webpackJsonp([17],{128:function(module,exports,__webpack_require__){eval("var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/*!\r\n * Bootstrap-select v1.11.2 (http://silviomoreto.github.io/bootstrap-select)\r\n *\r\n * Copyright 2013-2016 bootstrap-select\r\n * Licensed under MIT (https://github.com/silviomoreto/bootstrap-select/blob/master/LICENSE)\r\n */\n\n(function (root, factory) {\n  if (true) {\n    // AMD. Register as an anonymous module unless amdModuleId is set\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = function (a0) {\n      return factory(a0);\n    }.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node. Does not work with strict CommonJS, but\n    // only CommonJS-like environments that support module.exports,\n    // like Node.\n    module.exports = factory(require(\"jquery\"));\n  } else {\n    factory(jQuery);\n  }\n})(this, function (jQuery) {\n\n  (function ($) {\n    'use strict';\n\n    //<editor-fold desc=\"Shims\">\n\n    if (!String.prototype.includes) {\n      (function () {\n        'use strict'; // needed to support `apply`/`call` with `undefined`/`null`\n\n        var toString = {}.toString;\n        var defineProperty = function () {\n          // IE 8 only supports `Object.defineProperty` on DOM elements\n          try {\n            var object = {};\n            var $defineProperty = Object.defineProperty;\n            var result = $defineProperty(object, object, object) && $defineProperty;\n          } catch (error) {}\n          return result;\n        }();\n        var indexOf = ''.indexOf;\n        var includes = function (search) {\n          if (this == null) {\n            throw new TypeError();\n          }\n          var string = String(this);\n          if (search && toString.call(search) == '[object RegExp]') {\n            throw new TypeError();\n          }\n          var stringLength = string.length;\n          var searchString = String(search);\n          var searchLength = searchString.length;\n          var position = arguments.length > 1 ? arguments[1] : undefined;\n          // `ToInteger`\n          var pos = position ? Number(position) : 0;\n          if (pos != pos) {\n            // better `isNaN`\n            pos = 0;\n          }\n          var start = Math.min(Math.max(pos, 0), stringLength);\n          // Avoid the `indexOf` call if no match is possible\n          if (searchLength + start > stringLength) {\n            return false;\n          }\n          return indexOf.call(string, searchString, pos) != -1;\n        };\n        if (defineProperty) {\n          defineProperty(String.prototype, 'includes', {\n            'value': includes,\n            'configurable': true,\n            'writable': true\n          });\n        } else {\n          String.prototype.includes = includes;\n        }\n      })();\n    }\n\n    if (!String.prototype.startsWith) {\n      (function () {\n        'use strict'; // needed to support `apply`/`call` with `undefined`/`null`\n\n        var defineProperty = function () {\n          // IE 8 only supports `Object.defineProperty` on DOM elements\n          try {\n            var object = {};\n            var $defineProperty = Object.defineProperty;\n            var result = $defineProperty(object, object, object) && $defineProperty;\n          } catch (error) {}\n          return result;\n        }();\n        var toString = {}.toString;\n        var startsWith = function (search) {\n          if (this == null) {\n            throw new TypeError();\n          }\n          var string = String(this);\n          if (search && toString.call(search) == '[object RegExp]') {\n            throw new TypeError();\n          }\n          var stringLength = string.length;\n          var searchString = String(search);\n          var searchLength = searchString.length;\n          var position = arguments.length > 1 ? arguments[1] : undefined;\n          // `ToInteger`\n          var pos = position ? Number(position) : 0;\n          if (pos != pos) {\n            // better `isNaN`\n            pos = 0;\n          }\n          var start = Math.min(Math.max(pos, 0), stringLength);\n          // Avoid the `indexOf` call if no match is possible\n          if (searchLength + start > stringLength) {\n            return false;\n          }\n          var index = -1;\n          while (++index < searchLength) {\n            if (string.charCodeAt(start + index) != searchString.charCodeAt(index)) {\n              return false;\n            }\n          }\n          return true;\n        };\n        if (defineProperty) {\n          defineProperty(String.prototype, 'startsWith', {\n            'value': startsWith,\n            'configurable': true,\n            'writable': true\n          });\n        } else {\n          String.prototype.startsWith = startsWith;\n        }\n      })();\n    }\n\n    if (!Object.keys) {\n      Object.keys = function (o, // object\n      k, // key\n      r // result array\n      ) {\n        // initialize object and result\n        r = [];\n        // iterate over object keys\n        for (k in o)\n        // fill result array with non-prototypical keys\n        r.hasOwnProperty.call(o, k) && r.push(k);\n        // return result\n        return r;\n      };\n    }\n\n    // set data-selected on select element if the value has been programmatically selected\n    // prior to initialization of bootstrap-select\n    // * consider removing or replacing an alternative method *\n    var valHooks = {\n      useDefault: false,\n      _set: $.valHooks.select.set\n    };\n\n    $.valHooks.select.set = function (elem, value) {\n      if (value && !valHooks.useDefault) $(elem).data('selected', true);\n\n      return valHooks._set.apply(this, arguments);\n    };\n\n    var changed_arguments = null;\n    $.fn.triggerNative = function (eventName) {\n      var el = this[0],\n          event;\n\n      if (el.dispatchEvent) {\n        // for modern browsers & IE9+\n        if (typeof Event === 'function') {\n          // For modern browsers\n          event = new Event(eventName, {\n            bubbles: true\n          });\n        } else {\n          // For IE since it doesn't support Event constructor\n          event = document.createEvent('Event');\n          event.initEvent(eventName, true, false);\n        }\n\n        el.dispatchEvent(event);\n      } else if (el.fireEvent) {\n        // for IE8\n        event = document.createEventObject();\n        event.eventType = eventName;\n        el.fireEvent('on' + eventName, event);\n      } else {\n        // fall back to jQuery.trigger\n        this.trigger(eventName);\n      }\n    };\n    //</editor-fold>\n\n    // Case insensitive contains search\n    $.expr.pseudos.icontains = function (obj, index, meta) {\n      var $obj = $(obj);\n      var haystack = ($obj.data('tokens') || $obj.text()).toString().toUpperCase();\n      return haystack.includes(meta[3].toUpperCase());\n    };\n\n    // Case insensitive begins search\n    $.expr.pseudos.ibegins = function (obj, index, meta) {\n      var $obj = $(obj);\n      var haystack = ($obj.data('tokens') || $obj.text()).toString().toUpperCase();\n      return haystack.startsWith(meta[3].toUpperCase());\n    };\n\n    // Case and accent insensitive contains search\n    $.expr.pseudos.aicontains = function (obj, index, meta) {\n      var $obj = $(obj);\n      var haystack = ($obj.data('tokens') || $obj.data('normalizedText') || $obj.text()).toString().toUpperCase();\n      return haystack.includes(meta[3].toUpperCase());\n    };\n\n    // Case and accent insensitive begins search\n    $.expr.pseudos.aibegins = function (obj, index, meta) {\n      var $obj = $(obj);\n      var haystack = ($obj.data('tokens') || $obj.data('normalizedText') || $obj.text()).toString().toUpperCase();\n      return haystack.startsWith(meta[3].toUpperCase());\n    };\n\n    /**\r\n     * Remove all diatrics from the given text.\r\n     * @access private\r\n     * @param {String} text\r\n     * @returns {String}\r\n     */\n    function normalizeToBase(text) {\n      var rExps = [{ re: /[\\xC0-\\xC6]/g, ch: \"A\" }, { re: /[\\xE0-\\xE6]/g, ch: \"a\" }, { re: /[\\xC8-\\xCB]/g, ch: \"E\" }, { re: /[\\xE8-\\xEB]/g, ch: \"e\" }, { re: /[\\xCC-\\xCF]/g, ch: \"I\" }, { re: /[\\xEC-\\xEF]/g, ch: \"i\" }, { re: /[\\xD2-\\xD6]/g, ch: \"O\" }, { re: /[\\xF2-\\xF6]/g, ch: \"o\" }, { re: /[\\xD9-\\xDC]/g, ch: \"U\" }, { re: /[\\xF9-\\xFC]/g, ch: \"u\" }, { re: /[\\xC7-\\xE7]/g, ch: \"c\" }, { re: /[\\xD1]/g, ch: \"N\" }, { re: /[\\xF1]/g, ch: \"n\" }];\n      $.each(rExps, function () {\n        text = text.replace(this.re, this.ch);\n      });\n      return text;\n    }\n\n    function htmlEscape(html) {\n      var escapeMap = {\n        '&': '&amp;',\n        '<': '&lt;',\n        '>': '&gt;',\n        '\"': '&quot;',\n        \"'\": '&#x27;',\n        '`': '&#x60;'\n      };\n      var source = '(?:' + Object.keys(escapeMap).join('|') + ')',\n          testRegexp = new RegExp(source),\n          replaceRegexp = new RegExp(source, 'g'),\n          string = html == null ? '' : '' + html;\n      return testRegexp.test(string) ? string.replace(replaceRegexp, function (match) {\n        return escapeMap[match];\n      }) : string;\n    }\n\n    var Selectpicker = function (element, options, e) {\n      // bootstrap-select has been initialized - revert valHooks.select.set back to its original function\n      if (!valHooks.useDefault) {\n        $.valHooks.select.set = valHooks._set;\n        valHooks.useDefault = true;\n      }\n\n      if (e) {\n        e.stopPropagation();\n        e.preventDefault();\n      }\n\n      this.$element = $(element);\n      this.$newElement = null;\n      this.$button = null;\n      this.$menu = null;\n      this.$lis = null;\n      this.options = options;\n\n      // If we have no title yet, try to pull it from the html title attribute (jQuery doesnt' pick it up as it's not a\n      // data-attribute)\n      if (this.options.title === null) {\n        this.options.title = this.$element.attr('title');\n      }\n\n      //Expose public methods\n      this.val = Selectpicker.prototype.val;\n      this.render = Selectpicker.prototype.render;\n      this.refresh = Selectpicker.prototype.refresh;\n      this.setStyle = Selectpicker.prototype.setStyle;\n      this.selectAll = Selectpicker.prototype.selectAll;\n      this.deselectAll = Selectpicker.prototype.deselectAll;\n      this.destroy = Selectpicker.prototype.destroy;\n      this.remove = Selectpicker.prototype.remove;\n      this.show = Selectpicker.prototype.show;\n      this.hide = Selectpicker.prototype.hide;\n\n      this.init();\n    };\n\n    Selectpicker.VERSION = '1.11.2';\n\n    // part of this is duplicated in i18n/defaults-en_US.js. Make sure to update both.\n    Selectpicker.DEFAULTS = {\n      noneSelectedText: 'Nothing selected',\n      noneResultsText: 'No results matched {0}',\n      countSelectedText: function (numSelected, numTotal) {\n        return numSelected == 1 ? \"{0} item selected\" : \"{0} items selected\";\n      },\n      maxOptionsText: function (numAll, numGroup) {\n        return [numAll == 1 ? 'Limit reached ({n} item max)' : 'Limit reached ({n} items max)', numGroup == 1 ? 'Group limit reached ({n} item max)' : 'Group limit reached ({n} items max)'];\n      },\n      selectAllText: 'Select All',\n      deselectAllText: 'Deselect All',\n      doneButton: false,\n      doneButtonText: 'Close',\n      multipleSeparator: ', ',\n      styleBase: 'btn',\n      style: 'btn-default',\n      size: 'auto',\n      title: null,\n      selectedTextFormat: 'values',\n      width: false,\n      container: false,\n      hideDisabled: false,\n      showSubtext: false,\n      showIcon: true,\n      showContent: true,\n      dropupAuto: true,\n      header: false,\n      liveSearch: false,\n      liveSearchPlaceholder: null,\n      liveSearchNormalize: false,\n      liveSearchStyle: 'contains',\n      actionsBox: false,\n      iconBase: 'glyphicon',\n      tickIcon: 'glyphicon-ok',\n      showTick: false,\n      template: {\n        caret: '<span class=\"caret\"></span>'\n      },\n      maxOptions: false,\n      mobile: false,\n      selectOnTab: false,\n      dropdownAlignRight: false\n    };\n\n    Selectpicker.prototype = {\n\n      constructor: Selectpicker,\n\n      init: function () {\n        var that = this,\n            id = this.$element.attr('id');\n\n        this.$element.addClass('bs-select-hidden');\n\n        // store originalIndex (key) and newIndex (value) in this.liObj for fast accessibility\n        // allows us to do this.$lis.eq(that.liObj[index]) instead of this.$lis.filter('[data-original-index=\"' + index + '\"]')\n        this.liObj = {};\n        this.multiple = this.$element.prop('multiple');\n        this.autofocus = this.$element.prop('autofocus');\n        this.$newElement = this.createView();\n        this.$element.after(this.$newElement).appendTo(this.$newElement);\n        this.$button = this.$newElement.children('button');\n        this.$menu = this.$newElement.children('.dropdown-menu');\n        this.$menuInner = this.$menu.children('.inner');\n        this.$searchbox = this.$menu.find('input');\n\n        this.$element.removeClass('bs-select-hidden');\n\n        if (this.options.dropdownAlignRight === true) this.$menu.addClass('dropdown-menu-right');\n\n        if (typeof id !== 'undefined') {\n          this.$button.attr('data-id', id);\n          $('label[for=\"' + id + '\"]').click(function (e) {\n            e.preventDefault();\n            that.$button.focus();\n          });\n        }\n\n        this.checkDisabled();\n        this.clickListener();\n        if (this.options.liveSearch) this.liveSearchListener();\n        this.render();\n        this.setStyle();\n        this.setWidth();\n        if (this.options.container) this.selectPosition();\n        this.$menu.data('this', this);\n        this.$newElement.data('this', this);\n        if (this.options.mobile) this.mobile();\n\n        this.$newElement.on({\n          'hide.bs.dropdown': function (e) {\n            that.$menuInner.attr('aria-expanded', false);\n            that.$element.trigger('hide.bs.select', e);\n          },\n          'hidden.bs.dropdown': function (e) {\n            that.$element.trigger('hidden.bs.select', e);\n          },\n          'show.bs.dropdown': function (e) {\n            that.$menuInner.attr('aria-expanded', true);\n            that.$element.trigger('show.bs.select', e);\n          },\n          'shown.bs.dropdown': function (e) {\n            that.$element.trigger('shown.bs.select', e);\n          }\n        });\n\n        if (that.$element[0].hasAttribute('required')) {\n          this.$element.on('invalid', function () {\n            that.$button.addClass('bs-invalid').focus();\n\n            that.$element.on({\n              'focus.bs.select': function () {\n                that.$button.focus();\n                that.$element.off('focus.bs.select');\n              },\n              'shown.bs.select': function () {\n                that.$element.val(that.$element.val()) // set the value to hide the validation message in Chrome when menu is opened\n                .off('shown.bs.select');\n              },\n              'rendered.bs.select': function () {\n                // if select is no longer invalid, remove the bs-invalid class\n                if (this.validity.valid) that.$button.removeClass('bs-invalid');\n                that.$element.off('rendered.bs.select');\n              }\n            });\n          });\n        }\n\n        setTimeout(function () {\n          that.$element.trigger('loaded.bs.select');\n        });\n      },\n\n      createDropdown: function () {\n        // Options\n        // If we are multiple or showTick option is set, then add the show-tick class\n        var showTick = this.multiple || this.options.showTick ? ' show-tick' : '',\n            inputGroup = this.$element.parent().hasClass('input-group') ? ' input-group-btn' : '',\n            autofocus = this.autofocus ? ' autofocus' : '';\n        // Elements\n        var header = this.options.header ? '<div class=\"popover-title\"><button type=\"button\" class=\"close\" aria-hidden=\"true\">&times;</button>' + this.options.header + '</div>' : '';\n        var searchbox = this.options.liveSearch ? '<div class=\"bs-searchbox\">' + '<input type=\"text\" class=\"form-control\" autocomplete=\"off\"' + (null === this.options.liveSearchPlaceholder ? '' : ' placeholder=\"' + htmlEscape(this.options.liveSearchPlaceholder) + '\"') + ' role=\"textbox\" aria-label=\"Search\">' + '</div>' : '';\n        var actionsbox = this.multiple && this.options.actionsBox ? '<div class=\"bs-actionsbox\">' + '<div class=\"btn-group btn-group-sm btn-block\">' + '<button type=\"button\" class=\"actions-btn bs-select-all btn btn-default\">' + this.options.selectAllText + '</button>' + '<button type=\"button\" class=\"actions-btn bs-deselect-all btn btn-default\">' + this.options.deselectAllText + '</button>' + '</div>' + '</div>' : '';\n        var donebutton = this.multiple && this.options.doneButton ? '<div class=\"bs-donebutton\">' + '<div class=\"btn-group btn-block\">' + '<button type=\"button\" class=\"btn btn-sm btn-default\">' + this.options.doneButtonText + '</button>' + '</div>' + '</div>' : '';\n        var drop = '<div class=\"btn-group bootstrap-select' + showTick + inputGroup + '\">' + '<button type=\"button\" class=\"' + this.options.styleBase + ' dropdown-toggle\" data-toggle=\"dropdown\"' + autofocus + ' role=\"button\">' + '<span class=\"filter-option pull-left\"></span>&nbsp;' + '<span class=\"bs-caret\">' + this.options.template.caret + '</span>' + '</button>' + '<div class=\"dropdown-menu open\" role=\"combobox\">' + header + searchbox + actionsbox + '<ul class=\"dropdown-menu inner\" role=\"listbox\" aria-expanded=\"false\">' + '</ul>' + donebutton + '</div>' + '</div>';\n\n        return $(drop);\n      },\n\n      createView: function () {\n        var $drop = this.createDropdown(),\n            li = this.createLi();\n\n        $drop.find('ul')[0].innerHTML = li;\n        return $drop;\n      },\n\n      reloadLi: function () {\n        //Remove all children.\n        this.destroyLi();\n        //Re build\n        var li = this.createLi();\n        this.$menuInner[0].innerHTML = li;\n      },\n\n      destroyLi: function () {\n        this.$menu.find('li').remove();\n      },\n\n      createLi: function () {\n        var that = this,\n            _li = [],\n            optID = 0,\n            titleOption = document.createElement('option'),\n            liIndex = -1; // increment liIndex whenever a new <li> element is created to ensure liObj is correct\n\n        // Helper functions\n        /**\r\n         * @param content\r\n         * @param [index]\r\n         * @param [classes]\r\n         * @param [optgroup]\r\n         * @returns {string}\r\n         */\n        var generateLI = function (content, index, classes, optgroup) {\n          return '<li' + (typeof classes !== 'undefined' & '' !== classes ? ' class=\"' + classes + '\"' : '') + (typeof index !== 'undefined' & null !== index ? ' data-original-index=\"' + index + '\"' : '') + (typeof optgroup !== 'undefined' & null !== optgroup ? 'data-optgroup=\"' + optgroup + '\"' : '') + '>' + content + '</li>';\n        };\n\n        /**\r\n         * @param text\r\n         * @param [classes]\r\n         * @param [inline]\r\n         * @param [tokens]\r\n         * @returns {string}\r\n         */\n        var generateA = function (text, classes, inline, tokens) {\n          return '<a tabindex=\"0\"' + (typeof classes !== 'undefined' ? ' class=\"' + classes + '\"' : '') + (typeof inline !== 'undefined' ? ' style=\"' + inline + '\"' : '') + (that.options.liveSearchNormalize ? ' data-normalized-text=\"' + normalizeToBase(htmlEscape(text)) + '\"' : '') + (typeof tokens !== 'undefined' || tokens !== null ? ' data-tokens=\"' + tokens + '\"' : '') + ' role=\"option\">' + text + '<span class=\"' + that.options.iconBase + ' ' + that.options.tickIcon + ' check-mark\"></span>' + '</a>';\n        };\n\n        if (this.options.title && !this.multiple) {\n          // this option doesn't create a new <li> element, but does add a new option, so liIndex is decreased\n          // since liObj is recalculated on every refresh, liIndex needs to be decreased even if the titleOption is already appended\n          liIndex--;\n\n          if (!this.$element.find('.bs-title-option').length) {\n            // Use native JS to prepend option (faster)\n            var element = this.$element[0];\n            titleOption.className = 'bs-title-option';\n            titleOption.appendChild(document.createTextNode(this.options.title));\n            titleOption.value = '';\n            element.insertBefore(titleOption, element.firstChild);\n            // Check if selected or data-selected attribute is already set on an option. If not, select the titleOption option.\n            // the selected item may have been changed by user or programmatically before the bootstrap select plugin runs,\n            // if so, the select will have the data-selected attribute\n            var $opt = $(element.options[element.selectedIndex]);\n            if ($opt.attr('selected') === undefined && this.$element.data('selected') === undefined) {\n              titleOption.selected = true;\n            }\n          }\n        }\n\n        this.$element.find('option').each(function (index) {\n          var $this = $(this);\n\n          liIndex++;\n\n          if ($this.hasClass('bs-title-option')) return;\n\n          // Get the class and text for the option\n          var optionClass = this.className || '',\n              inline = this.style.cssText,\n              text = $this.data('content') ? $this.data('content') : $this.html(),\n              tokens = $this.data('tokens') ? $this.data('tokens') : null,\n              subtext = typeof $this.data('subtext') !== 'undefined' ? '<small class=\"text-muted\">' + $this.data('subtext') + '</small>' : '',\n              icon = typeof $this.data('icon') !== 'undefined' ? '<span class=\"' + that.options.iconBase + ' ' + $this.data('icon') + '\"></span> ' : '',\n              $parent = $this.parent(),\n              isOptgroup = $parent[0].tagName === 'OPTGROUP',\n              isOptgroupDisabled = isOptgroup && $parent[0].disabled,\n              isDisabled = this.disabled || isOptgroupDisabled;\n\n          if (icon !== '' && isDisabled) {\n            icon = '<span>' + icon + '</span>';\n          }\n\n          if (that.options.hideDisabled && (isDisabled && !isOptgroup || isOptgroupDisabled)) {\n            liIndex--;\n            return;\n          }\n\n          if (!$this.data('content')) {\n            // Prepend any icon and append any subtext to the main text.\n            text = icon + '<span class=\"text\">' + text + subtext + '</span>';\n          }\n\n          if (isOptgroup && $this.data('divider') !== true) {\n            if (that.options.hideDisabled && isDisabled) {\n              if ($parent.data('allOptionsDisabled') === undefined) {\n                var $options = $parent.children();\n                $parent.data('allOptionsDisabled', $options.filter(':disabled').length === $options.length);\n              }\n\n              if ($parent.data('allOptionsDisabled')) {\n                liIndex--;\n                return;\n              }\n            }\n\n            var optGroupClass = ' ' + $parent[0].className || '';\n\n            if ($this.index() === 0) {\n              // Is it the first option of the optgroup?\n              optID += 1;\n\n              // Get the opt group label\n              var label = $parent[0].label,\n                  labelSubtext = typeof $parent.data('subtext') !== 'undefined' ? '<small class=\"text-muted\">' + $parent.data('subtext') + '</small>' : '',\n                  labelIcon = $parent.data('icon') ? '<span class=\"' + that.options.iconBase + ' ' + $parent.data('icon') + '\"></span> ' : '';\n\n              label = labelIcon + '<span class=\"text\">' + label + labelSubtext + '</span>';\n\n              if (index !== 0 && _li.length > 0) {\n                // Is it NOT the first option of the select && are there elements in the dropdown?\n                liIndex++;\n                _li.push(generateLI('', null, 'divider', optID + 'div'));\n              }\n              liIndex++;\n              _li.push(generateLI(label, null, 'dropdown-header' + optGroupClass, optID));\n            }\n\n            if (that.options.hideDisabled && isDisabled) {\n              liIndex--;\n              return;\n            }\n\n            _li.push(generateLI(generateA(text, 'opt ' + optionClass + optGroupClass, inline, tokens), index, '', optID));\n          } else if ($this.data('divider') === true) {\n            _li.push(generateLI('', index, 'divider'));\n          } else if ($this.data('hidden') === true) {\n            _li.push(generateLI(generateA(text, optionClass, inline, tokens), index, 'hidden is-hidden'));\n          } else {\n            var showDivider = this.previousElementSibling && this.previousElementSibling.tagName === 'OPTGROUP';\n\n            // if previous element is not an optgroup and hideDisabled is true\n            if (!showDivider && that.options.hideDisabled) {\n              // get previous elements\n              var $prev = $(this).prevAll();\n\n              for (var i = 0; i < $prev.length; i++) {\n                // find the first element in the previous elements that is an optgroup\n                if ($prev[i].tagName === 'OPTGROUP') {\n                  var optGroupDistance = 0;\n\n                  // loop through the options in between the current option and the optgroup\n                  // and check if they are hidden or disabled\n                  for (var d = 0; d < i; d++) {\n                    var prevOption = $prev[d];\n                    if (prevOption.disabled || $(prevOption).data('hidden') === true) optGroupDistance++;\n                  }\n\n                  // if all of the options between the current option and the optgroup are hidden or disabled, show the divider\n                  if (optGroupDistance === i) showDivider = true;\n\n                  break;\n                }\n              }\n            }\n\n            if (showDivider) {\n              liIndex++;\n              _li.push(generateLI('', null, 'divider', optID + 'div'));\n            }\n            _li.push(generateLI(generateA(text, optionClass, inline, tokens), index));\n          }\n\n          that.liObj[index] = liIndex;\n        });\n\n        //If we are not multiple, we don't have a selected item, and we don't have a title, select the first element so something is set in the button\n        if (!this.multiple && this.$element.find('option:selected').length === 0 && !this.options.title) {\n          this.$element.find('option').eq(0).prop('selected', true).attr('selected', 'selected');\n        }\n\n        return _li.join('');\n      },\n\n      findLis: function () {\n        if (this.$lis == null) this.$lis = this.$menu.find('li');\n        return this.$lis;\n      },\n\n      /**\r\n       * @param [updateLi] defaults to true\r\n       */\n      render: function (updateLi) {\n        var that = this,\n            notDisabled;\n\n        //Update the LI to match the SELECT\n        if (updateLi !== false) {\n          this.$element.find('option').each(function (index) {\n            var $lis = that.findLis().eq(that.liObj[index]);\n\n            that.setDisabled(index, this.disabled || this.parentNode.tagName === 'OPTGROUP' && this.parentNode.disabled, $lis);\n            that.setSelected(index, this.selected, $lis);\n          });\n        }\n\n        this.togglePlaceholder();\n\n        this.tabIndex();\n\n        var selectedItems = this.$element.find('option').map(function () {\n          if (this.selected) {\n            if (that.options.hideDisabled && (this.disabled || this.parentNode.tagName === 'OPTGROUP' && this.parentNode.disabled)) return;\n\n            var $this = $(this),\n                icon = $this.data('icon') && that.options.showIcon ? '<i class=\"' + that.options.iconBase + ' ' + $this.data('icon') + '\"></i> ' : '',\n                subtext;\n\n            if (that.options.showSubtext && $this.data('subtext') && !that.multiple) {\n              subtext = ' <small class=\"text-muted\">' + $this.data('subtext') + '</small>';\n            } else {\n              subtext = '';\n            }\n            if (typeof $this.attr('title') !== 'undefined') {\n              return $this.attr('title');\n            } else if ($this.data('content') && that.options.showContent) {\n              return $this.data('content');\n            } else {\n              return icon + $this.html() + subtext;\n            }\n          }\n        }).toArray();\n\n        //Fixes issue in IE10 occurring when no default option is selected and at least one option is disabled\n        //Convert all the values into a comma delimited string\n        var title = !this.multiple ? selectedItems[0] : selectedItems.join(this.options.multipleSeparator);\n\n        //If this is multi select, and the selectText type is count, the show 1 of 2 selected etc..\n        if (this.multiple && this.options.selectedTextFormat.indexOf('count') > -1) {\n          var max = this.options.selectedTextFormat.split('>');\n          if (max.length > 1 && selectedItems.length > max[1] || max.length == 1 && selectedItems.length >= 2) {\n            notDisabled = this.options.hideDisabled ? ', [disabled]' : '';\n            var totalCount = this.$element.find('option').not('[data-divider=\"true\"], [data-hidden=\"true\"]' + notDisabled).length,\n                tr8nText = typeof this.options.countSelectedText === 'function' ? this.options.countSelectedText(selectedItems.length, totalCount) : this.options.countSelectedText;\n            title = tr8nText.replace('{0}', selectedItems.length.toString()).replace('{1}', totalCount.toString());\n          }\n        }\n\n        if (this.options.title == undefined) {\n          this.options.title = this.$element.attr('title');\n        }\n\n        if (this.options.selectedTextFormat == 'static') {\n          title = this.options.title;\n        }\n\n        //If we dont have a title, then use the default, or if nothing is set at all, use the not selected text\n        if (!title) {\n          title = typeof this.options.title !== 'undefined' ? this.options.title : this.options.noneSelectedText;\n        }\n\n        //strip all html-tags and trim the result\n        this.$button.attr('title', $.trim(title.replace(/<[^>]*>?/g, '')));\n        this.$button.children('.filter-option').html(title);\n\n        this.$element.trigger('rendered.bs.select');\n      },\n\n      /**\r\n       * @param [style]\r\n       * @param [status]\r\n       */\n      setStyle: function (style, status) {\n        if (this.$element.attr('class')) {\n          this.$newElement.addClass(this.$element.attr('class').replace(/selectpicker|mobile-device|bs-select-hidden|validate\\[.*\\]/gi, ''));\n        }\n\n        var buttonClass = style ? style : this.options.style;\n\n        if (status == 'add') {\n          this.$button.addClass(buttonClass);\n        } else if (status == 'remove') {\n          this.$button.removeClass(buttonClass);\n        } else {\n          this.$button.removeClass(this.options.style);\n          this.$button.addClass(buttonClass);\n        }\n      },\n\n      liHeight: function (refresh) {\n        if (!refresh && (this.options.size === false || this.sizeInfo)) return;\n\n        var newElement = document.createElement('div'),\n            menu = document.createElement('div'),\n            menuInner = document.createElement('ul'),\n            divider = document.createElement('li'),\n            li = document.createElement('li'),\n            a = document.createElement('a'),\n            text = document.createElement('span'),\n            header = this.options.header && this.$menu.find('.popover-title').length > 0 ? this.$menu.find('.popover-title')[0].cloneNode(true) : null,\n            search = this.options.liveSearch ? document.createElement('div') : null,\n            actions = this.options.actionsBox && this.multiple && this.$menu.find('.bs-actionsbox').length > 0 ? this.$menu.find('.bs-actionsbox')[0].cloneNode(true) : null,\n            doneButton = this.options.doneButton && this.multiple && this.$menu.find('.bs-donebutton').length > 0 ? this.$menu.find('.bs-donebutton')[0].cloneNode(true) : null;\n\n        text.className = 'text';\n        newElement.className = this.$menu[0].parentNode.className + ' open';\n        menu.className = 'dropdown-menu open';\n        menuInner.className = 'dropdown-menu inner';\n        divider.className = 'divider';\n\n        text.appendChild(document.createTextNode('Inner text'));\n        a.appendChild(text);\n        li.appendChild(a);\n        menuInner.appendChild(li);\n        menuInner.appendChild(divider);\n        if (header) menu.appendChild(header);\n        if (search) {\n          // create a span instead of input as creating an input element is slower\n          var input = document.createElement('span');\n          search.className = 'bs-searchbox';\n          input.className = 'form-control';\n          search.appendChild(input);\n          menu.appendChild(search);\n        }\n        if (actions) menu.appendChild(actions);\n        menu.appendChild(menuInner);\n        if (doneButton) menu.appendChild(doneButton);\n        newElement.appendChild(menu);\n\n        document.body.appendChild(newElement);\n\n        var liHeight = a.offsetHeight,\n            headerHeight = header ? header.offsetHeight : 0,\n            searchHeight = search ? search.offsetHeight : 0,\n            actionsHeight = actions ? actions.offsetHeight : 0,\n            doneButtonHeight = doneButton ? doneButton.offsetHeight : 0,\n            dividerHeight = $(divider).outerHeight(true),\n\n        // fall back to jQuery if getComputedStyle is not supported\n        menuStyle = typeof getComputedStyle === 'function' ? getComputedStyle(menu) : false,\n            $menu = menuStyle ? null : $(menu),\n            menuPadding = {\n          vert: parseInt(menuStyle ? menuStyle.paddingTop : $menu.css('paddingTop')) + parseInt(menuStyle ? menuStyle.paddingBottom : $menu.css('paddingBottom')) + parseInt(menuStyle ? menuStyle.borderTopWidth : $menu.css('borderTopWidth')) + parseInt(menuStyle ? menuStyle.borderBottomWidth : $menu.css('borderBottomWidth')),\n          horiz: parseInt(menuStyle ? menuStyle.paddingLeft : $menu.css('paddingLeft')) + parseInt(menuStyle ? menuStyle.paddingRight : $menu.css('paddingRight')) + parseInt(menuStyle ? menuStyle.borderLeftWidth : $menu.css('borderLeftWidth')) + parseInt(menuStyle ? menuStyle.borderRightWidth : $menu.css('borderRightWidth'))\n        },\n            menuExtras = {\n          vert: menuPadding.vert + parseInt(menuStyle ? menuStyle.marginTop : $menu.css('marginTop')) + parseInt(menuStyle ? menuStyle.marginBottom : $menu.css('marginBottom')) + 2,\n          horiz: menuPadding.horiz + parseInt(menuStyle ? menuStyle.marginLeft : $menu.css('marginLeft')) + parseInt(menuStyle ? menuStyle.marginRight : $menu.css('marginRight')) + 2\n        };\n\n        document.body.removeChild(newElement);\n\n        this.sizeInfo = {\n          liHeight: liHeight,\n          headerHeight: headerHeight,\n          searchHeight: searchHeight,\n          actionsHeight: actionsHeight,\n          doneButtonHeight: doneButtonHeight,\n          dividerHeight: dividerHeight,\n          menuPadding: menuPadding,\n          menuExtras: menuExtras\n        };\n      },\n\n      setSize: function () {\n        this.findLis();\n        this.liHeight();\n\n        if (this.options.header) this.$menu.css('padding-top', 0);\n        if (this.options.size === false) return;\n\n        var that = this,\n            $menu = this.$menu,\n            $menuInner = this.$menuInner,\n            $window = $(window),\n            selectHeight = this.$newElement[0].offsetHeight,\n            selectWidth = this.$newElement[0].offsetWidth,\n            liHeight = this.sizeInfo['liHeight'],\n            headerHeight = this.sizeInfo['headerHeight'],\n            searchHeight = this.sizeInfo['searchHeight'],\n            actionsHeight = this.sizeInfo['actionsHeight'],\n            doneButtonHeight = this.sizeInfo['doneButtonHeight'],\n            divHeight = this.sizeInfo['dividerHeight'],\n            menuPadding = this.sizeInfo['menuPadding'],\n            menuExtras = this.sizeInfo['menuExtras'],\n            notDisabled = this.options.hideDisabled ? '.disabled' : '',\n            menuHeight,\n            menuWidth,\n            getHeight,\n            getWidth,\n            selectOffsetTop,\n            selectOffsetBot,\n            selectOffsetLeft,\n            selectOffsetRight,\n            getPos = function () {\n          var pos = that.$newElement.offset(),\n              $container = $(that.options.container),\n              containerPos;\n\n          if (that.options.container && !$container.is('body')) {\n            containerPos = $container.offset();\n            containerPos.top += parseInt($container.css('borderTopWidth'));\n            containerPos.left += parseInt($container.css('borderLeftWidth'));\n          } else {\n            containerPos = { top: 0, left: 0 };\n          }\n\n          selectOffsetTop = pos.top - containerPos.top - $window.scrollTop();\n          selectOffsetBot = $window.height() - selectOffsetTop - selectHeight - containerPos.top;\n          selectOffsetLeft = pos.left - containerPos.left - $window.scrollLeft();\n          selectOffsetRight = $window.width() - selectOffsetLeft - selectWidth - containerPos.left;\n        };\n\n        getPos();\n\n        if (this.options.size === 'auto') {\n          var getSize = function () {\n            var minHeight,\n                hasClass = function (className, include) {\n              return function (element) {\n                if (include) {\n                  return element.classList ? element.classList.contains(className) : $(element).hasClass(className);\n                } else {\n                  return !(element.classList ? element.classList.contains(className) : $(element).hasClass(className));\n                }\n              };\n            },\n                lis = that.$menuInner[0].getElementsByTagName('li'),\n                lisVisible = Array.prototype.filter ? Array.prototype.filter.call(lis, hasClass('hidden', false)) : that.$lis.not('.hidden'),\n                optGroup = Array.prototype.filter ? Array.prototype.filter.call(lisVisible, hasClass('dropdown-header', true)) : lisVisible.filter('.dropdown-header');\n\n            getPos();\n            menuHeight = selectOffsetBot - menuExtras.vert;\n            menuWidth = selectOffsetRight - menuExtras.horiz;\n\n            if (that.options.container) {\n              if (!$menu.data('height')) $menu.data('height', $menu.height());\n              getHeight = $menu.data('height');\n\n              if (!$menu.data('width')) $menu.data('width', $menu.width());\n              getWidth = $menu.data('width');\n            } else {\n              getHeight = $menu.height();\n              getWidth = $menu.width();\n            }\n\n            if (that.options.dropupAuto) {\n              that.$newElement.toggleClass('dropup', selectOffsetTop > selectOffsetBot && menuHeight - menuExtras.vert < getHeight);\n            }\n\n            if (that.$newElement.hasClass('dropup')) {\n              menuHeight = selectOffsetTop - menuExtras.vert;\n            }\n\n            if (that.options.dropdownAlignRight === 'auto') {\n              $menu.toggleClass('dropdown-menu-right', selectOffsetLeft > selectOffsetRight && menuWidth - menuExtras.horiz < getWidth - selectWidth);\n            }\n\n            if (lisVisible.length + optGroup.length > 3) {\n              minHeight = liHeight * 3 + menuExtras.vert - 2;\n            } else {\n              minHeight = 0;\n            }\n\n            $menu.css({\n              'max-height': menuHeight + 'px',\n              'overflow': 'hidden',\n              'min-height': minHeight + headerHeight + searchHeight + actionsHeight + doneButtonHeight + 'px'\n            });\n            $menuInner.css({\n              'max-height': menuHeight - headerHeight - searchHeight - actionsHeight - doneButtonHeight - menuPadding.vert + 'px',\n              'overflow-y': 'auto',\n              'min-height': Math.max(minHeight - menuPadding.vert, 0) + 'px'\n            });\n          };\n          getSize();\n          this.$searchbox.off('input.getSize propertychange.getSize').on('input.getSize propertychange.getSize', getSize);\n          $window.off('resize.getSize scroll.getSize').on('resize.getSize scroll.getSize', getSize);\n        } else if (this.options.size && this.options.size != 'auto' && this.$lis.not(notDisabled).length > this.options.size) {\n          var optIndex = this.$lis.not('.divider').not(notDisabled).children().slice(0, this.options.size).last().parent().index(),\n              divLength = this.$lis.slice(0, optIndex + 1).filter('.divider').length;\n          menuHeight = liHeight * this.options.size + divLength * divHeight + menuPadding.vert;\n\n          if (that.options.container) {\n            if (!$menu.data('height')) $menu.data('height', $menu.height());\n            getHeight = $menu.data('height');\n          } else {\n            getHeight = $menu.height();\n          }\n\n          if (that.options.dropupAuto) {\n            //noinspection JSUnusedAssignment\n            this.$newElement.toggleClass('dropup', selectOffsetTop > selectOffsetBot && menuHeight - menuExtras.vert < getHeight);\n          }\n          $menu.css({\n            'max-height': menuHeight + headerHeight + searchHeight + actionsHeight + doneButtonHeight + 'px',\n            'overflow': 'hidden',\n            'min-height': ''\n          });\n          $menuInner.css({\n            'max-height': menuHeight - menuPadding.vert + 'px',\n            'overflow-y': 'auto',\n            'min-height': ''\n          });\n        }\n      },\n\n      setWidth: function () {\n        if (this.options.width === 'auto') {\n          this.$menu.css('min-width', '0');\n\n          // Get correct width if element is hidden\n          var $selectClone = this.$menu.parent().clone().appendTo('body'),\n              $selectClone2 = this.options.container ? this.$newElement.clone().appendTo('body') : $selectClone,\n              ulWidth = $selectClone.children('.dropdown-menu').outerWidth(),\n              btnWidth = $selectClone2.css('width', 'auto').children('button').outerWidth();\n\n          $selectClone.remove();\n          $selectClone2.remove();\n\n          // Set width to whatever's larger, button title or longest option\n          this.$newElement.css('width', Math.max(ulWidth, btnWidth) + 'px');\n        } else if (this.options.width === 'fit') {\n          // Remove inline min-width so width can be changed from 'auto'\n          this.$menu.css('min-width', '');\n          this.$newElement.css('width', '').addClass('fit-width');\n        } else if (this.options.width) {\n          // Remove inline min-width so width can be changed from 'auto'\n          this.$menu.css('min-width', '');\n          this.$newElement.css('width', this.options.width);\n        } else {\n          // Remove inline min-width/width so width can be changed\n          this.$menu.css('min-width', '');\n          this.$newElement.css('width', '');\n        }\n        // Remove fit-width class if width is changed programmatically\n        if (this.$newElement.hasClass('fit-width') && this.options.width !== 'fit') {\n          this.$newElement.removeClass('fit-width');\n        }\n      },\n\n      selectPosition: function () {\n        this.$bsContainer = $('<div class=\"bs-container\" />');\n\n        var that = this,\n            $container = $(this.options.container),\n            pos,\n            containerPos,\n            actualHeight,\n            getPlacement = function ($element) {\n          that.$bsContainer.addClass($element.attr('class').replace(/form-control|fit-width/gi, '')).toggleClass('dropup', $element.hasClass('dropup'));\n          pos = $element.offset();\n\n          if (!$container.is('body')) {\n            containerPos = $container.offset();\n            containerPos.top += parseInt($container.css('borderTopWidth')) - $container.scrollTop();\n            containerPos.left += parseInt($container.css('borderLeftWidth')) - $container.scrollLeft();\n          } else {\n            containerPos = { top: 0, left: 0 };\n          }\n\n          actualHeight = $element.hasClass('dropup') ? 0 : $element[0].offsetHeight;\n\n          that.$bsContainer.css({\n            'top': pos.top - containerPos.top + actualHeight,\n            'left': pos.left - containerPos.left,\n            'width': $element[0].offsetWidth\n          });\n        };\n\n        this.$button.on('click', function () {\n          var $this = $(this);\n\n          if (that.isDisabled()) {\n            return;\n          }\n\n          getPlacement(that.$newElement);\n\n          that.$bsContainer.appendTo(that.options.container).toggleClass('open', !$this.hasClass('open')).append(that.$menu);\n        });\n\n        $(window).on('resize scroll', function () {\n          getPlacement(that.$newElement);\n        });\n\n        this.$element.on('hide.bs.select', function () {\n          that.$menu.data('height', that.$menu.height());\n          that.$bsContainer.detach();\n        });\n      },\n\n      /**\r\n       * @param {number} index - the index of the option that is being changed\r\n       * @param {boolean} selected - true if the option is being selected, false if being deselected\r\n       * @param {JQuery} $lis - the 'li' element that is being modified\r\n       */\n      setSelected: function (index, selected, $lis) {\n        if (!$lis) {\n          this.togglePlaceholder(); // check if setSelected is being called by changing the value of the select\n          $lis = this.findLis().eq(this.liObj[index]);\n        }\n\n        $lis.toggleClass('selected', selected).find('a').attr('aria-selected', selected);\n      },\n\n      /**\r\n       * @param {number} index - the index of the option that is being disabled\r\n       * @param {boolean} disabled - true if the option is being disabled, false if being enabled\r\n       * @param {JQuery} $lis - the 'li' element that is being modified\r\n       */\n      setDisabled: function (index, disabled, $lis) {\n        if (!$lis) {\n          $lis = this.findLis().eq(this.liObj[index]);\n        }\n\n        if (disabled) {\n          $lis.addClass('disabled').children('a').attr('href', '#').attr('tabindex', -1).attr('aria-disabled', true);\n        } else {\n          $lis.removeClass('disabled').children('a').removeAttr('href').attr('tabindex', 0).attr('aria-disabled', false);\n        }\n      },\n\n      isDisabled: function () {\n        return this.$element[0].disabled;\n      },\n\n      checkDisabled: function () {\n        var that = this;\n\n        if (this.isDisabled()) {\n          this.$newElement.addClass('disabled');\n          this.$button.addClass('disabled').attr('tabindex', -1);\n        } else {\n          if (this.$button.hasClass('disabled')) {\n            this.$newElement.removeClass('disabled');\n            this.$button.removeClass('disabled');\n          }\n\n          if (this.$button.attr('tabindex') == -1 && !this.$element.data('tabindex')) {\n            this.$button.removeAttr('tabindex');\n          }\n        }\n\n        this.$button.click(function () {\n          return !that.isDisabled();\n        });\n      },\n\n      togglePlaceholder: function () {\n        var value = this.$element.val();\n        this.$button.toggleClass('bs-placeholder', value === null || value === '');\n      },\n\n      tabIndex: function () {\n        if (this.$element.data('tabindex') !== this.$element.attr('tabindex') && this.$element.attr('tabindex') !== -98 && this.$element.attr('tabindex') !== '-98') {\n          this.$element.data('tabindex', this.$element.attr('tabindex'));\n          this.$button.attr('tabindex', this.$element.data('tabindex'));\n        }\n\n        this.$element.attr('tabindex', -98);\n      },\n\n      clickListener: function () {\n        var that = this,\n            $document = $(document);\n\n        this.$newElement.on('touchstart.dropdown', '.dropdown-menu', function (e) {\n          e.stopPropagation();\n        });\n\n        $document.data('spaceSelect', false);\n\n        this.$button.on('keyup', function (e) {\n          if (/(32)/.test(e.keyCode.toString(10)) && $document.data('spaceSelect')) {\n            e.preventDefault();\n            $document.data('spaceSelect', false);\n          }\n        });\n\n        this.$button.on('click', function () {\n          that.setSize();\n        });\n\n        this.$element.on('shown.bs.select', function () {\n          if (!that.options.liveSearch && !that.multiple) {\n            that.$menuInner.find('.selected a').focus();\n          } else if (!that.multiple) {\n            var selectedIndex = that.liObj[that.$element[0].selectedIndex];\n\n            if (typeof selectedIndex !== 'number' || that.options.size === false) return;\n\n            // scroll to selected option\n            var offset = that.$lis.eq(selectedIndex)[0].offsetTop - that.$menuInner[0].offsetTop;\n            offset = offset - that.$menuInner[0].offsetHeight / 2 + that.sizeInfo.liHeight / 2;\n            that.$menuInner[0].scrollTop = offset;\n          }\n        });\n\n        this.$menuInner.on('click', 'li a', function (e) {\n          var $this = $(this),\n              clickedIndex = $this.parent().data('originalIndex'),\n              prevValue = that.$element.val(),\n              prevIndex = that.$element.prop('selectedIndex'),\n              triggerChange = true;\n\n          // Don't close on multi choice menu\n          if (that.multiple && that.options.maxOptions !== 1) {\n            e.stopPropagation();\n          }\n\n          e.preventDefault();\n\n          //Don't run if we have been disabled\n          if (!that.isDisabled() && !$this.parent().hasClass('disabled')) {\n            var $options = that.$element.find('option'),\n                $option = $options.eq(clickedIndex),\n                state = $option.prop('selected'),\n                $optgroup = $option.parent('optgroup'),\n                maxOptions = that.options.maxOptions,\n                maxOptionsGrp = $optgroup.data('maxOptions') || false;\n\n            if (!that.multiple) {\n              // Deselect all others if not multi select box\n              $options.prop('selected', false);\n              $option.prop('selected', true);\n              that.$menuInner.find('.selected').removeClass('selected').find('a').attr('aria-selected', false);\n              that.setSelected(clickedIndex, true);\n            } else {\n              // Toggle the one we have chosen if we are multi select.\n              $option.prop('selected', !state);\n              that.setSelected(clickedIndex, !state);\n              $this.blur();\n\n              if (maxOptions !== false || maxOptionsGrp !== false) {\n                var maxReached = maxOptions < $options.filter(':selected').length,\n                    maxReachedGrp = maxOptionsGrp < $optgroup.find('option:selected').length;\n\n                if (maxOptions && maxReached || maxOptionsGrp && maxReachedGrp) {\n                  if (maxOptions && maxOptions == 1) {\n                    $options.prop('selected', false);\n                    $option.prop('selected', true);\n                    that.$menuInner.find('.selected').removeClass('selected');\n                    that.setSelected(clickedIndex, true);\n                  } else if (maxOptionsGrp && maxOptionsGrp == 1) {\n                    $optgroup.find('option:selected').prop('selected', false);\n                    $option.prop('selected', true);\n                    var optgroupID = $this.parent().data('optgroup');\n                    that.$menuInner.find('[data-optgroup=\"' + optgroupID + '\"]').removeClass('selected');\n                    that.setSelected(clickedIndex, true);\n                  } else {\n                    var maxOptionsText = typeof that.options.maxOptionsText === 'string' ? [that.options.maxOptionsText, that.options.maxOptionsText] : that.options.maxOptionsText,\n                        maxOptionsArr = typeof maxOptionsText === 'function' ? maxOptionsText(maxOptions, maxOptionsGrp) : maxOptionsText,\n                        maxTxt = maxOptionsArr[0].replace('{n}', maxOptions),\n                        maxTxtGrp = maxOptionsArr[1].replace('{n}', maxOptionsGrp),\n                        $notify = $('<div class=\"notify\"></div>');\n                    // If {var} is set in array, replace it\n                    /** @deprecated */\n                    if (maxOptionsArr[2]) {\n                      maxTxt = maxTxt.replace('{var}', maxOptionsArr[2][maxOptions > 1 ? 0 : 1]);\n                      maxTxtGrp = maxTxtGrp.replace('{var}', maxOptionsArr[2][maxOptionsGrp > 1 ? 0 : 1]);\n                    }\n\n                    $option.prop('selected', false);\n\n                    that.$menu.append($notify);\n\n                    if (maxOptions && maxReached) {\n                      $notify.append($('<div>' + maxTxt + '</div>'));\n                      triggerChange = false;\n                      that.$element.trigger('maxReached.bs.select');\n                    }\n\n                    if (maxOptionsGrp && maxReachedGrp) {\n                      $notify.append($('<div>' + maxTxtGrp + '</div>'));\n                      triggerChange = false;\n                      that.$element.trigger('maxReachedGrp.bs.select');\n                    }\n\n                    setTimeout(function () {\n                      that.setSelected(clickedIndex, false);\n                    }, 10);\n\n                    $notify.delay(750).fadeOut(300, function () {\n                      $(this).remove();\n                    });\n                  }\n                }\n              }\n            }\n\n            if (!that.multiple || that.multiple && that.options.maxOptions === 1) {\n              that.$button.focus();\n            } else if (that.options.liveSearch) {\n              that.$searchbox.focus();\n            }\n\n            // Trigger select 'change'\n            if (triggerChange) {\n              if (prevValue != that.$element.val() && that.multiple || prevIndex != that.$element.prop('selectedIndex') && !that.multiple) {\n                // $option.prop('selected') is current option state (selected/unselected). state is previous option state.\n                changed_arguments = [clickedIndex, $option.prop('selected'), state];\n                that.$element.triggerNative('change');\n              }\n            }\n          }\n        });\n\n        this.$menu.on('click', 'li.disabled a, .popover-title, .popover-title :not(.close)', function (e) {\n          if (e.currentTarget == this) {\n            e.preventDefault();\n            e.stopPropagation();\n            if (that.options.liveSearch && !$(e.target).hasClass('close')) {\n              that.$searchbox.focus();\n            } else {\n              that.$button.focus();\n            }\n          }\n        });\n\n        this.$menuInner.on('click', '.divider, .dropdown-header', function (e) {\n          e.preventDefault();\n          e.stopPropagation();\n          if (that.options.liveSearch) {\n            that.$searchbox.focus();\n          } else {\n            that.$button.focus();\n          }\n        });\n\n        this.$menu.on('click', '.popover-title .close', function () {\n          that.$button.click();\n        });\n\n        this.$searchbox.on('click', function (e) {\n          e.stopPropagation();\n        });\n\n        this.$menu.on('click', '.actions-btn', function (e) {\n          if (that.options.liveSearch) {\n            that.$searchbox.focus();\n          } else {\n            that.$button.focus();\n          }\n\n          e.preventDefault();\n          e.stopPropagation();\n\n          if ($(this).hasClass('bs-select-all')) {\n            that.selectAll();\n          } else {\n            that.deselectAll();\n          }\n        });\n\n        this.$element.change(function () {\n          that.render(false);\n          that.$element.trigger('changed.bs.select', changed_arguments);\n          changed_arguments = null;\n        });\n      },\n\n      liveSearchListener: function () {\n        var that = this,\n            $no_results = $('<li class=\"no-results\"></li>');\n\n        this.$button.on('click.dropdown.data-api touchstart.dropdown.data-api', function () {\n          that.$menuInner.find('.active').removeClass('active');\n          if (!!that.$searchbox.val()) {\n            that.$searchbox.val('');\n            that.$lis.not('.is-hidden').removeClass('hidden');\n            if (!!$no_results.parent().length) $no_results.remove();\n          }\n          if (!that.multiple) that.$menuInner.find('.selected').addClass('active');\n          setTimeout(function () {\n            that.$searchbox.focus();\n          }, 10);\n        });\n\n        this.$searchbox.on('click.dropdown.data-api focus.dropdown.data-api touchend.dropdown.data-api', function (e) {\n          e.stopPropagation();\n        });\n\n        this.$searchbox.on('input propertychange', function () {\n          if (that.$searchbox.val()) {\n            var $searchBase = that.$lis.not('.is-hidden').removeClass('hidden').children('a');\n            if (that.options.liveSearchNormalize) {\n              $searchBase = $searchBase.not(':a' + that._searchStyle() + '(\"' + normalizeToBase(that.$searchbox.val()) + '\")');\n            } else {\n              $searchBase = $searchBase.not(':' + that._searchStyle() + '(\"' + that.$searchbox.val() + '\")');\n            }\n            $searchBase.parent().addClass('hidden');\n\n            that.$lis.filter('.dropdown-header').each(function () {\n              var $this = $(this),\n                  optgroup = $this.data('optgroup');\n\n              if (that.$lis.filter('[data-optgroup=' + optgroup + ']').not($this).not('.hidden').length === 0) {\n                $this.addClass('hidden');\n                that.$lis.filter('[data-optgroup=' + optgroup + 'div]').addClass('hidden');\n              }\n            });\n\n            var $lisVisible = that.$lis.not('.hidden');\n\n            // hide divider if first or last visible, or if followed by another divider\n            $lisVisible.each(function (index) {\n              var $this = $(this);\n\n              if ($this.hasClass('divider') && ($this.index() === $lisVisible.first().index() || $this.index() === $lisVisible.last().index() || $lisVisible.eq(index + 1).hasClass('divider'))) {\n                $this.addClass('hidden');\n              }\n            });\n\n            if (!that.$lis.not('.hidden, .no-results').length) {\n              if (!!$no_results.parent().length) {\n                $no_results.remove();\n              }\n              $no_results.html(that.options.noneResultsText.replace('{0}', '\"' + htmlEscape(that.$searchbox.val()) + '\"')).show();\n              that.$menuInner.append($no_results);\n            } else if (!!$no_results.parent().length) {\n              $no_results.remove();\n            }\n          } else {\n            that.$lis.not('.is-hidden').removeClass('hidden');\n            if (!!$no_results.parent().length) {\n              $no_results.remove();\n            }\n          }\n\n          that.$lis.filter('.active').removeClass('active');\n          if (that.$searchbox.val()) that.$lis.not('.hidden, .divider, .dropdown-header').eq(0).addClass('active').children('a').focus();\n          $(this).focus();\n        });\n      },\n\n      _searchStyle: function () {\n        var styles = {\n          begins: 'ibegins',\n          startsWith: 'ibegins'\n        };\n\n        return styles[this.options.liveSearchStyle] || 'icontains';\n      },\n\n      val: function (value) {\n        if (typeof value !== 'undefined') {\n          this.$element.val(value);\n          this.render();\n\n          return this.$element;\n        } else {\n          return this.$element.val();\n        }\n      },\n\n      changeAll: function (status) {\n        if (!this.multiple) return;\n        if (typeof status === 'undefined') status = true;\n\n        this.findLis();\n\n        var $options = this.$element.find('option'),\n            $lisVisible = this.$lis.not('.divider, .dropdown-header, .disabled, .hidden'),\n            lisVisLen = $lisVisible.length,\n            selectedOptions = [];\n\n        if (status) {\n          if ($lisVisible.filter('.selected').length === $lisVisible.length) return;\n        } else {\n          if ($lisVisible.filter('.selected').length === 0) return;\n        }\n\n        $lisVisible.toggleClass('selected', status);\n\n        for (var i = 0; i < lisVisLen; i++) {\n          var origIndex = $lisVisible[i].getAttribute('data-original-index');\n          selectedOptions[selectedOptions.length] = $options.eq(origIndex)[0];\n        }\n\n        $(selectedOptions).prop('selected', status);\n\n        this.render(false);\n\n        this.togglePlaceholder();\n\n        this.$element.triggerNative('change');\n      },\n\n      selectAll: function () {\n        return this.changeAll(true);\n      },\n\n      deselectAll: function () {\n        return this.changeAll(false);\n      },\n\n      toggle: function (e) {\n        e = e || window.event;\n\n        if (e) e.stopPropagation();\n\n        this.$button.trigger('click');\n      },\n\n      keydown: function (e) {\n        var $this = $(this),\n            $parent = $this.is('input') ? $this.parent().parent() : $this.parent(),\n            $items,\n            that = $parent.data('this'),\n            index,\n            next,\n            first,\n            last,\n            prev,\n            nextPrev,\n            prevIndex,\n            isActive,\n            selector = ':not(.disabled, .hidden, .dropdown-header, .divider)',\n            keyCodeMap = {\n          32: ' ',\n          48: '0',\n          49: '1',\n          50: '2',\n          51: '3',\n          52: '4',\n          53: '5',\n          54: '6',\n          55: '7',\n          56: '8',\n          57: '9',\n          59: ';',\n          65: 'a',\n          66: 'b',\n          67: 'c',\n          68: 'd',\n          69: 'e',\n          70: 'f',\n          71: 'g',\n          72: 'h',\n          73: 'i',\n          74: 'j',\n          75: 'k',\n          76: 'l',\n          77: 'm',\n          78: 'n',\n          79: 'o',\n          80: 'p',\n          81: 'q',\n          82: 'r',\n          83: 's',\n          84: 't',\n          85: 'u',\n          86: 'v',\n          87: 'w',\n          88: 'x',\n          89: 'y',\n          90: 'z',\n          96: '0',\n          97: '1',\n          98: '2',\n          99: '3',\n          100: '4',\n          101: '5',\n          102: '6',\n          103: '7',\n          104: '8',\n          105: '9'\n        };\n\n        if (that.options.liveSearch) $parent = $this.parent().parent();\n\n        if (that.options.container) $parent = that.$menu;\n\n        $items = $('[role=\"listbox\"] li', $parent);\n\n        isActive = that.$newElement.hasClass('open');\n\n        if (!isActive && (e.keyCode >= 48 && e.keyCode <= 57 || e.keyCode >= 96 && e.keyCode <= 105 || e.keyCode >= 65 && e.keyCode <= 90)) {\n          if (!that.options.container) {\n            that.setSize();\n            that.$menu.parent().addClass('open');\n            isActive = true;\n          } else {\n            that.$button.trigger('click');\n          }\n          that.$searchbox.focus();\n          return;\n        }\n\n        if (that.options.liveSearch) {\n          if (/(^9$|27)/.test(e.keyCode.toString(10)) && isActive) {\n            e.preventDefault();\n            e.stopPropagation();\n            that.$button.click().focus();\n          }\n          // $items contains li elements when liveSearch is enabled\n          $items = $('[role=\"listbox\"] li' + selector, $parent);\n          if (!$this.val() && !/(38|40)/.test(e.keyCode.toString(10))) {\n            if ($items.filter('.active').length === 0) {\n              $items = that.$menuInner.find('li');\n              if (that.options.liveSearchNormalize) {\n                $items = $items.filter(':a' + that._searchStyle() + '(' + normalizeToBase(keyCodeMap[e.keyCode]) + ')');\n              } else {\n                $items = $items.filter(':' + that._searchStyle() + '(' + keyCodeMap[e.keyCode] + ')');\n              }\n            }\n          }\n        }\n\n        if (!$items.length) return;\n\n        if (/(38|40)/.test(e.keyCode.toString(10))) {\n          index = $items.index($items.find('a').filter(':focus').parent());\n          first = $items.filter(selector).first().index();\n          last = $items.filter(selector).last().index();\n          next = $items.eq(index).nextAll(selector).eq(0).index();\n          prev = $items.eq(index).prevAll(selector).eq(0).index();\n          nextPrev = $items.eq(next).prevAll(selector).eq(0).index();\n\n          if (that.options.liveSearch) {\n            $items.each(function (i) {\n              if (!$(this).hasClass('disabled')) {\n                $(this).data('index', i);\n              }\n            });\n            index = $items.index($items.filter('.active'));\n            first = $items.first().data('index');\n            last = $items.last().data('index');\n            next = $items.eq(index).nextAll().eq(0).data('index');\n            prev = $items.eq(index).prevAll().eq(0).data('index');\n            nextPrev = $items.eq(next).prevAll().eq(0).data('index');\n          }\n\n          prevIndex = $this.data('prevIndex');\n\n          if (e.keyCode == 38) {\n            if (that.options.liveSearch) index--;\n            if (index != nextPrev && index > prev) index = prev;\n            if (index < first) index = first;\n            if (index == prevIndex) index = last;\n          } else if (e.keyCode == 40) {\n            if (that.options.liveSearch) index++;\n            if (index == -1) index = 0;\n            if (index != nextPrev && index < next) index = next;\n            if (index > last) index = last;\n            if (index == prevIndex) index = first;\n          }\n\n          $this.data('prevIndex', index);\n\n          if (!that.options.liveSearch) {\n            $items.eq(index).children('a').focus();\n          } else {\n            e.preventDefault();\n            if (!$this.hasClass('dropdown-toggle')) {\n              $items.removeClass('active').eq(index).addClass('active').children('a').focus();\n              $this.focus();\n            }\n          }\n        } else if (!$this.is('input')) {\n          var keyIndex = [],\n              count,\n              prevKey;\n\n          $items.each(function () {\n            if (!$(this).hasClass('disabled')) {\n              if ($.trim($(this).children('a').text().toLowerCase()).substring(0, 1) == keyCodeMap[e.keyCode]) {\n                keyIndex.push($(this).index());\n              }\n            }\n          });\n\n          count = $(document).data('keycount');\n          count++;\n          $(document).data('keycount', count);\n\n          prevKey = $.trim($(':focus').text().toLowerCase()).substring(0, 1);\n\n          if (prevKey != keyCodeMap[e.keyCode]) {\n            count = 1;\n            $(document).data('keycount', count);\n          } else if (count >= keyIndex.length) {\n            $(document).data('keycount', 0);\n            if (count > keyIndex.length) count = 1;\n          }\n\n          $items.eq(keyIndex[count - 1]).children('a').focus();\n        }\n\n        // Select focused option if \"Enter\", \"Spacebar\" or \"Tab\" (when selectOnTab is true) are pressed inside the menu.\n        if ((/(13|32)/.test(e.keyCode.toString(10)) || /(^9$)/.test(e.keyCode.toString(10)) && that.options.selectOnTab) && isActive) {\n          if (!/(32)/.test(e.keyCode.toString(10))) e.preventDefault();\n          if (!that.options.liveSearch) {\n            var elem = $(':focus');\n            elem.click();\n            // Bring back focus for multiselects\n            elem.focus();\n            // Prevent screen from scrolling if the user hit the spacebar\n            e.preventDefault();\n            // Fixes spacebar selection of dropdown items in FF & IE\n            $(document).data('spaceSelect', true);\n          } else if (!/(32)/.test(e.keyCode.toString(10))) {\n            that.$menuInner.find('.active a').click();\n            $this.focus();\n          }\n          $(document).data('keycount', 0);\n        }\n\n        if (/(^9$|27)/.test(e.keyCode.toString(10)) && isActive && (that.multiple || that.options.liveSearch) || /(27)/.test(e.keyCode.toString(10)) && !isActive) {\n          that.$menu.parent().removeClass('open');\n          if (that.options.container) that.$newElement.removeClass('open');\n          that.$button.focus();\n        }\n      },\n\n      mobile: function () {\n        this.$element.addClass('mobile-device');\n      },\n\n      refresh: function () {\n        this.$lis = null;\n        this.liObj = {};\n        this.reloadLi();\n        this.render();\n        this.checkDisabled();\n        this.liHeight(true);\n        this.setStyle();\n        this.setWidth();\n        if (this.$lis) this.$searchbox.trigger('propertychange');\n\n        this.$element.trigger('refreshed.bs.select');\n      },\n\n      hide: function () {\n        this.$newElement.hide();\n      },\n\n      show: function () {\n        this.$newElement.show();\n      },\n\n      remove: function () {\n        this.$newElement.remove();\n        this.$element.remove();\n      },\n\n      destroy: function () {\n        this.$newElement.before(this.$element).remove();\n\n        if (this.$bsContainer) {\n          this.$bsContainer.remove();\n        } else {\n          this.$menu.remove();\n        }\n\n        this.$element.off('.bs.select').removeData('selectpicker').removeClass('bs-select-hidden selectpicker');\n      }\n    };\n\n    // SELECTPICKER PLUGIN DEFINITION\n    // ==============================\n    function Plugin(option, event) {\n      // get the args of the outer function..\n      var args = arguments;\n      // The arguments of the function are explicitly re-defined from the argument list, because the shift causes them\n      // to get lost/corrupted in android 2.3 and IE9 #715 #775\n      var _option = option,\n          _event = event;\n      [].shift.apply(args);\n\n      var value;\n      var chain = this.each(function () {\n        var $this = $(this);\n        if ($this.is('select')) {\n          var data = $this.data('selectpicker'),\n              options = typeof _option == 'object' && _option;\n\n          if (!data) {\n            var config = $.extend({}, Selectpicker.DEFAULTS, $.fn.selectpicker.defaults || {}, $this.data(), options);\n            config.template = $.extend({}, Selectpicker.DEFAULTS.template, $.fn.selectpicker.defaults ? $.fn.selectpicker.defaults.template : {}, $this.data().template, options.template);\n            $this.data('selectpicker', data = new Selectpicker(this, config, _event));\n          } else if (options) {\n            for (var i in options) {\n              if (options.hasOwnProperty(i)) {\n                data.options[i] = options[i];\n              }\n            }\n          }\n\n          if (typeof _option == 'string') {\n            if (data[_option] instanceof Function) {\n              value = data[_option].apply(data, args);\n            } else {\n              value = data.options[_option];\n            }\n          }\n        }\n      });\n\n      if (typeof value !== 'undefined') {\n        //noinspection JSUnusedAssignment\n        return value;\n      } else {\n        return chain;\n      }\n    }\n\n    var old = $.fn.selectpicker;\n    $.fn.selectpicker = Plugin;\n    $.fn.selectpicker.Constructor = Selectpicker;\n\n    // SELECTPICKER NO CONFLICT\n    // ========================\n    $.fn.selectpicker.noConflict = function () {\n      $.fn.selectpicker = old;\n      return this;\n    };\n\n    $(document).data('keycount', 0).on('keydown.bs.select', '.bootstrap-select [data-toggle=dropdown], .bootstrap-select [role=\"listbox\"], .bs-searchbox input', Selectpicker.prototype.keydown).on('focusin.modal', '.bootstrap-select [data-toggle=dropdown], .bootstrap-select [role=\"listbox\"], .bs-searchbox input', function (e) {\n      e.stopPropagation();\n    });\n\n    // SELECTPICKER DATA-API\n    // =====================\n    $(window).on('load.bs.select.data-api', function () {\n      $('.selectpicker').each(function () {\n        var $selectpicker = $(this);\n        Plugin.call($selectpicker, $selectpicker.data());\n      });\n    });\n  })(jQuery);\n});//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTI4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vfi9ib290c3RyYXAtc2VsZWN0L2Rpc3QvanMvYm9vdHN0cmFwLXNlbGVjdC5qcz8yZGRjIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIVxyXG4gKiBCb290c3RyYXAtc2VsZWN0IHYxLjExLjIgKGh0dHA6Ly9zaWx2aW9tb3JldG8uZ2l0aHViLmlvL2Jvb3RzdHJhcC1zZWxlY3QpXHJcbiAqXHJcbiAqIENvcHlyaWdodCAyMDEzLTIwMTYgYm9vdHN0cmFwLXNlbGVjdFxyXG4gKiBMaWNlbnNlZCB1bmRlciBNSVQgKGh0dHBzOi8vZ2l0aHViLmNvbS9zaWx2aW9tb3JldG8vYm9vdHN0cmFwLXNlbGVjdC9ibG9iL21hc3Rlci9MSUNFTlNFKVxyXG4gKi9cblxuKGZ1bmN0aW9uIChyb290LCBmYWN0b3J5KSB7XG4gIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICAvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUgdW5sZXNzIGFtZE1vZHVsZUlkIGlzIHNldFxuICAgIGRlZmluZShbXCJqcXVlcnlcIl0sIGZ1bmN0aW9uIChhMCkge1xuICAgICAgcmV0dXJuIGZhY3RvcnkoYTApO1xuICAgIH0pO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jykge1xuICAgIC8vIE5vZGUuIERvZXMgbm90IHdvcmsgd2l0aCBzdHJpY3QgQ29tbW9uSlMsIGJ1dFxuICAgIC8vIG9ubHkgQ29tbW9uSlMtbGlrZSBlbnZpcm9ubWVudHMgdGhhdCBzdXBwb3J0IG1vZHVsZS5leHBvcnRzLFxuICAgIC8vIGxpa2UgTm9kZS5cbiAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZShcImpxdWVyeVwiKSk7XG4gIH0gZWxzZSB7XG4gICAgZmFjdG9yeShqUXVlcnkpO1xuICB9XG59KSh0aGlzLCBmdW5jdGlvbiAoalF1ZXJ5KSB7XG5cbiAgKGZ1bmN0aW9uICgkKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgLy88ZWRpdG9yLWZvbGQgZGVzYz1cIlNoaW1zXCI+XG5cbiAgICBpZiAoIVN0cmluZy5wcm90b3R5cGUuaW5jbHVkZXMpIHtcbiAgICAgIChmdW5jdGlvbiAoKSB7XG4gICAgICAgICd1c2Ugc3RyaWN0JzsgLy8gbmVlZGVkIHRvIHN1cHBvcnQgYGFwcGx5YC9gY2FsbGAgd2l0aCBgdW5kZWZpbmVkYC9gbnVsbGBcblxuICAgICAgICB2YXIgdG9TdHJpbmcgPSB7fS50b1N0cmluZztcbiAgICAgICAgdmFyIGRlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIC8vIElFIDggb25seSBzdXBwb3J0cyBgT2JqZWN0LmRlZmluZVByb3BlcnR5YCBvbiBET00gZWxlbWVudHNcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIG9iamVjdCA9IHt9O1xuICAgICAgICAgICAgdmFyICRkZWZpbmVQcm9wZXJ0eSA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSAkZGVmaW5lUHJvcGVydHkob2JqZWN0LCBvYmplY3QsIG9iamVjdCkgJiYgJGRlZmluZVByb3BlcnR5O1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7fVxuICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH0oKTtcbiAgICAgICAgdmFyIGluZGV4T2YgPSAnJy5pbmRleE9mO1xuICAgICAgICB2YXIgaW5jbHVkZXMgPSBmdW5jdGlvbiAoc2VhcmNoKSB7XG4gICAgICAgICAgaWYgKHRoaXMgPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgc3RyaW5nID0gU3RyaW5nKHRoaXMpO1xuICAgICAgICAgIGlmIChzZWFyY2ggJiYgdG9TdHJpbmcuY2FsbChzZWFyY2gpID09ICdbb2JqZWN0IFJlZ0V4cF0nKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBzdHJpbmdMZW5ndGggPSBzdHJpbmcubGVuZ3RoO1xuICAgICAgICAgIHZhciBzZWFyY2hTdHJpbmcgPSBTdHJpbmcoc2VhcmNoKTtcbiAgICAgICAgICB2YXIgc2VhcmNoTGVuZ3RoID0gc2VhcmNoU3RyaW5nLmxlbmd0aDtcbiAgICAgICAgICB2YXIgcG9zaXRpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZDtcbiAgICAgICAgICAvLyBgVG9JbnRlZ2VyYFxuICAgICAgICAgIHZhciBwb3MgPSBwb3NpdGlvbiA/IE51bWJlcihwb3NpdGlvbikgOiAwO1xuICAgICAgICAgIGlmIChwb3MgIT0gcG9zKSB7XG4gICAgICAgICAgICAvLyBiZXR0ZXIgYGlzTmFOYFxuICAgICAgICAgICAgcG9zID0gMDtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIHN0YXJ0ID0gTWF0aC5taW4oTWF0aC5tYXgocG9zLCAwKSwgc3RyaW5nTGVuZ3RoKTtcbiAgICAgICAgICAvLyBBdm9pZCB0aGUgYGluZGV4T2ZgIGNhbGwgaWYgbm8gbWF0Y2ggaXMgcG9zc2libGVcbiAgICAgICAgICBpZiAoc2VhcmNoTGVuZ3RoICsgc3RhcnQgPiBzdHJpbmdMZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGluZGV4T2YuY2FsbChzdHJpbmcsIHNlYXJjaFN0cmluZywgcG9zKSAhPSAtMTtcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKGRlZmluZVByb3BlcnR5KSB7XG4gICAgICAgICAgZGVmaW5lUHJvcGVydHkoU3RyaW5nLnByb3RvdHlwZSwgJ2luY2x1ZGVzJywge1xuICAgICAgICAgICAgJ3ZhbHVlJzogaW5jbHVkZXMsXG4gICAgICAgICAgICAnY29uZmlndXJhYmxlJzogdHJ1ZSxcbiAgICAgICAgICAgICd3cml0YWJsZSc6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBTdHJpbmcucHJvdG90eXBlLmluY2x1ZGVzID0gaW5jbHVkZXM7XG4gICAgICAgIH1cbiAgICAgIH0pKCk7XG4gICAgfVxuXG4gICAgaWYgKCFTdHJpbmcucHJvdG90eXBlLnN0YXJ0c1dpdGgpIHtcbiAgICAgIChmdW5jdGlvbiAoKSB7XG4gICAgICAgICd1c2Ugc3RyaWN0JzsgLy8gbmVlZGVkIHRvIHN1cHBvcnQgYGFwcGx5YC9gY2FsbGAgd2l0aCBgdW5kZWZpbmVkYC9gbnVsbGBcblxuICAgICAgICB2YXIgZGVmaW5lUHJvcGVydHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgLy8gSUUgOCBvbmx5IHN1cHBvcnRzIGBPYmplY3QuZGVmaW5lUHJvcGVydHlgIG9uIERPTSBlbGVtZW50c1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgb2JqZWN0ID0ge307XG4gICAgICAgICAgICB2YXIgJGRlZmluZVByb3BlcnR5ID0gT2JqZWN0LmRlZmluZVByb3BlcnR5O1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9ICRkZWZpbmVQcm9wZXJ0eShvYmplY3QsIG9iamVjdCwgb2JqZWN0KSAmJiAkZGVmaW5lUHJvcGVydHk7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHt9XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfSgpO1xuICAgICAgICB2YXIgdG9TdHJpbmcgPSB7fS50b1N0cmluZztcbiAgICAgICAgdmFyIHN0YXJ0c1dpdGggPSBmdW5jdGlvbiAoc2VhcmNoKSB7XG4gICAgICAgICAgaWYgKHRoaXMgPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgc3RyaW5nID0gU3RyaW5nKHRoaXMpO1xuICAgICAgICAgIGlmIChzZWFyY2ggJiYgdG9TdHJpbmcuY2FsbChzZWFyY2gpID09ICdbb2JqZWN0IFJlZ0V4cF0nKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBzdHJpbmdMZW5ndGggPSBzdHJpbmcubGVuZ3RoO1xuICAgICAgICAgIHZhciBzZWFyY2hTdHJpbmcgPSBTdHJpbmcoc2VhcmNoKTtcbiAgICAgICAgICB2YXIgc2VhcmNoTGVuZ3RoID0gc2VhcmNoU3RyaW5nLmxlbmd0aDtcbiAgICAgICAgICB2YXIgcG9zaXRpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZDtcbiAgICAgICAgICAvLyBgVG9JbnRlZ2VyYFxuICAgICAgICAgIHZhciBwb3MgPSBwb3NpdGlvbiA/IE51bWJlcihwb3NpdGlvbikgOiAwO1xuICAgICAgICAgIGlmIChwb3MgIT0gcG9zKSB7XG4gICAgICAgICAgICAvLyBiZXR0ZXIgYGlzTmFOYFxuICAgICAgICAgICAgcG9zID0gMDtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIHN0YXJ0ID0gTWF0aC5taW4oTWF0aC5tYXgocG9zLCAwKSwgc3RyaW5nTGVuZ3RoKTtcbiAgICAgICAgICAvLyBBdm9pZCB0aGUgYGluZGV4T2ZgIGNhbGwgaWYgbm8gbWF0Y2ggaXMgcG9zc2libGVcbiAgICAgICAgICBpZiAoc2VhcmNoTGVuZ3RoICsgc3RhcnQgPiBzdHJpbmdMZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGluZGV4ID0gLTE7XG4gICAgICAgICAgd2hpbGUgKCsraW5kZXggPCBzZWFyY2hMZW5ndGgpIHtcbiAgICAgICAgICAgIGlmIChzdHJpbmcuY2hhckNvZGVBdChzdGFydCArIGluZGV4KSAhPSBzZWFyY2hTdHJpbmcuY2hhckNvZGVBdChpbmRleCkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKGRlZmluZVByb3BlcnR5KSB7XG4gICAgICAgICAgZGVmaW5lUHJvcGVydHkoU3RyaW5nLnByb3RvdHlwZSwgJ3N0YXJ0c1dpdGgnLCB7XG4gICAgICAgICAgICAndmFsdWUnOiBzdGFydHNXaXRoLFxuICAgICAgICAgICAgJ2NvbmZpZ3VyYWJsZSc6IHRydWUsXG4gICAgICAgICAgICAnd3JpdGFibGUnOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgU3RyaW5nLnByb3RvdHlwZS5zdGFydHNXaXRoID0gc3RhcnRzV2l0aDtcbiAgICAgICAgfVxuICAgICAgfSkoKTtcbiAgICB9XG5cbiAgICBpZiAoIU9iamVjdC5rZXlzKSB7XG4gICAgICBPYmplY3Qua2V5cyA9IGZ1bmN0aW9uIChvLCAvLyBvYmplY3RcbiAgICAgIGssIC8vIGtleVxuICAgICAgciAvLyByZXN1bHQgYXJyYXlcbiAgICAgICkge1xuICAgICAgICAvLyBpbml0aWFsaXplIG9iamVjdCBhbmQgcmVzdWx0XG4gICAgICAgIHIgPSBbXTtcbiAgICAgICAgLy8gaXRlcmF0ZSBvdmVyIG9iamVjdCBrZXlzXG4gICAgICAgIGZvciAoayBpbiBvKVxuICAgICAgICAvLyBmaWxsIHJlc3VsdCBhcnJheSB3aXRoIG5vbi1wcm90b3R5cGljYWwga2V5c1xuICAgICAgICByLmhhc093blByb3BlcnR5LmNhbGwobywgaykgJiYgci5wdXNoKGspO1xuICAgICAgICAvLyByZXR1cm4gcmVzdWx0XG4gICAgICAgIHJldHVybiByO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBzZXQgZGF0YS1zZWxlY3RlZCBvbiBzZWxlY3QgZWxlbWVudCBpZiB0aGUgdmFsdWUgaGFzIGJlZW4gcHJvZ3JhbW1hdGljYWxseSBzZWxlY3RlZFxuICAgIC8vIHByaW9yIHRvIGluaXRpYWxpemF0aW9uIG9mIGJvb3RzdHJhcC1zZWxlY3RcbiAgICAvLyAqIGNvbnNpZGVyIHJlbW92aW5nIG9yIHJlcGxhY2luZyBhbiBhbHRlcm5hdGl2ZSBtZXRob2QgKlxuICAgIHZhciB2YWxIb29rcyA9IHtcbiAgICAgIHVzZURlZmF1bHQ6IGZhbHNlLFxuICAgICAgX3NldDogJC52YWxIb29rcy5zZWxlY3Quc2V0XG4gICAgfTtcblxuICAgICQudmFsSG9va3Muc2VsZWN0LnNldCA9IGZ1bmN0aW9uIChlbGVtLCB2YWx1ZSkge1xuICAgICAgaWYgKHZhbHVlICYmICF2YWxIb29rcy51c2VEZWZhdWx0KSAkKGVsZW0pLmRhdGEoJ3NlbGVjdGVkJywgdHJ1ZSk7XG5cbiAgICAgIHJldHVybiB2YWxIb29rcy5fc2V0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfTtcblxuICAgIHZhciBjaGFuZ2VkX2FyZ3VtZW50cyA9IG51bGw7XG4gICAgJC5mbi50cmlnZ2VyTmF0aXZlID0gZnVuY3Rpb24gKGV2ZW50TmFtZSkge1xuICAgICAgdmFyIGVsID0gdGhpc1swXSxcbiAgICAgICAgICBldmVudDtcblxuICAgICAgaWYgKGVsLmRpc3BhdGNoRXZlbnQpIHtcbiAgICAgICAgLy8gZm9yIG1vZGVybiBicm93c2VycyAmIElFOStcbiAgICAgICAgaWYgKHR5cGVvZiBFdmVudCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIC8vIEZvciBtb2Rlcm4gYnJvd3NlcnNcbiAgICAgICAgICBldmVudCA9IG5ldyBFdmVudChldmVudE5hbWUsIHtcbiAgICAgICAgICAgIGJ1YmJsZXM6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBGb3IgSUUgc2luY2UgaXQgZG9lc24ndCBzdXBwb3J0IEV2ZW50IGNvbnN0cnVjdG9yXG4gICAgICAgICAgZXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnRXZlbnQnKTtcbiAgICAgICAgICBldmVudC5pbml0RXZlbnQoZXZlbnROYW1lLCB0cnVlLCBmYWxzZSk7XG4gICAgICAgIH1cblxuICAgICAgICBlbC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgICAgIH0gZWxzZSBpZiAoZWwuZmlyZUV2ZW50KSB7XG4gICAgICAgIC8vIGZvciBJRThcbiAgICAgICAgZXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudE9iamVjdCgpO1xuICAgICAgICBldmVudC5ldmVudFR5cGUgPSBldmVudE5hbWU7XG4gICAgICAgIGVsLmZpcmVFdmVudCgnb24nICsgZXZlbnROYW1lLCBldmVudCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBmYWxsIGJhY2sgdG8galF1ZXJ5LnRyaWdnZXJcbiAgICAgICAgdGhpcy50cmlnZ2VyKGV2ZW50TmFtZSk7XG4gICAgICB9XG4gICAgfTtcbiAgICAvLzwvZWRpdG9yLWZvbGQ+XG5cbiAgICAvLyBDYXNlIGluc2Vuc2l0aXZlIGNvbnRhaW5zIHNlYXJjaFxuICAgICQuZXhwci5wc2V1ZG9zLmljb250YWlucyA9IGZ1bmN0aW9uIChvYmosIGluZGV4LCBtZXRhKSB7XG4gICAgICB2YXIgJG9iaiA9ICQob2JqKTtcbiAgICAgIHZhciBoYXlzdGFjayA9ICgkb2JqLmRhdGEoJ3Rva2VucycpIHx8ICRvYmoudGV4dCgpKS50b1N0cmluZygpLnRvVXBwZXJDYXNlKCk7XG4gICAgICByZXR1cm4gaGF5c3RhY2suaW5jbHVkZXMobWV0YVszXS50b1VwcGVyQ2FzZSgpKTtcbiAgICB9O1xuXG4gICAgLy8gQ2FzZSBpbnNlbnNpdGl2ZSBiZWdpbnMgc2VhcmNoXG4gICAgJC5leHByLnBzZXVkb3MuaWJlZ2lucyA9IGZ1bmN0aW9uIChvYmosIGluZGV4LCBtZXRhKSB7XG4gICAgICB2YXIgJG9iaiA9ICQob2JqKTtcbiAgICAgIHZhciBoYXlzdGFjayA9ICgkb2JqLmRhdGEoJ3Rva2VucycpIHx8ICRvYmoudGV4dCgpKS50b1N0cmluZygpLnRvVXBwZXJDYXNlKCk7XG4gICAgICByZXR1cm4gaGF5c3RhY2suc3RhcnRzV2l0aChtZXRhWzNdLnRvVXBwZXJDYXNlKCkpO1xuICAgIH07XG5cbiAgICAvLyBDYXNlIGFuZCBhY2NlbnQgaW5zZW5zaXRpdmUgY29udGFpbnMgc2VhcmNoXG4gICAgJC5leHByLnBzZXVkb3MuYWljb250YWlucyA9IGZ1bmN0aW9uIChvYmosIGluZGV4LCBtZXRhKSB7XG4gICAgICB2YXIgJG9iaiA9ICQob2JqKTtcbiAgICAgIHZhciBoYXlzdGFjayA9ICgkb2JqLmRhdGEoJ3Rva2VucycpIHx8ICRvYmouZGF0YSgnbm9ybWFsaXplZFRleHQnKSB8fCAkb2JqLnRleHQoKSkudG9TdHJpbmcoKS50b1VwcGVyQ2FzZSgpO1xuICAgICAgcmV0dXJuIGhheXN0YWNrLmluY2x1ZGVzKG1ldGFbM10udG9VcHBlckNhc2UoKSk7XG4gICAgfTtcblxuICAgIC8vIENhc2UgYW5kIGFjY2VudCBpbnNlbnNpdGl2ZSBiZWdpbnMgc2VhcmNoXG4gICAgJC5leHByLnBzZXVkb3MuYWliZWdpbnMgPSBmdW5jdGlvbiAob2JqLCBpbmRleCwgbWV0YSkge1xuICAgICAgdmFyICRvYmogPSAkKG9iaik7XG4gICAgICB2YXIgaGF5c3RhY2sgPSAoJG9iai5kYXRhKCd0b2tlbnMnKSB8fCAkb2JqLmRhdGEoJ25vcm1hbGl6ZWRUZXh0JykgfHwgJG9iai50ZXh0KCkpLnRvU3RyaW5nKCkudG9VcHBlckNhc2UoKTtcbiAgICAgIHJldHVybiBoYXlzdGFjay5zdGFydHNXaXRoKG1ldGFbM10udG9VcHBlckNhc2UoKSk7XG4gICAgfTtcblxuICAgIC8qKlxyXG4gICAgICogUmVtb3ZlIGFsbCBkaWF0cmljcyBmcm9tIHRoZSBnaXZlbiB0ZXh0LlxyXG4gICAgICogQGFjY2VzcyBwcml2YXRlXHJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdGV4dFxyXG4gICAgICogQHJldHVybnMge1N0cmluZ31cclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG5vcm1hbGl6ZVRvQmFzZSh0ZXh0KSB7XG4gICAgICB2YXIgckV4cHMgPSBbeyByZTogL1tcXHhDMC1cXHhDNl0vZywgY2g6IFwiQVwiIH0sIHsgcmU6IC9bXFx4RTAtXFx4RTZdL2csIGNoOiBcImFcIiB9LCB7IHJlOiAvW1xceEM4LVxceENCXS9nLCBjaDogXCJFXCIgfSwgeyByZTogL1tcXHhFOC1cXHhFQl0vZywgY2g6IFwiZVwiIH0sIHsgcmU6IC9bXFx4Q0MtXFx4Q0ZdL2csIGNoOiBcIklcIiB9LCB7IHJlOiAvW1xceEVDLVxceEVGXS9nLCBjaDogXCJpXCIgfSwgeyByZTogL1tcXHhEMi1cXHhENl0vZywgY2g6IFwiT1wiIH0sIHsgcmU6IC9bXFx4RjItXFx4RjZdL2csIGNoOiBcIm9cIiB9LCB7IHJlOiAvW1xceEQ5LVxceERDXS9nLCBjaDogXCJVXCIgfSwgeyByZTogL1tcXHhGOS1cXHhGQ10vZywgY2g6IFwidVwiIH0sIHsgcmU6IC9bXFx4QzctXFx4RTddL2csIGNoOiBcImNcIiB9LCB7IHJlOiAvW1xceEQxXS9nLCBjaDogXCJOXCIgfSwgeyByZTogL1tcXHhGMV0vZywgY2g6IFwiblwiIH1dO1xuICAgICAgJC5lYWNoKHJFeHBzLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UodGhpcy5yZSwgdGhpcy5jaCk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiB0ZXh0O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGh0bWxFc2NhcGUoaHRtbCkge1xuICAgICAgdmFyIGVzY2FwZU1hcCA9IHtcbiAgICAgICAgJyYnOiAnJmFtcDsnLFxuICAgICAgICAnPCc6ICcmbHQ7JyxcbiAgICAgICAgJz4nOiAnJmd0OycsXG4gICAgICAgICdcIic6ICcmcXVvdDsnLFxuICAgICAgICBcIidcIjogJyYjeDI3OycsXG4gICAgICAgICdgJzogJyYjeDYwOydcbiAgICAgIH07XG4gICAgICB2YXIgc291cmNlID0gJyg/OicgKyBPYmplY3Qua2V5cyhlc2NhcGVNYXApLmpvaW4oJ3wnKSArICcpJyxcbiAgICAgICAgICB0ZXN0UmVnZXhwID0gbmV3IFJlZ0V4cChzb3VyY2UpLFxuICAgICAgICAgIHJlcGxhY2VSZWdleHAgPSBuZXcgUmVnRXhwKHNvdXJjZSwgJ2cnKSxcbiAgICAgICAgICBzdHJpbmcgPSBodG1sID09IG51bGwgPyAnJyA6ICcnICsgaHRtbDtcbiAgICAgIHJldHVybiB0ZXN0UmVnZXhwLnRlc3Qoc3RyaW5nKSA/IHN0cmluZy5yZXBsYWNlKHJlcGxhY2VSZWdleHAsIGZ1bmN0aW9uIChtYXRjaCkge1xuICAgICAgICByZXR1cm4gZXNjYXBlTWFwW21hdGNoXTtcbiAgICAgIH0pIDogc3RyaW5nO1xuICAgIH1cblxuICAgIHZhciBTZWxlY3RwaWNrZXIgPSBmdW5jdGlvbiAoZWxlbWVudCwgb3B0aW9ucywgZSkge1xuICAgICAgLy8gYm9vdHN0cmFwLXNlbGVjdCBoYXMgYmVlbiBpbml0aWFsaXplZCAtIHJldmVydCB2YWxIb29rcy5zZWxlY3Quc2V0IGJhY2sgdG8gaXRzIG9yaWdpbmFsIGZ1bmN0aW9uXG4gICAgICBpZiAoIXZhbEhvb2tzLnVzZURlZmF1bHQpIHtcbiAgICAgICAgJC52YWxIb29rcy5zZWxlY3Quc2V0ID0gdmFsSG9va3MuX3NldDtcbiAgICAgICAgdmFsSG9va3MudXNlRGVmYXVsdCA9IHRydWU7XG4gICAgICB9XG5cbiAgICAgIGlmIChlKSB7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy4kZWxlbWVudCA9ICQoZWxlbWVudCk7XG4gICAgICB0aGlzLiRuZXdFbGVtZW50ID0gbnVsbDtcbiAgICAgIHRoaXMuJGJ1dHRvbiA9IG51bGw7XG4gICAgICB0aGlzLiRtZW51ID0gbnVsbDtcbiAgICAgIHRoaXMuJGxpcyA9IG51bGw7XG4gICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuXG4gICAgICAvLyBJZiB3ZSBoYXZlIG5vIHRpdGxlIHlldCwgdHJ5IHRvIHB1bGwgaXQgZnJvbSB0aGUgaHRtbCB0aXRsZSBhdHRyaWJ1dGUgKGpRdWVyeSBkb2VzbnQnIHBpY2sgaXQgdXAgYXMgaXQncyBub3QgYVxuICAgICAgLy8gZGF0YS1hdHRyaWJ1dGUpXG4gICAgICBpZiAodGhpcy5vcHRpb25zLnRpdGxlID09PSBudWxsKSB7XG4gICAgICAgIHRoaXMub3B0aW9ucy50aXRsZSA9IHRoaXMuJGVsZW1lbnQuYXR0cigndGl0bGUnKTtcbiAgICAgIH1cblxuICAgICAgLy9FeHBvc2UgcHVibGljIG1ldGhvZHNcbiAgICAgIHRoaXMudmFsID0gU2VsZWN0cGlja2VyLnByb3RvdHlwZS52YWw7XG4gICAgICB0aGlzLnJlbmRlciA9IFNlbGVjdHBpY2tlci5wcm90b3R5cGUucmVuZGVyO1xuICAgICAgdGhpcy5yZWZyZXNoID0gU2VsZWN0cGlja2VyLnByb3RvdHlwZS5yZWZyZXNoO1xuICAgICAgdGhpcy5zZXRTdHlsZSA9IFNlbGVjdHBpY2tlci5wcm90b3R5cGUuc2V0U3R5bGU7XG4gICAgICB0aGlzLnNlbGVjdEFsbCA9IFNlbGVjdHBpY2tlci5wcm90b3R5cGUuc2VsZWN0QWxsO1xuICAgICAgdGhpcy5kZXNlbGVjdEFsbCA9IFNlbGVjdHBpY2tlci5wcm90b3R5cGUuZGVzZWxlY3RBbGw7XG4gICAgICB0aGlzLmRlc3Ryb3kgPSBTZWxlY3RwaWNrZXIucHJvdG90eXBlLmRlc3Ryb3k7XG4gICAgICB0aGlzLnJlbW92ZSA9IFNlbGVjdHBpY2tlci5wcm90b3R5cGUucmVtb3ZlO1xuICAgICAgdGhpcy5zaG93ID0gU2VsZWN0cGlja2VyLnByb3RvdHlwZS5zaG93O1xuICAgICAgdGhpcy5oaWRlID0gU2VsZWN0cGlja2VyLnByb3RvdHlwZS5oaWRlO1xuXG4gICAgICB0aGlzLmluaXQoKTtcbiAgICB9O1xuXG4gICAgU2VsZWN0cGlja2VyLlZFUlNJT04gPSAnMS4xMS4yJztcblxuICAgIC8vIHBhcnQgb2YgdGhpcyBpcyBkdXBsaWNhdGVkIGluIGkxOG4vZGVmYXVsdHMtZW5fVVMuanMuIE1ha2Ugc3VyZSB0byB1cGRhdGUgYm90aC5cbiAgICBTZWxlY3RwaWNrZXIuREVGQVVMVFMgPSB7XG4gICAgICBub25lU2VsZWN0ZWRUZXh0OiAnTm90aGluZyBzZWxlY3RlZCcsXG4gICAgICBub25lUmVzdWx0c1RleHQ6ICdObyByZXN1bHRzIG1hdGNoZWQgezB9JyxcbiAgICAgIGNvdW50U2VsZWN0ZWRUZXh0OiBmdW5jdGlvbiAobnVtU2VsZWN0ZWQsIG51bVRvdGFsKSB7XG4gICAgICAgIHJldHVybiBudW1TZWxlY3RlZCA9PSAxID8gXCJ7MH0gaXRlbSBzZWxlY3RlZFwiIDogXCJ7MH0gaXRlbXMgc2VsZWN0ZWRcIjtcbiAgICAgIH0sXG4gICAgICBtYXhPcHRpb25zVGV4dDogZnVuY3Rpb24gKG51bUFsbCwgbnVtR3JvdXApIHtcbiAgICAgICAgcmV0dXJuIFtudW1BbGwgPT0gMSA/ICdMaW1pdCByZWFjaGVkICh7bn0gaXRlbSBtYXgpJyA6ICdMaW1pdCByZWFjaGVkICh7bn0gaXRlbXMgbWF4KScsIG51bUdyb3VwID09IDEgPyAnR3JvdXAgbGltaXQgcmVhY2hlZCAoe259IGl0ZW0gbWF4KScgOiAnR3JvdXAgbGltaXQgcmVhY2hlZCAoe259IGl0ZW1zIG1heCknXTtcbiAgICAgIH0sXG4gICAgICBzZWxlY3RBbGxUZXh0OiAnU2VsZWN0IEFsbCcsXG4gICAgICBkZXNlbGVjdEFsbFRleHQ6ICdEZXNlbGVjdCBBbGwnLFxuICAgICAgZG9uZUJ1dHRvbjogZmFsc2UsXG4gICAgICBkb25lQnV0dG9uVGV4dDogJ0Nsb3NlJyxcbiAgICAgIG11bHRpcGxlU2VwYXJhdG9yOiAnLCAnLFxuICAgICAgc3R5bGVCYXNlOiAnYnRuJyxcbiAgICAgIHN0eWxlOiAnYnRuLWRlZmF1bHQnLFxuICAgICAgc2l6ZTogJ2F1dG8nLFxuICAgICAgdGl0bGU6IG51bGwsXG4gICAgICBzZWxlY3RlZFRleHRGb3JtYXQ6ICd2YWx1ZXMnLFxuICAgICAgd2lkdGg6IGZhbHNlLFxuICAgICAgY29udGFpbmVyOiBmYWxzZSxcbiAgICAgIGhpZGVEaXNhYmxlZDogZmFsc2UsXG4gICAgICBzaG93U3VidGV4dDogZmFsc2UsXG4gICAgICBzaG93SWNvbjogdHJ1ZSxcbiAgICAgIHNob3dDb250ZW50OiB0cnVlLFxuICAgICAgZHJvcHVwQXV0bzogdHJ1ZSxcbiAgICAgIGhlYWRlcjogZmFsc2UsXG4gICAgICBsaXZlU2VhcmNoOiBmYWxzZSxcbiAgICAgIGxpdmVTZWFyY2hQbGFjZWhvbGRlcjogbnVsbCxcbiAgICAgIGxpdmVTZWFyY2hOb3JtYWxpemU6IGZhbHNlLFxuICAgICAgbGl2ZVNlYXJjaFN0eWxlOiAnY29udGFpbnMnLFxuICAgICAgYWN0aW9uc0JveDogZmFsc2UsXG4gICAgICBpY29uQmFzZTogJ2dseXBoaWNvbicsXG4gICAgICB0aWNrSWNvbjogJ2dseXBoaWNvbi1vaycsXG4gICAgICBzaG93VGljazogZmFsc2UsXG4gICAgICB0ZW1wbGF0ZToge1xuICAgICAgICBjYXJldDogJzxzcGFuIGNsYXNzPVwiY2FyZXRcIj48L3NwYW4+J1xuICAgICAgfSxcbiAgICAgIG1heE9wdGlvbnM6IGZhbHNlLFxuICAgICAgbW9iaWxlOiBmYWxzZSxcbiAgICAgIHNlbGVjdE9uVGFiOiBmYWxzZSxcbiAgICAgIGRyb3Bkb3duQWxpZ25SaWdodDogZmFsc2VcbiAgICB9O1xuXG4gICAgU2VsZWN0cGlja2VyLnByb3RvdHlwZSA9IHtcblxuICAgICAgY29uc3RydWN0b3I6IFNlbGVjdHBpY2tlcixcblxuICAgICAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXMsXG4gICAgICAgICAgICBpZCA9IHRoaXMuJGVsZW1lbnQuYXR0cignaWQnKTtcblxuICAgICAgICB0aGlzLiRlbGVtZW50LmFkZENsYXNzKCdicy1zZWxlY3QtaGlkZGVuJyk7XG5cbiAgICAgICAgLy8gc3RvcmUgb3JpZ2luYWxJbmRleCAoa2V5KSBhbmQgbmV3SW5kZXggKHZhbHVlKSBpbiB0aGlzLmxpT2JqIGZvciBmYXN0IGFjY2Vzc2liaWxpdHlcbiAgICAgICAgLy8gYWxsb3dzIHVzIHRvIGRvIHRoaXMuJGxpcy5lcSh0aGF0LmxpT2JqW2luZGV4XSkgaW5zdGVhZCBvZiB0aGlzLiRsaXMuZmlsdGVyKCdbZGF0YS1vcmlnaW5hbC1pbmRleD1cIicgKyBpbmRleCArICdcIl0nKVxuICAgICAgICB0aGlzLmxpT2JqID0ge307XG4gICAgICAgIHRoaXMubXVsdGlwbGUgPSB0aGlzLiRlbGVtZW50LnByb3AoJ211bHRpcGxlJyk7XG4gICAgICAgIHRoaXMuYXV0b2ZvY3VzID0gdGhpcy4kZWxlbWVudC5wcm9wKCdhdXRvZm9jdXMnKTtcbiAgICAgICAgdGhpcy4kbmV3RWxlbWVudCA9IHRoaXMuY3JlYXRlVmlldygpO1xuICAgICAgICB0aGlzLiRlbGVtZW50LmFmdGVyKHRoaXMuJG5ld0VsZW1lbnQpLmFwcGVuZFRvKHRoaXMuJG5ld0VsZW1lbnQpO1xuICAgICAgICB0aGlzLiRidXR0b24gPSB0aGlzLiRuZXdFbGVtZW50LmNoaWxkcmVuKCdidXR0b24nKTtcbiAgICAgICAgdGhpcy4kbWVudSA9IHRoaXMuJG5ld0VsZW1lbnQuY2hpbGRyZW4oJy5kcm9wZG93bi1tZW51Jyk7XG4gICAgICAgIHRoaXMuJG1lbnVJbm5lciA9IHRoaXMuJG1lbnUuY2hpbGRyZW4oJy5pbm5lcicpO1xuICAgICAgICB0aGlzLiRzZWFyY2hib3ggPSB0aGlzLiRtZW51LmZpbmQoJ2lucHV0Jyk7XG5cbiAgICAgICAgdGhpcy4kZWxlbWVudC5yZW1vdmVDbGFzcygnYnMtc2VsZWN0LWhpZGRlbicpO1xuXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZHJvcGRvd25BbGlnblJpZ2h0ID09PSB0cnVlKSB0aGlzLiRtZW51LmFkZENsYXNzKCdkcm9wZG93bi1tZW51LXJpZ2h0Jyk7XG5cbiAgICAgICAgaWYgKHR5cGVvZiBpZCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICB0aGlzLiRidXR0b24uYXR0cignZGF0YS1pZCcsIGlkKTtcbiAgICAgICAgICAkKCdsYWJlbFtmb3I9XCInICsgaWQgKyAnXCJdJykuY2xpY2soZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHRoYXQuJGJ1dHRvbi5mb2N1cygpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5jaGVja0Rpc2FibGVkKCk7XG4gICAgICAgIHRoaXMuY2xpY2tMaXN0ZW5lcigpO1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmxpdmVTZWFyY2gpIHRoaXMubGl2ZVNlYXJjaExpc3RlbmVyKCk7XG4gICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgIHRoaXMuc2V0U3R5bGUoKTtcbiAgICAgICAgdGhpcy5zZXRXaWR0aCgpO1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmNvbnRhaW5lcikgdGhpcy5zZWxlY3RQb3NpdGlvbigpO1xuICAgICAgICB0aGlzLiRtZW51LmRhdGEoJ3RoaXMnLCB0aGlzKTtcbiAgICAgICAgdGhpcy4kbmV3RWxlbWVudC5kYXRhKCd0aGlzJywgdGhpcyk7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMubW9iaWxlKSB0aGlzLm1vYmlsZSgpO1xuXG4gICAgICAgIHRoaXMuJG5ld0VsZW1lbnQub24oe1xuICAgICAgICAgICdoaWRlLmJzLmRyb3Bkb3duJzogZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHRoYXQuJG1lbnVJbm5lci5hdHRyKCdhcmlhLWV4cGFuZGVkJywgZmFsc2UpO1xuICAgICAgICAgICAgdGhhdC4kZWxlbWVudC50cmlnZ2VyKCdoaWRlLmJzLnNlbGVjdCcsIGUpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgJ2hpZGRlbi5icy5kcm9wZG93bic6IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICB0aGF0LiRlbGVtZW50LnRyaWdnZXIoJ2hpZGRlbi5icy5zZWxlY3QnLCBlKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgICdzaG93LmJzLmRyb3Bkb3duJzogZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHRoYXQuJG1lbnVJbm5lci5hdHRyKCdhcmlhLWV4cGFuZGVkJywgdHJ1ZSk7XG4gICAgICAgICAgICB0aGF0LiRlbGVtZW50LnRyaWdnZXIoJ3Nob3cuYnMuc2VsZWN0JywgZSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICAnc2hvd24uYnMuZHJvcGRvd24nOiBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgdGhhdC4kZWxlbWVudC50cmlnZ2VyKCdzaG93bi5icy5zZWxlY3QnLCBlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICh0aGF0LiRlbGVtZW50WzBdLmhhc0F0dHJpYnV0ZSgncmVxdWlyZWQnKSkge1xuICAgICAgICAgIHRoaXMuJGVsZW1lbnQub24oJ2ludmFsaWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGF0LiRidXR0b24uYWRkQ2xhc3MoJ2JzLWludmFsaWQnKS5mb2N1cygpO1xuXG4gICAgICAgICAgICB0aGF0LiRlbGVtZW50Lm9uKHtcbiAgICAgICAgICAgICAgJ2ZvY3VzLmJzLnNlbGVjdCc6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB0aGF0LiRidXR0b24uZm9jdXMoKTtcbiAgICAgICAgICAgICAgICB0aGF0LiRlbGVtZW50Lm9mZignZm9jdXMuYnMuc2VsZWN0Jyk7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICdzaG93bi5icy5zZWxlY3QnOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhhdC4kZWxlbWVudC52YWwodGhhdC4kZWxlbWVudC52YWwoKSkgLy8gc2V0IHRoZSB2YWx1ZSB0byBoaWRlIHRoZSB2YWxpZGF0aW9uIG1lc3NhZ2UgaW4gQ2hyb21lIHdoZW4gbWVudSBpcyBvcGVuZWRcbiAgICAgICAgICAgICAgICAub2ZmKCdzaG93bi5icy5zZWxlY3QnKTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgJ3JlbmRlcmVkLmJzLnNlbGVjdCc6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAvLyBpZiBzZWxlY3QgaXMgbm8gbG9uZ2VyIGludmFsaWQsIHJlbW92ZSB0aGUgYnMtaW52YWxpZCBjbGFzc1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnZhbGlkaXR5LnZhbGlkKSB0aGF0LiRidXR0b24ucmVtb3ZlQ2xhc3MoJ2JzLWludmFsaWQnKTtcbiAgICAgICAgICAgICAgICB0aGF0LiRlbGVtZW50Lm9mZigncmVuZGVyZWQuYnMuc2VsZWN0Jyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdGhhdC4kZWxlbWVudC50cmlnZ2VyKCdsb2FkZWQuYnMuc2VsZWN0Jyk7XG4gICAgICAgIH0pO1xuICAgICAgfSxcblxuICAgICAgY3JlYXRlRHJvcGRvd246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gT3B0aW9uc1xuICAgICAgICAvLyBJZiB3ZSBhcmUgbXVsdGlwbGUgb3Igc2hvd1RpY2sgb3B0aW9uIGlzIHNldCwgdGhlbiBhZGQgdGhlIHNob3ctdGljayBjbGFzc1xuICAgICAgICB2YXIgc2hvd1RpY2sgPSB0aGlzLm11bHRpcGxlIHx8IHRoaXMub3B0aW9ucy5zaG93VGljayA/ICcgc2hvdy10aWNrJyA6ICcnLFxuICAgICAgICAgICAgaW5wdXRHcm91cCA9IHRoaXMuJGVsZW1lbnQucGFyZW50KCkuaGFzQ2xhc3MoJ2lucHV0LWdyb3VwJykgPyAnIGlucHV0LWdyb3VwLWJ0bicgOiAnJyxcbiAgICAgICAgICAgIGF1dG9mb2N1cyA9IHRoaXMuYXV0b2ZvY3VzID8gJyBhdXRvZm9jdXMnIDogJyc7XG4gICAgICAgIC8vIEVsZW1lbnRzXG4gICAgICAgIHZhciBoZWFkZXIgPSB0aGlzLm9wdGlvbnMuaGVhZGVyID8gJzxkaXYgY2xhc3M9XCJwb3BvdmVyLXRpdGxlXCI+PGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJjbG9zZVwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPiZ0aW1lczs8L2J1dHRvbj4nICsgdGhpcy5vcHRpb25zLmhlYWRlciArICc8L2Rpdj4nIDogJyc7XG4gICAgICAgIHZhciBzZWFyY2hib3ggPSB0aGlzLm9wdGlvbnMubGl2ZVNlYXJjaCA/ICc8ZGl2IGNsYXNzPVwiYnMtc2VhcmNoYm94XCI+JyArICc8aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cImZvcm0tY29udHJvbFwiIGF1dG9jb21wbGV0ZT1cIm9mZlwiJyArIChudWxsID09PSB0aGlzLm9wdGlvbnMubGl2ZVNlYXJjaFBsYWNlaG9sZGVyID8gJycgOiAnIHBsYWNlaG9sZGVyPVwiJyArIGh0bWxFc2NhcGUodGhpcy5vcHRpb25zLmxpdmVTZWFyY2hQbGFjZWhvbGRlcikgKyAnXCInKSArICcgcm9sZT1cInRleHRib3hcIiBhcmlhLWxhYmVsPVwiU2VhcmNoXCI+JyArICc8L2Rpdj4nIDogJyc7XG4gICAgICAgIHZhciBhY3Rpb25zYm94ID0gdGhpcy5tdWx0aXBsZSAmJiB0aGlzLm9wdGlvbnMuYWN0aW9uc0JveCA/ICc8ZGl2IGNsYXNzPVwiYnMtYWN0aW9uc2JveFwiPicgKyAnPGRpdiBjbGFzcz1cImJ0bi1ncm91cCBidG4tZ3JvdXAtc20gYnRuLWJsb2NrXCI+JyArICc8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImFjdGlvbnMtYnRuIGJzLXNlbGVjdC1hbGwgYnRuIGJ0bi1kZWZhdWx0XCI+JyArIHRoaXMub3B0aW9ucy5zZWxlY3RBbGxUZXh0ICsgJzwvYnV0dG9uPicgKyAnPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJhY3Rpb25zLWJ0biBicy1kZXNlbGVjdC1hbGwgYnRuIGJ0bi1kZWZhdWx0XCI+JyArIHRoaXMub3B0aW9ucy5kZXNlbGVjdEFsbFRleHQgKyAnPC9idXR0b24+JyArICc8L2Rpdj4nICsgJzwvZGl2PicgOiAnJztcbiAgICAgICAgdmFyIGRvbmVidXR0b24gPSB0aGlzLm11bHRpcGxlICYmIHRoaXMub3B0aW9ucy5kb25lQnV0dG9uID8gJzxkaXYgY2xhc3M9XCJicy1kb25lYnV0dG9uXCI+JyArICc8ZGl2IGNsYXNzPVwiYnRuLWdyb3VwIGJ0bi1ibG9ja1wiPicgKyAnPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLXNtIGJ0bi1kZWZhdWx0XCI+JyArIHRoaXMub3B0aW9ucy5kb25lQnV0dG9uVGV4dCArICc8L2J1dHRvbj4nICsgJzwvZGl2PicgKyAnPC9kaXY+JyA6ICcnO1xuICAgICAgICB2YXIgZHJvcCA9ICc8ZGl2IGNsYXNzPVwiYnRuLWdyb3VwIGJvb3RzdHJhcC1zZWxlY3QnICsgc2hvd1RpY2sgKyBpbnB1dEdyb3VwICsgJ1wiPicgKyAnPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCInICsgdGhpcy5vcHRpb25zLnN0eWxlQmFzZSArICcgZHJvcGRvd24tdG9nZ2xlXCIgZGF0YS10b2dnbGU9XCJkcm9wZG93blwiJyArIGF1dG9mb2N1cyArICcgcm9sZT1cImJ1dHRvblwiPicgKyAnPHNwYW4gY2xhc3M9XCJmaWx0ZXItb3B0aW9uIHB1bGwtbGVmdFwiPjwvc3Bhbj4mbmJzcDsnICsgJzxzcGFuIGNsYXNzPVwiYnMtY2FyZXRcIj4nICsgdGhpcy5vcHRpb25zLnRlbXBsYXRlLmNhcmV0ICsgJzwvc3Bhbj4nICsgJzwvYnV0dG9uPicgKyAnPGRpdiBjbGFzcz1cImRyb3Bkb3duLW1lbnUgb3BlblwiIHJvbGU9XCJjb21ib2JveFwiPicgKyBoZWFkZXIgKyBzZWFyY2hib3ggKyBhY3Rpb25zYm94ICsgJzx1bCBjbGFzcz1cImRyb3Bkb3duLW1lbnUgaW5uZXJcIiByb2xlPVwibGlzdGJveFwiIGFyaWEtZXhwYW5kZWQ9XCJmYWxzZVwiPicgKyAnPC91bD4nICsgZG9uZWJ1dHRvbiArICc8L2Rpdj4nICsgJzwvZGl2Pic7XG5cbiAgICAgICAgcmV0dXJuICQoZHJvcCk7XG4gICAgICB9LFxuXG4gICAgICBjcmVhdGVWaWV3OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciAkZHJvcCA9IHRoaXMuY3JlYXRlRHJvcGRvd24oKSxcbiAgICAgICAgICAgIGxpID0gdGhpcy5jcmVhdGVMaSgpO1xuXG4gICAgICAgICRkcm9wLmZpbmQoJ3VsJylbMF0uaW5uZXJIVE1MID0gbGk7XG4gICAgICAgIHJldHVybiAkZHJvcDtcbiAgICAgIH0sXG5cbiAgICAgIHJlbG9hZExpOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vUmVtb3ZlIGFsbCBjaGlsZHJlbi5cbiAgICAgICAgdGhpcy5kZXN0cm95TGkoKTtcbiAgICAgICAgLy9SZSBidWlsZFxuICAgICAgICB2YXIgbGkgPSB0aGlzLmNyZWF0ZUxpKCk7XG4gICAgICAgIHRoaXMuJG1lbnVJbm5lclswXS5pbm5lckhUTUwgPSBsaTtcbiAgICAgIH0sXG5cbiAgICAgIGRlc3Ryb3lMaTogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLiRtZW51LmZpbmQoJ2xpJykucmVtb3ZlKCk7XG4gICAgICB9LFxuXG4gICAgICBjcmVhdGVMaTogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXMsXG4gICAgICAgICAgICBfbGkgPSBbXSxcbiAgICAgICAgICAgIG9wdElEID0gMCxcbiAgICAgICAgICAgIHRpdGxlT3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyksXG4gICAgICAgICAgICBsaUluZGV4ID0gLTE7IC8vIGluY3JlbWVudCBsaUluZGV4IHdoZW5ldmVyIGEgbmV3IDxsaT4gZWxlbWVudCBpcyBjcmVhdGVkIHRvIGVuc3VyZSBsaU9iaiBpcyBjb3JyZWN0XG5cbiAgICAgICAgLy8gSGVscGVyIGZ1bmN0aW9uc1xuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcGFyYW0gY29udGVudFxyXG4gICAgICAgICAqIEBwYXJhbSBbaW5kZXhdXHJcbiAgICAgICAgICogQHBhcmFtIFtjbGFzc2VzXVxyXG4gICAgICAgICAqIEBwYXJhbSBbb3B0Z3JvdXBdXHJcbiAgICAgICAgICogQHJldHVybnMge3N0cmluZ31cclxuICAgICAgICAgKi9cbiAgICAgICAgdmFyIGdlbmVyYXRlTEkgPSBmdW5jdGlvbiAoY29udGVudCwgaW5kZXgsIGNsYXNzZXMsIG9wdGdyb3VwKSB7XG4gICAgICAgICAgcmV0dXJuICc8bGknICsgKHR5cGVvZiBjbGFzc2VzICE9PSAndW5kZWZpbmVkJyAmICcnICE9PSBjbGFzc2VzID8gJyBjbGFzcz1cIicgKyBjbGFzc2VzICsgJ1wiJyA6ICcnKSArICh0eXBlb2YgaW5kZXggIT09ICd1bmRlZmluZWQnICYgbnVsbCAhPT0gaW5kZXggPyAnIGRhdGEtb3JpZ2luYWwtaW5kZXg9XCInICsgaW5kZXggKyAnXCInIDogJycpICsgKHR5cGVvZiBvcHRncm91cCAhPT0gJ3VuZGVmaW5lZCcgJiBudWxsICE9PSBvcHRncm91cCA/ICdkYXRhLW9wdGdyb3VwPVwiJyArIG9wdGdyb3VwICsgJ1wiJyA6ICcnKSArICc+JyArIGNvbnRlbnQgKyAnPC9saT4nO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBwYXJhbSB0ZXh0XHJcbiAgICAgICAgICogQHBhcmFtIFtjbGFzc2VzXVxyXG4gICAgICAgICAqIEBwYXJhbSBbaW5saW5lXVxyXG4gICAgICAgICAqIEBwYXJhbSBbdG9rZW5zXVxyXG4gICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAgICAgICAgICovXG4gICAgICAgIHZhciBnZW5lcmF0ZUEgPSBmdW5jdGlvbiAodGV4dCwgY2xhc3NlcywgaW5saW5lLCB0b2tlbnMpIHtcbiAgICAgICAgICByZXR1cm4gJzxhIHRhYmluZGV4PVwiMFwiJyArICh0eXBlb2YgY2xhc3NlcyAhPT0gJ3VuZGVmaW5lZCcgPyAnIGNsYXNzPVwiJyArIGNsYXNzZXMgKyAnXCInIDogJycpICsgKHR5cGVvZiBpbmxpbmUgIT09ICd1bmRlZmluZWQnID8gJyBzdHlsZT1cIicgKyBpbmxpbmUgKyAnXCInIDogJycpICsgKHRoYXQub3B0aW9ucy5saXZlU2VhcmNoTm9ybWFsaXplID8gJyBkYXRhLW5vcm1hbGl6ZWQtdGV4dD1cIicgKyBub3JtYWxpemVUb0Jhc2UoaHRtbEVzY2FwZSh0ZXh0KSkgKyAnXCInIDogJycpICsgKHR5cGVvZiB0b2tlbnMgIT09ICd1bmRlZmluZWQnIHx8IHRva2VucyAhPT0gbnVsbCA/ICcgZGF0YS10b2tlbnM9XCInICsgdG9rZW5zICsgJ1wiJyA6ICcnKSArICcgcm9sZT1cIm9wdGlvblwiPicgKyB0ZXh0ICsgJzxzcGFuIGNsYXNzPVwiJyArIHRoYXQub3B0aW9ucy5pY29uQmFzZSArICcgJyArIHRoYXQub3B0aW9ucy50aWNrSWNvbiArICcgY2hlY2stbWFya1wiPjwvc3Bhbj4nICsgJzwvYT4nO1xuICAgICAgICB9O1xuXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMudGl0bGUgJiYgIXRoaXMubXVsdGlwbGUpIHtcbiAgICAgICAgICAvLyB0aGlzIG9wdGlvbiBkb2Vzbid0IGNyZWF0ZSBhIG5ldyA8bGk+IGVsZW1lbnQsIGJ1dCBkb2VzIGFkZCBhIG5ldyBvcHRpb24sIHNvIGxpSW5kZXggaXMgZGVjcmVhc2VkXG4gICAgICAgICAgLy8gc2luY2UgbGlPYmogaXMgcmVjYWxjdWxhdGVkIG9uIGV2ZXJ5IHJlZnJlc2gsIGxpSW5kZXggbmVlZHMgdG8gYmUgZGVjcmVhc2VkIGV2ZW4gaWYgdGhlIHRpdGxlT3B0aW9uIGlzIGFscmVhZHkgYXBwZW5kZWRcbiAgICAgICAgICBsaUluZGV4LS07XG5cbiAgICAgICAgICBpZiAoIXRoaXMuJGVsZW1lbnQuZmluZCgnLmJzLXRpdGxlLW9wdGlvbicpLmxlbmd0aCkge1xuICAgICAgICAgICAgLy8gVXNlIG5hdGl2ZSBKUyB0byBwcmVwZW5kIG9wdGlvbiAoZmFzdGVyKVxuICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLiRlbGVtZW50WzBdO1xuICAgICAgICAgICAgdGl0bGVPcHRpb24uY2xhc3NOYW1lID0gJ2JzLXRpdGxlLW9wdGlvbic7XG4gICAgICAgICAgICB0aXRsZU9wdGlvbi5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0aGlzLm9wdGlvbnMudGl0bGUpKTtcbiAgICAgICAgICAgIHRpdGxlT3B0aW9uLnZhbHVlID0gJyc7XG4gICAgICAgICAgICBlbGVtZW50Lmluc2VydEJlZm9yZSh0aXRsZU9wdGlvbiwgZWxlbWVudC5maXJzdENoaWxkKTtcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHNlbGVjdGVkIG9yIGRhdGEtc2VsZWN0ZWQgYXR0cmlidXRlIGlzIGFscmVhZHkgc2V0IG9uIGFuIG9wdGlvbi4gSWYgbm90LCBzZWxlY3QgdGhlIHRpdGxlT3B0aW9uIG9wdGlvbi5cbiAgICAgICAgICAgIC8vIHRoZSBzZWxlY3RlZCBpdGVtIG1heSBoYXZlIGJlZW4gY2hhbmdlZCBieSB1c2VyIG9yIHByb2dyYW1tYXRpY2FsbHkgYmVmb3JlIHRoZSBib290c3RyYXAgc2VsZWN0IHBsdWdpbiBydW5zLFxuICAgICAgICAgICAgLy8gaWYgc28sIHRoZSBzZWxlY3Qgd2lsbCBoYXZlIHRoZSBkYXRhLXNlbGVjdGVkIGF0dHJpYnV0ZVxuICAgICAgICAgICAgdmFyICRvcHQgPSAkKGVsZW1lbnQub3B0aW9uc1tlbGVtZW50LnNlbGVjdGVkSW5kZXhdKTtcbiAgICAgICAgICAgIGlmICgkb3B0LmF0dHIoJ3NlbGVjdGVkJykgPT09IHVuZGVmaW5lZCAmJiB0aGlzLiRlbGVtZW50LmRhdGEoJ3NlbGVjdGVkJykgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICB0aXRsZU9wdGlvbi5zZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy4kZWxlbWVudC5maW5kKCdvcHRpb24nKS5lYWNoKGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgIHZhciAkdGhpcyA9ICQodGhpcyk7XG5cbiAgICAgICAgICBsaUluZGV4Kys7XG5cbiAgICAgICAgICBpZiAoJHRoaXMuaGFzQ2xhc3MoJ2JzLXRpdGxlLW9wdGlvbicpKSByZXR1cm47XG5cbiAgICAgICAgICAvLyBHZXQgdGhlIGNsYXNzIGFuZCB0ZXh0IGZvciB0aGUgb3B0aW9uXG4gICAgICAgICAgdmFyIG9wdGlvbkNsYXNzID0gdGhpcy5jbGFzc05hbWUgfHwgJycsXG4gICAgICAgICAgICAgIGlubGluZSA9IHRoaXMuc3R5bGUuY3NzVGV4dCxcbiAgICAgICAgICAgICAgdGV4dCA9ICR0aGlzLmRhdGEoJ2NvbnRlbnQnKSA/ICR0aGlzLmRhdGEoJ2NvbnRlbnQnKSA6ICR0aGlzLmh0bWwoKSxcbiAgICAgICAgICAgICAgdG9rZW5zID0gJHRoaXMuZGF0YSgndG9rZW5zJykgPyAkdGhpcy5kYXRhKCd0b2tlbnMnKSA6IG51bGwsXG4gICAgICAgICAgICAgIHN1YnRleHQgPSB0eXBlb2YgJHRoaXMuZGF0YSgnc3VidGV4dCcpICE9PSAndW5kZWZpbmVkJyA/ICc8c21hbGwgY2xhc3M9XCJ0ZXh0LW11dGVkXCI+JyArICR0aGlzLmRhdGEoJ3N1YnRleHQnKSArICc8L3NtYWxsPicgOiAnJyxcbiAgICAgICAgICAgICAgaWNvbiA9IHR5cGVvZiAkdGhpcy5kYXRhKCdpY29uJykgIT09ICd1bmRlZmluZWQnID8gJzxzcGFuIGNsYXNzPVwiJyArIHRoYXQub3B0aW9ucy5pY29uQmFzZSArICcgJyArICR0aGlzLmRhdGEoJ2ljb24nKSArICdcIj48L3NwYW4+ICcgOiAnJyxcbiAgICAgICAgICAgICAgJHBhcmVudCA9ICR0aGlzLnBhcmVudCgpLFxuICAgICAgICAgICAgICBpc09wdGdyb3VwID0gJHBhcmVudFswXS50YWdOYW1lID09PSAnT1BUR1JPVVAnLFxuICAgICAgICAgICAgICBpc09wdGdyb3VwRGlzYWJsZWQgPSBpc09wdGdyb3VwICYmICRwYXJlbnRbMF0uZGlzYWJsZWQsXG4gICAgICAgICAgICAgIGlzRGlzYWJsZWQgPSB0aGlzLmRpc2FibGVkIHx8IGlzT3B0Z3JvdXBEaXNhYmxlZDtcblxuICAgICAgICAgIGlmIChpY29uICE9PSAnJyAmJiBpc0Rpc2FibGVkKSB7XG4gICAgICAgICAgICBpY29uID0gJzxzcGFuPicgKyBpY29uICsgJzwvc3Bhbj4nO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICh0aGF0Lm9wdGlvbnMuaGlkZURpc2FibGVkICYmIChpc0Rpc2FibGVkICYmICFpc09wdGdyb3VwIHx8IGlzT3B0Z3JvdXBEaXNhYmxlZCkpIHtcbiAgICAgICAgICAgIGxpSW5kZXgtLTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoISR0aGlzLmRhdGEoJ2NvbnRlbnQnKSkge1xuICAgICAgICAgICAgLy8gUHJlcGVuZCBhbnkgaWNvbiBhbmQgYXBwZW5kIGFueSBzdWJ0ZXh0IHRvIHRoZSBtYWluIHRleHQuXG4gICAgICAgICAgICB0ZXh0ID0gaWNvbiArICc8c3BhbiBjbGFzcz1cInRleHRcIj4nICsgdGV4dCArIHN1YnRleHQgKyAnPC9zcGFuPic7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGlzT3B0Z3JvdXAgJiYgJHRoaXMuZGF0YSgnZGl2aWRlcicpICE9PSB0cnVlKSB7XG4gICAgICAgICAgICBpZiAodGhhdC5vcHRpb25zLmhpZGVEaXNhYmxlZCAmJiBpc0Rpc2FibGVkKSB7XG4gICAgICAgICAgICAgIGlmICgkcGFyZW50LmRhdGEoJ2FsbE9wdGlvbnNEaXNhYmxlZCcpID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgJG9wdGlvbnMgPSAkcGFyZW50LmNoaWxkcmVuKCk7XG4gICAgICAgICAgICAgICAgJHBhcmVudC5kYXRhKCdhbGxPcHRpb25zRGlzYWJsZWQnLCAkb3B0aW9ucy5maWx0ZXIoJzpkaXNhYmxlZCcpLmxlbmd0aCA9PT0gJG9wdGlvbnMubGVuZ3RoKTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmICgkcGFyZW50LmRhdGEoJ2FsbE9wdGlvbnNEaXNhYmxlZCcpKSB7XG4gICAgICAgICAgICAgICAgbGlJbmRleC0tO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgb3B0R3JvdXBDbGFzcyA9ICcgJyArICRwYXJlbnRbMF0uY2xhc3NOYW1lIHx8ICcnO1xuXG4gICAgICAgICAgICBpZiAoJHRoaXMuaW5kZXgoKSA9PT0gMCkge1xuICAgICAgICAgICAgICAvLyBJcyBpdCB0aGUgZmlyc3Qgb3B0aW9uIG9mIHRoZSBvcHRncm91cD9cbiAgICAgICAgICAgICAgb3B0SUQgKz0gMTtcblxuICAgICAgICAgICAgICAvLyBHZXQgdGhlIG9wdCBncm91cCBsYWJlbFxuICAgICAgICAgICAgICB2YXIgbGFiZWwgPSAkcGFyZW50WzBdLmxhYmVsLFxuICAgICAgICAgICAgICAgICAgbGFiZWxTdWJ0ZXh0ID0gdHlwZW9mICRwYXJlbnQuZGF0YSgnc3VidGV4dCcpICE9PSAndW5kZWZpbmVkJyA/ICc8c21hbGwgY2xhc3M9XCJ0ZXh0LW11dGVkXCI+JyArICRwYXJlbnQuZGF0YSgnc3VidGV4dCcpICsgJzwvc21hbGw+JyA6ICcnLFxuICAgICAgICAgICAgICAgICAgbGFiZWxJY29uID0gJHBhcmVudC5kYXRhKCdpY29uJykgPyAnPHNwYW4gY2xhc3M9XCInICsgdGhhdC5vcHRpb25zLmljb25CYXNlICsgJyAnICsgJHBhcmVudC5kYXRhKCdpY29uJykgKyAnXCI+PC9zcGFuPiAnIDogJyc7XG5cbiAgICAgICAgICAgICAgbGFiZWwgPSBsYWJlbEljb24gKyAnPHNwYW4gY2xhc3M9XCJ0ZXh0XCI+JyArIGxhYmVsICsgbGFiZWxTdWJ0ZXh0ICsgJzwvc3Bhbj4nO1xuXG4gICAgICAgICAgICAgIGlmIChpbmRleCAhPT0gMCAmJiBfbGkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIC8vIElzIGl0IE5PVCB0aGUgZmlyc3Qgb3B0aW9uIG9mIHRoZSBzZWxlY3QgJiYgYXJlIHRoZXJlIGVsZW1lbnRzIGluIHRoZSBkcm9wZG93bj9cbiAgICAgICAgICAgICAgICBsaUluZGV4Kys7XG4gICAgICAgICAgICAgICAgX2xpLnB1c2goZ2VuZXJhdGVMSSgnJywgbnVsbCwgJ2RpdmlkZXInLCBvcHRJRCArICdkaXYnKSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgbGlJbmRleCsrO1xuICAgICAgICAgICAgICBfbGkucHVzaChnZW5lcmF0ZUxJKGxhYmVsLCBudWxsLCAnZHJvcGRvd24taGVhZGVyJyArIG9wdEdyb3VwQ2xhc3MsIG9wdElEKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGF0Lm9wdGlvbnMuaGlkZURpc2FibGVkICYmIGlzRGlzYWJsZWQpIHtcbiAgICAgICAgICAgICAgbGlJbmRleC0tO1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9saS5wdXNoKGdlbmVyYXRlTEkoZ2VuZXJhdGVBKHRleHQsICdvcHQgJyArIG9wdGlvbkNsYXNzICsgb3B0R3JvdXBDbGFzcywgaW5saW5lLCB0b2tlbnMpLCBpbmRleCwgJycsIG9wdElEKSk7XG4gICAgICAgICAgfSBlbHNlIGlmICgkdGhpcy5kYXRhKCdkaXZpZGVyJykgPT09IHRydWUpIHtcbiAgICAgICAgICAgIF9saS5wdXNoKGdlbmVyYXRlTEkoJycsIGluZGV4LCAnZGl2aWRlcicpKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKCR0aGlzLmRhdGEoJ2hpZGRlbicpID09PSB0cnVlKSB7XG4gICAgICAgICAgICBfbGkucHVzaChnZW5lcmF0ZUxJKGdlbmVyYXRlQSh0ZXh0LCBvcHRpb25DbGFzcywgaW5saW5lLCB0b2tlbnMpLCBpbmRleCwgJ2hpZGRlbiBpcy1oaWRkZW4nKSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBzaG93RGl2aWRlciA9IHRoaXMucHJldmlvdXNFbGVtZW50U2libGluZyAmJiB0aGlzLnByZXZpb3VzRWxlbWVudFNpYmxpbmcudGFnTmFtZSA9PT0gJ09QVEdST1VQJztcblxuICAgICAgICAgICAgLy8gaWYgcHJldmlvdXMgZWxlbWVudCBpcyBub3QgYW4gb3B0Z3JvdXAgYW5kIGhpZGVEaXNhYmxlZCBpcyB0cnVlXG4gICAgICAgICAgICBpZiAoIXNob3dEaXZpZGVyICYmIHRoYXQub3B0aW9ucy5oaWRlRGlzYWJsZWQpIHtcbiAgICAgICAgICAgICAgLy8gZ2V0IHByZXZpb3VzIGVsZW1lbnRzXG4gICAgICAgICAgICAgIHZhciAkcHJldiA9ICQodGhpcykucHJldkFsbCgpO1xuXG4gICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgJHByZXYubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAvLyBmaW5kIHRoZSBmaXJzdCBlbGVtZW50IGluIHRoZSBwcmV2aW91cyBlbGVtZW50cyB0aGF0IGlzIGFuIG9wdGdyb3VwXG4gICAgICAgICAgICAgICAgaWYgKCRwcmV2W2ldLnRhZ05hbWUgPT09ICdPUFRHUk9VUCcpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBvcHRHcm91cERpc3RhbmNlID0gMDtcblxuICAgICAgICAgICAgICAgICAgLy8gbG9vcCB0aHJvdWdoIHRoZSBvcHRpb25zIGluIGJldHdlZW4gdGhlIGN1cnJlbnQgb3B0aW9uIGFuZCB0aGUgb3B0Z3JvdXBcbiAgICAgICAgICAgICAgICAgIC8vIGFuZCBjaGVjayBpZiB0aGV5IGFyZSBoaWRkZW4gb3IgZGlzYWJsZWRcbiAgICAgICAgICAgICAgICAgIGZvciAodmFyIGQgPSAwOyBkIDwgaTsgZCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwcmV2T3B0aW9uID0gJHByZXZbZF07XG4gICAgICAgICAgICAgICAgICAgIGlmIChwcmV2T3B0aW9uLmRpc2FibGVkIHx8ICQocHJldk9wdGlvbikuZGF0YSgnaGlkZGVuJykgPT09IHRydWUpIG9wdEdyb3VwRGlzdGFuY2UrKztcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgLy8gaWYgYWxsIG9mIHRoZSBvcHRpb25zIGJldHdlZW4gdGhlIGN1cnJlbnQgb3B0aW9uIGFuZCB0aGUgb3B0Z3JvdXAgYXJlIGhpZGRlbiBvciBkaXNhYmxlZCwgc2hvdyB0aGUgZGl2aWRlclxuICAgICAgICAgICAgICAgICAgaWYgKG9wdEdyb3VwRGlzdGFuY2UgPT09IGkpIHNob3dEaXZpZGVyID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChzaG93RGl2aWRlcikge1xuICAgICAgICAgICAgICBsaUluZGV4Kys7XG4gICAgICAgICAgICAgIF9saS5wdXNoKGdlbmVyYXRlTEkoJycsIG51bGwsICdkaXZpZGVyJywgb3B0SUQgKyAnZGl2JykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX2xpLnB1c2goZ2VuZXJhdGVMSShnZW5lcmF0ZUEodGV4dCwgb3B0aW9uQ2xhc3MsIGlubGluZSwgdG9rZW5zKSwgaW5kZXgpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0aGF0LmxpT2JqW2luZGV4XSA9IGxpSW5kZXg7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vSWYgd2UgYXJlIG5vdCBtdWx0aXBsZSwgd2UgZG9uJ3QgaGF2ZSBhIHNlbGVjdGVkIGl0ZW0sIGFuZCB3ZSBkb24ndCBoYXZlIGEgdGl0bGUsIHNlbGVjdCB0aGUgZmlyc3QgZWxlbWVudCBzbyBzb21ldGhpbmcgaXMgc2V0IGluIHRoZSBidXR0b25cbiAgICAgICAgaWYgKCF0aGlzLm11bHRpcGxlICYmIHRoaXMuJGVsZW1lbnQuZmluZCgnb3B0aW9uOnNlbGVjdGVkJykubGVuZ3RoID09PSAwICYmICF0aGlzLm9wdGlvbnMudGl0bGUpIHtcbiAgICAgICAgICB0aGlzLiRlbGVtZW50LmZpbmQoJ29wdGlvbicpLmVxKDApLnByb3AoJ3NlbGVjdGVkJywgdHJ1ZSkuYXR0cignc2VsZWN0ZWQnLCAnc2VsZWN0ZWQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBfbGkuam9pbignJyk7XG4gICAgICB9LFxuXG4gICAgICBmaW5kTGlzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLiRsaXMgPT0gbnVsbCkgdGhpcy4kbGlzID0gdGhpcy4kbWVudS5maW5kKCdsaScpO1xuICAgICAgICByZXR1cm4gdGhpcy4kbGlzO1xuICAgICAgfSxcblxuICAgICAgLyoqXHJcbiAgICAgICAqIEBwYXJhbSBbdXBkYXRlTGldIGRlZmF1bHRzIHRvIHRydWVcclxuICAgICAgICovXG4gICAgICByZW5kZXI6IGZ1bmN0aW9uICh1cGRhdGVMaSkge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXMsXG4gICAgICAgICAgICBub3REaXNhYmxlZDtcblxuICAgICAgICAvL1VwZGF0ZSB0aGUgTEkgdG8gbWF0Y2ggdGhlIFNFTEVDVFxuICAgICAgICBpZiAodXBkYXRlTGkgIT09IGZhbHNlKSB7XG4gICAgICAgICAgdGhpcy4kZWxlbWVudC5maW5kKCdvcHRpb24nKS5lYWNoKGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgICAgdmFyICRsaXMgPSB0aGF0LmZpbmRMaXMoKS5lcSh0aGF0LmxpT2JqW2luZGV4XSk7XG5cbiAgICAgICAgICAgIHRoYXQuc2V0RGlzYWJsZWQoaW5kZXgsIHRoaXMuZGlzYWJsZWQgfHwgdGhpcy5wYXJlbnROb2RlLnRhZ05hbWUgPT09ICdPUFRHUk9VUCcgJiYgdGhpcy5wYXJlbnROb2RlLmRpc2FibGVkLCAkbGlzKTtcbiAgICAgICAgICAgIHRoYXQuc2V0U2VsZWN0ZWQoaW5kZXgsIHRoaXMuc2VsZWN0ZWQsICRsaXMpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy50b2dnbGVQbGFjZWhvbGRlcigpO1xuXG4gICAgICAgIHRoaXMudGFiSW5kZXgoKTtcblxuICAgICAgICB2YXIgc2VsZWN0ZWRJdGVtcyA9IHRoaXMuJGVsZW1lbnQuZmluZCgnb3B0aW9uJykubWFwKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZCkge1xuICAgICAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5oaWRlRGlzYWJsZWQgJiYgKHRoaXMuZGlzYWJsZWQgfHwgdGhpcy5wYXJlbnROb2RlLnRhZ05hbWUgPT09ICdPUFRHUk9VUCcgJiYgdGhpcy5wYXJlbnROb2RlLmRpc2FibGVkKSkgcmV0dXJuO1xuXG4gICAgICAgICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpLFxuICAgICAgICAgICAgICAgIGljb24gPSAkdGhpcy5kYXRhKCdpY29uJykgJiYgdGhhdC5vcHRpb25zLnNob3dJY29uID8gJzxpIGNsYXNzPVwiJyArIHRoYXQub3B0aW9ucy5pY29uQmFzZSArICcgJyArICR0aGlzLmRhdGEoJ2ljb24nKSArICdcIj48L2k+ICcgOiAnJyxcbiAgICAgICAgICAgICAgICBzdWJ0ZXh0O1xuXG4gICAgICAgICAgICBpZiAodGhhdC5vcHRpb25zLnNob3dTdWJ0ZXh0ICYmICR0aGlzLmRhdGEoJ3N1YnRleHQnKSAmJiAhdGhhdC5tdWx0aXBsZSkge1xuICAgICAgICAgICAgICBzdWJ0ZXh0ID0gJyA8c21hbGwgY2xhc3M9XCJ0ZXh0LW11dGVkXCI+JyArICR0aGlzLmRhdGEoJ3N1YnRleHQnKSArICc8L3NtYWxsPic7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzdWJ0ZXh0ID0gJyc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZW9mICR0aGlzLmF0dHIoJ3RpdGxlJykgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgIHJldHVybiAkdGhpcy5hdHRyKCd0aXRsZScpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICgkdGhpcy5kYXRhKCdjb250ZW50JykgJiYgdGhhdC5vcHRpb25zLnNob3dDb250ZW50KSB7XG4gICAgICAgICAgICAgIHJldHVybiAkdGhpcy5kYXRhKCdjb250ZW50Jyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICByZXR1cm4gaWNvbiArICR0aGlzLmh0bWwoKSArIHN1YnRleHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KS50b0FycmF5KCk7XG5cbiAgICAgICAgLy9GaXhlcyBpc3N1ZSBpbiBJRTEwIG9jY3VycmluZyB3aGVuIG5vIGRlZmF1bHQgb3B0aW9uIGlzIHNlbGVjdGVkIGFuZCBhdCBsZWFzdCBvbmUgb3B0aW9uIGlzIGRpc2FibGVkXG4gICAgICAgIC8vQ29udmVydCBhbGwgdGhlIHZhbHVlcyBpbnRvIGEgY29tbWEgZGVsaW1pdGVkIHN0cmluZ1xuICAgICAgICB2YXIgdGl0bGUgPSAhdGhpcy5tdWx0aXBsZSA/IHNlbGVjdGVkSXRlbXNbMF0gOiBzZWxlY3RlZEl0ZW1zLmpvaW4odGhpcy5vcHRpb25zLm11bHRpcGxlU2VwYXJhdG9yKTtcblxuICAgICAgICAvL0lmIHRoaXMgaXMgbXVsdGkgc2VsZWN0LCBhbmQgdGhlIHNlbGVjdFRleHQgdHlwZSBpcyBjb3VudCwgdGhlIHNob3cgMSBvZiAyIHNlbGVjdGVkIGV0Yy4uXG4gICAgICAgIGlmICh0aGlzLm11bHRpcGxlICYmIHRoaXMub3B0aW9ucy5zZWxlY3RlZFRleHRGb3JtYXQuaW5kZXhPZignY291bnQnKSA+IC0xKSB7XG4gICAgICAgICAgdmFyIG1heCA9IHRoaXMub3B0aW9ucy5zZWxlY3RlZFRleHRGb3JtYXQuc3BsaXQoJz4nKTtcbiAgICAgICAgICBpZiAobWF4Lmxlbmd0aCA+IDEgJiYgc2VsZWN0ZWRJdGVtcy5sZW5ndGggPiBtYXhbMV0gfHwgbWF4Lmxlbmd0aCA9PSAxICYmIHNlbGVjdGVkSXRlbXMubGVuZ3RoID49IDIpIHtcbiAgICAgICAgICAgIG5vdERpc2FibGVkID0gdGhpcy5vcHRpb25zLmhpZGVEaXNhYmxlZCA/ICcsIFtkaXNhYmxlZF0nIDogJyc7XG4gICAgICAgICAgICB2YXIgdG90YWxDb3VudCA9IHRoaXMuJGVsZW1lbnQuZmluZCgnb3B0aW9uJykubm90KCdbZGF0YS1kaXZpZGVyPVwidHJ1ZVwiXSwgW2RhdGEtaGlkZGVuPVwidHJ1ZVwiXScgKyBub3REaXNhYmxlZCkubGVuZ3RoLFxuICAgICAgICAgICAgICAgIHRyOG5UZXh0ID0gdHlwZW9mIHRoaXMub3B0aW9ucy5jb3VudFNlbGVjdGVkVGV4dCA9PT0gJ2Z1bmN0aW9uJyA/IHRoaXMub3B0aW9ucy5jb3VudFNlbGVjdGVkVGV4dChzZWxlY3RlZEl0ZW1zLmxlbmd0aCwgdG90YWxDb3VudCkgOiB0aGlzLm9wdGlvbnMuY291bnRTZWxlY3RlZFRleHQ7XG4gICAgICAgICAgICB0aXRsZSA9IHRyOG5UZXh0LnJlcGxhY2UoJ3swfScsIHNlbGVjdGVkSXRlbXMubGVuZ3RoLnRvU3RyaW5nKCkpLnJlcGxhY2UoJ3sxfScsIHRvdGFsQ291bnQudG9TdHJpbmcoKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy50aXRsZSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICB0aGlzLm9wdGlvbnMudGl0bGUgPSB0aGlzLiRlbGVtZW50LmF0dHIoJ3RpdGxlJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnNlbGVjdGVkVGV4dEZvcm1hdCA9PSAnc3RhdGljJykge1xuICAgICAgICAgIHRpdGxlID0gdGhpcy5vcHRpb25zLnRpdGxlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9JZiB3ZSBkb250IGhhdmUgYSB0aXRsZSwgdGhlbiB1c2UgdGhlIGRlZmF1bHQsIG9yIGlmIG5vdGhpbmcgaXMgc2V0IGF0IGFsbCwgdXNlIHRoZSBub3Qgc2VsZWN0ZWQgdGV4dFxuICAgICAgICBpZiAoIXRpdGxlKSB7XG4gICAgICAgICAgdGl0bGUgPSB0eXBlb2YgdGhpcy5vcHRpb25zLnRpdGxlICE9PSAndW5kZWZpbmVkJyA/IHRoaXMub3B0aW9ucy50aXRsZSA6IHRoaXMub3B0aW9ucy5ub25lU2VsZWN0ZWRUZXh0O1xuICAgICAgICB9XG5cbiAgICAgICAgLy9zdHJpcCBhbGwgaHRtbC10YWdzIGFuZCB0cmltIHRoZSByZXN1bHRcbiAgICAgICAgdGhpcy4kYnV0dG9uLmF0dHIoJ3RpdGxlJywgJC50cmltKHRpdGxlLnJlcGxhY2UoLzxbXj5dKj4/L2csICcnKSkpO1xuICAgICAgICB0aGlzLiRidXR0b24uY2hpbGRyZW4oJy5maWx0ZXItb3B0aW9uJykuaHRtbCh0aXRsZSk7XG5cbiAgICAgICAgdGhpcy4kZWxlbWVudC50cmlnZ2VyKCdyZW5kZXJlZC5icy5zZWxlY3QnKTtcbiAgICAgIH0sXG5cbiAgICAgIC8qKlxyXG4gICAgICAgKiBAcGFyYW0gW3N0eWxlXVxyXG4gICAgICAgKiBAcGFyYW0gW3N0YXR1c11cclxuICAgICAgICovXG4gICAgICBzZXRTdHlsZTogZnVuY3Rpb24gKHN0eWxlLCBzdGF0dXMpIHtcbiAgICAgICAgaWYgKHRoaXMuJGVsZW1lbnQuYXR0cignY2xhc3MnKSkge1xuICAgICAgICAgIHRoaXMuJG5ld0VsZW1lbnQuYWRkQ2xhc3ModGhpcy4kZWxlbWVudC5hdHRyKCdjbGFzcycpLnJlcGxhY2UoL3NlbGVjdHBpY2tlcnxtb2JpbGUtZGV2aWNlfGJzLXNlbGVjdC1oaWRkZW58dmFsaWRhdGVcXFsuKlxcXS9naSwgJycpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBidXR0b25DbGFzcyA9IHN0eWxlID8gc3R5bGUgOiB0aGlzLm9wdGlvbnMuc3R5bGU7XG5cbiAgICAgICAgaWYgKHN0YXR1cyA9PSAnYWRkJykge1xuICAgICAgICAgIHRoaXMuJGJ1dHRvbi5hZGRDbGFzcyhidXR0b25DbGFzcyk7XG4gICAgICAgIH0gZWxzZSBpZiAoc3RhdHVzID09ICdyZW1vdmUnKSB7XG4gICAgICAgICAgdGhpcy4kYnV0dG9uLnJlbW92ZUNsYXNzKGJ1dHRvbkNsYXNzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLiRidXR0b24ucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLnN0eWxlKTtcbiAgICAgICAgICB0aGlzLiRidXR0b24uYWRkQ2xhc3MoYnV0dG9uQ2xhc3MpO1xuICAgICAgICB9XG4gICAgICB9LFxuXG4gICAgICBsaUhlaWdodDogZnVuY3Rpb24gKHJlZnJlc2gpIHtcbiAgICAgICAgaWYgKCFyZWZyZXNoICYmICh0aGlzLm9wdGlvbnMuc2l6ZSA9PT0gZmFsc2UgfHwgdGhpcy5zaXplSW5mbykpIHJldHVybjtcblxuICAgICAgICB2YXIgbmV3RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpLFxuICAgICAgICAgICAgbWVudSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpLFxuICAgICAgICAgICAgbWVudUlubmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWwnKSxcbiAgICAgICAgICAgIGRpdmlkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpLFxuICAgICAgICAgICAgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpLFxuICAgICAgICAgICAgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKSxcbiAgICAgICAgICAgIHRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyksXG4gICAgICAgICAgICBoZWFkZXIgPSB0aGlzLm9wdGlvbnMuaGVhZGVyICYmIHRoaXMuJG1lbnUuZmluZCgnLnBvcG92ZXItdGl0bGUnKS5sZW5ndGggPiAwID8gdGhpcy4kbWVudS5maW5kKCcucG9wb3Zlci10aXRsZScpWzBdLmNsb25lTm9kZSh0cnVlKSA6IG51bGwsXG4gICAgICAgICAgICBzZWFyY2ggPSB0aGlzLm9wdGlvbnMubGl2ZVNlYXJjaCA/IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpIDogbnVsbCxcbiAgICAgICAgICAgIGFjdGlvbnMgPSB0aGlzLm9wdGlvbnMuYWN0aW9uc0JveCAmJiB0aGlzLm11bHRpcGxlICYmIHRoaXMuJG1lbnUuZmluZCgnLmJzLWFjdGlvbnNib3gnKS5sZW5ndGggPiAwID8gdGhpcy4kbWVudS5maW5kKCcuYnMtYWN0aW9uc2JveCcpWzBdLmNsb25lTm9kZSh0cnVlKSA6IG51bGwsXG4gICAgICAgICAgICBkb25lQnV0dG9uID0gdGhpcy5vcHRpb25zLmRvbmVCdXR0b24gJiYgdGhpcy5tdWx0aXBsZSAmJiB0aGlzLiRtZW51LmZpbmQoJy5icy1kb25lYnV0dG9uJykubGVuZ3RoID4gMCA/IHRoaXMuJG1lbnUuZmluZCgnLmJzLWRvbmVidXR0b24nKVswXS5jbG9uZU5vZGUodHJ1ZSkgOiBudWxsO1xuXG4gICAgICAgIHRleHQuY2xhc3NOYW1lID0gJ3RleHQnO1xuICAgICAgICBuZXdFbGVtZW50LmNsYXNzTmFtZSA9IHRoaXMuJG1lbnVbMF0ucGFyZW50Tm9kZS5jbGFzc05hbWUgKyAnIG9wZW4nO1xuICAgICAgICBtZW51LmNsYXNzTmFtZSA9ICdkcm9wZG93bi1tZW51IG9wZW4nO1xuICAgICAgICBtZW51SW5uZXIuY2xhc3NOYW1lID0gJ2Ryb3Bkb3duLW1lbnUgaW5uZXInO1xuICAgICAgICBkaXZpZGVyLmNsYXNzTmFtZSA9ICdkaXZpZGVyJztcblxuICAgICAgICB0ZXh0LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCdJbm5lciB0ZXh0JykpO1xuICAgICAgICBhLmFwcGVuZENoaWxkKHRleHQpO1xuICAgICAgICBsaS5hcHBlbmRDaGlsZChhKTtcbiAgICAgICAgbWVudUlubmVyLmFwcGVuZENoaWxkKGxpKTtcbiAgICAgICAgbWVudUlubmVyLmFwcGVuZENoaWxkKGRpdmlkZXIpO1xuICAgICAgICBpZiAoaGVhZGVyKSBtZW51LmFwcGVuZENoaWxkKGhlYWRlcik7XG4gICAgICAgIGlmIChzZWFyY2gpIHtcbiAgICAgICAgICAvLyBjcmVhdGUgYSBzcGFuIGluc3RlYWQgb2YgaW5wdXQgYXMgY3JlYXRpbmcgYW4gaW5wdXQgZWxlbWVudCBpcyBzbG93ZXJcbiAgICAgICAgICB2YXIgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgICAgc2VhcmNoLmNsYXNzTmFtZSA9ICdicy1zZWFyY2hib3gnO1xuICAgICAgICAgIGlucHV0LmNsYXNzTmFtZSA9ICdmb3JtLWNvbnRyb2wnO1xuICAgICAgICAgIHNlYXJjaC5hcHBlbmRDaGlsZChpbnB1dCk7XG4gICAgICAgICAgbWVudS5hcHBlbmRDaGlsZChzZWFyY2gpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhY3Rpb25zKSBtZW51LmFwcGVuZENoaWxkKGFjdGlvbnMpO1xuICAgICAgICBtZW51LmFwcGVuZENoaWxkKG1lbnVJbm5lcik7XG4gICAgICAgIGlmIChkb25lQnV0dG9uKSBtZW51LmFwcGVuZENoaWxkKGRvbmVCdXR0b24pO1xuICAgICAgICBuZXdFbGVtZW50LmFwcGVuZENoaWxkKG1lbnUpO1xuXG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobmV3RWxlbWVudCk7XG5cbiAgICAgICAgdmFyIGxpSGVpZ2h0ID0gYS5vZmZzZXRIZWlnaHQsXG4gICAgICAgICAgICBoZWFkZXJIZWlnaHQgPSBoZWFkZXIgPyBoZWFkZXIub2Zmc2V0SGVpZ2h0IDogMCxcbiAgICAgICAgICAgIHNlYXJjaEhlaWdodCA9IHNlYXJjaCA/IHNlYXJjaC5vZmZzZXRIZWlnaHQgOiAwLFxuICAgICAgICAgICAgYWN0aW9uc0hlaWdodCA9IGFjdGlvbnMgPyBhY3Rpb25zLm9mZnNldEhlaWdodCA6IDAsXG4gICAgICAgICAgICBkb25lQnV0dG9uSGVpZ2h0ID0gZG9uZUJ1dHRvbiA/IGRvbmVCdXR0b24ub2Zmc2V0SGVpZ2h0IDogMCxcbiAgICAgICAgICAgIGRpdmlkZXJIZWlnaHQgPSAkKGRpdmlkZXIpLm91dGVySGVpZ2h0KHRydWUpLFxuXG4gICAgICAgIC8vIGZhbGwgYmFjayB0byBqUXVlcnkgaWYgZ2V0Q29tcHV0ZWRTdHlsZSBpcyBub3Qgc3VwcG9ydGVkXG4gICAgICAgIG1lbnVTdHlsZSA9IHR5cGVvZiBnZXRDb21wdXRlZFN0eWxlID09PSAnZnVuY3Rpb24nID8gZ2V0Q29tcHV0ZWRTdHlsZShtZW51KSA6IGZhbHNlLFxuICAgICAgICAgICAgJG1lbnUgPSBtZW51U3R5bGUgPyBudWxsIDogJChtZW51KSxcbiAgICAgICAgICAgIG1lbnVQYWRkaW5nID0ge1xuICAgICAgICAgIHZlcnQ6IHBhcnNlSW50KG1lbnVTdHlsZSA/IG1lbnVTdHlsZS5wYWRkaW5nVG9wIDogJG1lbnUuY3NzKCdwYWRkaW5nVG9wJykpICsgcGFyc2VJbnQobWVudVN0eWxlID8gbWVudVN0eWxlLnBhZGRpbmdCb3R0b20gOiAkbWVudS5jc3MoJ3BhZGRpbmdCb3R0b20nKSkgKyBwYXJzZUludChtZW51U3R5bGUgPyBtZW51U3R5bGUuYm9yZGVyVG9wV2lkdGggOiAkbWVudS5jc3MoJ2JvcmRlclRvcFdpZHRoJykpICsgcGFyc2VJbnQobWVudVN0eWxlID8gbWVudVN0eWxlLmJvcmRlckJvdHRvbVdpZHRoIDogJG1lbnUuY3NzKCdib3JkZXJCb3R0b21XaWR0aCcpKSxcbiAgICAgICAgICBob3JpejogcGFyc2VJbnQobWVudVN0eWxlID8gbWVudVN0eWxlLnBhZGRpbmdMZWZ0IDogJG1lbnUuY3NzKCdwYWRkaW5nTGVmdCcpKSArIHBhcnNlSW50KG1lbnVTdHlsZSA/IG1lbnVTdHlsZS5wYWRkaW5nUmlnaHQgOiAkbWVudS5jc3MoJ3BhZGRpbmdSaWdodCcpKSArIHBhcnNlSW50KG1lbnVTdHlsZSA/IG1lbnVTdHlsZS5ib3JkZXJMZWZ0V2lkdGggOiAkbWVudS5jc3MoJ2JvcmRlckxlZnRXaWR0aCcpKSArIHBhcnNlSW50KG1lbnVTdHlsZSA/IG1lbnVTdHlsZS5ib3JkZXJSaWdodFdpZHRoIDogJG1lbnUuY3NzKCdib3JkZXJSaWdodFdpZHRoJykpXG4gICAgICAgIH0sXG4gICAgICAgICAgICBtZW51RXh0cmFzID0ge1xuICAgICAgICAgIHZlcnQ6IG1lbnVQYWRkaW5nLnZlcnQgKyBwYXJzZUludChtZW51U3R5bGUgPyBtZW51U3R5bGUubWFyZ2luVG9wIDogJG1lbnUuY3NzKCdtYXJnaW5Ub3AnKSkgKyBwYXJzZUludChtZW51U3R5bGUgPyBtZW51U3R5bGUubWFyZ2luQm90dG9tIDogJG1lbnUuY3NzKCdtYXJnaW5Cb3R0b20nKSkgKyAyLFxuICAgICAgICAgIGhvcml6OiBtZW51UGFkZGluZy5ob3JpeiArIHBhcnNlSW50KG1lbnVTdHlsZSA/IG1lbnVTdHlsZS5tYXJnaW5MZWZ0IDogJG1lbnUuY3NzKCdtYXJnaW5MZWZ0JykpICsgcGFyc2VJbnQobWVudVN0eWxlID8gbWVudVN0eWxlLm1hcmdpblJpZ2h0IDogJG1lbnUuY3NzKCdtYXJnaW5SaWdodCcpKSArIDJcbiAgICAgICAgfTtcblxuICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKG5ld0VsZW1lbnQpO1xuXG4gICAgICAgIHRoaXMuc2l6ZUluZm8gPSB7XG4gICAgICAgICAgbGlIZWlnaHQ6IGxpSGVpZ2h0LFxuICAgICAgICAgIGhlYWRlckhlaWdodDogaGVhZGVySGVpZ2h0LFxuICAgICAgICAgIHNlYXJjaEhlaWdodDogc2VhcmNoSGVpZ2h0LFxuICAgICAgICAgIGFjdGlvbnNIZWlnaHQ6IGFjdGlvbnNIZWlnaHQsXG4gICAgICAgICAgZG9uZUJ1dHRvbkhlaWdodDogZG9uZUJ1dHRvbkhlaWdodCxcbiAgICAgICAgICBkaXZpZGVySGVpZ2h0OiBkaXZpZGVySGVpZ2h0LFxuICAgICAgICAgIG1lbnVQYWRkaW5nOiBtZW51UGFkZGluZyxcbiAgICAgICAgICBtZW51RXh0cmFzOiBtZW51RXh0cmFzXG4gICAgICAgIH07XG4gICAgICB9LFxuXG4gICAgICBzZXRTaXplOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZmluZExpcygpO1xuICAgICAgICB0aGlzLmxpSGVpZ2h0KCk7XG5cbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5oZWFkZXIpIHRoaXMuJG1lbnUuY3NzKCdwYWRkaW5nLXRvcCcsIDApO1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnNpemUgPT09IGZhbHNlKSByZXR1cm47XG5cbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzLFxuICAgICAgICAgICAgJG1lbnUgPSB0aGlzLiRtZW51LFxuICAgICAgICAgICAgJG1lbnVJbm5lciA9IHRoaXMuJG1lbnVJbm5lcixcbiAgICAgICAgICAgICR3aW5kb3cgPSAkKHdpbmRvdyksXG4gICAgICAgICAgICBzZWxlY3RIZWlnaHQgPSB0aGlzLiRuZXdFbGVtZW50WzBdLm9mZnNldEhlaWdodCxcbiAgICAgICAgICAgIHNlbGVjdFdpZHRoID0gdGhpcy4kbmV3RWxlbWVudFswXS5vZmZzZXRXaWR0aCxcbiAgICAgICAgICAgIGxpSGVpZ2h0ID0gdGhpcy5zaXplSW5mb1snbGlIZWlnaHQnXSxcbiAgICAgICAgICAgIGhlYWRlckhlaWdodCA9IHRoaXMuc2l6ZUluZm9bJ2hlYWRlckhlaWdodCddLFxuICAgICAgICAgICAgc2VhcmNoSGVpZ2h0ID0gdGhpcy5zaXplSW5mb1snc2VhcmNoSGVpZ2h0J10sXG4gICAgICAgICAgICBhY3Rpb25zSGVpZ2h0ID0gdGhpcy5zaXplSW5mb1snYWN0aW9uc0hlaWdodCddLFxuICAgICAgICAgICAgZG9uZUJ1dHRvbkhlaWdodCA9IHRoaXMuc2l6ZUluZm9bJ2RvbmVCdXR0b25IZWlnaHQnXSxcbiAgICAgICAgICAgIGRpdkhlaWdodCA9IHRoaXMuc2l6ZUluZm9bJ2RpdmlkZXJIZWlnaHQnXSxcbiAgICAgICAgICAgIG1lbnVQYWRkaW5nID0gdGhpcy5zaXplSW5mb1snbWVudVBhZGRpbmcnXSxcbiAgICAgICAgICAgIG1lbnVFeHRyYXMgPSB0aGlzLnNpemVJbmZvWydtZW51RXh0cmFzJ10sXG4gICAgICAgICAgICBub3REaXNhYmxlZCA9IHRoaXMub3B0aW9ucy5oaWRlRGlzYWJsZWQgPyAnLmRpc2FibGVkJyA6ICcnLFxuICAgICAgICAgICAgbWVudUhlaWdodCxcbiAgICAgICAgICAgIG1lbnVXaWR0aCxcbiAgICAgICAgICAgIGdldEhlaWdodCxcbiAgICAgICAgICAgIGdldFdpZHRoLFxuICAgICAgICAgICAgc2VsZWN0T2Zmc2V0VG9wLFxuICAgICAgICAgICAgc2VsZWN0T2Zmc2V0Qm90LFxuICAgICAgICAgICAgc2VsZWN0T2Zmc2V0TGVmdCxcbiAgICAgICAgICAgIHNlbGVjdE9mZnNldFJpZ2h0LFxuICAgICAgICAgICAgZ2V0UG9zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHZhciBwb3MgPSB0aGF0LiRuZXdFbGVtZW50Lm9mZnNldCgpLFxuICAgICAgICAgICAgICAkY29udGFpbmVyID0gJCh0aGF0Lm9wdGlvbnMuY29udGFpbmVyKSxcbiAgICAgICAgICAgICAgY29udGFpbmVyUG9zO1xuXG4gICAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5jb250YWluZXIgJiYgISRjb250YWluZXIuaXMoJ2JvZHknKSkge1xuICAgICAgICAgICAgY29udGFpbmVyUG9zID0gJGNvbnRhaW5lci5vZmZzZXQoKTtcbiAgICAgICAgICAgIGNvbnRhaW5lclBvcy50b3AgKz0gcGFyc2VJbnQoJGNvbnRhaW5lci5jc3MoJ2JvcmRlclRvcFdpZHRoJykpO1xuICAgICAgICAgICAgY29udGFpbmVyUG9zLmxlZnQgKz0gcGFyc2VJbnQoJGNvbnRhaW5lci5jc3MoJ2JvcmRlckxlZnRXaWR0aCcpKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29udGFpbmVyUG9zID0geyB0b3A6IDAsIGxlZnQ6IDAgfTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBzZWxlY3RPZmZzZXRUb3AgPSBwb3MudG9wIC0gY29udGFpbmVyUG9zLnRvcCAtICR3aW5kb3cuc2Nyb2xsVG9wKCk7XG4gICAgICAgICAgc2VsZWN0T2Zmc2V0Qm90ID0gJHdpbmRvdy5oZWlnaHQoKSAtIHNlbGVjdE9mZnNldFRvcCAtIHNlbGVjdEhlaWdodCAtIGNvbnRhaW5lclBvcy50b3A7XG4gICAgICAgICAgc2VsZWN0T2Zmc2V0TGVmdCA9IHBvcy5sZWZ0IC0gY29udGFpbmVyUG9zLmxlZnQgLSAkd2luZG93LnNjcm9sbExlZnQoKTtcbiAgICAgICAgICBzZWxlY3RPZmZzZXRSaWdodCA9ICR3aW5kb3cud2lkdGgoKSAtIHNlbGVjdE9mZnNldExlZnQgLSBzZWxlY3RXaWR0aCAtIGNvbnRhaW5lclBvcy5sZWZ0O1xuICAgICAgICB9O1xuXG4gICAgICAgIGdldFBvcygpO1xuXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2l6ZSA9PT0gJ2F1dG8nKSB7XG4gICAgICAgICAgdmFyIGdldFNpemUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgbWluSGVpZ2h0LFxuICAgICAgICAgICAgICAgIGhhc0NsYXNzID0gZnVuY3Rpb24gKGNsYXNzTmFtZSwgaW5jbHVkZSkge1xuICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoaW5jbHVkZSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQuY2xhc3NMaXN0ID8gZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoY2xhc3NOYW1lKSA6ICQoZWxlbWVudCkuaGFzQ2xhc3MoY2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuICEoZWxlbWVudC5jbGFzc0xpc3QgPyBlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhjbGFzc05hbWUpIDogJChlbGVtZW50KS5oYXNDbGFzcyhjbGFzc05hbWUpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGxpcyA9IHRoYXQuJG1lbnVJbm5lclswXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbGknKSxcbiAgICAgICAgICAgICAgICBsaXNWaXNpYmxlID0gQXJyYXkucHJvdG90eXBlLmZpbHRlciA/IEFycmF5LnByb3RvdHlwZS5maWx0ZXIuY2FsbChsaXMsIGhhc0NsYXNzKCdoaWRkZW4nLCBmYWxzZSkpIDogdGhhdC4kbGlzLm5vdCgnLmhpZGRlbicpLFxuICAgICAgICAgICAgICAgIG9wdEdyb3VwID0gQXJyYXkucHJvdG90eXBlLmZpbHRlciA/IEFycmF5LnByb3RvdHlwZS5maWx0ZXIuY2FsbChsaXNWaXNpYmxlLCBoYXNDbGFzcygnZHJvcGRvd24taGVhZGVyJywgdHJ1ZSkpIDogbGlzVmlzaWJsZS5maWx0ZXIoJy5kcm9wZG93bi1oZWFkZXInKTtcblxuICAgICAgICAgICAgZ2V0UG9zKCk7XG4gICAgICAgICAgICBtZW51SGVpZ2h0ID0gc2VsZWN0T2Zmc2V0Qm90IC0gbWVudUV4dHJhcy52ZXJ0O1xuICAgICAgICAgICAgbWVudVdpZHRoID0gc2VsZWN0T2Zmc2V0UmlnaHQgLSBtZW51RXh0cmFzLmhvcml6O1xuXG4gICAgICAgICAgICBpZiAodGhhdC5vcHRpb25zLmNvbnRhaW5lcikge1xuICAgICAgICAgICAgICBpZiAoISRtZW51LmRhdGEoJ2hlaWdodCcpKSAkbWVudS5kYXRhKCdoZWlnaHQnLCAkbWVudS5oZWlnaHQoKSk7XG4gICAgICAgICAgICAgIGdldEhlaWdodCA9ICRtZW51LmRhdGEoJ2hlaWdodCcpO1xuXG4gICAgICAgICAgICAgIGlmICghJG1lbnUuZGF0YSgnd2lkdGgnKSkgJG1lbnUuZGF0YSgnd2lkdGgnLCAkbWVudS53aWR0aCgpKTtcbiAgICAgICAgICAgICAgZ2V0V2lkdGggPSAkbWVudS5kYXRhKCd3aWR0aCcpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgZ2V0SGVpZ2h0ID0gJG1lbnUuaGVpZ2h0KCk7XG4gICAgICAgICAgICAgIGdldFdpZHRoID0gJG1lbnUud2lkdGgoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5kcm9wdXBBdXRvKSB7XG4gICAgICAgICAgICAgIHRoYXQuJG5ld0VsZW1lbnQudG9nZ2xlQ2xhc3MoJ2Ryb3B1cCcsIHNlbGVjdE9mZnNldFRvcCA+IHNlbGVjdE9mZnNldEJvdCAmJiBtZW51SGVpZ2h0IC0gbWVudUV4dHJhcy52ZXJ0IDwgZ2V0SGVpZ2h0KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoYXQuJG5ld0VsZW1lbnQuaGFzQ2xhc3MoJ2Ryb3B1cCcpKSB7XG4gICAgICAgICAgICAgIG1lbnVIZWlnaHQgPSBzZWxlY3RPZmZzZXRUb3AgLSBtZW51RXh0cmFzLnZlcnQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGF0Lm9wdGlvbnMuZHJvcGRvd25BbGlnblJpZ2h0ID09PSAnYXV0bycpIHtcbiAgICAgICAgICAgICAgJG1lbnUudG9nZ2xlQ2xhc3MoJ2Ryb3Bkb3duLW1lbnUtcmlnaHQnLCBzZWxlY3RPZmZzZXRMZWZ0ID4gc2VsZWN0T2Zmc2V0UmlnaHQgJiYgbWVudVdpZHRoIC0gbWVudUV4dHJhcy5ob3JpeiA8IGdldFdpZHRoIC0gc2VsZWN0V2lkdGgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAobGlzVmlzaWJsZS5sZW5ndGggKyBvcHRHcm91cC5sZW5ndGggPiAzKSB7XG4gICAgICAgICAgICAgIG1pbkhlaWdodCA9IGxpSGVpZ2h0ICogMyArIG1lbnVFeHRyYXMudmVydCAtIDI7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBtaW5IZWlnaHQgPSAwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkbWVudS5jc3Moe1xuICAgICAgICAgICAgICAnbWF4LWhlaWdodCc6IG1lbnVIZWlnaHQgKyAncHgnLFxuICAgICAgICAgICAgICAnb3ZlcmZsb3cnOiAnaGlkZGVuJyxcbiAgICAgICAgICAgICAgJ21pbi1oZWlnaHQnOiBtaW5IZWlnaHQgKyBoZWFkZXJIZWlnaHQgKyBzZWFyY2hIZWlnaHQgKyBhY3Rpb25zSGVpZ2h0ICsgZG9uZUJ1dHRvbkhlaWdodCArICdweCdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJG1lbnVJbm5lci5jc3Moe1xuICAgICAgICAgICAgICAnbWF4LWhlaWdodCc6IG1lbnVIZWlnaHQgLSBoZWFkZXJIZWlnaHQgLSBzZWFyY2hIZWlnaHQgLSBhY3Rpb25zSGVpZ2h0IC0gZG9uZUJ1dHRvbkhlaWdodCAtIG1lbnVQYWRkaW5nLnZlcnQgKyAncHgnLFxuICAgICAgICAgICAgICAnb3ZlcmZsb3cteSc6ICdhdXRvJyxcbiAgICAgICAgICAgICAgJ21pbi1oZWlnaHQnOiBNYXRoLm1heChtaW5IZWlnaHQgLSBtZW51UGFkZGluZy52ZXJ0LCAwKSArICdweCdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH07XG4gICAgICAgICAgZ2V0U2l6ZSgpO1xuICAgICAgICAgIHRoaXMuJHNlYXJjaGJveC5vZmYoJ2lucHV0LmdldFNpemUgcHJvcGVydHljaGFuZ2UuZ2V0U2l6ZScpLm9uKCdpbnB1dC5nZXRTaXplIHByb3BlcnR5Y2hhbmdlLmdldFNpemUnLCBnZXRTaXplKTtcbiAgICAgICAgICAkd2luZG93Lm9mZigncmVzaXplLmdldFNpemUgc2Nyb2xsLmdldFNpemUnKS5vbigncmVzaXplLmdldFNpemUgc2Nyb2xsLmdldFNpemUnLCBnZXRTaXplKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLm9wdGlvbnMuc2l6ZSAmJiB0aGlzLm9wdGlvbnMuc2l6ZSAhPSAnYXV0bycgJiYgdGhpcy4kbGlzLm5vdChub3REaXNhYmxlZCkubGVuZ3RoID4gdGhpcy5vcHRpb25zLnNpemUpIHtcbiAgICAgICAgICB2YXIgb3B0SW5kZXggPSB0aGlzLiRsaXMubm90KCcuZGl2aWRlcicpLm5vdChub3REaXNhYmxlZCkuY2hpbGRyZW4oKS5zbGljZSgwLCB0aGlzLm9wdGlvbnMuc2l6ZSkubGFzdCgpLnBhcmVudCgpLmluZGV4KCksXG4gICAgICAgICAgICAgIGRpdkxlbmd0aCA9IHRoaXMuJGxpcy5zbGljZSgwLCBvcHRJbmRleCArIDEpLmZpbHRlcignLmRpdmlkZXInKS5sZW5ndGg7XG4gICAgICAgICAgbWVudUhlaWdodCA9IGxpSGVpZ2h0ICogdGhpcy5vcHRpb25zLnNpemUgKyBkaXZMZW5ndGggKiBkaXZIZWlnaHQgKyBtZW51UGFkZGluZy52ZXJ0O1xuXG4gICAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5jb250YWluZXIpIHtcbiAgICAgICAgICAgIGlmICghJG1lbnUuZGF0YSgnaGVpZ2h0JykpICRtZW51LmRhdGEoJ2hlaWdodCcsICRtZW51LmhlaWdodCgpKTtcbiAgICAgICAgICAgIGdldEhlaWdodCA9ICRtZW51LmRhdGEoJ2hlaWdodCcpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBnZXRIZWlnaHQgPSAkbWVudS5oZWlnaHQoKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAodGhhdC5vcHRpb25zLmRyb3B1cEF1dG8pIHtcbiAgICAgICAgICAgIC8vbm9pbnNwZWN0aW9uIEpTVW51c2VkQXNzaWdubWVudFxuICAgICAgICAgICAgdGhpcy4kbmV3RWxlbWVudC50b2dnbGVDbGFzcygnZHJvcHVwJywgc2VsZWN0T2Zmc2V0VG9wID4gc2VsZWN0T2Zmc2V0Qm90ICYmIG1lbnVIZWlnaHQgLSBtZW51RXh0cmFzLnZlcnQgPCBnZXRIZWlnaHQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAkbWVudS5jc3Moe1xuICAgICAgICAgICAgJ21heC1oZWlnaHQnOiBtZW51SGVpZ2h0ICsgaGVhZGVySGVpZ2h0ICsgc2VhcmNoSGVpZ2h0ICsgYWN0aW9uc0hlaWdodCArIGRvbmVCdXR0b25IZWlnaHQgKyAncHgnLFxuICAgICAgICAgICAgJ292ZXJmbG93JzogJ2hpZGRlbicsXG4gICAgICAgICAgICAnbWluLWhlaWdodCc6ICcnXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgJG1lbnVJbm5lci5jc3Moe1xuICAgICAgICAgICAgJ21heC1oZWlnaHQnOiBtZW51SGVpZ2h0IC0gbWVudVBhZGRpbmcudmVydCArICdweCcsXG4gICAgICAgICAgICAnb3ZlcmZsb3cteSc6ICdhdXRvJyxcbiAgICAgICAgICAgICdtaW4taGVpZ2h0JzogJydcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgc2V0V2lkdGg6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy53aWR0aCA9PT0gJ2F1dG8nKSB7XG4gICAgICAgICAgdGhpcy4kbWVudS5jc3MoJ21pbi13aWR0aCcsICcwJyk7XG5cbiAgICAgICAgICAvLyBHZXQgY29ycmVjdCB3aWR0aCBpZiBlbGVtZW50IGlzIGhpZGRlblxuICAgICAgICAgIHZhciAkc2VsZWN0Q2xvbmUgPSB0aGlzLiRtZW51LnBhcmVudCgpLmNsb25lKCkuYXBwZW5kVG8oJ2JvZHknKSxcbiAgICAgICAgICAgICAgJHNlbGVjdENsb25lMiA9IHRoaXMub3B0aW9ucy5jb250YWluZXIgPyB0aGlzLiRuZXdFbGVtZW50LmNsb25lKCkuYXBwZW5kVG8oJ2JvZHknKSA6ICRzZWxlY3RDbG9uZSxcbiAgICAgICAgICAgICAgdWxXaWR0aCA9ICRzZWxlY3RDbG9uZS5jaGlsZHJlbignLmRyb3Bkb3duLW1lbnUnKS5vdXRlcldpZHRoKCksXG4gICAgICAgICAgICAgIGJ0bldpZHRoID0gJHNlbGVjdENsb25lMi5jc3MoJ3dpZHRoJywgJ2F1dG8nKS5jaGlsZHJlbignYnV0dG9uJykub3V0ZXJXaWR0aCgpO1xuXG4gICAgICAgICAgJHNlbGVjdENsb25lLnJlbW92ZSgpO1xuICAgICAgICAgICRzZWxlY3RDbG9uZTIucmVtb3ZlKCk7XG5cbiAgICAgICAgICAvLyBTZXQgd2lkdGggdG8gd2hhdGV2ZXIncyBsYXJnZXIsIGJ1dHRvbiB0aXRsZSBvciBsb25nZXN0IG9wdGlvblxuICAgICAgICAgIHRoaXMuJG5ld0VsZW1lbnQuY3NzKCd3aWR0aCcsIE1hdGgubWF4KHVsV2lkdGgsIGJ0bldpZHRoKSArICdweCcpO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9ucy53aWR0aCA9PT0gJ2ZpdCcpIHtcbiAgICAgICAgICAvLyBSZW1vdmUgaW5saW5lIG1pbi13aWR0aCBzbyB3aWR0aCBjYW4gYmUgY2hhbmdlZCBmcm9tICdhdXRvJ1xuICAgICAgICAgIHRoaXMuJG1lbnUuY3NzKCdtaW4td2lkdGgnLCAnJyk7XG4gICAgICAgICAgdGhpcy4kbmV3RWxlbWVudC5jc3MoJ3dpZHRoJywgJycpLmFkZENsYXNzKCdmaXQtd2lkdGgnKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLm9wdGlvbnMud2lkdGgpIHtcbiAgICAgICAgICAvLyBSZW1vdmUgaW5saW5lIG1pbi13aWR0aCBzbyB3aWR0aCBjYW4gYmUgY2hhbmdlZCBmcm9tICdhdXRvJ1xuICAgICAgICAgIHRoaXMuJG1lbnUuY3NzKCdtaW4td2lkdGgnLCAnJyk7XG4gICAgICAgICAgdGhpcy4kbmV3RWxlbWVudC5jc3MoJ3dpZHRoJywgdGhpcy5vcHRpb25zLndpZHRoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBSZW1vdmUgaW5saW5lIG1pbi13aWR0aC93aWR0aCBzbyB3aWR0aCBjYW4gYmUgY2hhbmdlZFxuICAgICAgICAgIHRoaXMuJG1lbnUuY3NzKCdtaW4td2lkdGgnLCAnJyk7XG4gICAgICAgICAgdGhpcy4kbmV3RWxlbWVudC5jc3MoJ3dpZHRoJywgJycpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFJlbW92ZSBmaXQtd2lkdGggY2xhc3MgaWYgd2lkdGggaXMgY2hhbmdlZCBwcm9ncmFtbWF0aWNhbGx5XG4gICAgICAgIGlmICh0aGlzLiRuZXdFbGVtZW50Lmhhc0NsYXNzKCdmaXQtd2lkdGgnKSAmJiB0aGlzLm9wdGlvbnMud2lkdGggIT09ICdmaXQnKSB7XG4gICAgICAgICAgdGhpcy4kbmV3RWxlbWVudC5yZW1vdmVDbGFzcygnZml0LXdpZHRoJyk7XG4gICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgIHNlbGVjdFBvc2l0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuJGJzQ29udGFpbmVyID0gJCgnPGRpdiBjbGFzcz1cImJzLWNvbnRhaW5lclwiIC8+Jyk7XG5cbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzLFxuICAgICAgICAgICAgJGNvbnRhaW5lciA9ICQodGhpcy5vcHRpb25zLmNvbnRhaW5lciksXG4gICAgICAgICAgICBwb3MsXG4gICAgICAgICAgICBjb250YWluZXJQb3MsXG4gICAgICAgICAgICBhY3R1YWxIZWlnaHQsXG4gICAgICAgICAgICBnZXRQbGFjZW1lbnQgPSBmdW5jdGlvbiAoJGVsZW1lbnQpIHtcbiAgICAgICAgICB0aGF0LiRic0NvbnRhaW5lci5hZGRDbGFzcygkZWxlbWVudC5hdHRyKCdjbGFzcycpLnJlcGxhY2UoL2Zvcm0tY29udHJvbHxmaXQtd2lkdGgvZ2ksICcnKSkudG9nZ2xlQ2xhc3MoJ2Ryb3B1cCcsICRlbGVtZW50Lmhhc0NsYXNzKCdkcm9wdXAnKSk7XG4gICAgICAgICAgcG9zID0gJGVsZW1lbnQub2Zmc2V0KCk7XG5cbiAgICAgICAgICBpZiAoISRjb250YWluZXIuaXMoJ2JvZHknKSkge1xuICAgICAgICAgICAgY29udGFpbmVyUG9zID0gJGNvbnRhaW5lci5vZmZzZXQoKTtcbiAgICAgICAgICAgIGNvbnRhaW5lclBvcy50b3AgKz0gcGFyc2VJbnQoJGNvbnRhaW5lci5jc3MoJ2JvcmRlclRvcFdpZHRoJykpIC0gJGNvbnRhaW5lci5zY3JvbGxUb3AoKTtcbiAgICAgICAgICAgIGNvbnRhaW5lclBvcy5sZWZ0ICs9IHBhcnNlSW50KCRjb250YWluZXIuY3NzKCdib3JkZXJMZWZ0V2lkdGgnKSkgLSAkY29udGFpbmVyLnNjcm9sbExlZnQoKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29udGFpbmVyUG9zID0geyB0b3A6IDAsIGxlZnQ6IDAgfTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBhY3R1YWxIZWlnaHQgPSAkZWxlbWVudC5oYXNDbGFzcygnZHJvcHVwJykgPyAwIDogJGVsZW1lbnRbMF0ub2Zmc2V0SGVpZ2h0O1xuXG4gICAgICAgICAgdGhhdC4kYnNDb250YWluZXIuY3NzKHtcbiAgICAgICAgICAgICd0b3AnOiBwb3MudG9wIC0gY29udGFpbmVyUG9zLnRvcCArIGFjdHVhbEhlaWdodCxcbiAgICAgICAgICAgICdsZWZ0JzogcG9zLmxlZnQgLSBjb250YWluZXJQb3MubGVmdCxcbiAgICAgICAgICAgICd3aWR0aCc6ICRlbGVtZW50WzBdLm9mZnNldFdpZHRoXG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy4kYnV0dG9uLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpO1xuXG4gICAgICAgICAgaWYgKHRoYXQuaXNEaXNhYmxlZCgpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZ2V0UGxhY2VtZW50KHRoYXQuJG5ld0VsZW1lbnQpO1xuXG4gICAgICAgICAgdGhhdC4kYnNDb250YWluZXIuYXBwZW5kVG8odGhhdC5vcHRpb25zLmNvbnRhaW5lcikudG9nZ2xlQ2xhc3MoJ29wZW4nLCAhJHRoaXMuaGFzQ2xhc3MoJ29wZW4nKSkuYXBwZW5kKHRoYXQuJG1lbnUpO1xuICAgICAgICB9KTtcblxuICAgICAgICAkKHdpbmRvdykub24oJ3Jlc2l6ZSBzY3JvbGwnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgZ2V0UGxhY2VtZW50KHRoYXQuJG5ld0VsZW1lbnQpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLiRlbGVtZW50Lm9uKCdoaWRlLmJzLnNlbGVjdCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB0aGF0LiRtZW51LmRhdGEoJ2hlaWdodCcsIHRoYXQuJG1lbnUuaGVpZ2h0KCkpO1xuICAgICAgICAgIHRoYXQuJGJzQ29udGFpbmVyLmRldGFjaCgpO1xuICAgICAgICB9KTtcbiAgICAgIH0sXG5cbiAgICAgIC8qKlxyXG4gICAgICAgKiBAcGFyYW0ge251bWJlcn0gaW5kZXggLSB0aGUgaW5kZXggb2YgdGhlIG9wdGlvbiB0aGF0IGlzIGJlaW5nIGNoYW5nZWRcclxuICAgICAgICogQHBhcmFtIHtib29sZWFufSBzZWxlY3RlZCAtIHRydWUgaWYgdGhlIG9wdGlvbiBpcyBiZWluZyBzZWxlY3RlZCwgZmFsc2UgaWYgYmVpbmcgZGVzZWxlY3RlZFxyXG4gICAgICAgKiBAcGFyYW0ge0pRdWVyeX0gJGxpcyAtIHRoZSAnbGknIGVsZW1lbnQgdGhhdCBpcyBiZWluZyBtb2RpZmllZFxyXG4gICAgICAgKi9cbiAgICAgIHNldFNlbGVjdGVkOiBmdW5jdGlvbiAoaW5kZXgsIHNlbGVjdGVkLCAkbGlzKSB7XG4gICAgICAgIGlmICghJGxpcykge1xuICAgICAgICAgIHRoaXMudG9nZ2xlUGxhY2Vob2xkZXIoKTsgLy8gY2hlY2sgaWYgc2V0U2VsZWN0ZWQgaXMgYmVpbmcgY2FsbGVkIGJ5IGNoYW5naW5nIHRoZSB2YWx1ZSBvZiB0aGUgc2VsZWN0XG4gICAgICAgICAgJGxpcyA9IHRoaXMuZmluZExpcygpLmVxKHRoaXMubGlPYmpbaW5kZXhdKTtcbiAgICAgICAgfVxuXG4gICAgICAgICRsaXMudG9nZ2xlQ2xhc3MoJ3NlbGVjdGVkJywgc2VsZWN0ZWQpLmZpbmQoJ2EnKS5hdHRyKCdhcmlhLXNlbGVjdGVkJywgc2VsZWN0ZWQpO1xuICAgICAgfSxcblxuICAgICAgLyoqXHJcbiAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleCAtIHRoZSBpbmRleCBvZiB0aGUgb3B0aW9uIHRoYXQgaXMgYmVpbmcgZGlzYWJsZWRcclxuICAgICAgICogQHBhcmFtIHtib29sZWFufSBkaXNhYmxlZCAtIHRydWUgaWYgdGhlIG9wdGlvbiBpcyBiZWluZyBkaXNhYmxlZCwgZmFsc2UgaWYgYmVpbmcgZW5hYmxlZFxyXG4gICAgICAgKiBAcGFyYW0ge0pRdWVyeX0gJGxpcyAtIHRoZSAnbGknIGVsZW1lbnQgdGhhdCBpcyBiZWluZyBtb2RpZmllZFxyXG4gICAgICAgKi9cbiAgICAgIHNldERpc2FibGVkOiBmdW5jdGlvbiAoaW5kZXgsIGRpc2FibGVkLCAkbGlzKSB7XG4gICAgICAgIGlmICghJGxpcykge1xuICAgICAgICAgICRsaXMgPSB0aGlzLmZpbmRMaXMoKS5lcSh0aGlzLmxpT2JqW2luZGV4XSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZGlzYWJsZWQpIHtcbiAgICAgICAgICAkbGlzLmFkZENsYXNzKCdkaXNhYmxlZCcpLmNoaWxkcmVuKCdhJykuYXR0cignaHJlZicsICcjJykuYXR0cigndGFiaW5kZXgnLCAtMSkuYXR0cignYXJpYS1kaXNhYmxlZCcsIHRydWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICRsaXMucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJykuY2hpbGRyZW4oJ2EnKS5yZW1vdmVBdHRyKCdocmVmJykuYXR0cigndGFiaW5kZXgnLCAwKS5hdHRyKCdhcmlhLWRpc2FibGVkJywgZmFsc2UpO1xuICAgICAgICB9XG4gICAgICB9LFxuXG4gICAgICBpc0Rpc2FibGVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiRlbGVtZW50WzBdLmRpc2FibGVkO1xuICAgICAgfSxcblxuICAgICAgY2hlY2tEaXNhYmxlZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG5cbiAgICAgICAgaWYgKHRoaXMuaXNEaXNhYmxlZCgpKSB7XG4gICAgICAgICAgdGhpcy4kbmV3RWxlbWVudC5hZGRDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgICB0aGlzLiRidXR0b24uYWRkQ2xhc3MoJ2Rpc2FibGVkJykuYXR0cigndGFiaW5kZXgnLCAtMSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKHRoaXMuJGJ1dHRvbi5oYXNDbGFzcygnZGlzYWJsZWQnKSkge1xuICAgICAgICAgICAgdGhpcy4kbmV3RWxlbWVudC5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgIHRoaXMuJGJ1dHRvbi5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAodGhpcy4kYnV0dG9uLmF0dHIoJ3RhYmluZGV4JykgPT0gLTEgJiYgIXRoaXMuJGVsZW1lbnQuZGF0YSgndGFiaW5kZXgnKSkge1xuICAgICAgICAgICAgdGhpcy4kYnV0dG9uLnJlbW92ZUF0dHIoJ3RhYmluZGV4Jyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy4kYnV0dG9uLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gIXRoYXQuaXNEaXNhYmxlZCgpO1xuICAgICAgICB9KTtcbiAgICAgIH0sXG5cbiAgICAgIHRvZ2dsZVBsYWNlaG9sZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuJGVsZW1lbnQudmFsKCk7XG4gICAgICAgIHRoaXMuJGJ1dHRvbi50b2dnbGVDbGFzcygnYnMtcGxhY2Vob2xkZXInLCB2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gJycpO1xuICAgICAgfSxcblxuICAgICAgdGFiSW5kZXg6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuJGVsZW1lbnQuZGF0YSgndGFiaW5kZXgnKSAhPT0gdGhpcy4kZWxlbWVudC5hdHRyKCd0YWJpbmRleCcpICYmIHRoaXMuJGVsZW1lbnQuYXR0cigndGFiaW5kZXgnKSAhPT0gLTk4ICYmIHRoaXMuJGVsZW1lbnQuYXR0cigndGFiaW5kZXgnKSAhPT0gJy05OCcpIHtcbiAgICAgICAgICB0aGlzLiRlbGVtZW50LmRhdGEoJ3RhYmluZGV4JywgdGhpcy4kZWxlbWVudC5hdHRyKCd0YWJpbmRleCcpKTtcbiAgICAgICAgICB0aGlzLiRidXR0b24uYXR0cigndGFiaW5kZXgnLCB0aGlzLiRlbGVtZW50LmRhdGEoJ3RhYmluZGV4JykpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy4kZWxlbWVudC5hdHRyKCd0YWJpbmRleCcsIC05OCk7XG4gICAgICB9LFxuXG4gICAgICBjbGlja0xpc3RlbmVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcyxcbiAgICAgICAgICAgICRkb2N1bWVudCA9ICQoZG9jdW1lbnQpO1xuXG4gICAgICAgIHRoaXMuJG5ld0VsZW1lbnQub24oJ3RvdWNoc3RhcnQuZHJvcGRvd24nLCAnLmRyb3Bkb3duLW1lbnUnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRkb2N1bWVudC5kYXRhKCdzcGFjZVNlbGVjdCcsIGZhbHNlKTtcblxuICAgICAgICB0aGlzLiRidXR0b24ub24oJ2tleXVwJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICBpZiAoLygzMikvLnRlc3QoZS5rZXlDb2RlLnRvU3RyaW5nKDEwKSkgJiYgJGRvY3VtZW50LmRhdGEoJ3NwYWNlU2VsZWN0JykpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICRkb2N1bWVudC5kYXRhKCdzcGFjZVNlbGVjdCcsIGZhbHNlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuJGJ1dHRvbi5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdGhhdC5zZXRTaXplKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuJGVsZW1lbnQub24oJ3Nob3duLmJzLnNlbGVjdCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpZiAoIXRoYXQub3B0aW9ucy5saXZlU2VhcmNoICYmICF0aGF0Lm11bHRpcGxlKSB7XG4gICAgICAgICAgICB0aGF0LiRtZW51SW5uZXIuZmluZCgnLnNlbGVjdGVkIGEnKS5mb2N1cygpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoIXRoYXQubXVsdGlwbGUpIHtcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZEluZGV4ID0gdGhhdC5saU9ialt0aGF0LiRlbGVtZW50WzBdLnNlbGVjdGVkSW5kZXhdO1xuXG4gICAgICAgICAgICBpZiAodHlwZW9mIHNlbGVjdGVkSW5kZXggIT09ICdudW1iZXInIHx8IHRoYXQub3B0aW9ucy5zaXplID09PSBmYWxzZSkgcmV0dXJuO1xuXG4gICAgICAgICAgICAvLyBzY3JvbGwgdG8gc2VsZWN0ZWQgb3B0aW9uXG4gICAgICAgICAgICB2YXIgb2Zmc2V0ID0gdGhhdC4kbGlzLmVxKHNlbGVjdGVkSW5kZXgpWzBdLm9mZnNldFRvcCAtIHRoYXQuJG1lbnVJbm5lclswXS5vZmZzZXRUb3A7XG4gICAgICAgICAgICBvZmZzZXQgPSBvZmZzZXQgLSB0aGF0LiRtZW51SW5uZXJbMF0ub2Zmc2V0SGVpZ2h0IC8gMiArIHRoYXQuc2l6ZUluZm8ubGlIZWlnaHQgLyAyO1xuICAgICAgICAgICAgdGhhdC4kbWVudUlubmVyWzBdLnNjcm9sbFRvcCA9IG9mZnNldDtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuJG1lbnVJbm5lci5vbignY2xpY2snLCAnbGkgYScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgdmFyICR0aGlzID0gJCh0aGlzKSxcbiAgICAgICAgICAgICAgY2xpY2tlZEluZGV4ID0gJHRoaXMucGFyZW50KCkuZGF0YSgnb3JpZ2luYWxJbmRleCcpLFxuICAgICAgICAgICAgICBwcmV2VmFsdWUgPSB0aGF0LiRlbGVtZW50LnZhbCgpLFxuICAgICAgICAgICAgICBwcmV2SW5kZXggPSB0aGF0LiRlbGVtZW50LnByb3AoJ3NlbGVjdGVkSW5kZXgnKSxcbiAgICAgICAgICAgICAgdHJpZ2dlckNoYW5nZSA9IHRydWU7XG5cbiAgICAgICAgICAvLyBEb24ndCBjbG9zZSBvbiBtdWx0aSBjaG9pY2UgbWVudVxuICAgICAgICAgIGlmICh0aGF0Lm11bHRpcGxlICYmIHRoYXQub3B0aW9ucy5tYXhPcHRpb25zICE9PSAxKSB7XG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgIC8vRG9uJ3QgcnVuIGlmIHdlIGhhdmUgYmVlbiBkaXNhYmxlZFxuICAgICAgICAgIGlmICghdGhhdC5pc0Rpc2FibGVkKCkgJiYgISR0aGlzLnBhcmVudCgpLmhhc0NsYXNzKCdkaXNhYmxlZCcpKSB7XG4gICAgICAgICAgICB2YXIgJG9wdGlvbnMgPSB0aGF0LiRlbGVtZW50LmZpbmQoJ29wdGlvbicpLFxuICAgICAgICAgICAgICAgICRvcHRpb24gPSAkb3B0aW9ucy5lcShjbGlja2VkSW5kZXgpLFxuICAgICAgICAgICAgICAgIHN0YXRlID0gJG9wdGlvbi5wcm9wKCdzZWxlY3RlZCcpLFxuICAgICAgICAgICAgICAgICRvcHRncm91cCA9ICRvcHRpb24ucGFyZW50KCdvcHRncm91cCcpLFxuICAgICAgICAgICAgICAgIG1heE9wdGlvbnMgPSB0aGF0Lm9wdGlvbnMubWF4T3B0aW9ucyxcbiAgICAgICAgICAgICAgICBtYXhPcHRpb25zR3JwID0gJG9wdGdyb3VwLmRhdGEoJ21heE9wdGlvbnMnKSB8fCBmYWxzZTtcblxuICAgICAgICAgICAgaWYgKCF0aGF0Lm11bHRpcGxlKSB7XG4gICAgICAgICAgICAgIC8vIERlc2VsZWN0IGFsbCBvdGhlcnMgaWYgbm90IG11bHRpIHNlbGVjdCBib3hcbiAgICAgICAgICAgICAgJG9wdGlvbnMucHJvcCgnc2VsZWN0ZWQnLCBmYWxzZSk7XG4gICAgICAgICAgICAgICRvcHRpb24ucHJvcCgnc2VsZWN0ZWQnLCB0cnVlKTtcbiAgICAgICAgICAgICAgdGhhdC4kbWVudUlubmVyLmZpbmQoJy5zZWxlY3RlZCcpLnJlbW92ZUNsYXNzKCdzZWxlY3RlZCcpLmZpbmQoJ2EnKS5hdHRyKCdhcmlhLXNlbGVjdGVkJywgZmFsc2UpO1xuICAgICAgICAgICAgICB0aGF0LnNldFNlbGVjdGVkKGNsaWNrZWRJbmRleCwgdHJ1ZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAvLyBUb2dnbGUgdGhlIG9uZSB3ZSBoYXZlIGNob3NlbiBpZiB3ZSBhcmUgbXVsdGkgc2VsZWN0LlxuICAgICAgICAgICAgICAkb3B0aW9uLnByb3AoJ3NlbGVjdGVkJywgIXN0YXRlKTtcbiAgICAgICAgICAgICAgdGhhdC5zZXRTZWxlY3RlZChjbGlja2VkSW5kZXgsICFzdGF0ZSk7XG4gICAgICAgICAgICAgICR0aGlzLmJsdXIoKTtcblxuICAgICAgICAgICAgICBpZiAobWF4T3B0aW9ucyAhPT0gZmFsc2UgfHwgbWF4T3B0aW9uc0dycCAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWF4UmVhY2hlZCA9IG1heE9wdGlvbnMgPCAkb3B0aW9ucy5maWx0ZXIoJzpzZWxlY3RlZCcpLmxlbmd0aCxcbiAgICAgICAgICAgICAgICAgICAgbWF4UmVhY2hlZEdycCA9IG1heE9wdGlvbnNHcnAgPCAkb3B0Z3JvdXAuZmluZCgnb3B0aW9uOnNlbGVjdGVkJykubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgaWYgKG1heE9wdGlvbnMgJiYgbWF4UmVhY2hlZCB8fCBtYXhPcHRpb25zR3JwICYmIG1heFJlYWNoZWRHcnApIHtcbiAgICAgICAgICAgICAgICAgIGlmIChtYXhPcHRpb25zICYmIG1heE9wdGlvbnMgPT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAkb3B0aW9ucy5wcm9wKCdzZWxlY3RlZCcsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgJG9wdGlvbi5wcm9wKCdzZWxlY3RlZCcsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB0aGF0LiRtZW51SW5uZXIuZmluZCgnLnNlbGVjdGVkJykucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkJyk7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0U2VsZWN0ZWQoY2xpY2tlZEluZGV4LCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWF4T3B0aW9uc0dycCAmJiBtYXhPcHRpb25zR3JwID09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgJG9wdGdyb3VwLmZpbmQoJ29wdGlvbjpzZWxlY3RlZCcpLnByb3AoJ3NlbGVjdGVkJywgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAkb3B0aW9uLnByb3AoJ3NlbGVjdGVkJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvcHRncm91cElEID0gJHRoaXMucGFyZW50KCkuZGF0YSgnb3B0Z3JvdXAnKTtcbiAgICAgICAgICAgICAgICAgICAgdGhhdC4kbWVudUlubmVyLmZpbmQoJ1tkYXRhLW9wdGdyb3VwPVwiJyArIG9wdGdyb3VwSUQgKyAnXCJdJykucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkJyk7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0U2VsZWN0ZWQoY2xpY2tlZEluZGV4LCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtYXhPcHRpb25zVGV4dCA9IHR5cGVvZiB0aGF0Lm9wdGlvbnMubWF4T3B0aW9uc1RleHQgPT09ICdzdHJpbmcnID8gW3RoYXQub3B0aW9ucy5tYXhPcHRpb25zVGV4dCwgdGhhdC5vcHRpb25zLm1heE9wdGlvbnNUZXh0XSA6IHRoYXQub3B0aW9ucy5tYXhPcHRpb25zVGV4dCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heE9wdGlvbnNBcnIgPSB0eXBlb2YgbWF4T3B0aW9uc1RleHQgPT09ICdmdW5jdGlvbicgPyBtYXhPcHRpb25zVGV4dChtYXhPcHRpb25zLCBtYXhPcHRpb25zR3JwKSA6IG1heE9wdGlvbnNUZXh0LFxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4VHh0ID0gbWF4T3B0aW9uc0FyclswXS5yZXBsYWNlKCd7bn0nLCBtYXhPcHRpb25zKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heFR4dEdycCA9IG1heE9wdGlvbnNBcnJbMV0ucmVwbGFjZSgne259JywgbWF4T3B0aW9uc0dycCksXG4gICAgICAgICAgICAgICAgICAgICAgICAkbm90aWZ5ID0gJCgnPGRpdiBjbGFzcz1cIm5vdGlmeVwiPjwvZGl2PicpO1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiB7dmFyfSBpcyBzZXQgaW4gYXJyYXksIHJlcGxhY2UgaXRcbiAgICAgICAgICAgICAgICAgICAgLyoqIEBkZXByZWNhdGVkICovXG4gICAgICAgICAgICAgICAgICAgIGlmIChtYXhPcHRpb25zQXJyWzJdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgbWF4VHh0ID0gbWF4VHh0LnJlcGxhY2UoJ3t2YXJ9JywgbWF4T3B0aW9uc0FyclsyXVttYXhPcHRpb25zID4gMSA/IDAgOiAxXSk7XG4gICAgICAgICAgICAgICAgICAgICAgbWF4VHh0R3JwID0gbWF4VHh0R3JwLnJlcGxhY2UoJ3t2YXJ9JywgbWF4T3B0aW9uc0FyclsyXVttYXhPcHRpb25zR3JwID4gMSA/IDAgOiAxXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAkb3B0aW9uLnByb3AoJ3NlbGVjdGVkJywgZmFsc2UpO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoYXQuJG1lbnUuYXBwZW5kKCRub3RpZnkpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChtYXhPcHRpb25zICYmIG1heFJlYWNoZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAkbm90aWZ5LmFwcGVuZCgkKCc8ZGl2PicgKyBtYXhUeHQgKyAnPC9kaXY+JykpO1xuICAgICAgICAgICAgICAgICAgICAgIHRyaWdnZXJDaGFuZ2UgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICB0aGF0LiRlbGVtZW50LnRyaWdnZXIoJ21heFJlYWNoZWQuYnMuc2VsZWN0Jyk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAobWF4T3B0aW9uc0dycCAmJiBtYXhSZWFjaGVkR3JwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgJG5vdGlmeS5hcHBlbmQoJCgnPGRpdj4nICsgbWF4VHh0R3JwICsgJzwvZGl2PicpKTtcbiAgICAgICAgICAgICAgICAgICAgICB0cmlnZ2VyQ2hhbmdlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgdGhhdC4kZWxlbWVudC50cmlnZ2VyKCdtYXhSZWFjaGVkR3JwLmJzLnNlbGVjdCcpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgdGhhdC5zZXRTZWxlY3RlZChjbGlja2VkSW5kZXgsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgMTApO1xuXG4gICAgICAgICAgICAgICAgICAgICRub3RpZnkuZGVsYXkoNzUwKS5mYWRlT3V0KDMwMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIXRoYXQubXVsdGlwbGUgfHwgdGhhdC5tdWx0aXBsZSAmJiB0aGF0Lm9wdGlvbnMubWF4T3B0aW9ucyA9PT0gMSkge1xuICAgICAgICAgICAgICB0aGF0LiRidXR0b24uZm9jdXMoKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhhdC5vcHRpb25zLmxpdmVTZWFyY2gpIHtcbiAgICAgICAgICAgICAgdGhhdC4kc2VhcmNoYm94LmZvY3VzKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFRyaWdnZXIgc2VsZWN0ICdjaGFuZ2UnXG4gICAgICAgICAgICBpZiAodHJpZ2dlckNoYW5nZSkge1xuICAgICAgICAgICAgICBpZiAocHJldlZhbHVlICE9IHRoYXQuJGVsZW1lbnQudmFsKCkgJiYgdGhhdC5tdWx0aXBsZSB8fCBwcmV2SW5kZXggIT0gdGhhdC4kZWxlbWVudC5wcm9wKCdzZWxlY3RlZEluZGV4JykgJiYgIXRoYXQubXVsdGlwbGUpIHtcbiAgICAgICAgICAgICAgICAvLyAkb3B0aW9uLnByb3AoJ3NlbGVjdGVkJykgaXMgY3VycmVudCBvcHRpb24gc3RhdGUgKHNlbGVjdGVkL3Vuc2VsZWN0ZWQpLiBzdGF0ZSBpcyBwcmV2aW91cyBvcHRpb24gc3RhdGUuXG4gICAgICAgICAgICAgICAgY2hhbmdlZF9hcmd1bWVudHMgPSBbY2xpY2tlZEluZGV4LCAkb3B0aW9uLnByb3AoJ3NlbGVjdGVkJyksIHN0YXRlXTtcbiAgICAgICAgICAgICAgICB0aGF0LiRlbGVtZW50LnRyaWdnZXJOYXRpdmUoJ2NoYW5nZScpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLiRtZW51Lm9uKCdjbGljaycsICdsaS5kaXNhYmxlZCBhLCAucG9wb3Zlci10aXRsZSwgLnBvcG92ZXItdGl0bGUgOm5vdCguY2xvc2UpJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICBpZiAoZS5jdXJyZW50VGFyZ2V0ID09IHRoaXMpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICBpZiAodGhhdC5vcHRpb25zLmxpdmVTZWFyY2ggJiYgISQoZS50YXJnZXQpLmhhc0NsYXNzKCdjbG9zZScpKSB7XG4gICAgICAgICAgICAgIHRoYXQuJHNlYXJjaGJveC5mb2N1cygpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhhdC4kYnV0dG9uLmZvY3VzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLiRtZW51SW5uZXIub24oJ2NsaWNrJywgJy5kaXZpZGVyLCAuZHJvcGRvd24taGVhZGVyJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICBpZiAodGhhdC5vcHRpb25zLmxpdmVTZWFyY2gpIHtcbiAgICAgICAgICAgIHRoYXQuJHNlYXJjaGJveC5mb2N1cygpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGF0LiRidXR0b24uZm9jdXMoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuJG1lbnUub24oJ2NsaWNrJywgJy5wb3BvdmVyLXRpdGxlIC5jbG9zZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB0aGF0LiRidXR0b24uY2xpY2soKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy4kc2VhcmNoYm94Lm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy4kbWVudS5vbignY2xpY2snLCAnLmFjdGlvbnMtYnRuJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICBpZiAodGhhdC5vcHRpb25zLmxpdmVTZWFyY2gpIHtcbiAgICAgICAgICAgIHRoYXQuJHNlYXJjaGJveC5mb2N1cygpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGF0LiRidXR0b24uZm9jdXMoKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKCdicy1zZWxlY3QtYWxsJykpIHtcbiAgICAgICAgICAgIHRoYXQuc2VsZWN0QWxsKCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoYXQuZGVzZWxlY3RBbGwoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuJGVsZW1lbnQuY2hhbmdlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB0aGF0LnJlbmRlcihmYWxzZSk7XG4gICAgICAgICAgdGhhdC4kZWxlbWVudC50cmlnZ2VyKCdjaGFuZ2VkLmJzLnNlbGVjdCcsIGNoYW5nZWRfYXJndW1lbnRzKTtcbiAgICAgICAgICBjaGFuZ2VkX2FyZ3VtZW50cyA9IG51bGw7XG4gICAgICAgIH0pO1xuICAgICAgfSxcblxuICAgICAgbGl2ZVNlYXJjaExpc3RlbmVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcyxcbiAgICAgICAgICAgICRub19yZXN1bHRzID0gJCgnPGxpIGNsYXNzPVwibm8tcmVzdWx0c1wiPjwvbGk+Jyk7XG5cbiAgICAgICAgdGhpcy4kYnV0dG9uLm9uKCdjbGljay5kcm9wZG93bi5kYXRhLWFwaSB0b3VjaHN0YXJ0LmRyb3Bkb3duLmRhdGEtYXBpJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHRoYXQuJG1lbnVJbm5lci5maW5kKCcuYWN0aXZlJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgIGlmICghIXRoYXQuJHNlYXJjaGJveC52YWwoKSkge1xuICAgICAgICAgICAgdGhhdC4kc2VhcmNoYm94LnZhbCgnJyk7XG4gICAgICAgICAgICB0aGF0LiRsaXMubm90KCcuaXMtaGlkZGVuJykucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAgICAgaWYgKCEhJG5vX3Jlc3VsdHMucGFyZW50KCkubGVuZ3RoKSAkbm9fcmVzdWx0cy5yZW1vdmUoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCF0aGF0Lm11bHRpcGxlKSB0aGF0LiRtZW51SW5uZXIuZmluZCgnLnNlbGVjdGVkJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhhdC4kc2VhcmNoYm94LmZvY3VzKCk7XG4gICAgICAgICAgfSwgMTApO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLiRzZWFyY2hib3gub24oJ2NsaWNrLmRyb3Bkb3duLmRhdGEtYXBpIGZvY3VzLmRyb3Bkb3duLmRhdGEtYXBpIHRvdWNoZW5kLmRyb3Bkb3duLmRhdGEtYXBpJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLiRzZWFyY2hib3gub24oJ2lucHV0IHByb3BlcnR5Y2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGlmICh0aGF0LiRzZWFyY2hib3gudmFsKCkpIHtcbiAgICAgICAgICAgIHZhciAkc2VhcmNoQmFzZSA9IHRoYXQuJGxpcy5ub3QoJy5pcy1oaWRkZW4nKS5yZW1vdmVDbGFzcygnaGlkZGVuJykuY2hpbGRyZW4oJ2EnKTtcbiAgICAgICAgICAgIGlmICh0aGF0Lm9wdGlvbnMubGl2ZVNlYXJjaE5vcm1hbGl6ZSkge1xuICAgICAgICAgICAgICAkc2VhcmNoQmFzZSA9ICRzZWFyY2hCYXNlLm5vdCgnOmEnICsgdGhhdC5fc2VhcmNoU3R5bGUoKSArICcoXCInICsgbm9ybWFsaXplVG9CYXNlKHRoYXQuJHNlYXJjaGJveC52YWwoKSkgKyAnXCIpJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAkc2VhcmNoQmFzZSA9ICRzZWFyY2hCYXNlLm5vdCgnOicgKyB0aGF0Ll9zZWFyY2hTdHlsZSgpICsgJyhcIicgKyB0aGF0LiRzZWFyY2hib3gudmFsKCkgKyAnXCIpJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2VhcmNoQmFzZS5wYXJlbnQoKS5hZGRDbGFzcygnaGlkZGVuJyk7XG5cbiAgICAgICAgICAgIHRoYXQuJGxpcy5maWx0ZXIoJy5kcm9wZG93bi1oZWFkZXInKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgdmFyICR0aGlzID0gJCh0aGlzKSxcbiAgICAgICAgICAgICAgICAgIG9wdGdyb3VwID0gJHRoaXMuZGF0YSgnb3B0Z3JvdXAnKTtcblxuICAgICAgICAgICAgICBpZiAodGhhdC4kbGlzLmZpbHRlcignW2RhdGEtb3B0Z3JvdXA9JyArIG9wdGdyb3VwICsgJ10nKS5ub3QoJHRoaXMpLm5vdCgnLmhpZGRlbicpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICR0aGlzLmFkZENsYXNzKCdoaWRkZW4nKTtcbiAgICAgICAgICAgICAgICB0aGF0LiRsaXMuZmlsdGVyKCdbZGF0YS1vcHRncm91cD0nICsgb3B0Z3JvdXAgKyAnZGl2XScpLmFkZENsYXNzKCdoaWRkZW4nKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHZhciAkbGlzVmlzaWJsZSA9IHRoYXQuJGxpcy5ub3QoJy5oaWRkZW4nKTtcblxuICAgICAgICAgICAgLy8gaGlkZSBkaXZpZGVyIGlmIGZpcnN0IG9yIGxhc3QgdmlzaWJsZSwgb3IgaWYgZm9sbG93ZWQgYnkgYW5vdGhlciBkaXZpZGVyXG4gICAgICAgICAgICAkbGlzVmlzaWJsZS5lYWNoKGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpO1xuXG4gICAgICAgICAgICAgIGlmICgkdGhpcy5oYXNDbGFzcygnZGl2aWRlcicpICYmICgkdGhpcy5pbmRleCgpID09PSAkbGlzVmlzaWJsZS5maXJzdCgpLmluZGV4KCkgfHwgJHRoaXMuaW5kZXgoKSA9PT0gJGxpc1Zpc2libGUubGFzdCgpLmluZGV4KCkgfHwgJGxpc1Zpc2libGUuZXEoaW5kZXggKyAxKS5oYXNDbGFzcygnZGl2aWRlcicpKSkge1xuICAgICAgICAgICAgICAgICR0aGlzLmFkZENsYXNzKCdoaWRkZW4nKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICghdGhhdC4kbGlzLm5vdCgnLmhpZGRlbiwgLm5vLXJlc3VsdHMnKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgaWYgKCEhJG5vX3Jlc3VsdHMucGFyZW50KCkubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgJG5vX3Jlc3VsdHMucmVtb3ZlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgJG5vX3Jlc3VsdHMuaHRtbCh0aGF0Lm9wdGlvbnMubm9uZVJlc3VsdHNUZXh0LnJlcGxhY2UoJ3swfScsICdcIicgKyBodG1sRXNjYXBlKHRoYXQuJHNlYXJjaGJveC52YWwoKSkgKyAnXCInKSkuc2hvdygpO1xuICAgICAgICAgICAgICB0aGF0LiRtZW51SW5uZXIuYXBwZW5kKCRub19yZXN1bHRzKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoISEkbm9fcmVzdWx0cy5wYXJlbnQoKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgJG5vX3Jlc3VsdHMucmVtb3ZlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoYXQuJGxpcy5ub3QoJy5pcy1oaWRkZW4nKS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgICAgICBpZiAoISEkbm9fcmVzdWx0cy5wYXJlbnQoKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgJG5vX3Jlc3VsdHMucmVtb3ZlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdGhhdC4kbGlzLmZpbHRlcignLmFjdGl2ZScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgICBpZiAodGhhdC4kc2VhcmNoYm94LnZhbCgpKSB0aGF0LiRsaXMubm90KCcuaGlkZGVuLCAuZGl2aWRlciwgLmRyb3Bkb3duLWhlYWRlcicpLmVxKDApLmFkZENsYXNzKCdhY3RpdmUnKS5jaGlsZHJlbignYScpLmZvY3VzKCk7XG4gICAgICAgICAgJCh0aGlzKS5mb2N1cygpO1xuICAgICAgICB9KTtcbiAgICAgIH0sXG5cbiAgICAgIF9zZWFyY2hTdHlsZTogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc3R5bGVzID0ge1xuICAgICAgICAgIGJlZ2luczogJ2liZWdpbnMnLFxuICAgICAgICAgIHN0YXJ0c1dpdGg6ICdpYmVnaW5zJ1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBzdHlsZXNbdGhpcy5vcHRpb25zLmxpdmVTZWFyY2hTdHlsZV0gfHwgJ2ljb250YWlucyc7XG4gICAgICB9LFxuXG4gICAgICB2YWw6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgIHRoaXMuJGVsZW1lbnQudmFsKHZhbHVlKTtcbiAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuXG4gICAgICAgICAgcmV0dXJuIHRoaXMuJGVsZW1lbnQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuJGVsZW1lbnQudmFsKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgIGNoYW5nZUFsbDogZnVuY3Rpb24gKHN0YXR1cykge1xuICAgICAgICBpZiAoIXRoaXMubXVsdGlwbGUpIHJldHVybjtcbiAgICAgICAgaWYgKHR5cGVvZiBzdGF0dXMgPT09ICd1bmRlZmluZWQnKSBzdGF0dXMgPSB0cnVlO1xuXG4gICAgICAgIHRoaXMuZmluZExpcygpO1xuXG4gICAgICAgIHZhciAkb3B0aW9ucyA9IHRoaXMuJGVsZW1lbnQuZmluZCgnb3B0aW9uJyksXG4gICAgICAgICAgICAkbGlzVmlzaWJsZSA9IHRoaXMuJGxpcy5ub3QoJy5kaXZpZGVyLCAuZHJvcGRvd24taGVhZGVyLCAuZGlzYWJsZWQsIC5oaWRkZW4nKSxcbiAgICAgICAgICAgIGxpc1Zpc0xlbiA9ICRsaXNWaXNpYmxlLmxlbmd0aCxcbiAgICAgICAgICAgIHNlbGVjdGVkT3B0aW9ucyA9IFtdO1xuXG4gICAgICAgIGlmIChzdGF0dXMpIHtcbiAgICAgICAgICBpZiAoJGxpc1Zpc2libGUuZmlsdGVyKCcuc2VsZWN0ZWQnKS5sZW5ndGggPT09ICRsaXNWaXNpYmxlLmxlbmd0aCkgcmV0dXJuO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmICgkbGlzVmlzaWJsZS5maWx0ZXIoJy5zZWxlY3RlZCcpLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgJGxpc1Zpc2libGUudG9nZ2xlQ2xhc3MoJ3NlbGVjdGVkJywgc3RhdHVzKTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpc1Zpc0xlbjsgaSsrKSB7XG4gICAgICAgICAgdmFyIG9yaWdJbmRleCA9ICRsaXNWaXNpYmxlW2ldLmdldEF0dHJpYnV0ZSgnZGF0YS1vcmlnaW5hbC1pbmRleCcpO1xuICAgICAgICAgIHNlbGVjdGVkT3B0aW9uc1tzZWxlY3RlZE9wdGlvbnMubGVuZ3RoXSA9ICRvcHRpb25zLmVxKG9yaWdJbmRleClbMF07XG4gICAgICAgIH1cblxuICAgICAgICAkKHNlbGVjdGVkT3B0aW9ucykucHJvcCgnc2VsZWN0ZWQnLCBzdGF0dXMpO1xuXG4gICAgICAgIHRoaXMucmVuZGVyKGZhbHNlKTtcblxuICAgICAgICB0aGlzLnRvZ2dsZVBsYWNlaG9sZGVyKCk7XG5cbiAgICAgICAgdGhpcy4kZWxlbWVudC50cmlnZ2VyTmF0aXZlKCdjaGFuZ2UnKTtcbiAgICAgIH0sXG5cbiAgICAgIHNlbGVjdEFsbDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jaGFuZ2VBbGwodHJ1ZSk7XG4gICAgICB9LFxuXG4gICAgICBkZXNlbGVjdEFsbDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jaGFuZ2VBbGwoZmFsc2UpO1xuICAgICAgfSxcblxuICAgICAgdG9nZ2xlOiBmdW5jdGlvbiAoZSkge1xuICAgICAgICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7XG5cbiAgICAgICAgaWYgKGUpIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgdGhpcy4kYnV0dG9uLnRyaWdnZXIoJ2NsaWNrJyk7XG4gICAgICB9LFxuXG4gICAgICBrZXlkb3duOiBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpLFxuICAgICAgICAgICAgJHBhcmVudCA9ICR0aGlzLmlzKCdpbnB1dCcpID8gJHRoaXMucGFyZW50KCkucGFyZW50KCkgOiAkdGhpcy5wYXJlbnQoKSxcbiAgICAgICAgICAgICRpdGVtcyxcbiAgICAgICAgICAgIHRoYXQgPSAkcGFyZW50LmRhdGEoJ3RoaXMnKSxcbiAgICAgICAgICAgIGluZGV4LFxuICAgICAgICAgICAgbmV4dCxcbiAgICAgICAgICAgIGZpcnN0LFxuICAgICAgICAgICAgbGFzdCxcbiAgICAgICAgICAgIHByZXYsXG4gICAgICAgICAgICBuZXh0UHJldixcbiAgICAgICAgICAgIHByZXZJbmRleCxcbiAgICAgICAgICAgIGlzQWN0aXZlLFxuICAgICAgICAgICAgc2VsZWN0b3IgPSAnOm5vdCguZGlzYWJsZWQsIC5oaWRkZW4sIC5kcm9wZG93bi1oZWFkZXIsIC5kaXZpZGVyKScsXG4gICAgICAgICAgICBrZXlDb2RlTWFwID0ge1xuICAgICAgICAgIDMyOiAnICcsXG4gICAgICAgICAgNDg6ICcwJyxcbiAgICAgICAgICA0OTogJzEnLFxuICAgICAgICAgIDUwOiAnMicsXG4gICAgICAgICAgNTE6ICczJyxcbiAgICAgICAgICA1MjogJzQnLFxuICAgICAgICAgIDUzOiAnNScsXG4gICAgICAgICAgNTQ6ICc2JyxcbiAgICAgICAgICA1NTogJzcnLFxuICAgICAgICAgIDU2OiAnOCcsXG4gICAgICAgICAgNTc6ICc5JyxcbiAgICAgICAgICA1OTogJzsnLFxuICAgICAgICAgIDY1OiAnYScsXG4gICAgICAgICAgNjY6ICdiJyxcbiAgICAgICAgICA2NzogJ2MnLFxuICAgICAgICAgIDY4OiAnZCcsXG4gICAgICAgICAgNjk6ICdlJyxcbiAgICAgICAgICA3MDogJ2YnLFxuICAgICAgICAgIDcxOiAnZycsXG4gICAgICAgICAgNzI6ICdoJyxcbiAgICAgICAgICA3MzogJ2knLFxuICAgICAgICAgIDc0OiAnaicsXG4gICAgICAgICAgNzU6ICdrJyxcbiAgICAgICAgICA3NjogJ2wnLFxuICAgICAgICAgIDc3OiAnbScsXG4gICAgICAgICAgNzg6ICduJyxcbiAgICAgICAgICA3OTogJ28nLFxuICAgICAgICAgIDgwOiAncCcsXG4gICAgICAgICAgODE6ICdxJyxcbiAgICAgICAgICA4MjogJ3InLFxuICAgICAgICAgIDgzOiAncycsXG4gICAgICAgICAgODQ6ICd0JyxcbiAgICAgICAgICA4NTogJ3UnLFxuICAgICAgICAgIDg2OiAndicsXG4gICAgICAgICAgODc6ICd3JyxcbiAgICAgICAgICA4ODogJ3gnLFxuICAgICAgICAgIDg5OiAneScsXG4gICAgICAgICAgOTA6ICd6JyxcbiAgICAgICAgICA5NjogJzAnLFxuICAgICAgICAgIDk3OiAnMScsXG4gICAgICAgICAgOTg6ICcyJyxcbiAgICAgICAgICA5OTogJzMnLFxuICAgICAgICAgIDEwMDogJzQnLFxuICAgICAgICAgIDEwMTogJzUnLFxuICAgICAgICAgIDEwMjogJzYnLFxuICAgICAgICAgIDEwMzogJzcnLFxuICAgICAgICAgIDEwNDogJzgnLFxuICAgICAgICAgIDEwNTogJzknXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5saXZlU2VhcmNoKSAkcGFyZW50ID0gJHRoaXMucGFyZW50KCkucGFyZW50KCk7XG5cbiAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5jb250YWluZXIpICRwYXJlbnQgPSB0aGF0LiRtZW51O1xuXG4gICAgICAgICRpdGVtcyA9ICQoJ1tyb2xlPVwibGlzdGJveFwiXSBsaScsICRwYXJlbnQpO1xuXG4gICAgICAgIGlzQWN0aXZlID0gdGhhdC4kbmV3RWxlbWVudC5oYXNDbGFzcygnb3BlbicpO1xuXG4gICAgICAgIGlmICghaXNBY3RpdmUgJiYgKGUua2V5Q29kZSA+PSA0OCAmJiBlLmtleUNvZGUgPD0gNTcgfHwgZS5rZXlDb2RlID49IDk2ICYmIGUua2V5Q29kZSA8PSAxMDUgfHwgZS5rZXlDb2RlID49IDY1ICYmIGUua2V5Q29kZSA8PSA5MCkpIHtcbiAgICAgICAgICBpZiAoIXRoYXQub3B0aW9ucy5jb250YWluZXIpIHtcbiAgICAgICAgICAgIHRoYXQuc2V0U2l6ZSgpO1xuICAgICAgICAgICAgdGhhdC4kbWVudS5wYXJlbnQoKS5hZGRDbGFzcygnb3BlbicpO1xuICAgICAgICAgICAgaXNBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGF0LiRidXR0b24udHJpZ2dlcignY2xpY2snKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhhdC4kc2VhcmNoYm94LmZvY3VzKCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5saXZlU2VhcmNoKSB7XG4gICAgICAgICAgaWYgKC8oXjkkfDI3KS8udGVzdChlLmtleUNvZGUudG9TdHJpbmcoMTApKSAmJiBpc0FjdGl2ZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgIHRoYXQuJGJ1dHRvbi5jbGljaygpLmZvY3VzKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vICRpdGVtcyBjb250YWlucyBsaSBlbGVtZW50cyB3aGVuIGxpdmVTZWFyY2ggaXMgZW5hYmxlZFxuICAgICAgICAgICRpdGVtcyA9ICQoJ1tyb2xlPVwibGlzdGJveFwiXSBsaScgKyBzZWxlY3RvciwgJHBhcmVudCk7XG4gICAgICAgICAgaWYgKCEkdGhpcy52YWwoKSAmJiAhLygzOHw0MCkvLnRlc3QoZS5rZXlDb2RlLnRvU3RyaW5nKDEwKSkpIHtcbiAgICAgICAgICAgIGlmICgkaXRlbXMuZmlsdGVyKCcuYWN0aXZlJykubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICRpdGVtcyA9IHRoYXQuJG1lbnVJbm5lci5maW5kKCdsaScpO1xuICAgICAgICAgICAgICBpZiAodGhhdC5vcHRpb25zLmxpdmVTZWFyY2hOb3JtYWxpemUpIHtcbiAgICAgICAgICAgICAgICAkaXRlbXMgPSAkaXRlbXMuZmlsdGVyKCc6YScgKyB0aGF0Ll9zZWFyY2hTdHlsZSgpICsgJygnICsgbm9ybWFsaXplVG9CYXNlKGtleUNvZGVNYXBbZS5rZXlDb2RlXSkgKyAnKScpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRpdGVtcyA9ICRpdGVtcy5maWx0ZXIoJzonICsgdGhhdC5fc2VhcmNoU3R5bGUoKSArICcoJyArIGtleUNvZGVNYXBbZS5rZXlDb2RlXSArICcpJyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoISRpdGVtcy5sZW5ndGgpIHJldHVybjtcblxuICAgICAgICBpZiAoLygzOHw0MCkvLnRlc3QoZS5rZXlDb2RlLnRvU3RyaW5nKDEwKSkpIHtcbiAgICAgICAgICBpbmRleCA9ICRpdGVtcy5pbmRleCgkaXRlbXMuZmluZCgnYScpLmZpbHRlcignOmZvY3VzJykucGFyZW50KCkpO1xuICAgICAgICAgIGZpcnN0ID0gJGl0ZW1zLmZpbHRlcihzZWxlY3RvcikuZmlyc3QoKS5pbmRleCgpO1xuICAgICAgICAgIGxhc3QgPSAkaXRlbXMuZmlsdGVyKHNlbGVjdG9yKS5sYXN0KCkuaW5kZXgoKTtcbiAgICAgICAgICBuZXh0ID0gJGl0ZW1zLmVxKGluZGV4KS5uZXh0QWxsKHNlbGVjdG9yKS5lcSgwKS5pbmRleCgpO1xuICAgICAgICAgIHByZXYgPSAkaXRlbXMuZXEoaW5kZXgpLnByZXZBbGwoc2VsZWN0b3IpLmVxKDApLmluZGV4KCk7XG4gICAgICAgICAgbmV4dFByZXYgPSAkaXRlbXMuZXEobmV4dCkucHJldkFsbChzZWxlY3RvcikuZXEoMCkuaW5kZXgoKTtcblxuICAgICAgICAgIGlmICh0aGF0Lm9wdGlvbnMubGl2ZVNlYXJjaCkge1xuICAgICAgICAgICAgJGl0ZW1zLmVhY2goZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgICAgICAgaWYgKCEkKHRoaXMpLmhhc0NsYXNzKCdkaXNhYmxlZCcpKSB7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS5kYXRhKCdpbmRleCcsIGkpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGluZGV4ID0gJGl0ZW1zLmluZGV4KCRpdGVtcy5maWx0ZXIoJy5hY3RpdmUnKSk7XG4gICAgICAgICAgICBmaXJzdCA9ICRpdGVtcy5maXJzdCgpLmRhdGEoJ2luZGV4Jyk7XG4gICAgICAgICAgICBsYXN0ID0gJGl0ZW1zLmxhc3QoKS5kYXRhKCdpbmRleCcpO1xuICAgICAgICAgICAgbmV4dCA9ICRpdGVtcy5lcShpbmRleCkubmV4dEFsbCgpLmVxKDApLmRhdGEoJ2luZGV4Jyk7XG4gICAgICAgICAgICBwcmV2ID0gJGl0ZW1zLmVxKGluZGV4KS5wcmV2QWxsKCkuZXEoMCkuZGF0YSgnaW5kZXgnKTtcbiAgICAgICAgICAgIG5leHRQcmV2ID0gJGl0ZW1zLmVxKG5leHQpLnByZXZBbGwoKS5lcSgwKS5kYXRhKCdpbmRleCcpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHByZXZJbmRleCA9ICR0aGlzLmRhdGEoJ3ByZXZJbmRleCcpO1xuXG4gICAgICAgICAgaWYgKGUua2V5Q29kZSA9PSAzOCkge1xuICAgICAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5saXZlU2VhcmNoKSBpbmRleC0tO1xuICAgICAgICAgICAgaWYgKGluZGV4ICE9IG5leHRQcmV2ICYmIGluZGV4ID4gcHJldikgaW5kZXggPSBwcmV2O1xuICAgICAgICAgICAgaWYgKGluZGV4IDwgZmlyc3QpIGluZGV4ID0gZmlyc3Q7XG4gICAgICAgICAgICBpZiAoaW5kZXggPT0gcHJldkluZGV4KSBpbmRleCA9IGxhc3Q7XG4gICAgICAgICAgfSBlbHNlIGlmIChlLmtleUNvZGUgPT0gNDApIHtcbiAgICAgICAgICAgIGlmICh0aGF0Lm9wdGlvbnMubGl2ZVNlYXJjaCkgaW5kZXgrKztcbiAgICAgICAgICAgIGlmIChpbmRleCA9PSAtMSkgaW5kZXggPSAwO1xuICAgICAgICAgICAgaWYgKGluZGV4ICE9IG5leHRQcmV2ICYmIGluZGV4IDwgbmV4dCkgaW5kZXggPSBuZXh0O1xuICAgICAgICAgICAgaWYgKGluZGV4ID4gbGFzdCkgaW5kZXggPSBsYXN0O1xuICAgICAgICAgICAgaWYgKGluZGV4ID09IHByZXZJbmRleCkgaW5kZXggPSBmaXJzdDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAkdGhpcy5kYXRhKCdwcmV2SW5kZXgnLCBpbmRleCk7XG5cbiAgICAgICAgICBpZiAoIXRoYXQub3B0aW9ucy5saXZlU2VhcmNoKSB7XG4gICAgICAgICAgICAkaXRlbXMuZXEoaW5kZXgpLmNoaWxkcmVuKCdhJykuZm9jdXMoKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgaWYgKCEkdGhpcy5oYXNDbGFzcygnZHJvcGRvd24tdG9nZ2xlJykpIHtcbiAgICAgICAgICAgICAgJGl0ZW1zLnJlbW92ZUNsYXNzKCdhY3RpdmUnKS5lcShpbmRleCkuYWRkQ2xhc3MoJ2FjdGl2ZScpLmNoaWxkcmVuKCdhJykuZm9jdXMoKTtcbiAgICAgICAgICAgICAgJHRoaXMuZm9jdXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoISR0aGlzLmlzKCdpbnB1dCcpKSB7XG4gICAgICAgICAgdmFyIGtleUluZGV4ID0gW10sXG4gICAgICAgICAgICAgIGNvdW50LFxuICAgICAgICAgICAgICBwcmV2S2V5O1xuXG4gICAgICAgICAgJGl0ZW1zLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCEkKHRoaXMpLmhhc0NsYXNzKCdkaXNhYmxlZCcpKSB7XG4gICAgICAgICAgICAgIGlmICgkLnRyaW0oJCh0aGlzKS5jaGlsZHJlbignYScpLnRleHQoKS50b0xvd2VyQ2FzZSgpKS5zdWJzdHJpbmcoMCwgMSkgPT0ga2V5Q29kZU1hcFtlLmtleUNvZGVdKSB7XG4gICAgICAgICAgICAgICAga2V5SW5kZXgucHVzaCgkKHRoaXMpLmluZGV4KCkpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBjb3VudCA9ICQoZG9jdW1lbnQpLmRhdGEoJ2tleWNvdW50Jyk7XG4gICAgICAgICAgY291bnQrKztcbiAgICAgICAgICAkKGRvY3VtZW50KS5kYXRhKCdrZXljb3VudCcsIGNvdW50KTtcblxuICAgICAgICAgIHByZXZLZXkgPSAkLnRyaW0oJCgnOmZvY3VzJykudGV4dCgpLnRvTG93ZXJDYXNlKCkpLnN1YnN0cmluZygwLCAxKTtcblxuICAgICAgICAgIGlmIChwcmV2S2V5ICE9IGtleUNvZGVNYXBbZS5rZXlDb2RlXSkge1xuICAgICAgICAgICAgY291bnQgPSAxO1xuICAgICAgICAgICAgJChkb2N1bWVudCkuZGF0YSgna2V5Y291bnQnLCBjb3VudCk7XG4gICAgICAgICAgfSBlbHNlIGlmIChjb3VudCA+PSBrZXlJbmRleC5sZW5ndGgpIHtcbiAgICAgICAgICAgICQoZG9jdW1lbnQpLmRhdGEoJ2tleWNvdW50JywgMCk7XG4gICAgICAgICAgICBpZiAoY291bnQgPiBrZXlJbmRleC5sZW5ndGgpIGNvdW50ID0gMTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAkaXRlbXMuZXEoa2V5SW5kZXhbY291bnQgLSAxXSkuY2hpbGRyZW4oJ2EnKS5mb2N1cygpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2VsZWN0IGZvY3VzZWQgb3B0aW9uIGlmIFwiRW50ZXJcIiwgXCJTcGFjZWJhclwiIG9yIFwiVGFiXCIgKHdoZW4gc2VsZWN0T25UYWIgaXMgdHJ1ZSkgYXJlIHByZXNzZWQgaW5zaWRlIHRoZSBtZW51LlxuICAgICAgICBpZiAoKC8oMTN8MzIpLy50ZXN0KGUua2V5Q29kZS50b1N0cmluZygxMCkpIHx8IC8oXjkkKS8udGVzdChlLmtleUNvZGUudG9TdHJpbmcoMTApKSAmJiB0aGF0Lm9wdGlvbnMuc2VsZWN0T25UYWIpICYmIGlzQWN0aXZlKSB7XG4gICAgICAgICAgaWYgKCEvKDMyKS8udGVzdChlLmtleUNvZGUudG9TdHJpbmcoMTApKSkgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIGlmICghdGhhdC5vcHRpb25zLmxpdmVTZWFyY2gpIHtcbiAgICAgICAgICAgIHZhciBlbGVtID0gJCgnOmZvY3VzJyk7XG4gICAgICAgICAgICBlbGVtLmNsaWNrKCk7XG4gICAgICAgICAgICAvLyBCcmluZyBiYWNrIGZvY3VzIGZvciBtdWx0aXNlbGVjdHNcbiAgICAgICAgICAgIGVsZW0uZm9jdXMoKTtcbiAgICAgICAgICAgIC8vIFByZXZlbnQgc2NyZWVuIGZyb20gc2Nyb2xsaW5nIGlmIHRoZSB1c2VyIGhpdCB0aGUgc3BhY2ViYXJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIC8vIEZpeGVzIHNwYWNlYmFyIHNlbGVjdGlvbiBvZiBkcm9wZG93biBpdGVtcyBpbiBGRiAmIElFXG4gICAgICAgICAgICAkKGRvY3VtZW50KS5kYXRhKCdzcGFjZVNlbGVjdCcsIHRydWUpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoIS8oMzIpLy50ZXN0KGUua2V5Q29kZS50b1N0cmluZygxMCkpKSB7XG4gICAgICAgICAgICB0aGF0LiRtZW51SW5uZXIuZmluZCgnLmFjdGl2ZSBhJykuY2xpY2soKTtcbiAgICAgICAgICAgICR0aGlzLmZvY3VzKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgICQoZG9jdW1lbnQpLmRhdGEoJ2tleWNvdW50JywgMCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoLyheOSR8MjcpLy50ZXN0KGUua2V5Q29kZS50b1N0cmluZygxMCkpICYmIGlzQWN0aXZlICYmICh0aGF0Lm11bHRpcGxlIHx8IHRoYXQub3B0aW9ucy5saXZlU2VhcmNoKSB8fCAvKDI3KS8udGVzdChlLmtleUNvZGUudG9TdHJpbmcoMTApKSAmJiAhaXNBY3RpdmUpIHtcbiAgICAgICAgICB0aGF0LiRtZW51LnBhcmVudCgpLnJlbW92ZUNsYXNzKCdvcGVuJyk7XG4gICAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5jb250YWluZXIpIHRoYXQuJG5ld0VsZW1lbnQucmVtb3ZlQ2xhc3MoJ29wZW4nKTtcbiAgICAgICAgICB0aGF0LiRidXR0b24uZm9jdXMoKTtcbiAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgbW9iaWxlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuJGVsZW1lbnQuYWRkQ2xhc3MoJ21vYmlsZS1kZXZpY2UnKTtcbiAgICAgIH0sXG5cbiAgICAgIHJlZnJlc2g6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy4kbGlzID0gbnVsbDtcbiAgICAgICAgdGhpcy5saU9iaiA9IHt9O1xuICAgICAgICB0aGlzLnJlbG9hZExpKCk7XG4gICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgIHRoaXMuY2hlY2tEaXNhYmxlZCgpO1xuICAgICAgICB0aGlzLmxpSGVpZ2h0KHRydWUpO1xuICAgICAgICB0aGlzLnNldFN0eWxlKCk7XG4gICAgICAgIHRoaXMuc2V0V2lkdGgoKTtcbiAgICAgICAgaWYgKHRoaXMuJGxpcykgdGhpcy4kc2VhcmNoYm94LnRyaWdnZXIoJ3Byb3BlcnR5Y2hhbmdlJyk7XG5cbiAgICAgICAgdGhpcy4kZWxlbWVudC50cmlnZ2VyKCdyZWZyZXNoZWQuYnMuc2VsZWN0Jyk7XG4gICAgICB9LFxuXG4gICAgICBoaWRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuJG5ld0VsZW1lbnQuaGlkZSgpO1xuICAgICAgfSxcblxuICAgICAgc2hvdzogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLiRuZXdFbGVtZW50LnNob3coKTtcbiAgICAgIH0sXG5cbiAgICAgIHJlbW92ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLiRuZXdFbGVtZW50LnJlbW92ZSgpO1xuICAgICAgICB0aGlzLiRlbGVtZW50LnJlbW92ZSgpO1xuICAgICAgfSxcblxuICAgICAgZGVzdHJveTogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLiRuZXdFbGVtZW50LmJlZm9yZSh0aGlzLiRlbGVtZW50KS5yZW1vdmUoKTtcblxuICAgICAgICBpZiAodGhpcy4kYnNDb250YWluZXIpIHtcbiAgICAgICAgICB0aGlzLiRic0NvbnRhaW5lci5yZW1vdmUoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLiRtZW51LnJlbW92ZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy4kZWxlbWVudC5vZmYoJy5icy5zZWxlY3QnKS5yZW1vdmVEYXRhKCdzZWxlY3RwaWNrZXInKS5yZW1vdmVDbGFzcygnYnMtc2VsZWN0LWhpZGRlbiBzZWxlY3RwaWNrZXInKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLy8gU0VMRUNUUElDS0VSIFBMVUdJTiBERUZJTklUSU9OXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgZnVuY3Rpb24gUGx1Z2luKG9wdGlvbiwgZXZlbnQpIHtcbiAgICAgIC8vIGdldCB0aGUgYXJncyBvZiB0aGUgb3V0ZXIgZnVuY3Rpb24uLlxuICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICAvLyBUaGUgYXJndW1lbnRzIG9mIHRoZSBmdW5jdGlvbiBhcmUgZXhwbGljaXRseSByZS1kZWZpbmVkIGZyb20gdGhlIGFyZ3VtZW50IGxpc3QsIGJlY2F1c2UgdGhlIHNoaWZ0IGNhdXNlcyB0aGVtXG4gICAgICAvLyB0byBnZXQgbG9zdC9jb3JydXB0ZWQgaW4gYW5kcm9pZCAyLjMgYW5kIElFOSAjNzE1ICM3NzVcbiAgICAgIHZhciBfb3B0aW9uID0gb3B0aW9uLFxuICAgICAgICAgIF9ldmVudCA9IGV2ZW50O1xuICAgICAgW10uc2hpZnQuYXBwbHkoYXJncyk7XG5cbiAgICAgIHZhciB2YWx1ZTtcbiAgICAgIHZhciBjaGFpbiA9IHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciAkdGhpcyA9ICQodGhpcyk7XG4gICAgICAgIGlmICgkdGhpcy5pcygnc2VsZWN0JykpIHtcbiAgICAgICAgICB2YXIgZGF0YSA9ICR0aGlzLmRhdGEoJ3NlbGVjdHBpY2tlcicpLFxuICAgICAgICAgICAgICBvcHRpb25zID0gdHlwZW9mIF9vcHRpb24gPT0gJ29iamVjdCcgJiYgX29wdGlvbjtcblxuICAgICAgICAgIGlmICghZGF0YSkge1xuICAgICAgICAgICAgdmFyIGNvbmZpZyA9ICQuZXh0ZW5kKHt9LCBTZWxlY3RwaWNrZXIuREVGQVVMVFMsICQuZm4uc2VsZWN0cGlja2VyLmRlZmF1bHRzIHx8IHt9LCAkdGhpcy5kYXRhKCksIG9wdGlvbnMpO1xuICAgICAgICAgICAgY29uZmlnLnRlbXBsYXRlID0gJC5leHRlbmQoe30sIFNlbGVjdHBpY2tlci5ERUZBVUxUUy50ZW1wbGF0ZSwgJC5mbi5zZWxlY3RwaWNrZXIuZGVmYXVsdHMgPyAkLmZuLnNlbGVjdHBpY2tlci5kZWZhdWx0cy50ZW1wbGF0ZSA6IHt9LCAkdGhpcy5kYXRhKCkudGVtcGxhdGUsIG9wdGlvbnMudGVtcGxhdGUpO1xuICAgICAgICAgICAgJHRoaXMuZGF0YSgnc2VsZWN0cGlja2VyJywgZGF0YSA9IG5ldyBTZWxlY3RwaWNrZXIodGhpcywgY29uZmlnLCBfZXZlbnQpKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKG9wdGlvbnMpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gb3B0aW9ucykge1xuICAgICAgICAgICAgICBpZiAob3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShpKSkge1xuICAgICAgICAgICAgICAgIGRhdGEub3B0aW9uc1tpXSA9IG9wdGlvbnNbaV07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAodHlwZW9mIF9vcHRpb24gPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGlmIChkYXRhW19vcHRpb25dIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcbiAgICAgICAgICAgICAgdmFsdWUgPSBkYXRhW19vcHRpb25dLmFwcGx5KGRhdGEsIGFyZ3MpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdmFsdWUgPSBkYXRhLm9wdGlvbnNbX29wdGlvbl07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgLy9ub2luc3BlY3Rpb24gSlNVbnVzZWRBc3NpZ25tZW50XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBjaGFpbjtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgb2xkID0gJC5mbi5zZWxlY3RwaWNrZXI7XG4gICAgJC5mbi5zZWxlY3RwaWNrZXIgPSBQbHVnaW47XG4gICAgJC5mbi5zZWxlY3RwaWNrZXIuQ29uc3RydWN0b3IgPSBTZWxlY3RwaWNrZXI7XG5cbiAgICAvLyBTRUxFQ1RQSUNLRVIgTk8gQ09ORkxJQ1RcbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAkLmZuLnNlbGVjdHBpY2tlci5ub0NvbmZsaWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgJC5mbi5zZWxlY3RwaWNrZXIgPSBvbGQ7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuXG4gICAgJChkb2N1bWVudCkuZGF0YSgna2V5Y291bnQnLCAwKS5vbigna2V5ZG93bi5icy5zZWxlY3QnLCAnLmJvb3RzdHJhcC1zZWxlY3QgW2RhdGEtdG9nZ2xlPWRyb3Bkb3duXSwgLmJvb3RzdHJhcC1zZWxlY3QgW3JvbGU9XCJsaXN0Ym94XCJdLCAuYnMtc2VhcmNoYm94IGlucHV0JywgU2VsZWN0cGlja2VyLnByb3RvdHlwZS5rZXlkb3duKS5vbignZm9jdXNpbi5tb2RhbCcsICcuYm9vdHN0cmFwLXNlbGVjdCBbZGF0YS10b2dnbGU9ZHJvcGRvd25dLCAuYm9vdHN0cmFwLXNlbGVjdCBbcm9sZT1cImxpc3Rib3hcIl0sIC5icy1zZWFyY2hib3ggaW5wdXQnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB9KTtcblxuICAgIC8vIFNFTEVDVFBJQ0tFUiBEQVRBLUFQSVxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PVxuICAgICQod2luZG93KS5vbignbG9hZC5icy5zZWxlY3QuZGF0YS1hcGknLCBmdW5jdGlvbiAoKSB7XG4gICAgICAkKCcuc2VsZWN0cGlja2VyJykuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciAkc2VsZWN0cGlja2VyID0gJCh0aGlzKTtcbiAgICAgICAgUGx1Z2luLmNhbGwoJHNlbGVjdHBpY2tlciwgJHNlbGVjdHBpY2tlci5kYXRhKCkpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pKGpRdWVyeSk7XG59KTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYm9vdHN0cmFwLXNlbGVjdC9kaXN0L2pzL2Jvb3RzdHJhcC1zZWxlY3QuanNcbi8vIG1vZHVsZSBpZCA9IDEyOFxuLy8gbW9kdWxlIGNodW5rcyA9IDE3Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");
}});
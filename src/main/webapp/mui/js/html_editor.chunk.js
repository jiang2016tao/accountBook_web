webpackJsonp([20,33],{55:function(module,exports,__webpack_require__){eval('// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n// This is CodeMirror (http://codemirror.net), a code editor\n// implemented in JavaScript on top of the browser\'s DOM.\n//\n// You can find some technical background for some of the code below\n// at http://marijnhaverbeke.nl/blog/#cm-internals .\n(function(global,factory){ true?module.exports=factory():typeof define===\'function\'&&define.amd?define(factory):global.CodeMirror=factory();})(this,function(){\'use strict\';// Kludges for bugs and behavior differences that can\'t be feature\n// detected are enabled based on userAgent etc sniffing.\nvar userAgent=navigator.userAgent;var platform=navigator.platform;var gecko=/gecko\\/\\d/i.test(userAgent);var ie_upto10=/MSIE \\d/.test(userAgent);var ie_11up=/Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(userAgent);var ie=ie_upto10||ie_11up;var ie_version=ie&&(ie_upto10?document.documentMode||6:ie_11up[1]);var webkit=/WebKit\\//.test(userAgent);var qtwebkit=webkit&&/Qt\\/\\d+\\.\\d+/.test(userAgent);var chrome=/Chrome\\//.test(userAgent);var presto=/Opera\\//.test(userAgent);var safari=/Apple Computer/.test(navigator.vendor);var mac_geMountainLion=/Mac OS X 1\\d\\D([8-9]|\\d\\d)\\D/.test(userAgent);var phantom=/PhantomJS/.test(userAgent);var ios=/AppleWebKit/.test(userAgent)&&/Mobile\\/\\w+/.test(userAgent);// This is woefully incomplete. Suggestions for alternative methods welcome.\nvar mobile=ios||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(userAgent);var mac=ios||/Mac/.test(platform);var chromeOS=/\\bCrOS\\b/.test(userAgent);var windows=/win/i.test(platform);var presto_version=presto&&userAgent.match(/Version\\/(\\d*\\.\\d*)/);if(presto_version){presto_version=Number(presto_version[1]);}if(presto_version&&presto_version>=15){presto=false;webkit=true;}// Some browsers use the wrong event properties to signal cmd/ctrl on OS X\nvar flipCtrlCmd=mac&&(qtwebkit||presto&&(presto_version==null||presto_version<12.11));var captureRightClick=gecko||ie&&ie_version>=9;function classTest(cls){return new RegExp("(^|\\\\s)"+cls+"(?:$|\\\\s)\\\\s*");}var rmClass=function(node,cls){var current=node.className;var match=classTest(cls).exec(current);if(match){var after=current.slice(match.index+match[0].length);node.className=current.slice(0,match.index)+(after?match[1]+after:"");}};function removeChildren(e){for(var count=e.childNodes.length;count>0;--count){e.removeChild(e.firstChild);}return e;}function removeChildrenAndAdd(parent,e){return removeChildren(parent).appendChild(e);}function elt(tag,content,className,style){var e=document.createElement(tag);if(className){e.className=className;}if(style){e.style.cssText=style;}if(typeof content=="string"){e.appendChild(document.createTextNode(content));}else if(content){for(var i=0;i<content.length;++i){e.appendChild(content[i]);}}return e;}var range;if(document.createRange){range=function(node,start,end,endNode){var r=document.createRange();r.setEnd(endNode||node,end);r.setStart(node,start);return r;};}else{range=function(node,start,end){var r=document.body.createTextRange();try{r.moveToElementText(node.parentNode);}catch(e){return r;}r.collapse(true);r.moveEnd("character",end);r.moveStart("character",start);return r;};}function contains(parent,child){if(child.nodeType==3)// Android browser always returns false when child is a textnode\n{child=child.parentNode;}if(parent.contains){return parent.contains(child);}do{if(child.nodeType==11){child=child.host;}if(child==parent){return true;}}while(child=child.parentNode);}var activeElt=function(){var activeElement=document.activeElement;while(activeElement&&activeElement.root&&activeElement.root.activeElement){activeElement=activeElement.root.activeElement;}return activeElement;};// Older versions of IE throws unspecified error when touching\n// document.activeElement in some cases (during loading, in iframe)\nif(ie&&ie_version<11){activeElt=function(){try{return document.activeElement;}catch(e){return document.body;}};}function addClass(node,cls){var current=node.className;if(!classTest(cls).test(current)){node.className+=(current?" ":"")+cls;}}function joinClasses(a,b){var as=a.split(" ");for(var i=0;i<as.length;i++){if(as[i]&&!classTest(as[i]).test(b)){b+=" "+as[i];}}return b;}var selectInput=function(node){node.select();};if(ios)// Mobile Safari apparently has a bug where select() is broken.\n{selectInput=function(node){node.selectionStart=0;node.selectionEnd=node.value.length;};}else if(ie)// Suppress mysterious IE10 errors\n{selectInput=function(node){try{node.select();}catch(_e){}};}function bind(f){var args=Array.prototype.slice.call(arguments,1);return function(){return f.apply(null,args);};}function copyObj(obj,target,overwrite){if(!target){target={};}for(var prop in obj){if(obj.hasOwnProperty(prop)&&(overwrite!==false||!target.hasOwnProperty(prop))){target[prop]=obj[prop];}}return target;}// Counts the column offset in a string, taking tabs into account.\n// Used mostly to find indentation.\nfunction countColumn(string,end,tabSize,startIndex,startValue){if(end==null){end=string.search(/[^\\s\\u00a0]/);if(end==-1){end=string.length;}}for(var i=startIndex||0,n=startValue||0;;){var nextTab=string.indexOf("\\t",i);if(nextTab<0||nextTab>=end){return n+(end-i);}n+=nextTab-i;n+=tabSize-n%tabSize;i=nextTab+1;}}function Delayed(){this.id=null;}Delayed.prototype.set=function(ms,f){clearTimeout(this.id);this.id=setTimeout(f,ms);};function indexOf(array,elt){for(var i=0;i<array.length;++i){if(array[i]==elt){return i;}}return-1;}// Number of pixels added to scroller and sizer to hide scrollbar\nvar scrollerGap=30;// Returned or thrown by various protocols to signal \'I\'m not\n// handling this\'.\nvar Pass={toString:function(){return"CodeMirror.Pass";}};// Reused option objects for setSelection & friends\nvar sel_dontScroll={scroll:false};var sel_mouse={origin:"*mouse"};var sel_move={origin:"+move"};// The inverse of countColumn -- find the offset that corresponds to\n// a particular column.\nfunction findColumn(string,goal,tabSize){for(var pos=0,col=0;;){var nextTab=string.indexOf("\\t",pos);if(nextTab==-1){nextTab=string.length;}var skipped=nextTab-pos;if(nextTab==string.length||col+skipped>=goal){return pos+Math.min(skipped,goal-col);}col+=nextTab-pos;col+=tabSize-col%tabSize;pos=nextTab+1;if(col>=goal){return pos;}}}var spaceStrs=[""];function spaceStr(n){while(spaceStrs.length<=n){spaceStrs.push(lst(spaceStrs)+" ");}return spaceStrs[n];}function lst(arr){return arr[arr.length-1];}function map(array,f){var out=[];for(var i=0;i<array.length;i++){out[i]=f(array[i],i);}return out;}function insertSorted(array,value,score){var pos=0,priority=score(value);while(pos<array.length&&score(array[pos])<=priority){pos++;}array.splice(pos,0,value);}function nothing(){}function createObj(base,props){var inst;if(Object.create){inst=Object.create(base);}else{nothing.prototype=base;inst=new nothing();}if(props){copyObj(props,inst);}return inst;}var nonASCIISingleCaseWordChar=/[\\u00df\\u0587\\u0590-\\u05f4\\u0600-\\u06ff\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/;function isWordCharBasic(ch){return /\\w/.test(ch)||ch>"\\x80"&&(ch.toUpperCase()!=ch.toLowerCase()||nonASCIISingleCaseWordChar.test(ch));}function isWordChar(ch,helper){if(!helper){return isWordCharBasic(ch);}if(helper.source.indexOf("\\\\w")>-1&&isWordCharBasic(ch)){return true;}return helper.test(ch);}function isEmpty(obj){for(var n in obj){if(obj.hasOwnProperty(n)&&obj[n]){return false;}}return true;}// Extending unicode characters. A series of a non-extending char +\n// any number of extending chars is treated as a single unit as far\n// as editing and measuring is concerned. This is not fully correct,\n// since some scripts/fonts/browsers also treat other configurations\n// of code points as a group.\nvar extendingChars=/[\\u0300-\\u036f\\u0483-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u064b-\\u065e\\u0670\\u06d6-\\u06dc\\u06de-\\u06e4\\u06e7\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0900-\\u0902\\u093c\\u0941-\\u0948\\u094d\\u0951-\\u0955\\u0962\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2\\u09e3\\u0a01\\u0a02\\u0a3c\\u0a41\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70\\u0a71\\u0a75\\u0a81\\u0a82\\u0abc\\u0ac1-\\u0ac5\\u0ac7\\u0ac8\\u0acd\\u0ae2\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57\\u0b62\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62\\u0c63\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc\\u0ccd\\u0cd5\\u0cd6\\u0ce2\\u0ce3\\u0d3e\\u0d41-\\u0d44\\u0d4d\\u0d57\\u0d62\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9\\u0ebb\\u0ebc\\u0ec8-\\u0ecd\\u0f18\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86\\u0f87\\u0f90-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039\\u103a\\u103d\\u103e\\u1058\\u1059\\u105e-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108d\\u109d\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193b\\u1a17\\u1a18\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1b00-\\u1b03\\u1b34\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80\\u1b81\\u1ba2-\\u1ba5\\u1ba8\\u1ba9\\u1c2c-\\u1c33\\u1c36\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1dc0-\\u1de6\\u1dfd-\\u1dff\\u200c\\u200d\\u20d0-\\u20f0\\u2cef-\\u2cf1\\u2de0-\\u2dff\\u302a-\\u302f\\u3099\\u309a\\ua66f-\\ua672\\ua67c\\ua67d\\ua6f0\\ua6f1\\ua802\\ua806\\ua80b\\ua825\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc\\uaa29-\\uaa2e\\uaa31\\uaa32\\uaa35\\uaa36\\uaa43\\uaa4c\\uaab0\\uaab2-\\uaab4\\uaab7\\uaab8\\uaabe\\uaabf\\uaac1\\uabe5\\uabe8\\uabed\\udc00-\\udfff\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe26\\uff9e\\uff9f]/;function isExtendingChar(ch){return ch.charCodeAt(0)>=768&&extendingChars.test(ch);}// The display handles the DOM integration, both for input reading\n// and content drawing. It holds references to DOM nodes and\n// display-related state.\nfunction Display(place,doc,input){var d=this;this.input=input;// Covers bottom-right square when both scrollbars are present.\nd.scrollbarFiller=elt("div",null,"CodeMirror-scrollbar-filler");d.scrollbarFiller.setAttribute("cm-not-content","true");// Covers bottom of gutter when coverGutterNextToScrollbar is on\n// and h scrollbar is present.\nd.gutterFiller=elt("div",null,"CodeMirror-gutter-filler");d.gutterFiller.setAttribute("cm-not-content","true");// Will contain the actual code, positioned to cover the viewport.\nd.lineDiv=elt("div",null,"CodeMirror-code");// Elements are added to these to represent selection and cursors.\nd.selectionDiv=elt("div",null,null,"position: relative; z-index: 1");d.cursorDiv=elt("div",null,"CodeMirror-cursors");// A visibility: hidden element used to find the size of things.\nd.measure=elt("div",null,"CodeMirror-measure");// When lines outside of the viewport are measured, they are drawn in this.\nd.lineMeasure=elt("div",null,"CodeMirror-measure");// Wraps everything that needs to exist inside the vertically-padded coordinate system\nd.lineSpace=elt("div",[d.measure,d.lineMeasure,d.selectionDiv,d.cursorDiv,d.lineDiv],null,"position: relative; outline: none");// Moved around its parent to cover visible view.\nd.mover=elt("div",[elt("div",[d.lineSpace],"CodeMirror-lines")],null,"position: relative");// Set to the height of the document, allowing scrolling.\nd.sizer=elt("div",[d.mover],"CodeMirror-sizer");d.sizerWidth=null;// Behavior of elts with overflow: auto and padding is\n// inconsistent across browsers. This is used to ensure the\n// scrollable area is big enough.\nd.heightForcer=elt("div",null,null,"position: absolute; height: "+scrollerGap+"px; width: 1px;");// Will contain the gutters, if any.\nd.gutters=elt("div",null,"CodeMirror-gutters");d.lineGutter=null;// Actual scrollable element.\nd.scroller=elt("div",[d.sizer,d.heightForcer,d.gutters],"CodeMirror-scroll");d.scroller.setAttribute("tabIndex","-1");// The element in which the editor lives.\nd.wrapper=elt("div",[d.scrollbarFiller,d.gutterFiller,d.scroller],"CodeMirror");// Work around IE7 z-index bug (not perfect, hence IE7 not really being supported)\nif(ie&&ie_version<8){d.gutters.style.zIndex=-1;d.scroller.style.paddingRight=0;}if(!webkit&&!(gecko&&mobile)){d.scroller.draggable=true;}if(place){if(place.appendChild){place.appendChild(d.wrapper);}else{place(d.wrapper);}}// Current rendered range (may be bigger than the view window).\nd.viewFrom=d.viewTo=doc.first;d.reportedViewFrom=d.reportedViewTo=doc.first;// Information about the rendered lines.\nd.view=[];d.renderedView=null;// Holds info about a single rendered line when it was rendered\n// for measurement, while not in view.\nd.externalMeasured=null;// Empty space (in pixels) above the view\nd.viewOffset=0;d.lastWrapHeight=d.lastWrapWidth=0;d.updateLineNumbers=null;d.nativeBarWidth=d.barHeight=d.barWidth=0;d.scrollbarsClipped=false;// Used to only resize the line number gutter when necessary (when\n// the amount of lines crosses a boundary that makes its width change)\nd.lineNumWidth=d.lineNumInnerWidth=d.lineNumChars=null;// Set to true when a non-horizontal-scrolling line widget is\n// added. As an optimization, line widget aligning is skipped when\n// this is false.\nd.alignWidgets=false;d.cachedCharWidth=d.cachedTextHeight=d.cachedPaddingH=null;// Tracks the maximum line length so that the horizontal scrollbar\n// can be kept static when scrolling.\nd.maxLine=null;d.maxLineLength=0;d.maxLineChanged=false;// Used for measuring wheel scrolling granularity\nd.wheelDX=d.wheelDY=d.wheelStartX=d.wheelStartY=null;// True when shift is held down.\nd.shift=false;// Used to track whether anything happened since the context menu\n// was opened.\nd.selForContextMenu=null;d.activeTouch=null;input.init(d);}// Find the line object corresponding to the given line number.\nfunction getLine(doc,n){n-=doc.first;if(n<0||n>=doc.size){throw new Error("There is no line "+(n+doc.first)+" in the document.");}var chunk=doc;while(!chunk.lines){for(var i=0;;++i){var child=chunk.children[i],sz=child.chunkSize();if(n<sz){chunk=child;break;}n-=sz;}}return chunk.lines[n];}// Get the part of a document between two positions, as an array of\n// strings.\nfunction getBetween(doc,start,end){var out=[],n=start.line;doc.iter(start.line,end.line+1,function(line){var text=line.text;if(n==end.line){text=text.slice(0,end.ch);}if(n==start.line){text=text.slice(start.ch);}out.push(text);++n;});return out;}// Get the lines between from and to, as array of strings.\nfunction getLines(doc,from,to){var out=[];doc.iter(from,to,function(line){out.push(line.text);});// iter aborts when callback returns truthy value\nreturn out;}// Update the height of a line, propagating the height change\n// upwards to parent nodes.\nfunction updateLineHeight(line,height){var diff=height-line.height;if(diff){for(var n=line;n;n=n.parent){n.height+=diff;}}}// Given a line object, find its line number by walking up through\n// its parent links.\nfunction lineNo(line){if(line.parent==null){return null;}var cur=line.parent,no=indexOf(cur.lines,line);for(var chunk=cur.parent;chunk;cur=chunk,chunk=chunk.parent){for(var i=0;;++i){if(chunk.children[i]==cur){break;}no+=chunk.children[i].chunkSize();}}return no+cur.first;}// Find the line at the given vertical position, using the height\n// information in the document tree.\nfunction lineAtHeight(chunk,h){var n=chunk.first;outer:do{for(var i$1=0;i$1<chunk.children.length;++i$1){var child=chunk.children[i$1],ch=child.height;if(h<ch){chunk=child;continue outer;}h-=ch;n+=child.chunkSize();}return n;}while(!chunk.lines);var i=0;for(;i<chunk.lines.length;++i){var line=chunk.lines[i],lh=line.height;if(h<lh){break;}h-=lh;}return n+i;}function isLine(doc,l){return l>=doc.first&&l<doc.first+doc.size;}function lineNumberFor(options,i){return String(options.lineNumberFormatter(i+options.firstLineNumber));}// A Pos instance represents a position within the text.\nfunction Pos(line,ch){if(!(this instanceof Pos)){return new Pos(line,ch);}this.line=line;this.ch=ch;}// Compare two positions, return 0 if they are the same, a negative\n// number when a is less, and a positive number otherwise.\nfunction cmp(a,b){return a.line-b.line||a.ch-b.ch;}function copyPos(x){return Pos(x.line,x.ch);}function maxPos(a,b){return cmp(a,b)<0?b:a;}function minPos(a,b){return cmp(a,b)<0?a:b;}// Most of the external API clips given positions to make sure they\n// actually exist within the document.\nfunction clipLine(doc,n){return Math.max(doc.first,Math.min(n,doc.first+doc.size-1));}function clipPos(doc,pos){if(pos.line<doc.first){return Pos(doc.first,0);}var last=doc.first+doc.size-1;if(pos.line>last){return Pos(last,getLine(doc,last).text.length);}return clipToLen(pos,getLine(doc,pos.line).text.length);}function clipToLen(pos,linelen){var ch=pos.ch;if(ch==null||ch>linelen){return Pos(pos.line,linelen);}else if(ch<0){return Pos(pos.line,0);}else{return pos;}}function clipPosArray(doc,array){var out=[];for(var i=0;i<array.length;i++){out[i]=clipPos(doc,array[i]);}return out;}// Optimize some code when these features are not used.\nvar sawReadOnlySpans=false;var sawCollapsedSpans=false;function seeReadOnlySpans(){sawReadOnlySpans=true;}function seeCollapsedSpans(){sawCollapsedSpans=true;}// TEXTMARKER SPANS\nfunction MarkedSpan(marker,from,to){this.marker=marker;this.from=from;this.to=to;}// Search an array of spans for a span matching the given marker.\nfunction getMarkedSpanFor(spans,marker){if(spans){for(var i=0;i<spans.length;++i){var span=spans[i];if(span.marker==marker){return span;}}}}// Remove a span from an array, returning undefined if no spans are\n// left (we don\'t store arrays for lines without spans).\nfunction removeMarkedSpan(spans,span){var r;for(var i=0;i<spans.length;++i){if(spans[i]!=span){(r||(r=[])).push(spans[i]);}}return r;}// Add a span to a line.\nfunction addMarkedSpan(line,span){line.markedSpans=line.markedSpans?line.markedSpans.concat([span]):[span];span.marker.attachLine(line);}// Used for the algorithm that adjusts markers for a change in the\n// document. These functions cut an array of spans at a given\n// character position, returning an array of remaining chunks (or\n// undefined if nothing remains).\nfunction markedSpansBefore(old,startCh,isInsert){var nw;if(old){for(var i=0;i<old.length;++i){var span=old[i],marker=span.marker;var startsBefore=span.from==null||(marker.inclusiveLeft?span.from<=startCh:span.from<startCh);if(startsBefore||span.from==startCh&&marker.type=="bookmark"&&(!isInsert||!span.marker.insertLeft)){var endsAfter=span.to==null||(marker.inclusiveRight?span.to>=startCh:span.to>startCh);(nw||(nw=[])).push(new MarkedSpan(marker,span.from,endsAfter?null:span.to));}}}return nw;}function markedSpansAfter(old,endCh,isInsert){var nw;if(old){for(var i=0;i<old.length;++i){var span=old[i],marker=span.marker;var endsAfter=span.to==null||(marker.inclusiveRight?span.to>=endCh:span.to>endCh);if(endsAfter||span.from==endCh&&marker.type=="bookmark"&&(!isInsert||span.marker.insertLeft)){var startsBefore=span.from==null||(marker.inclusiveLeft?span.from<=endCh:span.from<endCh);(nw||(nw=[])).push(new MarkedSpan(marker,startsBefore?null:span.from-endCh,span.to==null?null:span.to-endCh));}}}return nw;}// Given a change object, compute the new set of marker spans that\n// cover the line in which the change took place. Removes spans\n// entirely within the change, reconnects spans belonging to the\n// same marker that appear on both sides of the change, and cuts off\n// spans partially within the change. Returns an array of span\n// arrays with one element for each line in (after) the change.\nfunction stretchSpansOverChange(doc,change){if(change.full){return null;}var oldFirst=isLine(doc,change.from.line)&&getLine(doc,change.from.line).markedSpans;var oldLast=isLine(doc,change.to.line)&&getLine(doc,change.to.line).markedSpans;if(!oldFirst&&!oldLast){return null;}var startCh=change.from.ch,endCh=change.to.ch,isInsert=cmp(change.from,change.to)==0;// Get the spans that \'stick out\' on both sides\nvar first=markedSpansBefore(oldFirst,startCh,isInsert);var last=markedSpansAfter(oldLast,endCh,isInsert);// Next, merge those two ends\nvar sameLine=change.text.length==1,offset=lst(change.text).length+(sameLine?startCh:0);if(first){// Fix up .to properties of first\nfor(var i=0;i<first.length;++i){var span=first[i];if(span.to==null){var found=getMarkedSpanFor(last,span.marker);if(!found){span.to=startCh;}else if(sameLine){span.to=found.to==null?null:found.to+offset;}}}}if(last){// Fix up .from in last (or move them into first in case of sameLine)\nfor(var i$1=0;i$1<last.length;++i$1){var span$1=last[i$1];if(span$1.to!=null){span$1.to+=offset;}if(span$1.from==null){var found$1=getMarkedSpanFor(first,span$1.marker);if(!found$1){span$1.from=offset;if(sameLine){(first||(first=[])).push(span$1);}}}else{span$1.from+=offset;if(sameLine){(first||(first=[])).push(span$1);}}}}// Make sure we didn\'t create any zero-length spans\nif(first){first=clearEmptySpans(first);}if(last&&last!=first){last=clearEmptySpans(last);}var newMarkers=[first];if(!sameLine){// Fill gap with whole-line-spans\nvar gap=change.text.length-2,gapMarkers;if(gap>0&&first){for(var i$2=0;i$2<first.length;++i$2){if(first[i$2].to==null){(gapMarkers||(gapMarkers=[])).push(new MarkedSpan(first[i$2].marker,null,null));}}}for(var i$3=0;i$3<gap;++i$3){newMarkers.push(gapMarkers);}newMarkers.push(last);}return newMarkers;}// Remove spans that are empty and don\'t have a clearWhenEmpty\n// option of false.\nfunction clearEmptySpans(spans){for(var i=0;i<spans.length;++i){var span=spans[i];if(span.from!=null&&span.from==span.to&&span.marker.clearWhenEmpty!==false){spans.splice(i--,1);}}if(!spans.length){return null;}return spans;}// Used to \'clip\' out readOnly ranges when making a change.\nfunction removeReadOnlyRanges(doc,from,to){var markers=null;doc.iter(from.line,to.line+1,function(line){if(line.markedSpans){for(var i=0;i<line.markedSpans.length;++i){var mark=line.markedSpans[i].marker;if(mark.readOnly&&(!markers||indexOf(markers,mark)==-1)){(markers||(markers=[])).push(mark);}}}});if(!markers){return null;}var parts=[{from:from,to:to}];for(var i=0;i<markers.length;++i){var mk=markers[i],m=mk.find(0);for(var j=0;j<parts.length;++j){var p=parts[j];if(cmp(p.to,m.from)<0||cmp(p.from,m.to)>0){continue;}var newParts=[j,1],dfrom=cmp(p.from,m.from),dto=cmp(p.to,m.to);if(dfrom<0||!mk.inclusiveLeft&&!dfrom){newParts.push({from:p.from,to:m.from});}if(dto>0||!mk.inclusiveRight&&!dto){newParts.push({from:m.to,to:p.to});}parts.splice.apply(parts,newParts);j+=newParts.length-1;}}return parts;}// Connect or disconnect spans from a line.\nfunction detachMarkedSpans(line){var spans=line.markedSpans;if(!spans){return;}for(var i=0;i<spans.length;++i){spans[i].marker.detachLine(line);}line.markedSpans=null;}function attachMarkedSpans(line,spans){if(!spans){return;}for(var i=0;i<spans.length;++i){spans[i].marker.attachLine(line);}line.markedSpans=spans;}// Helpers used when computing which overlapping collapsed span\n// counts as the larger one.\nfunction extraLeft(marker){return marker.inclusiveLeft?-1:0;}function extraRight(marker){return marker.inclusiveRight?1:0;}// Returns a number indicating which of two overlapping collapsed\n// spans is larger (and thus includes the other). Falls back to\n// comparing ids when the spans cover exactly the same range.\nfunction compareCollapsedMarkers(a,b){var lenDiff=a.lines.length-b.lines.length;if(lenDiff!=0){return lenDiff;}var aPos=a.find(),bPos=b.find();var fromCmp=cmp(aPos.from,bPos.from)||extraLeft(a)-extraLeft(b);if(fromCmp){return-fromCmp;}var toCmp=cmp(aPos.to,bPos.to)||extraRight(a)-extraRight(b);if(toCmp){return toCmp;}return b.id-a.id;}// Find out whether a line ends or starts in a collapsed span. If\n// so, return the marker for that span.\nfunction collapsedSpanAtSide(line,start){var sps=sawCollapsedSpans&&line.markedSpans,found;if(sps){for(var sp=void 0,i=0;i<sps.length;++i){sp=sps[i];if(sp.marker.collapsed&&(start?sp.from:sp.to)==null&&(!found||compareCollapsedMarkers(found,sp.marker)<0)){found=sp.marker;}}}return found;}function collapsedSpanAtStart(line){return collapsedSpanAtSide(line,true);}function collapsedSpanAtEnd(line){return collapsedSpanAtSide(line,false);}// Test whether there exists a collapsed span that partially\n// overlaps (covers the start or end, but not both) of a new span.\n// Such overlap is not allowed.\nfunction conflictingCollapsedRange(doc,lineNo,from,to,marker){var line=getLine(doc,lineNo);var sps=sawCollapsedSpans&&line.markedSpans;if(sps){for(var i=0;i<sps.length;++i){var sp=sps[i];if(!sp.marker.collapsed){continue;}var found=sp.marker.find(0);var fromCmp=cmp(found.from,from)||extraLeft(sp.marker)-extraLeft(marker);var toCmp=cmp(found.to,to)||extraRight(sp.marker)-extraRight(marker);if(fromCmp>=0&&toCmp<=0||fromCmp<=0&&toCmp>=0){continue;}if(fromCmp<=0&&(sp.marker.inclusiveRight&&marker.inclusiveLeft?cmp(found.to,from)>=0:cmp(found.to,from)>0)||fromCmp>=0&&(sp.marker.inclusiveRight&&marker.inclusiveLeft?cmp(found.from,to)<=0:cmp(found.from,to)<0)){return true;}}}}// A visual line is a line as drawn on the screen. Folding, for\n// example, can cause multiple logical lines to appear on the same\n// visual line. This finds the start of the visual line that the\n// given line is part of (usually that is the line itself).\nfunction visualLine(line){var merged;while(merged=collapsedSpanAtStart(line)){line=merged.find(-1,true).line;}return line;}// Returns an array of logical lines that continue the visual line\n// started by the argument, or undefined if there are no such lines.\nfunction visualLineContinued(line){var merged,lines;while(merged=collapsedSpanAtEnd(line)){line=merged.find(1,true).line;(lines||(lines=[])).push(line);}return lines;}// Get the line number of the start of the visual line that the\n// given line number is part of.\nfunction visualLineNo(doc,lineN){var line=getLine(doc,lineN),vis=visualLine(line);if(line==vis){return lineN;}return lineNo(vis);}// Get the line number of the start of the next visual line after\n// the given line.\nfunction visualLineEndNo(doc,lineN){if(lineN>doc.lastLine()){return lineN;}var line=getLine(doc,lineN),merged;if(!lineIsHidden(doc,line)){return lineN;}while(merged=collapsedSpanAtEnd(line)){line=merged.find(1,true).line;}return lineNo(line)+1;}// Compute whether a line is hidden. Lines count as hidden when they\n// are part of a visual line that starts with another line, or when\n// they are entirely covered by collapsed, non-widget span.\nfunction lineIsHidden(doc,line){var sps=sawCollapsedSpans&&line.markedSpans;if(sps){for(var sp=void 0,i=0;i<sps.length;++i){sp=sps[i];if(!sp.marker.collapsed){continue;}if(sp.from==null){return true;}if(sp.marker.widgetNode){continue;}if(sp.from==0&&sp.marker.inclusiveLeft&&lineIsHiddenInner(doc,line,sp)){return true;}}}}function lineIsHiddenInner(doc,line,span){if(span.to==null){var end=span.marker.find(1,true);return lineIsHiddenInner(doc,end.line,getMarkedSpanFor(end.line.markedSpans,span.marker));}if(span.marker.inclusiveRight&&span.to==line.text.length){return true;}for(var sp=void 0,i=0;i<line.markedSpans.length;++i){sp=line.markedSpans[i];if(sp.marker.collapsed&&!sp.marker.widgetNode&&sp.from==span.to&&(sp.to==null||sp.to!=span.from)&&(sp.marker.inclusiveLeft||span.marker.inclusiveRight)&&lineIsHiddenInner(doc,line,sp)){return true;}}}// Find the height above the given line.\nfunction heightAtLine(lineObj){lineObj=visualLine(lineObj);var h=0,chunk=lineObj.parent;for(var i=0;i<chunk.lines.length;++i){var line=chunk.lines[i];if(line==lineObj){break;}else{h+=line.height;}}for(var p=chunk.parent;p;chunk=p,p=chunk.parent){for(var i$1=0;i$1<p.children.length;++i$1){var cur=p.children[i$1];if(cur==chunk){break;}else{h+=cur.height;}}}return h;}// Compute the character length of a line, taking into account\n// collapsed ranges (see markText) that might hide parts, and join\n// other lines onto it.\nfunction lineLength(line){if(line.height==0){return 0;}var len=line.text.length,merged,cur=line;while(merged=collapsedSpanAtStart(cur)){var found=merged.find(0,true);cur=found.from.line;len+=found.from.ch-found.to.ch;}cur=line;while(merged=collapsedSpanAtEnd(cur)){var found$1=merged.find(0,true);len-=cur.text.length-found$1.from.ch;cur=found$1.to.line;len+=cur.text.length-found$1.to.ch;}return len;}// Find the longest line in the document.\nfunction findMaxLine(cm){var d=cm.display,doc=cm.doc;d.maxLine=getLine(doc,doc.first);d.maxLineLength=lineLength(d.maxLine);d.maxLineChanged=true;doc.iter(function(line){var len=lineLength(line);if(len>d.maxLineLength){d.maxLineLength=len;d.maxLine=line;}});}// BIDI HELPERS\nfunction iterateBidiSections(order,from,to,f){if(!order){return f(from,to,"ltr");}var found=false;for(var i=0;i<order.length;++i){var part=order[i];if(part.from<to&&part.to>from||from==to&&part.to==from){f(Math.max(part.from,from),Math.min(part.to,to),part.level==1?"rtl":"ltr");found=true;}}if(!found){f(from,to,"ltr");}}function bidiLeft(part){return part.level%2?part.to:part.from;}function bidiRight(part){return part.level%2?part.from:part.to;}function lineLeft(line){var order=getOrder(line);return order?bidiLeft(order[0]):0;}function lineRight(line){var order=getOrder(line);if(!order){return line.text.length;}return bidiRight(lst(order));}function compareBidiLevel(order,a,b){var linedir=order[0].level;if(a==linedir){return true;}if(b==linedir){return false;}return a<b;}var bidiOther=null;function getBidiPartAt(order,pos){var found;bidiOther=null;for(var i=0;i<order.length;++i){var cur=order[i];if(cur.from<pos&&cur.to>pos){return i;}if(cur.from==pos||cur.to==pos){if(found==null){found=i;}else if(compareBidiLevel(order,cur.level,order[found].level)){if(cur.from!=cur.to){bidiOther=found;}return i;}else{if(cur.from!=cur.to){bidiOther=i;}return found;}}}return found;}function moveInLine(line,pos,dir,byUnit){if(!byUnit){return pos+dir;}do{pos+=dir;}while(pos>0&&isExtendingChar(line.text.charAt(pos)));return pos;}// This is needed in order to move \'visually\' through bi-directional\n// text -- i.e., pressing left should make the cursor go left, even\n// when in RTL text. The tricky part is the \'jumps\', where RTL and\n// LTR text touch each other. This often requires the cursor offset\n// to move more than one unit, in order to visually move one unit.\nfunction moveVisually(line,start,dir,byUnit){var bidi=getOrder(line);if(!bidi){return moveLogically(line,start,dir,byUnit);}var pos=getBidiPartAt(bidi,start),part=bidi[pos];var target=moveInLine(line,start,part.level%2?-dir:dir,byUnit);for(;;){if(target>part.from&&target<part.to){return target;}if(target==part.from||target==part.to){if(getBidiPartAt(bidi,target)==pos){return target;}part=bidi[pos+=dir];return dir>0==part.level%2?part.to:part.from;}else{part=bidi[pos+=dir];if(!part){return null;}if(dir>0==part.level%2){target=moveInLine(line,part.to,-1,byUnit);}else{target=moveInLine(line,part.from,1,byUnit);}}}}function moveLogically(line,start,dir,byUnit){var target=start+dir;if(byUnit){while(target>0&&isExtendingChar(line.text.charAt(target))){target+=dir;}}return target<0||target>line.text.length?null:target;}// Bidirectional ordering algorithm\n// See http://unicode.org/reports/tr9/tr9-13.html for the algorithm\n// that this (partially) implements.\n// One-char codes used for character types:\n// L (L):   Left-to-Right\n// R (R):   Right-to-Left\n// r (AL):  Right-to-Left Arabic\n// 1 (EN):  European Number\n// + (ES):  European Number Separator\n// % (ET):  European Number Terminator\n// n (AN):  Arabic Number\n// , (CS):  Common Number Separator\n// m (NSM): Non-Spacing Mark\n// b (BN):  Boundary Neutral\n// s (B):   Paragraph Separator\n// t (S):   Segment Separator\n// w (WS):  Whitespace\n// N (ON):  Other Neutrals\n// Returns null if characters are ordered as they appear\n// (left-to-right), or an array of sections ({from, to, level}\n// objects) in the order in which they occur visually.\nvar bidiOrdering=function(){// Character types for codepoints 0 to 0xff\nvar lowTypes="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN";// Character types for codepoints 0x600 to 0x6ff\nvar arabicTypes="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm";function charType(code){if(code<=0xf7){return lowTypes.charAt(code);}else if(0x590<=code&&code<=0x5f4){return"R";}else if(0x600<=code&&code<=0x6ed){return arabicTypes.charAt(code-0x600);}else if(0x6ee<=code&&code<=0x8ac){return"r";}else if(0x2000<=code&&code<=0x200b){return"w";}else if(code==0x200c){return"b";}else{return"L";}}var bidiRE=/[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;var isNeutral=/[stwN]/,isStrong=/[LRr]/,countsAsLeft=/[Lb1n]/,countsAsNum=/[1n]/;// Browsers seem to always treat the boundaries of block elements as being L.\nvar outerType="L";function BidiSpan(level,from,to){this.level=level;this.from=from;this.to=to;}return function(str){if(!bidiRE.test(str)){return false;}var len=str.length,types=[];for(var i=0;i<len;++i){types.push(charType(str.charCodeAt(i)));}// W1. Examine each non-spacing mark (NSM) in the level run, and\n// change the type of the NSM to the type of the previous\n// character. If the NSM is at the start of the level run, it will\n// get the type of sor.\nfor(var i$1=0,prev=outerType;i$1<len;++i$1){var type=types[i$1];if(type=="m"){types[i$1]=prev;}else{prev=type;}}// W2. Search backwards from each instance of a European number\n// until the first strong type (R, L, AL, or sor) is found. If an\n// AL is found, change the type of the European number to Arabic\n// number.\n// W3. Change all ALs to R.\nfor(var i$2=0,cur=outerType;i$2<len;++i$2){var type$1=types[i$2];if(type$1=="1"&&cur=="r"){types[i$2]="n";}else if(isStrong.test(type$1)){cur=type$1;if(type$1=="r"){types[i$2]="R";}}}// W4. A single European separator between two European numbers\n// changes to a European number. A single common separator between\n// two numbers of the same type changes to that type.\nfor(var i$3=1,prev$1=types[0];i$3<len-1;++i$3){var type$2=types[i$3];if(type$2=="+"&&prev$1=="1"&&types[i$3+1]=="1"){types[i$3]="1";}else if(type$2==","&&prev$1==types[i$3+1]&&(prev$1=="1"||prev$1=="n")){types[i$3]=prev$1;}prev$1=type$2;}// W5. A sequence of European terminators adjacent to European\n// numbers changes to all European numbers.\n// W6. Otherwise, separators and terminators change to Other\n// Neutral.\nfor(var i$4=0;i$4<len;++i$4){var type$3=types[i$4];if(type$3==","){types[i$4]="N";}else if(type$3=="%"){var end=void 0;for(end=i$4+1;end<len&&types[end]=="%";++end){}var replace=i$4&&types[i$4-1]=="!"||end<len&&types[end]=="1"?"1":"N";for(var j=i$4;j<end;++j){types[j]=replace;}i$4=end-1;}}// W7. Search backwards from each instance of a European number\n// until the first strong type (R, L, or sor) is found. If an L is\n// found, then change the type of the European number to L.\nfor(var i$5=0,cur$1=outerType;i$5<len;++i$5){var type$4=types[i$5];if(cur$1=="L"&&type$4=="1"){types[i$5]="L";}else if(isStrong.test(type$4)){cur$1=type$4;}}// N1. A sequence of neutrals takes the direction of the\n// surrounding strong text if the text on both sides has the same\n// direction. European and Arabic numbers act as if they were R in\n// terms of their influence on neutrals. Start-of-level-run (sor)\n// and end-of-level-run (eor) are used at level run boundaries.\n// N2. Any remaining neutrals take the embedding direction.\nfor(var i$6=0;i$6<len;++i$6){if(isNeutral.test(types[i$6])){var end$1=void 0;for(end$1=i$6+1;end$1<len&&isNeutral.test(types[end$1]);++end$1){}var before=(i$6?types[i$6-1]:outerType)=="L";var after=(end$1<len?types[end$1]:outerType)=="L";var replace$1=before||after?"L":"R";for(var j$1=i$6;j$1<end$1;++j$1){types[j$1]=replace$1;}i$6=end$1-1;}}// Here we depart from the documented algorithm, in order to avoid\n// building up an actual levels array. Since there are only three\n// levels (0, 1, 2) in an implementation that doesn\'t take\n// explicit embedding into account, we can build up the order on\n// the fly, without following the level-based algorithm.\nvar order=[],m;for(var i$7=0;i$7<len;){if(countsAsLeft.test(types[i$7])){var start=i$7;for(++i$7;i$7<len&&countsAsLeft.test(types[i$7]);++i$7){}order.push(new BidiSpan(0,start,i$7));}else{var pos=i$7,at=order.length;for(++i$7;i$7<len&&types[i$7]!="L";++i$7){}for(var j$2=pos;j$2<i$7;){if(countsAsNum.test(types[j$2])){if(pos<j$2){order.splice(at,0,new BidiSpan(1,pos,j$2));}var nstart=j$2;for(++j$2;j$2<i$7&&countsAsNum.test(types[j$2]);++j$2){}order.splice(at,0,new BidiSpan(2,nstart,j$2));pos=j$2;}else{++j$2;}}if(pos<i$7){order.splice(at,0,new BidiSpan(1,pos,i$7));}}}if(order[0].level==1&&(m=str.match(/^\\s+/))){order[0].from=m[0].length;order.unshift(new BidiSpan(0,0,m[0].length));}if(lst(order).level==1&&(m=str.match(/\\s+$/))){lst(order).to-=m[0].length;order.push(new BidiSpan(0,len-m[0].length,len));}if(order[0].level==2){order.unshift(new BidiSpan(1,order[0].to,order[0].to));}if(order[0].level!=lst(order).level){order.push(new BidiSpan(order[0].level,len,len));}return order;};}();// Get the bidi ordering for the given line (and cache it). Returns\n// false for lines that are fully left-to-right, and an array of\n// BidiSpan objects otherwise.\nfunction getOrder(line){var order=line.order;if(order==null){order=line.order=bidiOrdering(line.text);}return order;}// EVENT HANDLING\n// Lightweight event framework. on/off also work on DOM nodes,\n// registering native DOM handlers.\nvar on=function(emitter,type,f){if(emitter.addEventListener){emitter.addEventListener(type,f,false);}else if(emitter.attachEvent){emitter.attachEvent("on"+type,f);}else{var map=emitter._handlers||(emitter._handlers={});var arr=map[type]||(map[type]=[]);arr.push(f);}};var noHandlers=[];function getHandlers(emitter,type,copy){var arr=emitter._handlers&&emitter._handlers[type];if(copy){return arr&&arr.length>0?arr.slice():noHandlers;}else{return arr||noHandlers;}}function off(emitter,type,f){if(emitter.removeEventListener){emitter.removeEventListener(type,f,false);}else if(emitter.detachEvent){emitter.detachEvent("on"+type,f);}else{var handlers=getHandlers(emitter,type,false);for(var i=0;i<handlers.length;++i){if(handlers[i]==f){handlers.splice(i,1);break;}}}}function signal(emitter,type/*, values...*/){var handlers=getHandlers(emitter,type,true);if(!handlers.length){return;}var args=Array.prototype.slice.call(arguments,2);for(var i=0;i<handlers.length;++i){handlers[i].apply(null,args);}}// The DOM events that CodeMirror handles can be overridden by\n// registering a (non-DOM) handler on the editor for the event name,\n// and preventDefault-ing the event in that handler.\nfunction signalDOMEvent(cm,e,override){if(typeof e=="string"){e={type:e,preventDefault:function(){this.defaultPrevented=true;}};}signal(cm,override||e.type,cm,e);return e_defaultPrevented(e)||e.codemirrorIgnore;}function signalCursorActivity(cm){var arr=cm._handlers&&cm._handlers.cursorActivity;if(!arr){return;}var set=cm.curOp.cursorActivityHandlers||(cm.curOp.cursorActivityHandlers=[]);for(var i=0;i<arr.length;++i){if(indexOf(set,arr[i])==-1){set.push(arr[i]);}}}function hasHandler(emitter,type){return getHandlers(emitter,type).length>0;}// Add on and off methods to a constructor\'s prototype, to make\n// registering events on such objects more convenient.\nfunction eventMixin(ctor){ctor.prototype.on=function(type,f){on(this,type,f);};ctor.prototype.off=function(type,f){off(this,type,f);};}// Due to the fact that we still support jurassic IE versions, some\n// compatibility wrappers are needed.\nfunction e_preventDefault(e){if(e.preventDefault){e.preventDefault();}else{e.returnValue=false;}}function e_stopPropagation(e){if(e.stopPropagation){e.stopPropagation();}else{e.cancelBubble=true;}}function e_defaultPrevented(e){return e.defaultPrevented!=null?e.defaultPrevented:e.returnValue==false;}function e_stop(e){e_preventDefault(e);e_stopPropagation(e);}function e_target(e){return e.target||e.srcElement;}function e_button(e){var b=e.which;if(b==null){if(e.button&1){b=1;}else if(e.button&2){b=3;}else if(e.button&4){b=2;}}if(mac&&e.ctrlKey&&b==1){b=3;}return b;}// Detect drag-and-drop\nvar dragAndDrop=function(){// There is *some* kind of drag-and-drop support in IE6-8, but I\n// couldn\'t get it to work yet.\nif(ie&&ie_version<9){return false;}var div=elt(\'div\');return"draggable"in div||"dragDrop"in div;}();var zwspSupported;function zeroWidthElement(measure){if(zwspSupported==null){var test=elt("span","\\u200b");removeChildrenAndAdd(measure,elt("span",[test,document.createTextNode("x")]));if(measure.firstChild.offsetHeight!=0){zwspSupported=test.offsetWidth<=1&&test.offsetHeight>2&&!(ie&&ie_version<8);}}var node=zwspSupported?elt("span","\\u200b"):elt("span","\\u00a0",null,"display: inline-block; width: 1px; margin-right: -1px");node.setAttribute("cm-text","");return node;}// Feature-detect IE\'s crummy client rect reporting for bidi text\nvar badBidiRects;function hasBadBidiRects(measure){if(badBidiRects!=null){return badBidiRects;}var txt=removeChildrenAndAdd(measure,document.createTextNode("A\\u062eA"));var r0=range(txt,0,1).getBoundingClientRect();var r1=range(txt,1,2).getBoundingClientRect();removeChildren(measure);if(!r0||r0.left==r0.right){return false;}// Safari returns null in some cases (#2780)\nreturn badBidiRects=r1.right-r0.right<3;}// See if "".split is the broken IE version, if so, provide an\n// alternative way to split lines.\nvar splitLinesAuto="\\n\\nb".split(/\\n/).length!=3?function(string){var pos=0,result=[],l=string.length;while(pos<=l){var nl=string.indexOf("\\n",pos);if(nl==-1){nl=string.length;}var line=string.slice(pos,string.charAt(nl-1)=="\\r"?nl-1:nl);var rt=line.indexOf("\\r");if(rt!=-1){result.push(line.slice(0,rt));pos+=rt+1;}else{result.push(line);pos=nl+1;}}return result;}:function(string){return string.split(/\\r\\n?|\\n/);};var hasSelection=window.getSelection?function(te){try{return te.selectionStart!=te.selectionEnd;}catch(e){return false;}}:function(te){var range;try{range=te.ownerDocument.selection.createRange();}catch(e){}if(!range||range.parentElement()!=te){return false;}return range.compareEndPoints("StartToEnd",range)!=0;};var hasCopyEvent=function(){var e=elt("div");if("oncopy"in e){return true;}e.setAttribute("oncopy","return;");return typeof e.oncopy=="function";}();var badZoomedRects=null;function hasBadZoomedRects(measure){if(badZoomedRects!=null){return badZoomedRects;}var node=removeChildrenAndAdd(measure,elt("span","x"));var normal=node.getBoundingClientRect();var fromRange=range(node,0,1).getBoundingClientRect();return badZoomedRects=Math.abs(normal.left-fromRange.left)>1;}var modes={};var mimeModes={};// Extra arguments are stored as the mode\'s dependencies, which is\n// used by (legacy) mechanisms like loadmode.js to automatically\n// load a mode. (Preferred mechanism is the require/define calls.)\nfunction defineMode(name,mode){if(arguments.length>2){mode.dependencies=Array.prototype.slice.call(arguments,2);}modes[name]=mode;}function defineMIME(mime,spec){mimeModes[mime]=spec;}// Given a MIME type, a {name, ...options} config object, or a name\n// string, return a mode config object.\nfunction resolveMode(spec){if(typeof spec=="string"&&mimeModes.hasOwnProperty(spec)){spec=mimeModes[spec];}else if(spec&&typeof spec.name=="string"&&mimeModes.hasOwnProperty(spec.name)){var found=mimeModes[spec.name];if(typeof found=="string"){found={name:found};}spec=createObj(found,spec);spec.name=found.name;}else if(typeof spec=="string"&&/^[\\w\\-]+\\/[\\w\\-]+\\+xml$/.test(spec)){return resolveMode("application/xml");}else if(typeof spec=="string"&&/^[\\w\\-]+\\/[\\w\\-]+\\+json$/.test(spec)){return resolveMode("application/json");}if(typeof spec=="string"){return{name:spec};}else{return spec||{name:"null"};}}// Given a mode spec (anything that resolveMode accepts), find and\n// initialize an actual mode object.\nfunction getMode(options,spec){spec=resolveMode(spec);var mfactory=modes[spec.name];if(!mfactory){return getMode(options,"text/plain");}var modeObj=mfactory(options,spec);if(modeExtensions.hasOwnProperty(spec.name)){var exts=modeExtensions[spec.name];for(var prop in exts){if(!exts.hasOwnProperty(prop)){continue;}if(modeObj.hasOwnProperty(prop)){modeObj["_"+prop]=modeObj[prop];}modeObj[prop]=exts[prop];}}modeObj.name=spec.name;if(spec.helperType){modeObj.helperType=spec.helperType;}if(spec.modeProps){for(var prop$1 in spec.modeProps){modeObj[prop$1]=spec.modeProps[prop$1];}}return modeObj;}// This can be used to attach properties to mode objects from\n// outside the actual mode definition.\nvar modeExtensions={};function extendMode(mode,properties){var exts=modeExtensions.hasOwnProperty(mode)?modeExtensions[mode]:modeExtensions[mode]={};copyObj(properties,exts);}function copyState(mode,state){if(state===true){return state;}if(mode.copyState){return mode.copyState(state);}var nstate={};for(var n in state){var val=state[n];if(val instanceof Array){val=val.concat([]);}nstate[n]=val;}return nstate;}// Given a mode and a state (for that mode), find the inner mode and\n// state at the position that the state refers to.\nfunction innerMode(mode,state){var info;while(mode.innerMode){info=mode.innerMode(state);if(!info||info.mode==mode){break;}state=info.state;mode=info.mode;}return info||{mode:mode,state:state};}function startState(mode,a1,a2){return mode.startState?mode.startState(a1,a2):true;}// STRING STREAM\n// Fed to the mode parsers, provides helper functions to make\n// parsers more succinct.\nvar StringStream=function(string,tabSize){this.pos=this.start=0;this.string=string;this.tabSize=tabSize||8;this.lastColumnPos=this.lastColumnValue=0;this.lineStart=0;};StringStream.prototype={eol:function(){return this.pos>=this.string.length;},sol:function(){return this.pos==this.lineStart;},peek:function(){return this.string.charAt(this.pos)||undefined;},next:function(){if(this.pos<this.string.length){return this.string.charAt(this.pos++);}},eat:function(match){var ch=this.string.charAt(this.pos);var ok;if(typeof match=="string"){ok=ch==match;}else{ok=ch&&(match.test?match.test(ch):match(ch));}if(ok){++this.pos;return ch;}},eatWhile:function(match){var start=this.pos;while(this.eat(match)){}return this.pos>start;},eatSpace:function(){var this$1=this;var start=this.pos;while(/[\\s\\u00a0]/.test(this.string.charAt(this.pos))){++this$1.pos;}return this.pos>start;},skipToEnd:function(){this.pos=this.string.length;},skipTo:function(ch){var found=this.string.indexOf(ch,this.pos);if(found>-1){this.pos=found;return true;}},backUp:function(n){this.pos-=n;},column:function(){if(this.lastColumnPos<this.start){this.lastColumnValue=countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue);this.lastColumnPos=this.start;}return this.lastColumnValue-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0);},indentation:function(){return countColumn(this.string,null,this.tabSize)-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0);},match:function(pattern,consume,caseInsensitive){if(typeof pattern=="string"){var cased=function(str){return caseInsensitive?str.toLowerCase():str;};var substr=this.string.substr(this.pos,pattern.length);if(cased(substr)==cased(pattern)){if(consume!==false){this.pos+=pattern.length;}return true;}}else{var match=this.string.slice(this.pos).match(pattern);if(match&&match.index>0){return null;}if(match&&consume!==false){this.pos+=match[0].length;}return match;}},current:function(){return this.string.slice(this.start,this.pos);},hideFirstChars:function(n,inner){this.lineStart+=n;try{return inner();}finally{this.lineStart-=n;}}};// Compute a style array (an array starting with a mode generation\n// -- for invalidation -- followed by pairs of end positions and\n// style strings), which is used to highlight the tokens on the\n// line.\nfunction highlightLine(cm,line,state,forceToEnd){// A styles array always starts with a number identifying the\n// mode/overlays that it is based on (for easy invalidation).\nvar st=[cm.state.modeGen],lineClasses={};// Compute the base array of styles\nrunMode(cm,line.text,cm.doc.mode,state,function(end,style){return st.push(end,style);},lineClasses,forceToEnd);// Run overlays, adjust style array.\nvar loop=function(o){var overlay=cm.state.overlays[o],i=1,at=0;runMode(cm,line.text,overlay.mode,true,function(end,style){var start=i;// Ensure there\'s a token end at the current position, and that i points at it\nwhile(at<end){var i_end=st[i];if(i_end>end){st.splice(i,1,end,st[i+1],i_end);}i+=2;at=Math.min(end,i_end);}if(!style){return;}if(overlay.opaque){st.splice(start,i-start,end,"overlay "+style);i=start+2;}else{for(;start<i;start+=2){var cur=st[start+1];st[start+1]=(cur?cur+" ":"")+"overlay "+style;}}},lineClasses);};for(var o=0;o<cm.state.overlays.length;++o)loop(o);return{styles:st,classes:lineClasses.bgClass||lineClasses.textClass?lineClasses:null};}function getLineStyles(cm,line,updateFrontier){if(!line.styles||line.styles[0]!=cm.state.modeGen){var state=getStateBefore(cm,lineNo(line));var result=highlightLine(cm,line,line.text.length>cm.options.maxHighlightLength?copyState(cm.doc.mode,state):state);line.stateAfter=state;line.styles=result.styles;if(result.classes){line.styleClasses=result.classes;}else if(line.styleClasses){line.styleClasses=null;}if(updateFrontier===cm.doc.frontier){cm.doc.frontier++;}}return line.styles;}function getStateBefore(cm,n,precise){var doc=cm.doc,display=cm.display;if(!doc.mode.startState){return true;}var pos=findStartLine(cm,n,precise),state=pos>doc.first&&getLine(doc,pos-1).stateAfter;if(!state){state=startState(doc.mode);}else{state=copyState(doc.mode,state);}doc.iter(pos,n,function(line){processLine(cm,line.text,state);var save=pos==n-1||pos%5==0||pos>=display.viewFrom&&pos<display.viewTo;line.stateAfter=save?copyState(doc.mode,state):null;++pos;});if(precise){doc.frontier=pos;}return state;}// Lightweight form of highlight -- proceed over this line and\n// update state, but don\'t save a style array. Used for lines that\n// aren\'t currently visible.\nfunction processLine(cm,text,state,startAt){var mode=cm.doc.mode;var stream=new StringStream(text,cm.options.tabSize);stream.start=stream.pos=startAt||0;if(text==""){callBlankLine(mode,state);}while(!stream.eol()){readToken(mode,stream,state);stream.start=stream.pos;}}function callBlankLine(mode,state){if(mode.blankLine){return mode.blankLine(state);}if(!mode.innerMode){return;}var inner=innerMode(mode,state);if(inner.mode.blankLine){return inner.mode.blankLine(inner.state);}}function readToken(mode,stream,state,inner){for(var i=0;i<10;i++){if(inner){inner[0]=innerMode(mode,state).mode;}var style=mode.token(stream,state);if(stream.pos>stream.start){return style;}}throw new Error("Mode "+mode.name+" failed to advance stream.");}// Utility for getTokenAt and getLineTokens\nfunction takeToken(cm,pos,precise,asArray){var getObj=function(copy){return{start:stream.start,end:stream.pos,string:stream.current(),type:style||null,state:copy?copyState(doc.mode,state):state};};var doc=cm.doc,mode=doc.mode,style;pos=clipPos(doc,pos);var line=getLine(doc,pos.line),state=getStateBefore(cm,pos.line,precise);var stream=new StringStream(line.text,cm.options.tabSize),tokens;if(asArray){tokens=[];}while((asArray||stream.pos<pos.ch)&&!stream.eol()){stream.start=stream.pos;style=readToken(mode,stream,state);if(asArray){tokens.push(getObj(true));}}return asArray?tokens:getObj();}function extractLineClasses(type,output){if(type){for(;;){var lineClass=type.match(/(?:^|\\s+)line-(background-)?(\\S+)/);if(!lineClass){break;}type=type.slice(0,lineClass.index)+type.slice(lineClass.index+lineClass[0].length);var prop=lineClass[1]?"bgClass":"textClass";if(output[prop]==null){output[prop]=lineClass[2];}else if(!new RegExp("(?:^|\\s)"+lineClass[2]+"(?:$|\\s)").test(output[prop])){output[prop]+=" "+lineClass[2];}}}return type;}// Run the given mode\'s parser over a line, calling f for each token.\nfunction runMode(cm,text,mode,state,f,lineClasses,forceToEnd){var flattenSpans=mode.flattenSpans;if(flattenSpans==null){flattenSpans=cm.options.flattenSpans;}var curStart=0,curStyle=null;var stream=new StringStream(text,cm.options.tabSize),style;var inner=cm.options.addModeClass&&[null];if(text==""){extractLineClasses(callBlankLine(mode,state),lineClasses);}while(!stream.eol()){if(stream.pos>cm.options.maxHighlightLength){flattenSpans=false;if(forceToEnd){processLine(cm,text,state,stream.pos);}stream.pos=text.length;style=null;}else{style=extractLineClasses(readToken(mode,stream,state,inner),lineClasses);}if(inner){var mName=inner[0].name;if(mName){style="m-"+(style?mName+" "+style:mName);}}if(!flattenSpans||curStyle!=style){while(curStart<stream.start){curStart=Math.min(stream.start,curStart+5000);f(curStart,curStyle);}curStyle=style;}stream.start=stream.pos;}while(curStart<stream.pos){// Webkit seems to refuse to render text nodes longer than 57444\n// characters, and returns inaccurate measurements in nodes\n// starting around 5000 chars.\nvar pos=Math.min(stream.pos,curStart+5000);f(pos,curStyle);curStart=pos;}}// Finds the line to start with when starting a parse. Tries to\n// find a line with a stateAfter, so that it can start with a\n// valid state. If that fails, it returns the line with the\n// smallest indentation, which tends to need the least context to\n// parse correctly.\nfunction findStartLine(cm,n,precise){var minindent,minline,doc=cm.doc;var lim=precise?-1:n-(cm.doc.mode.innerMode?1000:100);for(var search=n;search>lim;--search){if(search<=doc.first){return doc.first;}var line=getLine(doc,search-1);if(line.stateAfter&&(!precise||search<=doc.frontier)){return search;}var indented=countColumn(line.text,null,cm.options.tabSize);if(minline==null||minindent>indented){minline=search-1;minindent=indented;}}return minline;}// LINE DATA STRUCTURE\n// Line objects. These hold state related to a line, including\n// highlighting info (the styles array).\nfunction Line(text,markedSpans,estimateHeight){this.text=text;attachMarkedSpans(this,markedSpans);this.height=estimateHeight?estimateHeight(this):1;}eventMixin(Line);Line.prototype.lineNo=function(){return lineNo(this);};// Change the content (text, markers) of a line. Automatically\n// invalidates cached information and tries to re-estimate the\n// line\'s height.\nfunction updateLine(line,text,markedSpans,estimateHeight){line.text=text;if(line.stateAfter){line.stateAfter=null;}if(line.styles){line.styles=null;}if(line.order!=null){line.order=null;}detachMarkedSpans(line);attachMarkedSpans(line,markedSpans);var estHeight=estimateHeight?estimateHeight(line):1;if(estHeight!=line.height){updateLineHeight(line,estHeight);}}// Detach a line from the document tree and its markers.\nfunction cleanUpLine(line){line.parent=null;detachMarkedSpans(line);}// Convert a style as returned by a mode (either null, or a string\n// containing one or more styles) to a CSS style. This is cached,\n// and also looks for line-wide styles.\nvar styleToClassCache={};var styleToClassCacheWithMode={};function interpretTokenStyle(style,options){if(!style||/^\\s*$/.test(style)){return null;}var cache=options.addModeClass?styleToClassCacheWithMode:styleToClassCache;return cache[style]||(cache[style]=style.replace(/\\S+/g,"cm-$&"));}// Render the DOM representation of the text of a line. Also builds\n// up a \'line map\', which points at the DOM nodes that represent\n// specific stretches of text, and is used by the measuring code.\n// The returned object contains the DOM node, this map, and\n// information about line-wide styles that were set by the mode.\nfunction buildLineContent(cm,lineView){// The padding-right forces the element to have a \'border\', which\n// is needed on Webkit to be able to get line-level bounding\n// rectangles for it (in measureChar).\nvar content=elt("span",null,null,webkit?"padding-right: .1px":null);var builder={pre:elt("pre",[content],"CodeMirror-line"),content:content,col:0,pos:0,cm:cm,trailingSpace:false,splitSpaces:(ie||webkit)&&cm.getOption("lineWrapping")};lineView.measure={};// Iterate over the logical lines that make up this visual line.\nfor(var i=0;i<=(lineView.rest?lineView.rest.length:0);i++){var line=i?lineView.rest[i-1]:lineView.line,order=void 0;builder.pos=0;builder.addToken=buildToken;// Optionally wire in some hacks into the token-rendering\n// algorithm, to deal with browser quirks.\nif(hasBadBidiRects(cm.display.measure)&&(order=getOrder(line))){builder.addToken=buildTokenBadBidi(builder.addToken,order);}builder.map=[];var allowFrontierUpdate=lineView!=cm.display.externalMeasured&&lineNo(line);insertLineContent(line,builder,getLineStyles(cm,line,allowFrontierUpdate));if(line.styleClasses){if(line.styleClasses.bgClass){builder.bgClass=joinClasses(line.styleClasses.bgClass,builder.bgClass||"");}if(line.styleClasses.textClass){builder.textClass=joinClasses(line.styleClasses.textClass,builder.textClass||"");}}// Ensure at least a single node is present, for measuring.\nif(builder.map.length==0){builder.map.push(0,0,builder.content.appendChild(zeroWidthElement(cm.display.measure)));}// Store the map and a cache object for the current logical line\nif(i==0){lineView.measure.map=builder.map;lineView.measure.cache={};}else{;(lineView.measure.maps||(lineView.measure.maps=[])).push(builder.map);(lineView.measure.caches||(lineView.measure.caches=[])).push({});}}// See issue #2901\nif(webkit){var last=builder.content.lastChild;if(/\\bcm-tab\\b/.test(last.className)||last.querySelector&&last.querySelector(".cm-tab")){builder.content.className="cm-tab-wrap-hack";}}signal(cm,"renderLine",cm,lineView.line,builder.pre);if(builder.pre.className){builder.textClass=joinClasses(builder.pre.className,builder.textClass||"");}return builder;}function defaultSpecialCharPlaceholder(ch){var token=elt("span","\\u2022","cm-invalidchar");token.title="\\\\u"+ch.charCodeAt(0).toString(16);token.setAttribute("aria-label",token.title);return token;}// Build up the DOM representation for a single token, and add it to\n// the line map. Takes care to render special characters separately.\nfunction buildToken(builder,text,style,startStyle,endStyle,title,css){if(!text){return;}var displayText=builder.splitSpaces?splitSpaces(text,builder.trailingSpace):text;var special=builder.cm.state.specialChars,mustWrap=false;var content;if(!special.test(text)){builder.col+=text.length;content=document.createTextNode(displayText);builder.map.push(builder.pos,builder.pos+text.length,content);if(ie&&ie_version<9){mustWrap=true;}builder.pos+=text.length;}else{content=document.createDocumentFragment();var pos=0;while(true){special.lastIndex=pos;var m=special.exec(text);var skipped=m?m.index-pos:text.length-pos;if(skipped){var txt=document.createTextNode(displayText.slice(pos,pos+skipped));if(ie&&ie_version<9){content.appendChild(elt("span",[txt]));}else{content.appendChild(txt);}builder.map.push(builder.pos,builder.pos+skipped,txt);builder.col+=skipped;builder.pos+=skipped;}if(!m){break;}pos+=skipped+1;var txt$1=void 0;if(m[0]=="\\t"){var tabSize=builder.cm.options.tabSize,tabWidth=tabSize-builder.col%tabSize;txt$1=content.appendChild(elt("span",spaceStr(tabWidth),"cm-tab"));txt$1.setAttribute("role","presentation");txt$1.setAttribute("cm-text","\\t");builder.col+=tabWidth;}else if(m[0]=="\\r"||m[0]=="\\n"){txt$1=content.appendChild(elt("span",m[0]=="\\r"?"\\u240d":"\\u2424","cm-invalidchar"));txt$1.setAttribute("cm-text",m[0]);builder.col+=1;}else{txt$1=builder.cm.options.specialCharPlaceholder(m[0]);txt$1.setAttribute("cm-text",m[0]);if(ie&&ie_version<9){content.appendChild(elt("span",[txt$1]));}else{content.appendChild(txt$1);}builder.col+=1;}builder.map.push(builder.pos,builder.pos+1,txt$1);builder.pos++;}}builder.trailingSpace=displayText.charCodeAt(text.length-1)==32;if(style||startStyle||endStyle||mustWrap||css){var fullStyle=style||"";if(startStyle){fullStyle+=startStyle;}if(endStyle){fullStyle+=endStyle;}var token=elt("span",[content],fullStyle,css);if(title){token.title=title;}return builder.content.appendChild(token);}builder.content.appendChild(content);}function splitSpaces(text,trailingBefore){if(text.length>1&&!/  /.test(text)){return text;}var spaceBefore=trailingBefore,result="";for(var i=0;i<text.length;i++){var ch=text.charAt(i);if(ch==" "&&spaceBefore&&(i==text.length-1||text.charCodeAt(i+1)==32)){ch="\\u00a0";}result+=ch;spaceBefore=ch==" ";}return result;}// Work around nonsense dimensions being reported for stretches of\n// right-to-left text.\nfunction buildTokenBadBidi(inner,order){return function(builder,text,style,startStyle,endStyle,title,css){style=style?style+" cm-force-border":"cm-force-border";var start=builder.pos,end=start+text.length;for(;;){// Find the part that overlaps with the start of this text\nvar part=void 0;for(var i=0;i<order.length;i++){part=order[i];if(part.to>start&&part.from<=start){break;}}if(part.to>=end){return inner(builder,text,style,startStyle,endStyle,title,css);}inner(builder,text.slice(0,part.to-start),style,startStyle,null,title,css);startStyle=null;text=text.slice(part.to-start);start=part.to;}};}function buildCollapsedSpan(builder,size,marker,ignoreWidget){var widget=!ignoreWidget&&marker.widgetNode;if(widget){builder.map.push(builder.pos,builder.pos+size,widget);}if(!ignoreWidget&&builder.cm.display.input.needsContentAttribute){if(!widget){widget=builder.content.appendChild(document.createElement("span"));}widget.setAttribute("cm-marker",marker.id);}if(widget){builder.cm.display.input.setUneditable(widget);builder.content.appendChild(widget);}builder.pos+=size;builder.trailingSpace=false;}// Outputs a number of spans to make up a line, taking highlighting\n// and marked text into account.\nfunction insertLineContent(line,builder,styles){var spans=line.markedSpans,allText=line.text,at=0;if(!spans){for(var i$1=1;i$1<styles.length;i$1+=2){builder.addToken(builder,allText.slice(at,at=styles[i$1]),interpretTokenStyle(styles[i$1+1],builder.cm.options));}return;}var len=allText.length,pos=0,i=1,text="",style,css;var nextChange=0,spanStyle,spanEndStyle,spanStartStyle,title,collapsed;for(;;){if(nextChange==pos){// Update current marker set\nspanStyle=spanEndStyle=spanStartStyle=title=css="";collapsed=null;nextChange=Infinity;var foundBookmarks=[],endStyles=void 0;for(var j=0;j<spans.length;++j){var sp=spans[j],m=sp.marker;if(m.type=="bookmark"&&sp.from==pos&&m.widgetNode){foundBookmarks.push(m);}else if(sp.from<=pos&&(sp.to==null||sp.to>pos||m.collapsed&&sp.to==pos&&sp.from==pos)){if(sp.to!=null&&sp.to!=pos&&nextChange>sp.to){nextChange=sp.to;spanEndStyle="";}if(m.className){spanStyle+=" "+m.className;}if(m.css){css=(css?css+";":"")+m.css;}if(m.startStyle&&sp.from==pos){spanStartStyle+=" "+m.startStyle;}if(m.endStyle&&sp.to==nextChange){(endStyles||(endStyles=[])).push(m.endStyle,sp.to);}if(m.title&&!title){title=m.title;}if(m.collapsed&&(!collapsed||compareCollapsedMarkers(collapsed.marker,m)<0)){collapsed=sp;}}else if(sp.from>pos&&nextChange>sp.from){nextChange=sp.from;}}if(endStyles){for(var j$1=0;j$1<endStyles.length;j$1+=2){if(endStyles[j$1+1]==nextChange){spanEndStyle+=" "+endStyles[j$1];}}}if(!collapsed||collapsed.from==pos){for(var j$2=0;j$2<foundBookmarks.length;++j$2){buildCollapsedSpan(builder,0,foundBookmarks[j$2]);}}if(collapsed&&(collapsed.from||0)==pos){buildCollapsedSpan(builder,(collapsed.to==null?len+1:collapsed.to)-pos,collapsed.marker,collapsed.from==null);if(collapsed.to==null){return;}if(collapsed.to==pos){collapsed=false;}}}if(pos>=len){break;}var upto=Math.min(len,nextChange);while(true){if(text){var end=pos+text.length;if(!collapsed){var tokenText=end>upto?text.slice(0,upto-pos):text;builder.addToken(builder,tokenText,style?style+spanStyle:spanStyle,spanStartStyle,pos+tokenText.length==nextChange?spanEndStyle:"",title,css);}if(end>=upto){text=text.slice(upto-pos);pos=upto;break;}pos=end;spanStartStyle="";}text=allText.slice(at,at=styles[i++]);style=interpretTokenStyle(styles[i++],builder.cm.options);}}}// These objects are used to represent the visible (currently drawn)\n// part of the document. A LineView may correspond to multiple\n// logical lines, if those are connected by collapsed ranges.\nfunction LineView(doc,line,lineN){// The starting line\nthis.line=line;// Continuing lines, if any\nthis.rest=visualLineContinued(line);// Number of logical lines in this visual line\nthis.size=this.rest?lineNo(lst(this.rest))-lineN+1:1;this.node=this.text=null;this.hidden=lineIsHidden(doc,line);}// Create a range of LineView objects for the given lines.\nfunction buildViewArray(cm,from,to){var array=[],nextPos;for(var pos=from;pos<to;pos=nextPos){var view=new LineView(cm.doc,getLine(cm.doc,pos),pos);nextPos=pos+view.size;array.push(view);}return array;}var operationGroup=null;function pushOperation(op){if(operationGroup){operationGroup.ops.push(op);}else{op.ownsGroup=operationGroup={ops:[op],delayedCallbacks:[]};}}function fireCallbacksForOps(group){// Calls delayed callbacks and cursorActivity handlers until no\n// new ones appear\nvar callbacks=group.delayedCallbacks,i=0;do{for(;i<callbacks.length;i++){callbacks[i].call(null);}for(var j=0;j<group.ops.length;j++){var op=group.ops[j];if(op.cursorActivityHandlers){while(op.cursorActivityCalled<op.cursorActivityHandlers.length){op.cursorActivityHandlers[op.cursorActivityCalled++].call(null,op.cm);}}}}while(i<callbacks.length);}function finishOperation(op,endCb){var group=op.ownsGroup;if(!group){return;}try{fireCallbacksForOps(group);}finally{operationGroup=null;endCb(group);}}var orphanDelayedCallbacks=null;// Often, we want to signal events at a point where we are in the\n// middle of some work, but don\'t want the handler to start calling\n// other methods on the editor, which might be in an inconsistent\n// state or simply not expect any other events to happen.\n// signalLater looks whether there are any handlers, and schedules\n// them to be executed when the last operation ends, or, if no\n// operation is active, when a timeout fires.\nfunction signalLater(emitter,type/*, values...*/){var arr=getHandlers(emitter,type,false);if(!arr.length){return;}var args=Array.prototype.slice.call(arguments,2),list;if(operationGroup){list=operationGroup.delayedCallbacks;}else if(orphanDelayedCallbacks){list=orphanDelayedCallbacks;}else{list=orphanDelayedCallbacks=[];setTimeout(fireOrphanDelayed,0);}var loop=function(i){list.push(function(){return arr[i].apply(null,args);});};for(var i=0;i<arr.length;++i)loop(i);}function fireOrphanDelayed(){var delayed=orphanDelayedCallbacks;orphanDelayedCallbacks=null;for(var i=0;i<delayed.length;++i){delayed[i]();}}// When an aspect of a line changes, a string is added to\n// lineView.changes. This updates the relevant part of the line\'s\n// DOM structure.\nfunction updateLineForChanges(cm,lineView,lineN,dims){for(var j=0;j<lineView.changes.length;j++){var type=lineView.changes[j];if(type=="text"){updateLineText(cm,lineView);}else if(type=="gutter"){updateLineGutter(cm,lineView,lineN,dims);}else if(type=="class"){updateLineClasses(lineView);}else if(type=="widget"){updateLineWidgets(cm,lineView,dims);}}lineView.changes=null;}// Lines with gutter elements, widgets or a background class need to\n// be wrapped, and have the extra elements added to the wrapper div\nfunction ensureLineWrapped(lineView){if(lineView.node==lineView.text){lineView.node=elt("div",null,null,"position: relative");if(lineView.text.parentNode){lineView.text.parentNode.replaceChild(lineView.node,lineView.text);}lineView.node.appendChild(lineView.text);if(ie&&ie_version<8){lineView.node.style.zIndex=2;}}return lineView.node;}function updateLineBackground(lineView){var cls=lineView.bgClass?lineView.bgClass+" "+(lineView.line.bgClass||""):lineView.line.bgClass;if(cls){cls+=" CodeMirror-linebackground";}if(lineView.background){if(cls){lineView.background.className=cls;}else{lineView.background.parentNode.removeChild(lineView.background);lineView.background=null;}}else if(cls){var wrap=ensureLineWrapped(lineView);lineView.background=wrap.insertBefore(elt("div",null,cls),wrap.firstChild);}}// Wrapper around buildLineContent which will reuse the structure\n// in display.externalMeasured when possible.\nfunction getLineContent(cm,lineView){var ext=cm.display.externalMeasured;if(ext&&ext.line==lineView.line){cm.display.externalMeasured=null;lineView.measure=ext.measure;return ext.built;}return buildLineContent(cm,lineView);}// Redraw the line\'s text. Interacts with the background and text\n// classes because the mode may output tokens that influence these\n// classes.\nfunction updateLineText(cm,lineView){var cls=lineView.text.className;var built=getLineContent(cm,lineView);if(lineView.text==lineView.node){lineView.node=built.pre;}lineView.text.parentNode.replaceChild(built.pre,lineView.text);lineView.text=built.pre;if(built.bgClass!=lineView.bgClass||built.textClass!=lineView.textClass){lineView.bgClass=built.bgClass;lineView.textClass=built.textClass;updateLineClasses(lineView);}else if(cls){lineView.text.className=cls;}}function updateLineClasses(lineView){updateLineBackground(lineView);if(lineView.line.wrapClass){ensureLineWrapped(lineView).className=lineView.line.wrapClass;}else if(lineView.node!=lineView.text){lineView.node.className="";}var textClass=lineView.textClass?lineView.textClass+" "+(lineView.line.textClass||""):lineView.line.textClass;lineView.text.className=textClass||"";}function updateLineGutter(cm,lineView,lineN,dims){if(lineView.gutter){lineView.node.removeChild(lineView.gutter);lineView.gutter=null;}if(lineView.gutterBackground){lineView.node.removeChild(lineView.gutterBackground);lineView.gutterBackground=null;}if(lineView.line.gutterClass){var wrap=ensureLineWrapped(lineView);lineView.gutterBackground=elt("div",null,"CodeMirror-gutter-background "+lineView.line.gutterClass,"left: "+(cm.options.fixedGutter?dims.fixedPos:-dims.gutterTotalWidth)+"px; width: "+dims.gutterTotalWidth+"px");wrap.insertBefore(lineView.gutterBackground,lineView.text);}var markers=lineView.line.gutterMarkers;if(cm.options.lineNumbers||markers){var wrap$1=ensureLineWrapped(lineView);var gutterWrap=lineView.gutter=elt("div",null,"CodeMirror-gutter-wrapper","left: "+(cm.options.fixedGutter?dims.fixedPos:-dims.gutterTotalWidth)+"px");cm.display.input.setUneditable(gutterWrap);wrap$1.insertBefore(gutterWrap,lineView.text);if(lineView.line.gutterClass){gutterWrap.className+=" "+lineView.line.gutterClass;}if(cm.options.lineNumbers&&(!markers||!markers["CodeMirror-linenumbers"])){lineView.lineNumber=gutterWrap.appendChild(elt("div",lineNumberFor(cm.options,lineN),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+dims.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+cm.display.lineNumInnerWidth+"px"));}if(markers){for(var k=0;k<cm.options.gutters.length;++k){var id=cm.options.gutters[k],found=markers.hasOwnProperty(id)&&markers[id];if(found){gutterWrap.appendChild(elt("div",[found],"CodeMirror-gutter-elt","left: "+dims.gutterLeft[id]+"px; width: "+dims.gutterWidth[id]+"px"));}}}}}function updateLineWidgets(cm,lineView,dims){if(lineView.alignable){lineView.alignable=null;}for(var node=lineView.node.firstChild,next=void 0;node;node=next){next=node.nextSibling;if(node.className=="CodeMirror-linewidget"){lineView.node.removeChild(node);}}insertLineWidgets(cm,lineView,dims);}// Build a line\'s DOM representation from scratch\nfunction buildLineElement(cm,lineView,lineN,dims){var built=getLineContent(cm,lineView);lineView.text=lineView.node=built.pre;if(built.bgClass){lineView.bgClass=built.bgClass;}if(built.textClass){lineView.textClass=built.textClass;}updateLineClasses(lineView);updateLineGutter(cm,lineView,lineN,dims);insertLineWidgets(cm,lineView,dims);return lineView.node;}// A lineView may contain multiple logical lines (when merged by\n// collapsed spans). The widgets for all of them need to be drawn.\nfunction insertLineWidgets(cm,lineView,dims){insertLineWidgetsFor(cm,lineView.line,lineView,dims,true);if(lineView.rest){for(var i=0;i<lineView.rest.length;i++){insertLineWidgetsFor(cm,lineView.rest[i],lineView,dims,false);}}}function insertLineWidgetsFor(cm,line,lineView,dims,allowAbove){if(!line.widgets){return;}var wrap=ensureLineWrapped(lineView);for(var i=0,ws=line.widgets;i<ws.length;++i){var widget=ws[i],node=elt("div",[widget.node],"CodeMirror-linewidget");if(!widget.handleMouseEvents){node.setAttribute("cm-ignore-events","true");}positionLineWidget(widget,node,lineView,dims);cm.display.input.setUneditable(node);if(allowAbove&&widget.above){wrap.insertBefore(node,lineView.gutter||lineView.text);}else{wrap.appendChild(node);}signalLater(widget,"redraw");}}function positionLineWidget(widget,node,lineView,dims){if(widget.noHScroll){;(lineView.alignable||(lineView.alignable=[])).push(node);var width=dims.wrapperWidth;node.style.left=dims.fixedPos+"px";if(!widget.coverGutter){width-=dims.gutterTotalWidth;node.style.paddingLeft=dims.gutterTotalWidth+"px";}node.style.width=width+"px";}if(widget.coverGutter){node.style.zIndex=5;node.style.position="relative";if(!widget.noHScroll){node.style.marginLeft=-dims.gutterTotalWidth+"px";}}}function widgetHeight(widget){if(widget.height!=null){return widget.height;}var cm=widget.doc.cm;if(!cm){return 0;}if(!contains(document.body,widget.node)){var parentStyle="position: relative;";if(widget.coverGutter){parentStyle+="margin-left: -"+cm.display.gutters.offsetWidth+"px;";}if(widget.noHScroll){parentStyle+="width: "+cm.display.wrapper.clientWidth+"px;";}removeChildrenAndAdd(cm.display.measure,elt("div",[widget.node],null,parentStyle));}return widget.height=widget.node.parentNode.offsetHeight;}// Return true when the given mouse event happened in a widget\nfunction eventInWidget(display,e){for(var n=e_target(e);n!=display.wrapper;n=n.parentNode){if(!n||n.nodeType==1&&n.getAttribute("cm-ignore-events")=="true"||n.parentNode==display.sizer&&n!=display.mover){return true;}}}// POSITION MEASUREMENT\nfunction paddingTop(display){return display.lineSpace.offsetTop;}function paddingVert(display){return display.mover.offsetHeight-display.lineSpace.offsetHeight;}function paddingH(display){if(display.cachedPaddingH){return display.cachedPaddingH;}var e=removeChildrenAndAdd(display.measure,elt("pre","x"));var style=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle;var data={left:parseInt(style.paddingLeft),right:parseInt(style.paddingRight)};if(!isNaN(data.left)&&!isNaN(data.right)){display.cachedPaddingH=data;}return data;}function scrollGap(cm){return scrollerGap-cm.display.nativeBarWidth;}function displayWidth(cm){return cm.display.scroller.clientWidth-scrollGap(cm)-cm.display.barWidth;}function displayHeight(cm){return cm.display.scroller.clientHeight-scrollGap(cm)-cm.display.barHeight;}// Ensure the lineView.wrapping.heights array is populated. This is\n// an array of bottom offsets for the lines that make up a drawn\n// line. When lineWrapping is on, there might be more than one\n// height.\nfunction ensureLineHeights(cm,lineView,rect){var wrapping=cm.options.lineWrapping;var curWidth=wrapping&&displayWidth(cm);if(!lineView.measure.heights||wrapping&&lineView.measure.width!=curWidth){var heights=lineView.measure.heights=[];if(wrapping){lineView.measure.width=curWidth;var rects=lineView.text.firstChild.getClientRects();for(var i=0;i<rects.length-1;i++){var cur=rects[i],next=rects[i+1];if(Math.abs(cur.bottom-next.bottom)>2){heights.push((cur.bottom+next.top)/2-rect.top);}}}heights.push(rect.bottom-rect.top);}}// Find a line map (mapping character offsets to text nodes) and a\n// measurement cache for the given line number. (A line view might\n// contain multiple lines when collapsed ranges are present.)\nfunction mapFromLineView(lineView,line,lineN){if(lineView.line==line){return{map:lineView.measure.map,cache:lineView.measure.cache};}for(var i=0;i<lineView.rest.length;i++){if(lineView.rest[i]==line){return{map:lineView.measure.maps[i],cache:lineView.measure.caches[i]};}}for(var i$1=0;i$1<lineView.rest.length;i$1++){if(lineNo(lineView.rest[i$1])>lineN){return{map:lineView.measure.maps[i$1],cache:lineView.measure.caches[i$1],before:true};}}}// Render a line into the hidden node display.externalMeasured. Used\n// when measurement is needed for a line that\'s not in the viewport.\nfunction updateExternalMeasurement(cm,line){line=visualLine(line);var lineN=lineNo(line);var view=cm.display.externalMeasured=new LineView(cm.doc,line,lineN);view.lineN=lineN;var built=view.built=buildLineContent(cm,view);view.text=built.pre;removeChildrenAndAdd(cm.display.lineMeasure,built.pre);return view;}// Get a {top, bottom, left, right} box (in line-local coordinates)\n// for a given character.\nfunction measureChar(cm,line,ch,bias){return measureCharPrepared(cm,prepareMeasureForLine(cm,line),ch,bias);}// Find a line view that corresponds to the given line number.\nfunction findViewForLine(cm,lineN){if(lineN>=cm.display.viewFrom&&lineN<cm.display.viewTo){return cm.display.view[findViewIndex(cm,lineN)];}var ext=cm.display.externalMeasured;if(ext&&lineN>=ext.lineN&&lineN<ext.lineN+ext.size){return ext;}}// Measurement can be split in two steps, the set-up work that\n// applies to the whole line, and the measurement of the actual\n// character. Functions like coordsChar, that need to do a lot of\n// measurements in a row, can thus ensure that the set-up work is\n// only done once.\nfunction prepareMeasureForLine(cm,line){var lineN=lineNo(line);var view=findViewForLine(cm,lineN);if(view&&!view.text){view=null;}else if(view&&view.changes){updateLineForChanges(cm,view,lineN,getDimensions(cm));cm.curOp.forceUpdate=true;}if(!view){view=updateExternalMeasurement(cm,line);}var info=mapFromLineView(view,line,lineN);return{line:line,view:view,rect:null,map:info.map,cache:info.cache,before:info.before,hasHeights:false};}// Given a prepared measurement object, measures the position of an\n// actual character (or fetches it from the cache).\nfunction measureCharPrepared(cm,prepared,ch,bias,varHeight){if(prepared.before){ch=-1;}var key=ch+(bias||""),found;if(prepared.cache.hasOwnProperty(key)){found=prepared.cache[key];}else{if(!prepared.rect){prepared.rect=prepared.view.text.getBoundingClientRect();}if(!prepared.hasHeights){ensureLineHeights(cm,prepared.view,prepared.rect);prepared.hasHeights=true;}found=measureCharInner(cm,prepared,ch,bias);if(!found.bogus){prepared.cache[key]=found;}}return{left:found.left,right:found.right,top:varHeight?found.rtop:found.top,bottom:varHeight?found.rbottom:found.bottom};}var nullRect={left:0,right:0,top:0,bottom:0};function nodeAndOffsetInLineMap(map,ch,bias){var node,start,end,collapse,mStart,mEnd;// First, search the line map for the text node corresponding to,\n// or closest to, the target character.\nfor(var i=0;i<map.length;i+=3){mStart=map[i];mEnd=map[i+1];if(ch<mStart){start=0;end=1;collapse="left";}else if(ch<mEnd){start=ch-mStart;end=start+1;}else if(i==map.length-3||ch==mEnd&&map[i+3]>ch){end=mEnd-mStart;start=end-1;if(ch>=mEnd){collapse="right";}}if(start!=null){node=map[i+2];if(mStart==mEnd&&bias==(node.insertLeft?"left":"right")){collapse=bias;}if(bias=="left"&&start==0){while(i&&map[i-2]==map[i-3]&&map[i-1].insertLeft){node=map[(i-=3)+2];collapse="left";}}if(bias=="right"&&start==mEnd-mStart){while(i<map.length-3&&map[i+3]==map[i+4]&&!map[i+5].insertLeft){node=map[(i+=3)+2];collapse="right";}}break;}}return{node:node,start:start,end:end,collapse:collapse,coverStart:mStart,coverEnd:mEnd};}function getUsefulRect(rects,bias){var rect=nullRect;if(bias=="left"){for(var i=0;i<rects.length;i++){if((rect=rects[i]).left!=rect.right){break;}}}else{for(var i$1=rects.length-1;i$1>=0;i$1--){if((rect=rects[i$1]).left!=rect.right){break;}}}return rect;}function measureCharInner(cm,prepared,ch,bias){var place=nodeAndOffsetInLineMap(prepared.map,ch,bias);var node=place.node,start=place.start,end=place.end,collapse=place.collapse;var rect;if(node.nodeType==3){// If it is a text node, use a range to retrieve the coordinates.\nfor(var i$1=0;i$1<4;i$1++){// Retry a maximum of 4 times when nonsense rectangles are returned\nwhile(start&&isExtendingChar(prepared.line.text.charAt(place.coverStart+start))){--start;}while(place.coverStart+end<place.coverEnd&&isExtendingChar(prepared.line.text.charAt(place.coverStart+end))){++end;}if(ie&&ie_version<9&&start==0&&end==place.coverEnd-place.coverStart){rect=node.parentNode.getBoundingClientRect();}else{rect=getUsefulRect(range(node,start,end).getClientRects(),bias);}if(rect.left||rect.right||start==0){break;}end=start;start=start-1;collapse="right";}if(ie&&ie_version<11){rect=maybeUpdateRectForZooming(cm.display.measure,rect);}}else{// If it is a widget, simply get the box for the whole widget.\nif(start>0){collapse=bias="right";}var rects;if(cm.options.lineWrapping&&(rects=node.getClientRects()).length>1){rect=rects[bias=="right"?rects.length-1:0];}else{rect=node.getBoundingClientRect();}}if(ie&&ie_version<9&&!start&&(!rect||!rect.left&&!rect.right)){var rSpan=node.parentNode.getClientRects()[0];if(rSpan){rect={left:rSpan.left,right:rSpan.left+charWidth(cm.display),top:rSpan.top,bottom:rSpan.bottom};}else{rect=nullRect;}}var rtop=rect.top-prepared.rect.top,rbot=rect.bottom-prepared.rect.top;var mid=(rtop+rbot)/2;var heights=prepared.view.measure.heights;var i=0;for(;i<heights.length-1;i++){if(mid<heights[i]){break;}}var top=i?heights[i-1]:0,bot=heights[i];var result={left:(collapse=="right"?rect.right:rect.left)-prepared.rect.left,right:(collapse=="left"?rect.left:rect.right)-prepared.rect.left,top:top,bottom:bot};if(!rect.left&&!rect.right){result.bogus=true;}if(!cm.options.singleCursorHeightPerLine){result.rtop=rtop;result.rbottom=rbot;}return result;}// Work around problem with bounding client rects on ranges being\n// returned incorrectly when zoomed on IE10 and below.\nfunction maybeUpdateRectForZooming(measure,rect){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!hasBadZoomedRects(measure)){return rect;}var scaleX=screen.logicalXDPI/screen.deviceXDPI;var scaleY=screen.logicalYDPI/screen.deviceYDPI;return{left:rect.left*scaleX,right:rect.right*scaleX,top:rect.top*scaleY,bottom:rect.bottom*scaleY};}function clearLineMeasurementCacheFor(lineView){if(lineView.measure){lineView.measure.cache={};lineView.measure.heights=null;if(lineView.rest){for(var i=0;i<lineView.rest.length;i++){lineView.measure.caches[i]={};}}}}function clearLineMeasurementCache(cm){cm.display.externalMeasure=null;removeChildren(cm.display.lineMeasure);for(var i=0;i<cm.display.view.length;i++){clearLineMeasurementCacheFor(cm.display.view[i]);}}function clearCaches(cm){clearLineMeasurementCache(cm);cm.display.cachedCharWidth=cm.display.cachedTextHeight=cm.display.cachedPaddingH=null;if(!cm.options.lineWrapping){cm.display.maxLineChanged=true;}cm.display.lineNumChars=null;}function pageScrollX(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft;}function pageScrollY(){return window.pageYOffset||(document.documentElement||document.body).scrollTop;}// Converts a {top, bottom, left, right} box from line-local\n// coordinates into another coordinate system. Context may be one of\n// "line", "div" (display.lineDiv), "local"./null (editor), "window",\n// or "page".\nfunction intoCoordSystem(cm,lineObj,rect,context){if(lineObj.widgets){for(var i=0;i<lineObj.widgets.length;++i){if(lineObj.widgets[i].above){var size=widgetHeight(lineObj.widgets[i]);rect.top+=size;rect.bottom+=size;}}}if(context=="line"){return rect;}if(!context){context="local";}var yOff=heightAtLine(lineObj);if(context=="local"){yOff+=paddingTop(cm.display);}else{yOff-=cm.display.viewOffset;}if(context=="page"||context=="window"){var lOff=cm.display.lineSpace.getBoundingClientRect();yOff+=lOff.top+(context=="window"?0:pageScrollY());var xOff=lOff.left+(context=="window"?0:pageScrollX());rect.left+=xOff;rect.right+=xOff;}rect.top+=yOff;rect.bottom+=yOff;return rect;}// Coverts a box from "div" coords to another coordinate system.\n// Context may be "window", "page", "div", or "local"./null.\nfunction fromCoordSystem(cm,coords,context){if(context=="div"){return coords;}var left=coords.left,top=coords.top;// First move into "page" coordinate system\nif(context=="page"){left-=pageScrollX();top-=pageScrollY();}else if(context=="local"||!context){var localBox=cm.display.sizer.getBoundingClientRect();left+=localBox.left;top+=localBox.top;}var lineSpaceBox=cm.display.lineSpace.getBoundingClientRect();return{left:left-lineSpaceBox.left,top:top-lineSpaceBox.top};}function charCoords(cm,pos,context,lineObj,bias){if(!lineObj){lineObj=getLine(cm.doc,pos.line);}return intoCoordSystem(cm,lineObj,measureChar(cm,lineObj,pos.ch,bias),context);}// Returns a box for a given cursor position, which may have an\n// \'other\' property containing the position of the secondary cursor\n// on a bidi boundary.\nfunction cursorCoords(cm,pos,context,lineObj,preparedMeasure,varHeight){lineObj=lineObj||getLine(cm.doc,pos.line);if(!preparedMeasure){preparedMeasure=prepareMeasureForLine(cm,lineObj);}function get(ch,right){var m=measureCharPrepared(cm,preparedMeasure,ch,right?"right":"left",varHeight);if(right){m.left=m.right;}else{m.right=m.left;}return intoCoordSystem(cm,lineObj,m,context);}function getBidi(ch,partPos){var part=order[partPos],right=part.level%2;if(ch==bidiLeft(part)&&partPos&&part.level<order[partPos-1].level){part=order[--partPos];ch=bidiRight(part)-(part.level%2?0:1);right=true;}else if(ch==bidiRight(part)&&partPos<order.length-1&&part.level<order[partPos+1].level){part=order[++partPos];ch=bidiLeft(part)-part.level%2;right=false;}if(right&&ch==part.to&&ch>part.from){return get(ch-1);}return get(ch,right);}var order=getOrder(lineObj),ch=pos.ch;if(!order){return get(ch);}var partPos=getBidiPartAt(order,ch);var val=getBidi(ch,partPos);if(bidiOther!=null){val.other=getBidi(ch,bidiOther);}return val;}// Used to cheaply estimate the coordinates for a position. Used for\n// intermediate scroll updates.\nfunction estimateCoords(cm,pos){var left=0;pos=clipPos(cm.doc,pos);if(!cm.options.lineWrapping){left=charWidth(cm.display)*pos.ch;}var lineObj=getLine(cm.doc,pos.line);var top=heightAtLine(lineObj)+paddingTop(cm.display);return{left:left,right:left,top:top,bottom:top+lineObj.height};}// Positions returned by coordsChar contain some extra information.\n// xRel is the relative x position of the input coordinates compared\n// to the found position (so xRel > 0 means the coordinates are to\n// the right of the character position, for example). When outside\n// is true, that means the coordinates lie outside the line\'s\n// vertical range.\nfunction PosWithInfo(line,ch,outside,xRel){var pos=Pos(line,ch);pos.xRel=xRel;if(outside){pos.outside=true;}return pos;}// Compute the character position closest to the given coordinates.\n// Input must be lineSpace-local ("div" coordinate system).\nfunction coordsChar(cm,x,y){var doc=cm.doc;y+=cm.display.viewOffset;if(y<0){return PosWithInfo(doc.first,0,true,-1);}var lineN=lineAtHeight(doc,y),last=doc.first+doc.size-1;if(lineN>last){return PosWithInfo(doc.first+doc.size-1,getLine(doc,last).text.length,true,1);}if(x<0){x=0;}var lineObj=getLine(doc,lineN);for(;;){var found=coordsCharInner(cm,lineObj,lineN,x,y);var merged=collapsedSpanAtEnd(lineObj);var mergedPos=merged&&merged.find(0,true);if(merged&&(found.ch>mergedPos.from.ch||found.ch==mergedPos.from.ch&&found.xRel>0)){lineN=lineNo(lineObj=mergedPos.to.line);}else{return found;}}}function coordsCharInner(cm,lineObj,lineNo,x,y){var innerOff=y-heightAtLine(lineObj);var wrongLine=false,adjust=2*cm.display.wrapper.clientWidth;var preparedMeasure=prepareMeasureForLine(cm,lineObj);function getX(ch){var sp=cursorCoords(cm,Pos(lineNo,ch),"line",lineObj,preparedMeasure);wrongLine=true;if(innerOff>sp.bottom){return sp.left-adjust;}else if(innerOff<sp.top){return sp.left+adjust;}else{wrongLine=false;}return sp.left;}var bidi=getOrder(lineObj),dist=lineObj.text.length;var from=lineLeft(lineObj),to=lineRight(lineObj);var fromX=getX(from),fromOutside=wrongLine,toX=getX(to),toOutside=wrongLine;if(x>toX){return PosWithInfo(lineNo,to,toOutside,1);}// Do a binary search between these bounds.\nfor(;;){if(bidi?to==from||to==moveVisually(lineObj,from,1):to-from<=1){var ch=x<fromX||x-fromX<=toX-x?from:to;var outside=ch==from?fromOutside:toOutside;var xDiff=x-(ch==from?fromX:toX);// This is a kludge to handle the case where the coordinates\n// are after a line-wrapped line. We should replace it with a\n// more general handling of cursor positions around line\n// breaks. (Issue #4078)\nif(toOutside&&!bidi&&!/\\s/.test(lineObj.text.charAt(ch))&&xDiff>0&&ch<lineObj.text.length&&preparedMeasure.view.measure.heights.length>1){var charSize=measureCharPrepared(cm,preparedMeasure,ch,"right");if(innerOff<=charSize.bottom&&innerOff>=charSize.top&&Math.abs(x-charSize.right)<xDiff){outside=false;ch++;xDiff=x-charSize.right;}}while(isExtendingChar(lineObj.text.charAt(ch))){++ch;}var pos=PosWithInfo(lineNo,ch,outside,xDiff<-1?-1:xDiff>1?1:0);return pos;}var step=Math.ceil(dist/2),middle=from+step;if(bidi){middle=from;for(var i=0;i<step;++i){middle=moveVisually(lineObj,middle,1);}}var middleX=getX(middle);if(middleX>x){to=middle;toX=middleX;if(toOutside=wrongLine){toX+=1000;}dist=step;}else{from=middle;fromX=middleX;fromOutside=wrongLine;dist-=step;}}}var measureText;// Compute the default text height.\nfunction textHeight(display){if(display.cachedTextHeight!=null){return display.cachedTextHeight;}if(measureText==null){measureText=elt("pre");// Measure a bunch of lines, for browsers that compute\n// fractional heights.\nfor(var i=0;i<49;++i){measureText.appendChild(document.createTextNode("x"));measureText.appendChild(elt("br"));}measureText.appendChild(document.createTextNode("x"));}removeChildrenAndAdd(display.measure,measureText);var height=measureText.offsetHeight/50;if(height>3){display.cachedTextHeight=height;}removeChildren(display.measure);return height||1;}// Compute the default character width.\nfunction charWidth(display){if(display.cachedCharWidth!=null){return display.cachedCharWidth;}var anchor=elt("span","xxxxxxxxxx");var pre=elt("pre",[anchor]);removeChildrenAndAdd(display.measure,pre);var rect=anchor.getBoundingClientRect(),width=(rect.right-rect.left)/10;if(width>2){display.cachedCharWidth=width;}return width||10;}// Do a bulk-read of the DOM positions and sizes needed to draw the\n// view, so that we don\'t interleave reading and writing to the DOM.\nfunction getDimensions(cm){var d=cm.display,left={},width={};var gutterLeft=d.gutters.clientLeft;for(var n=d.gutters.firstChild,i=0;n;n=n.nextSibling,++i){left[cm.options.gutters[i]]=n.offsetLeft+n.clientLeft+gutterLeft;width[cm.options.gutters[i]]=n.clientWidth;}return{fixedPos:compensateForHScroll(d),gutterTotalWidth:d.gutters.offsetWidth,gutterLeft:left,gutterWidth:width,wrapperWidth:d.wrapper.clientWidth};}// Computes display.scroller.scrollLeft + display.gutters.offsetWidth,\n// but using getBoundingClientRect to get a sub-pixel-accurate\n// result.\nfunction compensateForHScroll(display){return display.scroller.getBoundingClientRect().left-display.sizer.getBoundingClientRect().left;}// Returns a function that estimates the height of a line, to use as\n// first approximation until the line becomes visible (and is thus\n// properly measurable).\nfunction estimateHeight(cm){var th=textHeight(cm.display),wrapping=cm.options.lineWrapping;var perLine=wrapping&&Math.max(5,cm.display.scroller.clientWidth/charWidth(cm.display)-3);return function(line){if(lineIsHidden(cm.doc,line)){return 0;}var widgetsHeight=0;if(line.widgets){for(var i=0;i<line.widgets.length;i++){if(line.widgets[i].height){widgetsHeight+=line.widgets[i].height;}}}if(wrapping){return widgetsHeight+(Math.ceil(line.text.length/perLine)||1)*th;}else{return widgetsHeight+th;}};}function estimateLineHeights(cm){var doc=cm.doc,est=estimateHeight(cm);doc.iter(function(line){var estHeight=est(line);if(estHeight!=line.height){updateLineHeight(line,estHeight);}});}// Given a mouse event, find the corresponding position. If liberal\n// is false, it checks whether a gutter or scrollbar was clicked,\n// and returns null if it was. forRect is used by rectangular\n// selections, and tries to estimate a character position even for\n// coordinates beyond the right of the text.\nfunction posFromMouse(cm,e,liberal,forRect){var display=cm.display;if(!liberal&&e_target(e).getAttribute("cm-not-content")=="true"){return null;}var x,y,space=display.lineSpace.getBoundingClientRect();// Fails unpredictably on IE[67] when mouse is dragged around quickly.\ntry{x=e.clientX-space.left;y=e.clientY-space.top;}catch(e){return null;}var coords=coordsChar(cm,x,y),line;if(forRect&&coords.xRel==1&&(line=getLine(cm.doc,coords.line).text).length==coords.ch){var colDiff=countColumn(line,line.length,cm.options.tabSize)-line.length;coords=Pos(coords.line,Math.max(0,Math.round((x-paddingH(cm.display).left)/charWidth(cm.display))-colDiff));}return coords;}// Find the view element corresponding to a given line. Return null\n// when the line isn\'t visible.\nfunction findViewIndex(cm,n){if(n>=cm.display.viewTo){return null;}n-=cm.display.viewFrom;if(n<0){return null;}var view=cm.display.view;for(var i=0;i<view.length;i++){n-=view[i].size;if(n<0){return i;}}}function updateSelection(cm){cm.display.input.showSelection(cm.display.input.prepareSelection());}function prepareSelection(cm,primary){var doc=cm.doc,result={};var curFragment=result.cursors=document.createDocumentFragment();var selFragment=result.selection=document.createDocumentFragment();for(var i=0;i<doc.sel.ranges.length;i++){if(primary===false&&i==doc.sel.primIndex){continue;}var range=doc.sel.ranges[i];if(range.from().line>=cm.display.viewTo||range.to().line<cm.display.viewFrom){continue;}var collapsed=range.empty();if(collapsed||cm.options.showCursorWhenSelecting){drawSelectionCursor(cm,range.head,curFragment);}if(!collapsed){drawSelectionRange(cm,range,selFragment);}}return result;}// Draws a cursor for the given range\nfunction drawSelectionCursor(cm,head,output){var pos=cursorCoords(cm,head,"div",null,null,!cm.options.singleCursorHeightPerLine);var cursor=output.appendChild(elt("div","\\u00a0","CodeMirror-cursor"));cursor.style.left=pos.left+"px";cursor.style.top=pos.top+"px";cursor.style.height=Math.max(0,pos.bottom-pos.top)*cm.options.cursorHeight+"px";if(pos.other){// Secondary cursor, shown when on a \'jump\' in bi-directional text\nvar otherCursor=output.appendChild(elt("div","\\u00a0","CodeMirror-cursor CodeMirror-secondarycursor"));otherCursor.style.display="";otherCursor.style.left=pos.other.left+"px";otherCursor.style.top=pos.other.top+"px";otherCursor.style.height=(pos.other.bottom-pos.other.top)*.85+"px";}}// Draws the given range as a highlighted selection\nfunction drawSelectionRange(cm,range,output){var display=cm.display,doc=cm.doc;var fragment=document.createDocumentFragment();var padding=paddingH(cm.display),leftSide=padding.left;var rightSide=Math.max(display.sizerWidth,displayWidth(cm)-display.sizer.offsetLeft)-padding.right;function add(left,top,width,bottom){if(top<0){top=0;}top=Math.round(top);bottom=Math.round(bottom);fragment.appendChild(elt("div",null,"CodeMirror-selected","position: absolute; left: "+left+"px;\\n                             top: "+top+"px; width: "+(width==null?rightSide-left:width)+"px;\\n                             height: "+(bottom-top)+"px"));}function drawForLine(line,fromArg,toArg){var lineObj=getLine(doc,line);var lineLen=lineObj.text.length;var start,end;function coords(ch,bias){return charCoords(cm,Pos(line,ch),"div",lineObj,bias);}iterateBidiSections(getOrder(lineObj),fromArg||0,toArg==null?lineLen:toArg,function(from,to,dir){var leftPos=coords(from,"left"),rightPos,left,right;if(from==to){rightPos=leftPos;left=right=leftPos.left;}else{rightPos=coords(to-1,"right");if(dir=="rtl"){var tmp=leftPos;leftPos=rightPos;rightPos=tmp;}left=leftPos.left;right=rightPos.right;}if(fromArg==null&&from==0){left=leftSide;}if(rightPos.top-leftPos.top>3){// Different lines, draw top part\nadd(left,leftPos.top,null,leftPos.bottom);left=leftSide;if(leftPos.bottom<rightPos.top){add(left,leftPos.bottom,null,rightPos.top);}}if(toArg==null&&to==lineLen){right=rightSide;}if(!start||leftPos.top<start.top||leftPos.top==start.top&&leftPos.left<start.left){start=leftPos;}if(!end||rightPos.bottom>end.bottom||rightPos.bottom==end.bottom&&rightPos.right>end.right){end=rightPos;}if(left<leftSide+1){left=leftSide;}add(left,rightPos.top,right-left,rightPos.bottom);});return{start:start,end:end};}var sFrom=range.from(),sTo=range.to();if(sFrom.line==sTo.line){drawForLine(sFrom.line,sFrom.ch,sTo.ch);}else{var fromLine=getLine(doc,sFrom.line),toLine=getLine(doc,sTo.line);var singleVLine=visualLine(fromLine)==visualLine(toLine);var leftEnd=drawForLine(sFrom.line,sFrom.ch,singleVLine?fromLine.text.length+1:null).end;var rightStart=drawForLine(sTo.line,singleVLine?0:null,sTo.ch).start;if(singleVLine){if(leftEnd.top<rightStart.top-2){add(leftEnd.right,leftEnd.top,null,leftEnd.bottom);add(leftSide,rightStart.top,rightStart.left,rightStart.bottom);}else{add(leftEnd.right,leftEnd.top,rightStart.left-leftEnd.right,leftEnd.bottom);}}if(leftEnd.bottom<rightStart.top){add(leftSide,leftEnd.bottom,null,rightStart.top);}}output.appendChild(fragment);}// Cursor-blinking\nfunction restartBlink(cm){if(!cm.state.focused){return;}var display=cm.display;clearInterval(display.blinker);var on=true;display.cursorDiv.style.visibility="";if(cm.options.cursorBlinkRate>0){display.blinker=setInterval(function(){return display.cursorDiv.style.visibility=(on=!on)?"":"hidden";},cm.options.cursorBlinkRate);}else if(cm.options.cursorBlinkRate<0){display.cursorDiv.style.visibility="hidden";}}function ensureFocus(cm){if(!cm.state.focused){cm.display.input.focus();onFocus(cm);}}function delayBlurEvent(cm){cm.state.delayingBlurEvent=true;setTimeout(function(){if(cm.state.delayingBlurEvent){cm.state.delayingBlurEvent=false;onBlur(cm);}},100);}function onFocus(cm,e){if(cm.state.delayingBlurEvent){cm.state.delayingBlurEvent=false;}if(cm.options.readOnly=="nocursor"){return;}if(!cm.state.focused){signal(cm,"focus",cm,e);cm.state.focused=true;addClass(cm.display.wrapper,"CodeMirror-focused");// This test prevents this from firing when a context\n// menu is closed (since the input reset would kill the\n// select-all detection hack)\nif(!cm.curOp&&cm.display.selForContextMenu!=cm.doc.sel){cm.display.input.reset();if(webkit){setTimeout(function(){return cm.display.input.reset(true);},20);}// Issue #1730\n}cm.display.input.receivedFocus();}restartBlink(cm);}function onBlur(cm,e){if(cm.state.delayingBlurEvent){return;}if(cm.state.focused){signal(cm,"blur",cm,e);cm.state.focused=false;rmClass(cm.display.wrapper,"CodeMirror-focused");}clearInterval(cm.display.blinker);setTimeout(function(){if(!cm.state.focused){cm.display.shift=false;}},150);}// Re-align line numbers and gutter marks to compensate for\n// horizontal scrolling.\nfunction alignHorizontally(cm){var display=cm.display,view=display.view;if(!display.alignWidgets&&(!display.gutters.firstChild||!cm.options.fixedGutter)){return;}var comp=compensateForHScroll(display)-display.scroller.scrollLeft+cm.doc.scrollLeft;var gutterW=display.gutters.offsetWidth,left=comp+"px";for(var i=0;i<view.length;i++){if(!view[i].hidden){if(cm.options.fixedGutter){if(view[i].gutter){view[i].gutter.style.left=left;}if(view[i].gutterBackground){view[i].gutterBackground.style.left=left;}}var align=view[i].alignable;if(align){for(var j=0;j<align.length;j++){align[j].style.left=left;}}}}if(cm.options.fixedGutter){display.gutters.style.left=comp+gutterW+"px";}}// Used to ensure that the line number gutter is still the right\n// size for the current document size. Returns true when an update\n// is needed.\nfunction maybeUpdateLineNumberWidth(cm){if(!cm.options.lineNumbers){return false;}var doc=cm.doc,last=lineNumberFor(cm.options,doc.first+doc.size-1),display=cm.display;if(last.length!=display.lineNumChars){var test=display.measure.appendChild(elt("div",[elt("div",last)],"CodeMirror-linenumber CodeMirror-gutter-elt"));var innerW=test.firstChild.offsetWidth,padding=test.offsetWidth-innerW;display.lineGutter.style.width="";display.lineNumInnerWidth=Math.max(innerW,display.lineGutter.offsetWidth-padding)+1;display.lineNumWidth=display.lineNumInnerWidth+padding;display.lineNumChars=display.lineNumInnerWidth?last.length:-1;display.lineGutter.style.width=display.lineNumWidth+"px";updateGutterSpace(cm);return true;}return false;}// Read the actual heights of the rendered lines, and update their\n// stored heights to match.\nfunction updateHeightsInViewport(cm){var display=cm.display;var prevBottom=display.lineDiv.offsetTop;for(var i=0;i<display.view.length;i++){var cur=display.view[i],height=void 0;if(cur.hidden){continue;}if(ie&&ie_version<8){var bot=cur.node.offsetTop+cur.node.offsetHeight;height=bot-prevBottom;prevBottom=bot;}else{var box=cur.node.getBoundingClientRect();height=box.bottom-box.top;}var diff=cur.line.height-height;if(height<2){height=textHeight(display);}if(diff>.001||diff<-.001){updateLineHeight(cur.line,height);updateWidgetHeight(cur.line);if(cur.rest){for(var j=0;j<cur.rest.length;j++){updateWidgetHeight(cur.rest[j]);}}}}}// Read and store the height of line widgets associated with the\n// given line.\nfunction updateWidgetHeight(line){if(line.widgets){for(var i=0;i<line.widgets.length;++i){line.widgets[i].height=line.widgets[i].node.parentNode.offsetHeight;}}}// Compute the lines that are visible in a given viewport (defaults\n// the the current scroll position). viewport may contain top,\n// height, and ensure (see op.scrollToPos) properties.\nfunction visibleLines(display,doc,viewport){var top=viewport&&viewport.top!=null?Math.max(0,viewport.top):display.scroller.scrollTop;top=Math.floor(top-paddingTop(display));var bottom=viewport&&viewport.bottom!=null?viewport.bottom:top+display.wrapper.clientHeight;var from=lineAtHeight(doc,top),to=lineAtHeight(doc,bottom);// Ensure is a {from: {line, ch}, to: {line, ch}} object, and\n// forces those lines into the viewport (if possible).\nif(viewport&&viewport.ensure){var ensureFrom=viewport.ensure.from.line,ensureTo=viewport.ensure.to.line;if(ensureFrom<from){from=ensureFrom;to=lineAtHeight(doc,heightAtLine(getLine(doc,ensureFrom))+display.wrapper.clientHeight);}else if(Math.min(ensureTo,doc.lastLine())>=to){from=lineAtHeight(doc,heightAtLine(getLine(doc,ensureTo))-display.wrapper.clientHeight);to=ensureTo;}}return{from:from,to:Math.max(to,from+1)};}// Sync the scrollable area and scrollbars, ensure the viewport\n// covers the visible area.\nfunction setScrollTop(cm,val){if(Math.abs(cm.doc.scrollTop-val)<2){return;}cm.doc.scrollTop=val;if(!gecko){updateDisplaySimple(cm,{top:val});}if(cm.display.scroller.scrollTop!=val){cm.display.scroller.scrollTop=val;}cm.display.scrollbars.setScrollTop(val);if(gecko){updateDisplaySimple(cm);}startWorker(cm,100);}// Sync scroller and scrollbar, ensure the gutter elements are\n// aligned.\nfunction setScrollLeft(cm,val,isScroller){if(isScroller?val==cm.doc.scrollLeft:Math.abs(cm.doc.scrollLeft-val)<2){return;}val=Math.min(val,cm.display.scroller.scrollWidth-cm.display.scroller.clientWidth);cm.doc.scrollLeft=val;alignHorizontally(cm);if(cm.display.scroller.scrollLeft!=val){cm.display.scroller.scrollLeft=val;}cm.display.scrollbars.setScrollLeft(val);}// Since the delta values reported on mouse wheel events are\n// unstandardized between browsers and even browser versions, and\n// generally horribly unpredictable, this code starts by measuring\n// the scroll effect that the first few mouse wheel events have,\n// and, from that, detects the way it can convert deltas to pixel\n// offsets afterwards.\n//\n// The reason we want to know the amount a wheel event will scroll\n// is that it gives us a chance to update the display before the\n// actual scrolling happens, reducing flickering.\nvar wheelSamples=0;var wheelPixelsPerUnit=null;// Fill in a browser-detected starting value on browsers where we\n// know one. These don\'t have to be accurate -- the result of them\n// being wrong would just be a slight flicker on the first wheel\n// scroll (if it is large enough).\nif(ie){wheelPixelsPerUnit=-.53;}else if(gecko){wheelPixelsPerUnit=15;}else if(chrome){wheelPixelsPerUnit=-.7;}else if(safari){wheelPixelsPerUnit=-1/3;}function wheelEventDelta(e){var dx=e.wheelDeltaX,dy=e.wheelDeltaY;if(dx==null&&e.detail&&e.axis==e.HORIZONTAL_AXIS){dx=e.detail;}if(dy==null&&e.detail&&e.axis==e.VERTICAL_AXIS){dy=e.detail;}else if(dy==null){dy=e.wheelDelta;}return{x:dx,y:dy};}function wheelEventPixels(e){var delta=wheelEventDelta(e);delta.x*=wheelPixelsPerUnit;delta.y*=wheelPixelsPerUnit;return delta;}function onScrollWheel(cm,e){var delta=wheelEventDelta(e),dx=delta.x,dy=delta.y;var display=cm.display,scroll=display.scroller;// Quit if there\'s nothing to scroll here\nvar canScrollX=scroll.scrollWidth>scroll.clientWidth;var canScrollY=scroll.scrollHeight>scroll.clientHeight;if(!(dx&&canScrollX||dy&&canScrollY)){return;}// Webkit browsers on OS X abort momentum scrolls when the target\n// of the scroll event is removed from the scrollable element.\n// This hack (see related code in patchDisplay) makes sure the\n// element is kept around.\nif(dy&&mac&&webkit){outer:for(var cur=e.target,view=display.view;cur!=scroll;cur=cur.parentNode){for(var i=0;i<view.length;i++){if(view[i].node==cur){cm.display.currentWheelTarget=cur;break outer;}}}}// On some browsers, horizontal scrolling will cause redraws to\n// happen before the gutter has been realigned, causing it to\n// wriggle around in a most unseemly way. When we have an\n// estimated pixels/delta value, we just handle horizontal\n// scrolling entirely here. It\'ll be slightly off from native, but\n// better than glitching out.\nif(dx&&!gecko&&!presto&&wheelPixelsPerUnit!=null){if(dy&&canScrollY){setScrollTop(cm,Math.max(0,Math.min(scroll.scrollTop+dy*wheelPixelsPerUnit,scroll.scrollHeight-scroll.clientHeight)));}setScrollLeft(cm,Math.max(0,Math.min(scroll.scrollLeft+dx*wheelPixelsPerUnit,scroll.scrollWidth-scroll.clientWidth)));// Only prevent default scrolling if vertical scrolling is\n// actually possible. Otherwise, it causes vertical scroll\n// jitter on OSX trackpads when deltaX is small and deltaY\n// is large (issue #3579)\nif(!dy||dy&&canScrollY){e_preventDefault(e);}display.wheelStartX=null;// Abort measurement, if in progress\nreturn;}// \'Project\' the visible viewport to cover the area that is being\n// scrolled into view (if we know enough to estimate it).\nif(dy&&wheelPixelsPerUnit!=null){var pixels=dy*wheelPixelsPerUnit;var top=cm.doc.scrollTop,bot=top+display.wrapper.clientHeight;if(pixels<0){top=Math.max(0,top+pixels-50);}else{bot=Math.min(cm.doc.height,bot+pixels+50);}updateDisplaySimple(cm,{top:top,bottom:bot});}if(wheelSamples<20){if(display.wheelStartX==null){display.wheelStartX=scroll.scrollLeft;display.wheelStartY=scroll.scrollTop;display.wheelDX=dx;display.wheelDY=dy;setTimeout(function(){if(display.wheelStartX==null){return;}var movedX=scroll.scrollLeft-display.wheelStartX;var movedY=scroll.scrollTop-display.wheelStartY;var sample=movedY&&display.wheelDY&&movedY/display.wheelDY||movedX&&display.wheelDX&&movedX/display.wheelDX;display.wheelStartX=display.wheelStartY=null;if(!sample){return;}wheelPixelsPerUnit=(wheelPixelsPerUnit*wheelSamples+sample)/(wheelSamples+1);++wheelSamples;},200);}else{display.wheelDX+=dx;display.wheelDY+=dy;}}}// SCROLLBARS\n// Prepare DOM reads needed to update the scrollbars. Done in one\n// shot to minimize update/measure roundtrips.\nfunction measureForScrollbars(cm){var d=cm.display,gutterW=d.gutters.offsetWidth;var docH=Math.round(cm.doc.height+paddingVert(cm.display));return{clientHeight:d.scroller.clientHeight,viewHeight:d.wrapper.clientHeight,scrollWidth:d.scroller.scrollWidth,clientWidth:d.scroller.clientWidth,viewWidth:d.wrapper.clientWidth,barLeft:cm.options.fixedGutter?gutterW:0,docHeight:docH,scrollHeight:docH+scrollGap(cm)+d.barHeight,nativeBarWidth:d.nativeBarWidth,gutterWidth:gutterW};}function NativeScrollbars(place,scroll,cm){this.cm=cm;var vert=this.vert=elt("div",[elt("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar");var horiz=this.horiz=elt("div",[elt("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");place(vert);place(horiz);on(vert,"scroll",function(){if(vert.clientHeight){scroll(vert.scrollTop,"vertical");}});on(horiz,"scroll",function(){if(horiz.clientWidth){scroll(horiz.scrollLeft,"horizontal");}});this.checkedZeroWidth=false;// Need to set a minimum width to see the scrollbar on IE7 (but must not set it on IE8).\nif(ie&&ie_version<8){this.horiz.style.minHeight=this.vert.style.minWidth="18px";}}NativeScrollbars.prototype=copyObj({update:function(measure){var needsH=measure.scrollWidth>measure.clientWidth+1;var needsV=measure.scrollHeight>measure.clientHeight+1;var sWidth=measure.nativeBarWidth;if(needsV){this.vert.style.display="block";this.vert.style.bottom=needsH?sWidth+"px":"0";var totalHeight=measure.viewHeight-(needsH?sWidth:0);// A bug in IE8 can cause this value to be negative, so guard it.\nthis.vert.firstChild.style.height=Math.max(0,measure.scrollHeight-measure.clientHeight+totalHeight)+"px";}else{this.vert.style.display="";this.vert.firstChild.style.height="0";}if(needsH){this.horiz.style.display="block";this.horiz.style.right=needsV?sWidth+"px":"0";this.horiz.style.left=measure.barLeft+"px";var totalWidth=measure.viewWidth-measure.barLeft-(needsV?sWidth:0);this.horiz.firstChild.style.width=measure.scrollWidth-measure.clientWidth+totalWidth+"px";}else{this.horiz.style.display="";this.horiz.firstChild.style.width="0";}if(!this.checkedZeroWidth&&measure.clientHeight>0){if(sWidth==0){this.zeroWidthHack();}this.checkedZeroWidth=true;}return{right:needsV?sWidth:0,bottom:needsH?sWidth:0};},setScrollLeft:function(pos){if(this.horiz.scrollLeft!=pos){this.horiz.scrollLeft=pos;}if(this.disableHoriz){this.enableZeroWidthBar(this.horiz,this.disableHoriz);}},setScrollTop:function(pos){if(this.vert.scrollTop!=pos){this.vert.scrollTop=pos;}if(this.disableVert){this.enableZeroWidthBar(this.vert,this.disableVert);}},zeroWidthHack:function(){var w=mac&&!mac_geMountainLion?"12px":"18px";this.horiz.style.height=this.vert.style.width=w;this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none";this.disableHoriz=new Delayed();this.disableVert=new Delayed();},enableZeroWidthBar:function(bar,delay){bar.style.pointerEvents="auto";function maybeDisable(){// To find out whether the scrollbar is still visible, we\n// check whether the element under the pixel in the bottom\n// left corner of the scrollbar box is the scrollbar box\n// itself (when the bar is still visible) or its filler child\n// (when the bar is hidden). If it is still visible, we keep\n// it enabled, if it\'s hidden, we disable pointer events.\nvar box=bar.getBoundingClientRect();var elt=document.elementFromPoint(box.left+1,box.bottom-1);if(elt!=bar){bar.style.pointerEvents="none";}else{delay.set(1000,maybeDisable);}}delay.set(1000,maybeDisable);},clear:function(){var parent=this.horiz.parentNode;parent.removeChild(this.horiz);parent.removeChild(this.vert);}},NativeScrollbars.prototype);function NullScrollbars(){}NullScrollbars.prototype=copyObj({update:function(){return{bottom:0,right:0};},setScrollLeft:function(){},setScrollTop:function(){},clear:function(){}},NullScrollbars.prototype);function updateScrollbars(cm,measure){if(!measure){measure=measureForScrollbars(cm);}var startWidth=cm.display.barWidth,startHeight=cm.display.barHeight;updateScrollbarsInner(cm,measure);for(var i=0;i<4&&startWidth!=cm.display.barWidth||startHeight!=cm.display.barHeight;i++){if(startWidth!=cm.display.barWidth&&cm.options.lineWrapping){updateHeightsInViewport(cm);}updateScrollbarsInner(cm,measureForScrollbars(cm));startWidth=cm.display.barWidth;startHeight=cm.display.barHeight;}}// Re-synchronize the fake scrollbars with the actual size of the\n// content.\nfunction updateScrollbarsInner(cm,measure){var d=cm.display;var sizes=d.scrollbars.update(measure);d.sizer.style.paddingRight=(d.barWidth=sizes.right)+"px";d.sizer.style.paddingBottom=(d.barHeight=sizes.bottom)+"px";d.heightForcer.style.borderBottom=sizes.bottom+"px solid transparent";if(sizes.right&&sizes.bottom){d.scrollbarFiller.style.display="block";d.scrollbarFiller.style.height=sizes.bottom+"px";d.scrollbarFiller.style.width=sizes.right+"px";}else{d.scrollbarFiller.style.display="";}if(sizes.bottom&&cm.options.coverGutterNextToScrollbar&&cm.options.fixedGutter){d.gutterFiller.style.display="block";d.gutterFiller.style.height=sizes.bottom+"px";d.gutterFiller.style.width=measure.gutterWidth+"px";}else{d.gutterFiller.style.display="";}}var scrollbarModel={"native":NativeScrollbars,"null":NullScrollbars};function initScrollbars(cm){if(cm.display.scrollbars){cm.display.scrollbars.clear();if(cm.display.scrollbars.addClass){rmClass(cm.display.wrapper,cm.display.scrollbars.addClass);}}cm.display.scrollbars=new scrollbarModel[cm.options.scrollbarStyle](function(node){cm.display.wrapper.insertBefore(node,cm.display.scrollbarFiller);// Prevent clicks in the scrollbars from killing focus\non(node,"mousedown",function(){if(cm.state.focused){setTimeout(function(){return cm.display.input.focus();},0);}});node.setAttribute("cm-not-content","true");},function(pos,axis){if(axis=="horizontal"){setScrollLeft(cm,pos);}else{setScrollTop(cm,pos);}},cm);if(cm.display.scrollbars.addClass){addClass(cm.display.wrapper,cm.display.scrollbars.addClass);}}// SCROLLING THINGS INTO VIEW\n// If an editor sits on the top or bottom of the window, partially\n// scrolled out of view, this ensures that the cursor is visible.\nfunction maybeScrollWindow(cm,coords){if(signalDOMEvent(cm,"scrollCursorIntoView")){return;}var display=cm.display,box=display.sizer.getBoundingClientRect(),doScroll=null;if(coords.top+box.top<0){doScroll=true;}else if(coords.bottom+box.top>(window.innerHeight||document.documentElement.clientHeight)){doScroll=false;}if(doScroll!=null&&!phantom){var scrollNode=elt("div","\\u200b",null,"position: absolute;\\n                         top: "+(coords.top-display.viewOffset-paddingTop(cm.display))+"px;\\n                         height: "+(coords.bottom-coords.top+scrollGap(cm)+display.barHeight)+"px;\\n                         left: "+coords.left+"px; width: 2px;");cm.display.lineSpace.appendChild(scrollNode);scrollNode.scrollIntoView(doScroll);cm.display.lineSpace.removeChild(scrollNode);}}// Scroll a given position into view (immediately), verifying that\n// it actually became visible (as line heights are accurately\n// measured, the position of something may \'drift\' during drawing).\nfunction scrollPosIntoView(cm,pos,end,margin){if(margin==null){margin=0;}var coords;for(var limit=0;limit<5;limit++){var changed=false;coords=cursorCoords(cm,pos);var endCoords=!end||end==pos?coords:cursorCoords(cm,end);var scrollPos=calculateScrollPos(cm,Math.min(coords.left,endCoords.left),Math.min(coords.top,endCoords.top)-margin,Math.max(coords.left,endCoords.left),Math.max(coords.bottom,endCoords.bottom)+margin);var startTop=cm.doc.scrollTop,startLeft=cm.doc.scrollLeft;if(scrollPos.scrollTop!=null){setScrollTop(cm,scrollPos.scrollTop);if(Math.abs(cm.doc.scrollTop-startTop)>1){changed=true;}}if(scrollPos.scrollLeft!=null){setScrollLeft(cm,scrollPos.scrollLeft);if(Math.abs(cm.doc.scrollLeft-startLeft)>1){changed=true;}}if(!changed){break;}}return coords;}// Scroll a given set of coordinates into view (immediately).\nfunction scrollIntoView(cm,x1,y1,x2,y2){var scrollPos=calculateScrollPos(cm,x1,y1,x2,y2);if(scrollPos.scrollTop!=null){setScrollTop(cm,scrollPos.scrollTop);}if(scrollPos.scrollLeft!=null){setScrollLeft(cm,scrollPos.scrollLeft);}}// Calculate a new scroll position needed to scroll the given\n// rectangle into view. Returns an object with scrollTop and\n// scrollLeft properties. When these are undefined, the\n// vertical/horizontal position does not need to be adjusted.\nfunction calculateScrollPos(cm,x1,y1,x2,y2){var display=cm.display,snapMargin=textHeight(cm.display);if(y1<0){y1=0;}var screentop=cm.curOp&&cm.curOp.scrollTop!=null?cm.curOp.scrollTop:display.scroller.scrollTop;var screen=displayHeight(cm),result={};if(y2-y1>screen){y2=y1+screen;}var docBottom=cm.doc.height+paddingVert(display);var atTop=y1<snapMargin,atBottom=y2>docBottom-snapMargin;if(y1<screentop){result.scrollTop=atTop?0:y1;}else if(y2>screentop+screen){var newTop=Math.min(y1,(atBottom?docBottom:y2)-screen);if(newTop!=screentop){result.scrollTop=newTop;}}var screenleft=cm.curOp&&cm.curOp.scrollLeft!=null?cm.curOp.scrollLeft:display.scroller.scrollLeft;var screenw=displayWidth(cm)-(cm.options.fixedGutter?display.gutters.offsetWidth:0);var tooWide=x2-x1>screenw;if(tooWide){x2=x1+screenw;}if(x1<10){result.scrollLeft=0;}else if(x1<screenleft){result.scrollLeft=Math.max(0,x1-(tooWide?0:10));}else if(x2>screenw+screenleft-3){result.scrollLeft=x2+(tooWide?0:10)-screenw;}return result;}// Store a relative adjustment to the scroll position in the current\n// operation (to be applied when the operation finishes).\nfunction addToScrollPos(cm,left,top){if(left!=null||top!=null){resolveScrollToPos(cm);}if(left!=null){cm.curOp.scrollLeft=(cm.curOp.scrollLeft==null?cm.doc.scrollLeft:cm.curOp.scrollLeft)+left;}if(top!=null){cm.curOp.scrollTop=(cm.curOp.scrollTop==null?cm.doc.scrollTop:cm.curOp.scrollTop)+top;}}// Make sure that at the end of the operation the current cursor is\n// shown.\nfunction ensureCursorVisible(cm){resolveScrollToPos(cm);var cur=cm.getCursor(),from=cur,to=cur;if(!cm.options.lineWrapping){from=cur.ch?Pos(cur.line,cur.ch-1):cur;to=Pos(cur.line,cur.ch+1);}cm.curOp.scrollToPos={from:from,to:to,margin:cm.options.cursorScrollMargin,isCursor:true};}// When an operation has its scrollToPos property set, and another\n// scroll action is applied before the end of the operation, this\n// \'simulates\' scrolling that position into view in a cheap way, so\n// that the effect of intermediate scroll commands is not ignored.\nfunction resolveScrollToPos(cm){var range=cm.curOp.scrollToPos;if(range){cm.curOp.scrollToPos=null;var from=estimateCoords(cm,range.from),to=estimateCoords(cm,range.to);var sPos=calculateScrollPos(cm,Math.min(from.left,to.left),Math.min(from.top,to.top)-range.margin,Math.max(from.right,to.right),Math.max(from.bottom,to.bottom)+range.margin);cm.scrollTo(sPos.scrollLeft,sPos.scrollTop);}}// Operations are used to wrap a series of changes to the editor\n// state in such a way that each change won\'t have to update the\n// cursor and display (which would be awkward, slow, and\n// error-prone). Instead, display updates are batched and then all\n// combined and executed at once.\nvar nextOpId=0;// Start a new operation.\nfunction startOperation(cm){cm.curOp={cm:cm,viewChanged:false,// Flag that indicates that lines might need to be redrawn\nstartHeight:cm.doc.height,// Used to detect need to update scrollbar\nforceUpdate:false,// Used to force a redraw\nupdateInput:null,// Whether to reset the input textarea\ntyping:false,// Whether this reset should be careful to leave existing text (for compositing)\nchangeObjs:null,// Accumulated changes, for firing change events\ncursorActivityHandlers:null,// Set of handlers to fire cursorActivity on\ncursorActivityCalled:0,// Tracks which cursorActivity handlers have been called already\nselectionChanged:false,// Whether the selection needs to be redrawn\nupdateMaxLine:false,// Set when the widest line needs to be determined anew\nscrollLeft:null,scrollTop:null,// Intermediate scroll position, not pushed to DOM yet\nscrollToPos:null,// Used to scroll to a specific position\nfocus:false,id:++nextOpId// Unique ID\n};pushOperation(cm.curOp);}// Finish an operation, updating the display and signalling delayed events\nfunction endOperation(cm){var op=cm.curOp;finishOperation(op,function(group){for(var i=0;i<group.ops.length;i++){group.ops[i].cm.curOp=null;}endOperations(group);});}// The DOM updates done when an operation finishes are batched so\n// that the minimum number of relayouts are required.\nfunction endOperations(group){var ops=group.ops;for(var i=0;i<ops.length;i++)// Read DOM\n{endOperation_R1(ops[i]);}for(var i$1=0;i$1<ops.length;i$1++)// Write DOM (maybe)\n{endOperation_W1(ops[i$1]);}for(var i$2=0;i$2<ops.length;i$2++)// Read DOM\n{endOperation_R2(ops[i$2]);}for(var i$3=0;i$3<ops.length;i$3++)// Write DOM (maybe)\n{endOperation_W2(ops[i$3]);}for(var i$4=0;i$4<ops.length;i$4++)// Read DOM\n{endOperation_finish(ops[i$4]);}}function endOperation_R1(op){var cm=op.cm,display=cm.display;maybeClipScrollbars(cm);if(op.updateMaxLine){findMaxLine(cm);}op.mustUpdate=op.viewChanged||op.forceUpdate||op.scrollTop!=null||op.scrollToPos&&(op.scrollToPos.from.line<display.viewFrom||op.scrollToPos.to.line>=display.viewTo)||display.maxLineChanged&&cm.options.lineWrapping;op.update=op.mustUpdate&&new DisplayUpdate(cm,op.mustUpdate&&{top:op.scrollTop,ensure:op.scrollToPos},op.forceUpdate);}function endOperation_W1(op){op.updatedDisplay=op.mustUpdate&&updateDisplayIfNeeded(op.cm,op.update);}function endOperation_R2(op){var cm=op.cm,display=cm.display;if(op.updatedDisplay){updateHeightsInViewport(cm);}op.barMeasure=measureForScrollbars(cm);// If the max line changed since it was last measured, measure it,\n// and ensure the document\'s width matches it.\n// updateDisplay_W2 will use these properties to do the actual resizing\nif(display.maxLineChanged&&!cm.options.lineWrapping){op.adjustWidthTo=measureChar(cm,display.maxLine,display.maxLine.text.length).left+3;cm.display.sizerWidth=op.adjustWidthTo;op.barMeasure.scrollWidth=Math.max(display.scroller.clientWidth,display.sizer.offsetLeft+op.adjustWidthTo+scrollGap(cm)+cm.display.barWidth);op.maxScrollLeft=Math.max(0,display.sizer.offsetLeft+op.adjustWidthTo-displayWidth(cm));}if(op.updatedDisplay||op.selectionChanged){op.preparedSelection=display.input.prepareSelection(op.focus);}}function endOperation_W2(op){var cm=op.cm;if(op.adjustWidthTo!=null){cm.display.sizer.style.minWidth=op.adjustWidthTo+"px";if(op.maxScrollLeft<cm.doc.scrollLeft){setScrollLeft(cm,Math.min(cm.display.scroller.scrollLeft,op.maxScrollLeft),true);}cm.display.maxLineChanged=false;}var takeFocus=op.focus&&op.focus==activeElt()&&(!document.hasFocus||document.hasFocus());if(op.preparedSelection){cm.display.input.showSelection(op.preparedSelection,takeFocus);}if(op.updatedDisplay||op.startHeight!=cm.doc.height){updateScrollbars(cm,op.barMeasure);}if(op.updatedDisplay){setDocumentHeight(cm,op.barMeasure);}if(op.selectionChanged){restartBlink(cm);}if(cm.state.focused&&op.updateInput){cm.display.input.reset(op.typing);}if(takeFocus){ensureFocus(op.cm);}}function endOperation_finish(op){var cm=op.cm,display=cm.display,doc=cm.doc;if(op.updatedDisplay){postUpdateDisplay(cm,op.update);}// Abort mouse wheel delta measurement, when scrolling explicitly\nif(display.wheelStartX!=null&&(op.scrollTop!=null||op.scrollLeft!=null||op.scrollToPos)){display.wheelStartX=display.wheelStartY=null;}// Propagate the scroll position to the actual DOM scroller\nif(op.scrollTop!=null&&(display.scroller.scrollTop!=op.scrollTop||op.forceScroll)){doc.scrollTop=Math.max(0,Math.min(display.scroller.scrollHeight-display.scroller.clientHeight,op.scrollTop));display.scrollbars.setScrollTop(doc.scrollTop);display.scroller.scrollTop=doc.scrollTop;}if(op.scrollLeft!=null&&(display.scroller.scrollLeft!=op.scrollLeft||op.forceScroll)){doc.scrollLeft=Math.max(0,Math.min(display.scroller.scrollWidth-display.scroller.clientWidth,op.scrollLeft));display.scrollbars.setScrollLeft(doc.scrollLeft);display.scroller.scrollLeft=doc.scrollLeft;alignHorizontally(cm);}// If we need to scroll a specific position into view, do so.\nif(op.scrollToPos){var coords=scrollPosIntoView(cm,clipPos(doc,op.scrollToPos.from),clipPos(doc,op.scrollToPos.to),op.scrollToPos.margin);if(op.scrollToPos.isCursor&&cm.state.focused){maybeScrollWindow(cm,coords);}}// Fire events for markers that are hidden/unidden by editing or\n// undoing\nvar hidden=op.maybeHiddenMarkers,unhidden=op.maybeUnhiddenMarkers;if(hidden){for(var i=0;i<hidden.length;++i){if(!hidden[i].lines.length){signal(hidden[i],"hide");}}}if(unhidden){for(var i$1=0;i$1<unhidden.length;++i$1){if(unhidden[i$1].lines.length){signal(unhidden[i$1],"unhide");}}}if(display.wrapper.offsetHeight){doc.scrollTop=cm.display.scroller.scrollTop;}// Fire change events, and delayed event handlers\nif(op.changeObjs){signal(cm,"changes",cm,op.changeObjs);}if(op.update){op.update.finish();}}// Run the given function in an operation\nfunction runInOp(cm,f){if(cm.curOp){return f();}startOperation(cm);try{return f();}finally{endOperation(cm);}}// Wraps a function in an operation. Returns the wrapped function.\nfunction operation(cm,f){return function(){if(cm.curOp){return f.apply(cm,arguments);}startOperation(cm);try{return f.apply(cm,arguments);}finally{endOperation(cm);}};}// Used to add methods to editor and doc instances, wrapping them in\n// operations.\nfunction methodOp(f){return function(){if(this.curOp){return f.apply(this,arguments);}startOperation(this);try{return f.apply(this,arguments);}finally{endOperation(this);}};}function docMethodOp(f){return function(){var cm=this.cm;if(!cm||cm.curOp){return f.apply(this,arguments);}startOperation(cm);try{return f.apply(this,arguments);}finally{endOperation(cm);}};}// Updates the display.view data structure for a given change to the\n// document. From and to are in pre-change coordinates. Lendiff is\n// the amount of lines added or subtracted by the change. This is\n// used for changes that span multiple lines, or change the way\n// lines are divided into visual lines. regLineChange (below)\n// registers single-line changes.\nfunction regChange(cm,from,to,lendiff){if(from==null){from=cm.doc.first;}if(to==null){to=cm.doc.first+cm.doc.size;}if(!lendiff){lendiff=0;}var display=cm.display;if(lendiff&&to<display.viewTo&&(display.updateLineNumbers==null||display.updateLineNumbers>from)){display.updateLineNumbers=from;}cm.curOp.viewChanged=true;if(from>=display.viewTo){// Change after\nif(sawCollapsedSpans&&visualLineNo(cm.doc,from)<display.viewTo){resetView(cm);}}else if(to<=display.viewFrom){// Change before\nif(sawCollapsedSpans&&visualLineEndNo(cm.doc,to+lendiff)>display.viewFrom){resetView(cm);}else{display.viewFrom+=lendiff;display.viewTo+=lendiff;}}else if(from<=display.viewFrom&&to>=display.viewTo){// Full overlap\nresetView(cm);}else if(from<=display.viewFrom){// Top overlap\nvar cut=viewCuttingPoint(cm,to,to+lendiff,1);if(cut){display.view=display.view.slice(cut.index);display.viewFrom=cut.lineN;display.viewTo+=lendiff;}else{resetView(cm);}}else if(to>=display.viewTo){// Bottom overlap\nvar cut$1=viewCuttingPoint(cm,from,from,-1);if(cut$1){display.view=display.view.slice(0,cut$1.index);display.viewTo=cut$1.lineN;}else{resetView(cm);}}else{// Gap in the middle\nvar cutTop=viewCuttingPoint(cm,from,from,-1);var cutBot=viewCuttingPoint(cm,to,to+lendiff,1);if(cutTop&&cutBot){display.view=display.view.slice(0,cutTop.index).concat(buildViewArray(cm,cutTop.lineN,cutBot.lineN)).concat(display.view.slice(cutBot.index));display.viewTo+=lendiff;}else{resetView(cm);}}var ext=display.externalMeasured;if(ext){if(to<ext.lineN){ext.lineN+=lendiff;}else if(from<ext.lineN+ext.size){display.externalMeasured=null;}}}// Register a change to a single line. Type must be one of "text",\n// "gutter", "class", "widget"\nfunction regLineChange(cm,line,type){cm.curOp.viewChanged=true;var display=cm.display,ext=cm.display.externalMeasured;if(ext&&line>=ext.lineN&&line<ext.lineN+ext.size){display.externalMeasured=null;}if(line<display.viewFrom||line>=display.viewTo){return;}var lineView=display.view[findViewIndex(cm,line)];if(lineView.node==null){return;}var arr=lineView.changes||(lineView.changes=[]);if(indexOf(arr,type)==-1){arr.push(type);}}// Clear the view.\nfunction resetView(cm){cm.display.viewFrom=cm.display.viewTo=cm.doc.first;cm.display.view=[];cm.display.viewOffset=0;}function viewCuttingPoint(cm,oldN,newN,dir){var index=findViewIndex(cm,oldN),diff,view=cm.display.view;if(!sawCollapsedSpans||newN==cm.doc.first+cm.doc.size){return{index:index,lineN:newN};}var n=cm.display.viewFrom;for(var i=0;i<index;i++){n+=view[i].size;}if(n!=oldN){if(dir>0){if(index==view.length-1){return null;}diff=n+view[index].size-oldN;index++;}else{diff=n-oldN;}oldN+=diff;newN+=diff;}while(visualLineNo(cm.doc,newN)!=newN){if(index==(dir<0?0:view.length-1)){return null;}newN+=dir*view[index-(dir<0?1:0)].size;index+=dir;}return{index:index,lineN:newN};}// Force the view to cover a given range, adding empty view element\n// or clipping off existing ones as needed.\nfunction adjustView(cm,from,to){var display=cm.display,view=display.view;if(view.length==0||from>=display.viewTo||to<=display.viewFrom){display.view=buildViewArray(cm,from,to);display.viewFrom=from;}else{if(display.viewFrom>from){display.view=buildViewArray(cm,from,display.viewFrom).concat(display.view);}else if(display.viewFrom<from){display.view=display.view.slice(findViewIndex(cm,from));}display.viewFrom=from;if(display.viewTo<to){display.view=display.view.concat(buildViewArray(cm,display.viewTo,to));}else if(display.viewTo>to){display.view=display.view.slice(0,findViewIndex(cm,to));}}display.viewTo=to;}// Count the number of lines in the view whose DOM representation is\n// out of date (or nonexistent).\nfunction countDirtyView(cm){var view=cm.display.view,dirty=0;for(var i=0;i<view.length;i++){var lineView=view[i];if(!lineView.hidden&&(!lineView.node||lineView.changes)){++dirty;}}return dirty;}// HIGHLIGHT WORKER\nfunction startWorker(cm,time){if(cm.doc.mode.startState&&cm.doc.frontier<cm.display.viewTo){cm.state.highlight.set(time,bind(highlightWorker,cm));}}function highlightWorker(cm){var doc=cm.doc;if(doc.frontier<doc.first){doc.frontier=doc.first;}if(doc.frontier>=cm.display.viewTo){return;}var end=+new Date()+cm.options.workTime;var state=copyState(doc.mode,getStateBefore(cm,doc.frontier));var changedLines=[];doc.iter(doc.frontier,Math.min(doc.first+doc.size,cm.display.viewTo+500),function(line){if(doc.frontier>=cm.display.viewFrom){// Visible\nvar oldStyles=line.styles,tooLong=line.text.length>cm.options.maxHighlightLength;var highlighted=highlightLine(cm,line,tooLong?copyState(doc.mode,state):state,true);line.styles=highlighted.styles;var oldCls=line.styleClasses,newCls=highlighted.classes;if(newCls){line.styleClasses=newCls;}else if(oldCls){line.styleClasses=null;}var ischange=!oldStyles||oldStyles.length!=line.styles.length||oldCls!=newCls&&(!oldCls||!newCls||oldCls.bgClass!=newCls.bgClass||oldCls.textClass!=newCls.textClass);for(var i=0;!ischange&&i<oldStyles.length;++i){ischange=oldStyles[i]!=line.styles[i];}if(ischange){changedLines.push(doc.frontier);}line.stateAfter=tooLong?state:copyState(doc.mode,state);}else{if(line.text.length<=cm.options.maxHighlightLength){processLine(cm,line.text,state);}line.stateAfter=doc.frontier%5==0?copyState(doc.mode,state):null;}++doc.frontier;if(+new Date()>end){startWorker(cm,cm.options.workDelay);return true;}});if(changedLines.length){runInOp(cm,function(){for(var i=0;i<changedLines.length;i++){regLineChange(cm,changedLines[i],"text");}});}}// DISPLAY DRAWING\nfunction DisplayUpdate(cm,viewport,force){var display=cm.display;this.viewport=viewport;// Store some values that we\'ll need later (but don\'t want to force a relayout for)\nthis.visible=visibleLines(display,cm.doc,viewport);this.editorIsHidden=!display.wrapper.offsetWidth;this.wrapperHeight=display.wrapper.clientHeight;this.wrapperWidth=display.wrapper.clientWidth;this.oldDisplayWidth=displayWidth(cm);this.force=force;this.dims=getDimensions(cm);this.events=[];}DisplayUpdate.prototype.signal=function(emitter,type){if(hasHandler(emitter,type)){this.events.push(arguments);}};DisplayUpdate.prototype.finish=function(){var this$1=this;for(var i=0;i<this.events.length;i++){signal.apply(null,this$1.events[i]);}};function maybeClipScrollbars(cm){var display=cm.display;if(!display.scrollbarsClipped&&display.scroller.offsetWidth){display.nativeBarWidth=display.scroller.offsetWidth-display.scroller.clientWidth;display.heightForcer.style.height=scrollGap(cm)+"px";display.sizer.style.marginBottom=-display.nativeBarWidth+"px";display.sizer.style.borderRightWidth=scrollGap(cm)+"px";display.scrollbarsClipped=true;}}// Does the actual updating of the line display. Bails out\n// (returning false) when there is nothing to be done and forced is\n// false.\nfunction updateDisplayIfNeeded(cm,update){var display=cm.display,doc=cm.doc;if(update.editorIsHidden){resetView(cm);return false;}// Bail out if the visible area is already rendered and nothing changed.\nif(!update.force&&update.visible.from>=display.viewFrom&&update.visible.to<=display.viewTo&&(display.updateLineNumbers==null||display.updateLineNumbers>=display.viewTo)&&display.renderedView==display.view&&countDirtyView(cm)==0){return false;}if(maybeUpdateLineNumberWidth(cm)){resetView(cm);update.dims=getDimensions(cm);}// Compute a suitable new viewport (from & to)\nvar end=doc.first+doc.size;var from=Math.max(update.visible.from-cm.options.viewportMargin,doc.first);var to=Math.min(end,update.visible.to+cm.options.viewportMargin);if(display.viewFrom<from&&from-display.viewFrom<20){from=Math.max(doc.first,display.viewFrom);}if(display.viewTo>to&&display.viewTo-to<20){to=Math.min(end,display.viewTo);}if(sawCollapsedSpans){from=visualLineNo(cm.doc,from);to=visualLineEndNo(cm.doc,to);}var different=from!=display.viewFrom||to!=display.viewTo||display.lastWrapHeight!=update.wrapperHeight||display.lastWrapWidth!=update.wrapperWidth;adjustView(cm,from,to);display.viewOffset=heightAtLine(getLine(cm.doc,display.viewFrom));// Position the mover div to align with the current scroll position\ncm.display.mover.style.top=display.viewOffset+"px";var toUpdate=countDirtyView(cm);if(!different&&toUpdate==0&&!update.force&&display.renderedView==display.view&&(display.updateLineNumbers==null||display.updateLineNumbers>=display.viewTo)){return false;}// For big changes, we hide the enclosing element during the\n// update, since that speeds up the operations on most browsers.\nvar focused=activeElt();if(toUpdate>4){display.lineDiv.style.display="none";}patchDisplay(cm,display.updateLineNumbers,update.dims);if(toUpdate>4){display.lineDiv.style.display="";}display.renderedView=display.view;// There might have been a widget with a focused element that got\n// hidden or updated, if so re-focus it.\nif(focused&&activeElt()!=focused&&focused.offsetHeight){focused.focus();}// Prevent selection and cursors from interfering with the scroll\n// width and height.\nremoveChildren(display.cursorDiv);removeChildren(display.selectionDiv);display.gutters.style.height=display.sizer.style.minHeight=0;if(different){display.lastWrapHeight=update.wrapperHeight;display.lastWrapWidth=update.wrapperWidth;startWorker(cm,400);}display.updateLineNumbers=null;return true;}function postUpdateDisplay(cm,update){var viewport=update.viewport;for(var first=true;;first=false){if(!first||!cm.options.lineWrapping||update.oldDisplayWidth==displayWidth(cm)){// Clip forced viewport to actual scrollable area.\nif(viewport&&viewport.top!=null){viewport={top:Math.min(cm.doc.height+paddingVert(cm.display)-displayHeight(cm),viewport.top)};}// Updated line heights might result in the drawn area not\n// actually covering the viewport. Keep looping until it does.\nupdate.visible=visibleLines(cm.display,cm.doc,viewport);if(update.visible.from>=cm.display.viewFrom&&update.visible.to<=cm.display.viewTo){break;}}if(!updateDisplayIfNeeded(cm,update)){break;}updateHeightsInViewport(cm);var barMeasure=measureForScrollbars(cm);updateSelection(cm);updateScrollbars(cm,barMeasure);setDocumentHeight(cm,barMeasure);}update.signal(cm,"update",cm);if(cm.display.viewFrom!=cm.display.reportedViewFrom||cm.display.viewTo!=cm.display.reportedViewTo){update.signal(cm,"viewportChange",cm,cm.display.viewFrom,cm.display.viewTo);cm.display.reportedViewFrom=cm.display.viewFrom;cm.display.reportedViewTo=cm.display.viewTo;}}function updateDisplaySimple(cm,viewport){var update=new DisplayUpdate(cm,viewport);if(updateDisplayIfNeeded(cm,update)){updateHeightsInViewport(cm);postUpdateDisplay(cm,update);var barMeasure=measureForScrollbars(cm);updateSelection(cm);updateScrollbars(cm,barMeasure);setDocumentHeight(cm,barMeasure);update.finish();}}// Sync the actual display DOM structure with display.view, removing\n// nodes for lines that are no longer in view, and creating the ones\n// that are not there yet, and updating the ones that are out of\n// date.\nfunction patchDisplay(cm,updateNumbersFrom,dims){var display=cm.display,lineNumbers=cm.options.lineNumbers;var container=display.lineDiv,cur=container.firstChild;function rm(node){var next=node.nextSibling;// Works around a throw-scroll bug in OS X Webkit\nif(webkit&&mac&&cm.display.currentWheelTarget==node){node.style.display="none";}else{node.parentNode.removeChild(node);}return next;}var view=display.view,lineN=display.viewFrom;// Loop over the elements in the view, syncing cur (the DOM nodes\n// in display.lineDiv) with the view as we go.\nfor(var i=0;i<view.length;i++){var lineView=view[i];if(lineView.hidden){}else if(!lineView.node||lineView.node.parentNode!=container){// Not drawn yet\nvar node=buildLineElement(cm,lineView,lineN,dims);container.insertBefore(node,cur);}else{// Already drawn\nwhile(cur!=lineView.node){cur=rm(cur);}var updateNumber=lineNumbers&&updateNumbersFrom!=null&&updateNumbersFrom<=lineN&&lineView.lineNumber;if(lineView.changes){if(indexOf(lineView.changes,"gutter")>-1){updateNumber=false;}updateLineForChanges(cm,lineView,lineN,dims);}if(updateNumber){removeChildren(lineView.lineNumber);lineView.lineNumber.appendChild(document.createTextNode(lineNumberFor(cm.options,lineN)));}cur=lineView.node.nextSibling;}lineN+=lineView.size;}while(cur){cur=rm(cur);}}function updateGutterSpace(cm){var width=cm.display.gutters.offsetWidth;cm.display.sizer.style.marginLeft=width+"px";}function setDocumentHeight(cm,measure){cm.display.sizer.style.minHeight=measure.docHeight+"px";cm.display.heightForcer.style.top=measure.docHeight+"px";cm.display.gutters.style.height=measure.docHeight+cm.display.barHeight+scrollGap(cm)+"px";}// Rebuild the gutter elements, ensure the margin to the left of the\n// code matches their width.\nfunction updateGutters(cm){var gutters=cm.display.gutters,specs=cm.options.gutters;removeChildren(gutters);var i=0;for(;i<specs.length;++i){var gutterClass=specs[i];var gElt=gutters.appendChild(elt("div",null,"CodeMirror-gutter "+gutterClass));if(gutterClass=="CodeMirror-linenumbers"){cm.display.lineGutter=gElt;gElt.style.width=(cm.display.lineNumWidth||1)+"px";}}gutters.style.display=i?"":"none";updateGutterSpace(cm);}// Make sure the gutters options contains the element\n// "CodeMirror-linenumbers" when the lineNumbers option is true.\nfunction setGuttersForLineNumbers(options){var found=indexOf(options.gutters,"CodeMirror-linenumbers");if(found==-1&&options.lineNumbers){options.gutters=options.gutters.concat(["CodeMirror-linenumbers"]);}else if(found>-1&&!options.lineNumbers){options.gutters=options.gutters.slice(0);options.gutters.splice(found,1);}}// Selection objects are immutable. A new one is created every time\n// the selection changes. A selection is one or more non-overlapping\n// (and non-touching) ranges, sorted, and an integer that indicates\n// which one is the primary selection (the one that\'s scrolled into\n// view, that getCursor returns, etc).\nfunction Selection(ranges,primIndex){this.ranges=ranges;this.primIndex=primIndex;}Selection.prototype={primary:function(){return this.ranges[this.primIndex];},equals:function(other){var this$1=this;if(other==this){return true;}if(other.primIndex!=this.primIndex||other.ranges.length!=this.ranges.length){return false;}for(var i=0;i<this.ranges.length;i++){var here=this$1.ranges[i],there=other.ranges[i];if(cmp(here.anchor,there.anchor)!=0||cmp(here.head,there.head)!=0){return false;}}return true;},deepCopy:function(){var this$1=this;var out=[];for(var i=0;i<this.ranges.length;i++){out[i]=new Range(copyPos(this$1.ranges[i].anchor),copyPos(this$1.ranges[i].head));}return new Selection(out,this.primIndex);},somethingSelected:function(){var this$1=this;for(var i=0;i<this.ranges.length;i++){if(!this$1.ranges[i].empty()){return true;}}return false;},contains:function(pos,end){var this$1=this;if(!end){end=pos;}for(var i=0;i<this.ranges.length;i++){var range=this$1.ranges[i];if(cmp(end,range.from())>=0&&cmp(pos,range.to())<=0){return i;}}return-1;}};function Range(anchor,head){this.anchor=anchor;this.head=head;}Range.prototype={from:function(){return minPos(this.anchor,this.head);},to:function(){return maxPos(this.anchor,this.head);},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch;}};// Take an unsorted, potentially overlapping set of ranges, and\n// build a selection out of it. \'Consumes\' ranges array (modifying\n// it).\nfunction normalizeSelection(ranges,primIndex){var prim=ranges[primIndex];ranges.sort(function(a,b){return cmp(a.from(),b.from());});primIndex=indexOf(ranges,prim);for(var i=1;i<ranges.length;i++){var cur=ranges[i],prev=ranges[i-1];if(cmp(prev.to(),cur.from())>=0){var from=minPos(prev.from(),cur.from()),to=maxPos(prev.to(),cur.to());var inv=prev.empty()?cur.from()==cur.head:prev.from()==prev.head;if(i<=primIndex){--primIndex;}ranges.splice(--i,2,new Range(inv?to:from,inv?from:to));}}return new Selection(ranges,primIndex);}function simpleSelection(anchor,head){return new Selection([new Range(anchor,head||anchor)],0);}// Compute the position of the end of a change (its \'to\' property\n// refers to the pre-change end).\nfunction changeEnd(change){if(!change.text){return change.to;}return Pos(change.from.line+change.text.length-1,lst(change.text).length+(change.text.length==1?change.from.ch:0));}// Adjust a position to refer to the post-change position of the\n// same text, or the end of the change if the change covers it.\nfunction adjustForChange(pos,change){if(cmp(pos,change.from)<0){return pos;}if(cmp(pos,change.to)<=0){return changeEnd(change);}var line=pos.line+change.text.length-(change.to.line-change.from.line)-1,ch=pos.ch;if(pos.line==change.to.line){ch+=changeEnd(change).ch-change.to.ch;}return Pos(line,ch);}function computeSelAfterChange(doc,change){var out=[];for(var i=0;i<doc.sel.ranges.length;i++){var range=doc.sel.ranges[i];out.push(new Range(adjustForChange(range.anchor,change),adjustForChange(range.head,change)));}return normalizeSelection(out,doc.sel.primIndex);}function offsetPos(pos,old,nw){if(pos.line==old.line){return Pos(nw.line,pos.ch-old.ch+nw.ch);}else{return Pos(nw.line+(pos.line-old.line),pos.ch);}}// Used by replaceSelections to allow moving the selection to the\n// start or around the replaced test. Hint may be "start" or "around".\nfunction computeReplacedSel(doc,changes,hint){var out=[];var oldPrev=Pos(doc.first,0),newPrev=oldPrev;for(var i=0;i<changes.length;i++){var change=changes[i];var from=offsetPos(change.from,oldPrev,newPrev);var to=offsetPos(changeEnd(change),oldPrev,newPrev);oldPrev=change.to;newPrev=to;if(hint=="around"){var range=doc.sel.ranges[i],inv=cmp(range.head,range.anchor)<0;out[i]=new Range(inv?to:from,inv?from:to);}else{out[i]=new Range(from,from);}}return new Selection(out,doc.sel.primIndex);}// Used to get the editor into a consistent state again when options change.\nfunction loadMode(cm){cm.doc.mode=getMode(cm.options,cm.doc.modeOption);resetModeState(cm);}function resetModeState(cm){cm.doc.iter(function(line){if(line.stateAfter){line.stateAfter=null;}if(line.styles){line.styles=null;}});cm.doc.frontier=cm.doc.first;startWorker(cm,100);cm.state.modeGen++;if(cm.curOp){regChange(cm);}}// DOCUMENT DATA STRUCTURE\n// By default, updates that start and end at the beginning of a line\n// are treated specially, in order to make the association of line\n// widgets and marker elements with the text behave more intuitive.\nfunction isWholeLineUpdate(doc,change){return change.from.ch==0&&change.to.ch==0&&lst(change.text)==""&&(!doc.cm||doc.cm.options.wholeLineUpdateBefore);}// Perform a change on the document data structure.\nfunction updateDoc(doc,change,markedSpans,estimateHeight){function spansFor(n){return markedSpans?markedSpans[n]:null;}function update(line,text,spans){updateLine(line,text,spans,estimateHeight);signalLater(line,"change",line,change);}function linesFor(start,end){var result=[];for(var i=start;i<end;++i){result.push(new Line(text[i],spansFor(i),estimateHeight));}return result;}var from=change.from,to=change.to,text=change.text;var firstLine=getLine(doc,from.line),lastLine=getLine(doc,to.line);var lastText=lst(text),lastSpans=spansFor(text.length-1),nlines=to.line-from.line;// Adjust the line structure\nif(change.full){doc.insert(0,linesFor(0,text.length));doc.remove(text.length,doc.size-text.length);}else if(isWholeLineUpdate(doc,change)){// This is a whole-line replace. Treated specially to make\n// sure line objects move the way they are supposed to.\nvar added=linesFor(0,text.length-1);update(lastLine,lastLine.text,lastSpans);if(nlines){doc.remove(from.line,nlines);}if(added.length){doc.insert(from.line,added);}}else if(firstLine==lastLine){if(text.length==1){update(firstLine,firstLine.text.slice(0,from.ch)+lastText+firstLine.text.slice(to.ch),lastSpans);}else{var added$1=linesFor(1,text.length-1);added$1.push(new Line(lastText+firstLine.text.slice(to.ch),lastSpans,estimateHeight));update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0));doc.insert(from.line+1,added$1);}}else if(text.length==1){update(firstLine,firstLine.text.slice(0,from.ch)+text[0]+lastLine.text.slice(to.ch),spansFor(0));doc.remove(from.line+1,nlines);}else{update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0));update(lastLine,lastText+lastLine.text.slice(to.ch),lastSpans);var added$2=linesFor(1,text.length-1);if(nlines>1){doc.remove(from.line+1,nlines-1);}doc.insert(from.line+1,added$2);}signalLater(doc,"change",doc,change);}// Call f for all linked documents.\nfunction linkedDocs(doc,f,sharedHistOnly){function propagate(doc,skip,sharedHist){if(doc.linked){for(var i=0;i<doc.linked.length;++i){var rel=doc.linked[i];if(rel.doc==skip){continue;}var shared=sharedHist&&rel.sharedHist;if(sharedHistOnly&&!shared){continue;}f(rel.doc,shared);propagate(rel.doc,doc,shared);}}}propagate(doc,null,true);}// Attach a document to an editor.\nfunction attachDoc(cm,doc){if(doc.cm){throw new Error("This document is already in use.");}cm.doc=doc;doc.cm=cm;estimateLineHeights(cm);loadMode(cm);if(!cm.options.lineWrapping){findMaxLine(cm);}cm.options.mode=doc.modeOption;regChange(cm);}function History(startGen){// Arrays of change events and selections. Doing something adds an\n// event to done and clears undo. Undoing moves events from done\n// to undone, redoing moves them in the other direction.\nthis.done=[];this.undone=[];this.undoDepth=Infinity;// Used to track when changes can be merged into a single undo\n// event\nthis.lastModTime=this.lastSelTime=0;this.lastOp=this.lastSelOp=null;this.lastOrigin=this.lastSelOrigin=null;// Used by the isClean() method\nthis.generation=this.maxGeneration=startGen||1;}// Create a history change event from an updateDoc-style change\n// object.\nfunction historyChangeFromChange(doc,change){var histChange={from:copyPos(change.from),to:changeEnd(change),text:getBetween(doc,change.from,change.to)};attachLocalSpans(doc,histChange,change.from.line,change.to.line+1);linkedDocs(doc,function(doc){return attachLocalSpans(doc,histChange,change.from.line,change.to.line+1);},true);return histChange;}// Pop all selection events off the end of a history array. Stop at\n// a change event.\nfunction clearSelectionEvents(array){while(array.length){var last=lst(array);if(last.ranges){array.pop();}else{break;}}}// Find the top change event in the history. Pop off selection\n// events that are in the way.\nfunction lastChangeEvent(hist,force){if(force){clearSelectionEvents(hist.done);return lst(hist.done);}else if(hist.done.length&&!lst(hist.done).ranges){return lst(hist.done);}else if(hist.done.length>1&&!hist.done[hist.done.length-2].ranges){hist.done.pop();return lst(hist.done);}}// Register a change in the history. Merges changes that are within\n// a single operation, or are close together with an origin that\n// allows merging (starting with "+") into a single event.\nfunction addChangeToHistory(doc,change,selAfter,opId){var hist=doc.history;hist.undone.length=0;var time=+new Date(),cur;var last;if((hist.lastOp==opId||hist.lastOrigin==change.origin&&change.origin&&(change.origin.charAt(0)=="+"&&doc.cm&&hist.lastModTime>time-doc.cm.options.historyEventDelay||change.origin.charAt(0)=="*"))&&(cur=lastChangeEvent(hist,hist.lastOp==opId))){// Merge this change into the last event\nlast=lst(cur.changes);if(cmp(change.from,change.to)==0&&cmp(change.from,last.to)==0){// Optimized case for simple insertion -- don\'t want to add\n// new changesets for every character typed\nlast.to=changeEnd(change);}else{// Add new sub-event\ncur.changes.push(historyChangeFromChange(doc,change));}}else{// Can not be merged, start a new event.\nvar before=lst(hist.done);if(!before||!before.ranges){pushSelectionToHistory(doc.sel,hist.done);}cur={changes:[historyChangeFromChange(doc,change)],generation:hist.generation};hist.done.push(cur);while(hist.done.length>hist.undoDepth){hist.done.shift();if(!hist.done[0].ranges){hist.done.shift();}}}hist.done.push(selAfter);hist.generation=++hist.maxGeneration;hist.lastModTime=hist.lastSelTime=time;hist.lastOp=hist.lastSelOp=opId;hist.lastOrigin=hist.lastSelOrigin=change.origin;if(!last){signal(doc,"historyAdded");}}function selectionEventCanBeMerged(doc,origin,prev,sel){var ch=origin.charAt(0);return ch=="*"||ch=="+"&&prev.ranges.length==sel.ranges.length&&prev.somethingSelected()==sel.somethingSelected()&&new Date()-doc.history.lastSelTime<=(doc.cm?doc.cm.options.historyEventDelay:500);}// Called whenever the selection changes, sets the new selection as\n// the pending selection in the history, and pushes the old pending\n// selection into the \'done\' array when it was significantly\n// different (in number of selected ranges, emptiness, or time).\nfunction addSelectionToHistory(doc,sel,opId,options){var hist=doc.history,origin=options&&options.origin;// A new event is started when the previous origin does not match\n// the current, or the origins don\'t allow matching. Origins\n// starting with * are always merged, those starting with + are\n// merged when similar and close together in time.\nif(opId==hist.lastSelOp||origin&&hist.lastSelOrigin==origin&&(hist.lastModTime==hist.lastSelTime&&hist.lastOrigin==origin||selectionEventCanBeMerged(doc,origin,lst(hist.done),sel))){hist.done[hist.done.length-1]=sel;}else{pushSelectionToHistory(sel,hist.done);}hist.lastSelTime=+new Date();hist.lastSelOrigin=origin;hist.lastSelOp=opId;if(options&&options.clearRedo!==false){clearSelectionEvents(hist.undone);}}function pushSelectionToHistory(sel,dest){var top=lst(dest);if(!(top&&top.ranges&&top.equals(sel))){dest.push(sel);}}// Used to store marked span information in the history.\nfunction attachLocalSpans(doc,change,from,to){var existing=change["spans_"+doc.id],n=0;doc.iter(Math.max(doc.first,from),Math.min(doc.first+doc.size,to),function(line){if(line.markedSpans){(existing||(existing=change["spans_"+doc.id]={}))[n]=line.markedSpans;}++n;});}// When un/re-doing restores text containing marked spans, those\n// that have been explicitly cleared should not be restored.\nfunction removeClearedSpans(spans){if(!spans){return null;}var out;for(var i=0;i<spans.length;++i){if(spans[i].marker.explicitlyCleared){if(!out){out=spans.slice(0,i);}}else if(out){out.push(spans[i]);}}return!out?spans:out.length?out:null;}// Retrieve and filter the old marked spans stored in a change event.\nfunction getOldSpans(doc,change){var found=change["spans_"+doc.id];if(!found){return null;}var nw=[];for(var i=0;i<change.text.length;++i){nw.push(removeClearedSpans(found[i]));}return nw;}// Used for un/re-doing changes from the history. Combines the\n// result of computing the existing spans with the set of spans that\n// existed in the history (so that deleting around a span and then\n// undoing brings back the span).\nfunction mergeOldSpans(doc,change){var old=getOldSpans(doc,change);var stretched=stretchSpansOverChange(doc,change);if(!old){return stretched;}if(!stretched){return old;}for(var i=0;i<old.length;++i){var oldCur=old[i],stretchCur=stretched[i];if(oldCur&&stretchCur){spans:for(var j=0;j<stretchCur.length;++j){var span=stretchCur[j];for(var k=0;k<oldCur.length;++k){if(oldCur[k].marker==span.marker){continue spans;}}oldCur.push(span);}}else if(stretchCur){old[i]=stretchCur;}}return old;}// Used both to provide a JSON-safe object in .getHistory, and, when\n// detaching a document, to split the history in two\nfunction copyHistoryArray(events,newGroup,instantiateSel){var copy=[];for(var i=0;i<events.length;++i){var event=events[i];if(event.ranges){copy.push(instantiateSel?Selection.prototype.deepCopy.call(event):event);continue;}var changes=event.changes,newChanges=[];copy.push({changes:newChanges});for(var j=0;j<changes.length;++j){var change=changes[j],m=void 0;newChanges.push({from:change.from,to:change.to,text:change.text});if(newGroup){for(var prop in change){if(m=prop.match(/^spans_(\\d+)$/)){if(indexOf(newGroup,Number(m[1]))>-1){lst(newChanges)[prop]=change[prop];delete change[prop];}}}}}}return copy;}// The \'scroll\' parameter given to many of these indicated whether\n// the new cursor position should be scrolled into view after\n// modifying the selection.\n// If shift is held or the extend flag is set, extends a range to\n// include a given position (and optionally a second position).\n// Otherwise, simply returns the range between the given positions.\n// Used for cursor motion and such.\nfunction extendRange(doc,range,head,other){if(doc.cm&&doc.cm.display.shift||doc.extend){var anchor=range.anchor;if(other){var posBefore=cmp(head,anchor)<0;if(posBefore!=cmp(other,anchor)<0){anchor=head;head=other;}else if(posBefore!=cmp(head,other)<0){head=other;}}return new Range(anchor,head);}else{return new Range(other||head,head);}}// Extend the primary selection range, discard the rest.\nfunction extendSelection(doc,head,other,options){setSelection(doc,new Selection([extendRange(doc,doc.sel.primary(),head,other)],0),options);}// Extend all selections (pos is an array of selections with length\n// equal the number of selections)\nfunction extendSelections(doc,heads,options){var out=[];for(var i=0;i<doc.sel.ranges.length;i++){out[i]=extendRange(doc,doc.sel.ranges[i],heads[i],null);}var newSel=normalizeSelection(out,doc.sel.primIndex);setSelection(doc,newSel,options);}// Updates a single range in the selection.\nfunction replaceOneSelection(doc,i,range,options){var ranges=doc.sel.ranges.slice(0);ranges[i]=range;setSelection(doc,normalizeSelection(ranges,doc.sel.primIndex),options);}// Reset the selection to a single range.\nfunction setSimpleSelection(doc,anchor,head,options){setSelection(doc,simpleSelection(anchor,head),options);}// Give beforeSelectionChange handlers a change to influence a\n// selection update.\nfunction filterSelectionChange(doc,sel,options){var obj={ranges:sel.ranges,update:function(ranges){var this$1=this;this.ranges=[];for(var i=0;i<ranges.length;i++){this$1.ranges[i]=new Range(clipPos(doc,ranges[i].anchor),clipPos(doc,ranges[i].head));}},origin:options&&options.origin};signal(doc,"beforeSelectionChange",doc,obj);if(doc.cm){signal(doc.cm,"beforeSelectionChange",doc.cm,obj);}if(obj.ranges!=sel.ranges){return normalizeSelection(obj.ranges,obj.ranges.length-1);}else{return sel;}}function setSelectionReplaceHistory(doc,sel,options){var done=doc.history.done,last=lst(done);if(last&&last.ranges){done[done.length-1]=sel;setSelectionNoUndo(doc,sel,options);}else{setSelection(doc,sel,options);}}// Set a new selection.\nfunction setSelection(doc,sel,options){setSelectionNoUndo(doc,sel,options);addSelectionToHistory(doc,doc.sel,doc.cm?doc.cm.curOp.id:NaN,options);}function setSelectionNoUndo(doc,sel,options){if(hasHandler(doc,"beforeSelectionChange")||doc.cm&&hasHandler(doc.cm,"beforeSelectionChange")){sel=filterSelectionChange(doc,sel,options);}var bias=options&&options.bias||(cmp(sel.primary().head,doc.sel.primary().head)<0?-1:1);setSelectionInner(doc,skipAtomicInSelection(doc,sel,bias,true));if(!(options&&options.scroll===false)&&doc.cm){ensureCursorVisible(doc.cm);}}function setSelectionInner(doc,sel){if(sel.equals(doc.sel)){return;}doc.sel=sel;if(doc.cm){doc.cm.curOp.updateInput=doc.cm.curOp.selectionChanged=true;signalCursorActivity(doc.cm);}signalLater(doc,"cursorActivity",doc);}// Verify that the selection does not partially select any atomic\n// marked ranges.\nfunction reCheckSelection(doc){setSelectionInner(doc,skipAtomicInSelection(doc,doc.sel,null,false),sel_dontScroll);}// Return a selection that does not partially select any atomic\n// ranges.\nfunction skipAtomicInSelection(doc,sel,bias,mayClear){var out;for(var i=0;i<sel.ranges.length;i++){var range=sel.ranges[i];var old=sel.ranges.length==doc.sel.ranges.length&&doc.sel.ranges[i];var newAnchor=skipAtomic(doc,range.anchor,old&&old.anchor,bias,mayClear);var newHead=skipAtomic(doc,range.head,old&&old.head,bias,mayClear);if(out||newAnchor!=range.anchor||newHead!=range.head){if(!out){out=sel.ranges.slice(0,i);}out[i]=new Range(newAnchor,newHead);}}return out?normalizeSelection(out,sel.primIndex):sel;}function skipAtomicInner(doc,pos,oldPos,dir,mayClear){var line=getLine(doc,pos.line);if(line.markedSpans){for(var i=0;i<line.markedSpans.length;++i){var sp=line.markedSpans[i],m=sp.marker;if((sp.from==null||(m.inclusiveLeft?sp.from<=pos.ch:sp.from<pos.ch))&&(sp.to==null||(m.inclusiveRight?sp.to>=pos.ch:sp.to>pos.ch))){if(mayClear){signal(m,"beforeCursorEnter");if(m.explicitlyCleared){if(!line.markedSpans){break;}else{--i;continue;}}}if(!m.atomic){continue;}if(oldPos){var near=m.find(dir<0?1:-1),diff=void 0;if(dir<0?m.inclusiveRight:m.inclusiveLeft){near=movePos(doc,near,-dir,near&&near.line==pos.line?line:null);}if(near&&near.line==pos.line&&(diff=cmp(near,oldPos))&&(dir<0?diff<0:diff>0)){return skipAtomicInner(doc,near,pos,dir,mayClear);}}var far=m.find(dir<0?-1:1);if(dir<0?m.inclusiveLeft:m.inclusiveRight){far=movePos(doc,far,dir,far.line==pos.line?line:null);}return far?skipAtomicInner(doc,far,pos,dir,mayClear):null;}}}return pos;}// Ensure a given position is not inside an atomic range.\nfunction skipAtomic(doc,pos,oldPos,bias,mayClear){var dir=bias||1;var found=skipAtomicInner(doc,pos,oldPos,dir,mayClear)||!mayClear&&skipAtomicInner(doc,pos,oldPos,dir,true)||skipAtomicInner(doc,pos,oldPos,-dir,mayClear)||!mayClear&&skipAtomicInner(doc,pos,oldPos,-dir,true);if(!found){doc.cantEdit=true;return Pos(doc.first,0);}return found;}function movePos(doc,pos,dir,line){if(dir<0&&pos.ch==0){if(pos.line>doc.first){return clipPos(doc,Pos(pos.line-1));}else{return null;}}else if(dir>0&&pos.ch==(line||getLine(doc,pos.line)).text.length){if(pos.line<doc.first+doc.size-1){return Pos(pos.line+1,0);}else{return null;}}else{return new Pos(pos.line,pos.ch+dir);}}function selectAll(cm){cm.setSelection(Pos(cm.firstLine(),0),Pos(cm.lastLine()),sel_dontScroll);}// UPDATING\n// Allow "beforeChange" event handlers to influence a change\nfunction filterChange(doc,change,update){var obj={canceled:false,from:change.from,to:change.to,text:change.text,origin:change.origin,cancel:function(){return obj.canceled=true;}};if(update){obj.update=function(from,to,text,origin){if(from){obj.from=clipPos(doc,from);}if(to){obj.to=clipPos(doc,to);}if(text){obj.text=text;}if(origin!==undefined){obj.origin=origin;}};}signal(doc,"beforeChange",doc,obj);if(doc.cm){signal(doc.cm,"beforeChange",doc.cm,obj);}if(obj.canceled){return null;}return{from:obj.from,to:obj.to,text:obj.text,origin:obj.origin};}// Apply a change to a document, and add it to the document\'s\n// history, and propagating it to all linked documents.\nfunction makeChange(doc,change,ignoreReadOnly){if(doc.cm){if(!doc.cm.curOp){return operation(doc.cm,makeChange)(doc,change,ignoreReadOnly);}if(doc.cm.state.suppressEdits){return;}}if(hasHandler(doc,"beforeChange")||doc.cm&&hasHandler(doc.cm,"beforeChange")){change=filterChange(doc,change,true);if(!change){return;}}// Possibly split or suppress the update based on the presence\n// of read-only spans in its range.\nvar split=sawReadOnlySpans&&!ignoreReadOnly&&removeReadOnlyRanges(doc,change.from,change.to);if(split){for(var i=split.length-1;i>=0;--i){makeChangeInner(doc,{from:split[i].from,to:split[i].to,text:i?[""]:change.text});}}else{makeChangeInner(doc,change);}}function makeChangeInner(doc,change){if(change.text.length==1&&change.text[0]==""&&cmp(change.from,change.to)==0){return;}var selAfter=computeSelAfterChange(doc,change);addChangeToHistory(doc,change,selAfter,doc.cm?doc.cm.curOp.id:NaN);makeChangeSingleDoc(doc,change,selAfter,stretchSpansOverChange(doc,change));var rebased=[];linkedDocs(doc,function(doc,sharedHist){if(!sharedHist&&indexOf(rebased,doc.history)==-1){rebaseHist(doc.history,change);rebased.push(doc.history);}makeChangeSingleDoc(doc,change,null,stretchSpansOverChange(doc,change));});}// Revert a change stored in a document\'s history.\nfunction makeChangeFromHistory(doc,type,allowSelectionOnly){if(doc.cm&&doc.cm.state.suppressEdits&&!allowSelectionOnly){return;}var hist=doc.history,event,selAfter=doc.sel;var source=type=="undo"?hist.done:hist.undone,dest=type=="undo"?hist.undone:hist.done;// Verify that there is a useable event (so that ctrl-z won\'t\n// needlessly clear selection events)\nvar i=0;for(;i<source.length;i++){event=source[i];if(allowSelectionOnly?event.ranges&&!event.equals(doc.sel):!event.ranges){break;}}if(i==source.length){return;}hist.lastOrigin=hist.lastSelOrigin=null;for(;;){event=source.pop();if(event.ranges){pushSelectionToHistory(event,dest);if(allowSelectionOnly&&!event.equals(doc.sel)){setSelection(doc,event,{clearRedo:false});return;}selAfter=event;}else{break;}}// Build up a reverse change object to add to the opposite history\n// stack (redo when undoing, and vice versa).\nvar antiChanges=[];pushSelectionToHistory(selAfter,dest);dest.push({changes:antiChanges,generation:hist.generation});hist.generation=event.generation||++hist.maxGeneration;var filter=hasHandler(doc,"beforeChange")||doc.cm&&hasHandler(doc.cm,"beforeChange");var loop=function(i){var change=event.changes[i];change.origin=type;if(filter&&!filterChange(doc,change,false)){source.length=0;return{};}antiChanges.push(historyChangeFromChange(doc,change));var after=i?computeSelAfterChange(doc,change):lst(source);makeChangeSingleDoc(doc,change,after,mergeOldSpans(doc,change));if(!i&&doc.cm){doc.cm.scrollIntoView({from:change.from,to:changeEnd(change)});}var rebased=[];// Propagate to the linked documents\nlinkedDocs(doc,function(doc,sharedHist){if(!sharedHist&&indexOf(rebased,doc.history)==-1){rebaseHist(doc.history,change);rebased.push(doc.history);}makeChangeSingleDoc(doc,change,null,mergeOldSpans(doc,change));});};for(var i$1=event.changes.length-1;i$1>=0;--i$1){var returned=loop(i$1);if(returned)return returned.v;}}// Sub-views need their line numbers shifted when text is added\n// above or below them in the parent document.\nfunction shiftDoc(doc,distance){if(distance==0){return;}doc.first+=distance;doc.sel=new Selection(map(doc.sel.ranges,function(range){return new Range(Pos(range.anchor.line+distance,range.anchor.ch),Pos(range.head.line+distance,range.head.ch));}),doc.sel.primIndex);if(doc.cm){regChange(doc.cm,doc.first,doc.first-distance,distance);for(var d=doc.cm.display,l=d.viewFrom;l<d.viewTo;l++){regLineChange(doc.cm,l,"gutter");}}}// More lower-level change function, handling only a single document\n// (not linked ones).\nfunction makeChangeSingleDoc(doc,change,selAfter,spans){if(doc.cm&&!doc.cm.curOp){return operation(doc.cm,makeChangeSingleDoc)(doc,change,selAfter,spans);}if(change.to.line<doc.first){shiftDoc(doc,change.text.length-1-(change.to.line-change.from.line));return;}if(change.from.line>doc.lastLine()){return;}// Clip the change to the size of this doc\nif(change.from.line<doc.first){var shift=change.text.length-1-(doc.first-change.from.line);shiftDoc(doc,shift);change={from:Pos(doc.first,0),to:Pos(change.to.line+shift,change.to.ch),text:[lst(change.text)],origin:change.origin};}var last=doc.lastLine();if(change.to.line>last){change={from:change.from,to:Pos(last,getLine(doc,last).text.length),text:[change.text[0]],origin:change.origin};}change.removed=getBetween(doc,change.from,change.to);if(!selAfter){selAfter=computeSelAfterChange(doc,change);}if(doc.cm){makeChangeSingleDocInEditor(doc.cm,change,spans);}else{updateDoc(doc,change,spans);}setSelectionNoUndo(doc,selAfter,sel_dontScroll);}// Handle the interaction of a change to a document with the editor\n// that this document is part of.\nfunction makeChangeSingleDocInEditor(cm,change,spans){var doc=cm.doc,display=cm.display,from=change.from,to=change.to;var recomputeMaxLength=false,checkWidthStart=from.line;if(!cm.options.lineWrapping){checkWidthStart=lineNo(visualLine(getLine(doc,from.line)));doc.iter(checkWidthStart,to.line+1,function(line){if(line==display.maxLine){recomputeMaxLength=true;return true;}});}if(doc.sel.contains(change.from,change.to)>-1){signalCursorActivity(cm);}updateDoc(doc,change,spans,estimateHeight(cm));if(!cm.options.lineWrapping){doc.iter(checkWidthStart,from.line+change.text.length,function(line){var len=lineLength(line);if(len>display.maxLineLength){display.maxLine=line;display.maxLineLength=len;display.maxLineChanged=true;recomputeMaxLength=false;}});if(recomputeMaxLength){cm.curOp.updateMaxLine=true;}}// Adjust frontier, schedule worker\ndoc.frontier=Math.min(doc.frontier,from.line);startWorker(cm,400);var lendiff=change.text.length-(to.line-from.line)-1;// Remember that these lines changed, for updating the display\nif(change.full){regChange(cm);}else if(from.line==to.line&&change.text.length==1&&!isWholeLineUpdate(cm.doc,change)){regLineChange(cm,from.line,"text");}else{regChange(cm,from.line,to.line+1,lendiff);}var changesHandler=hasHandler(cm,"changes"),changeHandler=hasHandler(cm,"change");if(changeHandler||changesHandler){var obj={from:from,to:to,text:change.text,removed:change.removed,origin:change.origin};if(changeHandler){signalLater(cm,"change",cm,obj);}if(changesHandler){(cm.curOp.changeObjs||(cm.curOp.changeObjs=[])).push(obj);}}cm.display.selForContextMenu=null;}function replaceRange(doc,code,from,to,origin){if(!to){to=from;}if(cmp(to,from)<0){var tmp=to;to=from;from=tmp;}if(typeof code=="string"){code=doc.splitLines(code);}makeChange(doc,{from:from,to:to,text:code,origin:origin});}// Rebasing/resetting history to deal with externally-sourced changes\nfunction rebaseHistSelSingle(pos,from,to,diff){if(to<pos.line){pos.line+=diff;}else if(from<pos.line){pos.line=from;pos.ch=0;}}// Tries to rebase an array of history events given a change in the\n// document. If the change touches the same lines as the event, the\n// event, and everything \'behind\' it, is discarded. If the change is\n// before the event, the event\'s positions are updated. Uses a\n// copy-on-write scheme for the positions, to avoid having to\n// reallocate them all on every rebase, but also avoid problems with\n// shared position objects being unsafely updated.\nfunction rebaseHistArray(array,from,to,diff){for(var i=0;i<array.length;++i){var sub=array[i],ok=true;if(sub.ranges){if(!sub.copied){sub=array[i]=sub.deepCopy();sub.copied=true;}for(var j=0;j<sub.ranges.length;j++){rebaseHistSelSingle(sub.ranges[j].anchor,from,to,diff);rebaseHistSelSingle(sub.ranges[j].head,from,to,diff);}continue;}for(var j$1=0;j$1<sub.changes.length;++j$1){var cur=sub.changes[j$1];if(to<cur.from.line){cur.from=Pos(cur.from.line+diff,cur.from.ch);cur.to=Pos(cur.to.line+diff,cur.to.ch);}else if(from<=cur.to.line){ok=false;break;}}if(!ok){array.splice(0,i+1);i=0;}}}function rebaseHist(hist,change){var from=change.from.line,to=change.to.line,diff=change.text.length-(to-from)-1;rebaseHistArray(hist.done,from,to,diff);rebaseHistArray(hist.undone,from,to,diff);}// Utility for applying a change to a line by handle or number,\n// returning the number and optionally registering the line as\n// changed.\nfunction changeLine(doc,handle,changeType,op){var no=handle,line=handle;if(typeof handle=="number"){line=getLine(doc,clipLine(doc,handle));}else{no=lineNo(handle);}if(no==null){return null;}if(op(line,no)&&doc.cm){regLineChange(doc.cm,no,changeType);}return line;}// The document is represented as a BTree consisting of leaves, with\n// chunk of lines in them, and branches, with up to ten leaves or\n// other branch nodes below them. The top node is always a branch\n// node, and is the document object itself (meaning it has\n// additional methods and properties).\n//\n// All nodes have parent links. The tree is used both to go from\n// line numbers to line objects, and to go from objects to numbers.\n// It also indexes by height, and is used to convert between height\n// and line object, and to find the total height of the document.\n//\n// See also http://marijnhaverbeke.nl/blog/codemirror-line-tree.html\nfunction LeafChunk(lines){var this$1=this;this.lines=lines;this.parent=null;var height=0;for(var i=0;i<lines.length;++i){lines[i].parent=this$1;height+=lines[i].height;}this.height=height;}LeafChunk.prototype={chunkSize:function(){return this.lines.length;},// Remove the n lines at offset \'at\'.\nremoveInner:function(at,n){var this$1=this;for(var i=at,e=at+n;i<e;++i){var line=this$1.lines[i];this$1.height-=line.height;cleanUpLine(line);signalLater(line,"delete");}this.lines.splice(at,n);},// Helper used to collapse a small branch into a single leaf.\ncollapse:function(lines){lines.push.apply(lines,this.lines);},// Insert the given array of lines at offset \'at\', count them as\n// having the given height.\ninsertInner:function(at,lines,height){var this$1=this;this.height+=height;this.lines=this.lines.slice(0,at).concat(lines).concat(this.lines.slice(at));for(var i=0;i<lines.length;++i){lines[i].parent=this$1;}},// Used to iterate over a part of the tree.\niterN:function(at,n,op){var this$1=this;for(var e=at+n;at<e;++at){if(op(this$1.lines[at])){return true;}}}};function BranchChunk(children){var this$1=this;this.children=children;var size=0,height=0;for(var i=0;i<children.length;++i){var ch=children[i];size+=ch.chunkSize();height+=ch.height;ch.parent=this$1;}this.size=size;this.height=height;this.parent=null;}BranchChunk.prototype={chunkSize:function(){return this.size;},removeInner:function(at,n){var this$1=this;this.size-=n;for(var i=0;i<this.children.length;++i){var child=this$1.children[i],sz=child.chunkSize();if(at<sz){var rm=Math.min(n,sz-at),oldHeight=child.height;child.removeInner(at,rm);this$1.height-=oldHeight-child.height;if(sz==rm){this$1.children.splice(i--,1);child.parent=null;}if((n-=rm)==0){break;}at=0;}else{at-=sz;}}// If the result is smaller than 25 lines, ensure that it is a\n// single leaf node.\nif(this.size-n<25&&(this.children.length>1||!(this.children[0]instanceof LeafChunk))){var lines=[];this.collapse(lines);this.children=[new LeafChunk(lines)];this.children[0].parent=this;}},collapse:function(lines){var this$1=this;for(var i=0;i<this.children.length;++i){this$1.children[i].collapse(lines);}},insertInner:function(at,lines,height){var this$1=this;this.size+=lines.length;this.height+=height;for(var i=0;i<this.children.length;++i){var child=this$1.children[i],sz=child.chunkSize();if(at<=sz){child.insertInner(at,lines,height);if(child.lines&&child.lines.length>50){// To avoid memory thrashing when child.lines is huge (e.g. first view of a large file), it\'s never spliced.\n// Instead, small slices are taken. They\'re taken in order because sequential memory accesses are fastest.\nvar remaining=child.lines.length%25+25;for(var pos=remaining;pos<child.lines.length;){var leaf=new LeafChunk(child.lines.slice(pos,pos+=25));child.height-=leaf.height;this$1.children.splice(++i,0,leaf);leaf.parent=this$1;}child.lines=child.lines.slice(0,remaining);this$1.maybeSpill();}break;}at-=sz;}},// When a node has grown, check whether it should be split.\nmaybeSpill:function(){if(this.children.length<=10){return;}var me=this;do{var spilled=me.children.splice(me.children.length-5,5);var sibling=new BranchChunk(spilled);if(!me.parent){// Become the parent node\nvar copy=new BranchChunk(me.children);copy.parent=me;me.children=[copy,sibling];me=copy;}else{me.size-=sibling.size;me.height-=sibling.height;var myIndex=indexOf(me.parent.children,me);me.parent.children.splice(myIndex+1,0,sibling);}sibling.parent=me.parent;}while(me.children.length>10);me.parent.maybeSpill();},iterN:function(at,n,op){var this$1=this;for(var i=0;i<this.children.length;++i){var child=this$1.children[i],sz=child.chunkSize();if(at<sz){var used=Math.min(n,sz-at);if(child.iterN(at,used,op)){return true;}if((n-=used)==0){break;}at=0;}else{at-=sz;}}}};// Line widgets are block elements displayed above or below a line.\nfunction LineWidget(doc,node,options){var this$1=this;if(options){for(var opt in options){if(options.hasOwnProperty(opt)){this$1[opt]=options[opt];}}}this.doc=doc;this.node=node;}eventMixin(LineWidget);function adjustScrollWhenAboveVisible(cm,line,diff){if(heightAtLine(line)<(cm.curOp&&cm.curOp.scrollTop||cm.doc.scrollTop)){addToScrollPos(cm,null,diff);}}LineWidget.prototype.clear=function(){var this$1=this;var cm=this.doc.cm,ws=this.line.widgets,line=this.line,no=lineNo(line);if(no==null||!ws){return;}for(var i=0;i<ws.length;++i){if(ws[i]==this$1){ws.splice(i--,1);}}if(!ws.length){line.widgets=null;}var height=widgetHeight(this);updateLineHeight(line,Math.max(0,line.height-height));if(cm){runInOp(cm,function(){adjustScrollWhenAboveVisible(cm,line,-height);regLineChange(cm,no,"widget");});}};LineWidget.prototype.changed=function(){var oldH=this.height,cm=this.doc.cm,line=this.line;this.height=null;var diff=widgetHeight(this)-oldH;if(!diff){return;}updateLineHeight(line,line.height+diff);if(cm){runInOp(cm,function(){cm.curOp.forceUpdate=true;adjustScrollWhenAboveVisible(cm,line,diff);});}};function addLineWidget(doc,handle,node,options){var widget=new LineWidget(doc,node,options);var cm=doc.cm;if(cm&&widget.noHScroll){cm.display.alignWidgets=true;}changeLine(doc,handle,"widget",function(line){var widgets=line.widgets||(line.widgets=[]);if(widget.insertAt==null){widgets.push(widget);}else{widgets.splice(Math.min(widgets.length-1,Math.max(0,widget.insertAt)),0,widget);}widget.line=line;if(cm&&!lineIsHidden(doc,line)){var aboveVisible=heightAtLine(line)<doc.scrollTop;updateLineHeight(line,line.height+widgetHeight(widget));if(aboveVisible){addToScrollPos(cm,null,widget.height);}cm.curOp.forceUpdate=true;}return true;});return widget;}// TEXTMARKERS\n// Created with markText and setBookmark methods. A TextMarker is a\n// handle that can be used to clear or find a marked position in the\n// document. Line objects hold arrays (markedSpans) containing\n// {from, to, marker} object pointing to such marker objects, and\n// indicating that such a marker is present on that line. Multiple\n// lines may point to the same marker when it spans across lines.\n// The spans will have null for their from/to properties when the\n// marker continues beyond the start/end of the line. Markers have\n// links back to the lines they currently touch.\n// Collapsed markers have unique ids, in order to be able to order\n// them, which is needed for uniquely determining an outer marker\n// when they overlap (they may nest, but not partially overlap).\nvar nextMarkerId=0;function TextMarker(doc,type){this.lines=[];this.type=type;this.doc=doc;this.id=++nextMarkerId;}eventMixin(TextMarker);// Clear the marker.\nTextMarker.prototype.clear=function(){var this$1=this;if(this.explicitlyCleared){return;}var cm=this.doc.cm,withOp=cm&&!cm.curOp;if(withOp){startOperation(cm);}if(hasHandler(this,"clear")){var found=this.find();if(found){signalLater(this,"clear",found.from,found.to);}}var min=null,max=null;for(var i=0;i<this.lines.length;++i){var line=this$1.lines[i];var span=getMarkedSpanFor(line.markedSpans,this$1);if(cm&&!this$1.collapsed){regLineChange(cm,lineNo(line),"text");}else if(cm){if(span.to!=null){max=lineNo(line);}if(span.from!=null){min=lineNo(line);}}line.markedSpans=removeMarkedSpan(line.markedSpans,span);if(span.from==null&&this$1.collapsed&&!lineIsHidden(this$1.doc,line)&&cm){updateLineHeight(line,textHeight(cm.display));}}if(cm&&this.collapsed&&!cm.options.lineWrapping){for(var i$1=0;i$1<this.lines.length;++i$1){var visual=visualLine(this$1.lines[i$1]),len=lineLength(visual);if(len>cm.display.maxLineLength){cm.display.maxLine=visual;cm.display.maxLineLength=len;cm.display.maxLineChanged=true;}}}if(min!=null&&cm&&this.collapsed){regChange(cm,min,max+1);}this.lines.length=0;this.explicitlyCleared=true;if(this.atomic&&this.doc.cantEdit){this.doc.cantEdit=false;if(cm){reCheckSelection(cm.doc);}}if(cm){signalLater(cm,"markerCleared",cm,this);}if(withOp){endOperation(cm);}if(this.parent){this.parent.clear();}};// Find the position of the marker in the document. Returns a {from,\n// to} object by default. Side can be passed to get a specific side\n// -- 0 (both), -1 (left), or 1 (right). When lineObj is true, the\n// Pos objects returned contain a line object, rather than a line\n// number (used to prevent looking up the same line twice).\nTextMarker.prototype.find=function(side,lineObj){var this$1=this;if(side==null&&this.type=="bookmark"){side=1;}var from,to;for(var i=0;i<this.lines.length;++i){var line=this$1.lines[i];var span=getMarkedSpanFor(line.markedSpans,this$1);if(span.from!=null){from=Pos(lineObj?line:lineNo(line),span.from);if(side==-1){return from;}}if(span.to!=null){to=Pos(lineObj?line:lineNo(line),span.to);if(side==1){return to;}}}return from&&{from:from,to:to};};// Signals that the marker\'s widget changed, and surrounding layout\n// should be recomputed.\nTextMarker.prototype.changed=function(){var pos=this.find(-1,true),widget=this,cm=this.doc.cm;if(!pos||!cm){return;}runInOp(cm,function(){var line=pos.line,lineN=lineNo(pos.line);var view=findViewForLine(cm,lineN);if(view){clearLineMeasurementCacheFor(view);cm.curOp.selectionChanged=cm.curOp.forceUpdate=true;}cm.curOp.updateMaxLine=true;if(!lineIsHidden(widget.doc,line)&&widget.height!=null){var oldHeight=widget.height;widget.height=null;var dHeight=widgetHeight(widget)-oldHeight;if(dHeight){updateLineHeight(line,line.height+dHeight);}}});};TextMarker.prototype.attachLine=function(line){if(!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;if(!op.maybeHiddenMarkers||indexOf(op.maybeHiddenMarkers,this)==-1){(op.maybeUnhiddenMarkers||(op.maybeUnhiddenMarkers=[])).push(this);}}this.lines.push(line);};TextMarker.prototype.detachLine=function(line){this.lines.splice(indexOf(this.lines,line),1);if(!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;(op.maybeHiddenMarkers||(op.maybeHiddenMarkers=[])).push(this);}};// Create a marker, wire it up to the right lines, and\nfunction markText(doc,from,to,options,type){// Shared markers (across linked documents) are handled separately\n// (markTextShared will call out to this again, once per\n// document).\nif(options&&options.shared){return markTextShared(doc,from,to,options,type);}// Ensure we are in an operation.\nif(doc.cm&&!doc.cm.curOp){return operation(doc.cm,markText)(doc,from,to,options,type);}var marker=new TextMarker(doc,type),diff=cmp(from,to);if(options){copyObj(options,marker,false);}// Don\'t connect empty markers unless clearWhenEmpty is false\nif(diff>0||diff==0&&marker.clearWhenEmpty!==false){return marker;}if(marker.replacedWith){// Showing up as a widget implies collapsed (widget replaces text)\nmarker.collapsed=true;marker.widgetNode=elt("span",[marker.replacedWith],"CodeMirror-widget");if(!options.handleMouseEvents){marker.widgetNode.setAttribute("cm-ignore-events","true");}if(options.insertLeft){marker.widgetNode.insertLeft=true;}}if(marker.collapsed){if(conflictingCollapsedRange(doc,from.line,from,to,marker)||from.line!=to.line&&conflictingCollapsedRange(doc,to.line,from,to,marker)){throw new Error("Inserting collapsed marker partially overlapping an existing one");}seeCollapsedSpans();}if(marker.addToHistory){addChangeToHistory(doc,{from:from,to:to,origin:"markText"},doc.sel,NaN);}var curLine=from.line,cm=doc.cm,updateMaxLine;doc.iter(curLine,to.line+1,function(line){if(cm&&marker.collapsed&&!cm.options.lineWrapping&&visualLine(line)==cm.display.maxLine){updateMaxLine=true;}if(marker.collapsed&&curLine!=from.line){updateLineHeight(line,0);}addMarkedSpan(line,new MarkedSpan(marker,curLine==from.line?from.ch:null,curLine==to.line?to.ch:null));++curLine;});// lineIsHidden depends on the presence of the spans, so needs a second pass\nif(marker.collapsed){doc.iter(from.line,to.line+1,function(line){if(lineIsHidden(doc,line)){updateLineHeight(line,0);}});}if(marker.clearOnEnter){on(marker,"beforeCursorEnter",function(){return marker.clear();});}if(marker.readOnly){seeReadOnlySpans();if(doc.history.done.length||doc.history.undone.length){doc.clearHistory();}}if(marker.collapsed){marker.id=++nextMarkerId;marker.atomic=true;}if(cm){// Sync editor state\nif(updateMaxLine){cm.curOp.updateMaxLine=true;}if(marker.collapsed){regChange(cm,from.line,to.line+1);}else if(marker.className||marker.title||marker.startStyle||marker.endStyle||marker.css){for(var i=from.line;i<=to.line;i++){regLineChange(cm,i,"text");}}if(marker.atomic){reCheckSelection(cm.doc);}signalLater(cm,"markerAdded",cm,marker);}return marker;}// SHARED TEXTMARKERS\n// A shared marker spans multiple linked documents. It is\n// implemented as a meta-marker-object controlling multiple normal\n// markers.\nfunction SharedTextMarker(markers,primary){var this$1=this;this.markers=markers;this.primary=primary;for(var i=0;i<markers.length;++i){markers[i].parent=this$1;}}eventMixin(SharedTextMarker);SharedTextMarker.prototype.clear=function(){var this$1=this;if(this.explicitlyCleared){return;}this.explicitlyCleared=true;for(var i=0;i<this.markers.length;++i){this$1.markers[i].clear();}signalLater(this,"clear");};SharedTextMarker.prototype.find=function(side,lineObj){return this.primary.find(side,lineObj);};function markTextShared(doc,from,to,options,type){options=copyObj(options);options.shared=false;var markers=[markText(doc,from,to,options,type)],primary=markers[0];var widget=options.widgetNode;linkedDocs(doc,function(doc){if(widget){options.widgetNode=widget.cloneNode(true);}markers.push(markText(doc,clipPos(doc,from),clipPos(doc,to),options,type));for(var i=0;i<doc.linked.length;++i){if(doc.linked[i].isParent){return;}}primary=lst(markers);});return new SharedTextMarker(markers,primary);}function findSharedMarkers(doc){return doc.findMarks(Pos(doc.first,0),doc.clipPos(Pos(doc.lastLine())),function(m){return m.parent;});}function copySharedMarkers(doc,markers){for(var i=0;i<markers.length;i++){var marker=markers[i],pos=marker.find();var mFrom=doc.clipPos(pos.from),mTo=doc.clipPos(pos.to);if(cmp(mFrom,mTo)){var subMark=markText(doc,mFrom,mTo,marker.primary,marker.primary.type);marker.markers.push(subMark);subMark.parent=marker;}}}function detachSharedMarkers(markers){var loop=function(i){var marker=markers[i],linked=[marker.primary.doc];linkedDocs(marker.primary.doc,function(d){return linked.push(d);});for(var j=0;j<marker.markers.length;j++){var subMarker=marker.markers[j];if(indexOf(linked,subMarker.doc)==-1){subMarker.parent=null;marker.markers.splice(j--,1);}}};for(var i=0;i<markers.length;i++)loop(i);}var nextDocId=0;var Doc=function(text,mode,firstLine,lineSep){if(!(this instanceof Doc)){return new Doc(text,mode,firstLine,lineSep);}if(firstLine==null){firstLine=0;}BranchChunk.call(this,[new LeafChunk([new Line("",null)])]);this.first=firstLine;this.scrollTop=this.scrollLeft=0;this.cantEdit=false;this.cleanGeneration=1;this.frontier=firstLine;var start=Pos(firstLine,0);this.sel=simpleSelection(start);this.history=new History(null);this.id=++nextDocId;this.modeOption=mode;this.lineSep=lineSep;this.extend=false;if(typeof text=="string"){text=this.splitLines(text);}updateDoc(this,{from:start,to:start,text:text});setSelection(this,simpleSelection(start),sel_dontScroll);};Doc.prototype=createObj(BranchChunk.prototype,{constructor:Doc,// Iterate over the document. Supports two forms -- with only one\n// argument, it calls that for each line in the document. With\n// three, it iterates over the range given by the first two (with\n// the second being non-inclusive).\niter:function(from,to,op){if(op){this.iterN(from-this.first,to-from,op);}else{this.iterN(this.first,this.first+this.size,from);}},// Non-public interface for adding and removing lines.\ninsert:function(at,lines){var height=0;for(var i=0;i<lines.length;++i){height+=lines[i].height;}this.insertInner(at-this.first,lines,height);},remove:function(at,n){this.removeInner(at-this.first,n);},// From here, the methods are part of the public interface. Most\n// are also available from CodeMirror (editor) instances.\ngetValue:function(lineSep){var lines=getLines(this,this.first,this.first+this.size);if(lineSep===false){return lines;}return lines.join(lineSep||this.lineSeparator());},setValue:docMethodOp(function(code){var top=Pos(this.first,0),last=this.first+this.size-1;makeChange(this,{from:top,to:Pos(last,getLine(this,last).text.length),text:this.splitLines(code),origin:"setValue",full:true},true);setSelection(this,simpleSelection(top));}),replaceRange:function(code,from,to,origin){from=clipPos(this,from);to=to?clipPos(this,to):from;replaceRange(this,code,from,to,origin);},getRange:function(from,to,lineSep){var lines=getBetween(this,clipPos(this,from),clipPos(this,to));if(lineSep===false){return lines;}return lines.join(lineSep||this.lineSeparator());},getLine:function(line){var l=this.getLineHandle(line);return l&&l.text;},getLineHandle:function(line){if(isLine(this,line)){return getLine(this,line);}},getLineNumber:function(line){return lineNo(line);},getLineHandleVisualStart:function(line){if(typeof line=="number"){line=getLine(this,line);}return visualLine(line);},lineCount:function(){return this.size;},firstLine:function(){return this.first;},lastLine:function(){return this.first+this.size-1;},clipPos:function(pos){return clipPos(this,pos);},getCursor:function(start){var range=this.sel.primary(),pos;if(start==null||start=="head"){pos=range.head;}else if(start=="anchor"){pos=range.anchor;}else if(start=="end"||start=="to"||start===false){pos=range.to();}else{pos=range.from();}return pos;},listSelections:function(){return this.sel.ranges;},somethingSelected:function(){return this.sel.somethingSelected();},setCursor:docMethodOp(function(line,ch,options){setSimpleSelection(this,clipPos(this,typeof line=="number"?Pos(line,ch||0):line),null,options);}),setSelection:docMethodOp(function(anchor,head,options){setSimpleSelection(this,clipPos(this,anchor),clipPos(this,head||anchor),options);}),extendSelection:docMethodOp(function(head,other,options){extendSelection(this,clipPos(this,head),other&&clipPos(this,other),options);}),extendSelections:docMethodOp(function(heads,options){extendSelections(this,clipPosArray(this,heads),options);}),extendSelectionsBy:docMethodOp(function(f,options){var heads=map(this.sel.ranges,f);extendSelections(this,clipPosArray(this,heads),options);}),setSelections:docMethodOp(function(ranges,primary,options){var this$1=this;if(!ranges.length){return;}var out=[];for(var i=0;i<ranges.length;i++){out[i]=new Range(clipPos(this$1,ranges[i].anchor),clipPos(this$1,ranges[i].head));}if(primary==null){primary=Math.min(ranges.length-1,this.sel.primIndex);}setSelection(this,normalizeSelection(out,primary),options);}),addSelection:docMethodOp(function(anchor,head,options){var ranges=this.sel.ranges.slice(0);ranges.push(new Range(clipPos(this,anchor),clipPos(this,head||anchor)));setSelection(this,normalizeSelection(ranges,ranges.length-1),options);}),getSelection:function(lineSep){var this$1=this;var ranges=this.sel.ranges,lines;for(var i=0;i<ranges.length;i++){var sel=getBetween(this$1,ranges[i].from(),ranges[i].to());lines=lines?lines.concat(sel):sel;}if(lineSep===false){return lines;}else{return lines.join(lineSep||this.lineSeparator());}},getSelections:function(lineSep){var this$1=this;var parts=[],ranges=this.sel.ranges;for(var i=0;i<ranges.length;i++){var sel=getBetween(this$1,ranges[i].from(),ranges[i].to());if(lineSep!==false){sel=sel.join(lineSep||this$1.lineSeparator());}parts[i]=sel;}return parts;},replaceSelection:function(code,collapse,origin){var dup=[];for(var i=0;i<this.sel.ranges.length;i++){dup[i]=code;}this.replaceSelections(dup,collapse,origin||"+input");},replaceSelections:docMethodOp(function(code,collapse,origin){var this$1=this;var changes=[],sel=this.sel;for(var i=0;i<sel.ranges.length;i++){var range=sel.ranges[i];changes[i]={from:range.from(),to:range.to(),text:this$1.splitLines(code[i]),origin:origin};}var newSel=collapse&&collapse!="end"&&computeReplacedSel(this,changes,collapse);for(var i$1=changes.length-1;i$1>=0;i$1--){makeChange(this$1,changes[i$1]);}if(newSel){setSelectionReplaceHistory(this,newSel);}else if(this.cm){ensureCursorVisible(this.cm);}}),undo:docMethodOp(function(){makeChangeFromHistory(this,"undo");}),redo:docMethodOp(function(){makeChangeFromHistory(this,"redo");}),undoSelection:docMethodOp(function(){makeChangeFromHistory(this,"undo",true);}),redoSelection:docMethodOp(function(){makeChangeFromHistory(this,"redo",true);}),setExtending:function(val){this.extend=val;},getExtending:function(){return this.extend;},historySize:function(){var hist=this.history,done=0,undone=0;for(var i=0;i<hist.done.length;i++){if(!hist.done[i].ranges){++done;}}for(var i$1=0;i$1<hist.undone.length;i$1++){if(!hist.undone[i$1].ranges){++undone;}}return{undo:done,redo:undone};},clearHistory:function(){this.history=new History(this.history.maxGeneration);},markClean:function(){this.cleanGeneration=this.changeGeneration(true);},changeGeneration:function(forceSplit){if(forceSplit){this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null;}return this.history.generation;},isClean:function(gen){return this.history.generation==(gen||this.cleanGeneration);},getHistory:function(){return{done:copyHistoryArray(this.history.done),undone:copyHistoryArray(this.history.undone)};},setHistory:function(histData){var hist=this.history=new History(this.history.maxGeneration);hist.done=copyHistoryArray(histData.done.slice(0),null,true);hist.undone=copyHistoryArray(histData.undone.slice(0),null,true);},addLineClass:docMethodOp(function(handle,where,cls){return changeLine(this,handle,where=="gutter"?"gutter":"class",function(line){var prop=where=="text"?"textClass":where=="background"?"bgClass":where=="gutter"?"gutterClass":"wrapClass";if(!line[prop]){line[prop]=cls;}else if(classTest(cls).test(line[prop])){return false;}else{line[prop]+=" "+cls;}return true;});}),removeLineClass:docMethodOp(function(handle,where,cls){return changeLine(this,handle,where=="gutter"?"gutter":"class",function(line){var prop=where=="text"?"textClass":where=="background"?"bgClass":where=="gutter"?"gutterClass":"wrapClass";var cur=line[prop];if(!cur){return false;}else if(cls==null){line[prop]=null;}else{var found=cur.match(classTest(cls));if(!found){return false;}var end=found.index+found[0].length;line[prop]=cur.slice(0,found.index)+(!found.index||end==cur.length?"":" ")+cur.slice(end)||null;}return true;});}),addLineWidget:docMethodOp(function(handle,node,options){return addLineWidget(this,handle,node,options);}),removeLineWidget:function(widget){widget.clear();},markText:function(from,to,options){return markText(this,clipPos(this,from),clipPos(this,to),options,options&&options.type||"range");},setBookmark:function(pos,options){var realOpts={replacedWith:options&&(options.nodeType==null?options.widget:options),insertLeft:options&&options.insertLeft,clearWhenEmpty:false,shared:options&&options.shared,handleMouseEvents:options&&options.handleMouseEvents};pos=clipPos(this,pos);return markText(this,pos,pos,realOpts,"bookmark");},findMarksAt:function(pos){pos=clipPos(this,pos);var markers=[],spans=getLine(this,pos.line).markedSpans;if(spans){for(var i=0;i<spans.length;++i){var span=spans[i];if((span.from==null||span.from<=pos.ch)&&(span.to==null||span.to>=pos.ch)){markers.push(span.marker.parent||span.marker);}}}return markers;},findMarks:function(from,to,filter){from=clipPos(this,from);to=clipPos(this,to);var found=[],lineNo=from.line;this.iter(from.line,to.line+1,function(line){var spans=line.markedSpans;if(spans){for(var i=0;i<spans.length;i++){var span=spans[i];if(!(span.to!=null&&lineNo==from.line&&from.ch>=span.to||span.from==null&&lineNo!=from.line||span.from!=null&&lineNo==to.line&&span.from>=to.ch)&&(!filter||filter(span.marker))){found.push(span.marker.parent||span.marker);}}}++lineNo;});return found;},getAllMarks:function(){var markers=[];this.iter(function(line){var sps=line.markedSpans;if(sps){for(var i=0;i<sps.length;++i){if(sps[i].from!=null){markers.push(sps[i].marker);}}}});return markers;},posFromIndex:function(off){var ch,lineNo=this.first,sepSize=this.lineSeparator().length;this.iter(function(line){var sz=line.text.length+sepSize;if(sz>off){ch=off;return true;}off-=sz;++lineNo;});return clipPos(this,Pos(lineNo,ch));},indexFromPos:function(coords){coords=clipPos(this,coords);var index=coords.ch;if(coords.line<this.first||coords.ch<0){return 0;}var sepSize=this.lineSeparator().length;this.iter(this.first,coords.line,function(line){// iter aborts when callback returns a truthy value\nindex+=line.text.length+sepSize;});return index;},copy:function(copyHistory){var doc=new Doc(getLines(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep);doc.scrollTop=this.scrollTop;doc.scrollLeft=this.scrollLeft;doc.sel=this.sel;doc.extend=false;if(copyHistory){doc.history.undoDepth=this.history.undoDepth;doc.setHistory(this.getHistory());}return doc;},linkedDoc:function(options){if(!options){options={};}var from=this.first,to=this.first+this.size;if(options.from!=null&&options.from>from){from=options.from;}if(options.to!=null&&options.to<to){to=options.to;}var copy=new Doc(getLines(this,from,to),options.mode||this.modeOption,from,this.lineSep);if(options.sharedHist){copy.history=this.history;}(this.linked||(this.linked=[])).push({doc:copy,sharedHist:options.sharedHist});copy.linked=[{doc:this,isParent:true,sharedHist:options.sharedHist}];copySharedMarkers(copy,findSharedMarkers(this));return copy;},unlinkDoc:function(other){var this$1=this;if(other instanceof CodeMirror){other=other.doc;}if(this.linked){for(var i=0;i<this.linked.length;++i){var link=this$1.linked[i];if(link.doc!=other){continue;}this$1.linked.splice(i,1);other.unlinkDoc(this$1);detachSharedMarkers(findSharedMarkers(this$1));break;}}// If the histories were shared, split them again\nif(other.history==this.history){var splitIds=[other.id];linkedDocs(other,function(doc){return splitIds.push(doc.id);},true);other.history=new History(null);other.history.done=copyHistoryArray(this.history.done,splitIds);other.history.undone=copyHistoryArray(this.history.undone,splitIds);}},iterLinkedDocs:function(f){linkedDocs(this,f);},getMode:function(){return this.mode;},getEditor:function(){return this.cm;},splitLines:function(str){if(this.lineSep){return str.split(this.lineSep);}return splitLinesAuto(str);},lineSeparator:function(){return this.lineSep||"\\n";}});// Public alias.\nDoc.prototype.eachLine=Doc.prototype.iter;// Kludge to work around strange IE behavior where it\'ll sometimes\n// re-fire a series of drag-related events right after the drop (#1551)\nvar lastDrop=0;function onDrop(e){var cm=this;clearDragCursor(cm);if(signalDOMEvent(cm,e)||eventInWidget(cm.display,e)){return;}e_preventDefault(e);if(ie){lastDrop=+new Date();}var pos=posFromMouse(cm,e,true),files=e.dataTransfer.files;if(!pos||cm.isReadOnly()){return;}// Might be a file drop, in which case we simply extract the text\n// and insert it.\nif(files&&files.length&&window.FileReader&&window.File){var n=files.length,text=Array(n),read=0;var loadFile=function(file,i){if(cm.options.allowDropFileTypes&&indexOf(cm.options.allowDropFileTypes,file.type)==-1){return;}var reader=new FileReader();reader.onload=operation(cm,function(){var content=reader.result;if(/[\\x00-\\x08\\x0e-\\x1f]{2}/.test(content)){content="";}text[i]=content;if(++read==n){pos=clipPos(cm.doc,pos);var change={from:pos,to:pos,text:cm.doc.splitLines(text.join(cm.doc.lineSeparator())),origin:"paste"};makeChange(cm.doc,change);setSelectionReplaceHistory(cm.doc,simpleSelection(pos,changeEnd(change)));}});reader.readAsText(file);};for(var i=0;i<n;++i){loadFile(files[i],i);}}else{// Normal drop\n// Don\'t do a replace if the drop happened inside of the selected text.\nif(cm.state.draggingText&&cm.doc.sel.contains(pos)>-1){cm.state.draggingText(e);// Ensure the editor is re-focused\nsetTimeout(function(){return cm.display.input.focus();},20);return;}try{var text$1=e.dataTransfer.getData("Text");if(text$1){var selected;if(cm.state.draggingText&&!cm.state.draggingText.copy){selected=cm.listSelections();}setSelectionNoUndo(cm.doc,simpleSelection(pos,pos));if(selected){for(var i$1=0;i$1<selected.length;++i$1){replaceRange(cm.doc,"",selected[i$1].anchor,selected[i$1].head,"drag");}}cm.replaceSelection(text$1,"around","paste");cm.display.input.focus();}}catch(e){}}}function onDragStart(cm,e){if(ie&&(!cm.state.draggingText||+new Date()-lastDrop<100)){e_stop(e);return;}if(signalDOMEvent(cm,e)||eventInWidget(cm.display,e)){return;}e.dataTransfer.setData("Text",cm.getSelection());e.dataTransfer.effectAllowed="copyMove";// Use dummy image instead of default browsers image.\n// Recent Safari (~6.0.2) have a tendency to segfault when this happens, so we don\'t do it there.\nif(e.dataTransfer.setDragImage&&!safari){var img=elt("img",null,null,"position: fixed; left: 0; top: 0;");img.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";if(presto){img.width=img.height=1;cm.display.wrapper.appendChild(img);// Force a relayout, or Opera won\'t use our image for some obscure reason\nimg._top=img.offsetTop;}e.dataTransfer.setDragImage(img,0,0);if(presto){img.parentNode.removeChild(img);}}}function onDragOver(cm,e){var pos=posFromMouse(cm,e);if(!pos){return;}var frag=document.createDocumentFragment();drawSelectionCursor(cm,pos,frag);if(!cm.display.dragCursor){cm.display.dragCursor=elt("div",null,"CodeMirror-cursors CodeMirror-dragcursors");cm.display.lineSpace.insertBefore(cm.display.dragCursor,cm.display.cursorDiv);}removeChildrenAndAdd(cm.display.dragCursor,frag);}function clearDragCursor(cm){if(cm.display.dragCursor){cm.display.lineSpace.removeChild(cm.display.dragCursor);cm.display.dragCursor=null;}}// These must be handled carefully, because naively registering a\n// handler for each editor will cause the editors to never be\n// garbage collected.\nfunction forEachCodeMirror(f){if(!document.body.getElementsByClassName){return;}var byClass=document.body.getElementsByClassName("CodeMirror");for(var i=0;i<byClass.length;i++){var cm=byClass[i].CodeMirror;if(cm){f(cm);}}}var globalsRegistered=false;function ensureGlobalHandlers(){if(globalsRegistered){return;}registerGlobalHandlers();globalsRegistered=true;}function registerGlobalHandlers(){// When the window resizes, we need to refresh active editors.\nvar resizeTimer;on(window,"resize",function(){if(resizeTimer==null){resizeTimer=setTimeout(function(){resizeTimer=null;forEachCodeMirror(onResize);},100);}});// When the window loses focus, we want to show the editor as blurred\non(window,"blur",function(){return forEachCodeMirror(onBlur);});}// Called when the window resizes\nfunction onResize(cm){var d=cm.display;if(d.lastWrapHeight==d.wrapper.clientHeight&&d.lastWrapWidth==d.wrapper.clientWidth){return;}// Might be a text scaling operation, clear size caches.\nd.cachedCharWidth=d.cachedTextHeight=d.cachedPaddingH=null;d.scrollbarsClipped=false;cm.setSize();}var keyNames={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\\\",221:"]",222:"\'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};// Number keys\nfor(var i=0;i<10;i++){keyNames[i+48]=keyNames[i+96]=String(i);}// Alphabetic keys\nfor(var i$1=65;i$1<=90;i$1++){keyNames[i$1]=String.fromCharCode(i$1);}// Function keys\nfor(var i$2=1;i$2<=12;i$2++){keyNames[i$2+111]=keyNames[i$2+63235]="F"+i$2;}var keyMap={};keyMap.basic={"Left":"goCharLeft","Right":"goCharRight","Up":"goLineUp","Down":"goLineDown","End":"goLineEnd","Home":"goLineStartSmart","PageUp":"goPageUp","PageDown":"goPageDown","Delete":"delCharAfter","Backspace":"delCharBefore","Shift-Backspace":"delCharBefore","Tab":"defaultTab","Shift-Tab":"indentAuto","Enter":"newlineAndIndent","Insert":"toggleOverwrite","Esc":"singleSelection"};// Note that the save and find-related commands aren\'t defined by\n// default. User code or addons can define them. Unknown commands\n// are simply ignored.\nkeyMap.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"};// Very basic readline/emacs-style bindings, which are standard on Mac.\nkeyMap.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"};keyMap.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]};keyMap["default"]=mac?keyMap.macDefault:keyMap.pcDefault;// KEYMAP DISPATCH\nfunction normalizeKeyName(name){var parts=name.split(/-(?!$)/);name=parts[parts.length-1];var alt,ctrl,shift,cmd;for(var i=0;i<parts.length-1;i++){var mod=parts[i];if(/^(cmd|meta|m)$/i.test(mod)){cmd=true;}else if(/^a(lt)?$/i.test(mod)){alt=true;}else if(/^(c|ctrl|control)$/i.test(mod)){ctrl=true;}else if(/^s(hift)?$/i.test(mod)){shift=true;}else{throw new Error("Unrecognized modifier name: "+mod);}}if(alt){name="Alt-"+name;}if(ctrl){name="Ctrl-"+name;}if(cmd){name="Cmd-"+name;}if(shift){name="Shift-"+name;}return name;}// This is a kludge to keep keymaps mostly working as raw objects\n// (backwards compatibility) while at the same time support features\n// like normalization and multi-stroke key bindings. It compiles a\n// new normalized keymap, and then updates the old object to reflect\n// this.\nfunction normalizeKeyMap(keymap){var copy={};for(var keyname in keymap){if(keymap.hasOwnProperty(keyname)){var value=keymap[keyname];if(/^(name|fallthrough|(de|at)tach)$/.test(keyname)){continue;}if(value=="..."){delete keymap[keyname];continue;}var keys=map(keyname.split(" "),normalizeKeyName);for(var i=0;i<keys.length;i++){var val=void 0,name=void 0;if(i==keys.length-1){name=keys.join(" ");val=value;}else{name=keys.slice(0,i+1).join(" ");val="...";}var prev=copy[name];if(!prev){copy[name]=val;}else if(prev!=val){throw new Error("Inconsistent bindings for "+name);}}delete keymap[keyname];}}for(var prop in copy){keymap[prop]=copy[prop];}return keymap;}function lookupKey(key,map,handle,context){map=getKeyMap(map);var found=map.call?map.call(key,context):map[key];if(found===false){return"nothing";}if(found==="..."){return"multi";}if(found!=null&&handle(found)){return"handled";}if(map.fallthrough){if(Object.prototype.toString.call(map.fallthrough)!="[object Array]"){return lookupKey(key,map.fallthrough,handle,context);}for(var i=0;i<map.fallthrough.length;i++){var result=lookupKey(key,map.fallthrough[i],handle,context);if(result){return result;}}}}// Modifier key presses don\'t count as \'real\' key presses for the\n// purpose of keymap fallthrough.\nfunction isModifierKey(value){var name=typeof value=="string"?value:keyNames[value.keyCode];return name=="Ctrl"||name=="Alt"||name=="Shift"||name=="Mod";}// Look up the name of a key as indicated by an event object.\nfunction keyName(event,noShift){if(presto&&event.keyCode==34&&event["char"]){return false;}var base=keyNames[event.keyCode],name=base;if(name==null||event.altGraphKey){return false;}if(event.altKey&&base!="Alt"){name="Alt-"+name;}if((flipCtrlCmd?event.metaKey:event.ctrlKey)&&base!="Ctrl"){name="Ctrl-"+name;}if((flipCtrlCmd?event.ctrlKey:event.metaKey)&&base!="Cmd"){name="Cmd-"+name;}if(!noShift&&event.shiftKey&&base!="Shift"){name="Shift-"+name;}return name;}function getKeyMap(val){return typeof val=="string"?keyMap[val]:val;}// Helper for deleting text near the selection(s), used to implement\n// backspace, delete, and similar functionality.\nfunction deleteNearSelection(cm,compute){var ranges=cm.doc.sel.ranges,kill=[];// Build up a set of ranges to kill first, merging overlapping\n// ranges.\nfor(var i=0;i<ranges.length;i++){var toKill=compute(ranges[i]);while(kill.length&&cmp(toKill.from,lst(kill).to)<=0){var replaced=kill.pop();if(cmp(replaced.from,toKill.from)<0){toKill.from=replaced.from;break;}}kill.push(toKill);}// Next, remove those actual ranges.\nrunInOp(cm,function(){for(var i=kill.length-1;i>=0;i--){replaceRange(cm.doc,"",kill[i].from,kill[i].to,"+delete");}ensureCursorVisible(cm);});}// Commands are parameter-less actions that can be performed on an\n// editor, mostly used for keybindings.\nvar commands={selectAll:selectAll,singleSelection:function(cm){return cm.setSelection(cm.getCursor("anchor"),cm.getCursor("head"),sel_dontScroll);},killLine:function(cm){return deleteNearSelection(cm,function(range){if(range.empty()){var len=getLine(cm.doc,range.head.line).text.length;if(range.head.ch==len&&range.head.line<cm.lastLine()){return{from:range.head,to:Pos(range.head.line+1,0)};}else{return{from:range.head,to:Pos(range.head.line,len)};}}else{return{from:range.from(),to:range.to()};}});},deleteLine:function(cm){return deleteNearSelection(cm,function(range){return{from:Pos(range.from().line,0),to:clipPos(cm.doc,Pos(range.to().line+1,0))};});},delLineLeft:function(cm){return deleteNearSelection(cm,function(range){return{from:Pos(range.from().line,0),to:range.from()};});},delWrappedLineLeft:function(cm){return deleteNearSelection(cm,function(range){var top=cm.charCoords(range.head,"div").top+5;var leftPos=cm.coordsChar({left:0,top:top},"div");return{from:leftPos,to:range.from()};});},delWrappedLineRight:function(cm){return deleteNearSelection(cm,function(range){var top=cm.charCoords(range.head,"div").top+5;var rightPos=cm.coordsChar({left:cm.display.lineDiv.offsetWidth+100,top:top},"div");return{from:range.from(),to:rightPos};});},undo:function(cm){return cm.undo();},redo:function(cm){return cm.redo();},undoSelection:function(cm){return cm.undoSelection();},redoSelection:function(cm){return cm.redoSelection();},goDocStart:function(cm){return cm.extendSelection(Pos(cm.firstLine(),0));},goDocEnd:function(cm){return cm.extendSelection(Pos(cm.lastLine()));},goLineStart:function(cm){return cm.extendSelectionsBy(function(range){return lineStart(cm,range.head.line);},{origin:"+move",bias:1});},goLineStartSmart:function(cm){return cm.extendSelectionsBy(function(range){return lineStartSmart(cm,range.head);},{origin:"+move",bias:1});},goLineEnd:function(cm){return cm.extendSelectionsBy(function(range){return lineEnd(cm,range.head.line);},{origin:"+move",bias:-1});},goLineRight:function(cm){return cm.extendSelectionsBy(function(range){var top=cm.charCoords(range.head,"div").top+5;return cm.coordsChar({left:cm.display.lineDiv.offsetWidth+100,top:top},"div");},sel_move);},goLineLeft:function(cm){return cm.extendSelectionsBy(function(range){var top=cm.charCoords(range.head,"div").top+5;return cm.coordsChar({left:0,top:top},"div");},sel_move);},goLineLeftSmart:function(cm){return cm.extendSelectionsBy(function(range){var top=cm.charCoords(range.head,"div").top+5;var pos=cm.coordsChar({left:0,top:top},"div");if(pos.ch<cm.getLine(pos.line).search(/\\S/)){return lineStartSmart(cm,range.head);}return pos;},sel_move);},goLineUp:function(cm){return cm.moveV(-1,"line");},goLineDown:function(cm){return cm.moveV(1,"line");},goPageUp:function(cm){return cm.moveV(-1,"page");},goPageDown:function(cm){return cm.moveV(1,"page");},goCharLeft:function(cm){return cm.moveH(-1,"char");},goCharRight:function(cm){return cm.moveH(1,"char");},goColumnLeft:function(cm){return cm.moveH(-1,"column");},goColumnRight:function(cm){return cm.moveH(1,"column");},goWordLeft:function(cm){return cm.moveH(-1,"word");},goGroupRight:function(cm){return cm.moveH(1,"group");},goGroupLeft:function(cm){return cm.moveH(-1,"group");},goWordRight:function(cm){return cm.moveH(1,"word");},delCharBefore:function(cm){return cm.deleteH(-1,"char");},delCharAfter:function(cm){return cm.deleteH(1,"char");},delWordBefore:function(cm){return cm.deleteH(-1,"word");},delWordAfter:function(cm){return cm.deleteH(1,"word");},delGroupBefore:function(cm){return cm.deleteH(-1,"group");},delGroupAfter:function(cm){return cm.deleteH(1,"group");},indentAuto:function(cm){return cm.indentSelection("smart");},indentMore:function(cm){return cm.indentSelection("add");},indentLess:function(cm){return cm.indentSelection("subtract");},insertTab:function(cm){return cm.replaceSelection("\\t");},insertSoftTab:function(cm){var spaces=[],ranges=cm.listSelections(),tabSize=cm.options.tabSize;for(var i=0;i<ranges.length;i++){var pos=ranges[i].from();var col=countColumn(cm.getLine(pos.line),pos.ch,tabSize);spaces.push(spaceStr(tabSize-col%tabSize));}cm.replaceSelections(spaces);},defaultTab:function(cm){if(cm.somethingSelected()){cm.indentSelection("add");}else{cm.execCommand("insertTab");}},// Swap the two chars left and right of each selection\'s head.\n// Move cursor behind the two swapped characters afterwards.\n//\n// Doesn\'t consider line feeds a character.\n// Doesn\'t scan more than one line above to find a character.\n// Doesn\'t do anything on an empty line.\n// Doesn\'t do anything with non-empty selections.\ntransposeChars:function(cm){return runInOp(cm,function(){var ranges=cm.listSelections(),newSel=[];for(var i=0;i<ranges.length;i++){if(!ranges[i].empty()){continue;}var cur=ranges[i].head,line=getLine(cm.doc,cur.line).text;if(line){if(cur.ch==line.length){cur=new Pos(cur.line,cur.ch-1);}if(cur.ch>0){cur=new Pos(cur.line,cur.ch+1);cm.replaceRange(line.charAt(cur.ch-1)+line.charAt(cur.ch-2),Pos(cur.line,cur.ch-2),cur,"+transpose");}else if(cur.line>cm.doc.first){var prev=getLine(cm.doc,cur.line-1).text;if(prev){cur=new Pos(cur.line,1);cm.replaceRange(line.charAt(0)+cm.doc.lineSeparator()+prev.charAt(prev.length-1),Pos(cur.line-1,prev.length-1),cur,"+transpose");}}}newSel.push(new Range(cur,cur));}cm.setSelections(newSel);});},newlineAndIndent:function(cm){return runInOp(cm,function(){var sels=cm.listSelections();for(var i=sels.length-1;i>=0;i--){cm.replaceRange(cm.doc.lineSeparator(),sels[i].anchor,sels[i].head,"+input");}sels=cm.listSelections();for(var i$1=0;i$1<sels.length;i$1++){cm.indentLine(sels[i$1].from().line,null,true);}ensureCursorVisible(cm);});},openLine:function(cm){return cm.replaceSelection("\\n","start");},toggleOverwrite:function(cm){return cm.toggleOverwrite();}};function lineStart(cm,lineN){var line=getLine(cm.doc,lineN);var visual=visualLine(line);if(visual!=line){lineN=lineNo(visual);}var order=getOrder(visual);var ch=!order?0:order[0].level%2?lineRight(visual):lineLeft(visual);return Pos(lineN,ch);}function lineEnd(cm,lineN){var merged,line=getLine(cm.doc,lineN);while(merged=collapsedSpanAtEnd(line)){line=merged.find(1,true).line;lineN=null;}var order=getOrder(line);var ch=!order?line.text.length:order[0].level%2?lineLeft(line):lineRight(line);return Pos(lineN==null?lineNo(line):lineN,ch);}function lineStartSmart(cm,pos){var start=lineStart(cm,pos.line);var line=getLine(cm.doc,start.line);var order=getOrder(line);if(!order||order[0].level==0){var firstNonWS=Math.max(0,line.text.search(/\\S/));var inWS=pos.line==start.line&&pos.ch<=firstNonWS&&pos.ch;return Pos(start.line,inWS?0:firstNonWS);}return start;}// Run a handler that was bound to a key.\nfunction doHandleBinding(cm,bound,dropShift){if(typeof bound=="string"){bound=commands[bound];if(!bound){return false;}}// Ensure previous input has been read, so that the handler sees a\n// consistent view of the document\ncm.display.input.ensurePolled();var prevShift=cm.display.shift,done=false;try{if(cm.isReadOnly()){cm.state.suppressEdits=true;}if(dropShift){cm.display.shift=false;}done=bound(cm)!=Pass;}finally{cm.display.shift=prevShift;cm.state.suppressEdits=false;}return done;}function lookupKeyForEditor(cm,name,handle){for(var i=0;i<cm.state.keyMaps.length;i++){var result=lookupKey(name,cm.state.keyMaps[i],handle,cm);if(result){return result;}}return cm.options.extraKeys&&lookupKey(name,cm.options.extraKeys,handle,cm)||lookupKey(name,cm.options.keyMap,handle,cm);}var stopSeq=new Delayed();function dispatchKey(cm,name,e,handle){var seq=cm.state.keySeq;if(seq){if(isModifierKey(name)){return"handled";}stopSeq.set(50,function(){if(cm.state.keySeq==seq){cm.state.keySeq=null;cm.display.input.reset();}});name=seq+" "+name;}var result=lookupKeyForEditor(cm,name,handle);if(result=="multi"){cm.state.keySeq=name;}if(result=="handled"){signalLater(cm,"keyHandled",cm,name,e);}if(result=="handled"||result=="multi"){e_preventDefault(e);restartBlink(cm);}if(seq&&!result&&/\\\'$/.test(name)){e_preventDefault(e);return true;}return!!result;}// Handle a key from the keydown event.\nfunction handleKeyBinding(cm,e){var name=keyName(e,true);if(!name){return false;}if(e.shiftKey&&!cm.state.keySeq){// First try to resolve full name (including \'Shift-\'). Failing\n// that, see if there is a cursor-motion command (starting with\n// \'go\') bound to the keyname without \'Shift-\'.\nreturn dispatchKey(cm,"Shift-"+name,e,function(b){return doHandleBinding(cm,b,true);})||dispatchKey(cm,name,e,function(b){if(typeof b=="string"?/^go[A-Z]/.test(b):b.motion){return doHandleBinding(cm,b);}});}else{return dispatchKey(cm,name,e,function(b){return doHandleBinding(cm,b);});}}// Handle a key from the keypress event\nfunction handleCharBinding(cm,e,ch){return dispatchKey(cm,"\'"+ch+"\'",e,function(b){return doHandleBinding(cm,b,true);});}var lastStoppedKey=null;function onKeyDown(e){var cm=this;cm.curOp.focus=activeElt();if(signalDOMEvent(cm,e)){return;}// IE does strange things with escape.\nif(ie&&ie_version<11&&e.keyCode==27){e.returnValue=false;}var code=e.keyCode;cm.display.shift=code==16||e.shiftKey;var handled=handleKeyBinding(cm,e);if(presto){lastStoppedKey=handled?code:null;// Opera has no cut event... we try to at least catch the key combo\nif(!handled&&code==88&&!hasCopyEvent&&(mac?e.metaKey:e.ctrlKey)){cm.replaceSelection("",null,"cut");}}// Turn mouse into crosshair when Alt is held on Mac.\nif(code==18&&!/\\bCodeMirror-crosshair\\b/.test(cm.display.lineDiv.className)){showCrossHair(cm);}}function showCrossHair(cm){var lineDiv=cm.display.lineDiv;addClass(lineDiv,"CodeMirror-crosshair");function up(e){if(e.keyCode==18||!e.altKey){rmClass(lineDiv,"CodeMirror-crosshair");off(document,"keyup",up);off(document,"mouseover",up);}}on(document,"keyup",up);on(document,"mouseover",up);}function onKeyUp(e){if(e.keyCode==16){this.doc.sel.shift=false;}signalDOMEvent(this,e);}function onKeyPress(e){var cm=this;if(eventInWidget(cm.display,e)||signalDOMEvent(cm,e)||e.ctrlKey&&!e.altKey||mac&&e.metaKey){return;}var keyCode=e.keyCode,charCode=e.charCode;if(presto&&keyCode==lastStoppedKey){lastStoppedKey=null;e_preventDefault(e);return;}if(presto&&(!e.which||e.which<10)&&handleKeyBinding(cm,e)){return;}var ch=String.fromCharCode(charCode==null?keyCode:charCode);// Some browsers fire keypress events for backspace\nif(ch=="\\x08"){return;}if(handleCharBinding(cm,e,ch)){return;}cm.display.input.onKeyPress(e);}// A mouse down can be a single click, double click, triple click,\n// start of selection drag, start of text drag, new cursor\n// (ctrl-click), rectangle drag (alt-drag), or xwin\n// middle-click-paste. Or it might be a click on something we should\n// not interfere with, such as a scrollbar or widget.\nfunction onMouseDown(e){var cm=this,display=cm.display;if(signalDOMEvent(cm,e)||display.activeTouch&&display.input.supportsTouch()){return;}display.shift=e.shiftKey;if(eventInWidget(display,e)){if(!webkit){// Briefly turn off draggability, to allow widgets to do\n// normal dragging things.\ndisplay.scroller.draggable=false;setTimeout(function(){return display.scroller.draggable=true;},100);}return;}if(clickInGutter(cm,e)){return;}var start=posFromMouse(cm,e);window.focus();switch(e_button(e)){case 1:// #3261: make sure, that we\'re not starting a second selection\nif(cm.state.selectingText){cm.state.selectingText(e);}else if(start){leftButtonDown(cm,e,start);}else if(e_target(e)==display.scroller){e_preventDefault(e);}break;case 2:if(webkit){cm.state.lastMiddleDown=+new Date();}if(start){extendSelection(cm.doc,start);}setTimeout(function(){return display.input.focus();},20);e_preventDefault(e);break;case 3:if(captureRightClick){onContextMenu(cm,e);}else{delayBlurEvent(cm);}break;}}var lastClick;var lastDoubleClick;function leftButtonDown(cm,e,start){if(ie){setTimeout(bind(ensureFocus,cm),0);}else{cm.curOp.focus=activeElt();}var now=+new Date(),type;if(lastDoubleClick&&lastDoubleClick.time>now-400&&cmp(lastDoubleClick.pos,start)==0){type="triple";}else if(lastClick&&lastClick.time>now-400&&cmp(lastClick.pos,start)==0){type="double";lastDoubleClick={time:now,pos:start};}else{type="single";lastClick={time:now,pos:start};}var sel=cm.doc.sel,modifier=mac?e.metaKey:e.ctrlKey,contained;if(cm.options.dragDrop&&dragAndDrop&&!cm.isReadOnly()&&type=="single"&&(contained=sel.contains(start))>-1&&(cmp((contained=sel.ranges[contained]).from(),start)<0||start.xRel>0)&&(cmp(contained.to(),start)>0||start.xRel<0)){leftButtonStartDrag(cm,e,start,modifier);}else{leftButtonSelect(cm,e,start,type,modifier);}}// Start a text drag. When it ends, see if any dragging actually\n// happen, and treat as a click if it didn\'t.\nfunction leftButtonStartDrag(cm,e,start,modifier){var display=cm.display,startTime=+new Date();var dragEnd=operation(cm,function(e2){if(webkit){display.scroller.draggable=false;}cm.state.draggingText=false;off(document,"mouseup",dragEnd);off(display.scroller,"drop",dragEnd);if(Math.abs(e.clientX-e2.clientX)+Math.abs(e.clientY-e2.clientY)<10){e_preventDefault(e2);if(!modifier&&+new Date()-200<startTime){extendSelection(cm.doc,start);}// Work around unexplainable focus problem in IE9 (#2127) and Chrome (#3081)\nif(webkit||ie&&ie_version==9){setTimeout(function(){document.body.focus();display.input.focus();},20);}else{display.input.focus();}}});// Let the drag handler handle this.\nif(webkit){display.scroller.draggable=true;}cm.state.draggingText=dragEnd;dragEnd.copy=mac?e.altKey:e.ctrlKey;// IE\'s approach to draggable\nif(display.scroller.dragDrop){display.scroller.dragDrop();}on(document,"mouseup",dragEnd);on(display.scroller,"drop",dragEnd);}// Normal selection, as opposed to text dragging.\nfunction leftButtonSelect(cm,e,start,type,addNew){var display=cm.display,doc=cm.doc;e_preventDefault(e);var ourRange,ourIndex,startSel=doc.sel,ranges=startSel.ranges;if(addNew&&!e.shiftKey){ourIndex=doc.sel.contains(start);if(ourIndex>-1){ourRange=ranges[ourIndex];}else{ourRange=new Range(start,start);}}else{ourRange=doc.sel.primary();ourIndex=doc.sel.primIndex;}if(chromeOS?e.shiftKey&&e.metaKey:e.altKey){type="rect";if(!addNew){ourRange=new Range(start,start);}start=posFromMouse(cm,e,true,true);ourIndex=-1;}else if(type=="double"){var word=cm.findWordAt(start);if(cm.display.shift||doc.extend){ourRange=extendRange(doc,ourRange,word.anchor,word.head);}else{ourRange=word;}}else if(type=="triple"){var line=new Range(Pos(start.line,0),clipPos(doc,Pos(start.line+1,0)));if(cm.display.shift||doc.extend){ourRange=extendRange(doc,ourRange,line.anchor,line.head);}else{ourRange=line;}}else{ourRange=extendRange(doc,ourRange,start);}if(!addNew){ourIndex=0;setSelection(doc,new Selection([ourRange],0),sel_mouse);startSel=doc.sel;}else if(ourIndex==-1){ourIndex=ranges.length;setSelection(doc,normalizeSelection(ranges.concat([ourRange]),ourIndex),{scroll:false,origin:"*mouse"});}else if(ranges.length>1&&ranges[ourIndex].empty()&&type=="single"&&!e.shiftKey){setSelection(doc,normalizeSelection(ranges.slice(0,ourIndex).concat(ranges.slice(ourIndex+1)),0),{scroll:false,origin:"*mouse"});startSel=doc.sel;}else{replaceOneSelection(doc,ourIndex,ourRange,sel_mouse);}var lastPos=start;function extendTo(pos){if(cmp(lastPos,pos)==0){return;}lastPos=pos;if(type=="rect"){var ranges=[],tabSize=cm.options.tabSize;var startCol=countColumn(getLine(doc,start.line).text,start.ch,tabSize);var posCol=countColumn(getLine(doc,pos.line).text,pos.ch,tabSize);var left=Math.min(startCol,posCol),right=Math.max(startCol,posCol);for(var line=Math.min(start.line,pos.line),end=Math.min(cm.lastLine(),Math.max(start.line,pos.line));line<=end;line++){var text=getLine(doc,line).text,leftPos=findColumn(text,left,tabSize);if(left==right){ranges.push(new Range(Pos(line,leftPos),Pos(line,leftPos)));}else if(text.length>leftPos){ranges.push(new Range(Pos(line,leftPos),Pos(line,findColumn(text,right,tabSize))));}}if(!ranges.length){ranges.push(new Range(start,start));}setSelection(doc,normalizeSelection(startSel.ranges.slice(0,ourIndex).concat(ranges),ourIndex),{origin:"*mouse",scroll:false});cm.scrollIntoView(pos);}else{var oldRange=ourRange;var anchor=oldRange.anchor,head=pos;if(type!="single"){var range;if(type=="double"){range=cm.findWordAt(pos);}else{range=new Range(Pos(pos.line,0),clipPos(doc,Pos(pos.line+1,0)));}if(cmp(range.anchor,anchor)>0){head=range.head;anchor=minPos(oldRange.from(),range.anchor);}else{head=range.anchor;anchor=maxPos(oldRange.to(),range.head);}}var ranges$1=startSel.ranges.slice(0);ranges$1[ourIndex]=new Range(clipPos(doc,anchor),head);setSelection(doc,normalizeSelection(ranges$1,ourIndex),sel_mouse);}}var editorSize=display.wrapper.getBoundingClientRect();// Used to ensure timeout re-tries don\'t fire when another extend\n// happened in the meantime (clearTimeout isn\'t reliable -- at\n// least on Chrome, the timeouts still happen even when cleared,\n// if the clear happens after their scheduled firing time).\nvar counter=0;function extend(e){var curCount=++counter;var cur=posFromMouse(cm,e,true,type=="rect");if(!cur){return;}if(cmp(cur,lastPos)!=0){cm.curOp.focus=activeElt();extendTo(cur);var visible=visibleLines(display,doc);if(cur.line>=visible.to||cur.line<visible.from){setTimeout(operation(cm,function(){if(counter==curCount){extend(e);}}),150);}}else{var outside=e.clientY<editorSize.top?-20:e.clientY>editorSize.bottom?20:0;if(outside){setTimeout(operation(cm,function(){if(counter!=curCount){return;}display.scroller.scrollTop+=outside;extend(e);}),50);}}}function done(e){cm.state.selectingText=false;counter=Infinity;e_preventDefault(e);display.input.focus();off(document,"mousemove",move);off(document,"mouseup",up);doc.history.lastSelOrigin=null;}var move=operation(cm,function(e){if(!e_button(e)){done(e);}else{extend(e);}});var up=operation(cm,done);cm.state.selectingText=up;on(document,"mousemove",move);on(document,"mouseup",up);}// Determines whether an event happened in the gutter, and fires the\n// handlers for the corresponding event.\nfunction gutterEvent(cm,e,type,prevent){var mX,mY;try{mX=e.clientX;mY=e.clientY;}catch(e){return false;}if(mX>=Math.floor(cm.display.gutters.getBoundingClientRect().right)){return false;}if(prevent){e_preventDefault(e);}var display=cm.display;var lineBox=display.lineDiv.getBoundingClientRect();if(mY>lineBox.bottom||!hasHandler(cm,type)){return e_defaultPrevented(e);}mY-=lineBox.top-display.viewOffset;for(var i=0;i<cm.options.gutters.length;++i){var g=display.gutters.childNodes[i];if(g&&g.getBoundingClientRect().right>=mX){var line=lineAtHeight(cm.doc,mY);var gutter=cm.options.gutters[i];signal(cm,type,cm,line,gutter,e);return e_defaultPrevented(e);}}}function clickInGutter(cm,e){return gutterEvent(cm,e,"gutterClick",true);}// CONTEXT MENU HANDLING\n// To make the context menu work, we need to briefly unhide the\n// textarea (making it as unobtrusive as possible) to let the\n// right-click take effect on it.\nfunction onContextMenu(cm,e){if(eventInWidget(cm.display,e)||contextMenuInGutter(cm,e)){return;}if(signalDOMEvent(cm,e,"contextmenu")){return;}cm.display.input.onContextMenu(e);}function contextMenuInGutter(cm,e){if(!hasHandler(cm,"gutterContextMenu")){return false;}return gutterEvent(cm,e,"gutterContextMenu",false);}function themeChanged(cm){cm.display.wrapper.className=cm.display.wrapper.className.replace(/\\s*cm-s-\\S+/g,"")+cm.options.theme.replace(/(^|\\s)\\s*/g," cm-s-");clearCaches(cm);}var Init={toString:function(){return"CodeMirror.Init";}};var defaults={};var optionHandlers={};function defineOptions(CodeMirror){var optionHandlers=CodeMirror.optionHandlers;function option(name,deflt,handle,notOnInit){CodeMirror.defaults[name]=deflt;if(handle){optionHandlers[name]=notOnInit?function(cm,val,old){if(old!=Init){handle(cm,val,old);}}:handle;}}CodeMirror.defineOption=option;// Passed to option handlers when there is no old value.\nCodeMirror.Init=Init;// These two are, on init, called from the constructor because they\n// have to be initialized before the editor can start at all.\noption("value","",function(cm,val){return cm.setValue(val);},true);option("mode",null,function(cm,val){cm.doc.modeOption=val;loadMode(cm);},true);option("indentUnit",2,loadMode,true);option("indentWithTabs",false);option("smartIndent",true);option("tabSize",4,function(cm){resetModeState(cm);clearCaches(cm);regChange(cm);},true);option("lineSeparator",null,function(cm,val){cm.doc.lineSep=val;if(!val){return;}var newBreaks=[],lineNo=cm.doc.first;cm.doc.iter(function(line){for(var pos=0;;){var found=line.text.indexOf(val,pos);if(found==-1){break;}pos=found+val.length;newBreaks.push(Pos(lineNo,found));}lineNo++;});for(var i=newBreaks.length-1;i>=0;i--){replaceRange(cm.doc,val,newBreaks[i],Pos(newBreaks[i].line,newBreaks[i].ch+val.length));}});option("specialChars",/[\\u0000-\\u001f\\u007f\\u00ad\\u200b-\\u200f\\u2028\\u2029\\ufeff]/g,function(cm,val,old){cm.state.specialChars=new RegExp(val.source+(val.test("\\t")?"":"|\\t"),"g");if(old!=Init){cm.refresh();}});option("specialCharPlaceholder",defaultSpecialCharPlaceholder,function(cm){return cm.refresh();},true);option("electricChars",true);option("inputStyle",mobile?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor");// FIXME\n},true);option("spellcheck",false,function(cm,val){return cm.getInputField().spellcheck=val;},true);option("rtlMoveVisually",!windows);option("wholeLineUpdateBefore",true);option("theme","default",function(cm){themeChanged(cm);guttersChanged(cm);},true);option("keyMap","default",function(cm,val,old){var next=getKeyMap(val);var prev=old!=Init&&getKeyMap(old);if(prev&&prev.detach){prev.detach(cm,next);}if(next.attach){next.attach(cm,prev||null);}});option("extraKeys",null);option("lineWrapping",false,wrappingChanged,true);option("gutters",[],function(cm){setGuttersForLineNumbers(cm.options);guttersChanged(cm);},true);option("fixedGutter",true,function(cm,val){cm.display.gutters.style.left=val?compensateForHScroll(cm.display)+"px":"0";cm.refresh();},true);option("coverGutterNextToScrollbar",false,function(cm){return updateScrollbars(cm);},true);option("scrollbarStyle","native",function(cm){initScrollbars(cm);updateScrollbars(cm);cm.display.scrollbars.setScrollTop(cm.doc.scrollTop);cm.display.scrollbars.setScrollLeft(cm.doc.scrollLeft);},true);option("lineNumbers",false,function(cm){setGuttersForLineNumbers(cm.options);guttersChanged(cm);},true);option("firstLineNumber",1,guttersChanged,true);option("lineNumberFormatter",function(integer){return integer;},guttersChanged,true);option("showCursorWhenSelecting",false,updateSelection,true);option("resetSelectionOnContextMenu",true);option("lineWiseCopyCut",true);option("readOnly",false,function(cm,val){if(val=="nocursor"){onBlur(cm);cm.display.input.blur();cm.display.disabled=true;}else{cm.display.disabled=false;}cm.display.input.readOnlyChanged(val);});option("disableInput",false,function(cm,val){if(!val){cm.display.input.reset();}},true);option("dragDrop",true,dragDropChanged);option("allowDropFileTypes",null);option("cursorBlinkRate",530);option("cursorScrollMargin",0);option("cursorHeight",1,updateSelection,true);option("singleCursorHeightPerLine",true,updateSelection,true);option("workTime",100);option("workDelay",100);option("flattenSpans",true,resetModeState,true);option("addModeClass",false,resetModeState,true);option("pollInterval",100);option("undoDepth",200,function(cm,val){return cm.doc.history.undoDepth=val;});option("historyEventDelay",1250);option("viewportMargin",10,function(cm){return cm.refresh();},true);option("maxHighlightLength",10000,resetModeState,true);option("moveInputWithCursor",true,function(cm,val){if(!val){cm.display.input.resetPosition();}});option("tabindex",null,function(cm,val){return cm.display.input.getField().tabIndex=val||"";});option("autofocus",null);}function guttersChanged(cm){updateGutters(cm);regChange(cm);setTimeout(function(){return alignHorizontally(cm);},20);}function dragDropChanged(cm,value,old){var wasOn=old&&old!=Init;if(!value!=!wasOn){var funcs=cm.display.dragFunctions;var toggle=value?on:off;toggle(cm.display.scroller,"dragstart",funcs.start);toggle(cm.display.scroller,"dragenter",funcs.enter);toggle(cm.display.scroller,"dragover",funcs.over);toggle(cm.display.scroller,"dragleave",funcs.leave);toggle(cm.display.scroller,"drop",funcs.drop);}}function wrappingChanged(cm){if(cm.options.lineWrapping){addClass(cm.display.wrapper,"CodeMirror-wrap");cm.display.sizer.style.minWidth="";cm.display.sizerWidth=null;}else{rmClass(cm.display.wrapper,"CodeMirror-wrap");findMaxLine(cm);}estimateLineHeights(cm);regChange(cm);clearCaches(cm);setTimeout(function(){return updateScrollbars(cm);},100);}// A CodeMirror instance represents an editor. This is the object\n// that user code is usually dealing with.\nfunction CodeMirror(place,options){var this$1=this;if(!(this instanceof CodeMirror)){return new CodeMirror(place,options);}this.options=options=options?copyObj(options):{};// Determine effective options based on given values and defaults.\ncopyObj(defaults,options,false);setGuttersForLineNumbers(options);var doc=options.value;if(typeof doc=="string"){doc=new Doc(doc,options.mode,null,options.lineSeparator);}this.doc=doc;var input=new CodeMirror.inputStyles[options.inputStyle](this);var display=this.display=new Display(place,doc,input);display.wrapper.CodeMirror=this;updateGutters(this);themeChanged(this);if(options.lineWrapping){this.display.wrapper.className+=" CodeMirror-wrap";}if(options.autofocus&&!mobile){display.input.focus();}initScrollbars(this);this.state={keyMaps:[],// stores maps added by addKeyMap\noverlays:[],// highlighting overlays, as added by addOverlay\nmodeGen:0,// bumped when mode/overlay changes, used to invalidate highlighting info\noverwrite:false,delayingBlurEvent:false,focused:false,suppressEdits:false,// used to disable editing during key handlers when in readOnly mode\npasteIncoming:false,cutIncoming:false,// help recognize paste/cut edits in input.poll\nselectingText:false,draggingText:false,highlight:new Delayed(),// stores highlight worker timeout\nkeySeq:null,// Unfinished key sequence\nspecialChars:null};// Override magic textarea content restore that IE sometimes does\n// on our hidden textarea on reload\nif(ie&&ie_version<11){setTimeout(function(){return this$1.display.input.reset(true);},20);}registerEventHandlers(this);ensureGlobalHandlers();startOperation(this);this.curOp.forceUpdate=true;attachDoc(this,doc);if(options.autofocus&&!mobile||this.hasFocus()){setTimeout(bind(onFocus,this),20);}else{onBlur(this);}for(var opt in optionHandlers){if(optionHandlers.hasOwnProperty(opt)){optionHandlers[opt](this$1,options[opt],Init);}}maybeUpdateLineNumberWidth(this);if(options.finishInit){options.finishInit(this);}for(var i=0;i<initHooks.length;++i){initHooks[i](this$1);}endOperation(this);// Suppress optimizelegibility in Webkit, since it breaks text\n// measuring on line wrapping boundaries.\nif(webkit&&options.lineWrapping&&getComputedStyle(display.lineDiv).textRendering=="optimizelegibility"){display.lineDiv.style.textRendering="auto";}}// The default configuration options.\nCodeMirror.defaults=defaults;// Functions to run when options are changed.\nCodeMirror.optionHandlers=optionHandlers;// Attach the necessary event handlers when initializing the editor\nfunction registerEventHandlers(cm){var d=cm.display;on(d.scroller,"mousedown",operation(cm,onMouseDown));// Older IE\'s will not fire a second mousedown for a double click\nif(ie&&ie_version<11){on(d.scroller,"dblclick",operation(cm,function(e){if(signalDOMEvent(cm,e)){return;}var pos=posFromMouse(cm,e);if(!pos||clickInGutter(cm,e)||eventInWidget(cm.display,e)){return;}e_preventDefault(e);var word=cm.findWordAt(pos);extendSelection(cm.doc,word.anchor,word.head);}));}else{on(d.scroller,"dblclick",function(e){return signalDOMEvent(cm,e)||e_preventDefault(e);});}// Some browsers fire contextmenu *after* opening the menu, at\n// which point we can\'t mess with it anymore. Context menu is\n// handled in onMouseDown for these browsers.\nif(!captureRightClick){on(d.scroller,"contextmenu",function(e){return onContextMenu(cm,e);});}// Used to suppress mouse event handling when a touch happens\nvar touchFinished,prevTouch={end:0};function finishTouch(){if(d.activeTouch){touchFinished=setTimeout(function(){return d.activeTouch=null;},1000);prevTouch=d.activeTouch;prevTouch.end=+new Date();}}function isMouseLikeTouchEvent(e){if(e.touches.length!=1){return false;}var touch=e.touches[0];return touch.radiusX<=1&&touch.radiusY<=1;}function farAway(touch,other){if(other.left==null){return true;}var dx=other.left-touch.left,dy=other.top-touch.top;return dx*dx+dy*dy>20*20;}on(d.scroller,"touchstart",function(e){if(!signalDOMEvent(cm,e)&&!isMouseLikeTouchEvent(e)){clearTimeout(touchFinished);var now=+new Date();d.activeTouch={start:now,moved:false,prev:now-prevTouch.end<=300?prevTouch:null};if(e.touches.length==1){d.activeTouch.left=e.touches[0].pageX;d.activeTouch.top=e.touches[0].pageY;}}});on(d.scroller,"touchmove",function(){if(d.activeTouch){d.activeTouch.moved=true;}});on(d.scroller,"touchend",function(e){var touch=d.activeTouch;if(touch&&!eventInWidget(d,e)&&touch.left!=null&&!touch.moved&&new Date()-touch.start<300){var pos=cm.coordsChar(d.activeTouch,"page"),range;if(!touch.prev||farAway(touch,touch.prev))// Single tap\n{range=new Range(pos,pos);}else if(!touch.prev.prev||farAway(touch,touch.prev.prev))// Double tap\n{range=cm.findWordAt(pos);}else// Triple tap\n{range=new Range(Pos(pos.line,0),clipPos(cm.doc,Pos(pos.line+1,0)));}cm.setSelection(range.anchor,range.head);cm.focus();e_preventDefault(e);}finishTouch();});on(d.scroller,"touchcancel",finishTouch);// Sync scrolling between fake scrollbars and real scrollable\n// area, ensure viewport is updated when scrolling.\non(d.scroller,"scroll",function(){if(d.scroller.clientHeight){setScrollTop(cm,d.scroller.scrollTop);setScrollLeft(cm,d.scroller.scrollLeft,true);signal(cm,"scroll",cm);}});// Listen to wheel events in order to try and update the viewport on time.\non(d.scroller,"mousewheel",function(e){return onScrollWheel(cm,e);});on(d.scroller,"DOMMouseScroll",function(e){return onScrollWheel(cm,e);});// Prevent wrapper from ever scrolling\non(d.wrapper,"scroll",function(){return d.wrapper.scrollTop=d.wrapper.scrollLeft=0;});d.dragFunctions={enter:function(e){if(!signalDOMEvent(cm,e)){e_stop(e);}},over:function(e){if(!signalDOMEvent(cm,e)){onDragOver(cm,e);e_stop(e);}},start:function(e){return onDragStart(cm,e);},drop:operation(cm,onDrop),leave:function(e){if(!signalDOMEvent(cm,e)){clearDragCursor(cm);}}};var inp=d.input.getField();on(inp,"keyup",function(e){return onKeyUp.call(cm,e);});on(inp,"keydown",operation(cm,onKeyDown));on(inp,"keypress",operation(cm,onKeyPress));on(inp,"focus",function(e){return onFocus(cm,e);});on(inp,"blur",function(e){return onBlur(cm,e);});}var initHooks=[];CodeMirror.defineInitHook=function(f){return initHooks.push(f);};// Indent the given line. The how parameter can be "smart",\n// "add"/null, "subtract", or "prev". When aggressive is false\n// (typically set to true for forced single-line indents), empty\n// lines are not indented, and places where the mode returns Pass\n// are left alone.\nfunction indentLine(cm,n,how,aggressive){var doc=cm.doc,state;if(how==null){how="add";}if(how=="smart"){// Fall back to "prev" when the mode doesn\'t have an indentation\n// method.\nif(!doc.mode.indent){how="prev";}else{state=getStateBefore(cm,n);}}var tabSize=cm.options.tabSize;var line=getLine(doc,n),curSpace=countColumn(line.text,null,tabSize);if(line.stateAfter){line.stateAfter=null;}var curSpaceString=line.text.match(/^\\s*/)[0],indentation;if(!aggressive&&!/\\S/.test(line.text)){indentation=0;how="not";}else if(how=="smart"){indentation=doc.mode.indent(state,line.text.slice(curSpaceString.length),line.text);if(indentation==Pass||indentation>150){if(!aggressive){return;}how="prev";}}if(how=="prev"){if(n>doc.first){indentation=countColumn(getLine(doc,n-1).text,null,tabSize);}else{indentation=0;}}else if(how=="add"){indentation=curSpace+cm.options.indentUnit;}else if(how=="subtract"){indentation=curSpace-cm.options.indentUnit;}else if(typeof how=="number"){indentation=curSpace+how;}indentation=Math.max(0,indentation);var indentString="",pos=0;if(cm.options.indentWithTabs){for(var i=Math.floor(indentation/tabSize);i;--i){pos+=tabSize;indentString+="\\t";}}if(pos<indentation){indentString+=spaceStr(indentation-pos);}if(indentString!=curSpaceString){replaceRange(doc,indentString,Pos(n,0),Pos(n,curSpaceString.length),"+input");line.stateAfter=null;return true;}else{// Ensure that, if the cursor was in the whitespace at the start\n// of the line, it is moved to the end of that space.\nfor(var i$1=0;i$1<doc.sel.ranges.length;i$1++){var range=doc.sel.ranges[i$1];if(range.head.line==n&&range.head.ch<curSpaceString.length){var pos$1=Pos(n,curSpaceString.length);replaceOneSelection(doc,i$1,new Range(pos$1,pos$1));break;}}}}// This will be set to a {lineWise: bool, text: [string]} object, so\n// that, when pasting, we know what kind of selections the copied\n// text was made out of.\nvar lastCopied=null;function setLastCopied(newLastCopied){lastCopied=newLastCopied;}function applyTextInput(cm,inserted,deleted,sel,origin){var doc=cm.doc;cm.display.shift=false;if(!sel){sel=doc.sel;}var paste=cm.state.pasteIncoming||origin=="paste";var textLines=splitLinesAuto(inserted),multiPaste=null;// When pasing N lines into N selections, insert one line per selection\nif(paste&&sel.ranges.length>1){if(lastCopied&&lastCopied.text.join("\\n")==inserted){if(sel.ranges.length%lastCopied.text.length==0){multiPaste=[];for(var i=0;i<lastCopied.text.length;i++){multiPaste.push(doc.splitLines(lastCopied.text[i]));}}}else if(textLines.length==sel.ranges.length){multiPaste=map(textLines,function(l){return[l];});}}var updateInput;// Normal behavior is to insert the new text into every selection\nfor(var i$1=sel.ranges.length-1;i$1>=0;i$1--){var range=sel.ranges[i$1];var from=range.from(),to=range.to();if(range.empty()){if(deleted&&deleted>0)// Handle deletion\n{from=Pos(from.line,from.ch-deleted);}else if(cm.state.overwrite&&!paste)// Handle overwrite\n{to=Pos(to.line,Math.min(getLine(doc,to.line).text.length,to.ch+lst(textLines).length));}else if(lastCopied&&lastCopied.lineWise&&lastCopied.text.join("\\n")==inserted){from=to=Pos(from.line,0);}}updateInput=cm.curOp.updateInput;var changeEvent={from:from,to:to,text:multiPaste?multiPaste[i$1%multiPaste.length]:textLines,origin:origin||(paste?"paste":cm.state.cutIncoming?"cut":"+input")};makeChange(cm.doc,changeEvent);signalLater(cm,"inputRead",cm,changeEvent);}if(inserted&&!paste){triggerElectric(cm,inserted);}ensureCursorVisible(cm);cm.curOp.updateInput=updateInput;cm.curOp.typing=true;cm.state.pasteIncoming=cm.state.cutIncoming=false;}function handlePaste(e,cm){var pasted=e.clipboardData&&e.clipboardData.getData("Text");if(pasted){e.preventDefault();if(!cm.isReadOnly()&&!cm.options.disableInput){runInOp(cm,function(){return applyTextInput(cm,pasted,0,null,"paste");});}return true;}}function triggerElectric(cm,inserted){// When an \'electric\' character is inserted, immediately trigger a reindent\nif(!cm.options.electricChars||!cm.options.smartIndent){return;}var sel=cm.doc.sel;for(var i=sel.ranges.length-1;i>=0;i--){var range=sel.ranges[i];if(range.head.ch>100||i&&sel.ranges[i-1].head.line==range.head.line){continue;}var mode=cm.getModeAt(range.head);var indented=false;if(mode.electricChars){for(var j=0;j<mode.electricChars.length;j++){if(inserted.indexOf(mode.electricChars.charAt(j))>-1){indented=indentLine(cm,range.head.line,"smart");break;}}}else if(mode.electricInput){if(mode.electricInput.test(getLine(cm.doc,range.head.line).text.slice(0,range.head.ch))){indented=indentLine(cm,range.head.line,"smart");}}if(indented){signalLater(cm,"electricInput",cm,range.head.line);}}}function copyableRanges(cm){var text=[],ranges=[];for(var i=0;i<cm.doc.sel.ranges.length;i++){var line=cm.doc.sel.ranges[i].head.line;var lineRange={anchor:Pos(line,0),head:Pos(line+1,0)};ranges.push(lineRange);text.push(cm.getRange(lineRange.anchor,lineRange.head));}return{text:text,ranges:ranges};}function disableBrowserMagic(field,spellcheck){field.setAttribute("autocorrect","off");field.setAttribute("autocapitalize","off");field.setAttribute("spellcheck",!!spellcheck);}function hiddenTextarea(){var te=elt("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none");var div=elt("div",[te],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");// The textarea is kept positioned near the cursor to prevent the\n// fact that it\'ll be scrolled into view on input from scrolling\n// our fake cursor out of view. On webkit, when wrap=off, paste is\n// very slow. So make the area wide instead.\nif(webkit){te.style.width="1000px";}else{te.setAttribute("wrap","off");}// If border: 0; -- iOS fails to open keyboard (issue #1287)\nif(ios){te.style.border="1px solid black";}disableBrowserMagic(te);return div;}// The publicly visible API. Note that methodOp(f) means\n// \'wrap f in an operation, performed on its `this` parameter\'.\n// This is not the complete set of editor methods. Most of the\n// methods defined on the Doc type are also injected into\n// CodeMirror.prototype, for backwards compatibility and\n// convenience.\nfunction addEditorMethods(CodeMirror){var optionHandlers=CodeMirror.optionHandlers;var helpers=CodeMirror.helpers={};CodeMirror.prototype={constructor:CodeMirror,focus:function(){window.focus();this.display.input.focus();},setOption:function(option,value){var options=this.options,old=options[option];if(options[option]==value&&option!="mode"){return;}options[option]=value;if(optionHandlers.hasOwnProperty(option)){operation(this,optionHandlers[option])(this,value,old);}},getOption:function(option){return this.options[option];},getDoc:function(){return this.doc;},addKeyMap:function(map,bottom){this.state.keyMaps[bottom?"push":"unshift"](getKeyMap(map));},removeKeyMap:function(map){var maps=this.state.keyMaps;for(var i=0;i<maps.length;++i){if(maps[i]==map||maps[i].name==map){maps.splice(i,1);return true;}}},addOverlay:methodOp(function(spec,options){var mode=spec.token?spec:CodeMirror.getMode(this.options,spec);if(mode.startState){throw new Error("Overlays may not be stateful.");}insertSorted(this.state.overlays,{mode:mode,modeSpec:spec,opaque:options&&options.opaque,priority:options&&options.priority||0},function(overlay){return overlay.priority;});this.state.modeGen++;regChange(this);}),removeOverlay:methodOp(function(spec){var this$1=this;var overlays=this.state.overlays;for(var i=0;i<overlays.length;++i){var cur=overlays[i].modeSpec;if(cur==spec||typeof spec=="string"&&cur.name==spec){overlays.splice(i,1);this$1.state.modeGen++;regChange(this$1);return;}}}),indentLine:methodOp(function(n,dir,aggressive){if(typeof dir!="string"&&typeof dir!="number"){if(dir==null){dir=this.options.smartIndent?"smart":"prev";}else{dir=dir?"add":"subtract";}}if(isLine(this.doc,n)){indentLine(this,n,dir,aggressive);}}),indentSelection:methodOp(function(how){var this$1=this;var ranges=this.doc.sel.ranges,end=-1;for(var i=0;i<ranges.length;i++){var range=ranges[i];if(!range.empty()){var from=range.from(),to=range.to();var start=Math.max(end,from.line);end=Math.min(this$1.lastLine(),to.line-(to.ch?0:1))+1;for(var j=start;j<end;++j){indentLine(this$1,j,how);}var newRanges=this$1.doc.sel.ranges;if(from.ch==0&&ranges.length==newRanges.length&&newRanges[i].from().ch>0){replaceOneSelection(this$1.doc,i,new Range(from,newRanges[i].to()),sel_dontScroll);}}else if(range.head.line>end){indentLine(this$1,range.head.line,how,true);end=range.head.line;if(i==this$1.doc.sel.primIndex){ensureCursorVisible(this$1);}}}}),// Fetch the parser token for a given character. Useful for hacks\n// that want to inspect the mode state (say, for completion).\ngetTokenAt:function(pos,precise){return takeToken(this,pos,precise);},getLineTokens:function(line,precise){return takeToken(this,Pos(line),precise,true);},getTokenTypeAt:function(pos){pos=clipPos(this.doc,pos);var styles=getLineStyles(this,getLine(this.doc,pos.line));var before=0,after=(styles.length-1)/2,ch=pos.ch;var type;if(ch==0){type=styles[2];}else{for(;;){var mid=before+after>>1;if((mid?styles[mid*2-1]:0)>=ch){after=mid;}else if(styles[mid*2+1]<ch){before=mid+1;}else{type=styles[mid*2+2];break;}}}var cut=type?type.indexOf("overlay "):-1;return cut<0?type:cut==0?null:type.slice(0,cut-1);},getModeAt:function(pos){var mode=this.doc.mode;if(!mode.innerMode){return mode;}return CodeMirror.innerMode(mode,this.getTokenAt(pos).state).mode;},getHelper:function(pos,type){return this.getHelpers(pos,type)[0];},getHelpers:function(pos,type){var this$1=this;var found=[];if(!helpers.hasOwnProperty(type)){return found;}var help=helpers[type],mode=this.getModeAt(pos);if(typeof mode[type]=="string"){if(help[mode[type]]){found.push(help[mode[type]]);}}else if(mode[type]){for(var i=0;i<mode[type].length;i++){var val=help[mode[type][i]];if(val){found.push(val);}}}else if(mode.helperType&&help[mode.helperType]){found.push(help[mode.helperType]);}else if(help[mode.name]){found.push(help[mode.name]);}for(var i$1=0;i$1<help._global.length;i$1++){var cur=help._global[i$1];if(cur.pred(mode,this$1)&&indexOf(found,cur.val)==-1){found.push(cur.val);}}return found;},getStateAfter:function(line,precise){var doc=this.doc;line=clipLine(doc,line==null?doc.first+doc.size-1:line);return getStateBefore(this,line+1,precise);},cursorCoords:function(start,mode){var pos,range=this.doc.sel.primary();if(start==null){pos=range.head;}else if(typeof start=="object"){pos=clipPos(this.doc,start);}else{pos=start?range.from():range.to();}return cursorCoords(this,pos,mode||"page");},charCoords:function(pos,mode){return charCoords(this,clipPos(this.doc,pos),mode||"page");},coordsChar:function(coords,mode){coords=fromCoordSystem(this,coords,mode||"page");return coordsChar(this,coords.left,coords.top);},lineAtHeight:function(height,mode){height=fromCoordSystem(this,{top:height,left:0},mode||"page").top;return lineAtHeight(this.doc,height+this.display.viewOffset);},heightAtLine:function(line,mode){var end=false,lineObj;if(typeof line=="number"){var last=this.doc.first+this.doc.size-1;if(line<this.doc.first){line=this.doc.first;}else if(line>last){line=last;end=true;}lineObj=getLine(this.doc,line);}else{lineObj=line;}return intoCoordSystem(this,lineObj,{top:0,left:0},mode||"page").top+(end?this.doc.height-heightAtLine(lineObj):0);},defaultTextHeight:function(){return textHeight(this.display);},defaultCharWidth:function(){return charWidth(this.display);},setGutterMarker:methodOp(function(line,gutterID,value){return changeLine(this.doc,line,"gutter",function(line){var markers=line.gutterMarkers||(line.gutterMarkers={});markers[gutterID]=value;if(!value&&isEmpty(markers)){line.gutterMarkers=null;}return true;});}),clearGutter:methodOp(function(gutterID){var this$1=this;var doc=this.doc,i=doc.first;doc.iter(function(line){if(line.gutterMarkers&&line.gutterMarkers[gutterID]){line.gutterMarkers[gutterID]=null;regLineChange(this$1,i,"gutter");if(isEmpty(line.gutterMarkers)){line.gutterMarkers=null;}}++i;});}),lineInfo:function(line){var n;if(typeof line=="number"){if(!isLine(this.doc,line)){return null;}n=line;line=getLine(this.doc,line);if(!line){return null;}}else{n=lineNo(line);if(n==null){return null;}}return{line:n,handle:line,text:line.text,gutterMarkers:line.gutterMarkers,textClass:line.textClass,bgClass:line.bgClass,wrapClass:line.wrapClass,widgets:line.widgets};},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo};},addWidget:function(pos,node,scroll,vert,horiz){var display=this.display;pos=cursorCoords(this,clipPos(this.doc,pos));var top=pos.bottom,left=pos.left;node.style.position="absolute";node.setAttribute("cm-ignore-events","true");this.display.input.setUneditable(node);display.sizer.appendChild(node);if(vert=="over"){top=pos.top;}else if(vert=="above"||vert=="near"){var vspace=Math.max(display.wrapper.clientHeight,this.doc.height),hspace=Math.max(display.sizer.clientWidth,display.lineSpace.clientWidth);// Default to positioning above (if specified and possible); otherwise default to positioning below\nif((vert==\'above\'||pos.bottom+node.offsetHeight>vspace)&&pos.top>node.offsetHeight){top=pos.top-node.offsetHeight;}else if(pos.bottom+node.offsetHeight<=vspace){top=pos.bottom;}if(left+node.offsetWidth>hspace){left=hspace-node.offsetWidth;}}node.style.top=top+"px";node.style.left=node.style.right="";if(horiz=="right"){left=display.sizer.clientWidth-node.offsetWidth;node.style.right="0px";}else{if(horiz=="left"){left=0;}else if(horiz=="middle"){left=(display.sizer.clientWidth-node.offsetWidth)/2;}node.style.left=left+"px";}if(scroll){scrollIntoView(this,left,top,left+node.offsetWidth,top+node.offsetHeight);}},triggerOnKeyDown:methodOp(onKeyDown),triggerOnKeyPress:methodOp(onKeyPress),triggerOnKeyUp:onKeyUp,execCommand:function(cmd){if(commands.hasOwnProperty(cmd)){return commands[cmd].call(null,this);}},triggerElectric:methodOp(function(text){triggerElectric(this,text);}),findPosH:function(from,amount,unit,visually){var this$1=this;var dir=1;if(amount<0){dir=-1;amount=-amount;}var cur=clipPos(this.doc,from);for(var i=0;i<amount;++i){cur=findPosH(this$1.doc,cur,dir,unit,visually);if(cur.hitSide){break;}}return cur;},moveH:methodOp(function(dir,unit){var this$1=this;this.extendSelectionsBy(function(range){if(this$1.display.shift||this$1.doc.extend||range.empty()){return findPosH(this$1.doc,range.head,dir,unit,this$1.options.rtlMoveVisually);}else{return dir<0?range.from():range.to();}},sel_move);}),deleteH:methodOp(function(dir,unit){var sel=this.doc.sel,doc=this.doc;if(sel.somethingSelected()){doc.replaceSelection("",null,"+delete");}else{deleteNearSelection(this,function(range){var other=findPosH(doc,range.head,dir,unit,false);return dir<0?{from:other,to:range.head}:{from:range.head,to:other};});}}),findPosV:function(from,amount,unit,goalColumn){var this$1=this;var dir=1,x=goalColumn;if(amount<0){dir=-1;amount=-amount;}var cur=clipPos(this.doc,from);for(var i=0;i<amount;++i){var coords=cursorCoords(this$1,cur,"div");if(x==null){x=coords.left;}else{coords.left=x;}cur=findPosV(this$1,coords,dir,unit);if(cur.hitSide){break;}}return cur;},moveV:methodOp(function(dir,unit){var this$1=this;var doc=this.doc,goals=[];var collapse=!this.display.shift&&!doc.extend&&doc.sel.somethingSelected();doc.extendSelectionsBy(function(range){if(collapse){return dir<0?range.from():range.to();}var headPos=cursorCoords(this$1,range.head,"div");if(range.goalColumn!=null){headPos.left=range.goalColumn;}goals.push(headPos.left);var pos=findPosV(this$1,headPos,dir,unit);if(unit=="page"&&range==doc.sel.primary()){addToScrollPos(this$1,null,charCoords(this$1,pos,"div").top-headPos.top);}return pos;},sel_move);if(goals.length){for(var i=0;i<doc.sel.ranges.length;i++){doc.sel.ranges[i].goalColumn=goals[i];}}}),// Find the word at the given position (as returned by coordsChar).\nfindWordAt:function(pos){var doc=this.doc,line=getLine(doc,pos.line).text;var start=pos.ch,end=pos.ch;if(line){var helper=this.getHelper(pos,"wordChars");if((pos.xRel<0||end==line.length)&&start){--start;}else{++end;}var startChar=line.charAt(start);var check=isWordChar(startChar,helper)?function(ch){return isWordChar(ch,helper);}:/\\s/.test(startChar)?function(ch){return /\\s/.test(ch);}:function(ch){return!/\\s/.test(ch)&&!isWordChar(ch);};while(start>0&&check(line.charAt(start-1))){--start;}while(end<line.length&&check(line.charAt(end))){++end;}}return new Range(Pos(pos.line,start),Pos(pos.line,end));},toggleOverwrite:function(value){if(value!=null&&value==this.state.overwrite){return;}if(this.state.overwrite=!this.state.overwrite){addClass(this.display.cursorDiv,"CodeMirror-overwrite");}else{rmClass(this.display.cursorDiv,"CodeMirror-overwrite");}signal(this,"overwriteToggle",this,this.state.overwrite);},hasFocus:function(){return this.display.input.getField()==activeElt();},isReadOnly:function(){return!!(this.options.readOnly||this.doc.cantEdit);},scrollTo:methodOp(function(x,y){if(x!=null||y!=null){resolveScrollToPos(this);}if(x!=null){this.curOp.scrollLeft=x;}if(y!=null){this.curOp.scrollTop=y;}}),getScrollInfo:function(){var scroller=this.display.scroller;return{left:scroller.scrollLeft,top:scroller.scrollTop,height:scroller.scrollHeight-scrollGap(this)-this.display.barHeight,width:scroller.scrollWidth-scrollGap(this)-this.display.barWidth,clientHeight:displayHeight(this),clientWidth:displayWidth(this)};},scrollIntoView:methodOp(function(range,margin){if(range==null){range={from:this.doc.sel.primary().head,to:null};if(margin==null){margin=this.options.cursorScrollMargin;}}else if(typeof range=="number"){range={from:Pos(range,0),to:null};}else if(range.from==null){range={from:range,to:null};}if(!range.to){range.to=range.from;}range.margin=margin||0;if(range.from.line!=null){resolveScrollToPos(this);this.curOp.scrollToPos=range;}else{var sPos=calculateScrollPos(this,Math.min(range.from.left,range.to.left),Math.min(range.from.top,range.to.top)-range.margin,Math.max(range.from.right,range.to.right),Math.max(range.from.bottom,range.to.bottom)+range.margin);this.scrollTo(sPos.scrollLeft,sPos.scrollTop);}}),setSize:methodOp(function(width,height){var this$1=this;var interpret=function(val){return typeof val=="number"||/^\\d+$/.test(String(val))?val+"px":val;};if(width!=null){this.display.wrapper.style.width=interpret(width);}if(height!=null){this.display.wrapper.style.height=interpret(height);}if(this.options.lineWrapping){clearLineMeasurementCache(this);}var lineNo=this.display.viewFrom;this.doc.iter(lineNo,this.display.viewTo,function(line){if(line.widgets){for(var i=0;i<line.widgets.length;i++){if(line.widgets[i].noHScroll){regLineChange(this$1,lineNo,"widget");break;}}}++lineNo;});this.curOp.forceUpdate=true;signal(this,"refresh",this);}),operation:function(f){return runInOp(this,f);},refresh:methodOp(function(){var oldHeight=this.display.cachedTextHeight;regChange(this);this.curOp.forceUpdate=true;clearCaches(this);this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop);updateGutterSpace(this);if(oldHeight==null||Math.abs(oldHeight-textHeight(this.display))>.5){estimateLineHeights(this);}signal(this,"refresh",this);}),swapDoc:methodOp(function(doc){var old=this.doc;old.cm=null;attachDoc(this,doc);clearCaches(this);this.display.input.reset();this.scrollTo(doc.scrollLeft,doc.scrollTop);this.curOp.forceScroll=true;signalLater(this,"swapDoc",this,old);return old;}),getInputField:function(){return this.display.input.getField();},getWrapperElement:function(){return this.display.wrapper;},getScrollerElement:function(){return this.display.scroller;},getGutterElement:function(){return this.display.gutters;}};eventMixin(CodeMirror);CodeMirror.registerHelper=function(type,name,value){if(!helpers.hasOwnProperty(type)){helpers[type]=CodeMirror[type]={_global:[]};}helpers[type][name]=value;};CodeMirror.registerGlobalHelper=function(type,name,predicate,value){CodeMirror.registerHelper(type,name,value);helpers[type]._global.push({pred:predicate,val:value});};}// Used for horizontal relative motion. Dir is -1 or 1 (left or\n// right), unit can be "char", "column" (like char, but doesn\'t\n// cross line boundaries), "word" (across next word), or "group" (to\n// the start of next group of word or non-word-non-whitespace\n// chars). The visually param controls whether, in right-to-left\n// text, direction 1 means to move towards the next index in the\n// string, or towards the character to the right of the current\n// position. The resulting position will have a hitSide=true\n// property if it reached the end of the document.\nfunction findPosH(doc,pos,dir,unit,visually){var line=pos.line,ch=pos.ch,origDir=dir;var lineObj=getLine(doc,line);function findNextLine(){var l=line+dir;if(l<doc.first||l>=doc.first+doc.size){return false;}line=l;return lineObj=getLine(doc,l);}function moveOnce(boundToLine){var next=(visually?moveVisually:moveLogically)(lineObj,ch,dir,true);if(next==null){if(!boundToLine&&findNextLine()){if(visually){ch=(dir<0?lineRight:lineLeft)(lineObj);}else{ch=dir<0?lineObj.text.length:0;}}else{return false;}}else{ch=next;}return true;}if(unit=="char"){moveOnce();}else if(unit=="column"){moveOnce(true);}else if(unit=="word"||unit=="group"){var sawType=null,group=unit=="group";var helper=doc.cm&&doc.cm.getHelper(pos,"wordChars");for(var first=true;;first=false){if(dir<0&&!moveOnce(!first)){break;}var cur=lineObj.text.charAt(ch)||"\\n";var type=isWordChar(cur,helper)?"w":group&&cur=="\\n"?"n":!group||/\\s/.test(cur)?null:"p";if(group&&!first&&!type){type="s";}if(sawType&&sawType!=type){if(dir<0){dir=1;moveOnce();}break;}if(type){sawType=type;}if(dir>0&&!moveOnce(!first)){break;}}}var result=skipAtomic(doc,Pos(line,ch),pos,origDir,true);if(!cmp(pos,result)){result.hitSide=true;}return result;}// For relative vertical movement. Dir may be -1 or 1. Unit can be\n// "page" or "line". The resulting position will have a hitSide=true\n// property if it reached the end of the document.\nfunction findPosV(cm,pos,dir,unit){var doc=cm.doc,x=pos.left,y;if(unit=="page"){var pageSize=Math.min(cm.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);var moveAmount=Math.max(pageSize-.5*textHeight(cm.display),3);y=(dir>0?pos.bottom:pos.top)+dir*moveAmount;}else if(unit=="line"){y=dir>0?pos.bottom+3:pos.top-3;}var target;for(;;){target=coordsChar(cm,x,y);if(!target.outside){break;}if(dir<0?y<=0:y>=doc.height){target.hitSide=true;break;}y+=dir*5;}return target;}// CONTENTEDITABLE INPUT STYLE\nfunction ContentEditableInput(cm){this.cm=cm;this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null;this.polling=new Delayed();this.gracePeriod=false;}ContentEditableInput.prototype=copyObj({init:function(display){var input=this,cm=input.cm;var div=input.div=display.lineDiv;disableBrowserMagic(div,cm.options.spellcheck);on(div,"paste",function(e){if(signalDOMEvent(cm,e)||handlePaste(e,cm)){return;}// IE doesn\'t fire input events, so we schedule a read for the pasted content in this way\nif(ie_version<=11){setTimeout(operation(cm,function(){if(!input.pollContent()){regChange(cm);}}),20);}});on(div,"compositionstart",function(e){var data=e.data;input.composing={sel:cm.doc.sel,data:data,startData:data};if(!data){return;}var prim=cm.doc.sel.primary();var line=cm.getLine(prim.head.line);var found=line.indexOf(data,Math.max(0,prim.head.ch-data.length));if(found>-1&&found<=prim.head.ch){input.composing.sel=simpleSelection(Pos(prim.head.line,found),Pos(prim.head.line,found+data.length));}});on(div,"compositionupdate",function(e){return input.composing.data=e.data;});on(div,"compositionend",function(e){var ours=input.composing;if(!ours){return;}if(e.data!=ours.startData&&!/\\u200b/.test(e.data)){ours.data=e.data;}// Need a small delay to prevent other code (input event,\n// selection polling) from doing damage when fired right after\n// compositionend.\nsetTimeout(function(){if(!ours.handled){input.applyComposition(ours);}if(input.composing==ours){input.composing=null;}},50);});on(div,"touchstart",function(){return input.forceCompositionEnd();});on(div,"input",function(){if(input.composing){return;}if(cm.isReadOnly()||!input.pollContent()){runInOp(input.cm,function(){return regChange(cm);});}});function onCopyCut(e){if(signalDOMEvent(cm,e)){return;}if(cm.somethingSelected()){setLastCopied({lineWise:false,text:cm.getSelections()});if(e.type=="cut"){cm.replaceSelection("",null,"cut");}}else if(!cm.options.lineWiseCopyCut){return;}else{var ranges=copyableRanges(cm);setLastCopied({lineWise:true,text:ranges.text});if(e.type=="cut"){cm.operation(function(){cm.setSelections(ranges.ranges,0,sel_dontScroll);cm.replaceSelection("",null,"cut");});}}if(e.clipboardData){e.clipboardData.clearData();var content=lastCopied.text.join("\\n");// iOS exposes the clipboard API, but seems to discard content inserted into it\ne.clipboardData.setData("Text",content);if(e.clipboardData.getData("Text")==content){e.preventDefault();return;}}// Old-fashioned briefly-focus-a-textarea hack\nvar kludge=hiddenTextarea(),te=kludge.firstChild;cm.display.lineSpace.insertBefore(kludge,cm.display.lineSpace.firstChild);te.value=lastCopied.text.join("\\n");var hadFocus=document.activeElement;selectInput(te);setTimeout(function(){cm.display.lineSpace.removeChild(kludge);hadFocus.focus();if(hadFocus==div){input.showPrimarySelection();}},50);}on(div,"copy",onCopyCut);on(div,"cut",onCopyCut);},prepareSelection:function(){var result=prepareSelection(this.cm,false);result.focus=this.cm.state.focused;return result;},showSelection:function(info,takeFocus){if(!info||!this.cm.display.view.length){return;}if(info.focus||takeFocus){this.showPrimarySelection();}this.showMultipleSelections(info);},showPrimarySelection:function(){var sel=window.getSelection(),prim=this.cm.doc.sel.primary();var curAnchor=domToPos(this.cm,sel.anchorNode,sel.anchorOffset);var curFocus=domToPos(this.cm,sel.focusNode,sel.focusOffset);if(curAnchor&&!curAnchor.bad&&curFocus&&!curFocus.bad&&cmp(minPos(curAnchor,curFocus),prim.from())==0&&cmp(maxPos(curAnchor,curFocus),prim.to())==0){return;}var start=posToDOM(this.cm,prim.from());var end=posToDOM(this.cm,prim.to());if(!start&&!end){return;}var view=this.cm.display.view;var old=sel.rangeCount&&sel.getRangeAt(0);if(!start){start={node:view[0].measure.map[2],offset:0};}else if(!end){// FIXME dangerously hacky\nvar measure=view[view.length-1].measure;var map=measure.maps?measure.maps[measure.maps.length-1]:measure.map;end={node:map[map.length-1],offset:map[map.length-2]-map[map.length-3]};}var rng;try{rng=range(start.node,start.offset,end.offset,end.node);}catch(e){}// Our model of the DOM might be outdated, in which case the range we try to set can be impossible\nif(rng){if(!gecko&&this.cm.state.focused){sel.collapse(start.node,start.offset);if(!rng.collapsed){sel.removeAllRanges();sel.addRange(rng);}}else{sel.removeAllRanges();sel.addRange(rng);}if(old&&sel.anchorNode==null){sel.addRange(old);}else if(gecko){this.startGracePeriod();}}this.rememberSelection();},startGracePeriod:function(){var this$1=this;clearTimeout(this.gracePeriod);this.gracePeriod=setTimeout(function(){this$1.gracePeriod=false;if(this$1.selectionChanged()){this$1.cm.operation(function(){return this$1.cm.curOp.selectionChanged=true;});}},20);},showMultipleSelections:function(info){removeChildrenAndAdd(this.cm.display.cursorDiv,info.cursors);removeChildrenAndAdd(this.cm.display.selectionDiv,info.selection);},rememberSelection:function(){var sel=window.getSelection();this.lastAnchorNode=sel.anchorNode;this.lastAnchorOffset=sel.anchorOffset;this.lastFocusNode=sel.focusNode;this.lastFocusOffset=sel.focusOffset;},selectionInEditor:function(){var sel=window.getSelection();if(!sel.rangeCount){return false;}var node=sel.getRangeAt(0).commonAncestorContainer;return contains(this.div,node);},focus:function(){if(this.cm.options.readOnly!="nocursor"){this.div.focus();}},blur:function(){this.div.blur();},getField:function(){return this.div;},supportsTouch:function(){return true;},receivedFocus:function(){var input=this;if(this.selectionInEditor()){this.pollSelection();}else{runInOp(this.cm,function(){return input.cm.curOp.selectionChanged=true;});}function poll(){if(input.cm.state.focused){input.pollSelection();input.polling.set(input.cm.options.pollInterval,poll);}}this.polling.set(this.cm.options.pollInterval,poll);},selectionChanged:function(){var sel=window.getSelection();return sel.anchorNode!=this.lastAnchorNode||sel.anchorOffset!=this.lastAnchorOffset||sel.focusNode!=this.lastFocusNode||sel.focusOffset!=this.lastFocusOffset;},pollSelection:function(){if(!this.composing&&!this.gracePeriod&&this.selectionChanged()){var sel=window.getSelection(),cm=this.cm;this.rememberSelection();var anchor=domToPos(cm,sel.anchorNode,sel.anchorOffset);var head=domToPos(cm,sel.focusNode,sel.focusOffset);if(anchor&&head){runInOp(cm,function(){setSelection(cm.doc,simpleSelection(anchor,head),sel_dontScroll);if(anchor.bad||head.bad){cm.curOp.selectionChanged=true;}});}}},pollContent:function(){var cm=this.cm,display=cm.display,sel=cm.doc.sel.primary();var from=sel.from(),to=sel.to();if(from.line<display.viewFrom||to.line>display.viewTo-1){return false;}var fromIndex,fromLine,fromNode;if(from.line==display.viewFrom||(fromIndex=findViewIndex(cm,from.line))==0){fromLine=lineNo(display.view[0].line);fromNode=display.view[0].node;}else{fromLine=lineNo(display.view[fromIndex].line);fromNode=display.view[fromIndex-1].node.nextSibling;}var toIndex=findViewIndex(cm,to.line);var toLine,toNode;if(toIndex==display.view.length-1){toLine=display.viewTo-1;toNode=display.lineDiv.lastChild;}else{toLine=lineNo(display.view[toIndex+1].line)-1;toNode=display.view[toIndex+1].node.previousSibling;}var newText=cm.doc.splitLines(domTextBetween(cm,fromNode,toNode,fromLine,toLine));var oldText=getBetween(cm.doc,Pos(fromLine,0),Pos(toLine,getLine(cm.doc,toLine).text.length));while(newText.length>1&&oldText.length>1){if(lst(newText)==lst(oldText)){newText.pop();oldText.pop();toLine--;}else if(newText[0]==oldText[0]){newText.shift();oldText.shift();fromLine++;}else{break;}}var cutFront=0,cutEnd=0;var newTop=newText[0],oldTop=oldText[0],maxCutFront=Math.min(newTop.length,oldTop.length);while(cutFront<maxCutFront&&newTop.charCodeAt(cutFront)==oldTop.charCodeAt(cutFront)){++cutFront;}var newBot=lst(newText),oldBot=lst(oldText);var maxCutEnd=Math.min(newBot.length-(newText.length==1?cutFront:0),oldBot.length-(oldText.length==1?cutFront:0));while(cutEnd<maxCutEnd&&newBot.charCodeAt(newBot.length-cutEnd-1)==oldBot.charCodeAt(oldBot.length-cutEnd-1)){++cutEnd;}newText[newText.length-1]=newBot.slice(0,newBot.length-cutEnd);newText[0]=newText[0].slice(cutFront);var chFrom=Pos(fromLine,cutFront);var chTo=Pos(toLine,oldText.length?lst(oldText).length-cutEnd:0);if(newText.length>1||newText[0]||cmp(chFrom,chTo)){replaceRange(cm.doc,newText,chFrom,chTo,"+input");return true;}},ensurePolled:function(){this.forceCompositionEnd();},reset:function(){this.forceCompositionEnd();},forceCompositionEnd:function(){if(!this.composing||this.composing.handled){return;}this.applyComposition(this.composing);this.composing.handled=true;this.div.blur();this.div.focus();},applyComposition:function(composing){if(this.cm.isReadOnly()){operation(this.cm,regChange)(this.cm);}else if(composing.data&&composing.data!=composing.startData){operation(this.cm,applyTextInput)(this.cm,composing.data,0,composing.sel);}},setUneditable:function(node){node.contentEditable="false";},onKeyPress:function(e){e.preventDefault();if(!this.cm.isReadOnly()){operation(this.cm,applyTextInput)(this.cm,String.fromCharCode(e.charCode==null?e.keyCode:e.charCode),0);}},readOnlyChanged:function(val){this.div.contentEditable=String(val!="nocursor");},onContextMenu:nothing,resetPosition:nothing,needsContentAttribute:true},ContentEditableInput.prototype);function posToDOM(cm,pos){var view=findViewForLine(cm,pos.line);if(!view||view.hidden){return null;}var line=getLine(cm.doc,pos.line);var info=mapFromLineView(view,line,pos.line);var order=getOrder(line),side="left";if(order){var partPos=getBidiPartAt(order,pos.ch);side=partPos%2?"right":"left";}var result=nodeAndOffsetInLineMap(info.map,pos.ch,side);result.offset=result.collapse=="right"?result.end:result.start;return result;}function badPos(pos,bad){if(bad){pos.bad=true;}return pos;}function domTextBetween(cm,from,to,fromLine,toLine){var text="",closing=false,lineSep=cm.doc.lineSeparator();function recognizeMarker(id){return function(marker){return marker.id==id;};}function walk(node){if(node.nodeType==1){var cmText=node.getAttribute("cm-text");if(cmText!=null){if(cmText==""){cmText=node.textContent.replace(/\\u200b/g,"");}text+=cmText;return;}var markerID=node.getAttribute("cm-marker"),range;if(markerID){var found=cm.findMarks(Pos(fromLine,0),Pos(toLine+1,0),recognizeMarker(+markerID));if(found.length&&(range=found[0].find())){text+=getBetween(cm.doc,range.from,range.to).join(lineSep);}return;}if(node.getAttribute("contenteditable")=="false"){return;}for(var i=0;i<node.childNodes.length;i++){walk(node.childNodes[i]);}if(/^(pre|div|p)$/i.test(node.nodeName)){closing=true;}}else if(node.nodeType==3){var val=node.nodeValue;if(!val){return;}if(closing){text+=lineSep;closing=false;}text+=val;}}for(;;){walk(from);if(from==to){break;}from=from.nextSibling;}return text;}function domToPos(cm,node,offset){var lineNode;if(node==cm.display.lineDiv){lineNode=cm.display.lineDiv.childNodes[offset];if(!lineNode){return badPos(cm.clipPos(Pos(cm.display.viewTo-1)),true);}node=null;offset=0;}else{for(lineNode=node;;lineNode=lineNode.parentNode){if(!lineNode||lineNode==cm.display.lineDiv){return null;}if(lineNode.parentNode&&lineNode.parentNode==cm.display.lineDiv){break;}}}for(var i=0;i<cm.display.view.length;i++){var lineView=cm.display.view[i];if(lineView.node==lineNode){return locateNodeInLineView(lineView,node,offset);}}}function locateNodeInLineView(lineView,node,offset){var wrapper=lineView.text.firstChild,bad=false;if(!node||!contains(wrapper,node)){return badPos(Pos(lineNo(lineView.line),0),true);}if(node==wrapper){bad=true;node=wrapper.childNodes[offset];offset=0;if(!node){var line=lineView.rest?lst(lineView.rest):lineView.line;return badPos(Pos(lineNo(line),line.text.length),bad);}}var textNode=node.nodeType==3?node:null,topNode=node;if(!textNode&&node.childNodes.length==1&&node.firstChild.nodeType==3){textNode=node.firstChild;if(offset){offset=textNode.nodeValue.length;}}while(topNode.parentNode!=wrapper){topNode=topNode.parentNode;}var measure=lineView.measure,maps=measure.maps;function find(textNode,topNode,offset){for(var i=-1;i<(maps?maps.length:0);i++){var map=i<0?measure.map:maps[i];for(var j=0;j<map.length;j+=3){var curNode=map[j+2];if(curNode==textNode||curNode==topNode){var line=lineNo(i<0?lineView.line:lineView.rest[i]);var ch=map[j]+offset;if(offset<0||curNode!=textNode){ch=map[j+(offset?1:0)];}return Pos(line,ch);}}}}var found=find(textNode,topNode,offset);if(found){return badPos(found,bad);}// FIXME this is all really shaky. might handle the few cases it needs to handle, but likely to cause problems\nfor(var after=topNode.nextSibling,dist=textNode?textNode.nodeValue.length-offset:0;after;after=after.nextSibling){found=find(after,after.firstChild,0);if(found){return badPos(Pos(found.line,found.ch-dist),bad);}else{dist+=after.textContent.length;}}for(var before=topNode.previousSibling,dist$1=offset;before;before=before.previousSibling){found=find(before,before.firstChild,-1);if(found){return badPos(Pos(found.line,found.ch+dist$1),bad);}else{dist$1+=before.textContent.length;}}}// TEXTAREA INPUT STYLE\nfunction TextareaInput(cm){this.cm=cm;// See input.poll and input.reset\nthis.prevInput="";// Flag that indicates whether we expect input to appear real soon\n// now (after some event like \'keypress\' or \'input\') and are\n// polling intensively.\nthis.pollingFast=false;// Self-resetting timeout for the poller\nthis.polling=new Delayed();// Tracks when input.reset has punted to just putting a short\n// string into the textarea instead of the full selection.\nthis.inaccurateSelection=false;// Used to work around IE issue with selection being forgotten when focus moves away from textarea\nthis.hasSelection=false;this.composing=null;}TextareaInput.prototype=copyObj({init:function(display){var this$1=this;var input=this,cm=this.cm;// Wraps and hides input textarea\nvar div=this.wrapper=hiddenTextarea();// The semihidden textarea that is focused when the editor is\n// focused, and receives input.\nvar te=this.textarea=div.firstChild;display.wrapper.insertBefore(div,display.wrapper.firstChild);// Needed to hide big blue blinking cursor on Mobile Safari (doesn\'t seem to work in iOS 8 anymore)\nif(ios){te.style.width="0px";}on(te,"input",function(){if(ie&&ie_version>=9&&this$1.hasSelection){this$1.hasSelection=null;}input.poll();});on(te,"paste",function(e){if(signalDOMEvent(cm,e)||handlePaste(e,cm)){return;}cm.state.pasteIncoming=true;input.fastPoll();});function prepareCopyCut(e){if(signalDOMEvent(cm,e)){return;}if(cm.somethingSelected()){setLastCopied({lineWise:false,text:cm.getSelections()});if(input.inaccurateSelection){input.prevInput="";input.inaccurateSelection=false;te.value=lastCopied.text.join("\\n");selectInput(te);}}else if(!cm.options.lineWiseCopyCut){return;}else{var ranges=copyableRanges(cm);setLastCopied({lineWise:true,text:ranges.text});if(e.type=="cut"){cm.setSelections(ranges.ranges,null,sel_dontScroll);}else{input.prevInput="";te.value=ranges.text.join("\\n");selectInput(te);}}if(e.type=="cut"){cm.state.cutIncoming=true;}}on(te,"cut",prepareCopyCut);on(te,"copy",prepareCopyCut);on(display.scroller,"paste",function(e){if(eventInWidget(display,e)||signalDOMEvent(cm,e)){return;}cm.state.pasteIncoming=true;input.focus();});// Prevent normal selection in the editor (we handle our own)\non(display.lineSpace,"selectstart",function(e){if(!eventInWidget(display,e)){e_preventDefault(e);}});on(te,"compositionstart",function(){var start=cm.getCursor("from");if(input.composing){input.composing.range.clear();}input.composing={start:start,range:cm.markText(start,cm.getCursor("to"),{className:"CodeMirror-composing"})};});on(te,"compositionend",function(){if(input.composing){input.poll();input.composing.range.clear();input.composing=null;}});},prepareSelection:function(){// Redraw the selection and/or cursor\nvar cm=this.cm,display=cm.display,doc=cm.doc;var result=prepareSelection(cm);// Move the hidden textarea near the cursor to prevent scrolling artifacts\nif(cm.options.moveInputWithCursor){var headPos=cursorCoords(cm,doc.sel.primary().head,"div");var wrapOff=display.wrapper.getBoundingClientRect(),lineOff=display.lineDiv.getBoundingClientRect();result.teTop=Math.max(0,Math.min(display.wrapper.clientHeight-10,headPos.top+lineOff.top-wrapOff.top));result.teLeft=Math.max(0,Math.min(display.wrapper.clientWidth-10,headPos.left+lineOff.left-wrapOff.left));}return result;},showSelection:function(drawn){var cm=this.cm,display=cm.display;removeChildrenAndAdd(display.cursorDiv,drawn.cursors);removeChildrenAndAdd(display.selectionDiv,drawn.selection);if(drawn.teTop!=null){this.wrapper.style.top=drawn.teTop+"px";this.wrapper.style.left=drawn.teLeft+"px";}},// Reset the input to correspond to the selection (or to be empty,\n// when not typing and nothing is selected)\nreset:function(typing){if(this.contextMenuPending){return;}var minimal,selected,cm=this.cm,doc=cm.doc;if(cm.somethingSelected()){this.prevInput="";var range=doc.sel.primary();minimal=hasCopyEvent&&(range.to().line-range.from().line>100||(selected=cm.getSelection()).length>1000);var content=minimal?"-":selected||cm.getSelection();this.textarea.value=content;if(cm.state.focused){selectInput(this.textarea);}if(ie&&ie_version>=9){this.hasSelection=content;}}else if(!typing){this.prevInput=this.textarea.value="";if(ie&&ie_version>=9){this.hasSelection=null;}}this.inaccurateSelection=minimal;},getField:function(){return this.textarea;},supportsTouch:function(){return false;},focus:function(){if(this.cm.options.readOnly!="nocursor"&&(!mobile||activeElt()!=this.textarea)){try{this.textarea.focus();}catch(e){}// IE8 will throw if the textarea is display: none or not in DOM\n}},blur:function(){this.textarea.blur();},resetPosition:function(){this.wrapper.style.top=this.wrapper.style.left=0;},receivedFocus:function(){this.slowPoll();},// Poll for input changes, using the normal rate of polling. This\n// runs as long as the editor is focused.\nslowPoll:function(){var this$1=this;if(this.pollingFast){return;}this.polling.set(this.cm.options.pollInterval,function(){this$1.poll();if(this$1.cm.state.focused){this$1.slowPoll();}});},// When an event has just come in that is likely to add or change\n// something in the input textarea, we poll faster, to ensure that\n// the change appears on the screen quickly.\nfastPoll:function(){var missed=false,input=this;input.pollingFast=true;function p(){var changed=input.poll();if(!changed&&!missed){missed=true;input.polling.set(60,p);}else{input.pollingFast=false;input.slowPoll();}}input.polling.set(20,p);},// Read input from the textarea, and update the document to match.\n// When something is selected, it is present in the textarea, and\n// selected (unless it is huge, in which case a placeholder is\n// used). When nothing is selected, the cursor sits after previously\n// seen text (can be empty), which is stored in prevInput (we must\n// not reset the textarea when typing, because that breaks IME).\npoll:function(){var this$1=this;var cm=this.cm,input=this.textarea,prevInput=this.prevInput;// Since this is called a *lot*, try to bail out as cheaply as\n// possible when it is clear that nothing happened. hasSelection\n// will be the case when there is a lot of text in the textarea,\n// in which case reading its value would be expensive.\nif(this.contextMenuPending||!cm.state.focused||hasSelection(input)&&!prevInput&&!this.composing||cm.isReadOnly()||cm.options.disableInput||cm.state.keySeq){return false;}var text=input.value;// If nothing changed, bail.\nif(text==prevInput&&!cm.somethingSelected()){return false;}// Work around nonsensical selection resetting in IE9/10, and\n// inexplicable appearance of private area unicode characters on\n// some key combos in Mac (#2689).\nif(ie&&ie_version>=9&&this.hasSelection===text||mac&&/[\\uf700-\\uf7ff]/.test(text)){cm.display.input.reset();return false;}if(cm.doc.sel==cm.display.selForContextMenu){var first=text.charCodeAt(0);if(first==0x200b&&!prevInput){prevInput="\\u200b";}if(first==0x21da){this.reset();return this.cm.execCommand("undo");}}// Find the part of the input that is actually new\nvar same=0,l=Math.min(prevInput.length,text.length);while(same<l&&prevInput.charCodeAt(same)==text.charCodeAt(same)){++same;}runInOp(cm,function(){applyTextInput(cm,text.slice(same),prevInput.length-same,null,this$1.composing?"*compose":null);// Don\'t leave long text in the textarea, since it makes further polling slow\nif(text.length>1000||text.indexOf("\\n")>-1){input.value=this$1.prevInput="";}else{this$1.prevInput=text;}if(this$1.composing){this$1.composing.range.clear();this$1.composing.range=cm.markText(this$1.composing.start,cm.getCursor("to"),{className:"CodeMirror-composing"});}});return true;},ensurePolled:function(){if(this.pollingFast&&this.poll()){this.pollingFast=false;}},onKeyPress:function(){if(ie&&ie_version>=9){this.hasSelection=null;}this.fastPoll();},onContextMenu:function(e){var input=this,cm=input.cm,display=cm.display,te=input.textarea;var pos=posFromMouse(cm,e),scrollPos=display.scroller.scrollTop;if(!pos||presto){return;}// Opera is difficult.\n// Reset the current text selection only if the click is done outside of the selection\n// and \'resetSelectionOnContextMenu\' option is true.\nvar reset=cm.options.resetSelectionOnContextMenu;if(reset&&cm.doc.sel.contains(pos)==-1){operation(cm,setSelection)(cm.doc,simpleSelection(pos),sel_dontScroll);}var oldCSS=te.style.cssText,oldWrapperCSS=input.wrapper.style.cssText;input.wrapper.style.cssText="position: absolute";var wrapperBox=input.wrapper.getBoundingClientRect();te.style.cssText="position: absolute; width: 30px; height: 30px;\\n      top: "+(e.clientY-wrapperBox.top-5)+"px; left: "+(e.clientX-wrapperBox.left-5)+"px;\\n      z-index: 1000; background: "+(ie?"rgba(255, 255, 255, .05)":"transparent")+";\\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";var oldScrollY;if(webkit){oldScrollY=window.scrollY;}// Work around Chrome issue (#2712)\ndisplay.input.focus();if(webkit){window.scrollTo(null,oldScrollY);}display.input.reset();// Adds "Select all" to context menu in FF\nif(!cm.somethingSelected()){te.value=input.prevInput=" ";}input.contextMenuPending=true;display.selForContextMenu=cm.doc.sel;clearTimeout(display.detectingSelectAll);// Select-all will be greyed out if there\'s nothing to select, so\n// this adds a zero-width space so that we can later check whether\n// it got selected.\nfunction prepareSelectAllHack(){if(te.selectionStart!=null){var selected=cm.somethingSelected();var extval="\\u200b"+(selected?te.value:"");te.value="\\u21da";// Used to catch context-menu undo\nte.value=extval;input.prevInput=selected?"":"\\u200b";te.selectionStart=1;te.selectionEnd=extval.length;// Re-set this, in case some other handler touched the\n// selection in the meantime.\ndisplay.selForContextMenu=cm.doc.sel;}}function rehide(){input.contextMenuPending=false;input.wrapper.style.cssText=oldWrapperCSS;te.style.cssText=oldCSS;if(ie&&ie_version<9){display.scrollbars.setScrollTop(display.scroller.scrollTop=scrollPos);}// Try to detect the user choosing select-all\nif(te.selectionStart!=null){if(!ie||ie&&ie_version<9){prepareSelectAllHack();}var i=0,poll=function(){if(display.selForContextMenu==cm.doc.sel&&te.selectionStart==0&&te.selectionEnd>0&&input.prevInput=="\\u200b"){operation(cm,selectAll)(cm);}else if(i++<10){display.detectingSelectAll=setTimeout(poll,500);}else{display.input.reset();}};display.detectingSelectAll=setTimeout(poll,200);}}if(ie&&ie_version>=9){prepareSelectAllHack();}if(captureRightClick){e_stop(e);var mouseup=function(){off(window,"mouseup",mouseup);setTimeout(rehide,20);};on(window,"mouseup",mouseup);}else{setTimeout(rehide,50);}},readOnlyChanged:function(val){if(!val){this.reset();}},setUneditable:nothing,needsContentAttribute:false},TextareaInput.prototype);function fromTextArea(textarea,options){options=options?copyObj(options):{};options.value=textarea.value;if(!options.tabindex&&textarea.tabIndex){options.tabindex=textarea.tabIndex;}if(!options.placeholder&&textarea.placeholder){options.placeholder=textarea.placeholder;}// Set autofocus to true if this textarea is focused, or if it has\n// autofocus and no other element is focused.\nif(options.autofocus==null){var hasFocus=activeElt();options.autofocus=hasFocus==textarea||textarea.getAttribute("autofocus")!=null&&hasFocus==document.body;}function save(){textarea.value=cm.getValue();}var realSubmit;if(textarea.form){on(textarea.form,"submit",save);// Deplorable hack to make the submit method do the right thing.\nif(!options.leaveSubmitMethodAlone){var form=textarea.form;realSubmit=form.submit;try{var wrappedSubmit=form.submit=function(){save();form.submit=realSubmit;form.submit();form.submit=wrappedSubmit;};}catch(e){}}}options.finishInit=function(cm){cm.save=save;cm.getTextArea=function(){return textarea;};cm.toTextArea=function(){cm.toTextArea=isNaN;// Prevent this from being ran twice\nsave();textarea.parentNode.removeChild(cm.getWrapperElement());textarea.style.display="";if(textarea.form){off(textarea.form,"submit",save);if(typeof textarea.form.submit=="function"){textarea.form.submit=realSubmit;}}};};textarea.style.display="none";var cm=CodeMirror(function(node){return textarea.parentNode.insertBefore(node,textarea.nextSibling);},options);return cm;}function addLegacyProps(CodeMirror){CodeMirror.off=off;CodeMirror.on=on;CodeMirror.wheelEventPixels=wheelEventPixels;CodeMirror.Doc=Doc;CodeMirror.splitLines=splitLinesAuto;CodeMirror.countColumn=countColumn;CodeMirror.findColumn=findColumn;CodeMirror.isWordChar=isWordCharBasic;CodeMirror.Pass=Pass;CodeMirror.signal=signal;CodeMirror.Line=Line;CodeMirror.changeEnd=changeEnd;CodeMirror.scrollbarModel=scrollbarModel;CodeMirror.Pos=Pos;CodeMirror.cmpPos=cmp;CodeMirror.modes=modes;CodeMirror.mimeModes=mimeModes;CodeMirror.resolveMode=resolveMode;CodeMirror.getMode=getMode;CodeMirror.modeExtensions=modeExtensions;CodeMirror.extendMode=extendMode;CodeMirror.copyState=copyState;CodeMirror.startState=startState;CodeMirror.innerMode=innerMode;CodeMirror.commands=commands;CodeMirror.keyMap=keyMap;CodeMirror.keyName=keyName;CodeMirror.isModifierKey=isModifierKey;CodeMirror.lookupKey=lookupKey;CodeMirror.normalizeKeyMap=normalizeKeyMap;CodeMirror.StringStream=StringStream;CodeMirror.SharedTextMarker=SharedTextMarker;CodeMirror.TextMarker=TextMarker;CodeMirror.LineWidget=LineWidget;CodeMirror.e_preventDefault=e_preventDefault;CodeMirror.e_stopPropagation=e_stopPropagation;CodeMirror.e_stop=e_stop;CodeMirror.addClass=addClass;CodeMirror.contains=contains;CodeMirror.rmClass=rmClass;CodeMirror.keyNames=keyNames;}// EDITOR CONSTRUCTOR\ndefineOptions(CodeMirror);addEditorMethods(CodeMirror);// Set up methods on CodeMirror\'s prototype to redirect to the editor\'s document.\nvar dontDelegate="iter insert remove copy getEditor constructor".split(" ");for(var prop in Doc.prototype){if(Doc.prototype.hasOwnProperty(prop)&&indexOf(dontDelegate,prop)<0){CodeMirror.prototype[prop]=function(method){return function(){return method.apply(this.doc,arguments);};}(Doc.prototype[prop]);}}eventMixin(Doc);// INPUT HANDLING\nCodeMirror.inputStyles={"textarea":TextareaInput,"contenteditable":ContentEditableInput};// MODE DEFINITION AND QUERYING\n// Extra arguments are stored as the mode\'s dependencies, which is\n// used by (legacy) mechanisms like loadmode.js to automatically\n// load a mode. (Preferred mechanism is the require/define calls.)\nCodeMirror.defineMode=function(name/*, mode, */){if(!CodeMirror.defaults.mode&&name!="null"){CodeMirror.defaults.mode=name;}defineMode.apply(this,arguments);};CodeMirror.defineMIME=defineMIME;// Minimal default mode.\nCodeMirror.defineMode("null",function(){return{token:function(stream){return stream.skipToEnd();}};});CodeMirror.defineMIME("text/plain","null");// EXTENSIONS\nCodeMirror.defineExtension=function(name,func){CodeMirror.prototype[name]=func;};CodeMirror.defineDocExtension=function(name,func){Doc.prototype[name]=func;};CodeMirror.fromTextArea=fromTextArea;addLegacyProps(CodeMirror);CodeMirror.version="5.20.2";return CodeMirror;});//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9+L2NvZGVtaXJyb3IvbGliL2NvZGVtaXJyb3IuanM/YjQzZSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb2RlTWlycm9yLCBjb3B5cmlnaHQgKGMpIGJ5IE1hcmlqbiBIYXZlcmJla2UgYW5kIG90aGVyc1xuLy8gRGlzdHJpYnV0ZWQgdW5kZXIgYW4gTUlUIGxpY2Vuc2U6IGh0dHA6Ly9jb2RlbWlycm9yLm5ldC9MSUNFTlNFXG4vLyBUaGlzIGlzIENvZGVNaXJyb3IgKGh0dHA6Ly9jb2RlbWlycm9yLm5ldCksIGEgY29kZSBlZGl0b3Jcbi8vIGltcGxlbWVudGVkIGluIEphdmFTY3JpcHQgb24gdG9wIG9mIHRoZSBicm93c2VyJ3MgRE9NLlxuLy9cbi8vIFlvdSBjYW4gZmluZCBzb21lIHRlY2huaWNhbCBiYWNrZ3JvdW5kIGZvciBzb21lIG9mIHRoZSBjb2RlIGJlbG93XG4vLyBhdCBodHRwOi8vbWFyaWpuaGF2ZXJiZWtlLm5sL2Jsb2cvI2NtLWludGVybmFscyAuXG4oZnVuY3Rpb24oZ2xvYmFsLGZhY3Rvcnkpe3R5cGVvZiBleHBvcnRzPT09J29iamVjdCcmJnR5cGVvZiBtb2R1bGUhPT0ndW5kZWZpbmVkJz9tb2R1bGUuZXhwb3J0cz1mYWN0b3J5KCk6dHlwZW9mIGRlZmluZT09PSdmdW5jdGlvbicmJmRlZmluZS5hbWQ/ZGVmaW5lKGZhY3RvcnkpOmdsb2JhbC5Db2RlTWlycm9yPWZhY3RvcnkoKTt9KSh0aGlzLGZ1bmN0aW9uKCl7J3VzZSBzdHJpY3QnOy8vIEtsdWRnZXMgZm9yIGJ1Z3MgYW5kIGJlaGF2aW9yIGRpZmZlcmVuY2VzIHRoYXQgY2FuJ3QgYmUgZmVhdHVyZVxuLy8gZGV0ZWN0ZWQgYXJlIGVuYWJsZWQgYmFzZWQgb24gdXNlckFnZW50IGV0YyBzbmlmZmluZy5cbnZhciB1c2VyQWdlbnQ9bmF2aWdhdG9yLnVzZXJBZ2VudDt2YXIgcGxhdGZvcm09bmF2aWdhdG9yLnBsYXRmb3JtO3ZhciBnZWNrbz0vZ2Vja29cXC9cXGQvaS50ZXN0KHVzZXJBZ2VudCk7dmFyIGllX3VwdG8xMD0vTVNJRSBcXGQvLnRlc3QodXNlckFnZW50KTt2YXIgaWVfMTF1cD0vVHJpZGVudFxcLyg/Ols3LTldfFxcZHsyLH0pXFwuLipydjooXFxkKykvLmV4ZWModXNlckFnZW50KTt2YXIgaWU9aWVfdXB0bzEwfHxpZV8xMXVwO3ZhciBpZV92ZXJzaW9uPWllJiYoaWVfdXB0bzEwP2RvY3VtZW50LmRvY3VtZW50TW9kZXx8NjppZV8xMXVwWzFdKTt2YXIgd2Via2l0PS9XZWJLaXRcXC8vLnRlc3QodXNlckFnZW50KTt2YXIgcXR3ZWJraXQ9d2Via2l0JiYvUXRcXC9cXGQrXFwuXFxkKy8udGVzdCh1c2VyQWdlbnQpO3ZhciBjaHJvbWU9L0Nocm9tZVxcLy8udGVzdCh1c2VyQWdlbnQpO3ZhciBwcmVzdG89L09wZXJhXFwvLy50ZXN0KHVzZXJBZ2VudCk7dmFyIHNhZmFyaT0vQXBwbGUgQ29tcHV0ZXIvLnRlc3QobmF2aWdhdG9yLnZlbmRvcik7dmFyIG1hY19nZU1vdW50YWluTGlvbj0vTWFjIE9TIFggMVxcZFxcRChbOC05XXxcXGRcXGQpXFxELy50ZXN0KHVzZXJBZ2VudCk7dmFyIHBoYW50b209L1BoYW50b21KUy8udGVzdCh1c2VyQWdlbnQpO3ZhciBpb3M9L0FwcGxlV2ViS2l0Ly50ZXN0KHVzZXJBZ2VudCkmJi9Nb2JpbGVcXC9cXHcrLy50ZXN0KHVzZXJBZ2VudCk7Ly8gVGhpcyBpcyB3b2VmdWxseSBpbmNvbXBsZXRlLiBTdWdnZXN0aW9ucyBmb3IgYWx0ZXJuYXRpdmUgbWV0aG9kcyB3ZWxjb21lLlxudmFyIG1vYmlsZT1pb3N8fC9BbmRyb2lkfHdlYk9TfEJsYWNrQmVycnl8T3BlcmEgTWluaXxPcGVyYSBNb2JpfElFTW9iaWxlL2kudGVzdCh1c2VyQWdlbnQpO3ZhciBtYWM9aW9zfHwvTWFjLy50ZXN0KHBsYXRmb3JtKTt2YXIgY2hyb21lT1M9L1xcYkNyT1NcXGIvLnRlc3QodXNlckFnZW50KTt2YXIgd2luZG93cz0vd2luL2kudGVzdChwbGF0Zm9ybSk7dmFyIHByZXN0b192ZXJzaW9uPXByZXN0byYmdXNlckFnZW50Lm1hdGNoKC9WZXJzaW9uXFwvKFxcZCpcXC5cXGQqKS8pO2lmKHByZXN0b192ZXJzaW9uKXtwcmVzdG9fdmVyc2lvbj1OdW1iZXIocHJlc3RvX3ZlcnNpb25bMV0pO31pZihwcmVzdG9fdmVyc2lvbiYmcHJlc3RvX3ZlcnNpb24+PTE1KXtwcmVzdG89ZmFsc2U7d2Via2l0PXRydWU7fS8vIFNvbWUgYnJvd3NlcnMgdXNlIHRoZSB3cm9uZyBldmVudCBwcm9wZXJ0aWVzIHRvIHNpZ25hbCBjbWQvY3RybCBvbiBPUyBYXG52YXIgZmxpcEN0cmxDbWQ9bWFjJiYocXR3ZWJraXR8fHByZXN0byYmKHByZXN0b192ZXJzaW9uPT1udWxsfHxwcmVzdG9fdmVyc2lvbjwxMi4xMSkpO3ZhciBjYXB0dXJlUmlnaHRDbGljaz1nZWNrb3x8aWUmJmllX3ZlcnNpb24+PTk7ZnVuY3Rpb24gY2xhc3NUZXN0KGNscyl7cmV0dXJuIG5ldyBSZWdFeHAoXCIoXnxcXFxccylcIitjbHMrXCIoPzokfFxcXFxzKVxcXFxzKlwiKTt9dmFyIHJtQ2xhc3M9ZnVuY3Rpb24obm9kZSxjbHMpe3ZhciBjdXJyZW50PW5vZGUuY2xhc3NOYW1lO3ZhciBtYXRjaD1jbGFzc1Rlc3QoY2xzKS5leGVjKGN1cnJlbnQpO2lmKG1hdGNoKXt2YXIgYWZ0ZXI9Y3VycmVudC5zbGljZShtYXRjaC5pbmRleCttYXRjaFswXS5sZW5ndGgpO25vZGUuY2xhc3NOYW1lPWN1cnJlbnQuc2xpY2UoMCxtYXRjaC5pbmRleCkrKGFmdGVyP21hdGNoWzFdK2FmdGVyOlwiXCIpO319O2Z1bmN0aW9uIHJlbW92ZUNoaWxkcmVuKGUpe2Zvcih2YXIgY291bnQ9ZS5jaGlsZE5vZGVzLmxlbmd0aDtjb3VudD4wOy0tY291bnQpe2UucmVtb3ZlQ2hpbGQoZS5maXJzdENoaWxkKTt9cmV0dXJuIGU7fWZ1bmN0aW9uIHJlbW92ZUNoaWxkcmVuQW5kQWRkKHBhcmVudCxlKXtyZXR1cm4gcmVtb3ZlQ2hpbGRyZW4ocGFyZW50KS5hcHBlbmRDaGlsZChlKTt9ZnVuY3Rpb24gZWx0KHRhZyxjb250ZW50LGNsYXNzTmFtZSxzdHlsZSl7dmFyIGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWcpO2lmKGNsYXNzTmFtZSl7ZS5jbGFzc05hbWU9Y2xhc3NOYW1lO31pZihzdHlsZSl7ZS5zdHlsZS5jc3NUZXh0PXN0eWxlO31pZih0eXBlb2YgY29udGVudD09XCJzdHJpbmdcIil7ZS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShjb250ZW50KSk7fWVsc2UgaWYoY29udGVudCl7Zm9yKHZhciBpPTA7aTxjb250ZW50Lmxlbmd0aDsrK2kpe2UuYXBwZW5kQ2hpbGQoY29udGVudFtpXSk7fX1yZXR1cm4gZTt9dmFyIHJhbmdlO2lmKGRvY3VtZW50LmNyZWF0ZVJhbmdlKXtyYW5nZT1mdW5jdGlvbihub2RlLHN0YXJ0LGVuZCxlbmROb2RlKXt2YXIgcj1kb2N1bWVudC5jcmVhdGVSYW5nZSgpO3Iuc2V0RW5kKGVuZE5vZGV8fG5vZGUsZW5kKTtyLnNldFN0YXJ0KG5vZGUsc3RhcnQpO3JldHVybiByO307fWVsc2V7cmFuZ2U9ZnVuY3Rpb24obm9kZSxzdGFydCxlbmQpe3ZhciByPWRvY3VtZW50LmJvZHkuY3JlYXRlVGV4dFJhbmdlKCk7dHJ5e3IubW92ZVRvRWxlbWVudFRleHQobm9kZS5wYXJlbnROb2RlKTt9Y2F0Y2goZSl7cmV0dXJuIHI7fXIuY29sbGFwc2UodHJ1ZSk7ci5tb3ZlRW5kKFwiY2hhcmFjdGVyXCIsZW5kKTtyLm1vdmVTdGFydChcImNoYXJhY3RlclwiLHN0YXJ0KTtyZXR1cm4gcjt9O31mdW5jdGlvbiBjb250YWlucyhwYXJlbnQsY2hpbGQpe2lmKGNoaWxkLm5vZGVUeXBlPT0zKS8vIEFuZHJvaWQgYnJvd3NlciBhbHdheXMgcmV0dXJucyBmYWxzZSB3aGVuIGNoaWxkIGlzIGEgdGV4dG5vZGVcbntjaGlsZD1jaGlsZC5wYXJlbnROb2RlO31pZihwYXJlbnQuY29udGFpbnMpe3JldHVybiBwYXJlbnQuY29udGFpbnMoY2hpbGQpO31kb3tpZihjaGlsZC5ub2RlVHlwZT09MTEpe2NoaWxkPWNoaWxkLmhvc3Q7fWlmKGNoaWxkPT1wYXJlbnQpe3JldHVybiB0cnVlO319d2hpbGUoY2hpbGQ9Y2hpbGQucGFyZW50Tm9kZSk7fXZhciBhY3RpdmVFbHQ9ZnVuY3Rpb24oKXt2YXIgYWN0aXZlRWxlbWVudD1kb2N1bWVudC5hY3RpdmVFbGVtZW50O3doaWxlKGFjdGl2ZUVsZW1lbnQmJmFjdGl2ZUVsZW1lbnQucm9vdCYmYWN0aXZlRWxlbWVudC5yb290LmFjdGl2ZUVsZW1lbnQpe2FjdGl2ZUVsZW1lbnQ9YWN0aXZlRWxlbWVudC5yb290LmFjdGl2ZUVsZW1lbnQ7fXJldHVybiBhY3RpdmVFbGVtZW50O307Ly8gT2xkZXIgdmVyc2lvbnMgb2YgSUUgdGhyb3dzIHVuc3BlY2lmaWVkIGVycm9yIHdoZW4gdG91Y2hpbmdcbi8vIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgaW4gc29tZSBjYXNlcyAoZHVyaW5nIGxvYWRpbmcsIGluIGlmcmFtZSlcbmlmKGllJiZpZV92ZXJzaW9uPDExKXthY3RpdmVFbHQ9ZnVuY3Rpb24oKXt0cnl7cmV0dXJuIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7fWNhdGNoKGUpe3JldHVybiBkb2N1bWVudC5ib2R5O319O31mdW5jdGlvbiBhZGRDbGFzcyhub2RlLGNscyl7dmFyIGN1cnJlbnQ9bm9kZS5jbGFzc05hbWU7aWYoIWNsYXNzVGVzdChjbHMpLnRlc3QoY3VycmVudCkpe25vZGUuY2xhc3NOYW1lKz0oY3VycmVudD9cIiBcIjpcIlwiKStjbHM7fX1mdW5jdGlvbiBqb2luQ2xhc3NlcyhhLGIpe3ZhciBhcz1hLnNwbGl0KFwiIFwiKTtmb3IodmFyIGk9MDtpPGFzLmxlbmd0aDtpKyspe2lmKGFzW2ldJiYhY2xhc3NUZXN0KGFzW2ldKS50ZXN0KGIpKXtiKz1cIiBcIithc1tpXTt9fXJldHVybiBiO312YXIgc2VsZWN0SW5wdXQ9ZnVuY3Rpb24obm9kZSl7bm9kZS5zZWxlY3QoKTt9O2lmKGlvcykvLyBNb2JpbGUgU2FmYXJpIGFwcGFyZW50bHkgaGFzIGEgYnVnIHdoZXJlIHNlbGVjdCgpIGlzIGJyb2tlbi5cbntzZWxlY3RJbnB1dD1mdW5jdGlvbihub2RlKXtub2RlLnNlbGVjdGlvblN0YXJ0PTA7bm9kZS5zZWxlY3Rpb25FbmQ9bm9kZS52YWx1ZS5sZW5ndGg7fTt9ZWxzZSBpZihpZSkvLyBTdXBwcmVzcyBteXN0ZXJpb3VzIElFMTAgZXJyb3JzXG57c2VsZWN0SW5wdXQ9ZnVuY3Rpb24obm9kZSl7dHJ5e25vZGUuc2VsZWN0KCk7fWNhdGNoKF9lKXt9fTt9ZnVuY3Rpb24gYmluZChmKXt2YXIgYXJncz1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSk7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGYuYXBwbHkobnVsbCxhcmdzKTt9O31mdW5jdGlvbiBjb3B5T2JqKG9iaix0YXJnZXQsb3ZlcndyaXRlKXtpZighdGFyZ2V0KXt0YXJnZXQ9e307fWZvcih2YXIgcHJvcCBpbiBvYmope2lmKG9iai5oYXNPd25Qcm9wZXJ0eShwcm9wKSYmKG92ZXJ3cml0ZSE9PWZhbHNlfHwhdGFyZ2V0Lmhhc093blByb3BlcnR5KHByb3ApKSl7dGFyZ2V0W3Byb3BdPW9ialtwcm9wXTt9fXJldHVybiB0YXJnZXQ7fS8vIENvdW50cyB0aGUgY29sdW1uIG9mZnNldCBpbiBhIHN0cmluZywgdGFraW5nIHRhYnMgaW50byBhY2NvdW50LlxuLy8gVXNlZCBtb3N0bHkgdG8gZmluZCBpbmRlbnRhdGlvbi5cbmZ1bmN0aW9uIGNvdW50Q29sdW1uKHN0cmluZyxlbmQsdGFiU2l6ZSxzdGFydEluZGV4LHN0YXJ0VmFsdWUpe2lmKGVuZD09bnVsbCl7ZW5kPXN0cmluZy5zZWFyY2goL1teXFxzXFx1MDBhMF0vKTtpZihlbmQ9PS0xKXtlbmQ9c3RyaW5nLmxlbmd0aDt9fWZvcih2YXIgaT1zdGFydEluZGV4fHwwLG49c3RhcnRWYWx1ZXx8MDs7KXt2YXIgbmV4dFRhYj1zdHJpbmcuaW5kZXhPZihcIlxcdFwiLGkpO2lmKG5leHRUYWI8MHx8bmV4dFRhYj49ZW5kKXtyZXR1cm4gbisoZW5kLWkpO31uKz1uZXh0VGFiLWk7bis9dGFiU2l6ZS1uJXRhYlNpemU7aT1uZXh0VGFiKzE7fX1mdW5jdGlvbiBEZWxheWVkKCl7dGhpcy5pZD1udWxsO31EZWxheWVkLnByb3RvdHlwZS5zZXQ9ZnVuY3Rpb24obXMsZil7Y2xlYXJUaW1lb3V0KHRoaXMuaWQpO3RoaXMuaWQ9c2V0VGltZW91dChmLG1zKTt9O2Z1bmN0aW9uIGluZGV4T2YoYXJyYXksZWx0KXtmb3IodmFyIGk9MDtpPGFycmF5Lmxlbmd0aDsrK2kpe2lmKGFycmF5W2ldPT1lbHQpe3JldHVybiBpO319cmV0dXJuLTE7fS8vIE51bWJlciBvZiBwaXhlbHMgYWRkZWQgdG8gc2Nyb2xsZXIgYW5kIHNpemVyIHRvIGhpZGUgc2Nyb2xsYmFyXG52YXIgc2Nyb2xsZXJHYXA9MzA7Ly8gUmV0dXJuZWQgb3IgdGhyb3duIGJ5IHZhcmlvdXMgcHJvdG9jb2xzIHRvIHNpZ25hbCAnSSdtIG5vdFxuLy8gaGFuZGxpbmcgdGhpcycuXG52YXIgUGFzcz17dG9TdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm5cIkNvZGVNaXJyb3IuUGFzc1wiO319Oy8vIFJldXNlZCBvcHRpb24gb2JqZWN0cyBmb3Igc2V0U2VsZWN0aW9uICYgZnJpZW5kc1xudmFyIHNlbF9kb250U2Nyb2xsPXtzY3JvbGw6ZmFsc2V9O3ZhciBzZWxfbW91c2U9e29yaWdpbjpcIiptb3VzZVwifTt2YXIgc2VsX21vdmU9e29yaWdpbjpcIittb3ZlXCJ9Oy8vIFRoZSBpbnZlcnNlIG9mIGNvdW50Q29sdW1uIC0tIGZpbmQgdGhlIG9mZnNldCB0aGF0IGNvcnJlc3BvbmRzIHRvXG4vLyBhIHBhcnRpY3VsYXIgY29sdW1uLlxuZnVuY3Rpb24gZmluZENvbHVtbihzdHJpbmcsZ29hbCx0YWJTaXplKXtmb3IodmFyIHBvcz0wLGNvbD0wOzspe3ZhciBuZXh0VGFiPXN0cmluZy5pbmRleE9mKFwiXFx0XCIscG9zKTtpZihuZXh0VGFiPT0tMSl7bmV4dFRhYj1zdHJpbmcubGVuZ3RoO312YXIgc2tpcHBlZD1uZXh0VGFiLXBvcztpZihuZXh0VGFiPT1zdHJpbmcubGVuZ3RofHxjb2wrc2tpcHBlZD49Z29hbCl7cmV0dXJuIHBvcytNYXRoLm1pbihza2lwcGVkLGdvYWwtY29sKTt9Y29sKz1uZXh0VGFiLXBvcztjb2wrPXRhYlNpemUtY29sJXRhYlNpemU7cG9zPW5leHRUYWIrMTtpZihjb2w+PWdvYWwpe3JldHVybiBwb3M7fX19dmFyIHNwYWNlU3Rycz1bXCJcIl07ZnVuY3Rpb24gc3BhY2VTdHIobil7d2hpbGUoc3BhY2VTdHJzLmxlbmd0aDw9bil7c3BhY2VTdHJzLnB1c2gobHN0KHNwYWNlU3RycykrXCIgXCIpO31yZXR1cm4gc3BhY2VTdHJzW25dO31mdW5jdGlvbiBsc3QoYXJyKXtyZXR1cm4gYXJyW2Fyci5sZW5ndGgtMV07fWZ1bmN0aW9uIG1hcChhcnJheSxmKXt2YXIgb3V0PVtdO2Zvcih2YXIgaT0wO2k8YXJyYXkubGVuZ3RoO2krKyl7b3V0W2ldPWYoYXJyYXlbaV0saSk7fXJldHVybiBvdXQ7fWZ1bmN0aW9uIGluc2VydFNvcnRlZChhcnJheSx2YWx1ZSxzY29yZSl7dmFyIHBvcz0wLHByaW9yaXR5PXNjb3JlKHZhbHVlKTt3aGlsZShwb3M8YXJyYXkubGVuZ3RoJiZzY29yZShhcnJheVtwb3NdKTw9cHJpb3JpdHkpe3BvcysrO31hcnJheS5zcGxpY2UocG9zLDAsdmFsdWUpO31mdW5jdGlvbiBub3RoaW5nKCl7fWZ1bmN0aW9uIGNyZWF0ZU9iaihiYXNlLHByb3BzKXt2YXIgaW5zdDtpZihPYmplY3QuY3JlYXRlKXtpbnN0PU9iamVjdC5jcmVhdGUoYmFzZSk7fWVsc2V7bm90aGluZy5wcm90b3R5cGU9YmFzZTtpbnN0PW5ldyBub3RoaW5nKCk7fWlmKHByb3BzKXtjb3B5T2JqKHByb3BzLGluc3QpO31yZXR1cm4gaW5zdDt9dmFyIG5vbkFTQ0lJU2luZ2xlQ2FzZVdvcmRDaGFyPS9bXFx1MDBkZlxcdTA1ODdcXHUwNTkwLVxcdTA1ZjRcXHUwNjAwLVxcdTA2ZmZcXHUzMDQwLVxcdTMwOWZcXHUzMGEwLVxcdTMwZmZcXHUzNDAwLVxcdTRkYjVcXHU0ZTAwLVxcdTlmY2NcXHVhYzAwLVxcdWQ3YWZdLztmdW5jdGlvbiBpc1dvcmRDaGFyQmFzaWMoY2gpe3JldHVybiAvXFx3Ly50ZXN0KGNoKXx8Y2g+XCJcXHg4MFwiJiYoY2gudG9VcHBlckNhc2UoKSE9Y2gudG9Mb3dlckNhc2UoKXx8bm9uQVNDSUlTaW5nbGVDYXNlV29yZENoYXIudGVzdChjaCkpO31mdW5jdGlvbiBpc1dvcmRDaGFyKGNoLGhlbHBlcil7aWYoIWhlbHBlcil7cmV0dXJuIGlzV29yZENoYXJCYXNpYyhjaCk7fWlmKGhlbHBlci5zb3VyY2UuaW5kZXhPZihcIlxcXFx3XCIpPi0xJiZpc1dvcmRDaGFyQmFzaWMoY2gpKXtyZXR1cm4gdHJ1ZTt9cmV0dXJuIGhlbHBlci50ZXN0KGNoKTt9ZnVuY3Rpb24gaXNFbXB0eShvYmope2Zvcih2YXIgbiBpbiBvYmope2lmKG9iai5oYXNPd25Qcm9wZXJ0eShuKSYmb2JqW25dKXtyZXR1cm4gZmFsc2U7fX1yZXR1cm4gdHJ1ZTt9Ly8gRXh0ZW5kaW5nIHVuaWNvZGUgY2hhcmFjdGVycy4gQSBzZXJpZXMgb2YgYSBub24tZXh0ZW5kaW5nIGNoYXIgK1xuLy8gYW55IG51bWJlciBvZiBleHRlbmRpbmcgY2hhcnMgaXMgdHJlYXRlZCBhcyBhIHNpbmdsZSB1bml0IGFzIGZhclxuLy8gYXMgZWRpdGluZyBhbmQgbWVhc3VyaW5nIGlzIGNvbmNlcm5lZC4gVGhpcyBpcyBub3QgZnVsbHkgY29ycmVjdCxcbi8vIHNpbmNlIHNvbWUgc2NyaXB0cy9mb250cy9icm93c2VycyBhbHNvIHRyZWF0IG90aGVyIGNvbmZpZ3VyYXRpb25zXG4vLyBvZiBjb2RlIHBvaW50cyBhcyBhIGdyb3VwLlxudmFyIGV4dGVuZGluZ0NoYXJzPS9bXFx1MDMwMC1cXHUwMzZmXFx1MDQ4My1cXHUwNDg5XFx1MDU5MS1cXHUwNWJkXFx1MDViZlxcdTA1YzFcXHUwNWMyXFx1MDVjNFxcdTA1YzVcXHUwNWM3XFx1MDYxMC1cXHUwNjFhXFx1MDY0Yi1cXHUwNjVlXFx1MDY3MFxcdTA2ZDYtXFx1MDZkY1xcdTA2ZGUtXFx1MDZlNFxcdTA2ZTdcXHUwNmU4XFx1MDZlYS1cXHUwNmVkXFx1MDcxMVxcdTA3MzAtXFx1MDc0YVxcdTA3YTYtXFx1MDdiMFxcdTA3ZWItXFx1MDdmM1xcdTA4MTYtXFx1MDgxOVxcdTA4MWItXFx1MDgyM1xcdTA4MjUtXFx1MDgyN1xcdTA4MjktXFx1MDgyZFxcdTA5MDAtXFx1MDkwMlxcdTA5M2NcXHUwOTQxLVxcdTA5NDhcXHUwOTRkXFx1MDk1MS1cXHUwOTU1XFx1MDk2MlxcdTA5NjNcXHUwOTgxXFx1MDliY1xcdTA5YmVcXHUwOWMxLVxcdTA5YzRcXHUwOWNkXFx1MDlkN1xcdTA5ZTJcXHUwOWUzXFx1MGEwMVxcdTBhMDJcXHUwYTNjXFx1MGE0MVxcdTBhNDJcXHUwYTQ3XFx1MGE0OFxcdTBhNGItXFx1MGE0ZFxcdTBhNTFcXHUwYTcwXFx1MGE3MVxcdTBhNzVcXHUwYTgxXFx1MGE4MlxcdTBhYmNcXHUwYWMxLVxcdTBhYzVcXHUwYWM3XFx1MGFjOFxcdTBhY2RcXHUwYWUyXFx1MGFlM1xcdTBiMDFcXHUwYjNjXFx1MGIzZVxcdTBiM2ZcXHUwYjQxLVxcdTBiNDRcXHUwYjRkXFx1MGI1NlxcdTBiNTdcXHUwYjYyXFx1MGI2M1xcdTBiODJcXHUwYmJlXFx1MGJjMFxcdTBiY2RcXHUwYmQ3XFx1MGMzZS1cXHUwYzQwXFx1MGM0Ni1cXHUwYzQ4XFx1MGM0YS1cXHUwYzRkXFx1MGM1NVxcdTBjNTZcXHUwYzYyXFx1MGM2M1xcdTBjYmNcXHUwY2JmXFx1MGNjMlxcdTBjYzZcXHUwY2NjXFx1MGNjZFxcdTBjZDVcXHUwY2Q2XFx1MGNlMlxcdTBjZTNcXHUwZDNlXFx1MGQ0MS1cXHUwZDQ0XFx1MGQ0ZFxcdTBkNTdcXHUwZDYyXFx1MGQ2M1xcdTBkY2FcXHUwZGNmXFx1MGRkMi1cXHUwZGQ0XFx1MGRkNlxcdTBkZGZcXHUwZTMxXFx1MGUzNC1cXHUwZTNhXFx1MGU0Ny1cXHUwZTRlXFx1MGViMVxcdTBlYjQtXFx1MGViOVxcdTBlYmJcXHUwZWJjXFx1MGVjOC1cXHUwZWNkXFx1MGYxOFxcdTBmMTlcXHUwZjM1XFx1MGYzN1xcdTBmMzlcXHUwZjcxLVxcdTBmN2VcXHUwZjgwLVxcdTBmODRcXHUwZjg2XFx1MGY4N1xcdTBmOTAtXFx1MGY5N1xcdTBmOTktXFx1MGZiY1xcdTBmYzZcXHUxMDJkLVxcdTEwMzBcXHUxMDMyLVxcdTEwMzdcXHUxMDM5XFx1MTAzYVxcdTEwM2RcXHUxMDNlXFx1MTA1OFxcdTEwNTlcXHUxMDVlLVxcdTEwNjBcXHUxMDcxLVxcdTEwNzRcXHUxMDgyXFx1MTA4NVxcdTEwODZcXHUxMDhkXFx1MTA5ZFxcdTEzNWZcXHUxNzEyLVxcdTE3MTRcXHUxNzMyLVxcdTE3MzRcXHUxNzUyXFx1MTc1M1xcdTE3NzJcXHUxNzczXFx1MTdiNy1cXHUxN2JkXFx1MTdjNlxcdTE3YzktXFx1MTdkM1xcdTE3ZGRcXHUxODBiLVxcdTE4MGRcXHUxOGE5XFx1MTkyMC1cXHUxOTIyXFx1MTkyN1xcdTE5MjhcXHUxOTMyXFx1MTkzOS1cXHUxOTNiXFx1MWExN1xcdTFhMThcXHUxYTU2XFx1MWE1OC1cXHUxYTVlXFx1MWE2MFxcdTFhNjJcXHUxYTY1LVxcdTFhNmNcXHUxYTczLVxcdTFhN2NcXHUxYTdmXFx1MWIwMC1cXHUxYjAzXFx1MWIzNFxcdTFiMzYtXFx1MWIzYVxcdTFiM2NcXHUxYjQyXFx1MWI2Yi1cXHUxYjczXFx1MWI4MFxcdTFiODFcXHUxYmEyLVxcdTFiYTVcXHUxYmE4XFx1MWJhOVxcdTFjMmMtXFx1MWMzM1xcdTFjMzZcXHUxYzM3XFx1MWNkMC1cXHUxY2QyXFx1MWNkNC1cXHUxY2UwXFx1MWNlMi1cXHUxY2U4XFx1MWNlZFxcdTFkYzAtXFx1MWRlNlxcdTFkZmQtXFx1MWRmZlxcdTIwMGNcXHUyMDBkXFx1MjBkMC1cXHUyMGYwXFx1MmNlZi1cXHUyY2YxXFx1MmRlMC1cXHUyZGZmXFx1MzAyYS1cXHUzMDJmXFx1MzA5OVxcdTMwOWFcXHVhNjZmLVxcdWE2NzJcXHVhNjdjXFx1YTY3ZFxcdWE2ZjBcXHVhNmYxXFx1YTgwMlxcdWE4MDZcXHVhODBiXFx1YTgyNVxcdWE4MjZcXHVhOGM0XFx1YThlMC1cXHVhOGYxXFx1YTkyNi1cXHVhOTJkXFx1YTk0Ny1cXHVhOTUxXFx1YTk4MC1cXHVhOTgyXFx1YTliM1xcdWE5YjYtXFx1YTliOVxcdWE5YmNcXHVhYTI5LVxcdWFhMmVcXHVhYTMxXFx1YWEzMlxcdWFhMzVcXHVhYTM2XFx1YWE0M1xcdWFhNGNcXHVhYWIwXFx1YWFiMi1cXHVhYWI0XFx1YWFiN1xcdWFhYjhcXHVhYWJlXFx1YWFiZlxcdWFhYzFcXHVhYmU1XFx1YWJlOFxcdWFiZWRcXHVkYzAwLVxcdWRmZmZcXHVmYjFlXFx1ZmUwMC1cXHVmZTBmXFx1ZmUyMC1cXHVmZTI2XFx1ZmY5ZVxcdWZmOWZdLztmdW5jdGlvbiBpc0V4dGVuZGluZ0NoYXIoY2gpe3JldHVybiBjaC5jaGFyQ29kZUF0KDApPj03NjgmJmV4dGVuZGluZ0NoYXJzLnRlc3QoY2gpO30vLyBUaGUgZGlzcGxheSBoYW5kbGVzIHRoZSBET00gaW50ZWdyYXRpb24sIGJvdGggZm9yIGlucHV0IHJlYWRpbmdcbi8vIGFuZCBjb250ZW50IGRyYXdpbmcuIEl0IGhvbGRzIHJlZmVyZW5jZXMgdG8gRE9NIG5vZGVzIGFuZFxuLy8gZGlzcGxheS1yZWxhdGVkIHN0YXRlLlxuZnVuY3Rpb24gRGlzcGxheShwbGFjZSxkb2MsaW5wdXQpe3ZhciBkPXRoaXM7dGhpcy5pbnB1dD1pbnB1dDsvLyBDb3ZlcnMgYm90dG9tLXJpZ2h0IHNxdWFyZSB3aGVuIGJvdGggc2Nyb2xsYmFycyBhcmUgcHJlc2VudC5cbmQuc2Nyb2xsYmFyRmlsbGVyPWVsdChcImRpdlwiLG51bGwsXCJDb2RlTWlycm9yLXNjcm9sbGJhci1maWxsZXJcIik7ZC5zY3JvbGxiYXJGaWxsZXIuc2V0QXR0cmlidXRlKFwiY20tbm90LWNvbnRlbnRcIixcInRydWVcIik7Ly8gQ292ZXJzIGJvdHRvbSBvZiBndXR0ZXIgd2hlbiBjb3Zlckd1dHRlck5leHRUb1Njcm9sbGJhciBpcyBvblxuLy8gYW5kIGggc2Nyb2xsYmFyIGlzIHByZXNlbnQuXG5kLmd1dHRlckZpbGxlcj1lbHQoXCJkaXZcIixudWxsLFwiQ29kZU1pcnJvci1ndXR0ZXItZmlsbGVyXCIpO2QuZ3V0dGVyRmlsbGVyLnNldEF0dHJpYnV0ZShcImNtLW5vdC1jb250ZW50XCIsXCJ0cnVlXCIpOy8vIFdpbGwgY29udGFpbiB0aGUgYWN0dWFsIGNvZGUsIHBvc2l0aW9uZWQgdG8gY292ZXIgdGhlIHZpZXdwb3J0LlxuZC5saW5lRGl2PWVsdChcImRpdlwiLG51bGwsXCJDb2RlTWlycm9yLWNvZGVcIik7Ly8gRWxlbWVudHMgYXJlIGFkZGVkIHRvIHRoZXNlIHRvIHJlcHJlc2VudCBzZWxlY3Rpb24gYW5kIGN1cnNvcnMuXG5kLnNlbGVjdGlvbkRpdj1lbHQoXCJkaXZcIixudWxsLG51bGwsXCJwb3NpdGlvbjogcmVsYXRpdmU7IHotaW5kZXg6IDFcIik7ZC5jdXJzb3JEaXY9ZWx0KFwiZGl2XCIsbnVsbCxcIkNvZGVNaXJyb3ItY3Vyc29yc1wiKTsvLyBBIHZpc2liaWxpdHk6IGhpZGRlbiBlbGVtZW50IHVzZWQgdG8gZmluZCB0aGUgc2l6ZSBvZiB0aGluZ3MuXG5kLm1lYXN1cmU9ZWx0KFwiZGl2XCIsbnVsbCxcIkNvZGVNaXJyb3ItbWVhc3VyZVwiKTsvLyBXaGVuIGxpbmVzIG91dHNpZGUgb2YgdGhlIHZpZXdwb3J0IGFyZSBtZWFzdXJlZCwgdGhleSBhcmUgZHJhd24gaW4gdGhpcy5cbmQubGluZU1lYXN1cmU9ZWx0KFwiZGl2XCIsbnVsbCxcIkNvZGVNaXJyb3ItbWVhc3VyZVwiKTsvLyBXcmFwcyBldmVyeXRoaW5nIHRoYXQgbmVlZHMgdG8gZXhpc3QgaW5zaWRlIHRoZSB2ZXJ0aWNhbGx5LXBhZGRlZCBjb29yZGluYXRlIHN5c3RlbVxuZC5saW5lU3BhY2U9ZWx0KFwiZGl2XCIsW2QubWVhc3VyZSxkLmxpbmVNZWFzdXJlLGQuc2VsZWN0aW9uRGl2LGQuY3Vyc29yRGl2LGQubGluZURpdl0sbnVsbCxcInBvc2l0aW9uOiByZWxhdGl2ZTsgb3V0bGluZTogbm9uZVwiKTsvLyBNb3ZlZCBhcm91bmQgaXRzIHBhcmVudCB0byBjb3ZlciB2aXNpYmxlIHZpZXcuXG5kLm1vdmVyPWVsdChcImRpdlwiLFtlbHQoXCJkaXZcIixbZC5saW5lU3BhY2VdLFwiQ29kZU1pcnJvci1saW5lc1wiKV0sbnVsbCxcInBvc2l0aW9uOiByZWxhdGl2ZVwiKTsvLyBTZXQgdG8gdGhlIGhlaWdodCBvZiB0aGUgZG9jdW1lbnQsIGFsbG93aW5nIHNjcm9sbGluZy5cbmQuc2l6ZXI9ZWx0KFwiZGl2XCIsW2QubW92ZXJdLFwiQ29kZU1pcnJvci1zaXplclwiKTtkLnNpemVyV2lkdGg9bnVsbDsvLyBCZWhhdmlvciBvZiBlbHRzIHdpdGggb3ZlcmZsb3c6IGF1dG8gYW5kIHBhZGRpbmcgaXNcbi8vIGluY29uc2lzdGVudCBhY3Jvc3MgYnJvd3NlcnMuIFRoaXMgaXMgdXNlZCB0byBlbnN1cmUgdGhlXG4vLyBzY3JvbGxhYmxlIGFyZWEgaXMgYmlnIGVub3VnaC5cbmQuaGVpZ2h0Rm9yY2VyPWVsdChcImRpdlwiLG51bGwsbnVsbCxcInBvc2l0aW9uOiBhYnNvbHV0ZTsgaGVpZ2h0OiBcIitzY3JvbGxlckdhcCtcInB4OyB3aWR0aDogMXB4O1wiKTsvLyBXaWxsIGNvbnRhaW4gdGhlIGd1dHRlcnMsIGlmIGFueS5cbmQuZ3V0dGVycz1lbHQoXCJkaXZcIixudWxsLFwiQ29kZU1pcnJvci1ndXR0ZXJzXCIpO2QubGluZUd1dHRlcj1udWxsOy8vIEFjdHVhbCBzY3JvbGxhYmxlIGVsZW1lbnQuXG5kLnNjcm9sbGVyPWVsdChcImRpdlwiLFtkLnNpemVyLGQuaGVpZ2h0Rm9yY2VyLGQuZ3V0dGVyc10sXCJDb2RlTWlycm9yLXNjcm9sbFwiKTtkLnNjcm9sbGVyLnNldEF0dHJpYnV0ZShcInRhYkluZGV4XCIsXCItMVwiKTsvLyBUaGUgZWxlbWVudCBpbiB3aGljaCB0aGUgZWRpdG9yIGxpdmVzLlxuZC53cmFwcGVyPWVsdChcImRpdlwiLFtkLnNjcm9sbGJhckZpbGxlcixkLmd1dHRlckZpbGxlcixkLnNjcm9sbGVyXSxcIkNvZGVNaXJyb3JcIik7Ly8gV29yayBhcm91bmQgSUU3IHotaW5kZXggYnVnIChub3QgcGVyZmVjdCwgaGVuY2UgSUU3IG5vdCByZWFsbHkgYmVpbmcgc3VwcG9ydGVkKVxuaWYoaWUmJmllX3ZlcnNpb248OCl7ZC5ndXR0ZXJzLnN0eWxlLnpJbmRleD0tMTtkLnNjcm9sbGVyLnN0eWxlLnBhZGRpbmdSaWdodD0wO31pZighd2Via2l0JiYhKGdlY2tvJiZtb2JpbGUpKXtkLnNjcm9sbGVyLmRyYWdnYWJsZT10cnVlO31pZihwbGFjZSl7aWYocGxhY2UuYXBwZW5kQ2hpbGQpe3BsYWNlLmFwcGVuZENoaWxkKGQud3JhcHBlcik7fWVsc2V7cGxhY2UoZC53cmFwcGVyKTt9fS8vIEN1cnJlbnQgcmVuZGVyZWQgcmFuZ2UgKG1heSBiZSBiaWdnZXIgdGhhbiB0aGUgdmlldyB3aW5kb3cpLlxuZC52aWV3RnJvbT1kLnZpZXdUbz1kb2MuZmlyc3Q7ZC5yZXBvcnRlZFZpZXdGcm9tPWQucmVwb3J0ZWRWaWV3VG89ZG9jLmZpcnN0Oy8vIEluZm9ybWF0aW9uIGFib3V0IHRoZSByZW5kZXJlZCBsaW5lcy5cbmQudmlldz1bXTtkLnJlbmRlcmVkVmlldz1udWxsOy8vIEhvbGRzIGluZm8gYWJvdXQgYSBzaW5nbGUgcmVuZGVyZWQgbGluZSB3aGVuIGl0IHdhcyByZW5kZXJlZFxuLy8gZm9yIG1lYXN1cmVtZW50LCB3aGlsZSBub3QgaW4gdmlldy5cbmQuZXh0ZXJuYWxNZWFzdXJlZD1udWxsOy8vIEVtcHR5IHNwYWNlIChpbiBwaXhlbHMpIGFib3ZlIHRoZSB2aWV3XG5kLnZpZXdPZmZzZXQ9MDtkLmxhc3RXcmFwSGVpZ2h0PWQubGFzdFdyYXBXaWR0aD0wO2QudXBkYXRlTGluZU51bWJlcnM9bnVsbDtkLm5hdGl2ZUJhcldpZHRoPWQuYmFySGVpZ2h0PWQuYmFyV2lkdGg9MDtkLnNjcm9sbGJhcnNDbGlwcGVkPWZhbHNlOy8vIFVzZWQgdG8gb25seSByZXNpemUgdGhlIGxpbmUgbnVtYmVyIGd1dHRlciB3aGVuIG5lY2Vzc2FyeSAod2hlblxuLy8gdGhlIGFtb3VudCBvZiBsaW5lcyBjcm9zc2VzIGEgYm91bmRhcnkgdGhhdCBtYWtlcyBpdHMgd2lkdGggY2hhbmdlKVxuZC5saW5lTnVtV2lkdGg9ZC5saW5lTnVtSW5uZXJXaWR0aD1kLmxpbmVOdW1DaGFycz1udWxsOy8vIFNldCB0byB0cnVlIHdoZW4gYSBub24taG9yaXpvbnRhbC1zY3JvbGxpbmcgbGluZSB3aWRnZXQgaXNcbi8vIGFkZGVkLiBBcyBhbiBvcHRpbWl6YXRpb24sIGxpbmUgd2lkZ2V0IGFsaWduaW5nIGlzIHNraXBwZWQgd2hlblxuLy8gdGhpcyBpcyBmYWxzZS5cbmQuYWxpZ25XaWRnZXRzPWZhbHNlO2QuY2FjaGVkQ2hhcldpZHRoPWQuY2FjaGVkVGV4dEhlaWdodD1kLmNhY2hlZFBhZGRpbmdIPW51bGw7Ly8gVHJhY2tzIHRoZSBtYXhpbXVtIGxpbmUgbGVuZ3RoIHNvIHRoYXQgdGhlIGhvcml6b250YWwgc2Nyb2xsYmFyXG4vLyBjYW4gYmUga2VwdCBzdGF0aWMgd2hlbiBzY3JvbGxpbmcuXG5kLm1heExpbmU9bnVsbDtkLm1heExpbmVMZW5ndGg9MDtkLm1heExpbmVDaGFuZ2VkPWZhbHNlOy8vIFVzZWQgZm9yIG1lYXN1cmluZyB3aGVlbCBzY3JvbGxpbmcgZ3JhbnVsYXJpdHlcbmQud2hlZWxEWD1kLndoZWVsRFk9ZC53aGVlbFN0YXJ0WD1kLndoZWVsU3RhcnRZPW51bGw7Ly8gVHJ1ZSB3aGVuIHNoaWZ0IGlzIGhlbGQgZG93bi5cbmQuc2hpZnQ9ZmFsc2U7Ly8gVXNlZCB0byB0cmFjayB3aGV0aGVyIGFueXRoaW5nIGhhcHBlbmVkIHNpbmNlIHRoZSBjb250ZXh0IG1lbnVcbi8vIHdhcyBvcGVuZWQuXG5kLnNlbEZvckNvbnRleHRNZW51PW51bGw7ZC5hY3RpdmVUb3VjaD1udWxsO2lucHV0LmluaXQoZCk7fS8vIEZpbmQgdGhlIGxpbmUgb2JqZWN0IGNvcnJlc3BvbmRpbmcgdG8gdGhlIGdpdmVuIGxpbmUgbnVtYmVyLlxuZnVuY3Rpb24gZ2V0TGluZShkb2Msbil7bi09ZG9jLmZpcnN0O2lmKG48MHx8bj49ZG9jLnNpemUpe3Rocm93IG5ldyBFcnJvcihcIlRoZXJlIGlzIG5vIGxpbmUgXCIrKG4rZG9jLmZpcnN0KStcIiBpbiB0aGUgZG9jdW1lbnQuXCIpO312YXIgY2h1bms9ZG9jO3doaWxlKCFjaHVuay5saW5lcyl7Zm9yKHZhciBpPTA7OysraSl7dmFyIGNoaWxkPWNodW5rLmNoaWxkcmVuW2ldLHN6PWNoaWxkLmNodW5rU2l6ZSgpO2lmKG48c3ope2NodW5rPWNoaWxkO2JyZWFrO31uLT1zejt9fXJldHVybiBjaHVuay5saW5lc1tuXTt9Ly8gR2V0IHRoZSBwYXJ0IG9mIGEgZG9jdW1lbnQgYmV0d2VlbiB0d28gcG9zaXRpb25zLCBhcyBhbiBhcnJheSBvZlxuLy8gc3RyaW5ncy5cbmZ1bmN0aW9uIGdldEJldHdlZW4oZG9jLHN0YXJ0LGVuZCl7dmFyIG91dD1bXSxuPXN0YXJ0LmxpbmU7ZG9jLml0ZXIoc3RhcnQubGluZSxlbmQubGluZSsxLGZ1bmN0aW9uKGxpbmUpe3ZhciB0ZXh0PWxpbmUudGV4dDtpZihuPT1lbmQubGluZSl7dGV4dD10ZXh0LnNsaWNlKDAsZW5kLmNoKTt9aWYobj09c3RhcnQubGluZSl7dGV4dD10ZXh0LnNsaWNlKHN0YXJ0LmNoKTt9b3V0LnB1c2godGV4dCk7KytuO30pO3JldHVybiBvdXQ7fS8vIEdldCB0aGUgbGluZXMgYmV0d2VlbiBmcm9tIGFuZCB0bywgYXMgYXJyYXkgb2Ygc3RyaW5ncy5cbmZ1bmN0aW9uIGdldExpbmVzKGRvYyxmcm9tLHRvKXt2YXIgb3V0PVtdO2RvYy5pdGVyKGZyb20sdG8sZnVuY3Rpb24obGluZSl7b3V0LnB1c2gobGluZS50ZXh0KTt9KTsvLyBpdGVyIGFib3J0cyB3aGVuIGNhbGxiYWNrIHJldHVybnMgdHJ1dGh5IHZhbHVlXG5yZXR1cm4gb3V0O30vLyBVcGRhdGUgdGhlIGhlaWdodCBvZiBhIGxpbmUsIHByb3BhZ2F0aW5nIHRoZSBoZWlnaHQgY2hhbmdlXG4vLyB1cHdhcmRzIHRvIHBhcmVudCBub2Rlcy5cbmZ1bmN0aW9uIHVwZGF0ZUxpbmVIZWlnaHQobGluZSxoZWlnaHQpe3ZhciBkaWZmPWhlaWdodC1saW5lLmhlaWdodDtpZihkaWZmKXtmb3IodmFyIG49bGluZTtuO249bi5wYXJlbnQpe24uaGVpZ2h0Kz1kaWZmO319fS8vIEdpdmVuIGEgbGluZSBvYmplY3QsIGZpbmQgaXRzIGxpbmUgbnVtYmVyIGJ5IHdhbGtpbmcgdXAgdGhyb3VnaFxuLy8gaXRzIHBhcmVudCBsaW5rcy5cbmZ1bmN0aW9uIGxpbmVObyhsaW5lKXtpZihsaW5lLnBhcmVudD09bnVsbCl7cmV0dXJuIG51bGw7fXZhciBjdXI9bGluZS5wYXJlbnQsbm89aW5kZXhPZihjdXIubGluZXMsbGluZSk7Zm9yKHZhciBjaHVuaz1jdXIucGFyZW50O2NodW5rO2N1cj1jaHVuayxjaHVuaz1jaHVuay5wYXJlbnQpe2Zvcih2YXIgaT0wOzsrK2kpe2lmKGNodW5rLmNoaWxkcmVuW2ldPT1jdXIpe2JyZWFrO31ubys9Y2h1bmsuY2hpbGRyZW5baV0uY2h1bmtTaXplKCk7fX1yZXR1cm4gbm8rY3VyLmZpcnN0O30vLyBGaW5kIHRoZSBsaW5lIGF0IHRoZSBnaXZlbiB2ZXJ0aWNhbCBwb3NpdGlvbiwgdXNpbmcgdGhlIGhlaWdodFxuLy8gaW5mb3JtYXRpb24gaW4gdGhlIGRvY3VtZW50IHRyZWUuXG5mdW5jdGlvbiBsaW5lQXRIZWlnaHQoY2h1bmssaCl7dmFyIG49Y2h1bmsuZmlyc3Q7b3V0ZXI6ZG97Zm9yKHZhciBpJDE9MDtpJDE8Y2h1bmsuY2hpbGRyZW4ubGVuZ3RoOysraSQxKXt2YXIgY2hpbGQ9Y2h1bmsuY2hpbGRyZW5baSQxXSxjaD1jaGlsZC5oZWlnaHQ7aWYoaDxjaCl7Y2h1bms9Y2hpbGQ7Y29udGludWUgb3V0ZXI7fWgtPWNoO24rPWNoaWxkLmNodW5rU2l6ZSgpO31yZXR1cm4gbjt9d2hpbGUoIWNodW5rLmxpbmVzKTt2YXIgaT0wO2Zvcig7aTxjaHVuay5saW5lcy5sZW5ndGg7KytpKXt2YXIgbGluZT1jaHVuay5saW5lc1tpXSxsaD1saW5lLmhlaWdodDtpZihoPGxoKXticmVhazt9aC09bGg7fXJldHVybiBuK2k7fWZ1bmN0aW9uIGlzTGluZShkb2MsbCl7cmV0dXJuIGw+PWRvYy5maXJzdCYmbDxkb2MuZmlyc3QrZG9jLnNpemU7fWZ1bmN0aW9uIGxpbmVOdW1iZXJGb3Iob3B0aW9ucyxpKXtyZXR1cm4gU3RyaW5nKG9wdGlvbnMubGluZU51bWJlckZvcm1hdHRlcihpK29wdGlvbnMuZmlyc3RMaW5lTnVtYmVyKSk7fS8vIEEgUG9zIGluc3RhbmNlIHJlcHJlc2VudHMgYSBwb3NpdGlvbiB3aXRoaW4gdGhlIHRleHQuXG5mdW5jdGlvbiBQb3MobGluZSxjaCl7aWYoISh0aGlzIGluc3RhbmNlb2YgUG9zKSl7cmV0dXJuIG5ldyBQb3MobGluZSxjaCk7fXRoaXMubGluZT1saW5lO3RoaXMuY2g9Y2g7fS8vIENvbXBhcmUgdHdvIHBvc2l0aW9ucywgcmV0dXJuIDAgaWYgdGhleSBhcmUgdGhlIHNhbWUsIGEgbmVnYXRpdmVcbi8vIG51bWJlciB3aGVuIGEgaXMgbGVzcywgYW5kIGEgcG9zaXRpdmUgbnVtYmVyIG90aGVyd2lzZS5cbmZ1bmN0aW9uIGNtcChhLGIpe3JldHVybiBhLmxpbmUtYi5saW5lfHxhLmNoLWIuY2g7fWZ1bmN0aW9uIGNvcHlQb3MoeCl7cmV0dXJuIFBvcyh4LmxpbmUseC5jaCk7fWZ1bmN0aW9uIG1heFBvcyhhLGIpe3JldHVybiBjbXAoYSxiKTwwP2I6YTt9ZnVuY3Rpb24gbWluUG9zKGEsYil7cmV0dXJuIGNtcChhLGIpPDA/YTpiO30vLyBNb3N0IG9mIHRoZSBleHRlcm5hbCBBUEkgY2xpcHMgZ2l2ZW4gcG9zaXRpb25zIHRvIG1ha2Ugc3VyZSB0aGV5XG4vLyBhY3R1YWxseSBleGlzdCB3aXRoaW4gdGhlIGRvY3VtZW50LlxuZnVuY3Rpb24gY2xpcExpbmUoZG9jLG4pe3JldHVybiBNYXRoLm1heChkb2MuZmlyc3QsTWF0aC5taW4obixkb2MuZmlyc3QrZG9jLnNpemUtMSkpO31mdW5jdGlvbiBjbGlwUG9zKGRvYyxwb3Mpe2lmKHBvcy5saW5lPGRvYy5maXJzdCl7cmV0dXJuIFBvcyhkb2MuZmlyc3QsMCk7fXZhciBsYXN0PWRvYy5maXJzdCtkb2Muc2l6ZS0xO2lmKHBvcy5saW5lPmxhc3Qpe3JldHVybiBQb3MobGFzdCxnZXRMaW5lKGRvYyxsYXN0KS50ZXh0Lmxlbmd0aCk7fXJldHVybiBjbGlwVG9MZW4ocG9zLGdldExpbmUoZG9jLHBvcy5saW5lKS50ZXh0Lmxlbmd0aCk7fWZ1bmN0aW9uIGNsaXBUb0xlbihwb3MsbGluZWxlbil7dmFyIGNoPXBvcy5jaDtpZihjaD09bnVsbHx8Y2g+bGluZWxlbil7cmV0dXJuIFBvcyhwb3MubGluZSxsaW5lbGVuKTt9ZWxzZSBpZihjaDwwKXtyZXR1cm4gUG9zKHBvcy5saW5lLDApO31lbHNle3JldHVybiBwb3M7fX1mdW5jdGlvbiBjbGlwUG9zQXJyYXkoZG9jLGFycmF5KXt2YXIgb3V0PVtdO2Zvcih2YXIgaT0wO2k8YXJyYXkubGVuZ3RoO2krKyl7b3V0W2ldPWNsaXBQb3MoZG9jLGFycmF5W2ldKTt9cmV0dXJuIG91dDt9Ly8gT3B0aW1pemUgc29tZSBjb2RlIHdoZW4gdGhlc2UgZmVhdHVyZXMgYXJlIG5vdCB1c2VkLlxudmFyIHNhd1JlYWRPbmx5U3BhbnM9ZmFsc2U7dmFyIHNhd0NvbGxhcHNlZFNwYW5zPWZhbHNlO2Z1bmN0aW9uIHNlZVJlYWRPbmx5U3BhbnMoKXtzYXdSZWFkT25seVNwYW5zPXRydWU7fWZ1bmN0aW9uIHNlZUNvbGxhcHNlZFNwYW5zKCl7c2F3Q29sbGFwc2VkU3BhbnM9dHJ1ZTt9Ly8gVEVYVE1BUktFUiBTUEFOU1xuZnVuY3Rpb24gTWFya2VkU3BhbihtYXJrZXIsZnJvbSx0byl7dGhpcy5tYXJrZXI9bWFya2VyO3RoaXMuZnJvbT1mcm9tO3RoaXMudG89dG87fS8vIFNlYXJjaCBhbiBhcnJheSBvZiBzcGFucyBmb3IgYSBzcGFuIG1hdGNoaW5nIHRoZSBnaXZlbiBtYXJrZXIuXG5mdW5jdGlvbiBnZXRNYXJrZWRTcGFuRm9yKHNwYW5zLG1hcmtlcil7aWYoc3BhbnMpe2Zvcih2YXIgaT0wO2k8c3BhbnMubGVuZ3RoOysraSl7dmFyIHNwYW49c3BhbnNbaV07aWYoc3Bhbi5tYXJrZXI9PW1hcmtlcil7cmV0dXJuIHNwYW47fX19fS8vIFJlbW92ZSBhIHNwYW4gZnJvbSBhbiBhcnJheSwgcmV0dXJuaW5nIHVuZGVmaW5lZCBpZiBubyBzcGFucyBhcmVcbi8vIGxlZnQgKHdlIGRvbid0IHN0b3JlIGFycmF5cyBmb3IgbGluZXMgd2l0aG91dCBzcGFucykuXG5mdW5jdGlvbiByZW1vdmVNYXJrZWRTcGFuKHNwYW5zLHNwYW4pe3ZhciByO2Zvcih2YXIgaT0wO2k8c3BhbnMubGVuZ3RoOysraSl7aWYoc3BhbnNbaV0hPXNwYW4peyhyfHwocj1bXSkpLnB1c2goc3BhbnNbaV0pO319cmV0dXJuIHI7fS8vIEFkZCBhIHNwYW4gdG8gYSBsaW5lLlxuZnVuY3Rpb24gYWRkTWFya2VkU3BhbihsaW5lLHNwYW4pe2xpbmUubWFya2VkU3BhbnM9bGluZS5tYXJrZWRTcGFucz9saW5lLm1hcmtlZFNwYW5zLmNvbmNhdChbc3Bhbl0pOltzcGFuXTtzcGFuLm1hcmtlci5hdHRhY2hMaW5lKGxpbmUpO30vLyBVc2VkIGZvciB0aGUgYWxnb3JpdGhtIHRoYXQgYWRqdXN0cyBtYXJrZXJzIGZvciBhIGNoYW5nZSBpbiB0aGVcbi8vIGRvY3VtZW50LiBUaGVzZSBmdW5jdGlvbnMgY3V0IGFuIGFycmF5IG9mIHNwYW5zIGF0IGEgZ2l2ZW5cbi8vIGNoYXJhY3RlciBwb3NpdGlvbiwgcmV0dXJuaW5nIGFuIGFycmF5IG9mIHJlbWFpbmluZyBjaHVua3MgKG9yXG4vLyB1bmRlZmluZWQgaWYgbm90aGluZyByZW1haW5zKS5cbmZ1bmN0aW9uIG1hcmtlZFNwYW5zQmVmb3JlKG9sZCxzdGFydENoLGlzSW5zZXJ0KXt2YXIgbnc7aWYob2xkKXtmb3IodmFyIGk9MDtpPG9sZC5sZW5ndGg7KytpKXt2YXIgc3Bhbj1vbGRbaV0sbWFya2VyPXNwYW4ubWFya2VyO3ZhciBzdGFydHNCZWZvcmU9c3Bhbi5mcm9tPT1udWxsfHwobWFya2VyLmluY2x1c2l2ZUxlZnQ/c3Bhbi5mcm9tPD1zdGFydENoOnNwYW4uZnJvbTxzdGFydENoKTtpZihzdGFydHNCZWZvcmV8fHNwYW4uZnJvbT09c3RhcnRDaCYmbWFya2VyLnR5cGU9PVwiYm9va21hcmtcIiYmKCFpc0luc2VydHx8IXNwYW4ubWFya2VyLmluc2VydExlZnQpKXt2YXIgZW5kc0FmdGVyPXNwYW4udG89PW51bGx8fChtYXJrZXIuaW5jbHVzaXZlUmlnaHQ/c3Bhbi50bz49c3RhcnRDaDpzcGFuLnRvPnN0YXJ0Q2gpOyhud3x8KG53PVtdKSkucHVzaChuZXcgTWFya2VkU3BhbihtYXJrZXIsc3Bhbi5mcm9tLGVuZHNBZnRlcj9udWxsOnNwYW4udG8pKTt9fX1yZXR1cm4gbnc7fWZ1bmN0aW9uIG1hcmtlZFNwYW5zQWZ0ZXIob2xkLGVuZENoLGlzSW5zZXJ0KXt2YXIgbnc7aWYob2xkKXtmb3IodmFyIGk9MDtpPG9sZC5sZW5ndGg7KytpKXt2YXIgc3Bhbj1vbGRbaV0sbWFya2VyPXNwYW4ubWFya2VyO3ZhciBlbmRzQWZ0ZXI9c3Bhbi50bz09bnVsbHx8KG1hcmtlci5pbmNsdXNpdmVSaWdodD9zcGFuLnRvPj1lbmRDaDpzcGFuLnRvPmVuZENoKTtpZihlbmRzQWZ0ZXJ8fHNwYW4uZnJvbT09ZW5kQ2gmJm1hcmtlci50eXBlPT1cImJvb2ttYXJrXCImJighaXNJbnNlcnR8fHNwYW4ubWFya2VyLmluc2VydExlZnQpKXt2YXIgc3RhcnRzQmVmb3JlPXNwYW4uZnJvbT09bnVsbHx8KG1hcmtlci5pbmNsdXNpdmVMZWZ0P3NwYW4uZnJvbTw9ZW5kQ2g6c3Bhbi5mcm9tPGVuZENoKTsobnd8fChudz1bXSkpLnB1c2gobmV3IE1hcmtlZFNwYW4obWFya2VyLHN0YXJ0c0JlZm9yZT9udWxsOnNwYW4uZnJvbS1lbmRDaCxzcGFuLnRvPT1udWxsP251bGw6c3Bhbi50by1lbmRDaCkpO319fXJldHVybiBudzt9Ly8gR2l2ZW4gYSBjaGFuZ2Ugb2JqZWN0LCBjb21wdXRlIHRoZSBuZXcgc2V0IG9mIG1hcmtlciBzcGFucyB0aGF0XG4vLyBjb3ZlciB0aGUgbGluZSBpbiB3aGljaCB0aGUgY2hhbmdlIHRvb2sgcGxhY2UuIFJlbW92ZXMgc3BhbnNcbi8vIGVudGlyZWx5IHdpdGhpbiB0aGUgY2hhbmdlLCByZWNvbm5lY3RzIHNwYW5zIGJlbG9uZ2luZyB0byB0aGVcbi8vIHNhbWUgbWFya2VyIHRoYXQgYXBwZWFyIG9uIGJvdGggc2lkZXMgb2YgdGhlIGNoYW5nZSwgYW5kIGN1dHMgb2ZmXG4vLyBzcGFucyBwYXJ0aWFsbHkgd2l0aGluIHRoZSBjaGFuZ2UuIFJldHVybnMgYW4gYXJyYXkgb2Ygc3BhblxuLy8gYXJyYXlzIHdpdGggb25lIGVsZW1lbnQgZm9yIGVhY2ggbGluZSBpbiAoYWZ0ZXIpIHRoZSBjaGFuZ2UuXG5mdW5jdGlvbiBzdHJldGNoU3BhbnNPdmVyQ2hhbmdlKGRvYyxjaGFuZ2Upe2lmKGNoYW5nZS5mdWxsKXtyZXR1cm4gbnVsbDt9dmFyIG9sZEZpcnN0PWlzTGluZShkb2MsY2hhbmdlLmZyb20ubGluZSkmJmdldExpbmUoZG9jLGNoYW5nZS5mcm9tLmxpbmUpLm1hcmtlZFNwYW5zO3ZhciBvbGRMYXN0PWlzTGluZShkb2MsY2hhbmdlLnRvLmxpbmUpJiZnZXRMaW5lKGRvYyxjaGFuZ2UudG8ubGluZSkubWFya2VkU3BhbnM7aWYoIW9sZEZpcnN0JiYhb2xkTGFzdCl7cmV0dXJuIG51bGw7fXZhciBzdGFydENoPWNoYW5nZS5mcm9tLmNoLGVuZENoPWNoYW5nZS50by5jaCxpc0luc2VydD1jbXAoY2hhbmdlLmZyb20sY2hhbmdlLnRvKT09MDsvLyBHZXQgdGhlIHNwYW5zIHRoYXQgJ3N0aWNrIG91dCcgb24gYm90aCBzaWRlc1xudmFyIGZpcnN0PW1hcmtlZFNwYW5zQmVmb3JlKG9sZEZpcnN0LHN0YXJ0Q2gsaXNJbnNlcnQpO3ZhciBsYXN0PW1hcmtlZFNwYW5zQWZ0ZXIob2xkTGFzdCxlbmRDaCxpc0luc2VydCk7Ly8gTmV4dCwgbWVyZ2UgdGhvc2UgdHdvIGVuZHNcbnZhciBzYW1lTGluZT1jaGFuZ2UudGV4dC5sZW5ndGg9PTEsb2Zmc2V0PWxzdChjaGFuZ2UudGV4dCkubGVuZ3RoKyhzYW1lTGluZT9zdGFydENoOjApO2lmKGZpcnN0KXsvLyBGaXggdXAgLnRvIHByb3BlcnRpZXMgb2YgZmlyc3RcbmZvcih2YXIgaT0wO2k8Zmlyc3QubGVuZ3RoOysraSl7dmFyIHNwYW49Zmlyc3RbaV07aWYoc3Bhbi50bz09bnVsbCl7dmFyIGZvdW5kPWdldE1hcmtlZFNwYW5Gb3IobGFzdCxzcGFuLm1hcmtlcik7aWYoIWZvdW5kKXtzcGFuLnRvPXN0YXJ0Q2g7fWVsc2UgaWYoc2FtZUxpbmUpe3NwYW4udG89Zm91bmQudG89PW51bGw/bnVsbDpmb3VuZC50bytvZmZzZXQ7fX19fWlmKGxhc3Qpey8vIEZpeCB1cCAuZnJvbSBpbiBsYXN0IChvciBtb3ZlIHRoZW0gaW50byBmaXJzdCBpbiBjYXNlIG9mIHNhbWVMaW5lKVxuZm9yKHZhciBpJDE9MDtpJDE8bGFzdC5sZW5ndGg7KytpJDEpe3ZhciBzcGFuJDE9bGFzdFtpJDFdO2lmKHNwYW4kMS50byE9bnVsbCl7c3BhbiQxLnRvKz1vZmZzZXQ7fWlmKHNwYW4kMS5mcm9tPT1udWxsKXt2YXIgZm91bmQkMT1nZXRNYXJrZWRTcGFuRm9yKGZpcnN0LHNwYW4kMS5tYXJrZXIpO2lmKCFmb3VuZCQxKXtzcGFuJDEuZnJvbT1vZmZzZXQ7aWYoc2FtZUxpbmUpeyhmaXJzdHx8KGZpcnN0PVtdKSkucHVzaChzcGFuJDEpO319fWVsc2V7c3BhbiQxLmZyb20rPW9mZnNldDtpZihzYW1lTGluZSl7KGZpcnN0fHwoZmlyc3Q9W10pKS5wdXNoKHNwYW4kMSk7fX19fS8vIE1ha2Ugc3VyZSB3ZSBkaWRuJ3QgY3JlYXRlIGFueSB6ZXJvLWxlbmd0aCBzcGFuc1xuaWYoZmlyc3Qpe2ZpcnN0PWNsZWFyRW1wdHlTcGFucyhmaXJzdCk7fWlmKGxhc3QmJmxhc3QhPWZpcnN0KXtsYXN0PWNsZWFyRW1wdHlTcGFucyhsYXN0KTt9dmFyIG5ld01hcmtlcnM9W2ZpcnN0XTtpZighc2FtZUxpbmUpey8vIEZpbGwgZ2FwIHdpdGggd2hvbGUtbGluZS1zcGFuc1xudmFyIGdhcD1jaGFuZ2UudGV4dC5sZW5ndGgtMixnYXBNYXJrZXJzO2lmKGdhcD4wJiZmaXJzdCl7Zm9yKHZhciBpJDI9MDtpJDI8Zmlyc3QubGVuZ3RoOysraSQyKXtpZihmaXJzdFtpJDJdLnRvPT1udWxsKXsoZ2FwTWFya2Vyc3x8KGdhcE1hcmtlcnM9W10pKS5wdXNoKG5ldyBNYXJrZWRTcGFuKGZpcnN0W2kkMl0ubWFya2VyLG51bGwsbnVsbCkpO319fWZvcih2YXIgaSQzPTA7aSQzPGdhcDsrK2kkMyl7bmV3TWFya2Vycy5wdXNoKGdhcE1hcmtlcnMpO31uZXdNYXJrZXJzLnB1c2gobGFzdCk7fXJldHVybiBuZXdNYXJrZXJzO30vLyBSZW1vdmUgc3BhbnMgdGhhdCBhcmUgZW1wdHkgYW5kIGRvbid0IGhhdmUgYSBjbGVhcldoZW5FbXB0eVxuLy8gb3B0aW9uIG9mIGZhbHNlLlxuZnVuY3Rpb24gY2xlYXJFbXB0eVNwYW5zKHNwYW5zKXtmb3IodmFyIGk9MDtpPHNwYW5zLmxlbmd0aDsrK2kpe3ZhciBzcGFuPXNwYW5zW2ldO2lmKHNwYW4uZnJvbSE9bnVsbCYmc3Bhbi5mcm9tPT1zcGFuLnRvJiZzcGFuLm1hcmtlci5jbGVhcldoZW5FbXB0eSE9PWZhbHNlKXtzcGFucy5zcGxpY2UoaS0tLDEpO319aWYoIXNwYW5zLmxlbmd0aCl7cmV0dXJuIG51bGw7fXJldHVybiBzcGFuczt9Ly8gVXNlZCB0byAnY2xpcCcgb3V0IHJlYWRPbmx5IHJhbmdlcyB3aGVuIG1ha2luZyBhIGNoYW5nZS5cbmZ1bmN0aW9uIHJlbW92ZVJlYWRPbmx5UmFuZ2VzKGRvYyxmcm9tLHRvKXt2YXIgbWFya2Vycz1udWxsO2RvYy5pdGVyKGZyb20ubGluZSx0by5saW5lKzEsZnVuY3Rpb24obGluZSl7aWYobGluZS5tYXJrZWRTcGFucyl7Zm9yKHZhciBpPTA7aTxsaW5lLm1hcmtlZFNwYW5zLmxlbmd0aDsrK2kpe3ZhciBtYXJrPWxpbmUubWFya2VkU3BhbnNbaV0ubWFya2VyO2lmKG1hcmsucmVhZE9ubHkmJighbWFya2Vyc3x8aW5kZXhPZihtYXJrZXJzLG1hcmspPT0tMSkpeyhtYXJrZXJzfHwobWFya2Vycz1bXSkpLnB1c2gobWFyayk7fX19fSk7aWYoIW1hcmtlcnMpe3JldHVybiBudWxsO312YXIgcGFydHM9W3tmcm9tOmZyb20sdG86dG99XTtmb3IodmFyIGk9MDtpPG1hcmtlcnMubGVuZ3RoOysraSl7dmFyIG1rPW1hcmtlcnNbaV0sbT1tay5maW5kKDApO2Zvcih2YXIgaj0wO2o8cGFydHMubGVuZ3RoOysrail7dmFyIHA9cGFydHNbal07aWYoY21wKHAudG8sbS5mcm9tKTwwfHxjbXAocC5mcm9tLG0udG8pPjApe2NvbnRpbnVlO312YXIgbmV3UGFydHM9W2osMV0sZGZyb209Y21wKHAuZnJvbSxtLmZyb20pLGR0bz1jbXAocC50byxtLnRvKTtpZihkZnJvbTwwfHwhbWsuaW5jbHVzaXZlTGVmdCYmIWRmcm9tKXtuZXdQYXJ0cy5wdXNoKHtmcm9tOnAuZnJvbSx0bzptLmZyb219KTt9aWYoZHRvPjB8fCFtay5pbmNsdXNpdmVSaWdodCYmIWR0byl7bmV3UGFydHMucHVzaCh7ZnJvbTptLnRvLHRvOnAudG99KTt9cGFydHMuc3BsaWNlLmFwcGx5KHBhcnRzLG5ld1BhcnRzKTtqKz1uZXdQYXJ0cy5sZW5ndGgtMTt9fXJldHVybiBwYXJ0czt9Ly8gQ29ubmVjdCBvciBkaXNjb25uZWN0IHNwYW5zIGZyb20gYSBsaW5lLlxuZnVuY3Rpb24gZGV0YWNoTWFya2VkU3BhbnMobGluZSl7dmFyIHNwYW5zPWxpbmUubWFya2VkU3BhbnM7aWYoIXNwYW5zKXtyZXR1cm47fWZvcih2YXIgaT0wO2k8c3BhbnMubGVuZ3RoOysraSl7c3BhbnNbaV0ubWFya2VyLmRldGFjaExpbmUobGluZSk7fWxpbmUubWFya2VkU3BhbnM9bnVsbDt9ZnVuY3Rpb24gYXR0YWNoTWFya2VkU3BhbnMobGluZSxzcGFucyl7aWYoIXNwYW5zKXtyZXR1cm47fWZvcih2YXIgaT0wO2k8c3BhbnMubGVuZ3RoOysraSl7c3BhbnNbaV0ubWFya2VyLmF0dGFjaExpbmUobGluZSk7fWxpbmUubWFya2VkU3BhbnM9c3BhbnM7fS8vIEhlbHBlcnMgdXNlZCB3aGVuIGNvbXB1dGluZyB3aGljaCBvdmVybGFwcGluZyBjb2xsYXBzZWQgc3BhblxuLy8gY291bnRzIGFzIHRoZSBsYXJnZXIgb25lLlxuZnVuY3Rpb24gZXh0cmFMZWZ0KG1hcmtlcil7cmV0dXJuIG1hcmtlci5pbmNsdXNpdmVMZWZ0Py0xOjA7fWZ1bmN0aW9uIGV4dHJhUmlnaHQobWFya2VyKXtyZXR1cm4gbWFya2VyLmluY2x1c2l2ZVJpZ2h0PzE6MDt9Ly8gUmV0dXJucyBhIG51bWJlciBpbmRpY2F0aW5nIHdoaWNoIG9mIHR3byBvdmVybGFwcGluZyBjb2xsYXBzZWRcbi8vIHNwYW5zIGlzIGxhcmdlciAoYW5kIHRodXMgaW5jbHVkZXMgdGhlIG90aGVyKS4gRmFsbHMgYmFjayB0b1xuLy8gY29tcGFyaW5nIGlkcyB3aGVuIHRoZSBzcGFucyBjb3ZlciBleGFjdGx5IHRoZSBzYW1lIHJhbmdlLlxuZnVuY3Rpb24gY29tcGFyZUNvbGxhcHNlZE1hcmtlcnMoYSxiKXt2YXIgbGVuRGlmZj1hLmxpbmVzLmxlbmd0aC1iLmxpbmVzLmxlbmd0aDtpZihsZW5EaWZmIT0wKXtyZXR1cm4gbGVuRGlmZjt9dmFyIGFQb3M9YS5maW5kKCksYlBvcz1iLmZpbmQoKTt2YXIgZnJvbUNtcD1jbXAoYVBvcy5mcm9tLGJQb3MuZnJvbSl8fGV4dHJhTGVmdChhKS1leHRyYUxlZnQoYik7aWYoZnJvbUNtcCl7cmV0dXJuLWZyb21DbXA7fXZhciB0b0NtcD1jbXAoYVBvcy50byxiUG9zLnRvKXx8ZXh0cmFSaWdodChhKS1leHRyYVJpZ2h0KGIpO2lmKHRvQ21wKXtyZXR1cm4gdG9DbXA7fXJldHVybiBiLmlkLWEuaWQ7fS8vIEZpbmQgb3V0IHdoZXRoZXIgYSBsaW5lIGVuZHMgb3Igc3RhcnRzIGluIGEgY29sbGFwc2VkIHNwYW4uIElmXG4vLyBzbywgcmV0dXJuIHRoZSBtYXJrZXIgZm9yIHRoYXQgc3Bhbi5cbmZ1bmN0aW9uIGNvbGxhcHNlZFNwYW5BdFNpZGUobGluZSxzdGFydCl7dmFyIHNwcz1zYXdDb2xsYXBzZWRTcGFucyYmbGluZS5tYXJrZWRTcGFucyxmb3VuZDtpZihzcHMpe2Zvcih2YXIgc3A9dm9pZCAwLGk9MDtpPHNwcy5sZW5ndGg7KytpKXtzcD1zcHNbaV07aWYoc3AubWFya2VyLmNvbGxhcHNlZCYmKHN0YXJ0P3NwLmZyb206c3AudG8pPT1udWxsJiYoIWZvdW5kfHxjb21wYXJlQ29sbGFwc2VkTWFya2Vycyhmb3VuZCxzcC5tYXJrZXIpPDApKXtmb3VuZD1zcC5tYXJrZXI7fX19cmV0dXJuIGZvdW5kO31mdW5jdGlvbiBjb2xsYXBzZWRTcGFuQXRTdGFydChsaW5lKXtyZXR1cm4gY29sbGFwc2VkU3BhbkF0U2lkZShsaW5lLHRydWUpO31mdW5jdGlvbiBjb2xsYXBzZWRTcGFuQXRFbmQobGluZSl7cmV0dXJuIGNvbGxhcHNlZFNwYW5BdFNpZGUobGluZSxmYWxzZSk7fS8vIFRlc3Qgd2hldGhlciB0aGVyZSBleGlzdHMgYSBjb2xsYXBzZWQgc3BhbiB0aGF0IHBhcnRpYWxseVxuLy8gb3ZlcmxhcHMgKGNvdmVycyB0aGUgc3RhcnQgb3IgZW5kLCBidXQgbm90IGJvdGgpIG9mIGEgbmV3IHNwYW4uXG4vLyBTdWNoIG92ZXJsYXAgaXMgbm90IGFsbG93ZWQuXG5mdW5jdGlvbiBjb25mbGljdGluZ0NvbGxhcHNlZFJhbmdlKGRvYyxsaW5lTm8sZnJvbSx0byxtYXJrZXIpe3ZhciBsaW5lPWdldExpbmUoZG9jLGxpbmVObyk7dmFyIHNwcz1zYXdDb2xsYXBzZWRTcGFucyYmbGluZS5tYXJrZWRTcGFucztpZihzcHMpe2Zvcih2YXIgaT0wO2k8c3BzLmxlbmd0aDsrK2kpe3ZhciBzcD1zcHNbaV07aWYoIXNwLm1hcmtlci5jb2xsYXBzZWQpe2NvbnRpbnVlO312YXIgZm91bmQ9c3AubWFya2VyLmZpbmQoMCk7dmFyIGZyb21DbXA9Y21wKGZvdW5kLmZyb20sZnJvbSl8fGV4dHJhTGVmdChzcC5tYXJrZXIpLWV4dHJhTGVmdChtYXJrZXIpO3ZhciB0b0NtcD1jbXAoZm91bmQudG8sdG8pfHxleHRyYVJpZ2h0KHNwLm1hcmtlciktZXh0cmFSaWdodChtYXJrZXIpO2lmKGZyb21DbXA+PTAmJnRvQ21wPD0wfHxmcm9tQ21wPD0wJiZ0b0NtcD49MCl7Y29udGludWU7fWlmKGZyb21DbXA8PTAmJihzcC5tYXJrZXIuaW5jbHVzaXZlUmlnaHQmJm1hcmtlci5pbmNsdXNpdmVMZWZ0P2NtcChmb3VuZC50byxmcm9tKT49MDpjbXAoZm91bmQudG8sZnJvbSk+MCl8fGZyb21DbXA+PTAmJihzcC5tYXJrZXIuaW5jbHVzaXZlUmlnaHQmJm1hcmtlci5pbmNsdXNpdmVMZWZ0P2NtcChmb3VuZC5mcm9tLHRvKTw9MDpjbXAoZm91bmQuZnJvbSx0byk8MCkpe3JldHVybiB0cnVlO319fX0vLyBBIHZpc3VhbCBsaW5lIGlzIGEgbGluZSBhcyBkcmF3biBvbiB0aGUgc2NyZWVuLiBGb2xkaW5nLCBmb3Jcbi8vIGV4YW1wbGUsIGNhbiBjYXVzZSBtdWx0aXBsZSBsb2dpY2FsIGxpbmVzIHRvIGFwcGVhciBvbiB0aGUgc2FtZVxuLy8gdmlzdWFsIGxpbmUuIFRoaXMgZmluZHMgdGhlIHN0YXJ0IG9mIHRoZSB2aXN1YWwgbGluZSB0aGF0IHRoZVxuLy8gZ2l2ZW4gbGluZSBpcyBwYXJ0IG9mICh1c3VhbGx5IHRoYXQgaXMgdGhlIGxpbmUgaXRzZWxmKS5cbmZ1bmN0aW9uIHZpc3VhbExpbmUobGluZSl7dmFyIG1lcmdlZDt3aGlsZShtZXJnZWQ9Y29sbGFwc2VkU3BhbkF0U3RhcnQobGluZSkpe2xpbmU9bWVyZ2VkLmZpbmQoLTEsdHJ1ZSkubGluZTt9cmV0dXJuIGxpbmU7fS8vIFJldHVybnMgYW4gYXJyYXkgb2YgbG9naWNhbCBsaW5lcyB0aGF0IGNvbnRpbnVlIHRoZSB2aXN1YWwgbGluZVxuLy8gc3RhcnRlZCBieSB0aGUgYXJndW1lbnQsIG9yIHVuZGVmaW5lZCBpZiB0aGVyZSBhcmUgbm8gc3VjaCBsaW5lcy5cbmZ1bmN0aW9uIHZpc3VhbExpbmVDb250aW51ZWQobGluZSl7dmFyIG1lcmdlZCxsaW5lczt3aGlsZShtZXJnZWQ9Y29sbGFwc2VkU3BhbkF0RW5kKGxpbmUpKXtsaW5lPW1lcmdlZC5maW5kKDEsdHJ1ZSkubGluZTsobGluZXN8fChsaW5lcz1bXSkpLnB1c2gobGluZSk7fXJldHVybiBsaW5lczt9Ly8gR2V0IHRoZSBsaW5lIG51bWJlciBvZiB0aGUgc3RhcnQgb2YgdGhlIHZpc3VhbCBsaW5lIHRoYXQgdGhlXG4vLyBnaXZlbiBsaW5lIG51bWJlciBpcyBwYXJ0IG9mLlxuZnVuY3Rpb24gdmlzdWFsTGluZU5vKGRvYyxsaW5lTil7dmFyIGxpbmU9Z2V0TGluZShkb2MsbGluZU4pLHZpcz12aXN1YWxMaW5lKGxpbmUpO2lmKGxpbmU9PXZpcyl7cmV0dXJuIGxpbmVOO31yZXR1cm4gbGluZU5vKHZpcyk7fS8vIEdldCB0aGUgbGluZSBudW1iZXIgb2YgdGhlIHN0YXJ0IG9mIHRoZSBuZXh0IHZpc3VhbCBsaW5lIGFmdGVyXG4vLyB0aGUgZ2l2ZW4gbGluZS5cbmZ1bmN0aW9uIHZpc3VhbExpbmVFbmRObyhkb2MsbGluZU4pe2lmKGxpbmVOPmRvYy5sYXN0TGluZSgpKXtyZXR1cm4gbGluZU47fXZhciBsaW5lPWdldExpbmUoZG9jLGxpbmVOKSxtZXJnZWQ7aWYoIWxpbmVJc0hpZGRlbihkb2MsbGluZSkpe3JldHVybiBsaW5lTjt9d2hpbGUobWVyZ2VkPWNvbGxhcHNlZFNwYW5BdEVuZChsaW5lKSl7bGluZT1tZXJnZWQuZmluZCgxLHRydWUpLmxpbmU7fXJldHVybiBsaW5lTm8obGluZSkrMTt9Ly8gQ29tcHV0ZSB3aGV0aGVyIGEgbGluZSBpcyBoaWRkZW4uIExpbmVzIGNvdW50IGFzIGhpZGRlbiB3aGVuIHRoZXlcbi8vIGFyZSBwYXJ0IG9mIGEgdmlzdWFsIGxpbmUgdGhhdCBzdGFydHMgd2l0aCBhbm90aGVyIGxpbmUsIG9yIHdoZW5cbi8vIHRoZXkgYXJlIGVudGlyZWx5IGNvdmVyZWQgYnkgY29sbGFwc2VkLCBub24td2lkZ2V0IHNwYW4uXG5mdW5jdGlvbiBsaW5lSXNIaWRkZW4oZG9jLGxpbmUpe3ZhciBzcHM9c2F3Q29sbGFwc2VkU3BhbnMmJmxpbmUubWFya2VkU3BhbnM7aWYoc3BzKXtmb3IodmFyIHNwPXZvaWQgMCxpPTA7aTxzcHMubGVuZ3RoOysraSl7c3A9c3BzW2ldO2lmKCFzcC5tYXJrZXIuY29sbGFwc2VkKXtjb250aW51ZTt9aWYoc3AuZnJvbT09bnVsbCl7cmV0dXJuIHRydWU7fWlmKHNwLm1hcmtlci53aWRnZXROb2RlKXtjb250aW51ZTt9aWYoc3AuZnJvbT09MCYmc3AubWFya2VyLmluY2x1c2l2ZUxlZnQmJmxpbmVJc0hpZGRlbklubmVyKGRvYyxsaW5lLHNwKSl7cmV0dXJuIHRydWU7fX19fWZ1bmN0aW9uIGxpbmVJc0hpZGRlbklubmVyKGRvYyxsaW5lLHNwYW4pe2lmKHNwYW4udG89PW51bGwpe3ZhciBlbmQ9c3Bhbi5tYXJrZXIuZmluZCgxLHRydWUpO3JldHVybiBsaW5lSXNIaWRkZW5Jbm5lcihkb2MsZW5kLmxpbmUsZ2V0TWFya2VkU3BhbkZvcihlbmQubGluZS5tYXJrZWRTcGFucyxzcGFuLm1hcmtlcikpO31pZihzcGFuLm1hcmtlci5pbmNsdXNpdmVSaWdodCYmc3Bhbi50bz09bGluZS50ZXh0Lmxlbmd0aCl7cmV0dXJuIHRydWU7fWZvcih2YXIgc3A9dm9pZCAwLGk9MDtpPGxpbmUubWFya2VkU3BhbnMubGVuZ3RoOysraSl7c3A9bGluZS5tYXJrZWRTcGFuc1tpXTtpZihzcC5tYXJrZXIuY29sbGFwc2VkJiYhc3AubWFya2VyLndpZGdldE5vZGUmJnNwLmZyb209PXNwYW4udG8mJihzcC50bz09bnVsbHx8c3AudG8hPXNwYW4uZnJvbSkmJihzcC5tYXJrZXIuaW5jbHVzaXZlTGVmdHx8c3Bhbi5tYXJrZXIuaW5jbHVzaXZlUmlnaHQpJiZsaW5lSXNIaWRkZW5Jbm5lcihkb2MsbGluZSxzcCkpe3JldHVybiB0cnVlO319fS8vIEZpbmQgdGhlIGhlaWdodCBhYm92ZSB0aGUgZ2l2ZW4gbGluZS5cbmZ1bmN0aW9uIGhlaWdodEF0TGluZShsaW5lT2JqKXtsaW5lT2JqPXZpc3VhbExpbmUobGluZU9iaik7dmFyIGg9MCxjaHVuaz1saW5lT2JqLnBhcmVudDtmb3IodmFyIGk9MDtpPGNodW5rLmxpbmVzLmxlbmd0aDsrK2kpe3ZhciBsaW5lPWNodW5rLmxpbmVzW2ldO2lmKGxpbmU9PWxpbmVPYmope2JyZWFrO31lbHNle2grPWxpbmUuaGVpZ2h0O319Zm9yKHZhciBwPWNodW5rLnBhcmVudDtwO2NodW5rPXAscD1jaHVuay5wYXJlbnQpe2Zvcih2YXIgaSQxPTA7aSQxPHAuY2hpbGRyZW4ubGVuZ3RoOysraSQxKXt2YXIgY3VyPXAuY2hpbGRyZW5baSQxXTtpZihjdXI9PWNodW5rKXticmVhazt9ZWxzZXtoKz1jdXIuaGVpZ2h0O319fXJldHVybiBoO30vLyBDb21wdXRlIHRoZSBjaGFyYWN0ZXIgbGVuZ3RoIG9mIGEgbGluZSwgdGFraW5nIGludG8gYWNjb3VudFxuLy8gY29sbGFwc2VkIHJhbmdlcyAoc2VlIG1hcmtUZXh0KSB0aGF0IG1pZ2h0IGhpZGUgcGFydHMsIGFuZCBqb2luXG4vLyBvdGhlciBsaW5lcyBvbnRvIGl0LlxuZnVuY3Rpb24gbGluZUxlbmd0aChsaW5lKXtpZihsaW5lLmhlaWdodD09MCl7cmV0dXJuIDA7fXZhciBsZW49bGluZS50ZXh0Lmxlbmd0aCxtZXJnZWQsY3VyPWxpbmU7d2hpbGUobWVyZ2VkPWNvbGxhcHNlZFNwYW5BdFN0YXJ0KGN1cikpe3ZhciBmb3VuZD1tZXJnZWQuZmluZCgwLHRydWUpO2N1cj1mb3VuZC5mcm9tLmxpbmU7bGVuKz1mb3VuZC5mcm9tLmNoLWZvdW5kLnRvLmNoO31jdXI9bGluZTt3aGlsZShtZXJnZWQ9Y29sbGFwc2VkU3BhbkF0RW5kKGN1cikpe3ZhciBmb3VuZCQxPW1lcmdlZC5maW5kKDAsdHJ1ZSk7bGVuLT1jdXIudGV4dC5sZW5ndGgtZm91bmQkMS5mcm9tLmNoO2N1cj1mb3VuZCQxLnRvLmxpbmU7bGVuKz1jdXIudGV4dC5sZW5ndGgtZm91bmQkMS50by5jaDt9cmV0dXJuIGxlbjt9Ly8gRmluZCB0aGUgbG9uZ2VzdCBsaW5lIGluIHRoZSBkb2N1bWVudC5cbmZ1bmN0aW9uIGZpbmRNYXhMaW5lKGNtKXt2YXIgZD1jbS5kaXNwbGF5LGRvYz1jbS5kb2M7ZC5tYXhMaW5lPWdldExpbmUoZG9jLGRvYy5maXJzdCk7ZC5tYXhMaW5lTGVuZ3RoPWxpbmVMZW5ndGgoZC5tYXhMaW5lKTtkLm1heExpbmVDaGFuZ2VkPXRydWU7ZG9jLml0ZXIoZnVuY3Rpb24obGluZSl7dmFyIGxlbj1saW5lTGVuZ3RoKGxpbmUpO2lmKGxlbj5kLm1heExpbmVMZW5ndGgpe2QubWF4TGluZUxlbmd0aD1sZW47ZC5tYXhMaW5lPWxpbmU7fX0pO30vLyBCSURJIEhFTFBFUlNcbmZ1bmN0aW9uIGl0ZXJhdGVCaWRpU2VjdGlvbnMob3JkZXIsZnJvbSx0byxmKXtpZighb3JkZXIpe3JldHVybiBmKGZyb20sdG8sXCJsdHJcIik7fXZhciBmb3VuZD1mYWxzZTtmb3IodmFyIGk9MDtpPG9yZGVyLmxlbmd0aDsrK2kpe3ZhciBwYXJ0PW9yZGVyW2ldO2lmKHBhcnQuZnJvbTx0byYmcGFydC50bz5mcm9tfHxmcm9tPT10byYmcGFydC50bz09ZnJvbSl7ZihNYXRoLm1heChwYXJ0LmZyb20sZnJvbSksTWF0aC5taW4ocGFydC50byx0bykscGFydC5sZXZlbD09MT9cInJ0bFwiOlwibHRyXCIpO2ZvdW5kPXRydWU7fX1pZighZm91bmQpe2YoZnJvbSx0byxcImx0clwiKTt9fWZ1bmN0aW9uIGJpZGlMZWZ0KHBhcnQpe3JldHVybiBwYXJ0LmxldmVsJTI/cGFydC50bzpwYXJ0LmZyb207fWZ1bmN0aW9uIGJpZGlSaWdodChwYXJ0KXtyZXR1cm4gcGFydC5sZXZlbCUyP3BhcnQuZnJvbTpwYXJ0LnRvO31mdW5jdGlvbiBsaW5lTGVmdChsaW5lKXt2YXIgb3JkZXI9Z2V0T3JkZXIobGluZSk7cmV0dXJuIG9yZGVyP2JpZGlMZWZ0KG9yZGVyWzBdKTowO31mdW5jdGlvbiBsaW5lUmlnaHQobGluZSl7dmFyIG9yZGVyPWdldE9yZGVyKGxpbmUpO2lmKCFvcmRlcil7cmV0dXJuIGxpbmUudGV4dC5sZW5ndGg7fXJldHVybiBiaWRpUmlnaHQobHN0KG9yZGVyKSk7fWZ1bmN0aW9uIGNvbXBhcmVCaWRpTGV2ZWwob3JkZXIsYSxiKXt2YXIgbGluZWRpcj1vcmRlclswXS5sZXZlbDtpZihhPT1saW5lZGlyKXtyZXR1cm4gdHJ1ZTt9aWYoYj09bGluZWRpcil7cmV0dXJuIGZhbHNlO31yZXR1cm4gYTxiO312YXIgYmlkaU90aGVyPW51bGw7ZnVuY3Rpb24gZ2V0QmlkaVBhcnRBdChvcmRlcixwb3Mpe3ZhciBmb3VuZDtiaWRpT3RoZXI9bnVsbDtmb3IodmFyIGk9MDtpPG9yZGVyLmxlbmd0aDsrK2kpe3ZhciBjdXI9b3JkZXJbaV07aWYoY3VyLmZyb208cG9zJiZjdXIudG8+cG9zKXtyZXR1cm4gaTt9aWYoY3VyLmZyb209PXBvc3x8Y3VyLnRvPT1wb3Mpe2lmKGZvdW5kPT1udWxsKXtmb3VuZD1pO31lbHNlIGlmKGNvbXBhcmVCaWRpTGV2ZWwob3JkZXIsY3VyLmxldmVsLG9yZGVyW2ZvdW5kXS5sZXZlbCkpe2lmKGN1ci5mcm9tIT1jdXIudG8pe2JpZGlPdGhlcj1mb3VuZDt9cmV0dXJuIGk7fWVsc2V7aWYoY3VyLmZyb20hPWN1ci50byl7YmlkaU90aGVyPWk7fXJldHVybiBmb3VuZDt9fX1yZXR1cm4gZm91bmQ7fWZ1bmN0aW9uIG1vdmVJbkxpbmUobGluZSxwb3MsZGlyLGJ5VW5pdCl7aWYoIWJ5VW5pdCl7cmV0dXJuIHBvcytkaXI7fWRve3Bvcys9ZGlyO313aGlsZShwb3M+MCYmaXNFeHRlbmRpbmdDaGFyKGxpbmUudGV4dC5jaGFyQXQocG9zKSkpO3JldHVybiBwb3M7fS8vIFRoaXMgaXMgbmVlZGVkIGluIG9yZGVyIHRvIG1vdmUgJ3Zpc3VhbGx5JyB0aHJvdWdoIGJpLWRpcmVjdGlvbmFsXG4vLyB0ZXh0IC0tIGkuZS4sIHByZXNzaW5nIGxlZnQgc2hvdWxkIG1ha2UgdGhlIGN1cnNvciBnbyBsZWZ0LCBldmVuXG4vLyB3aGVuIGluIFJUTCB0ZXh0LiBUaGUgdHJpY2t5IHBhcnQgaXMgdGhlICdqdW1wcycsIHdoZXJlIFJUTCBhbmRcbi8vIExUUiB0ZXh0IHRvdWNoIGVhY2ggb3RoZXIuIFRoaXMgb2Z0ZW4gcmVxdWlyZXMgdGhlIGN1cnNvciBvZmZzZXRcbi8vIHRvIG1vdmUgbW9yZSB0aGFuIG9uZSB1bml0LCBpbiBvcmRlciB0byB2aXN1YWxseSBtb3ZlIG9uZSB1bml0LlxuZnVuY3Rpb24gbW92ZVZpc3VhbGx5KGxpbmUsc3RhcnQsZGlyLGJ5VW5pdCl7dmFyIGJpZGk9Z2V0T3JkZXIobGluZSk7aWYoIWJpZGkpe3JldHVybiBtb3ZlTG9naWNhbGx5KGxpbmUsc3RhcnQsZGlyLGJ5VW5pdCk7fXZhciBwb3M9Z2V0QmlkaVBhcnRBdChiaWRpLHN0YXJ0KSxwYXJ0PWJpZGlbcG9zXTt2YXIgdGFyZ2V0PW1vdmVJbkxpbmUobGluZSxzdGFydCxwYXJ0LmxldmVsJTI/LWRpcjpkaXIsYnlVbml0KTtmb3IoOzspe2lmKHRhcmdldD5wYXJ0LmZyb20mJnRhcmdldDxwYXJ0LnRvKXtyZXR1cm4gdGFyZ2V0O31pZih0YXJnZXQ9PXBhcnQuZnJvbXx8dGFyZ2V0PT1wYXJ0LnRvKXtpZihnZXRCaWRpUGFydEF0KGJpZGksdGFyZ2V0KT09cG9zKXtyZXR1cm4gdGFyZ2V0O31wYXJ0PWJpZGlbcG9zKz1kaXJdO3JldHVybiBkaXI+MD09cGFydC5sZXZlbCUyP3BhcnQudG86cGFydC5mcm9tO31lbHNle3BhcnQ9YmlkaVtwb3MrPWRpcl07aWYoIXBhcnQpe3JldHVybiBudWxsO31pZihkaXI+MD09cGFydC5sZXZlbCUyKXt0YXJnZXQ9bW92ZUluTGluZShsaW5lLHBhcnQudG8sLTEsYnlVbml0KTt9ZWxzZXt0YXJnZXQ9bW92ZUluTGluZShsaW5lLHBhcnQuZnJvbSwxLGJ5VW5pdCk7fX19fWZ1bmN0aW9uIG1vdmVMb2dpY2FsbHkobGluZSxzdGFydCxkaXIsYnlVbml0KXt2YXIgdGFyZ2V0PXN0YXJ0K2RpcjtpZihieVVuaXQpe3doaWxlKHRhcmdldD4wJiZpc0V4dGVuZGluZ0NoYXIobGluZS50ZXh0LmNoYXJBdCh0YXJnZXQpKSl7dGFyZ2V0Kz1kaXI7fX1yZXR1cm4gdGFyZ2V0PDB8fHRhcmdldD5saW5lLnRleHQubGVuZ3RoP251bGw6dGFyZ2V0O30vLyBCaWRpcmVjdGlvbmFsIG9yZGVyaW5nIGFsZ29yaXRobVxuLy8gU2VlIGh0dHA6Ly91bmljb2RlLm9yZy9yZXBvcnRzL3RyOS90cjktMTMuaHRtbCBmb3IgdGhlIGFsZ29yaXRobVxuLy8gdGhhdCB0aGlzIChwYXJ0aWFsbHkpIGltcGxlbWVudHMuXG4vLyBPbmUtY2hhciBjb2RlcyB1c2VkIGZvciBjaGFyYWN0ZXIgdHlwZXM6XG4vLyBMIChMKTogICBMZWZ0LXRvLVJpZ2h0XG4vLyBSIChSKTogICBSaWdodC10by1MZWZ0XG4vLyByIChBTCk6ICBSaWdodC10by1MZWZ0IEFyYWJpY1xuLy8gMSAoRU4pOiAgRXVyb3BlYW4gTnVtYmVyXG4vLyArIChFUyk6ICBFdXJvcGVhbiBOdW1iZXIgU2VwYXJhdG9yXG4vLyAlIChFVCk6ICBFdXJvcGVhbiBOdW1iZXIgVGVybWluYXRvclxuLy8gbiAoQU4pOiAgQXJhYmljIE51bWJlclxuLy8gLCAoQ1MpOiAgQ29tbW9uIE51bWJlciBTZXBhcmF0b3Jcbi8vIG0gKE5TTSk6IE5vbi1TcGFjaW5nIE1hcmtcbi8vIGIgKEJOKTogIEJvdW5kYXJ5IE5ldXRyYWxcbi8vIHMgKEIpOiAgIFBhcmFncmFwaCBTZXBhcmF0b3Jcbi8vIHQgKFMpOiAgIFNlZ21lbnQgU2VwYXJhdG9yXG4vLyB3IChXUyk6ICBXaGl0ZXNwYWNlXG4vLyBOIChPTik6ICBPdGhlciBOZXV0cmFsc1xuLy8gUmV0dXJucyBudWxsIGlmIGNoYXJhY3RlcnMgYXJlIG9yZGVyZWQgYXMgdGhleSBhcHBlYXJcbi8vIChsZWZ0LXRvLXJpZ2h0KSwgb3IgYW4gYXJyYXkgb2Ygc2VjdGlvbnMgKHtmcm9tLCB0bywgbGV2ZWx9XG4vLyBvYmplY3RzKSBpbiB0aGUgb3JkZXIgaW4gd2hpY2ggdGhleSBvY2N1ciB2aXN1YWxseS5cbnZhciBiaWRpT3JkZXJpbmc9ZnVuY3Rpb24oKXsvLyBDaGFyYWN0ZXIgdHlwZXMgZm9yIGNvZGVwb2ludHMgMCB0byAweGZmXG52YXIgbG93VHlwZXM9XCJiYmJiYmJiYmJ0c3R3c2JiYmJiYmJiYmJiYmJic3NzdHdOTiUlJU5OTk5OTixOLE4xMTExMTExMTExTk5OTk5OTkxMTExMTExMTExMTExMTExMTExMTExMTExMTk5OTk5OTExMTExMTExMTExMTExMTExMTExMTExMTExOTk5OYmJiYmJic2JiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiLE4lJSUlTk5OTkxOTk5OTiUlMTFOTE5OTjFMTk5OTk5MTExMTExMTExMTExMTExMTExMTExMTE5MTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTlwiOy8vIENoYXJhY3RlciB0eXBlcyBmb3IgY29kZXBvaW50cyAweDYwMCB0byAweDZmZlxudmFyIGFyYWJpY1R5cGVzPVwicnJycnJycnJycnJyLHJOTm1tbW1tbXJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJybW1tbW1tbW1tbW1tbW1ycnJycnJybm5ubm5ubm5ubiVubnJycm1ycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycm1tbW1tbW1tbW1tbW1tbW1tbW1ObW1tbVwiO2Z1bmN0aW9uIGNoYXJUeXBlKGNvZGUpe2lmKGNvZGU8PTB4Zjcpe3JldHVybiBsb3dUeXBlcy5jaGFyQXQoY29kZSk7fWVsc2UgaWYoMHg1OTA8PWNvZGUmJmNvZGU8PTB4NWY0KXtyZXR1cm5cIlJcIjt9ZWxzZSBpZigweDYwMDw9Y29kZSYmY29kZTw9MHg2ZWQpe3JldHVybiBhcmFiaWNUeXBlcy5jaGFyQXQoY29kZS0weDYwMCk7fWVsc2UgaWYoMHg2ZWU8PWNvZGUmJmNvZGU8PTB4OGFjKXtyZXR1cm5cInJcIjt9ZWxzZSBpZigweDIwMDA8PWNvZGUmJmNvZGU8PTB4MjAwYil7cmV0dXJuXCJ3XCI7fWVsc2UgaWYoY29kZT09MHgyMDBjKXtyZXR1cm5cImJcIjt9ZWxzZXtyZXR1cm5cIkxcIjt9fXZhciBiaWRpUkU9L1tcXHUwNTkwLVxcdTA1ZjRcXHUwNjAwLVxcdTA2ZmZcXHUwNzAwLVxcdTA4YWNdLzt2YXIgaXNOZXV0cmFsPS9bc3R3Tl0vLGlzU3Ryb25nPS9bTFJyXS8sY291bnRzQXNMZWZ0PS9bTGIxbl0vLGNvdW50c0FzTnVtPS9bMW5dLzsvLyBCcm93c2VycyBzZWVtIHRvIGFsd2F5cyB0cmVhdCB0aGUgYm91bmRhcmllcyBvZiBibG9jayBlbGVtZW50cyBhcyBiZWluZyBMLlxudmFyIG91dGVyVHlwZT1cIkxcIjtmdW5jdGlvbiBCaWRpU3BhbihsZXZlbCxmcm9tLHRvKXt0aGlzLmxldmVsPWxldmVsO3RoaXMuZnJvbT1mcm9tO3RoaXMudG89dG87fXJldHVybiBmdW5jdGlvbihzdHIpe2lmKCFiaWRpUkUudGVzdChzdHIpKXtyZXR1cm4gZmFsc2U7fXZhciBsZW49c3RyLmxlbmd0aCx0eXBlcz1bXTtmb3IodmFyIGk9MDtpPGxlbjsrK2kpe3R5cGVzLnB1c2goY2hhclR5cGUoc3RyLmNoYXJDb2RlQXQoaSkpKTt9Ly8gVzEuIEV4YW1pbmUgZWFjaCBub24tc3BhY2luZyBtYXJrIChOU00pIGluIHRoZSBsZXZlbCBydW4sIGFuZFxuLy8gY2hhbmdlIHRoZSB0eXBlIG9mIHRoZSBOU00gdG8gdGhlIHR5cGUgb2YgdGhlIHByZXZpb3VzXG4vLyBjaGFyYWN0ZXIuIElmIHRoZSBOU00gaXMgYXQgdGhlIHN0YXJ0IG9mIHRoZSBsZXZlbCBydW4sIGl0IHdpbGxcbi8vIGdldCB0aGUgdHlwZSBvZiBzb3IuXG5mb3IodmFyIGkkMT0wLHByZXY9b3V0ZXJUeXBlO2kkMTxsZW47KytpJDEpe3ZhciB0eXBlPXR5cGVzW2kkMV07aWYodHlwZT09XCJtXCIpe3R5cGVzW2kkMV09cHJldjt9ZWxzZXtwcmV2PXR5cGU7fX0vLyBXMi4gU2VhcmNoIGJhY2t3YXJkcyBmcm9tIGVhY2ggaW5zdGFuY2Ugb2YgYSBFdXJvcGVhbiBudW1iZXJcbi8vIHVudGlsIHRoZSBmaXJzdCBzdHJvbmcgdHlwZSAoUiwgTCwgQUwsIG9yIHNvcikgaXMgZm91bmQuIElmIGFuXG4vLyBBTCBpcyBmb3VuZCwgY2hhbmdlIHRoZSB0eXBlIG9mIHRoZSBFdXJvcGVhbiBudW1iZXIgdG8gQXJhYmljXG4vLyBudW1iZXIuXG4vLyBXMy4gQ2hhbmdlIGFsbCBBTHMgdG8gUi5cbmZvcih2YXIgaSQyPTAsY3VyPW91dGVyVHlwZTtpJDI8bGVuOysraSQyKXt2YXIgdHlwZSQxPXR5cGVzW2kkMl07aWYodHlwZSQxPT1cIjFcIiYmY3VyPT1cInJcIil7dHlwZXNbaSQyXT1cIm5cIjt9ZWxzZSBpZihpc1N0cm9uZy50ZXN0KHR5cGUkMSkpe2N1cj10eXBlJDE7aWYodHlwZSQxPT1cInJcIil7dHlwZXNbaSQyXT1cIlJcIjt9fX0vLyBXNC4gQSBzaW5nbGUgRXVyb3BlYW4gc2VwYXJhdG9yIGJldHdlZW4gdHdvIEV1cm9wZWFuIG51bWJlcnNcbi8vIGNoYW5nZXMgdG8gYSBFdXJvcGVhbiBudW1iZXIuIEEgc2luZ2xlIGNvbW1vbiBzZXBhcmF0b3IgYmV0d2VlblxuLy8gdHdvIG51bWJlcnMgb2YgdGhlIHNhbWUgdHlwZSBjaGFuZ2VzIHRvIHRoYXQgdHlwZS5cbmZvcih2YXIgaSQzPTEscHJldiQxPXR5cGVzWzBdO2kkMzxsZW4tMTsrK2kkMyl7dmFyIHR5cGUkMj10eXBlc1tpJDNdO2lmKHR5cGUkMj09XCIrXCImJnByZXYkMT09XCIxXCImJnR5cGVzW2kkMysxXT09XCIxXCIpe3R5cGVzW2kkM109XCIxXCI7fWVsc2UgaWYodHlwZSQyPT1cIixcIiYmcHJldiQxPT10eXBlc1tpJDMrMV0mJihwcmV2JDE9PVwiMVwifHxwcmV2JDE9PVwiblwiKSl7dHlwZXNbaSQzXT1wcmV2JDE7fXByZXYkMT10eXBlJDI7fS8vIFc1LiBBIHNlcXVlbmNlIG9mIEV1cm9wZWFuIHRlcm1pbmF0b3JzIGFkamFjZW50IHRvIEV1cm9wZWFuXG4vLyBudW1iZXJzIGNoYW5nZXMgdG8gYWxsIEV1cm9wZWFuIG51bWJlcnMuXG4vLyBXNi4gT3RoZXJ3aXNlLCBzZXBhcmF0b3JzIGFuZCB0ZXJtaW5hdG9ycyBjaGFuZ2UgdG8gT3RoZXJcbi8vIE5ldXRyYWwuXG5mb3IodmFyIGkkND0wO2kkNDxsZW47KytpJDQpe3ZhciB0eXBlJDM9dHlwZXNbaSQ0XTtpZih0eXBlJDM9PVwiLFwiKXt0eXBlc1tpJDRdPVwiTlwiO31lbHNlIGlmKHR5cGUkMz09XCIlXCIpe3ZhciBlbmQ9dm9pZCAwO2ZvcihlbmQ9aSQ0KzE7ZW5kPGxlbiYmdHlwZXNbZW5kXT09XCIlXCI7KytlbmQpe312YXIgcmVwbGFjZT1pJDQmJnR5cGVzW2kkNC0xXT09XCIhXCJ8fGVuZDxsZW4mJnR5cGVzW2VuZF09PVwiMVwiP1wiMVwiOlwiTlwiO2Zvcih2YXIgaj1pJDQ7ajxlbmQ7KytqKXt0eXBlc1tqXT1yZXBsYWNlO31pJDQ9ZW5kLTE7fX0vLyBXNy4gU2VhcmNoIGJhY2t3YXJkcyBmcm9tIGVhY2ggaW5zdGFuY2Ugb2YgYSBFdXJvcGVhbiBudW1iZXJcbi8vIHVudGlsIHRoZSBmaXJzdCBzdHJvbmcgdHlwZSAoUiwgTCwgb3Igc29yKSBpcyBmb3VuZC4gSWYgYW4gTCBpc1xuLy8gZm91bmQsIHRoZW4gY2hhbmdlIHRoZSB0eXBlIG9mIHRoZSBFdXJvcGVhbiBudW1iZXIgdG8gTC5cbmZvcih2YXIgaSQ1PTAsY3VyJDE9b3V0ZXJUeXBlO2kkNTxsZW47KytpJDUpe3ZhciB0eXBlJDQ9dHlwZXNbaSQ1XTtpZihjdXIkMT09XCJMXCImJnR5cGUkND09XCIxXCIpe3R5cGVzW2kkNV09XCJMXCI7fWVsc2UgaWYoaXNTdHJvbmcudGVzdCh0eXBlJDQpKXtjdXIkMT10eXBlJDQ7fX0vLyBOMS4gQSBzZXF1ZW5jZSBvZiBuZXV0cmFscyB0YWtlcyB0aGUgZGlyZWN0aW9uIG9mIHRoZVxuLy8gc3Vycm91bmRpbmcgc3Ryb25nIHRleHQgaWYgdGhlIHRleHQgb24gYm90aCBzaWRlcyBoYXMgdGhlIHNhbWVcbi8vIGRpcmVjdGlvbi4gRXVyb3BlYW4gYW5kIEFyYWJpYyBudW1iZXJzIGFjdCBhcyBpZiB0aGV5IHdlcmUgUiBpblxuLy8gdGVybXMgb2YgdGhlaXIgaW5mbHVlbmNlIG9uIG5ldXRyYWxzLiBTdGFydC1vZi1sZXZlbC1ydW4gKHNvcilcbi8vIGFuZCBlbmQtb2YtbGV2ZWwtcnVuIChlb3IpIGFyZSB1c2VkIGF0IGxldmVsIHJ1biBib3VuZGFyaWVzLlxuLy8gTjIuIEFueSByZW1haW5pbmcgbmV1dHJhbHMgdGFrZSB0aGUgZW1iZWRkaW5nIGRpcmVjdGlvbi5cbmZvcih2YXIgaSQ2PTA7aSQ2PGxlbjsrK2kkNil7aWYoaXNOZXV0cmFsLnRlc3QodHlwZXNbaSQ2XSkpe3ZhciBlbmQkMT12b2lkIDA7Zm9yKGVuZCQxPWkkNisxO2VuZCQxPGxlbiYmaXNOZXV0cmFsLnRlc3QodHlwZXNbZW5kJDFdKTsrK2VuZCQxKXt9dmFyIGJlZm9yZT0oaSQ2P3R5cGVzW2kkNi0xXTpvdXRlclR5cGUpPT1cIkxcIjt2YXIgYWZ0ZXI9KGVuZCQxPGxlbj90eXBlc1tlbmQkMV06b3V0ZXJUeXBlKT09XCJMXCI7dmFyIHJlcGxhY2UkMT1iZWZvcmV8fGFmdGVyP1wiTFwiOlwiUlwiO2Zvcih2YXIgaiQxPWkkNjtqJDE8ZW5kJDE7KytqJDEpe3R5cGVzW2okMV09cmVwbGFjZSQxO31pJDY9ZW5kJDEtMTt9fS8vIEhlcmUgd2UgZGVwYXJ0IGZyb20gdGhlIGRvY3VtZW50ZWQgYWxnb3JpdGhtLCBpbiBvcmRlciB0byBhdm9pZFxuLy8gYnVpbGRpbmcgdXAgYW4gYWN0dWFsIGxldmVscyBhcnJheS4gU2luY2UgdGhlcmUgYXJlIG9ubHkgdGhyZWVcbi8vIGxldmVscyAoMCwgMSwgMikgaW4gYW4gaW1wbGVtZW50YXRpb24gdGhhdCBkb2Vzbid0IHRha2Vcbi8vIGV4cGxpY2l0IGVtYmVkZGluZyBpbnRvIGFjY291bnQsIHdlIGNhbiBidWlsZCB1cCB0aGUgb3JkZXIgb25cbi8vIHRoZSBmbHksIHdpdGhvdXQgZm9sbG93aW5nIHRoZSBsZXZlbC1iYXNlZCBhbGdvcml0aG0uXG52YXIgb3JkZXI9W10sbTtmb3IodmFyIGkkNz0wO2kkNzxsZW47KXtpZihjb3VudHNBc0xlZnQudGVzdCh0eXBlc1tpJDddKSl7dmFyIHN0YXJ0PWkkNztmb3IoKytpJDc7aSQ3PGxlbiYmY291bnRzQXNMZWZ0LnRlc3QodHlwZXNbaSQ3XSk7KytpJDcpe31vcmRlci5wdXNoKG5ldyBCaWRpU3BhbigwLHN0YXJ0LGkkNykpO31lbHNle3ZhciBwb3M9aSQ3LGF0PW9yZGVyLmxlbmd0aDtmb3IoKytpJDc7aSQ3PGxlbiYmdHlwZXNbaSQ3XSE9XCJMXCI7KytpJDcpe31mb3IodmFyIGokMj1wb3M7aiQyPGkkNzspe2lmKGNvdW50c0FzTnVtLnRlc3QodHlwZXNbaiQyXSkpe2lmKHBvczxqJDIpe29yZGVyLnNwbGljZShhdCwwLG5ldyBCaWRpU3BhbigxLHBvcyxqJDIpKTt9dmFyIG5zdGFydD1qJDI7Zm9yKCsraiQyO2okMjxpJDcmJmNvdW50c0FzTnVtLnRlc3QodHlwZXNbaiQyXSk7KytqJDIpe31vcmRlci5zcGxpY2UoYXQsMCxuZXcgQmlkaVNwYW4oMixuc3RhcnQsaiQyKSk7cG9zPWokMjt9ZWxzZXsrK2okMjt9fWlmKHBvczxpJDcpe29yZGVyLnNwbGljZShhdCwwLG5ldyBCaWRpU3BhbigxLHBvcyxpJDcpKTt9fX1pZihvcmRlclswXS5sZXZlbD09MSYmKG09c3RyLm1hdGNoKC9eXFxzKy8pKSl7b3JkZXJbMF0uZnJvbT1tWzBdLmxlbmd0aDtvcmRlci51bnNoaWZ0KG5ldyBCaWRpU3BhbigwLDAsbVswXS5sZW5ndGgpKTt9aWYobHN0KG9yZGVyKS5sZXZlbD09MSYmKG09c3RyLm1hdGNoKC9cXHMrJC8pKSl7bHN0KG9yZGVyKS50by09bVswXS5sZW5ndGg7b3JkZXIucHVzaChuZXcgQmlkaVNwYW4oMCxsZW4tbVswXS5sZW5ndGgsbGVuKSk7fWlmKG9yZGVyWzBdLmxldmVsPT0yKXtvcmRlci51bnNoaWZ0KG5ldyBCaWRpU3BhbigxLG9yZGVyWzBdLnRvLG9yZGVyWzBdLnRvKSk7fWlmKG9yZGVyWzBdLmxldmVsIT1sc3Qob3JkZXIpLmxldmVsKXtvcmRlci5wdXNoKG5ldyBCaWRpU3BhbihvcmRlclswXS5sZXZlbCxsZW4sbGVuKSk7fXJldHVybiBvcmRlcjt9O30oKTsvLyBHZXQgdGhlIGJpZGkgb3JkZXJpbmcgZm9yIHRoZSBnaXZlbiBsaW5lIChhbmQgY2FjaGUgaXQpLiBSZXR1cm5zXG4vLyBmYWxzZSBmb3IgbGluZXMgdGhhdCBhcmUgZnVsbHkgbGVmdC10by1yaWdodCwgYW5kIGFuIGFycmF5IG9mXG4vLyBCaWRpU3BhbiBvYmplY3RzIG90aGVyd2lzZS5cbmZ1bmN0aW9uIGdldE9yZGVyKGxpbmUpe3ZhciBvcmRlcj1saW5lLm9yZGVyO2lmKG9yZGVyPT1udWxsKXtvcmRlcj1saW5lLm9yZGVyPWJpZGlPcmRlcmluZyhsaW5lLnRleHQpO31yZXR1cm4gb3JkZXI7fS8vIEVWRU5UIEhBTkRMSU5HXG4vLyBMaWdodHdlaWdodCBldmVudCBmcmFtZXdvcmsuIG9uL29mZiBhbHNvIHdvcmsgb24gRE9NIG5vZGVzLFxuLy8gcmVnaXN0ZXJpbmcgbmF0aXZlIERPTSBoYW5kbGVycy5cbnZhciBvbj1mdW5jdGlvbihlbWl0dGVyLHR5cGUsZil7aWYoZW1pdHRlci5hZGRFdmVudExpc3RlbmVyKXtlbWl0dGVyLmFkZEV2ZW50TGlzdGVuZXIodHlwZSxmLGZhbHNlKTt9ZWxzZSBpZihlbWl0dGVyLmF0dGFjaEV2ZW50KXtlbWl0dGVyLmF0dGFjaEV2ZW50KFwib25cIit0eXBlLGYpO31lbHNle3ZhciBtYXA9ZW1pdHRlci5faGFuZGxlcnN8fChlbWl0dGVyLl9oYW5kbGVycz17fSk7dmFyIGFycj1tYXBbdHlwZV18fChtYXBbdHlwZV09W10pO2Fyci5wdXNoKGYpO319O3ZhciBub0hhbmRsZXJzPVtdO2Z1bmN0aW9uIGdldEhhbmRsZXJzKGVtaXR0ZXIsdHlwZSxjb3B5KXt2YXIgYXJyPWVtaXR0ZXIuX2hhbmRsZXJzJiZlbWl0dGVyLl9oYW5kbGVyc1t0eXBlXTtpZihjb3B5KXtyZXR1cm4gYXJyJiZhcnIubGVuZ3RoPjA/YXJyLnNsaWNlKCk6bm9IYW5kbGVyczt9ZWxzZXtyZXR1cm4gYXJyfHxub0hhbmRsZXJzO319ZnVuY3Rpb24gb2ZmKGVtaXR0ZXIsdHlwZSxmKXtpZihlbWl0dGVyLnJlbW92ZUV2ZW50TGlzdGVuZXIpe2VtaXR0ZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLGYsZmFsc2UpO31lbHNlIGlmKGVtaXR0ZXIuZGV0YWNoRXZlbnQpe2VtaXR0ZXIuZGV0YWNoRXZlbnQoXCJvblwiK3R5cGUsZik7fWVsc2V7dmFyIGhhbmRsZXJzPWdldEhhbmRsZXJzKGVtaXR0ZXIsdHlwZSxmYWxzZSk7Zm9yKHZhciBpPTA7aTxoYW5kbGVycy5sZW5ndGg7KytpKXtpZihoYW5kbGVyc1tpXT09Zil7aGFuZGxlcnMuc3BsaWNlKGksMSk7YnJlYWs7fX19fWZ1bmN0aW9uIHNpZ25hbChlbWl0dGVyLHR5cGUvKiwgdmFsdWVzLi4uKi8pe3ZhciBoYW5kbGVycz1nZXRIYW5kbGVycyhlbWl0dGVyLHR5cGUsdHJ1ZSk7aWYoIWhhbmRsZXJzLmxlbmd0aCl7cmV0dXJuO312YXIgYXJncz1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMik7Zm9yKHZhciBpPTA7aTxoYW5kbGVycy5sZW5ndGg7KytpKXtoYW5kbGVyc1tpXS5hcHBseShudWxsLGFyZ3MpO319Ly8gVGhlIERPTSBldmVudHMgdGhhdCBDb2RlTWlycm9yIGhhbmRsZXMgY2FuIGJlIG92ZXJyaWRkZW4gYnlcbi8vIHJlZ2lzdGVyaW5nIGEgKG5vbi1ET00pIGhhbmRsZXIgb24gdGhlIGVkaXRvciBmb3IgdGhlIGV2ZW50IG5hbWUsXG4vLyBhbmQgcHJldmVudERlZmF1bHQtaW5nIHRoZSBldmVudCBpbiB0aGF0IGhhbmRsZXIuXG5mdW5jdGlvbiBzaWduYWxET01FdmVudChjbSxlLG92ZXJyaWRlKXtpZih0eXBlb2YgZT09XCJzdHJpbmdcIil7ZT17dHlwZTplLHByZXZlbnREZWZhdWx0OmZ1bmN0aW9uKCl7dGhpcy5kZWZhdWx0UHJldmVudGVkPXRydWU7fX07fXNpZ25hbChjbSxvdmVycmlkZXx8ZS50eXBlLGNtLGUpO3JldHVybiBlX2RlZmF1bHRQcmV2ZW50ZWQoZSl8fGUuY29kZW1pcnJvcklnbm9yZTt9ZnVuY3Rpb24gc2lnbmFsQ3Vyc29yQWN0aXZpdHkoY20pe3ZhciBhcnI9Y20uX2hhbmRsZXJzJiZjbS5faGFuZGxlcnMuY3Vyc29yQWN0aXZpdHk7aWYoIWFycil7cmV0dXJuO312YXIgc2V0PWNtLmN1ck9wLmN1cnNvckFjdGl2aXR5SGFuZGxlcnN8fChjbS5jdXJPcC5jdXJzb3JBY3Rpdml0eUhhbmRsZXJzPVtdKTtmb3IodmFyIGk9MDtpPGFyci5sZW5ndGg7KytpKXtpZihpbmRleE9mKHNldCxhcnJbaV0pPT0tMSl7c2V0LnB1c2goYXJyW2ldKTt9fX1mdW5jdGlvbiBoYXNIYW5kbGVyKGVtaXR0ZXIsdHlwZSl7cmV0dXJuIGdldEhhbmRsZXJzKGVtaXR0ZXIsdHlwZSkubGVuZ3RoPjA7fS8vIEFkZCBvbiBhbmQgb2ZmIG1ldGhvZHMgdG8gYSBjb25zdHJ1Y3RvcidzIHByb3RvdHlwZSwgdG8gbWFrZVxuLy8gcmVnaXN0ZXJpbmcgZXZlbnRzIG9uIHN1Y2ggb2JqZWN0cyBtb3JlIGNvbnZlbmllbnQuXG5mdW5jdGlvbiBldmVudE1peGluKGN0b3Ipe2N0b3IucHJvdG90eXBlLm9uPWZ1bmN0aW9uKHR5cGUsZil7b24odGhpcyx0eXBlLGYpO307Y3Rvci5wcm90b3R5cGUub2ZmPWZ1bmN0aW9uKHR5cGUsZil7b2ZmKHRoaXMsdHlwZSxmKTt9O30vLyBEdWUgdG8gdGhlIGZhY3QgdGhhdCB3ZSBzdGlsbCBzdXBwb3J0IGp1cmFzc2ljIElFIHZlcnNpb25zLCBzb21lXG4vLyBjb21wYXRpYmlsaXR5IHdyYXBwZXJzIGFyZSBuZWVkZWQuXG5mdW5jdGlvbiBlX3ByZXZlbnREZWZhdWx0KGUpe2lmKGUucHJldmVudERlZmF1bHQpe2UucHJldmVudERlZmF1bHQoKTt9ZWxzZXtlLnJldHVyblZhbHVlPWZhbHNlO319ZnVuY3Rpb24gZV9zdG9wUHJvcGFnYXRpb24oZSl7aWYoZS5zdG9wUHJvcGFnYXRpb24pe2Uuc3RvcFByb3BhZ2F0aW9uKCk7fWVsc2V7ZS5jYW5jZWxCdWJibGU9dHJ1ZTt9fWZ1bmN0aW9uIGVfZGVmYXVsdFByZXZlbnRlZChlKXtyZXR1cm4gZS5kZWZhdWx0UHJldmVudGVkIT1udWxsP2UuZGVmYXVsdFByZXZlbnRlZDplLnJldHVyblZhbHVlPT1mYWxzZTt9ZnVuY3Rpb24gZV9zdG9wKGUpe2VfcHJldmVudERlZmF1bHQoZSk7ZV9zdG9wUHJvcGFnYXRpb24oZSk7fWZ1bmN0aW9uIGVfdGFyZ2V0KGUpe3JldHVybiBlLnRhcmdldHx8ZS5zcmNFbGVtZW50O31mdW5jdGlvbiBlX2J1dHRvbihlKXt2YXIgYj1lLndoaWNoO2lmKGI9PW51bGwpe2lmKGUuYnV0dG9uJjEpe2I9MTt9ZWxzZSBpZihlLmJ1dHRvbiYyKXtiPTM7fWVsc2UgaWYoZS5idXR0b24mNCl7Yj0yO319aWYobWFjJiZlLmN0cmxLZXkmJmI9PTEpe2I9Mzt9cmV0dXJuIGI7fS8vIERldGVjdCBkcmFnLWFuZC1kcm9wXG52YXIgZHJhZ0FuZERyb3A9ZnVuY3Rpb24oKXsvLyBUaGVyZSBpcyAqc29tZSoga2luZCBvZiBkcmFnLWFuZC1kcm9wIHN1cHBvcnQgaW4gSUU2LTgsIGJ1dCBJXG4vLyBjb3VsZG4ndCBnZXQgaXQgdG8gd29yayB5ZXQuXG5pZihpZSYmaWVfdmVyc2lvbjw5KXtyZXR1cm4gZmFsc2U7fXZhciBkaXY9ZWx0KCdkaXYnKTtyZXR1cm5cImRyYWdnYWJsZVwiaW4gZGl2fHxcImRyYWdEcm9wXCJpbiBkaXY7fSgpO3ZhciB6d3NwU3VwcG9ydGVkO2Z1bmN0aW9uIHplcm9XaWR0aEVsZW1lbnQobWVhc3VyZSl7aWYoendzcFN1cHBvcnRlZD09bnVsbCl7dmFyIHRlc3Q9ZWx0KFwic3BhblwiLFwiXFx1MjAwYlwiKTtyZW1vdmVDaGlsZHJlbkFuZEFkZChtZWFzdXJlLGVsdChcInNwYW5cIixbdGVzdCxkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShcInhcIildKSk7aWYobWVhc3VyZS5maXJzdENoaWxkLm9mZnNldEhlaWdodCE9MCl7endzcFN1cHBvcnRlZD10ZXN0Lm9mZnNldFdpZHRoPD0xJiZ0ZXN0Lm9mZnNldEhlaWdodD4yJiYhKGllJiZpZV92ZXJzaW9uPDgpO319dmFyIG5vZGU9endzcFN1cHBvcnRlZD9lbHQoXCJzcGFuXCIsXCJcXHUyMDBiXCIpOmVsdChcInNwYW5cIixcIlxcdTAwYTBcIixudWxsLFwiZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aWR0aDogMXB4OyBtYXJnaW4tcmlnaHQ6IC0xcHhcIik7bm9kZS5zZXRBdHRyaWJ1dGUoXCJjbS10ZXh0XCIsXCJcIik7cmV0dXJuIG5vZGU7fS8vIEZlYXR1cmUtZGV0ZWN0IElFJ3MgY3J1bW15IGNsaWVudCByZWN0IHJlcG9ydGluZyBmb3IgYmlkaSB0ZXh0XG52YXIgYmFkQmlkaVJlY3RzO2Z1bmN0aW9uIGhhc0JhZEJpZGlSZWN0cyhtZWFzdXJlKXtpZihiYWRCaWRpUmVjdHMhPW51bGwpe3JldHVybiBiYWRCaWRpUmVjdHM7fXZhciB0eHQ9cmVtb3ZlQ2hpbGRyZW5BbmRBZGQobWVhc3VyZSxkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShcIkFcXHUwNjJlQVwiKSk7dmFyIHIwPXJhbmdlKHR4dCwwLDEpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO3ZhciByMT1yYW5nZSh0eHQsMSwyKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtyZW1vdmVDaGlsZHJlbihtZWFzdXJlKTtpZighcjB8fHIwLmxlZnQ9PXIwLnJpZ2h0KXtyZXR1cm4gZmFsc2U7fS8vIFNhZmFyaSByZXR1cm5zIG51bGwgaW4gc29tZSBjYXNlcyAoIzI3ODApXG5yZXR1cm4gYmFkQmlkaVJlY3RzPXIxLnJpZ2h0LXIwLnJpZ2h0PDM7fS8vIFNlZSBpZiBcIlwiLnNwbGl0IGlzIHRoZSBicm9rZW4gSUUgdmVyc2lvbiwgaWYgc28sIHByb3ZpZGUgYW5cbi8vIGFsdGVybmF0aXZlIHdheSB0byBzcGxpdCBsaW5lcy5cbnZhciBzcGxpdExpbmVzQXV0bz1cIlxcblxcbmJcIi5zcGxpdCgvXFxuLykubGVuZ3RoIT0zP2Z1bmN0aW9uKHN0cmluZyl7dmFyIHBvcz0wLHJlc3VsdD1bXSxsPXN0cmluZy5sZW5ndGg7d2hpbGUocG9zPD1sKXt2YXIgbmw9c3RyaW5nLmluZGV4T2YoXCJcXG5cIixwb3MpO2lmKG5sPT0tMSl7bmw9c3RyaW5nLmxlbmd0aDt9dmFyIGxpbmU9c3RyaW5nLnNsaWNlKHBvcyxzdHJpbmcuY2hhckF0KG5sLTEpPT1cIlxcclwiP25sLTE6bmwpO3ZhciBydD1saW5lLmluZGV4T2YoXCJcXHJcIik7aWYocnQhPS0xKXtyZXN1bHQucHVzaChsaW5lLnNsaWNlKDAscnQpKTtwb3MrPXJ0KzE7fWVsc2V7cmVzdWx0LnB1c2gobGluZSk7cG9zPW5sKzE7fX1yZXR1cm4gcmVzdWx0O306ZnVuY3Rpb24oc3RyaW5nKXtyZXR1cm4gc3RyaW5nLnNwbGl0KC9cXHJcXG4/fFxcbi8pO307dmFyIGhhc1NlbGVjdGlvbj13aW5kb3cuZ2V0U2VsZWN0aW9uP2Z1bmN0aW9uKHRlKXt0cnl7cmV0dXJuIHRlLnNlbGVjdGlvblN0YXJ0IT10ZS5zZWxlY3Rpb25FbmQ7fWNhdGNoKGUpe3JldHVybiBmYWxzZTt9fTpmdW5jdGlvbih0ZSl7dmFyIHJhbmdlO3RyeXtyYW5nZT10ZS5vd25lckRvY3VtZW50LnNlbGVjdGlvbi5jcmVhdGVSYW5nZSgpO31jYXRjaChlKXt9aWYoIXJhbmdlfHxyYW5nZS5wYXJlbnRFbGVtZW50KCkhPXRlKXtyZXR1cm4gZmFsc2U7fXJldHVybiByYW5nZS5jb21wYXJlRW5kUG9pbnRzKFwiU3RhcnRUb0VuZFwiLHJhbmdlKSE9MDt9O3ZhciBoYXNDb3B5RXZlbnQ9ZnVuY3Rpb24oKXt2YXIgZT1lbHQoXCJkaXZcIik7aWYoXCJvbmNvcHlcImluIGUpe3JldHVybiB0cnVlO31lLnNldEF0dHJpYnV0ZShcIm9uY29weVwiLFwicmV0dXJuO1wiKTtyZXR1cm4gdHlwZW9mIGUub25jb3B5PT1cImZ1bmN0aW9uXCI7fSgpO3ZhciBiYWRab29tZWRSZWN0cz1udWxsO2Z1bmN0aW9uIGhhc0JhZFpvb21lZFJlY3RzKG1lYXN1cmUpe2lmKGJhZFpvb21lZFJlY3RzIT1udWxsKXtyZXR1cm4gYmFkWm9vbWVkUmVjdHM7fXZhciBub2RlPXJlbW92ZUNoaWxkcmVuQW5kQWRkKG1lYXN1cmUsZWx0KFwic3BhblwiLFwieFwiKSk7dmFyIG5vcm1hbD1ub2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO3ZhciBmcm9tUmFuZ2U9cmFuZ2Uobm9kZSwwLDEpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO3JldHVybiBiYWRab29tZWRSZWN0cz1NYXRoLmFicyhub3JtYWwubGVmdC1mcm9tUmFuZ2UubGVmdCk+MTt9dmFyIG1vZGVzPXt9O3ZhciBtaW1lTW9kZXM9e307Ly8gRXh0cmEgYXJndW1lbnRzIGFyZSBzdG9yZWQgYXMgdGhlIG1vZGUncyBkZXBlbmRlbmNpZXMsIHdoaWNoIGlzXG4vLyB1c2VkIGJ5IChsZWdhY3kpIG1lY2hhbmlzbXMgbGlrZSBsb2FkbW9kZS5qcyB0byBhdXRvbWF0aWNhbGx5XG4vLyBsb2FkIGEgbW9kZS4gKFByZWZlcnJlZCBtZWNoYW5pc20gaXMgdGhlIHJlcXVpcmUvZGVmaW5lIGNhbGxzLilcbmZ1bmN0aW9uIGRlZmluZU1vZGUobmFtZSxtb2RlKXtpZihhcmd1bWVudHMubGVuZ3RoPjIpe21vZGUuZGVwZW5kZW5jaWVzPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKTt9bW9kZXNbbmFtZV09bW9kZTt9ZnVuY3Rpb24gZGVmaW5lTUlNRShtaW1lLHNwZWMpe21pbWVNb2Rlc1ttaW1lXT1zcGVjO30vLyBHaXZlbiBhIE1JTUUgdHlwZSwgYSB7bmFtZSwgLi4ub3B0aW9uc30gY29uZmlnIG9iamVjdCwgb3IgYSBuYW1lXG4vLyBzdHJpbmcsIHJldHVybiBhIG1vZGUgY29uZmlnIG9iamVjdC5cbmZ1bmN0aW9uIHJlc29sdmVNb2RlKHNwZWMpe2lmKHR5cGVvZiBzcGVjPT1cInN0cmluZ1wiJiZtaW1lTW9kZXMuaGFzT3duUHJvcGVydHkoc3BlYykpe3NwZWM9bWltZU1vZGVzW3NwZWNdO31lbHNlIGlmKHNwZWMmJnR5cGVvZiBzcGVjLm5hbWU9PVwic3RyaW5nXCImJm1pbWVNb2Rlcy5oYXNPd25Qcm9wZXJ0eShzcGVjLm5hbWUpKXt2YXIgZm91bmQ9bWltZU1vZGVzW3NwZWMubmFtZV07aWYodHlwZW9mIGZvdW5kPT1cInN0cmluZ1wiKXtmb3VuZD17bmFtZTpmb3VuZH07fXNwZWM9Y3JlYXRlT2JqKGZvdW5kLHNwZWMpO3NwZWMubmFtZT1mb3VuZC5uYW1lO31lbHNlIGlmKHR5cGVvZiBzcGVjPT1cInN0cmluZ1wiJiYvXltcXHdcXC1dK1xcL1tcXHdcXC1dK1xcK3htbCQvLnRlc3Qoc3BlYykpe3JldHVybiByZXNvbHZlTW9kZShcImFwcGxpY2F0aW9uL3htbFwiKTt9ZWxzZSBpZih0eXBlb2Ygc3BlYz09XCJzdHJpbmdcIiYmL15bXFx3XFwtXStcXC9bXFx3XFwtXStcXCtqc29uJC8udGVzdChzcGVjKSl7cmV0dXJuIHJlc29sdmVNb2RlKFwiYXBwbGljYXRpb24vanNvblwiKTt9aWYodHlwZW9mIHNwZWM9PVwic3RyaW5nXCIpe3JldHVybntuYW1lOnNwZWN9O31lbHNle3JldHVybiBzcGVjfHx7bmFtZTpcIm51bGxcIn07fX0vLyBHaXZlbiBhIG1vZGUgc3BlYyAoYW55dGhpbmcgdGhhdCByZXNvbHZlTW9kZSBhY2NlcHRzKSwgZmluZCBhbmRcbi8vIGluaXRpYWxpemUgYW4gYWN0dWFsIG1vZGUgb2JqZWN0LlxuZnVuY3Rpb24gZ2V0TW9kZShvcHRpb25zLHNwZWMpe3NwZWM9cmVzb2x2ZU1vZGUoc3BlYyk7dmFyIG1mYWN0b3J5PW1vZGVzW3NwZWMubmFtZV07aWYoIW1mYWN0b3J5KXtyZXR1cm4gZ2V0TW9kZShvcHRpb25zLFwidGV4dC9wbGFpblwiKTt9dmFyIG1vZGVPYmo9bWZhY3Rvcnkob3B0aW9ucyxzcGVjKTtpZihtb2RlRXh0ZW5zaW9ucy5oYXNPd25Qcm9wZXJ0eShzcGVjLm5hbWUpKXt2YXIgZXh0cz1tb2RlRXh0ZW5zaW9uc1tzcGVjLm5hbWVdO2Zvcih2YXIgcHJvcCBpbiBleHRzKXtpZighZXh0cy5oYXNPd25Qcm9wZXJ0eShwcm9wKSl7Y29udGludWU7fWlmKG1vZGVPYmouaGFzT3duUHJvcGVydHkocHJvcCkpe21vZGVPYmpbXCJfXCIrcHJvcF09bW9kZU9ialtwcm9wXTt9bW9kZU9ialtwcm9wXT1leHRzW3Byb3BdO319bW9kZU9iai5uYW1lPXNwZWMubmFtZTtpZihzcGVjLmhlbHBlclR5cGUpe21vZGVPYmouaGVscGVyVHlwZT1zcGVjLmhlbHBlclR5cGU7fWlmKHNwZWMubW9kZVByb3BzKXtmb3IodmFyIHByb3AkMSBpbiBzcGVjLm1vZGVQcm9wcyl7bW9kZU9ialtwcm9wJDFdPXNwZWMubW9kZVByb3BzW3Byb3AkMV07fX1yZXR1cm4gbW9kZU9iajt9Ly8gVGhpcyBjYW4gYmUgdXNlZCB0byBhdHRhY2ggcHJvcGVydGllcyB0byBtb2RlIG9iamVjdHMgZnJvbVxuLy8gb3V0c2lkZSB0aGUgYWN0dWFsIG1vZGUgZGVmaW5pdGlvbi5cbnZhciBtb2RlRXh0ZW5zaW9ucz17fTtmdW5jdGlvbiBleHRlbmRNb2RlKG1vZGUscHJvcGVydGllcyl7dmFyIGV4dHM9bW9kZUV4dGVuc2lvbnMuaGFzT3duUHJvcGVydHkobW9kZSk/bW9kZUV4dGVuc2lvbnNbbW9kZV06bW9kZUV4dGVuc2lvbnNbbW9kZV09e307Y29weU9iaihwcm9wZXJ0aWVzLGV4dHMpO31mdW5jdGlvbiBjb3B5U3RhdGUobW9kZSxzdGF0ZSl7aWYoc3RhdGU9PT10cnVlKXtyZXR1cm4gc3RhdGU7fWlmKG1vZGUuY29weVN0YXRlKXtyZXR1cm4gbW9kZS5jb3B5U3RhdGUoc3RhdGUpO312YXIgbnN0YXRlPXt9O2Zvcih2YXIgbiBpbiBzdGF0ZSl7dmFyIHZhbD1zdGF0ZVtuXTtpZih2YWwgaW5zdGFuY2VvZiBBcnJheSl7dmFsPXZhbC5jb25jYXQoW10pO31uc3RhdGVbbl09dmFsO31yZXR1cm4gbnN0YXRlO30vLyBHaXZlbiBhIG1vZGUgYW5kIGEgc3RhdGUgKGZvciB0aGF0IG1vZGUpLCBmaW5kIHRoZSBpbm5lciBtb2RlIGFuZFxuLy8gc3RhdGUgYXQgdGhlIHBvc2l0aW9uIHRoYXQgdGhlIHN0YXRlIHJlZmVycyB0by5cbmZ1bmN0aW9uIGlubmVyTW9kZShtb2RlLHN0YXRlKXt2YXIgaW5mbzt3aGlsZShtb2RlLmlubmVyTW9kZSl7aW5mbz1tb2RlLmlubmVyTW9kZShzdGF0ZSk7aWYoIWluZm98fGluZm8ubW9kZT09bW9kZSl7YnJlYWs7fXN0YXRlPWluZm8uc3RhdGU7bW9kZT1pbmZvLm1vZGU7fXJldHVybiBpbmZvfHx7bW9kZTptb2RlLHN0YXRlOnN0YXRlfTt9ZnVuY3Rpb24gc3RhcnRTdGF0ZShtb2RlLGExLGEyKXtyZXR1cm4gbW9kZS5zdGFydFN0YXRlP21vZGUuc3RhcnRTdGF0ZShhMSxhMik6dHJ1ZTt9Ly8gU1RSSU5HIFNUUkVBTVxuLy8gRmVkIHRvIHRoZSBtb2RlIHBhcnNlcnMsIHByb3ZpZGVzIGhlbHBlciBmdW5jdGlvbnMgdG8gbWFrZVxuLy8gcGFyc2VycyBtb3JlIHN1Y2NpbmN0LlxudmFyIFN0cmluZ1N0cmVhbT1mdW5jdGlvbihzdHJpbmcsdGFiU2l6ZSl7dGhpcy5wb3M9dGhpcy5zdGFydD0wO3RoaXMuc3RyaW5nPXN0cmluZzt0aGlzLnRhYlNpemU9dGFiU2l6ZXx8ODt0aGlzLmxhc3RDb2x1bW5Qb3M9dGhpcy5sYXN0Q29sdW1uVmFsdWU9MDt0aGlzLmxpbmVTdGFydD0wO307U3RyaW5nU3RyZWFtLnByb3RvdHlwZT17ZW9sOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucG9zPj10aGlzLnN0cmluZy5sZW5ndGg7fSxzb2w6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wb3M9PXRoaXMubGluZVN0YXJ0O30scGVlazpmdW5jdGlvbigpe3JldHVybiB0aGlzLnN0cmluZy5jaGFyQXQodGhpcy5wb3MpfHx1bmRlZmluZWQ7fSxuZXh0OmZ1bmN0aW9uKCl7aWYodGhpcy5wb3M8dGhpcy5zdHJpbmcubGVuZ3RoKXtyZXR1cm4gdGhpcy5zdHJpbmcuY2hhckF0KHRoaXMucG9zKyspO319LGVhdDpmdW5jdGlvbihtYXRjaCl7dmFyIGNoPXRoaXMuc3RyaW5nLmNoYXJBdCh0aGlzLnBvcyk7dmFyIG9rO2lmKHR5cGVvZiBtYXRjaD09XCJzdHJpbmdcIil7b2s9Y2g9PW1hdGNoO31lbHNle29rPWNoJiYobWF0Y2gudGVzdD9tYXRjaC50ZXN0KGNoKTptYXRjaChjaCkpO31pZihvayl7Kyt0aGlzLnBvcztyZXR1cm4gY2g7fX0sZWF0V2hpbGU6ZnVuY3Rpb24obWF0Y2gpe3ZhciBzdGFydD10aGlzLnBvczt3aGlsZSh0aGlzLmVhdChtYXRjaCkpe31yZXR1cm4gdGhpcy5wb3M+c3RhcnQ7fSxlYXRTcGFjZTpmdW5jdGlvbigpe3ZhciB0aGlzJDE9dGhpczt2YXIgc3RhcnQ9dGhpcy5wb3M7d2hpbGUoL1tcXHNcXHUwMGEwXS8udGVzdCh0aGlzLnN0cmluZy5jaGFyQXQodGhpcy5wb3MpKSl7Kyt0aGlzJDEucG9zO31yZXR1cm4gdGhpcy5wb3M+c3RhcnQ7fSxza2lwVG9FbmQ6ZnVuY3Rpb24oKXt0aGlzLnBvcz10aGlzLnN0cmluZy5sZW5ndGg7fSxza2lwVG86ZnVuY3Rpb24oY2gpe3ZhciBmb3VuZD10aGlzLnN0cmluZy5pbmRleE9mKGNoLHRoaXMucG9zKTtpZihmb3VuZD4tMSl7dGhpcy5wb3M9Zm91bmQ7cmV0dXJuIHRydWU7fX0sYmFja1VwOmZ1bmN0aW9uKG4pe3RoaXMucG9zLT1uO30sY29sdW1uOmZ1bmN0aW9uKCl7aWYodGhpcy5sYXN0Q29sdW1uUG9zPHRoaXMuc3RhcnQpe3RoaXMubGFzdENvbHVtblZhbHVlPWNvdW50Q29sdW1uKHRoaXMuc3RyaW5nLHRoaXMuc3RhcnQsdGhpcy50YWJTaXplLHRoaXMubGFzdENvbHVtblBvcyx0aGlzLmxhc3RDb2x1bW5WYWx1ZSk7dGhpcy5sYXN0Q29sdW1uUG9zPXRoaXMuc3RhcnQ7fXJldHVybiB0aGlzLmxhc3RDb2x1bW5WYWx1ZS0odGhpcy5saW5lU3RhcnQ/Y291bnRDb2x1bW4odGhpcy5zdHJpbmcsdGhpcy5saW5lU3RhcnQsdGhpcy50YWJTaXplKTowKTt9LGluZGVudGF0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuIGNvdW50Q29sdW1uKHRoaXMuc3RyaW5nLG51bGwsdGhpcy50YWJTaXplKS0odGhpcy5saW5lU3RhcnQ/Y291bnRDb2x1bW4odGhpcy5zdHJpbmcsdGhpcy5saW5lU3RhcnQsdGhpcy50YWJTaXplKTowKTt9LG1hdGNoOmZ1bmN0aW9uKHBhdHRlcm4sY29uc3VtZSxjYXNlSW5zZW5zaXRpdmUpe2lmKHR5cGVvZiBwYXR0ZXJuPT1cInN0cmluZ1wiKXt2YXIgY2FzZWQ9ZnVuY3Rpb24oc3RyKXtyZXR1cm4gY2FzZUluc2Vuc2l0aXZlP3N0ci50b0xvd2VyQ2FzZSgpOnN0cjt9O3ZhciBzdWJzdHI9dGhpcy5zdHJpbmcuc3Vic3RyKHRoaXMucG9zLHBhdHRlcm4ubGVuZ3RoKTtpZihjYXNlZChzdWJzdHIpPT1jYXNlZChwYXR0ZXJuKSl7aWYoY29uc3VtZSE9PWZhbHNlKXt0aGlzLnBvcys9cGF0dGVybi5sZW5ndGg7fXJldHVybiB0cnVlO319ZWxzZXt2YXIgbWF0Y2g9dGhpcy5zdHJpbmcuc2xpY2UodGhpcy5wb3MpLm1hdGNoKHBhdHRlcm4pO2lmKG1hdGNoJiZtYXRjaC5pbmRleD4wKXtyZXR1cm4gbnVsbDt9aWYobWF0Y2gmJmNvbnN1bWUhPT1mYWxzZSl7dGhpcy5wb3MrPW1hdGNoWzBdLmxlbmd0aDt9cmV0dXJuIG1hdGNoO319LGN1cnJlbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zdHJpbmcuc2xpY2UodGhpcy5zdGFydCx0aGlzLnBvcyk7fSxoaWRlRmlyc3RDaGFyczpmdW5jdGlvbihuLGlubmVyKXt0aGlzLmxpbmVTdGFydCs9bjt0cnl7cmV0dXJuIGlubmVyKCk7fWZpbmFsbHl7dGhpcy5saW5lU3RhcnQtPW47fX19Oy8vIENvbXB1dGUgYSBzdHlsZSBhcnJheSAoYW4gYXJyYXkgc3RhcnRpbmcgd2l0aCBhIG1vZGUgZ2VuZXJhdGlvblxuLy8gLS0gZm9yIGludmFsaWRhdGlvbiAtLSBmb2xsb3dlZCBieSBwYWlycyBvZiBlbmQgcG9zaXRpb25zIGFuZFxuLy8gc3R5bGUgc3RyaW5ncyksIHdoaWNoIGlzIHVzZWQgdG8gaGlnaGxpZ2h0IHRoZSB0b2tlbnMgb24gdGhlXG4vLyBsaW5lLlxuZnVuY3Rpb24gaGlnaGxpZ2h0TGluZShjbSxsaW5lLHN0YXRlLGZvcmNlVG9FbmQpey8vIEEgc3R5bGVzIGFycmF5IGFsd2F5cyBzdGFydHMgd2l0aCBhIG51bWJlciBpZGVudGlmeWluZyB0aGVcbi8vIG1vZGUvb3ZlcmxheXMgdGhhdCBpdCBpcyBiYXNlZCBvbiAoZm9yIGVhc3kgaW52YWxpZGF0aW9uKS5cbnZhciBzdD1bY20uc3RhdGUubW9kZUdlbl0sbGluZUNsYXNzZXM9e307Ly8gQ29tcHV0ZSB0aGUgYmFzZSBhcnJheSBvZiBzdHlsZXNcbnJ1bk1vZGUoY20sbGluZS50ZXh0LGNtLmRvYy5tb2RlLHN0YXRlLGZ1bmN0aW9uKGVuZCxzdHlsZSl7cmV0dXJuIHN0LnB1c2goZW5kLHN0eWxlKTt9LGxpbmVDbGFzc2VzLGZvcmNlVG9FbmQpOy8vIFJ1biBvdmVybGF5cywgYWRqdXN0IHN0eWxlIGFycmF5LlxudmFyIGxvb3A9ZnVuY3Rpb24obyl7dmFyIG92ZXJsYXk9Y20uc3RhdGUub3ZlcmxheXNbb10saT0xLGF0PTA7cnVuTW9kZShjbSxsaW5lLnRleHQsb3ZlcmxheS5tb2RlLHRydWUsZnVuY3Rpb24oZW5kLHN0eWxlKXt2YXIgc3RhcnQ9aTsvLyBFbnN1cmUgdGhlcmUncyBhIHRva2VuIGVuZCBhdCB0aGUgY3VycmVudCBwb3NpdGlvbiwgYW5kIHRoYXQgaSBwb2ludHMgYXQgaXRcbndoaWxlKGF0PGVuZCl7dmFyIGlfZW5kPXN0W2ldO2lmKGlfZW5kPmVuZCl7c3Quc3BsaWNlKGksMSxlbmQsc3RbaSsxXSxpX2VuZCk7fWkrPTI7YXQ9TWF0aC5taW4oZW5kLGlfZW5kKTt9aWYoIXN0eWxlKXtyZXR1cm47fWlmKG92ZXJsYXkub3BhcXVlKXtzdC5zcGxpY2Uoc3RhcnQsaS1zdGFydCxlbmQsXCJvdmVybGF5IFwiK3N0eWxlKTtpPXN0YXJ0KzI7fWVsc2V7Zm9yKDtzdGFydDxpO3N0YXJ0Kz0yKXt2YXIgY3VyPXN0W3N0YXJ0KzFdO3N0W3N0YXJ0KzFdPShjdXI/Y3VyK1wiIFwiOlwiXCIpK1wib3ZlcmxheSBcIitzdHlsZTt9fX0sbGluZUNsYXNzZXMpO307Zm9yKHZhciBvPTA7bzxjbS5zdGF0ZS5vdmVybGF5cy5sZW5ndGg7KytvKWxvb3Aobyk7cmV0dXJue3N0eWxlczpzdCxjbGFzc2VzOmxpbmVDbGFzc2VzLmJnQ2xhc3N8fGxpbmVDbGFzc2VzLnRleHRDbGFzcz9saW5lQ2xhc3NlczpudWxsfTt9ZnVuY3Rpb24gZ2V0TGluZVN0eWxlcyhjbSxsaW5lLHVwZGF0ZUZyb250aWVyKXtpZighbGluZS5zdHlsZXN8fGxpbmUuc3R5bGVzWzBdIT1jbS5zdGF0ZS5tb2RlR2VuKXt2YXIgc3RhdGU9Z2V0U3RhdGVCZWZvcmUoY20sbGluZU5vKGxpbmUpKTt2YXIgcmVzdWx0PWhpZ2hsaWdodExpbmUoY20sbGluZSxsaW5lLnRleHQubGVuZ3RoPmNtLm9wdGlvbnMubWF4SGlnaGxpZ2h0TGVuZ3RoP2NvcHlTdGF0ZShjbS5kb2MubW9kZSxzdGF0ZSk6c3RhdGUpO2xpbmUuc3RhdGVBZnRlcj1zdGF0ZTtsaW5lLnN0eWxlcz1yZXN1bHQuc3R5bGVzO2lmKHJlc3VsdC5jbGFzc2VzKXtsaW5lLnN0eWxlQ2xhc3Nlcz1yZXN1bHQuY2xhc3Nlczt9ZWxzZSBpZihsaW5lLnN0eWxlQ2xhc3Nlcyl7bGluZS5zdHlsZUNsYXNzZXM9bnVsbDt9aWYodXBkYXRlRnJvbnRpZXI9PT1jbS5kb2MuZnJvbnRpZXIpe2NtLmRvYy5mcm9udGllcisrO319cmV0dXJuIGxpbmUuc3R5bGVzO31mdW5jdGlvbiBnZXRTdGF0ZUJlZm9yZShjbSxuLHByZWNpc2Upe3ZhciBkb2M9Y20uZG9jLGRpc3BsYXk9Y20uZGlzcGxheTtpZighZG9jLm1vZGUuc3RhcnRTdGF0ZSl7cmV0dXJuIHRydWU7fXZhciBwb3M9ZmluZFN0YXJ0TGluZShjbSxuLHByZWNpc2UpLHN0YXRlPXBvcz5kb2MuZmlyc3QmJmdldExpbmUoZG9jLHBvcy0xKS5zdGF0ZUFmdGVyO2lmKCFzdGF0ZSl7c3RhdGU9c3RhcnRTdGF0ZShkb2MubW9kZSk7fWVsc2V7c3RhdGU9Y29weVN0YXRlKGRvYy5tb2RlLHN0YXRlKTt9ZG9jLml0ZXIocG9zLG4sZnVuY3Rpb24obGluZSl7cHJvY2Vzc0xpbmUoY20sbGluZS50ZXh0LHN0YXRlKTt2YXIgc2F2ZT1wb3M9PW4tMXx8cG9zJTU9PTB8fHBvcz49ZGlzcGxheS52aWV3RnJvbSYmcG9zPGRpc3BsYXkudmlld1RvO2xpbmUuc3RhdGVBZnRlcj1zYXZlP2NvcHlTdGF0ZShkb2MubW9kZSxzdGF0ZSk6bnVsbDsrK3Bvczt9KTtpZihwcmVjaXNlKXtkb2MuZnJvbnRpZXI9cG9zO31yZXR1cm4gc3RhdGU7fS8vIExpZ2h0d2VpZ2h0IGZvcm0gb2YgaGlnaGxpZ2h0IC0tIHByb2NlZWQgb3ZlciB0aGlzIGxpbmUgYW5kXG4vLyB1cGRhdGUgc3RhdGUsIGJ1dCBkb24ndCBzYXZlIGEgc3R5bGUgYXJyYXkuIFVzZWQgZm9yIGxpbmVzIHRoYXRcbi8vIGFyZW4ndCBjdXJyZW50bHkgdmlzaWJsZS5cbmZ1bmN0aW9uIHByb2Nlc3NMaW5lKGNtLHRleHQsc3RhdGUsc3RhcnRBdCl7dmFyIG1vZGU9Y20uZG9jLm1vZGU7dmFyIHN0cmVhbT1uZXcgU3RyaW5nU3RyZWFtKHRleHQsY20ub3B0aW9ucy50YWJTaXplKTtzdHJlYW0uc3RhcnQ9c3RyZWFtLnBvcz1zdGFydEF0fHwwO2lmKHRleHQ9PVwiXCIpe2NhbGxCbGFua0xpbmUobW9kZSxzdGF0ZSk7fXdoaWxlKCFzdHJlYW0uZW9sKCkpe3JlYWRUb2tlbihtb2RlLHN0cmVhbSxzdGF0ZSk7c3RyZWFtLnN0YXJ0PXN0cmVhbS5wb3M7fX1mdW5jdGlvbiBjYWxsQmxhbmtMaW5lKG1vZGUsc3RhdGUpe2lmKG1vZGUuYmxhbmtMaW5lKXtyZXR1cm4gbW9kZS5ibGFua0xpbmUoc3RhdGUpO31pZighbW9kZS5pbm5lck1vZGUpe3JldHVybjt9dmFyIGlubmVyPWlubmVyTW9kZShtb2RlLHN0YXRlKTtpZihpbm5lci5tb2RlLmJsYW5rTGluZSl7cmV0dXJuIGlubmVyLm1vZGUuYmxhbmtMaW5lKGlubmVyLnN0YXRlKTt9fWZ1bmN0aW9uIHJlYWRUb2tlbihtb2RlLHN0cmVhbSxzdGF0ZSxpbm5lcil7Zm9yKHZhciBpPTA7aTwxMDtpKyspe2lmKGlubmVyKXtpbm5lclswXT1pbm5lck1vZGUobW9kZSxzdGF0ZSkubW9kZTt9dmFyIHN0eWxlPW1vZGUudG9rZW4oc3RyZWFtLHN0YXRlKTtpZihzdHJlYW0ucG9zPnN0cmVhbS5zdGFydCl7cmV0dXJuIHN0eWxlO319dGhyb3cgbmV3IEVycm9yKFwiTW9kZSBcIittb2RlLm5hbWUrXCIgZmFpbGVkIHRvIGFkdmFuY2Ugc3RyZWFtLlwiKTt9Ly8gVXRpbGl0eSBmb3IgZ2V0VG9rZW5BdCBhbmQgZ2V0TGluZVRva2Vuc1xuZnVuY3Rpb24gdGFrZVRva2VuKGNtLHBvcyxwcmVjaXNlLGFzQXJyYXkpe3ZhciBnZXRPYmo9ZnVuY3Rpb24oY29weSl7cmV0dXJue3N0YXJ0OnN0cmVhbS5zdGFydCxlbmQ6c3RyZWFtLnBvcyxzdHJpbmc6c3RyZWFtLmN1cnJlbnQoKSx0eXBlOnN0eWxlfHxudWxsLHN0YXRlOmNvcHk/Y29weVN0YXRlKGRvYy5tb2RlLHN0YXRlKTpzdGF0ZX07fTt2YXIgZG9jPWNtLmRvYyxtb2RlPWRvYy5tb2RlLHN0eWxlO3Bvcz1jbGlwUG9zKGRvYyxwb3MpO3ZhciBsaW5lPWdldExpbmUoZG9jLHBvcy5saW5lKSxzdGF0ZT1nZXRTdGF0ZUJlZm9yZShjbSxwb3MubGluZSxwcmVjaXNlKTt2YXIgc3RyZWFtPW5ldyBTdHJpbmdTdHJlYW0obGluZS50ZXh0LGNtLm9wdGlvbnMudGFiU2l6ZSksdG9rZW5zO2lmKGFzQXJyYXkpe3Rva2Vucz1bXTt9d2hpbGUoKGFzQXJyYXl8fHN0cmVhbS5wb3M8cG9zLmNoKSYmIXN0cmVhbS5lb2woKSl7c3RyZWFtLnN0YXJ0PXN0cmVhbS5wb3M7c3R5bGU9cmVhZFRva2VuKG1vZGUsc3RyZWFtLHN0YXRlKTtpZihhc0FycmF5KXt0b2tlbnMucHVzaChnZXRPYmoodHJ1ZSkpO319cmV0dXJuIGFzQXJyYXk/dG9rZW5zOmdldE9iaigpO31mdW5jdGlvbiBleHRyYWN0TGluZUNsYXNzZXModHlwZSxvdXRwdXQpe2lmKHR5cGUpe2Zvcig7Oyl7dmFyIGxpbmVDbGFzcz10eXBlLm1hdGNoKC8oPzpefFxccyspbGluZS0oYmFja2dyb3VuZC0pPyhcXFMrKS8pO2lmKCFsaW5lQ2xhc3Mpe2JyZWFrO310eXBlPXR5cGUuc2xpY2UoMCxsaW5lQ2xhc3MuaW5kZXgpK3R5cGUuc2xpY2UobGluZUNsYXNzLmluZGV4K2xpbmVDbGFzc1swXS5sZW5ndGgpO3ZhciBwcm9wPWxpbmVDbGFzc1sxXT9cImJnQ2xhc3NcIjpcInRleHRDbGFzc1wiO2lmKG91dHB1dFtwcm9wXT09bnVsbCl7b3V0cHV0W3Byb3BdPWxpbmVDbGFzc1syXTt9ZWxzZSBpZighbmV3IFJlZ0V4cChcIig/Ol58XFxzKVwiK2xpbmVDbGFzc1syXStcIig/OiR8XFxzKVwiKS50ZXN0KG91dHB1dFtwcm9wXSkpe291dHB1dFtwcm9wXSs9XCIgXCIrbGluZUNsYXNzWzJdO319fXJldHVybiB0eXBlO30vLyBSdW4gdGhlIGdpdmVuIG1vZGUncyBwYXJzZXIgb3ZlciBhIGxpbmUsIGNhbGxpbmcgZiBmb3IgZWFjaCB0b2tlbi5cbmZ1bmN0aW9uIHJ1bk1vZGUoY20sdGV4dCxtb2RlLHN0YXRlLGYsbGluZUNsYXNzZXMsZm9yY2VUb0VuZCl7dmFyIGZsYXR0ZW5TcGFucz1tb2RlLmZsYXR0ZW5TcGFucztpZihmbGF0dGVuU3BhbnM9PW51bGwpe2ZsYXR0ZW5TcGFucz1jbS5vcHRpb25zLmZsYXR0ZW5TcGFuczt9dmFyIGN1clN0YXJ0PTAsY3VyU3R5bGU9bnVsbDt2YXIgc3RyZWFtPW5ldyBTdHJpbmdTdHJlYW0odGV4dCxjbS5vcHRpb25zLnRhYlNpemUpLHN0eWxlO3ZhciBpbm5lcj1jbS5vcHRpb25zLmFkZE1vZGVDbGFzcyYmW251bGxdO2lmKHRleHQ9PVwiXCIpe2V4dHJhY3RMaW5lQ2xhc3NlcyhjYWxsQmxhbmtMaW5lKG1vZGUsc3RhdGUpLGxpbmVDbGFzc2VzKTt9d2hpbGUoIXN0cmVhbS5lb2woKSl7aWYoc3RyZWFtLnBvcz5jbS5vcHRpb25zLm1heEhpZ2hsaWdodExlbmd0aCl7ZmxhdHRlblNwYW5zPWZhbHNlO2lmKGZvcmNlVG9FbmQpe3Byb2Nlc3NMaW5lKGNtLHRleHQsc3RhdGUsc3RyZWFtLnBvcyk7fXN0cmVhbS5wb3M9dGV4dC5sZW5ndGg7c3R5bGU9bnVsbDt9ZWxzZXtzdHlsZT1leHRyYWN0TGluZUNsYXNzZXMocmVhZFRva2VuKG1vZGUsc3RyZWFtLHN0YXRlLGlubmVyKSxsaW5lQ2xhc3Nlcyk7fWlmKGlubmVyKXt2YXIgbU5hbWU9aW5uZXJbMF0ubmFtZTtpZihtTmFtZSl7c3R5bGU9XCJtLVwiKyhzdHlsZT9tTmFtZStcIiBcIitzdHlsZTptTmFtZSk7fX1pZighZmxhdHRlblNwYW5zfHxjdXJTdHlsZSE9c3R5bGUpe3doaWxlKGN1clN0YXJ0PHN0cmVhbS5zdGFydCl7Y3VyU3RhcnQ9TWF0aC5taW4oc3RyZWFtLnN0YXJ0LGN1clN0YXJ0KzUwMDApO2YoY3VyU3RhcnQsY3VyU3R5bGUpO31jdXJTdHlsZT1zdHlsZTt9c3RyZWFtLnN0YXJ0PXN0cmVhbS5wb3M7fXdoaWxlKGN1clN0YXJ0PHN0cmVhbS5wb3Mpey8vIFdlYmtpdCBzZWVtcyB0byByZWZ1c2UgdG8gcmVuZGVyIHRleHQgbm9kZXMgbG9uZ2VyIHRoYW4gNTc0NDRcbi8vIGNoYXJhY3RlcnMsIGFuZCByZXR1cm5zIGluYWNjdXJhdGUgbWVhc3VyZW1lbnRzIGluIG5vZGVzXG4vLyBzdGFydGluZyBhcm91bmQgNTAwMCBjaGFycy5cbnZhciBwb3M9TWF0aC5taW4oc3RyZWFtLnBvcyxjdXJTdGFydCs1MDAwKTtmKHBvcyxjdXJTdHlsZSk7Y3VyU3RhcnQ9cG9zO319Ly8gRmluZHMgdGhlIGxpbmUgdG8gc3RhcnQgd2l0aCB3aGVuIHN0YXJ0aW5nIGEgcGFyc2UuIFRyaWVzIHRvXG4vLyBmaW5kIGEgbGluZSB3aXRoIGEgc3RhdGVBZnRlciwgc28gdGhhdCBpdCBjYW4gc3RhcnQgd2l0aCBhXG4vLyB2YWxpZCBzdGF0ZS4gSWYgdGhhdCBmYWlscywgaXQgcmV0dXJucyB0aGUgbGluZSB3aXRoIHRoZVxuLy8gc21hbGxlc3QgaW5kZW50YXRpb24sIHdoaWNoIHRlbmRzIHRvIG5lZWQgdGhlIGxlYXN0IGNvbnRleHQgdG9cbi8vIHBhcnNlIGNvcnJlY3RseS5cbmZ1bmN0aW9uIGZpbmRTdGFydExpbmUoY20sbixwcmVjaXNlKXt2YXIgbWluaW5kZW50LG1pbmxpbmUsZG9jPWNtLmRvYzt2YXIgbGltPXByZWNpc2U/LTE6bi0oY20uZG9jLm1vZGUuaW5uZXJNb2RlPzEwMDA6MTAwKTtmb3IodmFyIHNlYXJjaD1uO3NlYXJjaD5saW07LS1zZWFyY2gpe2lmKHNlYXJjaDw9ZG9jLmZpcnN0KXtyZXR1cm4gZG9jLmZpcnN0O312YXIgbGluZT1nZXRMaW5lKGRvYyxzZWFyY2gtMSk7aWYobGluZS5zdGF0ZUFmdGVyJiYoIXByZWNpc2V8fHNlYXJjaDw9ZG9jLmZyb250aWVyKSl7cmV0dXJuIHNlYXJjaDt9dmFyIGluZGVudGVkPWNvdW50Q29sdW1uKGxpbmUudGV4dCxudWxsLGNtLm9wdGlvbnMudGFiU2l6ZSk7aWYobWlubGluZT09bnVsbHx8bWluaW5kZW50PmluZGVudGVkKXttaW5saW5lPXNlYXJjaC0xO21pbmluZGVudD1pbmRlbnRlZDt9fXJldHVybiBtaW5saW5lO30vLyBMSU5FIERBVEEgU1RSVUNUVVJFXG4vLyBMaW5lIG9iamVjdHMuIFRoZXNlIGhvbGQgc3RhdGUgcmVsYXRlZCB0byBhIGxpbmUsIGluY2x1ZGluZ1xuLy8gaGlnaGxpZ2h0aW5nIGluZm8gKHRoZSBzdHlsZXMgYXJyYXkpLlxuZnVuY3Rpb24gTGluZSh0ZXh0LG1hcmtlZFNwYW5zLGVzdGltYXRlSGVpZ2h0KXt0aGlzLnRleHQ9dGV4dDthdHRhY2hNYXJrZWRTcGFucyh0aGlzLG1hcmtlZFNwYW5zKTt0aGlzLmhlaWdodD1lc3RpbWF0ZUhlaWdodD9lc3RpbWF0ZUhlaWdodCh0aGlzKToxO31ldmVudE1peGluKExpbmUpO0xpbmUucHJvdG90eXBlLmxpbmVObz1mdW5jdGlvbigpe3JldHVybiBsaW5lTm8odGhpcyk7fTsvLyBDaGFuZ2UgdGhlIGNvbnRlbnQgKHRleHQsIG1hcmtlcnMpIG9mIGEgbGluZS4gQXV0b21hdGljYWxseVxuLy8gaW52YWxpZGF0ZXMgY2FjaGVkIGluZm9ybWF0aW9uIGFuZCB0cmllcyB0byByZS1lc3RpbWF0ZSB0aGVcbi8vIGxpbmUncyBoZWlnaHQuXG5mdW5jdGlvbiB1cGRhdGVMaW5lKGxpbmUsdGV4dCxtYXJrZWRTcGFucyxlc3RpbWF0ZUhlaWdodCl7bGluZS50ZXh0PXRleHQ7aWYobGluZS5zdGF0ZUFmdGVyKXtsaW5lLnN0YXRlQWZ0ZXI9bnVsbDt9aWYobGluZS5zdHlsZXMpe2xpbmUuc3R5bGVzPW51bGw7fWlmKGxpbmUub3JkZXIhPW51bGwpe2xpbmUub3JkZXI9bnVsbDt9ZGV0YWNoTWFya2VkU3BhbnMobGluZSk7YXR0YWNoTWFya2VkU3BhbnMobGluZSxtYXJrZWRTcGFucyk7dmFyIGVzdEhlaWdodD1lc3RpbWF0ZUhlaWdodD9lc3RpbWF0ZUhlaWdodChsaW5lKToxO2lmKGVzdEhlaWdodCE9bGluZS5oZWlnaHQpe3VwZGF0ZUxpbmVIZWlnaHQobGluZSxlc3RIZWlnaHQpO319Ly8gRGV0YWNoIGEgbGluZSBmcm9tIHRoZSBkb2N1bWVudCB0cmVlIGFuZCBpdHMgbWFya2Vycy5cbmZ1bmN0aW9uIGNsZWFuVXBMaW5lKGxpbmUpe2xpbmUucGFyZW50PW51bGw7ZGV0YWNoTWFya2VkU3BhbnMobGluZSk7fS8vIENvbnZlcnQgYSBzdHlsZSBhcyByZXR1cm5lZCBieSBhIG1vZGUgKGVpdGhlciBudWxsLCBvciBhIHN0cmluZ1xuLy8gY29udGFpbmluZyBvbmUgb3IgbW9yZSBzdHlsZXMpIHRvIGEgQ1NTIHN0eWxlLiBUaGlzIGlzIGNhY2hlZCxcbi8vIGFuZCBhbHNvIGxvb2tzIGZvciBsaW5lLXdpZGUgc3R5bGVzLlxudmFyIHN0eWxlVG9DbGFzc0NhY2hlPXt9O3ZhciBzdHlsZVRvQ2xhc3NDYWNoZVdpdGhNb2RlPXt9O2Z1bmN0aW9uIGludGVycHJldFRva2VuU3R5bGUoc3R5bGUsb3B0aW9ucyl7aWYoIXN0eWxlfHwvXlxccyokLy50ZXN0KHN0eWxlKSl7cmV0dXJuIG51bGw7fXZhciBjYWNoZT1vcHRpb25zLmFkZE1vZGVDbGFzcz9zdHlsZVRvQ2xhc3NDYWNoZVdpdGhNb2RlOnN0eWxlVG9DbGFzc0NhY2hlO3JldHVybiBjYWNoZVtzdHlsZV18fChjYWNoZVtzdHlsZV09c3R5bGUucmVwbGFjZSgvXFxTKy9nLFwiY20tJCZcIikpO30vLyBSZW5kZXIgdGhlIERPTSByZXByZXNlbnRhdGlvbiBvZiB0aGUgdGV4dCBvZiBhIGxpbmUuIEFsc28gYnVpbGRzXG4vLyB1cCBhICdsaW5lIG1hcCcsIHdoaWNoIHBvaW50cyBhdCB0aGUgRE9NIG5vZGVzIHRoYXQgcmVwcmVzZW50XG4vLyBzcGVjaWZpYyBzdHJldGNoZXMgb2YgdGV4dCwgYW5kIGlzIHVzZWQgYnkgdGhlIG1lYXN1cmluZyBjb2RlLlxuLy8gVGhlIHJldHVybmVkIG9iamVjdCBjb250YWlucyB0aGUgRE9NIG5vZGUsIHRoaXMgbWFwLCBhbmRcbi8vIGluZm9ybWF0aW9uIGFib3V0IGxpbmUtd2lkZSBzdHlsZXMgdGhhdCB3ZXJlIHNldCBieSB0aGUgbW9kZS5cbmZ1bmN0aW9uIGJ1aWxkTGluZUNvbnRlbnQoY20sbGluZVZpZXcpey8vIFRoZSBwYWRkaW5nLXJpZ2h0IGZvcmNlcyB0aGUgZWxlbWVudCB0byBoYXZlIGEgJ2JvcmRlcicsIHdoaWNoXG4vLyBpcyBuZWVkZWQgb24gV2Via2l0IHRvIGJlIGFibGUgdG8gZ2V0IGxpbmUtbGV2ZWwgYm91bmRpbmdcbi8vIHJlY3RhbmdsZXMgZm9yIGl0IChpbiBtZWFzdXJlQ2hhcikuXG52YXIgY29udGVudD1lbHQoXCJzcGFuXCIsbnVsbCxudWxsLHdlYmtpdD9cInBhZGRpbmctcmlnaHQ6IC4xcHhcIjpudWxsKTt2YXIgYnVpbGRlcj17cHJlOmVsdChcInByZVwiLFtjb250ZW50XSxcIkNvZGVNaXJyb3ItbGluZVwiKSxjb250ZW50OmNvbnRlbnQsY29sOjAscG9zOjAsY206Y20sdHJhaWxpbmdTcGFjZTpmYWxzZSxzcGxpdFNwYWNlczooaWV8fHdlYmtpdCkmJmNtLmdldE9wdGlvbihcImxpbmVXcmFwcGluZ1wiKX07bGluZVZpZXcubWVhc3VyZT17fTsvLyBJdGVyYXRlIG92ZXIgdGhlIGxvZ2ljYWwgbGluZXMgdGhhdCBtYWtlIHVwIHRoaXMgdmlzdWFsIGxpbmUuXG5mb3IodmFyIGk9MDtpPD0obGluZVZpZXcucmVzdD9saW5lVmlldy5yZXN0Lmxlbmd0aDowKTtpKyspe3ZhciBsaW5lPWk/bGluZVZpZXcucmVzdFtpLTFdOmxpbmVWaWV3LmxpbmUsb3JkZXI9dm9pZCAwO2J1aWxkZXIucG9zPTA7YnVpbGRlci5hZGRUb2tlbj1idWlsZFRva2VuOy8vIE9wdGlvbmFsbHkgd2lyZSBpbiBzb21lIGhhY2tzIGludG8gdGhlIHRva2VuLXJlbmRlcmluZ1xuLy8gYWxnb3JpdGhtLCB0byBkZWFsIHdpdGggYnJvd3NlciBxdWlya3MuXG5pZihoYXNCYWRCaWRpUmVjdHMoY20uZGlzcGxheS5tZWFzdXJlKSYmKG9yZGVyPWdldE9yZGVyKGxpbmUpKSl7YnVpbGRlci5hZGRUb2tlbj1idWlsZFRva2VuQmFkQmlkaShidWlsZGVyLmFkZFRva2VuLG9yZGVyKTt9YnVpbGRlci5tYXA9W107dmFyIGFsbG93RnJvbnRpZXJVcGRhdGU9bGluZVZpZXchPWNtLmRpc3BsYXkuZXh0ZXJuYWxNZWFzdXJlZCYmbGluZU5vKGxpbmUpO2luc2VydExpbmVDb250ZW50KGxpbmUsYnVpbGRlcixnZXRMaW5lU3R5bGVzKGNtLGxpbmUsYWxsb3dGcm9udGllclVwZGF0ZSkpO2lmKGxpbmUuc3R5bGVDbGFzc2VzKXtpZihsaW5lLnN0eWxlQ2xhc3Nlcy5iZ0NsYXNzKXtidWlsZGVyLmJnQ2xhc3M9am9pbkNsYXNzZXMobGluZS5zdHlsZUNsYXNzZXMuYmdDbGFzcyxidWlsZGVyLmJnQ2xhc3N8fFwiXCIpO31pZihsaW5lLnN0eWxlQ2xhc3Nlcy50ZXh0Q2xhc3Mpe2J1aWxkZXIudGV4dENsYXNzPWpvaW5DbGFzc2VzKGxpbmUuc3R5bGVDbGFzc2VzLnRleHRDbGFzcyxidWlsZGVyLnRleHRDbGFzc3x8XCJcIik7fX0vLyBFbnN1cmUgYXQgbGVhc3QgYSBzaW5nbGUgbm9kZSBpcyBwcmVzZW50LCBmb3IgbWVhc3VyaW5nLlxuaWYoYnVpbGRlci5tYXAubGVuZ3RoPT0wKXtidWlsZGVyLm1hcC5wdXNoKDAsMCxidWlsZGVyLmNvbnRlbnQuYXBwZW5kQ2hpbGQoemVyb1dpZHRoRWxlbWVudChjbS5kaXNwbGF5Lm1lYXN1cmUpKSk7fS8vIFN0b3JlIHRoZSBtYXAgYW5kIGEgY2FjaGUgb2JqZWN0IGZvciB0aGUgY3VycmVudCBsb2dpY2FsIGxpbmVcbmlmKGk9PTApe2xpbmVWaWV3Lm1lYXN1cmUubWFwPWJ1aWxkZXIubWFwO2xpbmVWaWV3Lm1lYXN1cmUuY2FjaGU9e307fWVsc2V7OyhsaW5lVmlldy5tZWFzdXJlLm1hcHN8fChsaW5lVmlldy5tZWFzdXJlLm1hcHM9W10pKS5wdXNoKGJ1aWxkZXIubWFwKTsobGluZVZpZXcubWVhc3VyZS5jYWNoZXN8fChsaW5lVmlldy5tZWFzdXJlLmNhY2hlcz1bXSkpLnB1c2goe30pO319Ly8gU2VlIGlzc3VlICMyOTAxXG5pZih3ZWJraXQpe3ZhciBsYXN0PWJ1aWxkZXIuY29udGVudC5sYXN0Q2hpbGQ7aWYoL1xcYmNtLXRhYlxcYi8udGVzdChsYXN0LmNsYXNzTmFtZSl8fGxhc3QucXVlcnlTZWxlY3RvciYmbGFzdC5xdWVyeVNlbGVjdG9yKFwiLmNtLXRhYlwiKSl7YnVpbGRlci5jb250ZW50LmNsYXNzTmFtZT1cImNtLXRhYi13cmFwLWhhY2tcIjt9fXNpZ25hbChjbSxcInJlbmRlckxpbmVcIixjbSxsaW5lVmlldy5saW5lLGJ1aWxkZXIucHJlKTtpZihidWlsZGVyLnByZS5jbGFzc05hbWUpe2J1aWxkZXIudGV4dENsYXNzPWpvaW5DbGFzc2VzKGJ1aWxkZXIucHJlLmNsYXNzTmFtZSxidWlsZGVyLnRleHRDbGFzc3x8XCJcIik7fXJldHVybiBidWlsZGVyO31mdW5jdGlvbiBkZWZhdWx0U3BlY2lhbENoYXJQbGFjZWhvbGRlcihjaCl7dmFyIHRva2VuPWVsdChcInNwYW5cIixcIlxcdTIwMjJcIixcImNtLWludmFsaWRjaGFyXCIpO3Rva2VuLnRpdGxlPVwiXFxcXHVcIitjaC5jaGFyQ29kZUF0KDApLnRvU3RyaW5nKDE2KTt0b2tlbi5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsdG9rZW4udGl0bGUpO3JldHVybiB0b2tlbjt9Ly8gQnVpbGQgdXAgdGhlIERPTSByZXByZXNlbnRhdGlvbiBmb3IgYSBzaW5nbGUgdG9rZW4sIGFuZCBhZGQgaXQgdG9cbi8vIHRoZSBsaW5lIG1hcC4gVGFrZXMgY2FyZSB0byByZW5kZXIgc3BlY2lhbCBjaGFyYWN0ZXJzIHNlcGFyYXRlbHkuXG5mdW5jdGlvbiBidWlsZFRva2VuKGJ1aWxkZXIsdGV4dCxzdHlsZSxzdGFydFN0eWxlLGVuZFN0eWxlLHRpdGxlLGNzcyl7aWYoIXRleHQpe3JldHVybjt9dmFyIGRpc3BsYXlUZXh0PWJ1aWxkZXIuc3BsaXRTcGFjZXM/c3BsaXRTcGFjZXModGV4dCxidWlsZGVyLnRyYWlsaW5nU3BhY2UpOnRleHQ7dmFyIHNwZWNpYWw9YnVpbGRlci5jbS5zdGF0ZS5zcGVjaWFsQ2hhcnMsbXVzdFdyYXA9ZmFsc2U7dmFyIGNvbnRlbnQ7aWYoIXNwZWNpYWwudGVzdCh0ZXh0KSl7YnVpbGRlci5jb2wrPXRleHQubGVuZ3RoO2NvbnRlbnQ9ZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoZGlzcGxheVRleHQpO2J1aWxkZXIubWFwLnB1c2goYnVpbGRlci5wb3MsYnVpbGRlci5wb3MrdGV4dC5sZW5ndGgsY29udGVudCk7aWYoaWUmJmllX3ZlcnNpb248OSl7bXVzdFdyYXA9dHJ1ZTt9YnVpbGRlci5wb3MrPXRleHQubGVuZ3RoO31lbHNle2NvbnRlbnQ9ZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO3ZhciBwb3M9MDt3aGlsZSh0cnVlKXtzcGVjaWFsLmxhc3RJbmRleD1wb3M7dmFyIG09c3BlY2lhbC5leGVjKHRleHQpO3ZhciBza2lwcGVkPW0/bS5pbmRleC1wb3M6dGV4dC5sZW5ndGgtcG9zO2lmKHNraXBwZWQpe3ZhciB0eHQ9ZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoZGlzcGxheVRleHQuc2xpY2UocG9zLHBvcytza2lwcGVkKSk7aWYoaWUmJmllX3ZlcnNpb248OSl7Y29udGVudC5hcHBlbmRDaGlsZChlbHQoXCJzcGFuXCIsW3R4dF0pKTt9ZWxzZXtjb250ZW50LmFwcGVuZENoaWxkKHR4dCk7fWJ1aWxkZXIubWFwLnB1c2goYnVpbGRlci5wb3MsYnVpbGRlci5wb3Mrc2tpcHBlZCx0eHQpO2J1aWxkZXIuY29sKz1za2lwcGVkO2J1aWxkZXIucG9zKz1za2lwcGVkO31pZighbSl7YnJlYWs7fXBvcys9c2tpcHBlZCsxO3ZhciB0eHQkMT12b2lkIDA7aWYobVswXT09XCJcXHRcIil7dmFyIHRhYlNpemU9YnVpbGRlci5jbS5vcHRpb25zLnRhYlNpemUsdGFiV2lkdGg9dGFiU2l6ZS1idWlsZGVyLmNvbCV0YWJTaXplO3R4dCQxPWNvbnRlbnQuYXBwZW5kQ2hpbGQoZWx0KFwic3BhblwiLHNwYWNlU3RyKHRhYldpZHRoKSxcImNtLXRhYlwiKSk7dHh0JDEuc2V0QXR0cmlidXRlKFwicm9sZVwiLFwicHJlc2VudGF0aW9uXCIpO3R4dCQxLnNldEF0dHJpYnV0ZShcImNtLXRleHRcIixcIlxcdFwiKTtidWlsZGVyLmNvbCs9dGFiV2lkdGg7fWVsc2UgaWYobVswXT09XCJcXHJcInx8bVswXT09XCJcXG5cIil7dHh0JDE9Y29udGVudC5hcHBlbmRDaGlsZChlbHQoXCJzcGFuXCIsbVswXT09XCJcXHJcIj9cIlxcdTI0MGRcIjpcIlxcdTI0MjRcIixcImNtLWludmFsaWRjaGFyXCIpKTt0eHQkMS5zZXRBdHRyaWJ1dGUoXCJjbS10ZXh0XCIsbVswXSk7YnVpbGRlci5jb2wrPTE7fWVsc2V7dHh0JDE9YnVpbGRlci5jbS5vcHRpb25zLnNwZWNpYWxDaGFyUGxhY2Vob2xkZXIobVswXSk7dHh0JDEuc2V0QXR0cmlidXRlKFwiY20tdGV4dFwiLG1bMF0pO2lmKGllJiZpZV92ZXJzaW9uPDkpe2NvbnRlbnQuYXBwZW5kQ2hpbGQoZWx0KFwic3BhblwiLFt0eHQkMV0pKTt9ZWxzZXtjb250ZW50LmFwcGVuZENoaWxkKHR4dCQxKTt9YnVpbGRlci5jb2wrPTE7fWJ1aWxkZXIubWFwLnB1c2goYnVpbGRlci5wb3MsYnVpbGRlci5wb3MrMSx0eHQkMSk7YnVpbGRlci5wb3MrKzt9fWJ1aWxkZXIudHJhaWxpbmdTcGFjZT1kaXNwbGF5VGV4dC5jaGFyQ29kZUF0KHRleHQubGVuZ3RoLTEpPT0zMjtpZihzdHlsZXx8c3RhcnRTdHlsZXx8ZW5kU3R5bGV8fG11c3RXcmFwfHxjc3Mpe3ZhciBmdWxsU3R5bGU9c3R5bGV8fFwiXCI7aWYoc3RhcnRTdHlsZSl7ZnVsbFN0eWxlKz1zdGFydFN0eWxlO31pZihlbmRTdHlsZSl7ZnVsbFN0eWxlKz1lbmRTdHlsZTt9dmFyIHRva2VuPWVsdChcInNwYW5cIixbY29udGVudF0sZnVsbFN0eWxlLGNzcyk7aWYodGl0bGUpe3Rva2VuLnRpdGxlPXRpdGxlO31yZXR1cm4gYnVpbGRlci5jb250ZW50LmFwcGVuZENoaWxkKHRva2VuKTt9YnVpbGRlci5jb250ZW50LmFwcGVuZENoaWxkKGNvbnRlbnQpO31mdW5jdGlvbiBzcGxpdFNwYWNlcyh0ZXh0LHRyYWlsaW5nQmVmb3JlKXtpZih0ZXh0Lmxlbmd0aD4xJiYhLyAgLy50ZXN0KHRleHQpKXtyZXR1cm4gdGV4dDt9dmFyIHNwYWNlQmVmb3JlPXRyYWlsaW5nQmVmb3JlLHJlc3VsdD1cIlwiO2Zvcih2YXIgaT0wO2k8dGV4dC5sZW5ndGg7aSsrKXt2YXIgY2g9dGV4dC5jaGFyQXQoaSk7aWYoY2g9PVwiIFwiJiZzcGFjZUJlZm9yZSYmKGk9PXRleHQubGVuZ3RoLTF8fHRleHQuY2hhckNvZGVBdChpKzEpPT0zMikpe2NoPVwiXFx1MDBhMFwiO31yZXN1bHQrPWNoO3NwYWNlQmVmb3JlPWNoPT1cIiBcIjt9cmV0dXJuIHJlc3VsdDt9Ly8gV29yayBhcm91bmQgbm9uc2Vuc2UgZGltZW5zaW9ucyBiZWluZyByZXBvcnRlZCBmb3Igc3RyZXRjaGVzIG9mXG4vLyByaWdodC10by1sZWZ0IHRleHQuXG5mdW5jdGlvbiBidWlsZFRva2VuQmFkQmlkaShpbm5lcixvcmRlcil7cmV0dXJuIGZ1bmN0aW9uKGJ1aWxkZXIsdGV4dCxzdHlsZSxzdGFydFN0eWxlLGVuZFN0eWxlLHRpdGxlLGNzcyl7c3R5bGU9c3R5bGU/c3R5bGUrXCIgY20tZm9yY2UtYm9yZGVyXCI6XCJjbS1mb3JjZS1ib3JkZXJcIjt2YXIgc3RhcnQ9YnVpbGRlci5wb3MsZW5kPXN0YXJ0K3RleHQubGVuZ3RoO2Zvcig7Oyl7Ly8gRmluZCB0aGUgcGFydCB0aGF0IG92ZXJsYXBzIHdpdGggdGhlIHN0YXJ0IG9mIHRoaXMgdGV4dFxudmFyIHBhcnQ9dm9pZCAwO2Zvcih2YXIgaT0wO2k8b3JkZXIubGVuZ3RoO2krKyl7cGFydD1vcmRlcltpXTtpZihwYXJ0LnRvPnN0YXJ0JiZwYXJ0LmZyb208PXN0YXJ0KXticmVhazt9fWlmKHBhcnQudG8+PWVuZCl7cmV0dXJuIGlubmVyKGJ1aWxkZXIsdGV4dCxzdHlsZSxzdGFydFN0eWxlLGVuZFN0eWxlLHRpdGxlLGNzcyk7fWlubmVyKGJ1aWxkZXIsdGV4dC5zbGljZSgwLHBhcnQudG8tc3RhcnQpLHN0eWxlLHN0YXJ0U3R5bGUsbnVsbCx0aXRsZSxjc3MpO3N0YXJ0U3R5bGU9bnVsbDt0ZXh0PXRleHQuc2xpY2UocGFydC50by1zdGFydCk7c3RhcnQ9cGFydC50bzt9fTt9ZnVuY3Rpb24gYnVpbGRDb2xsYXBzZWRTcGFuKGJ1aWxkZXIsc2l6ZSxtYXJrZXIsaWdub3JlV2lkZ2V0KXt2YXIgd2lkZ2V0PSFpZ25vcmVXaWRnZXQmJm1hcmtlci53aWRnZXROb2RlO2lmKHdpZGdldCl7YnVpbGRlci5tYXAucHVzaChidWlsZGVyLnBvcyxidWlsZGVyLnBvcytzaXplLHdpZGdldCk7fWlmKCFpZ25vcmVXaWRnZXQmJmJ1aWxkZXIuY20uZGlzcGxheS5pbnB1dC5uZWVkc0NvbnRlbnRBdHRyaWJ1dGUpe2lmKCF3aWRnZXQpe3dpZGdldD1idWlsZGVyLmNvbnRlbnQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIikpO313aWRnZXQuc2V0QXR0cmlidXRlKFwiY20tbWFya2VyXCIsbWFya2VyLmlkKTt9aWYod2lkZ2V0KXtidWlsZGVyLmNtLmRpc3BsYXkuaW5wdXQuc2V0VW5lZGl0YWJsZSh3aWRnZXQpO2J1aWxkZXIuY29udGVudC5hcHBlbmRDaGlsZCh3aWRnZXQpO31idWlsZGVyLnBvcys9c2l6ZTtidWlsZGVyLnRyYWlsaW5nU3BhY2U9ZmFsc2U7fS8vIE91dHB1dHMgYSBudW1iZXIgb2Ygc3BhbnMgdG8gbWFrZSB1cCBhIGxpbmUsIHRha2luZyBoaWdobGlnaHRpbmdcbi8vIGFuZCBtYXJrZWQgdGV4dCBpbnRvIGFjY291bnQuXG5mdW5jdGlvbiBpbnNlcnRMaW5lQ29udGVudChsaW5lLGJ1aWxkZXIsc3R5bGVzKXt2YXIgc3BhbnM9bGluZS5tYXJrZWRTcGFucyxhbGxUZXh0PWxpbmUudGV4dCxhdD0wO2lmKCFzcGFucyl7Zm9yKHZhciBpJDE9MTtpJDE8c3R5bGVzLmxlbmd0aDtpJDErPTIpe2J1aWxkZXIuYWRkVG9rZW4oYnVpbGRlcixhbGxUZXh0LnNsaWNlKGF0LGF0PXN0eWxlc1tpJDFdKSxpbnRlcnByZXRUb2tlblN0eWxlKHN0eWxlc1tpJDErMV0sYnVpbGRlci5jbS5vcHRpb25zKSk7fXJldHVybjt9dmFyIGxlbj1hbGxUZXh0Lmxlbmd0aCxwb3M9MCxpPTEsdGV4dD1cIlwiLHN0eWxlLGNzczt2YXIgbmV4dENoYW5nZT0wLHNwYW5TdHlsZSxzcGFuRW5kU3R5bGUsc3BhblN0YXJ0U3R5bGUsdGl0bGUsY29sbGFwc2VkO2Zvcig7Oyl7aWYobmV4dENoYW5nZT09cG9zKXsvLyBVcGRhdGUgY3VycmVudCBtYXJrZXIgc2V0XG5zcGFuU3R5bGU9c3BhbkVuZFN0eWxlPXNwYW5TdGFydFN0eWxlPXRpdGxlPWNzcz1cIlwiO2NvbGxhcHNlZD1udWxsO25leHRDaGFuZ2U9SW5maW5pdHk7dmFyIGZvdW5kQm9va21hcmtzPVtdLGVuZFN0eWxlcz12b2lkIDA7Zm9yKHZhciBqPTA7ajxzcGFucy5sZW5ndGg7KytqKXt2YXIgc3A9c3BhbnNbal0sbT1zcC5tYXJrZXI7aWYobS50eXBlPT1cImJvb2ttYXJrXCImJnNwLmZyb209PXBvcyYmbS53aWRnZXROb2RlKXtmb3VuZEJvb2ttYXJrcy5wdXNoKG0pO31lbHNlIGlmKHNwLmZyb208PXBvcyYmKHNwLnRvPT1udWxsfHxzcC50bz5wb3N8fG0uY29sbGFwc2VkJiZzcC50bz09cG9zJiZzcC5mcm9tPT1wb3MpKXtpZihzcC50byE9bnVsbCYmc3AudG8hPXBvcyYmbmV4dENoYW5nZT5zcC50byl7bmV4dENoYW5nZT1zcC50bztzcGFuRW5kU3R5bGU9XCJcIjt9aWYobS5jbGFzc05hbWUpe3NwYW5TdHlsZSs9XCIgXCIrbS5jbGFzc05hbWU7fWlmKG0uY3NzKXtjc3M9KGNzcz9jc3MrXCI7XCI6XCJcIikrbS5jc3M7fWlmKG0uc3RhcnRTdHlsZSYmc3AuZnJvbT09cG9zKXtzcGFuU3RhcnRTdHlsZSs9XCIgXCIrbS5zdGFydFN0eWxlO31pZihtLmVuZFN0eWxlJiZzcC50bz09bmV4dENoYW5nZSl7KGVuZFN0eWxlc3x8KGVuZFN0eWxlcz1bXSkpLnB1c2gobS5lbmRTdHlsZSxzcC50byk7fWlmKG0udGl0bGUmJiF0aXRsZSl7dGl0bGU9bS50aXRsZTt9aWYobS5jb2xsYXBzZWQmJighY29sbGFwc2VkfHxjb21wYXJlQ29sbGFwc2VkTWFya2Vycyhjb2xsYXBzZWQubWFya2VyLG0pPDApKXtjb2xsYXBzZWQ9c3A7fX1lbHNlIGlmKHNwLmZyb20+cG9zJiZuZXh0Q2hhbmdlPnNwLmZyb20pe25leHRDaGFuZ2U9c3AuZnJvbTt9fWlmKGVuZFN0eWxlcyl7Zm9yKHZhciBqJDE9MDtqJDE8ZW5kU3R5bGVzLmxlbmd0aDtqJDErPTIpe2lmKGVuZFN0eWxlc1tqJDErMV09PW5leHRDaGFuZ2Upe3NwYW5FbmRTdHlsZSs9XCIgXCIrZW5kU3R5bGVzW2okMV07fX19aWYoIWNvbGxhcHNlZHx8Y29sbGFwc2VkLmZyb209PXBvcyl7Zm9yKHZhciBqJDI9MDtqJDI8Zm91bmRCb29rbWFya3MubGVuZ3RoOysraiQyKXtidWlsZENvbGxhcHNlZFNwYW4oYnVpbGRlciwwLGZvdW5kQm9va21hcmtzW2okMl0pO319aWYoY29sbGFwc2VkJiYoY29sbGFwc2VkLmZyb218fDApPT1wb3Mpe2J1aWxkQ29sbGFwc2VkU3BhbihidWlsZGVyLChjb2xsYXBzZWQudG89PW51bGw/bGVuKzE6Y29sbGFwc2VkLnRvKS1wb3MsY29sbGFwc2VkLm1hcmtlcixjb2xsYXBzZWQuZnJvbT09bnVsbCk7aWYoY29sbGFwc2VkLnRvPT1udWxsKXtyZXR1cm47fWlmKGNvbGxhcHNlZC50bz09cG9zKXtjb2xsYXBzZWQ9ZmFsc2U7fX19aWYocG9zPj1sZW4pe2JyZWFrO312YXIgdXB0bz1NYXRoLm1pbihsZW4sbmV4dENoYW5nZSk7d2hpbGUodHJ1ZSl7aWYodGV4dCl7dmFyIGVuZD1wb3MrdGV4dC5sZW5ndGg7aWYoIWNvbGxhcHNlZCl7dmFyIHRva2VuVGV4dD1lbmQ+dXB0bz90ZXh0LnNsaWNlKDAsdXB0by1wb3MpOnRleHQ7YnVpbGRlci5hZGRUb2tlbihidWlsZGVyLHRva2VuVGV4dCxzdHlsZT9zdHlsZStzcGFuU3R5bGU6c3BhblN0eWxlLHNwYW5TdGFydFN0eWxlLHBvcyt0b2tlblRleHQubGVuZ3RoPT1uZXh0Q2hhbmdlP3NwYW5FbmRTdHlsZTpcIlwiLHRpdGxlLGNzcyk7fWlmKGVuZD49dXB0byl7dGV4dD10ZXh0LnNsaWNlKHVwdG8tcG9zKTtwb3M9dXB0bzticmVhazt9cG9zPWVuZDtzcGFuU3RhcnRTdHlsZT1cIlwiO310ZXh0PWFsbFRleHQuc2xpY2UoYXQsYXQ9c3R5bGVzW2krK10pO3N0eWxlPWludGVycHJldFRva2VuU3R5bGUoc3R5bGVzW2krK10sYnVpbGRlci5jbS5vcHRpb25zKTt9fX0vLyBUaGVzZSBvYmplY3RzIGFyZSB1c2VkIHRvIHJlcHJlc2VudCB0aGUgdmlzaWJsZSAoY3VycmVudGx5IGRyYXduKVxuLy8gcGFydCBvZiB0aGUgZG9jdW1lbnQuIEEgTGluZVZpZXcgbWF5IGNvcnJlc3BvbmQgdG8gbXVsdGlwbGVcbi8vIGxvZ2ljYWwgbGluZXMsIGlmIHRob3NlIGFyZSBjb25uZWN0ZWQgYnkgY29sbGFwc2VkIHJhbmdlcy5cbmZ1bmN0aW9uIExpbmVWaWV3KGRvYyxsaW5lLGxpbmVOKXsvLyBUaGUgc3RhcnRpbmcgbGluZVxudGhpcy5saW5lPWxpbmU7Ly8gQ29udGludWluZyBsaW5lcywgaWYgYW55XG50aGlzLnJlc3Q9dmlzdWFsTGluZUNvbnRpbnVlZChsaW5lKTsvLyBOdW1iZXIgb2YgbG9naWNhbCBsaW5lcyBpbiB0aGlzIHZpc3VhbCBsaW5lXG50aGlzLnNpemU9dGhpcy5yZXN0P2xpbmVObyhsc3QodGhpcy5yZXN0KSktbGluZU4rMToxO3RoaXMubm9kZT10aGlzLnRleHQ9bnVsbDt0aGlzLmhpZGRlbj1saW5lSXNIaWRkZW4oZG9jLGxpbmUpO30vLyBDcmVhdGUgYSByYW5nZSBvZiBMaW5lVmlldyBvYmplY3RzIGZvciB0aGUgZ2l2ZW4gbGluZXMuXG5mdW5jdGlvbiBidWlsZFZpZXdBcnJheShjbSxmcm9tLHRvKXt2YXIgYXJyYXk9W10sbmV4dFBvcztmb3IodmFyIHBvcz1mcm9tO3Bvczx0bztwb3M9bmV4dFBvcyl7dmFyIHZpZXc9bmV3IExpbmVWaWV3KGNtLmRvYyxnZXRMaW5lKGNtLmRvYyxwb3MpLHBvcyk7bmV4dFBvcz1wb3Mrdmlldy5zaXplO2FycmF5LnB1c2godmlldyk7fXJldHVybiBhcnJheTt9dmFyIG9wZXJhdGlvbkdyb3VwPW51bGw7ZnVuY3Rpb24gcHVzaE9wZXJhdGlvbihvcCl7aWYob3BlcmF0aW9uR3JvdXApe29wZXJhdGlvbkdyb3VwLm9wcy5wdXNoKG9wKTt9ZWxzZXtvcC5vd25zR3JvdXA9b3BlcmF0aW9uR3JvdXA9e29wczpbb3BdLGRlbGF5ZWRDYWxsYmFja3M6W119O319ZnVuY3Rpb24gZmlyZUNhbGxiYWNrc0Zvck9wcyhncm91cCl7Ly8gQ2FsbHMgZGVsYXllZCBjYWxsYmFja3MgYW5kIGN1cnNvckFjdGl2aXR5IGhhbmRsZXJzIHVudGlsIG5vXG4vLyBuZXcgb25lcyBhcHBlYXJcbnZhciBjYWxsYmFja3M9Z3JvdXAuZGVsYXllZENhbGxiYWNrcyxpPTA7ZG97Zm9yKDtpPGNhbGxiYWNrcy5sZW5ndGg7aSsrKXtjYWxsYmFja3NbaV0uY2FsbChudWxsKTt9Zm9yKHZhciBqPTA7ajxncm91cC5vcHMubGVuZ3RoO2orKyl7dmFyIG9wPWdyb3VwLm9wc1tqXTtpZihvcC5jdXJzb3JBY3Rpdml0eUhhbmRsZXJzKXt3aGlsZShvcC5jdXJzb3JBY3Rpdml0eUNhbGxlZDxvcC5jdXJzb3JBY3Rpdml0eUhhbmRsZXJzLmxlbmd0aCl7b3AuY3Vyc29yQWN0aXZpdHlIYW5kbGVyc1tvcC5jdXJzb3JBY3Rpdml0eUNhbGxlZCsrXS5jYWxsKG51bGwsb3AuY20pO319fX13aGlsZShpPGNhbGxiYWNrcy5sZW5ndGgpO31mdW5jdGlvbiBmaW5pc2hPcGVyYXRpb24ob3AsZW5kQ2Ipe3ZhciBncm91cD1vcC5vd25zR3JvdXA7aWYoIWdyb3VwKXtyZXR1cm47fXRyeXtmaXJlQ2FsbGJhY2tzRm9yT3BzKGdyb3VwKTt9ZmluYWxseXtvcGVyYXRpb25Hcm91cD1udWxsO2VuZENiKGdyb3VwKTt9fXZhciBvcnBoYW5EZWxheWVkQ2FsbGJhY2tzPW51bGw7Ly8gT2Z0ZW4sIHdlIHdhbnQgdG8gc2lnbmFsIGV2ZW50cyBhdCBhIHBvaW50IHdoZXJlIHdlIGFyZSBpbiB0aGVcbi8vIG1pZGRsZSBvZiBzb21lIHdvcmssIGJ1dCBkb24ndCB3YW50IHRoZSBoYW5kbGVyIHRvIHN0YXJ0IGNhbGxpbmdcbi8vIG90aGVyIG1ldGhvZHMgb24gdGhlIGVkaXRvciwgd2hpY2ggbWlnaHQgYmUgaW4gYW4gaW5jb25zaXN0ZW50XG4vLyBzdGF0ZSBvciBzaW1wbHkgbm90IGV4cGVjdCBhbnkgb3RoZXIgZXZlbnRzIHRvIGhhcHBlbi5cbi8vIHNpZ25hbExhdGVyIGxvb2tzIHdoZXRoZXIgdGhlcmUgYXJlIGFueSBoYW5kbGVycywgYW5kIHNjaGVkdWxlc1xuLy8gdGhlbSB0byBiZSBleGVjdXRlZCB3aGVuIHRoZSBsYXN0IG9wZXJhdGlvbiBlbmRzLCBvciwgaWYgbm9cbi8vIG9wZXJhdGlvbiBpcyBhY3RpdmUsIHdoZW4gYSB0aW1lb3V0IGZpcmVzLlxuZnVuY3Rpb24gc2lnbmFsTGF0ZXIoZW1pdHRlcix0eXBlLyosIHZhbHVlcy4uLiovKXt2YXIgYXJyPWdldEhhbmRsZXJzKGVtaXR0ZXIsdHlwZSxmYWxzZSk7aWYoIWFyci5sZW5ndGgpe3JldHVybjt9dmFyIGFyZ3M9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLGxpc3Q7aWYob3BlcmF0aW9uR3JvdXApe2xpc3Q9b3BlcmF0aW9uR3JvdXAuZGVsYXllZENhbGxiYWNrczt9ZWxzZSBpZihvcnBoYW5EZWxheWVkQ2FsbGJhY2tzKXtsaXN0PW9ycGhhbkRlbGF5ZWRDYWxsYmFja3M7fWVsc2V7bGlzdD1vcnBoYW5EZWxheWVkQ2FsbGJhY2tzPVtdO3NldFRpbWVvdXQoZmlyZU9ycGhhbkRlbGF5ZWQsMCk7fXZhciBsb29wPWZ1bmN0aW9uKGkpe2xpc3QucHVzaChmdW5jdGlvbigpe3JldHVybiBhcnJbaV0uYXBwbHkobnVsbCxhcmdzKTt9KTt9O2Zvcih2YXIgaT0wO2k8YXJyLmxlbmd0aDsrK2kpbG9vcChpKTt9ZnVuY3Rpb24gZmlyZU9ycGhhbkRlbGF5ZWQoKXt2YXIgZGVsYXllZD1vcnBoYW5EZWxheWVkQ2FsbGJhY2tzO29ycGhhbkRlbGF5ZWRDYWxsYmFja3M9bnVsbDtmb3IodmFyIGk9MDtpPGRlbGF5ZWQubGVuZ3RoOysraSl7ZGVsYXllZFtpXSgpO319Ly8gV2hlbiBhbiBhc3BlY3Qgb2YgYSBsaW5lIGNoYW5nZXMsIGEgc3RyaW5nIGlzIGFkZGVkIHRvXG4vLyBsaW5lVmlldy5jaGFuZ2VzLiBUaGlzIHVwZGF0ZXMgdGhlIHJlbGV2YW50IHBhcnQgb2YgdGhlIGxpbmUnc1xuLy8gRE9NIHN0cnVjdHVyZS5cbmZ1bmN0aW9uIHVwZGF0ZUxpbmVGb3JDaGFuZ2VzKGNtLGxpbmVWaWV3LGxpbmVOLGRpbXMpe2Zvcih2YXIgaj0wO2o8bGluZVZpZXcuY2hhbmdlcy5sZW5ndGg7aisrKXt2YXIgdHlwZT1saW5lVmlldy5jaGFuZ2VzW2pdO2lmKHR5cGU9PVwidGV4dFwiKXt1cGRhdGVMaW5lVGV4dChjbSxsaW5lVmlldyk7fWVsc2UgaWYodHlwZT09XCJndXR0ZXJcIil7dXBkYXRlTGluZUd1dHRlcihjbSxsaW5lVmlldyxsaW5lTixkaW1zKTt9ZWxzZSBpZih0eXBlPT1cImNsYXNzXCIpe3VwZGF0ZUxpbmVDbGFzc2VzKGxpbmVWaWV3KTt9ZWxzZSBpZih0eXBlPT1cIndpZGdldFwiKXt1cGRhdGVMaW5lV2lkZ2V0cyhjbSxsaW5lVmlldyxkaW1zKTt9fWxpbmVWaWV3LmNoYW5nZXM9bnVsbDt9Ly8gTGluZXMgd2l0aCBndXR0ZXIgZWxlbWVudHMsIHdpZGdldHMgb3IgYSBiYWNrZ3JvdW5kIGNsYXNzIG5lZWQgdG9cbi8vIGJlIHdyYXBwZWQsIGFuZCBoYXZlIHRoZSBleHRyYSBlbGVtZW50cyBhZGRlZCB0byB0aGUgd3JhcHBlciBkaXZcbmZ1bmN0aW9uIGVuc3VyZUxpbmVXcmFwcGVkKGxpbmVWaWV3KXtpZihsaW5lVmlldy5ub2RlPT1saW5lVmlldy50ZXh0KXtsaW5lVmlldy5ub2RlPWVsdChcImRpdlwiLG51bGwsbnVsbCxcInBvc2l0aW9uOiByZWxhdGl2ZVwiKTtpZihsaW5lVmlldy50ZXh0LnBhcmVudE5vZGUpe2xpbmVWaWV3LnRleHQucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQobGluZVZpZXcubm9kZSxsaW5lVmlldy50ZXh0KTt9bGluZVZpZXcubm9kZS5hcHBlbmRDaGlsZChsaW5lVmlldy50ZXh0KTtpZihpZSYmaWVfdmVyc2lvbjw4KXtsaW5lVmlldy5ub2RlLnN0eWxlLnpJbmRleD0yO319cmV0dXJuIGxpbmVWaWV3Lm5vZGU7fWZ1bmN0aW9uIHVwZGF0ZUxpbmVCYWNrZ3JvdW5kKGxpbmVWaWV3KXt2YXIgY2xzPWxpbmVWaWV3LmJnQ2xhc3M/bGluZVZpZXcuYmdDbGFzcytcIiBcIisobGluZVZpZXcubGluZS5iZ0NsYXNzfHxcIlwiKTpsaW5lVmlldy5saW5lLmJnQ2xhc3M7aWYoY2xzKXtjbHMrPVwiIENvZGVNaXJyb3ItbGluZWJhY2tncm91bmRcIjt9aWYobGluZVZpZXcuYmFja2dyb3VuZCl7aWYoY2xzKXtsaW5lVmlldy5iYWNrZ3JvdW5kLmNsYXNzTmFtZT1jbHM7fWVsc2V7bGluZVZpZXcuYmFja2dyb3VuZC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGxpbmVWaWV3LmJhY2tncm91bmQpO2xpbmVWaWV3LmJhY2tncm91bmQ9bnVsbDt9fWVsc2UgaWYoY2xzKXt2YXIgd3JhcD1lbnN1cmVMaW5lV3JhcHBlZChsaW5lVmlldyk7bGluZVZpZXcuYmFja2dyb3VuZD13cmFwLmluc2VydEJlZm9yZShlbHQoXCJkaXZcIixudWxsLGNscyksd3JhcC5maXJzdENoaWxkKTt9fS8vIFdyYXBwZXIgYXJvdW5kIGJ1aWxkTGluZUNvbnRlbnQgd2hpY2ggd2lsbCByZXVzZSB0aGUgc3RydWN0dXJlXG4vLyBpbiBkaXNwbGF5LmV4dGVybmFsTWVhc3VyZWQgd2hlbiBwb3NzaWJsZS5cbmZ1bmN0aW9uIGdldExpbmVDb250ZW50KGNtLGxpbmVWaWV3KXt2YXIgZXh0PWNtLmRpc3BsYXkuZXh0ZXJuYWxNZWFzdXJlZDtpZihleHQmJmV4dC5saW5lPT1saW5lVmlldy5saW5lKXtjbS5kaXNwbGF5LmV4dGVybmFsTWVhc3VyZWQ9bnVsbDtsaW5lVmlldy5tZWFzdXJlPWV4dC5tZWFzdXJlO3JldHVybiBleHQuYnVpbHQ7fXJldHVybiBidWlsZExpbmVDb250ZW50KGNtLGxpbmVWaWV3KTt9Ly8gUmVkcmF3IHRoZSBsaW5lJ3MgdGV4dC4gSW50ZXJhY3RzIHdpdGggdGhlIGJhY2tncm91bmQgYW5kIHRleHRcbi8vIGNsYXNzZXMgYmVjYXVzZSB0aGUgbW9kZSBtYXkgb3V0cHV0IHRva2VucyB0aGF0IGluZmx1ZW5jZSB0aGVzZVxuLy8gY2xhc3Nlcy5cbmZ1bmN0aW9uIHVwZGF0ZUxpbmVUZXh0KGNtLGxpbmVWaWV3KXt2YXIgY2xzPWxpbmVWaWV3LnRleHQuY2xhc3NOYW1lO3ZhciBidWlsdD1nZXRMaW5lQ29udGVudChjbSxsaW5lVmlldyk7aWYobGluZVZpZXcudGV4dD09bGluZVZpZXcubm9kZSl7bGluZVZpZXcubm9kZT1idWlsdC5wcmU7fWxpbmVWaWV3LnRleHQucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQoYnVpbHQucHJlLGxpbmVWaWV3LnRleHQpO2xpbmVWaWV3LnRleHQ9YnVpbHQucHJlO2lmKGJ1aWx0LmJnQ2xhc3MhPWxpbmVWaWV3LmJnQ2xhc3N8fGJ1aWx0LnRleHRDbGFzcyE9bGluZVZpZXcudGV4dENsYXNzKXtsaW5lVmlldy5iZ0NsYXNzPWJ1aWx0LmJnQ2xhc3M7bGluZVZpZXcudGV4dENsYXNzPWJ1aWx0LnRleHRDbGFzczt1cGRhdGVMaW5lQ2xhc3NlcyhsaW5lVmlldyk7fWVsc2UgaWYoY2xzKXtsaW5lVmlldy50ZXh0LmNsYXNzTmFtZT1jbHM7fX1mdW5jdGlvbiB1cGRhdGVMaW5lQ2xhc3NlcyhsaW5lVmlldyl7dXBkYXRlTGluZUJhY2tncm91bmQobGluZVZpZXcpO2lmKGxpbmVWaWV3LmxpbmUud3JhcENsYXNzKXtlbnN1cmVMaW5lV3JhcHBlZChsaW5lVmlldykuY2xhc3NOYW1lPWxpbmVWaWV3LmxpbmUud3JhcENsYXNzO31lbHNlIGlmKGxpbmVWaWV3Lm5vZGUhPWxpbmVWaWV3LnRleHQpe2xpbmVWaWV3Lm5vZGUuY2xhc3NOYW1lPVwiXCI7fXZhciB0ZXh0Q2xhc3M9bGluZVZpZXcudGV4dENsYXNzP2xpbmVWaWV3LnRleHRDbGFzcytcIiBcIisobGluZVZpZXcubGluZS50ZXh0Q2xhc3N8fFwiXCIpOmxpbmVWaWV3LmxpbmUudGV4dENsYXNzO2xpbmVWaWV3LnRleHQuY2xhc3NOYW1lPXRleHRDbGFzc3x8XCJcIjt9ZnVuY3Rpb24gdXBkYXRlTGluZUd1dHRlcihjbSxsaW5lVmlldyxsaW5lTixkaW1zKXtpZihsaW5lVmlldy5ndXR0ZXIpe2xpbmVWaWV3Lm5vZGUucmVtb3ZlQ2hpbGQobGluZVZpZXcuZ3V0dGVyKTtsaW5lVmlldy5ndXR0ZXI9bnVsbDt9aWYobGluZVZpZXcuZ3V0dGVyQmFja2dyb3VuZCl7bGluZVZpZXcubm9kZS5yZW1vdmVDaGlsZChsaW5lVmlldy5ndXR0ZXJCYWNrZ3JvdW5kKTtsaW5lVmlldy5ndXR0ZXJCYWNrZ3JvdW5kPW51bGw7fWlmKGxpbmVWaWV3LmxpbmUuZ3V0dGVyQ2xhc3Mpe3ZhciB3cmFwPWVuc3VyZUxpbmVXcmFwcGVkKGxpbmVWaWV3KTtsaW5lVmlldy5ndXR0ZXJCYWNrZ3JvdW5kPWVsdChcImRpdlwiLG51bGwsXCJDb2RlTWlycm9yLWd1dHRlci1iYWNrZ3JvdW5kIFwiK2xpbmVWaWV3LmxpbmUuZ3V0dGVyQ2xhc3MsXCJsZWZ0OiBcIisoY20ub3B0aW9ucy5maXhlZEd1dHRlcj9kaW1zLmZpeGVkUG9zOi1kaW1zLmd1dHRlclRvdGFsV2lkdGgpK1wicHg7IHdpZHRoOiBcIitkaW1zLmd1dHRlclRvdGFsV2lkdGgrXCJweFwiKTt3cmFwLmluc2VydEJlZm9yZShsaW5lVmlldy5ndXR0ZXJCYWNrZ3JvdW5kLGxpbmVWaWV3LnRleHQpO312YXIgbWFya2Vycz1saW5lVmlldy5saW5lLmd1dHRlck1hcmtlcnM7aWYoY20ub3B0aW9ucy5saW5lTnVtYmVyc3x8bWFya2Vycyl7dmFyIHdyYXAkMT1lbnN1cmVMaW5lV3JhcHBlZChsaW5lVmlldyk7dmFyIGd1dHRlcldyYXA9bGluZVZpZXcuZ3V0dGVyPWVsdChcImRpdlwiLG51bGwsXCJDb2RlTWlycm9yLWd1dHRlci13cmFwcGVyXCIsXCJsZWZ0OiBcIisoY20ub3B0aW9ucy5maXhlZEd1dHRlcj9kaW1zLmZpeGVkUG9zOi1kaW1zLmd1dHRlclRvdGFsV2lkdGgpK1wicHhcIik7Y20uZGlzcGxheS5pbnB1dC5zZXRVbmVkaXRhYmxlKGd1dHRlcldyYXApO3dyYXAkMS5pbnNlcnRCZWZvcmUoZ3V0dGVyV3JhcCxsaW5lVmlldy50ZXh0KTtpZihsaW5lVmlldy5saW5lLmd1dHRlckNsYXNzKXtndXR0ZXJXcmFwLmNsYXNzTmFtZSs9XCIgXCIrbGluZVZpZXcubGluZS5ndXR0ZXJDbGFzczt9aWYoY20ub3B0aW9ucy5saW5lTnVtYmVycyYmKCFtYXJrZXJzfHwhbWFya2Vyc1tcIkNvZGVNaXJyb3ItbGluZW51bWJlcnNcIl0pKXtsaW5lVmlldy5saW5lTnVtYmVyPWd1dHRlcldyYXAuYXBwZW5kQ2hpbGQoZWx0KFwiZGl2XCIsbGluZU51bWJlckZvcihjbS5vcHRpb25zLGxpbmVOKSxcIkNvZGVNaXJyb3ItbGluZW51bWJlciBDb2RlTWlycm9yLWd1dHRlci1lbHRcIixcImxlZnQ6IFwiK2RpbXMuZ3V0dGVyTGVmdFtcIkNvZGVNaXJyb3ItbGluZW51bWJlcnNcIl0rXCJweDsgd2lkdGg6IFwiK2NtLmRpc3BsYXkubGluZU51bUlubmVyV2lkdGgrXCJweFwiKSk7fWlmKG1hcmtlcnMpe2Zvcih2YXIgaz0wO2s8Y20ub3B0aW9ucy5ndXR0ZXJzLmxlbmd0aDsrK2spe3ZhciBpZD1jbS5vcHRpb25zLmd1dHRlcnNba10sZm91bmQ9bWFya2Vycy5oYXNPd25Qcm9wZXJ0eShpZCkmJm1hcmtlcnNbaWRdO2lmKGZvdW5kKXtndXR0ZXJXcmFwLmFwcGVuZENoaWxkKGVsdChcImRpdlwiLFtmb3VuZF0sXCJDb2RlTWlycm9yLWd1dHRlci1lbHRcIixcImxlZnQ6IFwiK2RpbXMuZ3V0dGVyTGVmdFtpZF0rXCJweDsgd2lkdGg6IFwiK2RpbXMuZ3V0dGVyV2lkdGhbaWRdK1wicHhcIikpO319fX19ZnVuY3Rpb24gdXBkYXRlTGluZVdpZGdldHMoY20sbGluZVZpZXcsZGltcyl7aWYobGluZVZpZXcuYWxpZ25hYmxlKXtsaW5lVmlldy5hbGlnbmFibGU9bnVsbDt9Zm9yKHZhciBub2RlPWxpbmVWaWV3Lm5vZGUuZmlyc3RDaGlsZCxuZXh0PXZvaWQgMDtub2RlO25vZGU9bmV4dCl7bmV4dD1ub2RlLm5leHRTaWJsaW5nO2lmKG5vZGUuY2xhc3NOYW1lPT1cIkNvZGVNaXJyb3ItbGluZXdpZGdldFwiKXtsaW5lVmlldy5ub2RlLnJlbW92ZUNoaWxkKG5vZGUpO319aW5zZXJ0TGluZVdpZGdldHMoY20sbGluZVZpZXcsZGltcyk7fS8vIEJ1aWxkIGEgbGluZSdzIERPTSByZXByZXNlbnRhdGlvbiBmcm9tIHNjcmF0Y2hcbmZ1bmN0aW9uIGJ1aWxkTGluZUVsZW1lbnQoY20sbGluZVZpZXcsbGluZU4sZGltcyl7dmFyIGJ1aWx0PWdldExpbmVDb250ZW50KGNtLGxpbmVWaWV3KTtsaW5lVmlldy50ZXh0PWxpbmVWaWV3Lm5vZGU9YnVpbHQucHJlO2lmKGJ1aWx0LmJnQ2xhc3Mpe2xpbmVWaWV3LmJnQ2xhc3M9YnVpbHQuYmdDbGFzczt9aWYoYnVpbHQudGV4dENsYXNzKXtsaW5lVmlldy50ZXh0Q2xhc3M9YnVpbHQudGV4dENsYXNzO311cGRhdGVMaW5lQ2xhc3NlcyhsaW5lVmlldyk7dXBkYXRlTGluZUd1dHRlcihjbSxsaW5lVmlldyxsaW5lTixkaW1zKTtpbnNlcnRMaW5lV2lkZ2V0cyhjbSxsaW5lVmlldyxkaW1zKTtyZXR1cm4gbGluZVZpZXcubm9kZTt9Ly8gQSBsaW5lVmlldyBtYXkgY29udGFpbiBtdWx0aXBsZSBsb2dpY2FsIGxpbmVzICh3aGVuIG1lcmdlZCBieVxuLy8gY29sbGFwc2VkIHNwYW5zKS4gVGhlIHdpZGdldHMgZm9yIGFsbCBvZiB0aGVtIG5lZWQgdG8gYmUgZHJhd24uXG5mdW5jdGlvbiBpbnNlcnRMaW5lV2lkZ2V0cyhjbSxsaW5lVmlldyxkaW1zKXtpbnNlcnRMaW5lV2lkZ2V0c0ZvcihjbSxsaW5lVmlldy5saW5lLGxpbmVWaWV3LGRpbXMsdHJ1ZSk7aWYobGluZVZpZXcucmVzdCl7Zm9yKHZhciBpPTA7aTxsaW5lVmlldy5yZXN0Lmxlbmd0aDtpKyspe2luc2VydExpbmVXaWRnZXRzRm9yKGNtLGxpbmVWaWV3LnJlc3RbaV0sbGluZVZpZXcsZGltcyxmYWxzZSk7fX19ZnVuY3Rpb24gaW5zZXJ0TGluZVdpZGdldHNGb3IoY20sbGluZSxsaW5lVmlldyxkaW1zLGFsbG93QWJvdmUpe2lmKCFsaW5lLndpZGdldHMpe3JldHVybjt9dmFyIHdyYXA9ZW5zdXJlTGluZVdyYXBwZWQobGluZVZpZXcpO2Zvcih2YXIgaT0wLHdzPWxpbmUud2lkZ2V0cztpPHdzLmxlbmd0aDsrK2kpe3ZhciB3aWRnZXQ9d3NbaV0sbm9kZT1lbHQoXCJkaXZcIixbd2lkZ2V0Lm5vZGVdLFwiQ29kZU1pcnJvci1saW5ld2lkZ2V0XCIpO2lmKCF3aWRnZXQuaGFuZGxlTW91c2VFdmVudHMpe25vZGUuc2V0QXR0cmlidXRlKFwiY20taWdub3JlLWV2ZW50c1wiLFwidHJ1ZVwiKTt9cG9zaXRpb25MaW5lV2lkZ2V0KHdpZGdldCxub2RlLGxpbmVWaWV3LGRpbXMpO2NtLmRpc3BsYXkuaW5wdXQuc2V0VW5lZGl0YWJsZShub2RlKTtpZihhbGxvd0Fib3ZlJiZ3aWRnZXQuYWJvdmUpe3dyYXAuaW5zZXJ0QmVmb3JlKG5vZGUsbGluZVZpZXcuZ3V0dGVyfHxsaW5lVmlldy50ZXh0KTt9ZWxzZXt3cmFwLmFwcGVuZENoaWxkKG5vZGUpO31zaWduYWxMYXRlcih3aWRnZXQsXCJyZWRyYXdcIik7fX1mdW5jdGlvbiBwb3NpdGlvbkxpbmVXaWRnZXQod2lkZ2V0LG5vZGUsbGluZVZpZXcsZGltcyl7aWYod2lkZ2V0Lm5vSFNjcm9sbCl7OyhsaW5lVmlldy5hbGlnbmFibGV8fChsaW5lVmlldy5hbGlnbmFibGU9W10pKS5wdXNoKG5vZGUpO3ZhciB3aWR0aD1kaW1zLndyYXBwZXJXaWR0aDtub2RlLnN0eWxlLmxlZnQ9ZGltcy5maXhlZFBvcytcInB4XCI7aWYoIXdpZGdldC5jb3Zlckd1dHRlcil7d2lkdGgtPWRpbXMuZ3V0dGVyVG90YWxXaWR0aDtub2RlLnN0eWxlLnBhZGRpbmdMZWZ0PWRpbXMuZ3V0dGVyVG90YWxXaWR0aCtcInB4XCI7fW5vZGUuc3R5bGUud2lkdGg9d2lkdGgrXCJweFwiO31pZih3aWRnZXQuY292ZXJHdXR0ZXIpe25vZGUuc3R5bGUuekluZGV4PTU7bm9kZS5zdHlsZS5wb3NpdGlvbj1cInJlbGF0aXZlXCI7aWYoIXdpZGdldC5ub0hTY3JvbGwpe25vZGUuc3R5bGUubWFyZ2luTGVmdD0tZGltcy5ndXR0ZXJUb3RhbFdpZHRoK1wicHhcIjt9fX1mdW5jdGlvbiB3aWRnZXRIZWlnaHQod2lkZ2V0KXtpZih3aWRnZXQuaGVpZ2h0IT1udWxsKXtyZXR1cm4gd2lkZ2V0LmhlaWdodDt9dmFyIGNtPXdpZGdldC5kb2MuY207aWYoIWNtKXtyZXR1cm4gMDt9aWYoIWNvbnRhaW5zKGRvY3VtZW50LmJvZHksd2lkZ2V0Lm5vZGUpKXt2YXIgcGFyZW50U3R5bGU9XCJwb3NpdGlvbjogcmVsYXRpdmU7XCI7aWYod2lkZ2V0LmNvdmVyR3V0dGVyKXtwYXJlbnRTdHlsZSs9XCJtYXJnaW4tbGVmdDogLVwiK2NtLmRpc3BsYXkuZ3V0dGVycy5vZmZzZXRXaWR0aCtcInB4O1wiO31pZih3aWRnZXQubm9IU2Nyb2xsKXtwYXJlbnRTdHlsZSs9XCJ3aWR0aDogXCIrY20uZGlzcGxheS53cmFwcGVyLmNsaWVudFdpZHRoK1wicHg7XCI7fXJlbW92ZUNoaWxkcmVuQW5kQWRkKGNtLmRpc3BsYXkubWVhc3VyZSxlbHQoXCJkaXZcIixbd2lkZ2V0Lm5vZGVdLG51bGwscGFyZW50U3R5bGUpKTt9cmV0dXJuIHdpZGdldC5oZWlnaHQ9d2lkZ2V0Lm5vZGUucGFyZW50Tm9kZS5vZmZzZXRIZWlnaHQ7fS8vIFJldHVybiB0cnVlIHdoZW4gdGhlIGdpdmVuIG1vdXNlIGV2ZW50IGhhcHBlbmVkIGluIGEgd2lkZ2V0XG5mdW5jdGlvbiBldmVudEluV2lkZ2V0KGRpc3BsYXksZSl7Zm9yKHZhciBuPWVfdGFyZ2V0KGUpO24hPWRpc3BsYXkud3JhcHBlcjtuPW4ucGFyZW50Tm9kZSl7aWYoIW58fG4ubm9kZVR5cGU9PTEmJm4uZ2V0QXR0cmlidXRlKFwiY20taWdub3JlLWV2ZW50c1wiKT09XCJ0cnVlXCJ8fG4ucGFyZW50Tm9kZT09ZGlzcGxheS5zaXplciYmbiE9ZGlzcGxheS5tb3Zlcil7cmV0dXJuIHRydWU7fX19Ly8gUE9TSVRJT04gTUVBU1VSRU1FTlRcbmZ1bmN0aW9uIHBhZGRpbmdUb3AoZGlzcGxheSl7cmV0dXJuIGRpc3BsYXkubGluZVNwYWNlLm9mZnNldFRvcDt9ZnVuY3Rpb24gcGFkZGluZ1ZlcnQoZGlzcGxheSl7cmV0dXJuIGRpc3BsYXkubW92ZXIub2Zmc2V0SGVpZ2h0LWRpc3BsYXkubGluZVNwYWNlLm9mZnNldEhlaWdodDt9ZnVuY3Rpb24gcGFkZGluZ0goZGlzcGxheSl7aWYoZGlzcGxheS5jYWNoZWRQYWRkaW5nSCl7cmV0dXJuIGRpc3BsYXkuY2FjaGVkUGFkZGluZ0g7fXZhciBlPXJlbW92ZUNoaWxkcmVuQW5kQWRkKGRpc3BsYXkubWVhc3VyZSxlbHQoXCJwcmVcIixcInhcIikpO3ZhciBzdHlsZT13aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZT93aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlKTplLmN1cnJlbnRTdHlsZTt2YXIgZGF0YT17bGVmdDpwYXJzZUludChzdHlsZS5wYWRkaW5nTGVmdCkscmlnaHQ6cGFyc2VJbnQoc3R5bGUucGFkZGluZ1JpZ2h0KX07aWYoIWlzTmFOKGRhdGEubGVmdCkmJiFpc05hTihkYXRhLnJpZ2h0KSl7ZGlzcGxheS5jYWNoZWRQYWRkaW5nSD1kYXRhO31yZXR1cm4gZGF0YTt9ZnVuY3Rpb24gc2Nyb2xsR2FwKGNtKXtyZXR1cm4gc2Nyb2xsZXJHYXAtY20uZGlzcGxheS5uYXRpdmVCYXJXaWR0aDt9ZnVuY3Rpb24gZGlzcGxheVdpZHRoKGNtKXtyZXR1cm4gY20uZGlzcGxheS5zY3JvbGxlci5jbGllbnRXaWR0aC1zY3JvbGxHYXAoY20pLWNtLmRpc3BsYXkuYmFyV2lkdGg7fWZ1bmN0aW9uIGRpc3BsYXlIZWlnaHQoY20pe3JldHVybiBjbS5kaXNwbGF5LnNjcm9sbGVyLmNsaWVudEhlaWdodC1zY3JvbGxHYXAoY20pLWNtLmRpc3BsYXkuYmFySGVpZ2h0O30vLyBFbnN1cmUgdGhlIGxpbmVWaWV3LndyYXBwaW5nLmhlaWdodHMgYXJyYXkgaXMgcG9wdWxhdGVkLiBUaGlzIGlzXG4vLyBhbiBhcnJheSBvZiBib3R0b20gb2Zmc2V0cyBmb3IgdGhlIGxpbmVzIHRoYXQgbWFrZSB1cCBhIGRyYXduXG4vLyBsaW5lLiBXaGVuIGxpbmVXcmFwcGluZyBpcyBvbiwgdGhlcmUgbWlnaHQgYmUgbW9yZSB0aGFuIG9uZVxuLy8gaGVpZ2h0LlxuZnVuY3Rpb24gZW5zdXJlTGluZUhlaWdodHMoY20sbGluZVZpZXcscmVjdCl7dmFyIHdyYXBwaW5nPWNtLm9wdGlvbnMubGluZVdyYXBwaW5nO3ZhciBjdXJXaWR0aD13cmFwcGluZyYmZGlzcGxheVdpZHRoKGNtKTtpZighbGluZVZpZXcubWVhc3VyZS5oZWlnaHRzfHx3cmFwcGluZyYmbGluZVZpZXcubWVhc3VyZS53aWR0aCE9Y3VyV2lkdGgpe3ZhciBoZWlnaHRzPWxpbmVWaWV3Lm1lYXN1cmUuaGVpZ2h0cz1bXTtpZih3cmFwcGluZyl7bGluZVZpZXcubWVhc3VyZS53aWR0aD1jdXJXaWR0aDt2YXIgcmVjdHM9bGluZVZpZXcudGV4dC5maXJzdENoaWxkLmdldENsaWVudFJlY3RzKCk7Zm9yKHZhciBpPTA7aTxyZWN0cy5sZW5ndGgtMTtpKyspe3ZhciBjdXI9cmVjdHNbaV0sbmV4dD1yZWN0c1tpKzFdO2lmKE1hdGguYWJzKGN1ci5ib3R0b20tbmV4dC5ib3R0b20pPjIpe2hlaWdodHMucHVzaCgoY3VyLmJvdHRvbStuZXh0LnRvcCkvMi1yZWN0LnRvcCk7fX19aGVpZ2h0cy5wdXNoKHJlY3QuYm90dG9tLXJlY3QudG9wKTt9fS8vIEZpbmQgYSBsaW5lIG1hcCAobWFwcGluZyBjaGFyYWN0ZXIgb2Zmc2V0cyB0byB0ZXh0IG5vZGVzKSBhbmQgYVxuLy8gbWVhc3VyZW1lbnQgY2FjaGUgZm9yIHRoZSBnaXZlbiBsaW5lIG51bWJlci4gKEEgbGluZSB2aWV3IG1pZ2h0XG4vLyBjb250YWluIG11bHRpcGxlIGxpbmVzIHdoZW4gY29sbGFwc2VkIHJhbmdlcyBhcmUgcHJlc2VudC4pXG5mdW5jdGlvbiBtYXBGcm9tTGluZVZpZXcobGluZVZpZXcsbGluZSxsaW5lTil7aWYobGluZVZpZXcubGluZT09bGluZSl7cmV0dXJue21hcDpsaW5lVmlldy5tZWFzdXJlLm1hcCxjYWNoZTpsaW5lVmlldy5tZWFzdXJlLmNhY2hlfTt9Zm9yKHZhciBpPTA7aTxsaW5lVmlldy5yZXN0Lmxlbmd0aDtpKyspe2lmKGxpbmVWaWV3LnJlc3RbaV09PWxpbmUpe3JldHVybnttYXA6bGluZVZpZXcubWVhc3VyZS5tYXBzW2ldLGNhY2hlOmxpbmVWaWV3Lm1lYXN1cmUuY2FjaGVzW2ldfTt9fWZvcih2YXIgaSQxPTA7aSQxPGxpbmVWaWV3LnJlc3QubGVuZ3RoO2kkMSsrKXtpZihsaW5lTm8obGluZVZpZXcucmVzdFtpJDFdKT5saW5lTil7cmV0dXJue21hcDpsaW5lVmlldy5tZWFzdXJlLm1hcHNbaSQxXSxjYWNoZTpsaW5lVmlldy5tZWFzdXJlLmNhY2hlc1tpJDFdLGJlZm9yZTp0cnVlfTt9fX0vLyBSZW5kZXIgYSBsaW5lIGludG8gdGhlIGhpZGRlbiBub2RlIGRpc3BsYXkuZXh0ZXJuYWxNZWFzdXJlZC4gVXNlZFxuLy8gd2hlbiBtZWFzdXJlbWVudCBpcyBuZWVkZWQgZm9yIGEgbGluZSB0aGF0J3Mgbm90IGluIHRoZSB2aWV3cG9ydC5cbmZ1bmN0aW9uIHVwZGF0ZUV4dGVybmFsTWVhc3VyZW1lbnQoY20sbGluZSl7bGluZT12aXN1YWxMaW5lKGxpbmUpO3ZhciBsaW5lTj1saW5lTm8obGluZSk7dmFyIHZpZXc9Y20uZGlzcGxheS5leHRlcm5hbE1lYXN1cmVkPW5ldyBMaW5lVmlldyhjbS5kb2MsbGluZSxsaW5lTik7dmlldy5saW5lTj1saW5lTjt2YXIgYnVpbHQ9dmlldy5idWlsdD1idWlsZExpbmVDb250ZW50KGNtLHZpZXcpO3ZpZXcudGV4dD1idWlsdC5wcmU7cmVtb3ZlQ2hpbGRyZW5BbmRBZGQoY20uZGlzcGxheS5saW5lTWVhc3VyZSxidWlsdC5wcmUpO3JldHVybiB2aWV3O30vLyBHZXQgYSB7dG9wLCBib3R0b20sIGxlZnQsIHJpZ2h0fSBib3ggKGluIGxpbmUtbG9jYWwgY29vcmRpbmF0ZXMpXG4vLyBmb3IgYSBnaXZlbiBjaGFyYWN0ZXIuXG5mdW5jdGlvbiBtZWFzdXJlQ2hhcihjbSxsaW5lLGNoLGJpYXMpe3JldHVybiBtZWFzdXJlQ2hhclByZXBhcmVkKGNtLHByZXBhcmVNZWFzdXJlRm9yTGluZShjbSxsaW5lKSxjaCxiaWFzKTt9Ly8gRmluZCBhIGxpbmUgdmlldyB0aGF0IGNvcnJlc3BvbmRzIHRvIHRoZSBnaXZlbiBsaW5lIG51bWJlci5cbmZ1bmN0aW9uIGZpbmRWaWV3Rm9yTGluZShjbSxsaW5lTil7aWYobGluZU4+PWNtLmRpc3BsYXkudmlld0Zyb20mJmxpbmVOPGNtLmRpc3BsYXkudmlld1RvKXtyZXR1cm4gY20uZGlzcGxheS52aWV3W2ZpbmRWaWV3SW5kZXgoY20sbGluZU4pXTt9dmFyIGV4dD1jbS5kaXNwbGF5LmV4dGVybmFsTWVhc3VyZWQ7aWYoZXh0JiZsaW5lTj49ZXh0LmxpbmVOJiZsaW5lTjxleHQubGluZU4rZXh0LnNpemUpe3JldHVybiBleHQ7fX0vLyBNZWFzdXJlbWVudCBjYW4gYmUgc3BsaXQgaW4gdHdvIHN0ZXBzLCB0aGUgc2V0LXVwIHdvcmsgdGhhdFxuLy8gYXBwbGllcyB0byB0aGUgd2hvbGUgbGluZSwgYW5kIHRoZSBtZWFzdXJlbWVudCBvZiB0aGUgYWN0dWFsXG4vLyBjaGFyYWN0ZXIuIEZ1bmN0aW9ucyBsaWtlIGNvb3Jkc0NoYXIsIHRoYXQgbmVlZCB0byBkbyBhIGxvdCBvZlxuLy8gbWVhc3VyZW1lbnRzIGluIGEgcm93LCBjYW4gdGh1cyBlbnN1cmUgdGhhdCB0aGUgc2V0LXVwIHdvcmsgaXNcbi8vIG9ubHkgZG9uZSBvbmNlLlxuZnVuY3Rpb24gcHJlcGFyZU1lYXN1cmVGb3JMaW5lKGNtLGxpbmUpe3ZhciBsaW5lTj1saW5lTm8obGluZSk7dmFyIHZpZXc9ZmluZFZpZXdGb3JMaW5lKGNtLGxpbmVOKTtpZih2aWV3JiYhdmlldy50ZXh0KXt2aWV3PW51bGw7fWVsc2UgaWYodmlldyYmdmlldy5jaGFuZ2VzKXt1cGRhdGVMaW5lRm9yQ2hhbmdlcyhjbSx2aWV3LGxpbmVOLGdldERpbWVuc2lvbnMoY20pKTtjbS5jdXJPcC5mb3JjZVVwZGF0ZT10cnVlO31pZighdmlldyl7dmlldz11cGRhdGVFeHRlcm5hbE1lYXN1cmVtZW50KGNtLGxpbmUpO312YXIgaW5mbz1tYXBGcm9tTGluZVZpZXcodmlldyxsaW5lLGxpbmVOKTtyZXR1cm57bGluZTpsaW5lLHZpZXc6dmlldyxyZWN0Om51bGwsbWFwOmluZm8ubWFwLGNhY2hlOmluZm8uY2FjaGUsYmVmb3JlOmluZm8uYmVmb3JlLGhhc0hlaWdodHM6ZmFsc2V9O30vLyBHaXZlbiBhIHByZXBhcmVkIG1lYXN1cmVtZW50IG9iamVjdCwgbWVhc3VyZXMgdGhlIHBvc2l0aW9uIG9mIGFuXG4vLyBhY3R1YWwgY2hhcmFjdGVyIChvciBmZXRjaGVzIGl0IGZyb20gdGhlIGNhY2hlKS5cbmZ1bmN0aW9uIG1lYXN1cmVDaGFyUHJlcGFyZWQoY20scHJlcGFyZWQsY2gsYmlhcyx2YXJIZWlnaHQpe2lmKHByZXBhcmVkLmJlZm9yZSl7Y2g9LTE7fXZhciBrZXk9Y2grKGJpYXN8fFwiXCIpLGZvdW5kO2lmKHByZXBhcmVkLmNhY2hlLmhhc093blByb3BlcnR5KGtleSkpe2ZvdW5kPXByZXBhcmVkLmNhY2hlW2tleV07fWVsc2V7aWYoIXByZXBhcmVkLnJlY3Qpe3ByZXBhcmVkLnJlY3Q9cHJlcGFyZWQudmlldy50ZXh0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO31pZighcHJlcGFyZWQuaGFzSGVpZ2h0cyl7ZW5zdXJlTGluZUhlaWdodHMoY20scHJlcGFyZWQudmlldyxwcmVwYXJlZC5yZWN0KTtwcmVwYXJlZC5oYXNIZWlnaHRzPXRydWU7fWZvdW5kPW1lYXN1cmVDaGFySW5uZXIoY20scHJlcGFyZWQsY2gsYmlhcyk7aWYoIWZvdW5kLmJvZ3VzKXtwcmVwYXJlZC5jYWNoZVtrZXldPWZvdW5kO319cmV0dXJue2xlZnQ6Zm91bmQubGVmdCxyaWdodDpmb3VuZC5yaWdodCx0b3A6dmFySGVpZ2h0P2ZvdW5kLnJ0b3A6Zm91bmQudG9wLGJvdHRvbTp2YXJIZWlnaHQ/Zm91bmQucmJvdHRvbTpmb3VuZC5ib3R0b219O312YXIgbnVsbFJlY3Q9e2xlZnQ6MCxyaWdodDowLHRvcDowLGJvdHRvbTowfTtmdW5jdGlvbiBub2RlQW5kT2Zmc2V0SW5MaW5lTWFwKG1hcCxjaCxiaWFzKXt2YXIgbm9kZSxzdGFydCxlbmQsY29sbGFwc2UsbVN0YXJ0LG1FbmQ7Ly8gRmlyc3QsIHNlYXJjaCB0aGUgbGluZSBtYXAgZm9yIHRoZSB0ZXh0IG5vZGUgY29ycmVzcG9uZGluZyB0byxcbi8vIG9yIGNsb3Nlc3QgdG8sIHRoZSB0YXJnZXQgY2hhcmFjdGVyLlxuZm9yKHZhciBpPTA7aTxtYXAubGVuZ3RoO2krPTMpe21TdGFydD1tYXBbaV07bUVuZD1tYXBbaSsxXTtpZihjaDxtU3RhcnQpe3N0YXJ0PTA7ZW5kPTE7Y29sbGFwc2U9XCJsZWZ0XCI7fWVsc2UgaWYoY2g8bUVuZCl7c3RhcnQ9Y2gtbVN0YXJ0O2VuZD1zdGFydCsxO31lbHNlIGlmKGk9PW1hcC5sZW5ndGgtM3x8Y2g9PW1FbmQmJm1hcFtpKzNdPmNoKXtlbmQ9bUVuZC1tU3RhcnQ7c3RhcnQ9ZW5kLTE7aWYoY2g+PW1FbmQpe2NvbGxhcHNlPVwicmlnaHRcIjt9fWlmKHN0YXJ0IT1udWxsKXtub2RlPW1hcFtpKzJdO2lmKG1TdGFydD09bUVuZCYmYmlhcz09KG5vZGUuaW5zZXJ0TGVmdD9cImxlZnRcIjpcInJpZ2h0XCIpKXtjb2xsYXBzZT1iaWFzO31pZihiaWFzPT1cImxlZnRcIiYmc3RhcnQ9PTApe3doaWxlKGkmJm1hcFtpLTJdPT1tYXBbaS0zXSYmbWFwW2ktMV0uaW5zZXJ0TGVmdCl7bm9kZT1tYXBbKGktPTMpKzJdO2NvbGxhcHNlPVwibGVmdFwiO319aWYoYmlhcz09XCJyaWdodFwiJiZzdGFydD09bUVuZC1tU3RhcnQpe3doaWxlKGk8bWFwLmxlbmd0aC0zJiZtYXBbaSszXT09bWFwW2krNF0mJiFtYXBbaSs1XS5pbnNlcnRMZWZ0KXtub2RlPW1hcFsoaSs9MykrMl07Y29sbGFwc2U9XCJyaWdodFwiO319YnJlYWs7fX1yZXR1cm57bm9kZTpub2RlLHN0YXJ0OnN0YXJ0LGVuZDplbmQsY29sbGFwc2U6Y29sbGFwc2UsY292ZXJTdGFydDptU3RhcnQsY292ZXJFbmQ6bUVuZH07fWZ1bmN0aW9uIGdldFVzZWZ1bFJlY3QocmVjdHMsYmlhcyl7dmFyIHJlY3Q9bnVsbFJlY3Q7aWYoYmlhcz09XCJsZWZ0XCIpe2Zvcih2YXIgaT0wO2k8cmVjdHMubGVuZ3RoO2krKyl7aWYoKHJlY3Q9cmVjdHNbaV0pLmxlZnQhPXJlY3QucmlnaHQpe2JyZWFrO319fWVsc2V7Zm9yKHZhciBpJDE9cmVjdHMubGVuZ3RoLTE7aSQxPj0wO2kkMS0tKXtpZigocmVjdD1yZWN0c1tpJDFdKS5sZWZ0IT1yZWN0LnJpZ2h0KXticmVhazt9fX1yZXR1cm4gcmVjdDt9ZnVuY3Rpb24gbWVhc3VyZUNoYXJJbm5lcihjbSxwcmVwYXJlZCxjaCxiaWFzKXt2YXIgcGxhY2U9bm9kZUFuZE9mZnNldEluTGluZU1hcChwcmVwYXJlZC5tYXAsY2gsYmlhcyk7dmFyIG5vZGU9cGxhY2Uubm9kZSxzdGFydD1wbGFjZS5zdGFydCxlbmQ9cGxhY2UuZW5kLGNvbGxhcHNlPXBsYWNlLmNvbGxhcHNlO3ZhciByZWN0O2lmKG5vZGUubm9kZVR5cGU9PTMpey8vIElmIGl0IGlzIGEgdGV4dCBub2RlLCB1c2UgYSByYW5nZSB0byByZXRyaWV2ZSB0aGUgY29vcmRpbmF0ZXMuXG5mb3IodmFyIGkkMT0wO2kkMTw0O2kkMSsrKXsvLyBSZXRyeSBhIG1heGltdW0gb2YgNCB0aW1lcyB3aGVuIG5vbnNlbnNlIHJlY3RhbmdsZXMgYXJlIHJldHVybmVkXG53aGlsZShzdGFydCYmaXNFeHRlbmRpbmdDaGFyKHByZXBhcmVkLmxpbmUudGV4dC5jaGFyQXQocGxhY2UuY292ZXJTdGFydCtzdGFydCkpKXstLXN0YXJ0O313aGlsZShwbGFjZS5jb3ZlclN0YXJ0K2VuZDxwbGFjZS5jb3ZlckVuZCYmaXNFeHRlbmRpbmdDaGFyKHByZXBhcmVkLmxpbmUudGV4dC5jaGFyQXQocGxhY2UuY292ZXJTdGFydCtlbmQpKSl7KytlbmQ7fWlmKGllJiZpZV92ZXJzaW9uPDkmJnN0YXJ0PT0wJiZlbmQ9PXBsYWNlLmNvdmVyRW5kLXBsYWNlLmNvdmVyU3RhcnQpe3JlY3Q9bm9kZS5wYXJlbnROb2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO31lbHNle3JlY3Q9Z2V0VXNlZnVsUmVjdChyYW5nZShub2RlLHN0YXJ0LGVuZCkuZ2V0Q2xpZW50UmVjdHMoKSxiaWFzKTt9aWYocmVjdC5sZWZ0fHxyZWN0LnJpZ2h0fHxzdGFydD09MCl7YnJlYWs7fWVuZD1zdGFydDtzdGFydD1zdGFydC0xO2NvbGxhcHNlPVwicmlnaHRcIjt9aWYoaWUmJmllX3ZlcnNpb248MTEpe3JlY3Q9bWF5YmVVcGRhdGVSZWN0Rm9yWm9vbWluZyhjbS5kaXNwbGF5Lm1lYXN1cmUscmVjdCk7fX1lbHNley8vIElmIGl0IGlzIGEgd2lkZ2V0LCBzaW1wbHkgZ2V0IHRoZSBib3ggZm9yIHRoZSB3aG9sZSB3aWRnZXQuXG5pZihzdGFydD4wKXtjb2xsYXBzZT1iaWFzPVwicmlnaHRcIjt9dmFyIHJlY3RzO2lmKGNtLm9wdGlvbnMubGluZVdyYXBwaW5nJiYocmVjdHM9bm9kZS5nZXRDbGllbnRSZWN0cygpKS5sZW5ndGg+MSl7cmVjdD1yZWN0c1tiaWFzPT1cInJpZ2h0XCI/cmVjdHMubGVuZ3RoLTE6MF07fWVsc2V7cmVjdD1ub2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO319aWYoaWUmJmllX3ZlcnNpb248OSYmIXN0YXJ0JiYoIXJlY3R8fCFyZWN0LmxlZnQmJiFyZWN0LnJpZ2h0KSl7dmFyIHJTcGFuPW5vZGUucGFyZW50Tm9kZS5nZXRDbGllbnRSZWN0cygpWzBdO2lmKHJTcGFuKXtyZWN0PXtsZWZ0OnJTcGFuLmxlZnQscmlnaHQ6clNwYW4ubGVmdCtjaGFyV2lkdGgoY20uZGlzcGxheSksdG9wOnJTcGFuLnRvcCxib3R0b206clNwYW4uYm90dG9tfTt9ZWxzZXtyZWN0PW51bGxSZWN0O319dmFyIHJ0b3A9cmVjdC50b3AtcHJlcGFyZWQucmVjdC50b3AscmJvdD1yZWN0LmJvdHRvbS1wcmVwYXJlZC5yZWN0LnRvcDt2YXIgbWlkPShydG9wK3Jib3QpLzI7dmFyIGhlaWdodHM9cHJlcGFyZWQudmlldy5tZWFzdXJlLmhlaWdodHM7dmFyIGk9MDtmb3IoO2k8aGVpZ2h0cy5sZW5ndGgtMTtpKyspe2lmKG1pZDxoZWlnaHRzW2ldKXticmVhazt9fXZhciB0b3A9aT9oZWlnaHRzW2ktMV06MCxib3Q9aGVpZ2h0c1tpXTt2YXIgcmVzdWx0PXtsZWZ0Oihjb2xsYXBzZT09XCJyaWdodFwiP3JlY3QucmlnaHQ6cmVjdC5sZWZ0KS1wcmVwYXJlZC5yZWN0LmxlZnQscmlnaHQ6KGNvbGxhcHNlPT1cImxlZnRcIj9yZWN0LmxlZnQ6cmVjdC5yaWdodCktcHJlcGFyZWQucmVjdC5sZWZ0LHRvcDp0b3AsYm90dG9tOmJvdH07aWYoIXJlY3QubGVmdCYmIXJlY3QucmlnaHQpe3Jlc3VsdC5ib2d1cz10cnVlO31pZighY20ub3B0aW9ucy5zaW5nbGVDdXJzb3JIZWlnaHRQZXJMaW5lKXtyZXN1bHQucnRvcD1ydG9wO3Jlc3VsdC5yYm90dG9tPXJib3Q7fXJldHVybiByZXN1bHQ7fS8vIFdvcmsgYXJvdW5kIHByb2JsZW0gd2l0aCBib3VuZGluZyBjbGllbnQgcmVjdHMgb24gcmFuZ2VzIGJlaW5nXG4vLyByZXR1cm5lZCBpbmNvcnJlY3RseSB3aGVuIHpvb21lZCBvbiBJRTEwIGFuZCBiZWxvdy5cbmZ1bmN0aW9uIG1heWJlVXBkYXRlUmVjdEZvclpvb21pbmcobWVhc3VyZSxyZWN0KXtpZighd2luZG93LnNjcmVlbnx8c2NyZWVuLmxvZ2ljYWxYRFBJPT1udWxsfHxzY3JlZW4ubG9naWNhbFhEUEk9PXNjcmVlbi5kZXZpY2VYRFBJfHwhaGFzQmFkWm9vbWVkUmVjdHMobWVhc3VyZSkpe3JldHVybiByZWN0O312YXIgc2NhbGVYPXNjcmVlbi5sb2dpY2FsWERQSS9zY3JlZW4uZGV2aWNlWERQSTt2YXIgc2NhbGVZPXNjcmVlbi5sb2dpY2FsWURQSS9zY3JlZW4uZGV2aWNlWURQSTtyZXR1cm57bGVmdDpyZWN0LmxlZnQqc2NhbGVYLHJpZ2h0OnJlY3QucmlnaHQqc2NhbGVYLHRvcDpyZWN0LnRvcCpzY2FsZVksYm90dG9tOnJlY3QuYm90dG9tKnNjYWxlWX07fWZ1bmN0aW9uIGNsZWFyTGluZU1lYXN1cmVtZW50Q2FjaGVGb3IobGluZVZpZXcpe2lmKGxpbmVWaWV3Lm1lYXN1cmUpe2xpbmVWaWV3Lm1lYXN1cmUuY2FjaGU9e307bGluZVZpZXcubWVhc3VyZS5oZWlnaHRzPW51bGw7aWYobGluZVZpZXcucmVzdCl7Zm9yKHZhciBpPTA7aTxsaW5lVmlldy5yZXN0Lmxlbmd0aDtpKyspe2xpbmVWaWV3Lm1lYXN1cmUuY2FjaGVzW2ldPXt9O319fX1mdW5jdGlvbiBjbGVhckxpbmVNZWFzdXJlbWVudENhY2hlKGNtKXtjbS5kaXNwbGF5LmV4dGVybmFsTWVhc3VyZT1udWxsO3JlbW92ZUNoaWxkcmVuKGNtLmRpc3BsYXkubGluZU1lYXN1cmUpO2Zvcih2YXIgaT0wO2k8Y20uZGlzcGxheS52aWV3Lmxlbmd0aDtpKyspe2NsZWFyTGluZU1lYXN1cmVtZW50Q2FjaGVGb3IoY20uZGlzcGxheS52aWV3W2ldKTt9fWZ1bmN0aW9uIGNsZWFyQ2FjaGVzKGNtKXtjbGVhckxpbmVNZWFzdXJlbWVudENhY2hlKGNtKTtjbS5kaXNwbGF5LmNhY2hlZENoYXJXaWR0aD1jbS5kaXNwbGF5LmNhY2hlZFRleHRIZWlnaHQ9Y20uZGlzcGxheS5jYWNoZWRQYWRkaW5nSD1udWxsO2lmKCFjbS5vcHRpb25zLmxpbmVXcmFwcGluZyl7Y20uZGlzcGxheS5tYXhMaW5lQ2hhbmdlZD10cnVlO31jbS5kaXNwbGF5LmxpbmVOdW1DaGFycz1udWxsO31mdW5jdGlvbiBwYWdlU2Nyb2xsWCgpe3JldHVybiB3aW5kb3cucGFnZVhPZmZzZXR8fChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnR8fGRvY3VtZW50LmJvZHkpLnNjcm9sbExlZnQ7fWZ1bmN0aW9uIHBhZ2VTY3JvbGxZKCl7cmV0dXJuIHdpbmRvdy5wYWdlWU9mZnNldHx8KGRvY3VtZW50LmRvY3VtZW50RWxlbWVudHx8ZG9jdW1lbnQuYm9keSkuc2Nyb2xsVG9wO30vLyBDb252ZXJ0cyBhIHt0b3AsIGJvdHRvbSwgbGVmdCwgcmlnaHR9IGJveCBmcm9tIGxpbmUtbG9jYWxcbi8vIGNvb3JkaW5hdGVzIGludG8gYW5vdGhlciBjb29yZGluYXRlIHN5c3RlbS4gQ29udGV4dCBtYXkgYmUgb25lIG9mXG4vLyBcImxpbmVcIiwgXCJkaXZcIiAoZGlzcGxheS5saW5lRGl2KSwgXCJsb2NhbFwiLi9udWxsIChlZGl0b3IpLCBcIndpbmRvd1wiLFxuLy8gb3IgXCJwYWdlXCIuXG5mdW5jdGlvbiBpbnRvQ29vcmRTeXN0ZW0oY20sbGluZU9iaixyZWN0LGNvbnRleHQpe2lmKGxpbmVPYmoud2lkZ2V0cyl7Zm9yKHZhciBpPTA7aTxsaW5lT2JqLndpZGdldHMubGVuZ3RoOysraSl7aWYobGluZU9iai53aWRnZXRzW2ldLmFib3ZlKXt2YXIgc2l6ZT13aWRnZXRIZWlnaHQobGluZU9iai53aWRnZXRzW2ldKTtyZWN0LnRvcCs9c2l6ZTtyZWN0LmJvdHRvbSs9c2l6ZTt9fX1pZihjb250ZXh0PT1cImxpbmVcIil7cmV0dXJuIHJlY3Q7fWlmKCFjb250ZXh0KXtjb250ZXh0PVwibG9jYWxcIjt9dmFyIHlPZmY9aGVpZ2h0QXRMaW5lKGxpbmVPYmopO2lmKGNvbnRleHQ9PVwibG9jYWxcIil7eU9mZis9cGFkZGluZ1RvcChjbS5kaXNwbGF5KTt9ZWxzZXt5T2ZmLT1jbS5kaXNwbGF5LnZpZXdPZmZzZXQ7fWlmKGNvbnRleHQ9PVwicGFnZVwifHxjb250ZXh0PT1cIndpbmRvd1wiKXt2YXIgbE9mZj1jbS5kaXNwbGF5LmxpbmVTcGFjZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTt5T2ZmKz1sT2ZmLnRvcCsoY29udGV4dD09XCJ3aW5kb3dcIj8wOnBhZ2VTY3JvbGxZKCkpO3ZhciB4T2ZmPWxPZmYubGVmdCsoY29udGV4dD09XCJ3aW5kb3dcIj8wOnBhZ2VTY3JvbGxYKCkpO3JlY3QubGVmdCs9eE9mZjtyZWN0LnJpZ2h0Kz14T2ZmO31yZWN0LnRvcCs9eU9mZjtyZWN0LmJvdHRvbSs9eU9mZjtyZXR1cm4gcmVjdDt9Ly8gQ292ZXJ0cyBhIGJveCBmcm9tIFwiZGl2XCIgY29vcmRzIHRvIGFub3RoZXIgY29vcmRpbmF0ZSBzeXN0ZW0uXG4vLyBDb250ZXh0IG1heSBiZSBcIndpbmRvd1wiLCBcInBhZ2VcIiwgXCJkaXZcIiwgb3IgXCJsb2NhbFwiLi9udWxsLlxuZnVuY3Rpb24gZnJvbUNvb3JkU3lzdGVtKGNtLGNvb3Jkcyxjb250ZXh0KXtpZihjb250ZXh0PT1cImRpdlwiKXtyZXR1cm4gY29vcmRzO312YXIgbGVmdD1jb29yZHMubGVmdCx0b3A9Y29vcmRzLnRvcDsvLyBGaXJzdCBtb3ZlIGludG8gXCJwYWdlXCIgY29vcmRpbmF0ZSBzeXN0ZW1cbmlmKGNvbnRleHQ9PVwicGFnZVwiKXtsZWZ0LT1wYWdlU2Nyb2xsWCgpO3RvcC09cGFnZVNjcm9sbFkoKTt9ZWxzZSBpZihjb250ZXh0PT1cImxvY2FsXCJ8fCFjb250ZXh0KXt2YXIgbG9jYWxCb3g9Y20uZGlzcGxheS5zaXplci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtsZWZ0Kz1sb2NhbEJveC5sZWZ0O3RvcCs9bG9jYWxCb3gudG9wO312YXIgbGluZVNwYWNlQm94PWNtLmRpc3BsYXkubGluZVNwYWNlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO3JldHVybntsZWZ0OmxlZnQtbGluZVNwYWNlQm94LmxlZnQsdG9wOnRvcC1saW5lU3BhY2VCb3gudG9wfTt9ZnVuY3Rpb24gY2hhckNvb3JkcyhjbSxwb3MsY29udGV4dCxsaW5lT2JqLGJpYXMpe2lmKCFsaW5lT2JqKXtsaW5lT2JqPWdldExpbmUoY20uZG9jLHBvcy5saW5lKTt9cmV0dXJuIGludG9Db29yZFN5c3RlbShjbSxsaW5lT2JqLG1lYXN1cmVDaGFyKGNtLGxpbmVPYmoscG9zLmNoLGJpYXMpLGNvbnRleHQpO30vLyBSZXR1cm5zIGEgYm94IGZvciBhIGdpdmVuIGN1cnNvciBwb3NpdGlvbiwgd2hpY2ggbWF5IGhhdmUgYW5cbi8vICdvdGhlcicgcHJvcGVydHkgY29udGFpbmluZyB0aGUgcG9zaXRpb24gb2YgdGhlIHNlY29uZGFyeSBjdXJzb3Jcbi8vIG9uIGEgYmlkaSBib3VuZGFyeS5cbmZ1bmN0aW9uIGN1cnNvckNvb3JkcyhjbSxwb3MsY29udGV4dCxsaW5lT2JqLHByZXBhcmVkTWVhc3VyZSx2YXJIZWlnaHQpe2xpbmVPYmo9bGluZU9ianx8Z2V0TGluZShjbS5kb2MscG9zLmxpbmUpO2lmKCFwcmVwYXJlZE1lYXN1cmUpe3ByZXBhcmVkTWVhc3VyZT1wcmVwYXJlTWVhc3VyZUZvckxpbmUoY20sbGluZU9iaik7fWZ1bmN0aW9uIGdldChjaCxyaWdodCl7dmFyIG09bWVhc3VyZUNoYXJQcmVwYXJlZChjbSxwcmVwYXJlZE1lYXN1cmUsY2gscmlnaHQ/XCJyaWdodFwiOlwibGVmdFwiLHZhckhlaWdodCk7aWYocmlnaHQpe20ubGVmdD1tLnJpZ2h0O31lbHNle20ucmlnaHQ9bS5sZWZ0O31yZXR1cm4gaW50b0Nvb3JkU3lzdGVtKGNtLGxpbmVPYmosbSxjb250ZXh0KTt9ZnVuY3Rpb24gZ2V0QmlkaShjaCxwYXJ0UG9zKXt2YXIgcGFydD1vcmRlcltwYXJ0UG9zXSxyaWdodD1wYXJ0LmxldmVsJTI7aWYoY2g9PWJpZGlMZWZ0KHBhcnQpJiZwYXJ0UG9zJiZwYXJ0LmxldmVsPG9yZGVyW3BhcnRQb3MtMV0ubGV2ZWwpe3BhcnQ9b3JkZXJbLS1wYXJ0UG9zXTtjaD1iaWRpUmlnaHQocGFydCktKHBhcnQubGV2ZWwlMj8wOjEpO3JpZ2h0PXRydWU7fWVsc2UgaWYoY2g9PWJpZGlSaWdodChwYXJ0KSYmcGFydFBvczxvcmRlci5sZW5ndGgtMSYmcGFydC5sZXZlbDxvcmRlcltwYXJ0UG9zKzFdLmxldmVsKXtwYXJ0PW9yZGVyWysrcGFydFBvc107Y2g9YmlkaUxlZnQocGFydCktcGFydC5sZXZlbCUyO3JpZ2h0PWZhbHNlO31pZihyaWdodCYmY2g9PXBhcnQudG8mJmNoPnBhcnQuZnJvbSl7cmV0dXJuIGdldChjaC0xKTt9cmV0dXJuIGdldChjaCxyaWdodCk7fXZhciBvcmRlcj1nZXRPcmRlcihsaW5lT2JqKSxjaD1wb3MuY2g7aWYoIW9yZGVyKXtyZXR1cm4gZ2V0KGNoKTt9dmFyIHBhcnRQb3M9Z2V0QmlkaVBhcnRBdChvcmRlcixjaCk7dmFyIHZhbD1nZXRCaWRpKGNoLHBhcnRQb3MpO2lmKGJpZGlPdGhlciE9bnVsbCl7dmFsLm90aGVyPWdldEJpZGkoY2gsYmlkaU90aGVyKTt9cmV0dXJuIHZhbDt9Ly8gVXNlZCB0byBjaGVhcGx5IGVzdGltYXRlIHRoZSBjb29yZGluYXRlcyBmb3IgYSBwb3NpdGlvbi4gVXNlZCBmb3Jcbi8vIGludGVybWVkaWF0ZSBzY3JvbGwgdXBkYXRlcy5cbmZ1bmN0aW9uIGVzdGltYXRlQ29vcmRzKGNtLHBvcyl7dmFyIGxlZnQ9MDtwb3M9Y2xpcFBvcyhjbS5kb2MscG9zKTtpZighY20ub3B0aW9ucy5saW5lV3JhcHBpbmcpe2xlZnQ9Y2hhcldpZHRoKGNtLmRpc3BsYXkpKnBvcy5jaDt9dmFyIGxpbmVPYmo9Z2V0TGluZShjbS5kb2MscG9zLmxpbmUpO3ZhciB0b3A9aGVpZ2h0QXRMaW5lKGxpbmVPYmopK3BhZGRpbmdUb3AoY20uZGlzcGxheSk7cmV0dXJue2xlZnQ6bGVmdCxyaWdodDpsZWZ0LHRvcDp0b3AsYm90dG9tOnRvcCtsaW5lT2JqLmhlaWdodH07fS8vIFBvc2l0aW9ucyByZXR1cm5lZCBieSBjb29yZHNDaGFyIGNvbnRhaW4gc29tZSBleHRyYSBpbmZvcm1hdGlvbi5cbi8vIHhSZWwgaXMgdGhlIHJlbGF0aXZlIHggcG9zaXRpb24gb2YgdGhlIGlucHV0IGNvb3JkaW5hdGVzIGNvbXBhcmVkXG4vLyB0byB0aGUgZm91bmQgcG9zaXRpb24gKHNvIHhSZWwgPiAwIG1lYW5zIHRoZSBjb29yZGluYXRlcyBhcmUgdG9cbi8vIHRoZSByaWdodCBvZiB0aGUgY2hhcmFjdGVyIHBvc2l0aW9uLCBmb3IgZXhhbXBsZSkuIFdoZW4gb3V0c2lkZVxuLy8gaXMgdHJ1ZSwgdGhhdCBtZWFucyB0aGUgY29vcmRpbmF0ZXMgbGllIG91dHNpZGUgdGhlIGxpbmUnc1xuLy8gdmVydGljYWwgcmFuZ2UuXG5mdW5jdGlvbiBQb3NXaXRoSW5mbyhsaW5lLGNoLG91dHNpZGUseFJlbCl7dmFyIHBvcz1Qb3MobGluZSxjaCk7cG9zLnhSZWw9eFJlbDtpZihvdXRzaWRlKXtwb3Mub3V0c2lkZT10cnVlO31yZXR1cm4gcG9zO30vLyBDb21wdXRlIHRoZSBjaGFyYWN0ZXIgcG9zaXRpb24gY2xvc2VzdCB0byB0aGUgZ2l2ZW4gY29vcmRpbmF0ZXMuXG4vLyBJbnB1dCBtdXN0IGJlIGxpbmVTcGFjZS1sb2NhbCAoXCJkaXZcIiBjb29yZGluYXRlIHN5c3RlbSkuXG5mdW5jdGlvbiBjb29yZHNDaGFyKGNtLHgseSl7dmFyIGRvYz1jbS5kb2M7eSs9Y20uZGlzcGxheS52aWV3T2Zmc2V0O2lmKHk8MCl7cmV0dXJuIFBvc1dpdGhJbmZvKGRvYy5maXJzdCwwLHRydWUsLTEpO312YXIgbGluZU49bGluZUF0SGVpZ2h0KGRvYyx5KSxsYXN0PWRvYy5maXJzdCtkb2Muc2l6ZS0xO2lmKGxpbmVOPmxhc3Qpe3JldHVybiBQb3NXaXRoSW5mbyhkb2MuZmlyc3QrZG9jLnNpemUtMSxnZXRMaW5lKGRvYyxsYXN0KS50ZXh0Lmxlbmd0aCx0cnVlLDEpO31pZih4PDApe3g9MDt9dmFyIGxpbmVPYmo9Z2V0TGluZShkb2MsbGluZU4pO2Zvcig7Oyl7dmFyIGZvdW5kPWNvb3Jkc0NoYXJJbm5lcihjbSxsaW5lT2JqLGxpbmVOLHgseSk7dmFyIG1lcmdlZD1jb2xsYXBzZWRTcGFuQXRFbmQobGluZU9iaik7dmFyIG1lcmdlZFBvcz1tZXJnZWQmJm1lcmdlZC5maW5kKDAsdHJ1ZSk7aWYobWVyZ2VkJiYoZm91bmQuY2g+bWVyZ2VkUG9zLmZyb20uY2h8fGZvdW5kLmNoPT1tZXJnZWRQb3MuZnJvbS5jaCYmZm91bmQueFJlbD4wKSl7bGluZU49bGluZU5vKGxpbmVPYmo9bWVyZ2VkUG9zLnRvLmxpbmUpO31lbHNle3JldHVybiBmb3VuZDt9fX1mdW5jdGlvbiBjb29yZHNDaGFySW5uZXIoY20sbGluZU9iaixsaW5lTm8seCx5KXt2YXIgaW5uZXJPZmY9eS1oZWlnaHRBdExpbmUobGluZU9iaik7dmFyIHdyb25nTGluZT1mYWxzZSxhZGp1c3Q9MipjbS5kaXNwbGF5LndyYXBwZXIuY2xpZW50V2lkdGg7dmFyIHByZXBhcmVkTWVhc3VyZT1wcmVwYXJlTWVhc3VyZUZvckxpbmUoY20sbGluZU9iaik7ZnVuY3Rpb24gZ2V0WChjaCl7dmFyIHNwPWN1cnNvckNvb3JkcyhjbSxQb3MobGluZU5vLGNoKSxcImxpbmVcIixsaW5lT2JqLHByZXBhcmVkTWVhc3VyZSk7d3JvbmdMaW5lPXRydWU7aWYoaW5uZXJPZmY+c3AuYm90dG9tKXtyZXR1cm4gc3AubGVmdC1hZGp1c3Q7fWVsc2UgaWYoaW5uZXJPZmY8c3AudG9wKXtyZXR1cm4gc3AubGVmdCthZGp1c3Q7fWVsc2V7d3JvbmdMaW5lPWZhbHNlO31yZXR1cm4gc3AubGVmdDt9dmFyIGJpZGk9Z2V0T3JkZXIobGluZU9iaiksZGlzdD1saW5lT2JqLnRleHQubGVuZ3RoO3ZhciBmcm9tPWxpbmVMZWZ0KGxpbmVPYmopLHRvPWxpbmVSaWdodChsaW5lT2JqKTt2YXIgZnJvbVg9Z2V0WChmcm9tKSxmcm9tT3V0c2lkZT13cm9uZ0xpbmUsdG9YPWdldFgodG8pLHRvT3V0c2lkZT13cm9uZ0xpbmU7aWYoeD50b1gpe3JldHVybiBQb3NXaXRoSW5mbyhsaW5lTm8sdG8sdG9PdXRzaWRlLDEpO30vLyBEbyBhIGJpbmFyeSBzZWFyY2ggYmV0d2VlbiB0aGVzZSBib3VuZHMuXG5mb3IoOzspe2lmKGJpZGk/dG89PWZyb218fHRvPT1tb3ZlVmlzdWFsbHkobGluZU9iaixmcm9tLDEpOnRvLWZyb208PTEpe3ZhciBjaD14PGZyb21YfHx4LWZyb21YPD10b1gteD9mcm9tOnRvO3ZhciBvdXRzaWRlPWNoPT1mcm9tP2Zyb21PdXRzaWRlOnRvT3V0c2lkZTt2YXIgeERpZmY9eC0oY2g9PWZyb20/ZnJvbVg6dG9YKTsvLyBUaGlzIGlzIGEga2x1ZGdlIHRvIGhhbmRsZSB0aGUgY2FzZSB3aGVyZSB0aGUgY29vcmRpbmF0ZXNcbi8vIGFyZSBhZnRlciBhIGxpbmUtd3JhcHBlZCBsaW5lLiBXZSBzaG91bGQgcmVwbGFjZSBpdCB3aXRoIGFcbi8vIG1vcmUgZ2VuZXJhbCBoYW5kbGluZyBvZiBjdXJzb3IgcG9zaXRpb25zIGFyb3VuZCBsaW5lXG4vLyBicmVha3MuIChJc3N1ZSAjNDA3OClcbmlmKHRvT3V0c2lkZSYmIWJpZGkmJiEvXFxzLy50ZXN0KGxpbmVPYmoudGV4dC5jaGFyQXQoY2gpKSYmeERpZmY+MCYmY2g8bGluZU9iai50ZXh0Lmxlbmd0aCYmcHJlcGFyZWRNZWFzdXJlLnZpZXcubWVhc3VyZS5oZWlnaHRzLmxlbmd0aD4xKXt2YXIgY2hhclNpemU9bWVhc3VyZUNoYXJQcmVwYXJlZChjbSxwcmVwYXJlZE1lYXN1cmUsY2gsXCJyaWdodFwiKTtpZihpbm5lck9mZjw9Y2hhclNpemUuYm90dG9tJiZpbm5lck9mZj49Y2hhclNpemUudG9wJiZNYXRoLmFicyh4LWNoYXJTaXplLnJpZ2h0KTx4RGlmZil7b3V0c2lkZT1mYWxzZTtjaCsrO3hEaWZmPXgtY2hhclNpemUucmlnaHQ7fX13aGlsZShpc0V4dGVuZGluZ0NoYXIobGluZU9iai50ZXh0LmNoYXJBdChjaCkpKXsrK2NoO312YXIgcG9zPVBvc1dpdGhJbmZvKGxpbmVObyxjaCxvdXRzaWRlLHhEaWZmPC0xPy0xOnhEaWZmPjE/MTowKTtyZXR1cm4gcG9zO312YXIgc3RlcD1NYXRoLmNlaWwoZGlzdC8yKSxtaWRkbGU9ZnJvbStzdGVwO2lmKGJpZGkpe21pZGRsZT1mcm9tO2Zvcih2YXIgaT0wO2k8c3RlcDsrK2kpe21pZGRsZT1tb3ZlVmlzdWFsbHkobGluZU9iaixtaWRkbGUsMSk7fX12YXIgbWlkZGxlWD1nZXRYKG1pZGRsZSk7aWYobWlkZGxlWD54KXt0bz1taWRkbGU7dG9YPW1pZGRsZVg7aWYodG9PdXRzaWRlPXdyb25nTGluZSl7dG9YKz0xMDAwO31kaXN0PXN0ZXA7fWVsc2V7ZnJvbT1taWRkbGU7ZnJvbVg9bWlkZGxlWDtmcm9tT3V0c2lkZT13cm9uZ0xpbmU7ZGlzdC09c3RlcDt9fX12YXIgbWVhc3VyZVRleHQ7Ly8gQ29tcHV0ZSB0aGUgZGVmYXVsdCB0ZXh0IGhlaWdodC5cbmZ1bmN0aW9uIHRleHRIZWlnaHQoZGlzcGxheSl7aWYoZGlzcGxheS5jYWNoZWRUZXh0SGVpZ2h0IT1udWxsKXtyZXR1cm4gZGlzcGxheS5jYWNoZWRUZXh0SGVpZ2h0O31pZihtZWFzdXJlVGV4dD09bnVsbCl7bWVhc3VyZVRleHQ9ZWx0KFwicHJlXCIpOy8vIE1lYXN1cmUgYSBidW5jaCBvZiBsaW5lcywgZm9yIGJyb3dzZXJzIHRoYXQgY29tcHV0ZVxuLy8gZnJhY3Rpb25hbCBoZWlnaHRzLlxuZm9yKHZhciBpPTA7aTw0OTsrK2kpe21lYXN1cmVUZXh0LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKFwieFwiKSk7bWVhc3VyZVRleHQuYXBwZW5kQ2hpbGQoZWx0KFwiYnJcIikpO31tZWFzdXJlVGV4dC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShcInhcIikpO31yZW1vdmVDaGlsZHJlbkFuZEFkZChkaXNwbGF5Lm1lYXN1cmUsbWVhc3VyZVRleHQpO3ZhciBoZWlnaHQ9bWVhc3VyZVRleHQub2Zmc2V0SGVpZ2h0LzUwO2lmKGhlaWdodD4zKXtkaXNwbGF5LmNhY2hlZFRleHRIZWlnaHQ9aGVpZ2h0O31yZW1vdmVDaGlsZHJlbihkaXNwbGF5Lm1lYXN1cmUpO3JldHVybiBoZWlnaHR8fDE7fS8vIENvbXB1dGUgdGhlIGRlZmF1bHQgY2hhcmFjdGVyIHdpZHRoLlxuZnVuY3Rpb24gY2hhcldpZHRoKGRpc3BsYXkpe2lmKGRpc3BsYXkuY2FjaGVkQ2hhcldpZHRoIT1udWxsKXtyZXR1cm4gZGlzcGxheS5jYWNoZWRDaGFyV2lkdGg7fXZhciBhbmNob3I9ZWx0KFwic3BhblwiLFwieHh4eHh4eHh4eFwiKTt2YXIgcHJlPWVsdChcInByZVwiLFthbmNob3JdKTtyZW1vdmVDaGlsZHJlbkFuZEFkZChkaXNwbGF5Lm1lYXN1cmUscHJlKTt2YXIgcmVjdD1hbmNob3IuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksd2lkdGg9KHJlY3QucmlnaHQtcmVjdC5sZWZ0KS8xMDtpZih3aWR0aD4yKXtkaXNwbGF5LmNhY2hlZENoYXJXaWR0aD13aWR0aDt9cmV0dXJuIHdpZHRofHwxMDt9Ly8gRG8gYSBidWxrLXJlYWQgb2YgdGhlIERPTSBwb3NpdGlvbnMgYW5kIHNpemVzIG5lZWRlZCB0byBkcmF3IHRoZVxuLy8gdmlldywgc28gdGhhdCB3ZSBkb24ndCBpbnRlcmxlYXZlIHJlYWRpbmcgYW5kIHdyaXRpbmcgdG8gdGhlIERPTS5cbmZ1bmN0aW9uIGdldERpbWVuc2lvbnMoY20pe3ZhciBkPWNtLmRpc3BsYXksbGVmdD17fSx3aWR0aD17fTt2YXIgZ3V0dGVyTGVmdD1kLmd1dHRlcnMuY2xpZW50TGVmdDtmb3IodmFyIG49ZC5ndXR0ZXJzLmZpcnN0Q2hpbGQsaT0wO247bj1uLm5leHRTaWJsaW5nLCsraSl7bGVmdFtjbS5vcHRpb25zLmd1dHRlcnNbaV1dPW4ub2Zmc2V0TGVmdCtuLmNsaWVudExlZnQrZ3V0dGVyTGVmdDt3aWR0aFtjbS5vcHRpb25zLmd1dHRlcnNbaV1dPW4uY2xpZW50V2lkdGg7fXJldHVybntmaXhlZFBvczpjb21wZW5zYXRlRm9ySFNjcm9sbChkKSxndXR0ZXJUb3RhbFdpZHRoOmQuZ3V0dGVycy5vZmZzZXRXaWR0aCxndXR0ZXJMZWZ0OmxlZnQsZ3V0dGVyV2lkdGg6d2lkdGgsd3JhcHBlcldpZHRoOmQud3JhcHBlci5jbGllbnRXaWR0aH07fS8vIENvbXB1dGVzIGRpc3BsYXkuc2Nyb2xsZXIuc2Nyb2xsTGVmdCArIGRpc3BsYXkuZ3V0dGVycy5vZmZzZXRXaWR0aCxcbi8vIGJ1dCB1c2luZyBnZXRCb3VuZGluZ0NsaWVudFJlY3QgdG8gZ2V0IGEgc3ViLXBpeGVsLWFjY3VyYXRlXG4vLyByZXN1bHQuXG5mdW5jdGlvbiBjb21wZW5zYXRlRm9ySFNjcm9sbChkaXNwbGF5KXtyZXR1cm4gZGlzcGxheS5zY3JvbGxlci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0LWRpc3BsYXkuc2l6ZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdDt9Ly8gUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgZXN0aW1hdGVzIHRoZSBoZWlnaHQgb2YgYSBsaW5lLCB0byB1c2UgYXNcbi8vIGZpcnN0IGFwcHJveGltYXRpb24gdW50aWwgdGhlIGxpbmUgYmVjb21lcyB2aXNpYmxlIChhbmQgaXMgdGh1c1xuLy8gcHJvcGVybHkgbWVhc3VyYWJsZSkuXG5mdW5jdGlvbiBlc3RpbWF0ZUhlaWdodChjbSl7dmFyIHRoPXRleHRIZWlnaHQoY20uZGlzcGxheSksd3JhcHBpbmc9Y20ub3B0aW9ucy5saW5lV3JhcHBpbmc7dmFyIHBlckxpbmU9d3JhcHBpbmcmJk1hdGgubWF4KDUsY20uZGlzcGxheS5zY3JvbGxlci5jbGllbnRXaWR0aC9jaGFyV2lkdGgoY20uZGlzcGxheSktMyk7cmV0dXJuIGZ1bmN0aW9uKGxpbmUpe2lmKGxpbmVJc0hpZGRlbihjbS5kb2MsbGluZSkpe3JldHVybiAwO312YXIgd2lkZ2V0c0hlaWdodD0wO2lmKGxpbmUud2lkZ2V0cyl7Zm9yKHZhciBpPTA7aTxsaW5lLndpZGdldHMubGVuZ3RoO2krKyl7aWYobGluZS53aWRnZXRzW2ldLmhlaWdodCl7d2lkZ2V0c0hlaWdodCs9bGluZS53aWRnZXRzW2ldLmhlaWdodDt9fX1pZih3cmFwcGluZyl7cmV0dXJuIHdpZGdldHNIZWlnaHQrKE1hdGguY2VpbChsaW5lLnRleHQubGVuZ3RoL3BlckxpbmUpfHwxKSp0aDt9ZWxzZXtyZXR1cm4gd2lkZ2V0c0hlaWdodCt0aDt9fTt9ZnVuY3Rpb24gZXN0aW1hdGVMaW5lSGVpZ2h0cyhjbSl7dmFyIGRvYz1jbS5kb2MsZXN0PWVzdGltYXRlSGVpZ2h0KGNtKTtkb2MuaXRlcihmdW5jdGlvbihsaW5lKXt2YXIgZXN0SGVpZ2h0PWVzdChsaW5lKTtpZihlc3RIZWlnaHQhPWxpbmUuaGVpZ2h0KXt1cGRhdGVMaW5lSGVpZ2h0KGxpbmUsZXN0SGVpZ2h0KTt9fSk7fS8vIEdpdmVuIGEgbW91c2UgZXZlbnQsIGZpbmQgdGhlIGNvcnJlc3BvbmRpbmcgcG9zaXRpb24uIElmIGxpYmVyYWxcbi8vIGlzIGZhbHNlLCBpdCBjaGVja3Mgd2hldGhlciBhIGd1dHRlciBvciBzY3JvbGxiYXIgd2FzIGNsaWNrZWQsXG4vLyBhbmQgcmV0dXJucyBudWxsIGlmIGl0IHdhcy4gZm9yUmVjdCBpcyB1c2VkIGJ5IHJlY3Rhbmd1bGFyXG4vLyBzZWxlY3Rpb25zLCBhbmQgdHJpZXMgdG8gZXN0aW1hdGUgYSBjaGFyYWN0ZXIgcG9zaXRpb24gZXZlbiBmb3Jcbi8vIGNvb3JkaW5hdGVzIGJleW9uZCB0aGUgcmlnaHQgb2YgdGhlIHRleHQuXG5mdW5jdGlvbiBwb3NGcm9tTW91c2UoY20sZSxsaWJlcmFsLGZvclJlY3Qpe3ZhciBkaXNwbGF5PWNtLmRpc3BsYXk7aWYoIWxpYmVyYWwmJmVfdGFyZ2V0KGUpLmdldEF0dHJpYnV0ZShcImNtLW5vdC1jb250ZW50XCIpPT1cInRydWVcIil7cmV0dXJuIG51bGw7fXZhciB4LHksc3BhY2U9ZGlzcGxheS5saW5lU3BhY2UuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7Ly8gRmFpbHMgdW5wcmVkaWN0YWJseSBvbiBJRVs2N10gd2hlbiBtb3VzZSBpcyBkcmFnZ2VkIGFyb3VuZCBxdWlja2x5LlxudHJ5e3g9ZS5jbGllbnRYLXNwYWNlLmxlZnQ7eT1lLmNsaWVudFktc3BhY2UudG9wO31jYXRjaChlKXtyZXR1cm4gbnVsbDt9dmFyIGNvb3Jkcz1jb29yZHNDaGFyKGNtLHgseSksbGluZTtpZihmb3JSZWN0JiZjb29yZHMueFJlbD09MSYmKGxpbmU9Z2V0TGluZShjbS5kb2MsY29vcmRzLmxpbmUpLnRleHQpLmxlbmd0aD09Y29vcmRzLmNoKXt2YXIgY29sRGlmZj1jb3VudENvbHVtbihsaW5lLGxpbmUubGVuZ3RoLGNtLm9wdGlvbnMudGFiU2l6ZSktbGluZS5sZW5ndGg7Y29vcmRzPVBvcyhjb29yZHMubGluZSxNYXRoLm1heCgwLE1hdGgucm91bmQoKHgtcGFkZGluZ0goY20uZGlzcGxheSkubGVmdCkvY2hhcldpZHRoKGNtLmRpc3BsYXkpKS1jb2xEaWZmKSk7fXJldHVybiBjb29yZHM7fS8vIEZpbmQgdGhlIHZpZXcgZWxlbWVudCBjb3JyZXNwb25kaW5nIHRvIGEgZ2l2ZW4gbGluZS4gUmV0dXJuIG51bGxcbi8vIHdoZW4gdGhlIGxpbmUgaXNuJ3QgdmlzaWJsZS5cbmZ1bmN0aW9uIGZpbmRWaWV3SW5kZXgoY20sbil7aWYobj49Y20uZGlzcGxheS52aWV3VG8pe3JldHVybiBudWxsO31uLT1jbS5kaXNwbGF5LnZpZXdGcm9tO2lmKG48MCl7cmV0dXJuIG51bGw7fXZhciB2aWV3PWNtLmRpc3BsYXkudmlldztmb3IodmFyIGk9MDtpPHZpZXcubGVuZ3RoO2krKyl7bi09dmlld1tpXS5zaXplO2lmKG48MCl7cmV0dXJuIGk7fX19ZnVuY3Rpb24gdXBkYXRlU2VsZWN0aW9uKGNtKXtjbS5kaXNwbGF5LmlucHV0LnNob3dTZWxlY3Rpb24oY20uZGlzcGxheS5pbnB1dC5wcmVwYXJlU2VsZWN0aW9uKCkpO31mdW5jdGlvbiBwcmVwYXJlU2VsZWN0aW9uKGNtLHByaW1hcnkpe3ZhciBkb2M9Y20uZG9jLHJlc3VsdD17fTt2YXIgY3VyRnJhZ21lbnQ9cmVzdWx0LmN1cnNvcnM9ZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO3ZhciBzZWxGcmFnbWVudD1yZXN1bHQuc2VsZWN0aW9uPWRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtmb3IodmFyIGk9MDtpPGRvYy5zZWwucmFuZ2VzLmxlbmd0aDtpKyspe2lmKHByaW1hcnk9PT1mYWxzZSYmaT09ZG9jLnNlbC5wcmltSW5kZXgpe2NvbnRpbnVlO312YXIgcmFuZ2U9ZG9jLnNlbC5yYW5nZXNbaV07aWYocmFuZ2UuZnJvbSgpLmxpbmU+PWNtLmRpc3BsYXkudmlld1RvfHxyYW5nZS50bygpLmxpbmU8Y20uZGlzcGxheS52aWV3RnJvbSl7Y29udGludWU7fXZhciBjb2xsYXBzZWQ9cmFuZ2UuZW1wdHkoKTtpZihjb2xsYXBzZWR8fGNtLm9wdGlvbnMuc2hvd0N1cnNvcldoZW5TZWxlY3Rpbmcpe2RyYXdTZWxlY3Rpb25DdXJzb3IoY20scmFuZ2UuaGVhZCxjdXJGcmFnbWVudCk7fWlmKCFjb2xsYXBzZWQpe2RyYXdTZWxlY3Rpb25SYW5nZShjbSxyYW5nZSxzZWxGcmFnbWVudCk7fX1yZXR1cm4gcmVzdWx0O30vLyBEcmF3cyBhIGN1cnNvciBmb3IgdGhlIGdpdmVuIHJhbmdlXG5mdW5jdGlvbiBkcmF3U2VsZWN0aW9uQ3Vyc29yKGNtLGhlYWQsb3V0cHV0KXt2YXIgcG9zPWN1cnNvckNvb3JkcyhjbSxoZWFkLFwiZGl2XCIsbnVsbCxudWxsLCFjbS5vcHRpb25zLnNpbmdsZUN1cnNvckhlaWdodFBlckxpbmUpO3ZhciBjdXJzb3I9b3V0cHV0LmFwcGVuZENoaWxkKGVsdChcImRpdlwiLFwiXFx1MDBhMFwiLFwiQ29kZU1pcnJvci1jdXJzb3JcIikpO2N1cnNvci5zdHlsZS5sZWZ0PXBvcy5sZWZ0K1wicHhcIjtjdXJzb3Iuc3R5bGUudG9wPXBvcy50b3ArXCJweFwiO2N1cnNvci5zdHlsZS5oZWlnaHQ9TWF0aC5tYXgoMCxwb3MuYm90dG9tLXBvcy50b3ApKmNtLm9wdGlvbnMuY3Vyc29ySGVpZ2h0K1wicHhcIjtpZihwb3Mub3RoZXIpey8vIFNlY29uZGFyeSBjdXJzb3IsIHNob3duIHdoZW4gb24gYSAnanVtcCcgaW4gYmktZGlyZWN0aW9uYWwgdGV4dFxudmFyIG90aGVyQ3Vyc29yPW91dHB1dC5hcHBlbmRDaGlsZChlbHQoXCJkaXZcIixcIlxcdTAwYTBcIixcIkNvZGVNaXJyb3ItY3Vyc29yIENvZGVNaXJyb3Itc2Vjb25kYXJ5Y3Vyc29yXCIpKTtvdGhlckN1cnNvci5zdHlsZS5kaXNwbGF5PVwiXCI7b3RoZXJDdXJzb3Iuc3R5bGUubGVmdD1wb3Mub3RoZXIubGVmdCtcInB4XCI7b3RoZXJDdXJzb3Iuc3R5bGUudG9wPXBvcy5vdGhlci50b3ArXCJweFwiO290aGVyQ3Vyc29yLnN0eWxlLmhlaWdodD0ocG9zLm90aGVyLmJvdHRvbS1wb3Mub3RoZXIudG9wKSouODUrXCJweFwiO319Ly8gRHJhd3MgdGhlIGdpdmVuIHJhbmdlIGFzIGEgaGlnaGxpZ2h0ZWQgc2VsZWN0aW9uXG5mdW5jdGlvbiBkcmF3U2VsZWN0aW9uUmFuZ2UoY20scmFuZ2Usb3V0cHV0KXt2YXIgZGlzcGxheT1jbS5kaXNwbGF5LGRvYz1jbS5kb2M7dmFyIGZyYWdtZW50PWRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTt2YXIgcGFkZGluZz1wYWRkaW5nSChjbS5kaXNwbGF5KSxsZWZ0U2lkZT1wYWRkaW5nLmxlZnQ7dmFyIHJpZ2h0U2lkZT1NYXRoLm1heChkaXNwbGF5LnNpemVyV2lkdGgsZGlzcGxheVdpZHRoKGNtKS1kaXNwbGF5LnNpemVyLm9mZnNldExlZnQpLXBhZGRpbmcucmlnaHQ7ZnVuY3Rpb24gYWRkKGxlZnQsdG9wLHdpZHRoLGJvdHRvbSl7aWYodG9wPDApe3RvcD0wO310b3A9TWF0aC5yb3VuZCh0b3ApO2JvdHRvbT1NYXRoLnJvdW5kKGJvdHRvbSk7ZnJhZ21lbnQuYXBwZW5kQ2hpbGQoZWx0KFwiZGl2XCIsbnVsbCxcIkNvZGVNaXJyb3Itc2VsZWN0ZWRcIixcInBvc2l0aW9uOiBhYnNvbHV0ZTsgbGVmdDogXCIrbGVmdCtcInB4O1xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiBcIit0b3ArXCJweDsgd2lkdGg6IFwiKyh3aWR0aD09bnVsbD9yaWdodFNpZGUtbGVmdDp3aWR0aCkrXCJweDtcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogXCIrKGJvdHRvbS10b3ApK1wicHhcIikpO31mdW5jdGlvbiBkcmF3Rm9yTGluZShsaW5lLGZyb21BcmcsdG9Bcmcpe3ZhciBsaW5lT2JqPWdldExpbmUoZG9jLGxpbmUpO3ZhciBsaW5lTGVuPWxpbmVPYmoudGV4dC5sZW5ndGg7dmFyIHN0YXJ0LGVuZDtmdW5jdGlvbiBjb29yZHMoY2gsYmlhcyl7cmV0dXJuIGNoYXJDb29yZHMoY20sUG9zKGxpbmUsY2gpLFwiZGl2XCIsbGluZU9iaixiaWFzKTt9aXRlcmF0ZUJpZGlTZWN0aW9ucyhnZXRPcmRlcihsaW5lT2JqKSxmcm9tQXJnfHwwLHRvQXJnPT1udWxsP2xpbmVMZW46dG9BcmcsZnVuY3Rpb24oZnJvbSx0byxkaXIpe3ZhciBsZWZ0UG9zPWNvb3Jkcyhmcm9tLFwibGVmdFwiKSxyaWdodFBvcyxsZWZ0LHJpZ2h0O2lmKGZyb209PXRvKXtyaWdodFBvcz1sZWZ0UG9zO2xlZnQ9cmlnaHQ9bGVmdFBvcy5sZWZ0O31lbHNle3JpZ2h0UG9zPWNvb3Jkcyh0by0xLFwicmlnaHRcIik7aWYoZGlyPT1cInJ0bFwiKXt2YXIgdG1wPWxlZnRQb3M7bGVmdFBvcz1yaWdodFBvcztyaWdodFBvcz10bXA7fWxlZnQ9bGVmdFBvcy5sZWZ0O3JpZ2h0PXJpZ2h0UG9zLnJpZ2h0O31pZihmcm9tQXJnPT1udWxsJiZmcm9tPT0wKXtsZWZ0PWxlZnRTaWRlO31pZihyaWdodFBvcy50b3AtbGVmdFBvcy50b3A+Myl7Ly8gRGlmZmVyZW50IGxpbmVzLCBkcmF3IHRvcCBwYXJ0XG5hZGQobGVmdCxsZWZ0UG9zLnRvcCxudWxsLGxlZnRQb3MuYm90dG9tKTtsZWZ0PWxlZnRTaWRlO2lmKGxlZnRQb3MuYm90dG9tPHJpZ2h0UG9zLnRvcCl7YWRkKGxlZnQsbGVmdFBvcy5ib3R0b20sbnVsbCxyaWdodFBvcy50b3ApO319aWYodG9Bcmc9PW51bGwmJnRvPT1saW5lTGVuKXtyaWdodD1yaWdodFNpZGU7fWlmKCFzdGFydHx8bGVmdFBvcy50b3A8c3RhcnQudG9wfHxsZWZ0UG9zLnRvcD09c3RhcnQudG9wJiZsZWZ0UG9zLmxlZnQ8c3RhcnQubGVmdCl7c3RhcnQ9bGVmdFBvczt9aWYoIWVuZHx8cmlnaHRQb3MuYm90dG9tPmVuZC5ib3R0b218fHJpZ2h0UG9zLmJvdHRvbT09ZW5kLmJvdHRvbSYmcmlnaHRQb3MucmlnaHQ+ZW5kLnJpZ2h0KXtlbmQ9cmlnaHRQb3M7fWlmKGxlZnQ8bGVmdFNpZGUrMSl7bGVmdD1sZWZ0U2lkZTt9YWRkKGxlZnQscmlnaHRQb3MudG9wLHJpZ2h0LWxlZnQscmlnaHRQb3MuYm90dG9tKTt9KTtyZXR1cm57c3RhcnQ6c3RhcnQsZW5kOmVuZH07fXZhciBzRnJvbT1yYW5nZS5mcm9tKCksc1RvPXJhbmdlLnRvKCk7aWYoc0Zyb20ubGluZT09c1RvLmxpbmUpe2RyYXdGb3JMaW5lKHNGcm9tLmxpbmUsc0Zyb20uY2gsc1RvLmNoKTt9ZWxzZXt2YXIgZnJvbUxpbmU9Z2V0TGluZShkb2Msc0Zyb20ubGluZSksdG9MaW5lPWdldExpbmUoZG9jLHNUby5saW5lKTt2YXIgc2luZ2xlVkxpbmU9dmlzdWFsTGluZShmcm9tTGluZSk9PXZpc3VhbExpbmUodG9MaW5lKTt2YXIgbGVmdEVuZD1kcmF3Rm9yTGluZShzRnJvbS5saW5lLHNGcm9tLmNoLHNpbmdsZVZMaW5lP2Zyb21MaW5lLnRleHQubGVuZ3RoKzE6bnVsbCkuZW5kO3ZhciByaWdodFN0YXJ0PWRyYXdGb3JMaW5lKHNUby5saW5lLHNpbmdsZVZMaW5lPzA6bnVsbCxzVG8uY2gpLnN0YXJ0O2lmKHNpbmdsZVZMaW5lKXtpZihsZWZ0RW5kLnRvcDxyaWdodFN0YXJ0LnRvcC0yKXthZGQobGVmdEVuZC5yaWdodCxsZWZ0RW5kLnRvcCxudWxsLGxlZnRFbmQuYm90dG9tKTthZGQobGVmdFNpZGUscmlnaHRTdGFydC50b3AscmlnaHRTdGFydC5sZWZ0LHJpZ2h0U3RhcnQuYm90dG9tKTt9ZWxzZXthZGQobGVmdEVuZC5yaWdodCxsZWZ0RW5kLnRvcCxyaWdodFN0YXJ0LmxlZnQtbGVmdEVuZC5yaWdodCxsZWZ0RW5kLmJvdHRvbSk7fX1pZihsZWZ0RW5kLmJvdHRvbTxyaWdodFN0YXJ0LnRvcCl7YWRkKGxlZnRTaWRlLGxlZnRFbmQuYm90dG9tLG51bGwscmlnaHRTdGFydC50b3ApO319b3V0cHV0LmFwcGVuZENoaWxkKGZyYWdtZW50KTt9Ly8gQ3Vyc29yLWJsaW5raW5nXG5mdW5jdGlvbiByZXN0YXJ0QmxpbmsoY20pe2lmKCFjbS5zdGF0ZS5mb2N1c2VkKXtyZXR1cm47fXZhciBkaXNwbGF5PWNtLmRpc3BsYXk7Y2xlYXJJbnRlcnZhbChkaXNwbGF5LmJsaW5rZXIpO3ZhciBvbj10cnVlO2Rpc3BsYXkuY3Vyc29yRGl2LnN0eWxlLnZpc2liaWxpdHk9XCJcIjtpZihjbS5vcHRpb25zLmN1cnNvckJsaW5rUmF0ZT4wKXtkaXNwbGF5LmJsaW5rZXI9c2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXtyZXR1cm4gZGlzcGxheS5jdXJzb3JEaXYuc3R5bGUudmlzaWJpbGl0eT0ob249IW9uKT9cIlwiOlwiaGlkZGVuXCI7fSxjbS5vcHRpb25zLmN1cnNvckJsaW5rUmF0ZSk7fWVsc2UgaWYoY20ub3B0aW9ucy5jdXJzb3JCbGlua1JhdGU8MCl7ZGlzcGxheS5jdXJzb3JEaXYuc3R5bGUudmlzaWJpbGl0eT1cImhpZGRlblwiO319ZnVuY3Rpb24gZW5zdXJlRm9jdXMoY20pe2lmKCFjbS5zdGF0ZS5mb2N1c2VkKXtjbS5kaXNwbGF5LmlucHV0LmZvY3VzKCk7b25Gb2N1cyhjbSk7fX1mdW5jdGlvbiBkZWxheUJsdXJFdmVudChjbSl7Y20uc3RhdGUuZGVsYXlpbmdCbHVyRXZlbnQ9dHJ1ZTtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7aWYoY20uc3RhdGUuZGVsYXlpbmdCbHVyRXZlbnQpe2NtLnN0YXRlLmRlbGF5aW5nQmx1ckV2ZW50PWZhbHNlO29uQmx1cihjbSk7fX0sMTAwKTt9ZnVuY3Rpb24gb25Gb2N1cyhjbSxlKXtpZihjbS5zdGF0ZS5kZWxheWluZ0JsdXJFdmVudCl7Y20uc3RhdGUuZGVsYXlpbmdCbHVyRXZlbnQ9ZmFsc2U7fWlmKGNtLm9wdGlvbnMucmVhZE9ubHk9PVwibm9jdXJzb3JcIil7cmV0dXJuO31pZighY20uc3RhdGUuZm9jdXNlZCl7c2lnbmFsKGNtLFwiZm9jdXNcIixjbSxlKTtjbS5zdGF0ZS5mb2N1c2VkPXRydWU7YWRkQ2xhc3MoY20uZGlzcGxheS53cmFwcGVyLFwiQ29kZU1pcnJvci1mb2N1c2VkXCIpOy8vIFRoaXMgdGVzdCBwcmV2ZW50cyB0aGlzIGZyb20gZmlyaW5nIHdoZW4gYSBjb250ZXh0XG4vLyBtZW51IGlzIGNsb3NlZCAoc2luY2UgdGhlIGlucHV0IHJlc2V0IHdvdWxkIGtpbGwgdGhlXG4vLyBzZWxlY3QtYWxsIGRldGVjdGlvbiBoYWNrKVxuaWYoIWNtLmN1ck9wJiZjbS5kaXNwbGF5LnNlbEZvckNvbnRleHRNZW51IT1jbS5kb2Muc2VsKXtjbS5kaXNwbGF5LmlucHV0LnJlc2V0KCk7aWYod2Via2l0KXtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7cmV0dXJuIGNtLmRpc3BsYXkuaW5wdXQucmVzZXQodHJ1ZSk7fSwyMCk7fS8vIElzc3VlICMxNzMwXG59Y20uZGlzcGxheS5pbnB1dC5yZWNlaXZlZEZvY3VzKCk7fXJlc3RhcnRCbGluayhjbSk7fWZ1bmN0aW9uIG9uQmx1cihjbSxlKXtpZihjbS5zdGF0ZS5kZWxheWluZ0JsdXJFdmVudCl7cmV0dXJuO31pZihjbS5zdGF0ZS5mb2N1c2VkKXtzaWduYWwoY20sXCJibHVyXCIsY20sZSk7Y20uc3RhdGUuZm9jdXNlZD1mYWxzZTtybUNsYXNzKGNtLmRpc3BsYXkud3JhcHBlcixcIkNvZGVNaXJyb3ItZm9jdXNlZFwiKTt9Y2xlYXJJbnRlcnZhbChjbS5kaXNwbGF5LmJsaW5rZXIpO3NldFRpbWVvdXQoZnVuY3Rpb24oKXtpZighY20uc3RhdGUuZm9jdXNlZCl7Y20uZGlzcGxheS5zaGlmdD1mYWxzZTt9fSwxNTApO30vLyBSZS1hbGlnbiBsaW5lIG51bWJlcnMgYW5kIGd1dHRlciBtYXJrcyB0byBjb21wZW5zYXRlIGZvclxuLy8gaG9yaXpvbnRhbCBzY3JvbGxpbmcuXG5mdW5jdGlvbiBhbGlnbkhvcml6b250YWxseShjbSl7dmFyIGRpc3BsYXk9Y20uZGlzcGxheSx2aWV3PWRpc3BsYXkudmlldztpZighZGlzcGxheS5hbGlnbldpZGdldHMmJighZGlzcGxheS5ndXR0ZXJzLmZpcnN0Q2hpbGR8fCFjbS5vcHRpb25zLmZpeGVkR3V0dGVyKSl7cmV0dXJuO312YXIgY29tcD1jb21wZW5zYXRlRm9ySFNjcm9sbChkaXNwbGF5KS1kaXNwbGF5LnNjcm9sbGVyLnNjcm9sbExlZnQrY20uZG9jLnNjcm9sbExlZnQ7dmFyIGd1dHRlclc9ZGlzcGxheS5ndXR0ZXJzLm9mZnNldFdpZHRoLGxlZnQ9Y29tcCtcInB4XCI7Zm9yKHZhciBpPTA7aTx2aWV3Lmxlbmd0aDtpKyspe2lmKCF2aWV3W2ldLmhpZGRlbil7aWYoY20ub3B0aW9ucy5maXhlZEd1dHRlcil7aWYodmlld1tpXS5ndXR0ZXIpe3ZpZXdbaV0uZ3V0dGVyLnN0eWxlLmxlZnQ9bGVmdDt9aWYodmlld1tpXS5ndXR0ZXJCYWNrZ3JvdW5kKXt2aWV3W2ldLmd1dHRlckJhY2tncm91bmQuc3R5bGUubGVmdD1sZWZ0O319dmFyIGFsaWduPXZpZXdbaV0uYWxpZ25hYmxlO2lmKGFsaWduKXtmb3IodmFyIGo9MDtqPGFsaWduLmxlbmd0aDtqKyspe2FsaWduW2pdLnN0eWxlLmxlZnQ9bGVmdDt9fX19aWYoY20ub3B0aW9ucy5maXhlZEd1dHRlcil7ZGlzcGxheS5ndXR0ZXJzLnN0eWxlLmxlZnQ9Y29tcCtndXR0ZXJXK1wicHhcIjt9fS8vIFVzZWQgdG8gZW5zdXJlIHRoYXQgdGhlIGxpbmUgbnVtYmVyIGd1dHRlciBpcyBzdGlsbCB0aGUgcmlnaHRcbi8vIHNpemUgZm9yIHRoZSBjdXJyZW50IGRvY3VtZW50IHNpemUuIFJldHVybnMgdHJ1ZSB3aGVuIGFuIHVwZGF0ZVxuLy8gaXMgbmVlZGVkLlxuZnVuY3Rpb24gbWF5YmVVcGRhdGVMaW5lTnVtYmVyV2lkdGgoY20pe2lmKCFjbS5vcHRpb25zLmxpbmVOdW1iZXJzKXtyZXR1cm4gZmFsc2U7fXZhciBkb2M9Y20uZG9jLGxhc3Q9bGluZU51bWJlckZvcihjbS5vcHRpb25zLGRvYy5maXJzdCtkb2Muc2l6ZS0xKSxkaXNwbGF5PWNtLmRpc3BsYXk7aWYobGFzdC5sZW5ndGghPWRpc3BsYXkubGluZU51bUNoYXJzKXt2YXIgdGVzdD1kaXNwbGF5Lm1lYXN1cmUuYXBwZW5kQ2hpbGQoZWx0KFwiZGl2XCIsW2VsdChcImRpdlwiLGxhc3QpXSxcIkNvZGVNaXJyb3ItbGluZW51bWJlciBDb2RlTWlycm9yLWd1dHRlci1lbHRcIikpO3ZhciBpbm5lclc9dGVzdC5maXJzdENoaWxkLm9mZnNldFdpZHRoLHBhZGRpbmc9dGVzdC5vZmZzZXRXaWR0aC1pbm5lclc7ZGlzcGxheS5saW5lR3V0dGVyLnN0eWxlLndpZHRoPVwiXCI7ZGlzcGxheS5saW5lTnVtSW5uZXJXaWR0aD1NYXRoLm1heChpbm5lclcsZGlzcGxheS5saW5lR3V0dGVyLm9mZnNldFdpZHRoLXBhZGRpbmcpKzE7ZGlzcGxheS5saW5lTnVtV2lkdGg9ZGlzcGxheS5saW5lTnVtSW5uZXJXaWR0aCtwYWRkaW5nO2Rpc3BsYXkubGluZU51bUNoYXJzPWRpc3BsYXkubGluZU51bUlubmVyV2lkdGg/bGFzdC5sZW5ndGg6LTE7ZGlzcGxheS5saW5lR3V0dGVyLnN0eWxlLndpZHRoPWRpc3BsYXkubGluZU51bVdpZHRoK1wicHhcIjt1cGRhdGVHdXR0ZXJTcGFjZShjbSk7cmV0dXJuIHRydWU7fXJldHVybiBmYWxzZTt9Ly8gUmVhZCB0aGUgYWN0dWFsIGhlaWdodHMgb2YgdGhlIHJlbmRlcmVkIGxpbmVzLCBhbmQgdXBkYXRlIHRoZWlyXG4vLyBzdG9yZWQgaGVpZ2h0cyB0byBtYXRjaC5cbmZ1bmN0aW9uIHVwZGF0ZUhlaWdodHNJblZpZXdwb3J0KGNtKXt2YXIgZGlzcGxheT1jbS5kaXNwbGF5O3ZhciBwcmV2Qm90dG9tPWRpc3BsYXkubGluZURpdi5vZmZzZXRUb3A7Zm9yKHZhciBpPTA7aTxkaXNwbGF5LnZpZXcubGVuZ3RoO2krKyl7dmFyIGN1cj1kaXNwbGF5LnZpZXdbaV0saGVpZ2h0PXZvaWQgMDtpZihjdXIuaGlkZGVuKXtjb250aW51ZTt9aWYoaWUmJmllX3ZlcnNpb248OCl7dmFyIGJvdD1jdXIubm9kZS5vZmZzZXRUb3ArY3VyLm5vZGUub2Zmc2V0SGVpZ2h0O2hlaWdodD1ib3QtcHJldkJvdHRvbTtwcmV2Qm90dG9tPWJvdDt9ZWxzZXt2YXIgYm94PWN1ci5ub2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO2hlaWdodD1ib3guYm90dG9tLWJveC50b3A7fXZhciBkaWZmPWN1ci5saW5lLmhlaWdodC1oZWlnaHQ7aWYoaGVpZ2h0PDIpe2hlaWdodD10ZXh0SGVpZ2h0KGRpc3BsYXkpO31pZihkaWZmPi4wMDF8fGRpZmY8LS4wMDEpe3VwZGF0ZUxpbmVIZWlnaHQoY3VyLmxpbmUsaGVpZ2h0KTt1cGRhdGVXaWRnZXRIZWlnaHQoY3VyLmxpbmUpO2lmKGN1ci5yZXN0KXtmb3IodmFyIGo9MDtqPGN1ci5yZXN0Lmxlbmd0aDtqKyspe3VwZGF0ZVdpZGdldEhlaWdodChjdXIucmVzdFtqXSk7fX19fX0vLyBSZWFkIGFuZCBzdG9yZSB0aGUgaGVpZ2h0IG9mIGxpbmUgd2lkZ2V0cyBhc3NvY2lhdGVkIHdpdGggdGhlXG4vLyBnaXZlbiBsaW5lLlxuZnVuY3Rpb24gdXBkYXRlV2lkZ2V0SGVpZ2h0KGxpbmUpe2lmKGxpbmUud2lkZ2V0cyl7Zm9yKHZhciBpPTA7aTxsaW5lLndpZGdldHMubGVuZ3RoOysraSl7bGluZS53aWRnZXRzW2ldLmhlaWdodD1saW5lLndpZGdldHNbaV0ubm9kZS5wYXJlbnROb2RlLm9mZnNldEhlaWdodDt9fX0vLyBDb21wdXRlIHRoZSBsaW5lcyB0aGF0IGFyZSB2aXNpYmxlIGluIGEgZ2l2ZW4gdmlld3BvcnQgKGRlZmF1bHRzXG4vLyB0aGUgdGhlIGN1cnJlbnQgc2Nyb2xsIHBvc2l0aW9uKS4gdmlld3BvcnQgbWF5IGNvbnRhaW4gdG9wLFxuLy8gaGVpZ2h0LCBhbmQgZW5zdXJlIChzZWUgb3Auc2Nyb2xsVG9Qb3MpIHByb3BlcnRpZXMuXG5mdW5jdGlvbiB2aXNpYmxlTGluZXMoZGlzcGxheSxkb2Msdmlld3BvcnQpe3ZhciB0b3A9dmlld3BvcnQmJnZpZXdwb3J0LnRvcCE9bnVsbD9NYXRoLm1heCgwLHZpZXdwb3J0LnRvcCk6ZGlzcGxheS5zY3JvbGxlci5zY3JvbGxUb3A7dG9wPU1hdGguZmxvb3IodG9wLXBhZGRpbmdUb3AoZGlzcGxheSkpO3ZhciBib3R0b209dmlld3BvcnQmJnZpZXdwb3J0LmJvdHRvbSE9bnVsbD92aWV3cG9ydC5ib3R0b206dG9wK2Rpc3BsYXkud3JhcHBlci5jbGllbnRIZWlnaHQ7dmFyIGZyb209bGluZUF0SGVpZ2h0KGRvYyx0b3ApLHRvPWxpbmVBdEhlaWdodChkb2MsYm90dG9tKTsvLyBFbnN1cmUgaXMgYSB7ZnJvbToge2xpbmUsIGNofSwgdG86IHtsaW5lLCBjaH19IG9iamVjdCwgYW5kXG4vLyBmb3JjZXMgdGhvc2UgbGluZXMgaW50byB0aGUgdmlld3BvcnQgKGlmIHBvc3NpYmxlKS5cbmlmKHZpZXdwb3J0JiZ2aWV3cG9ydC5lbnN1cmUpe3ZhciBlbnN1cmVGcm9tPXZpZXdwb3J0LmVuc3VyZS5mcm9tLmxpbmUsZW5zdXJlVG89dmlld3BvcnQuZW5zdXJlLnRvLmxpbmU7aWYoZW5zdXJlRnJvbTxmcm9tKXtmcm9tPWVuc3VyZUZyb207dG89bGluZUF0SGVpZ2h0KGRvYyxoZWlnaHRBdExpbmUoZ2V0TGluZShkb2MsZW5zdXJlRnJvbSkpK2Rpc3BsYXkud3JhcHBlci5jbGllbnRIZWlnaHQpO31lbHNlIGlmKE1hdGgubWluKGVuc3VyZVRvLGRvYy5sYXN0TGluZSgpKT49dG8pe2Zyb209bGluZUF0SGVpZ2h0KGRvYyxoZWlnaHRBdExpbmUoZ2V0TGluZShkb2MsZW5zdXJlVG8pKS1kaXNwbGF5LndyYXBwZXIuY2xpZW50SGVpZ2h0KTt0bz1lbnN1cmVUbzt9fXJldHVybntmcm9tOmZyb20sdG86TWF0aC5tYXgodG8sZnJvbSsxKX07fS8vIFN5bmMgdGhlIHNjcm9sbGFibGUgYXJlYSBhbmQgc2Nyb2xsYmFycywgZW5zdXJlIHRoZSB2aWV3cG9ydFxuLy8gY292ZXJzIHRoZSB2aXNpYmxlIGFyZWEuXG5mdW5jdGlvbiBzZXRTY3JvbGxUb3AoY20sdmFsKXtpZihNYXRoLmFicyhjbS5kb2Muc2Nyb2xsVG9wLXZhbCk8Mil7cmV0dXJuO31jbS5kb2Muc2Nyb2xsVG9wPXZhbDtpZighZ2Vja28pe3VwZGF0ZURpc3BsYXlTaW1wbGUoY20se3RvcDp2YWx9KTt9aWYoY20uZGlzcGxheS5zY3JvbGxlci5zY3JvbGxUb3AhPXZhbCl7Y20uZGlzcGxheS5zY3JvbGxlci5zY3JvbGxUb3A9dmFsO31jbS5kaXNwbGF5LnNjcm9sbGJhcnMuc2V0U2Nyb2xsVG9wKHZhbCk7aWYoZ2Vja28pe3VwZGF0ZURpc3BsYXlTaW1wbGUoY20pO31zdGFydFdvcmtlcihjbSwxMDApO30vLyBTeW5jIHNjcm9sbGVyIGFuZCBzY3JvbGxiYXIsIGVuc3VyZSB0aGUgZ3V0dGVyIGVsZW1lbnRzIGFyZVxuLy8gYWxpZ25lZC5cbmZ1bmN0aW9uIHNldFNjcm9sbExlZnQoY20sdmFsLGlzU2Nyb2xsZXIpe2lmKGlzU2Nyb2xsZXI/dmFsPT1jbS5kb2Muc2Nyb2xsTGVmdDpNYXRoLmFicyhjbS5kb2Muc2Nyb2xsTGVmdC12YWwpPDIpe3JldHVybjt9dmFsPU1hdGgubWluKHZhbCxjbS5kaXNwbGF5LnNjcm9sbGVyLnNjcm9sbFdpZHRoLWNtLmRpc3BsYXkuc2Nyb2xsZXIuY2xpZW50V2lkdGgpO2NtLmRvYy5zY3JvbGxMZWZ0PXZhbDthbGlnbkhvcml6b250YWxseShjbSk7aWYoY20uZGlzcGxheS5zY3JvbGxlci5zY3JvbGxMZWZ0IT12YWwpe2NtLmRpc3BsYXkuc2Nyb2xsZXIuc2Nyb2xsTGVmdD12YWw7fWNtLmRpc3BsYXkuc2Nyb2xsYmFycy5zZXRTY3JvbGxMZWZ0KHZhbCk7fS8vIFNpbmNlIHRoZSBkZWx0YSB2YWx1ZXMgcmVwb3J0ZWQgb24gbW91c2Ugd2hlZWwgZXZlbnRzIGFyZVxuLy8gdW5zdGFuZGFyZGl6ZWQgYmV0d2VlbiBicm93c2VycyBhbmQgZXZlbiBicm93c2VyIHZlcnNpb25zLCBhbmRcbi8vIGdlbmVyYWxseSBob3JyaWJseSB1bnByZWRpY3RhYmxlLCB0aGlzIGNvZGUgc3RhcnRzIGJ5IG1lYXN1cmluZ1xuLy8gdGhlIHNjcm9sbCBlZmZlY3QgdGhhdCB0aGUgZmlyc3QgZmV3IG1vdXNlIHdoZWVsIGV2ZW50cyBoYXZlLFxuLy8gYW5kLCBmcm9tIHRoYXQsIGRldGVjdHMgdGhlIHdheSBpdCBjYW4gY29udmVydCBkZWx0YXMgdG8gcGl4ZWxcbi8vIG9mZnNldHMgYWZ0ZXJ3YXJkcy5cbi8vXG4vLyBUaGUgcmVhc29uIHdlIHdhbnQgdG8ga25vdyB0aGUgYW1vdW50IGEgd2hlZWwgZXZlbnQgd2lsbCBzY3JvbGxcbi8vIGlzIHRoYXQgaXQgZ2l2ZXMgdXMgYSBjaGFuY2UgdG8gdXBkYXRlIHRoZSBkaXNwbGF5IGJlZm9yZSB0aGVcbi8vIGFjdHVhbCBzY3JvbGxpbmcgaGFwcGVucywgcmVkdWNpbmcgZmxpY2tlcmluZy5cbnZhciB3aGVlbFNhbXBsZXM9MDt2YXIgd2hlZWxQaXhlbHNQZXJVbml0PW51bGw7Ly8gRmlsbCBpbiBhIGJyb3dzZXItZGV0ZWN0ZWQgc3RhcnRpbmcgdmFsdWUgb24gYnJvd3NlcnMgd2hlcmUgd2Vcbi8vIGtub3cgb25lLiBUaGVzZSBkb24ndCBoYXZlIHRvIGJlIGFjY3VyYXRlIC0tIHRoZSByZXN1bHQgb2YgdGhlbVxuLy8gYmVpbmcgd3Jvbmcgd291bGQganVzdCBiZSBhIHNsaWdodCBmbGlja2VyIG9uIHRoZSBmaXJzdCB3aGVlbFxuLy8gc2Nyb2xsIChpZiBpdCBpcyBsYXJnZSBlbm91Z2gpLlxuaWYoaWUpe3doZWVsUGl4ZWxzUGVyVW5pdD0tLjUzO31lbHNlIGlmKGdlY2tvKXt3aGVlbFBpeGVsc1BlclVuaXQ9MTU7fWVsc2UgaWYoY2hyb21lKXt3aGVlbFBpeGVsc1BlclVuaXQ9LS43O31lbHNlIGlmKHNhZmFyaSl7d2hlZWxQaXhlbHNQZXJVbml0PS0xLzM7fWZ1bmN0aW9uIHdoZWVsRXZlbnREZWx0YShlKXt2YXIgZHg9ZS53aGVlbERlbHRhWCxkeT1lLndoZWVsRGVsdGFZO2lmKGR4PT1udWxsJiZlLmRldGFpbCYmZS5heGlzPT1lLkhPUklaT05UQUxfQVhJUyl7ZHg9ZS5kZXRhaWw7fWlmKGR5PT1udWxsJiZlLmRldGFpbCYmZS5heGlzPT1lLlZFUlRJQ0FMX0FYSVMpe2R5PWUuZGV0YWlsO31lbHNlIGlmKGR5PT1udWxsKXtkeT1lLndoZWVsRGVsdGE7fXJldHVybnt4OmR4LHk6ZHl9O31mdW5jdGlvbiB3aGVlbEV2ZW50UGl4ZWxzKGUpe3ZhciBkZWx0YT13aGVlbEV2ZW50RGVsdGEoZSk7ZGVsdGEueCo9d2hlZWxQaXhlbHNQZXJVbml0O2RlbHRhLnkqPXdoZWVsUGl4ZWxzUGVyVW5pdDtyZXR1cm4gZGVsdGE7fWZ1bmN0aW9uIG9uU2Nyb2xsV2hlZWwoY20sZSl7dmFyIGRlbHRhPXdoZWVsRXZlbnREZWx0YShlKSxkeD1kZWx0YS54LGR5PWRlbHRhLnk7dmFyIGRpc3BsYXk9Y20uZGlzcGxheSxzY3JvbGw9ZGlzcGxheS5zY3JvbGxlcjsvLyBRdWl0IGlmIHRoZXJlJ3Mgbm90aGluZyB0byBzY3JvbGwgaGVyZVxudmFyIGNhblNjcm9sbFg9c2Nyb2xsLnNjcm9sbFdpZHRoPnNjcm9sbC5jbGllbnRXaWR0aDt2YXIgY2FuU2Nyb2xsWT1zY3JvbGwuc2Nyb2xsSGVpZ2h0PnNjcm9sbC5jbGllbnRIZWlnaHQ7aWYoIShkeCYmY2FuU2Nyb2xsWHx8ZHkmJmNhblNjcm9sbFkpKXtyZXR1cm47fS8vIFdlYmtpdCBicm93c2VycyBvbiBPUyBYIGFib3J0IG1vbWVudHVtIHNjcm9sbHMgd2hlbiB0aGUgdGFyZ2V0XG4vLyBvZiB0aGUgc2Nyb2xsIGV2ZW50IGlzIHJlbW92ZWQgZnJvbSB0aGUgc2Nyb2xsYWJsZSBlbGVtZW50LlxuLy8gVGhpcyBoYWNrIChzZWUgcmVsYXRlZCBjb2RlIGluIHBhdGNoRGlzcGxheSkgbWFrZXMgc3VyZSB0aGVcbi8vIGVsZW1lbnQgaXMga2VwdCBhcm91bmQuXG5pZihkeSYmbWFjJiZ3ZWJraXQpe291dGVyOmZvcih2YXIgY3VyPWUudGFyZ2V0LHZpZXc9ZGlzcGxheS52aWV3O2N1ciE9c2Nyb2xsO2N1cj1jdXIucGFyZW50Tm9kZSl7Zm9yKHZhciBpPTA7aTx2aWV3Lmxlbmd0aDtpKyspe2lmKHZpZXdbaV0ubm9kZT09Y3VyKXtjbS5kaXNwbGF5LmN1cnJlbnRXaGVlbFRhcmdldD1jdXI7YnJlYWsgb3V0ZXI7fX19fS8vIE9uIHNvbWUgYnJvd3NlcnMsIGhvcml6b250YWwgc2Nyb2xsaW5nIHdpbGwgY2F1c2UgcmVkcmF3cyB0b1xuLy8gaGFwcGVuIGJlZm9yZSB0aGUgZ3V0dGVyIGhhcyBiZWVuIHJlYWxpZ25lZCwgY2F1c2luZyBpdCB0b1xuLy8gd3JpZ2dsZSBhcm91bmQgaW4gYSBtb3N0IHVuc2VlbWx5IHdheS4gV2hlbiB3ZSBoYXZlIGFuXG4vLyBlc3RpbWF0ZWQgcGl4ZWxzL2RlbHRhIHZhbHVlLCB3ZSBqdXN0IGhhbmRsZSBob3Jpem9udGFsXG4vLyBzY3JvbGxpbmcgZW50aXJlbHkgaGVyZS4gSXQnbGwgYmUgc2xpZ2h0bHkgb2ZmIGZyb20gbmF0aXZlLCBidXRcbi8vIGJldHRlciB0aGFuIGdsaXRjaGluZyBvdXQuXG5pZihkeCYmIWdlY2tvJiYhcHJlc3RvJiZ3aGVlbFBpeGVsc1BlclVuaXQhPW51bGwpe2lmKGR5JiZjYW5TY3JvbGxZKXtzZXRTY3JvbGxUb3AoY20sTWF0aC5tYXgoMCxNYXRoLm1pbihzY3JvbGwuc2Nyb2xsVG9wK2R5KndoZWVsUGl4ZWxzUGVyVW5pdCxzY3JvbGwuc2Nyb2xsSGVpZ2h0LXNjcm9sbC5jbGllbnRIZWlnaHQpKSk7fXNldFNjcm9sbExlZnQoY20sTWF0aC5tYXgoMCxNYXRoLm1pbihzY3JvbGwuc2Nyb2xsTGVmdCtkeCp3aGVlbFBpeGVsc1BlclVuaXQsc2Nyb2xsLnNjcm9sbFdpZHRoLXNjcm9sbC5jbGllbnRXaWR0aCkpKTsvLyBPbmx5IHByZXZlbnQgZGVmYXVsdCBzY3JvbGxpbmcgaWYgdmVydGljYWwgc2Nyb2xsaW5nIGlzXG4vLyBhY3R1YWxseSBwb3NzaWJsZS4gT3RoZXJ3aXNlLCBpdCBjYXVzZXMgdmVydGljYWwgc2Nyb2xsXG4vLyBqaXR0ZXIgb24gT1NYIHRyYWNrcGFkcyB3aGVuIGRlbHRhWCBpcyBzbWFsbCBhbmQgZGVsdGFZXG4vLyBpcyBsYXJnZSAoaXNzdWUgIzM1NzkpXG5pZighZHl8fGR5JiZjYW5TY3JvbGxZKXtlX3ByZXZlbnREZWZhdWx0KGUpO31kaXNwbGF5LndoZWVsU3RhcnRYPW51bGw7Ly8gQWJvcnQgbWVhc3VyZW1lbnQsIGlmIGluIHByb2dyZXNzXG5yZXR1cm47fS8vICdQcm9qZWN0JyB0aGUgdmlzaWJsZSB2aWV3cG9ydCB0byBjb3ZlciB0aGUgYXJlYSB0aGF0IGlzIGJlaW5nXG4vLyBzY3JvbGxlZCBpbnRvIHZpZXcgKGlmIHdlIGtub3cgZW5vdWdoIHRvIGVzdGltYXRlIGl0KS5cbmlmKGR5JiZ3aGVlbFBpeGVsc1BlclVuaXQhPW51bGwpe3ZhciBwaXhlbHM9ZHkqd2hlZWxQaXhlbHNQZXJVbml0O3ZhciB0b3A9Y20uZG9jLnNjcm9sbFRvcCxib3Q9dG9wK2Rpc3BsYXkud3JhcHBlci5jbGllbnRIZWlnaHQ7aWYocGl4ZWxzPDApe3RvcD1NYXRoLm1heCgwLHRvcCtwaXhlbHMtNTApO31lbHNle2JvdD1NYXRoLm1pbihjbS5kb2MuaGVpZ2h0LGJvdCtwaXhlbHMrNTApO311cGRhdGVEaXNwbGF5U2ltcGxlKGNtLHt0b3A6dG9wLGJvdHRvbTpib3R9KTt9aWYod2hlZWxTYW1wbGVzPDIwKXtpZihkaXNwbGF5LndoZWVsU3RhcnRYPT1udWxsKXtkaXNwbGF5LndoZWVsU3RhcnRYPXNjcm9sbC5zY3JvbGxMZWZ0O2Rpc3BsYXkud2hlZWxTdGFydFk9c2Nyb2xsLnNjcm9sbFRvcDtkaXNwbGF5LndoZWVsRFg9ZHg7ZGlzcGxheS53aGVlbERZPWR5O3NldFRpbWVvdXQoZnVuY3Rpb24oKXtpZihkaXNwbGF5LndoZWVsU3RhcnRYPT1udWxsKXtyZXR1cm47fXZhciBtb3ZlZFg9c2Nyb2xsLnNjcm9sbExlZnQtZGlzcGxheS53aGVlbFN0YXJ0WDt2YXIgbW92ZWRZPXNjcm9sbC5zY3JvbGxUb3AtZGlzcGxheS53aGVlbFN0YXJ0WTt2YXIgc2FtcGxlPW1vdmVkWSYmZGlzcGxheS53aGVlbERZJiZtb3ZlZFkvZGlzcGxheS53aGVlbERZfHxtb3ZlZFgmJmRpc3BsYXkud2hlZWxEWCYmbW92ZWRYL2Rpc3BsYXkud2hlZWxEWDtkaXNwbGF5LndoZWVsU3RhcnRYPWRpc3BsYXkud2hlZWxTdGFydFk9bnVsbDtpZighc2FtcGxlKXtyZXR1cm47fXdoZWVsUGl4ZWxzUGVyVW5pdD0od2hlZWxQaXhlbHNQZXJVbml0KndoZWVsU2FtcGxlcytzYW1wbGUpLyh3aGVlbFNhbXBsZXMrMSk7Kyt3aGVlbFNhbXBsZXM7fSwyMDApO31lbHNle2Rpc3BsYXkud2hlZWxEWCs9ZHg7ZGlzcGxheS53aGVlbERZKz1keTt9fX0vLyBTQ1JPTExCQVJTXG4vLyBQcmVwYXJlIERPTSByZWFkcyBuZWVkZWQgdG8gdXBkYXRlIHRoZSBzY3JvbGxiYXJzLiBEb25lIGluIG9uZVxuLy8gc2hvdCB0byBtaW5pbWl6ZSB1cGRhdGUvbWVhc3VyZSByb3VuZHRyaXBzLlxuZnVuY3Rpb24gbWVhc3VyZUZvclNjcm9sbGJhcnMoY20pe3ZhciBkPWNtLmRpc3BsYXksZ3V0dGVyVz1kLmd1dHRlcnMub2Zmc2V0V2lkdGg7dmFyIGRvY0g9TWF0aC5yb3VuZChjbS5kb2MuaGVpZ2h0K3BhZGRpbmdWZXJ0KGNtLmRpc3BsYXkpKTtyZXR1cm57Y2xpZW50SGVpZ2h0OmQuc2Nyb2xsZXIuY2xpZW50SGVpZ2h0LHZpZXdIZWlnaHQ6ZC53cmFwcGVyLmNsaWVudEhlaWdodCxzY3JvbGxXaWR0aDpkLnNjcm9sbGVyLnNjcm9sbFdpZHRoLGNsaWVudFdpZHRoOmQuc2Nyb2xsZXIuY2xpZW50V2lkdGgsdmlld1dpZHRoOmQud3JhcHBlci5jbGllbnRXaWR0aCxiYXJMZWZ0OmNtLm9wdGlvbnMuZml4ZWRHdXR0ZXI/Z3V0dGVyVzowLGRvY0hlaWdodDpkb2NILHNjcm9sbEhlaWdodDpkb2NIK3Njcm9sbEdhcChjbSkrZC5iYXJIZWlnaHQsbmF0aXZlQmFyV2lkdGg6ZC5uYXRpdmVCYXJXaWR0aCxndXR0ZXJXaWR0aDpndXR0ZXJXfTt9ZnVuY3Rpb24gTmF0aXZlU2Nyb2xsYmFycyhwbGFjZSxzY3JvbGwsY20pe3RoaXMuY209Y207dmFyIHZlcnQ9dGhpcy52ZXJ0PWVsdChcImRpdlwiLFtlbHQoXCJkaXZcIixudWxsLG51bGwsXCJtaW4td2lkdGg6IDFweFwiKV0sXCJDb2RlTWlycm9yLXZzY3JvbGxiYXJcIik7dmFyIGhvcml6PXRoaXMuaG9yaXo9ZWx0KFwiZGl2XCIsW2VsdChcImRpdlwiLG51bGwsbnVsbCxcImhlaWdodDogMTAwJTsgbWluLWhlaWdodDogMXB4XCIpXSxcIkNvZGVNaXJyb3ItaHNjcm9sbGJhclwiKTtwbGFjZSh2ZXJ0KTtwbGFjZShob3Jpeik7b24odmVydCxcInNjcm9sbFwiLGZ1bmN0aW9uKCl7aWYodmVydC5jbGllbnRIZWlnaHQpe3Njcm9sbCh2ZXJ0LnNjcm9sbFRvcCxcInZlcnRpY2FsXCIpO319KTtvbihob3JpeixcInNjcm9sbFwiLGZ1bmN0aW9uKCl7aWYoaG9yaXouY2xpZW50V2lkdGgpe3Njcm9sbChob3Jpei5zY3JvbGxMZWZ0LFwiaG9yaXpvbnRhbFwiKTt9fSk7dGhpcy5jaGVja2VkWmVyb1dpZHRoPWZhbHNlOy8vIE5lZWQgdG8gc2V0IGEgbWluaW11bSB3aWR0aCB0byBzZWUgdGhlIHNjcm9sbGJhciBvbiBJRTcgKGJ1dCBtdXN0IG5vdCBzZXQgaXQgb24gSUU4KS5cbmlmKGllJiZpZV92ZXJzaW9uPDgpe3RoaXMuaG9yaXouc3R5bGUubWluSGVpZ2h0PXRoaXMudmVydC5zdHlsZS5taW5XaWR0aD1cIjE4cHhcIjt9fU5hdGl2ZVNjcm9sbGJhcnMucHJvdG90eXBlPWNvcHlPYmooe3VwZGF0ZTpmdW5jdGlvbihtZWFzdXJlKXt2YXIgbmVlZHNIPW1lYXN1cmUuc2Nyb2xsV2lkdGg+bWVhc3VyZS5jbGllbnRXaWR0aCsxO3ZhciBuZWVkc1Y9bWVhc3VyZS5zY3JvbGxIZWlnaHQ+bWVhc3VyZS5jbGllbnRIZWlnaHQrMTt2YXIgc1dpZHRoPW1lYXN1cmUubmF0aXZlQmFyV2lkdGg7aWYobmVlZHNWKXt0aGlzLnZlcnQuc3R5bGUuZGlzcGxheT1cImJsb2NrXCI7dGhpcy52ZXJ0LnN0eWxlLmJvdHRvbT1uZWVkc0g/c1dpZHRoK1wicHhcIjpcIjBcIjt2YXIgdG90YWxIZWlnaHQ9bWVhc3VyZS52aWV3SGVpZ2h0LShuZWVkc0g/c1dpZHRoOjApOy8vIEEgYnVnIGluIElFOCBjYW4gY2F1c2UgdGhpcyB2YWx1ZSB0byBiZSBuZWdhdGl2ZSwgc28gZ3VhcmQgaXQuXG50aGlzLnZlcnQuZmlyc3RDaGlsZC5zdHlsZS5oZWlnaHQ9TWF0aC5tYXgoMCxtZWFzdXJlLnNjcm9sbEhlaWdodC1tZWFzdXJlLmNsaWVudEhlaWdodCt0b3RhbEhlaWdodCkrXCJweFwiO31lbHNle3RoaXMudmVydC5zdHlsZS5kaXNwbGF5PVwiXCI7dGhpcy52ZXJ0LmZpcnN0Q2hpbGQuc3R5bGUuaGVpZ2h0PVwiMFwiO31pZihuZWVkc0gpe3RoaXMuaG9yaXouc3R5bGUuZGlzcGxheT1cImJsb2NrXCI7dGhpcy5ob3Jpei5zdHlsZS5yaWdodD1uZWVkc1Y/c1dpZHRoK1wicHhcIjpcIjBcIjt0aGlzLmhvcml6LnN0eWxlLmxlZnQ9bWVhc3VyZS5iYXJMZWZ0K1wicHhcIjt2YXIgdG90YWxXaWR0aD1tZWFzdXJlLnZpZXdXaWR0aC1tZWFzdXJlLmJhckxlZnQtKG5lZWRzVj9zV2lkdGg6MCk7dGhpcy5ob3Jpei5maXJzdENoaWxkLnN0eWxlLndpZHRoPW1lYXN1cmUuc2Nyb2xsV2lkdGgtbWVhc3VyZS5jbGllbnRXaWR0aCt0b3RhbFdpZHRoK1wicHhcIjt9ZWxzZXt0aGlzLmhvcml6LnN0eWxlLmRpc3BsYXk9XCJcIjt0aGlzLmhvcml6LmZpcnN0Q2hpbGQuc3R5bGUud2lkdGg9XCIwXCI7fWlmKCF0aGlzLmNoZWNrZWRaZXJvV2lkdGgmJm1lYXN1cmUuY2xpZW50SGVpZ2h0PjApe2lmKHNXaWR0aD09MCl7dGhpcy56ZXJvV2lkdGhIYWNrKCk7fXRoaXMuY2hlY2tlZFplcm9XaWR0aD10cnVlO31yZXR1cm57cmlnaHQ6bmVlZHNWP3NXaWR0aDowLGJvdHRvbTpuZWVkc0g/c1dpZHRoOjB9O30sc2V0U2Nyb2xsTGVmdDpmdW5jdGlvbihwb3Mpe2lmKHRoaXMuaG9yaXouc2Nyb2xsTGVmdCE9cG9zKXt0aGlzLmhvcml6LnNjcm9sbExlZnQ9cG9zO31pZih0aGlzLmRpc2FibGVIb3Jpeil7dGhpcy5lbmFibGVaZXJvV2lkdGhCYXIodGhpcy5ob3Jpeix0aGlzLmRpc2FibGVIb3Jpeik7fX0sc2V0U2Nyb2xsVG9wOmZ1bmN0aW9uKHBvcyl7aWYodGhpcy52ZXJ0LnNjcm9sbFRvcCE9cG9zKXt0aGlzLnZlcnQuc2Nyb2xsVG9wPXBvczt9aWYodGhpcy5kaXNhYmxlVmVydCl7dGhpcy5lbmFibGVaZXJvV2lkdGhCYXIodGhpcy52ZXJ0LHRoaXMuZGlzYWJsZVZlcnQpO319LHplcm9XaWR0aEhhY2s6ZnVuY3Rpb24oKXt2YXIgdz1tYWMmJiFtYWNfZ2VNb3VudGFpbkxpb24/XCIxMnB4XCI6XCIxOHB4XCI7dGhpcy5ob3Jpei5zdHlsZS5oZWlnaHQ9dGhpcy52ZXJ0LnN0eWxlLndpZHRoPXc7dGhpcy5ob3Jpei5zdHlsZS5wb2ludGVyRXZlbnRzPXRoaXMudmVydC5zdHlsZS5wb2ludGVyRXZlbnRzPVwibm9uZVwiO3RoaXMuZGlzYWJsZUhvcml6PW5ldyBEZWxheWVkKCk7dGhpcy5kaXNhYmxlVmVydD1uZXcgRGVsYXllZCgpO30sZW5hYmxlWmVyb1dpZHRoQmFyOmZ1bmN0aW9uKGJhcixkZWxheSl7YmFyLnN0eWxlLnBvaW50ZXJFdmVudHM9XCJhdXRvXCI7ZnVuY3Rpb24gbWF5YmVEaXNhYmxlKCl7Ly8gVG8gZmluZCBvdXQgd2hldGhlciB0aGUgc2Nyb2xsYmFyIGlzIHN0aWxsIHZpc2libGUsIHdlXG4vLyBjaGVjayB3aGV0aGVyIHRoZSBlbGVtZW50IHVuZGVyIHRoZSBwaXhlbCBpbiB0aGUgYm90dG9tXG4vLyBsZWZ0IGNvcm5lciBvZiB0aGUgc2Nyb2xsYmFyIGJveCBpcyB0aGUgc2Nyb2xsYmFyIGJveFxuLy8gaXRzZWxmICh3aGVuIHRoZSBiYXIgaXMgc3RpbGwgdmlzaWJsZSkgb3IgaXRzIGZpbGxlciBjaGlsZFxuLy8gKHdoZW4gdGhlIGJhciBpcyBoaWRkZW4pLiBJZiBpdCBpcyBzdGlsbCB2aXNpYmxlLCB3ZSBrZWVwXG4vLyBpdCBlbmFibGVkLCBpZiBpdCdzIGhpZGRlbiwgd2UgZGlzYWJsZSBwb2ludGVyIGV2ZW50cy5cbnZhciBib3g9YmFyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO3ZhciBlbHQ9ZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludChib3gubGVmdCsxLGJveC5ib3R0b20tMSk7aWYoZWx0IT1iYXIpe2Jhci5zdHlsZS5wb2ludGVyRXZlbnRzPVwibm9uZVwiO31lbHNle2RlbGF5LnNldCgxMDAwLG1heWJlRGlzYWJsZSk7fX1kZWxheS5zZXQoMTAwMCxtYXliZURpc2FibGUpO30sY2xlYXI6ZnVuY3Rpb24oKXt2YXIgcGFyZW50PXRoaXMuaG9yaXoucGFyZW50Tm9kZTtwYXJlbnQucmVtb3ZlQ2hpbGQodGhpcy5ob3Jpeik7cGFyZW50LnJlbW92ZUNoaWxkKHRoaXMudmVydCk7fX0sTmF0aXZlU2Nyb2xsYmFycy5wcm90b3R5cGUpO2Z1bmN0aW9uIE51bGxTY3JvbGxiYXJzKCl7fU51bGxTY3JvbGxiYXJzLnByb3RvdHlwZT1jb3B5T2JqKHt1cGRhdGU6ZnVuY3Rpb24oKXtyZXR1cm57Ym90dG9tOjAscmlnaHQ6MH07fSxzZXRTY3JvbGxMZWZ0OmZ1bmN0aW9uKCl7fSxzZXRTY3JvbGxUb3A6ZnVuY3Rpb24oKXt9LGNsZWFyOmZ1bmN0aW9uKCl7fX0sTnVsbFNjcm9sbGJhcnMucHJvdG90eXBlKTtmdW5jdGlvbiB1cGRhdGVTY3JvbGxiYXJzKGNtLG1lYXN1cmUpe2lmKCFtZWFzdXJlKXttZWFzdXJlPW1lYXN1cmVGb3JTY3JvbGxiYXJzKGNtKTt9dmFyIHN0YXJ0V2lkdGg9Y20uZGlzcGxheS5iYXJXaWR0aCxzdGFydEhlaWdodD1jbS5kaXNwbGF5LmJhckhlaWdodDt1cGRhdGVTY3JvbGxiYXJzSW5uZXIoY20sbWVhc3VyZSk7Zm9yKHZhciBpPTA7aTw0JiZzdGFydFdpZHRoIT1jbS5kaXNwbGF5LmJhcldpZHRofHxzdGFydEhlaWdodCE9Y20uZGlzcGxheS5iYXJIZWlnaHQ7aSsrKXtpZihzdGFydFdpZHRoIT1jbS5kaXNwbGF5LmJhcldpZHRoJiZjbS5vcHRpb25zLmxpbmVXcmFwcGluZyl7dXBkYXRlSGVpZ2h0c0luVmlld3BvcnQoY20pO311cGRhdGVTY3JvbGxiYXJzSW5uZXIoY20sbWVhc3VyZUZvclNjcm9sbGJhcnMoY20pKTtzdGFydFdpZHRoPWNtLmRpc3BsYXkuYmFyV2lkdGg7c3RhcnRIZWlnaHQ9Y20uZGlzcGxheS5iYXJIZWlnaHQ7fX0vLyBSZS1zeW5jaHJvbml6ZSB0aGUgZmFrZSBzY3JvbGxiYXJzIHdpdGggdGhlIGFjdHVhbCBzaXplIG9mIHRoZVxuLy8gY29udGVudC5cbmZ1bmN0aW9uIHVwZGF0ZVNjcm9sbGJhcnNJbm5lcihjbSxtZWFzdXJlKXt2YXIgZD1jbS5kaXNwbGF5O3ZhciBzaXplcz1kLnNjcm9sbGJhcnMudXBkYXRlKG1lYXN1cmUpO2Quc2l6ZXIuc3R5bGUucGFkZGluZ1JpZ2h0PShkLmJhcldpZHRoPXNpemVzLnJpZ2h0KStcInB4XCI7ZC5zaXplci5zdHlsZS5wYWRkaW5nQm90dG9tPShkLmJhckhlaWdodD1zaXplcy5ib3R0b20pK1wicHhcIjtkLmhlaWdodEZvcmNlci5zdHlsZS5ib3JkZXJCb3R0b209c2l6ZXMuYm90dG9tK1wicHggc29saWQgdHJhbnNwYXJlbnRcIjtpZihzaXplcy5yaWdodCYmc2l6ZXMuYm90dG9tKXtkLnNjcm9sbGJhckZpbGxlci5zdHlsZS5kaXNwbGF5PVwiYmxvY2tcIjtkLnNjcm9sbGJhckZpbGxlci5zdHlsZS5oZWlnaHQ9c2l6ZXMuYm90dG9tK1wicHhcIjtkLnNjcm9sbGJhckZpbGxlci5zdHlsZS53aWR0aD1zaXplcy5yaWdodCtcInB4XCI7fWVsc2V7ZC5zY3JvbGxiYXJGaWxsZXIuc3R5bGUuZGlzcGxheT1cIlwiO31pZihzaXplcy5ib3R0b20mJmNtLm9wdGlvbnMuY292ZXJHdXR0ZXJOZXh0VG9TY3JvbGxiYXImJmNtLm9wdGlvbnMuZml4ZWRHdXR0ZXIpe2QuZ3V0dGVyRmlsbGVyLnN0eWxlLmRpc3BsYXk9XCJibG9ja1wiO2QuZ3V0dGVyRmlsbGVyLnN0eWxlLmhlaWdodD1zaXplcy5ib3R0b20rXCJweFwiO2QuZ3V0dGVyRmlsbGVyLnN0eWxlLndpZHRoPW1lYXN1cmUuZ3V0dGVyV2lkdGgrXCJweFwiO31lbHNle2QuZ3V0dGVyRmlsbGVyLnN0eWxlLmRpc3BsYXk9XCJcIjt9fXZhciBzY3JvbGxiYXJNb2RlbD17XCJuYXRpdmVcIjpOYXRpdmVTY3JvbGxiYXJzLFwibnVsbFwiOk51bGxTY3JvbGxiYXJzfTtmdW5jdGlvbiBpbml0U2Nyb2xsYmFycyhjbSl7aWYoY20uZGlzcGxheS5zY3JvbGxiYXJzKXtjbS5kaXNwbGF5LnNjcm9sbGJhcnMuY2xlYXIoKTtpZihjbS5kaXNwbGF5LnNjcm9sbGJhcnMuYWRkQ2xhc3Mpe3JtQ2xhc3MoY20uZGlzcGxheS53cmFwcGVyLGNtLmRpc3BsYXkuc2Nyb2xsYmFycy5hZGRDbGFzcyk7fX1jbS5kaXNwbGF5LnNjcm9sbGJhcnM9bmV3IHNjcm9sbGJhck1vZGVsW2NtLm9wdGlvbnMuc2Nyb2xsYmFyU3R5bGVdKGZ1bmN0aW9uKG5vZGUpe2NtLmRpc3BsYXkud3JhcHBlci5pbnNlcnRCZWZvcmUobm9kZSxjbS5kaXNwbGF5LnNjcm9sbGJhckZpbGxlcik7Ly8gUHJldmVudCBjbGlja3MgaW4gdGhlIHNjcm9sbGJhcnMgZnJvbSBraWxsaW5nIGZvY3VzXG5vbihub2RlLFwibW91c2Vkb3duXCIsZnVuY3Rpb24oKXtpZihjbS5zdGF0ZS5mb2N1c2VkKXtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7cmV0dXJuIGNtLmRpc3BsYXkuaW5wdXQuZm9jdXMoKTt9LDApO319KTtub2RlLnNldEF0dHJpYnV0ZShcImNtLW5vdC1jb250ZW50XCIsXCJ0cnVlXCIpO30sZnVuY3Rpb24ocG9zLGF4aXMpe2lmKGF4aXM9PVwiaG9yaXpvbnRhbFwiKXtzZXRTY3JvbGxMZWZ0KGNtLHBvcyk7fWVsc2V7c2V0U2Nyb2xsVG9wKGNtLHBvcyk7fX0sY20pO2lmKGNtLmRpc3BsYXkuc2Nyb2xsYmFycy5hZGRDbGFzcyl7YWRkQ2xhc3MoY20uZGlzcGxheS53cmFwcGVyLGNtLmRpc3BsYXkuc2Nyb2xsYmFycy5hZGRDbGFzcyk7fX0vLyBTQ1JPTExJTkcgVEhJTkdTIElOVE8gVklFV1xuLy8gSWYgYW4gZWRpdG9yIHNpdHMgb24gdGhlIHRvcCBvciBib3R0b20gb2YgdGhlIHdpbmRvdywgcGFydGlhbGx5XG4vLyBzY3JvbGxlZCBvdXQgb2YgdmlldywgdGhpcyBlbnN1cmVzIHRoYXQgdGhlIGN1cnNvciBpcyB2aXNpYmxlLlxuZnVuY3Rpb24gbWF5YmVTY3JvbGxXaW5kb3coY20sY29vcmRzKXtpZihzaWduYWxET01FdmVudChjbSxcInNjcm9sbEN1cnNvckludG9WaWV3XCIpKXtyZXR1cm47fXZhciBkaXNwbGF5PWNtLmRpc3BsYXksYm94PWRpc3BsYXkuc2l6ZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksZG9TY3JvbGw9bnVsbDtpZihjb29yZHMudG9wK2JveC50b3A8MCl7ZG9TY3JvbGw9dHJ1ZTt9ZWxzZSBpZihjb29yZHMuYm90dG9tK2JveC50b3A+KHdpbmRvdy5pbm5lckhlaWdodHx8ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCkpe2RvU2Nyb2xsPWZhbHNlO31pZihkb1Njcm9sbCE9bnVsbCYmIXBoYW50b20pe3ZhciBzY3JvbGxOb2RlPWVsdChcImRpdlwiLFwiXFx1MjAwYlwiLG51bGwsXCJwb3NpdGlvbjogYWJzb2x1dGU7XFxuICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogXCIrKGNvb3Jkcy50b3AtZGlzcGxheS52aWV3T2Zmc2V0LXBhZGRpbmdUb3AoY20uZGlzcGxheSkpK1wicHg7XFxuICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogXCIrKGNvb3Jkcy5ib3R0b20tY29vcmRzLnRvcCtzY3JvbGxHYXAoY20pK2Rpc3BsYXkuYmFySGVpZ2h0KStcInB4O1xcbiAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBcIitjb29yZHMubGVmdCtcInB4OyB3aWR0aDogMnB4O1wiKTtjbS5kaXNwbGF5LmxpbmVTcGFjZS5hcHBlbmRDaGlsZChzY3JvbGxOb2RlKTtzY3JvbGxOb2RlLnNjcm9sbEludG9WaWV3KGRvU2Nyb2xsKTtjbS5kaXNwbGF5LmxpbmVTcGFjZS5yZW1vdmVDaGlsZChzY3JvbGxOb2RlKTt9fS8vIFNjcm9sbCBhIGdpdmVuIHBvc2l0aW9uIGludG8gdmlldyAoaW1tZWRpYXRlbHkpLCB2ZXJpZnlpbmcgdGhhdFxuLy8gaXQgYWN0dWFsbHkgYmVjYW1lIHZpc2libGUgKGFzIGxpbmUgaGVpZ2h0cyBhcmUgYWNjdXJhdGVseVxuLy8gbWVhc3VyZWQsIHRoZSBwb3NpdGlvbiBvZiBzb21ldGhpbmcgbWF5ICdkcmlmdCcgZHVyaW5nIGRyYXdpbmcpLlxuZnVuY3Rpb24gc2Nyb2xsUG9zSW50b1ZpZXcoY20scG9zLGVuZCxtYXJnaW4pe2lmKG1hcmdpbj09bnVsbCl7bWFyZ2luPTA7fXZhciBjb29yZHM7Zm9yKHZhciBsaW1pdD0wO2xpbWl0PDU7bGltaXQrKyl7dmFyIGNoYW5nZWQ9ZmFsc2U7Y29vcmRzPWN1cnNvckNvb3JkcyhjbSxwb3MpO3ZhciBlbmRDb29yZHM9IWVuZHx8ZW5kPT1wb3M/Y29vcmRzOmN1cnNvckNvb3JkcyhjbSxlbmQpO3ZhciBzY3JvbGxQb3M9Y2FsY3VsYXRlU2Nyb2xsUG9zKGNtLE1hdGgubWluKGNvb3Jkcy5sZWZ0LGVuZENvb3Jkcy5sZWZ0KSxNYXRoLm1pbihjb29yZHMudG9wLGVuZENvb3Jkcy50b3ApLW1hcmdpbixNYXRoLm1heChjb29yZHMubGVmdCxlbmRDb29yZHMubGVmdCksTWF0aC5tYXgoY29vcmRzLmJvdHRvbSxlbmRDb29yZHMuYm90dG9tKSttYXJnaW4pO3ZhciBzdGFydFRvcD1jbS5kb2Muc2Nyb2xsVG9wLHN0YXJ0TGVmdD1jbS5kb2Muc2Nyb2xsTGVmdDtpZihzY3JvbGxQb3Muc2Nyb2xsVG9wIT1udWxsKXtzZXRTY3JvbGxUb3AoY20sc2Nyb2xsUG9zLnNjcm9sbFRvcCk7aWYoTWF0aC5hYnMoY20uZG9jLnNjcm9sbFRvcC1zdGFydFRvcCk+MSl7Y2hhbmdlZD10cnVlO319aWYoc2Nyb2xsUG9zLnNjcm9sbExlZnQhPW51bGwpe3NldFNjcm9sbExlZnQoY20sc2Nyb2xsUG9zLnNjcm9sbExlZnQpO2lmKE1hdGguYWJzKGNtLmRvYy5zY3JvbGxMZWZ0LXN0YXJ0TGVmdCk+MSl7Y2hhbmdlZD10cnVlO319aWYoIWNoYW5nZWQpe2JyZWFrO319cmV0dXJuIGNvb3Jkczt9Ly8gU2Nyb2xsIGEgZ2l2ZW4gc2V0IG9mIGNvb3JkaW5hdGVzIGludG8gdmlldyAoaW1tZWRpYXRlbHkpLlxuZnVuY3Rpb24gc2Nyb2xsSW50b1ZpZXcoY20seDEseTEseDIseTIpe3ZhciBzY3JvbGxQb3M9Y2FsY3VsYXRlU2Nyb2xsUG9zKGNtLHgxLHkxLHgyLHkyKTtpZihzY3JvbGxQb3Muc2Nyb2xsVG9wIT1udWxsKXtzZXRTY3JvbGxUb3AoY20sc2Nyb2xsUG9zLnNjcm9sbFRvcCk7fWlmKHNjcm9sbFBvcy5zY3JvbGxMZWZ0IT1udWxsKXtzZXRTY3JvbGxMZWZ0KGNtLHNjcm9sbFBvcy5zY3JvbGxMZWZ0KTt9fS8vIENhbGN1bGF0ZSBhIG5ldyBzY3JvbGwgcG9zaXRpb24gbmVlZGVkIHRvIHNjcm9sbCB0aGUgZ2l2ZW5cbi8vIHJlY3RhbmdsZSBpbnRvIHZpZXcuIFJldHVybnMgYW4gb2JqZWN0IHdpdGggc2Nyb2xsVG9wIGFuZFxuLy8gc2Nyb2xsTGVmdCBwcm9wZXJ0aWVzLiBXaGVuIHRoZXNlIGFyZSB1bmRlZmluZWQsIHRoZVxuLy8gdmVydGljYWwvaG9yaXpvbnRhbCBwb3NpdGlvbiBkb2VzIG5vdCBuZWVkIHRvIGJlIGFkanVzdGVkLlxuZnVuY3Rpb24gY2FsY3VsYXRlU2Nyb2xsUG9zKGNtLHgxLHkxLHgyLHkyKXt2YXIgZGlzcGxheT1jbS5kaXNwbGF5LHNuYXBNYXJnaW49dGV4dEhlaWdodChjbS5kaXNwbGF5KTtpZih5MTwwKXt5MT0wO312YXIgc2NyZWVudG9wPWNtLmN1ck9wJiZjbS5jdXJPcC5zY3JvbGxUb3AhPW51bGw/Y20uY3VyT3Auc2Nyb2xsVG9wOmRpc3BsYXkuc2Nyb2xsZXIuc2Nyb2xsVG9wO3ZhciBzY3JlZW49ZGlzcGxheUhlaWdodChjbSkscmVzdWx0PXt9O2lmKHkyLXkxPnNjcmVlbil7eTI9eTErc2NyZWVuO312YXIgZG9jQm90dG9tPWNtLmRvYy5oZWlnaHQrcGFkZGluZ1ZlcnQoZGlzcGxheSk7dmFyIGF0VG9wPXkxPHNuYXBNYXJnaW4sYXRCb3R0b209eTI+ZG9jQm90dG9tLXNuYXBNYXJnaW47aWYoeTE8c2NyZWVudG9wKXtyZXN1bHQuc2Nyb2xsVG9wPWF0VG9wPzA6eTE7fWVsc2UgaWYoeTI+c2NyZWVudG9wK3NjcmVlbil7dmFyIG5ld1RvcD1NYXRoLm1pbih5MSwoYXRCb3R0b20/ZG9jQm90dG9tOnkyKS1zY3JlZW4pO2lmKG5ld1RvcCE9c2NyZWVudG9wKXtyZXN1bHQuc2Nyb2xsVG9wPW5ld1RvcDt9fXZhciBzY3JlZW5sZWZ0PWNtLmN1ck9wJiZjbS5jdXJPcC5zY3JvbGxMZWZ0IT1udWxsP2NtLmN1ck9wLnNjcm9sbExlZnQ6ZGlzcGxheS5zY3JvbGxlci5zY3JvbGxMZWZ0O3ZhciBzY3JlZW53PWRpc3BsYXlXaWR0aChjbSktKGNtLm9wdGlvbnMuZml4ZWRHdXR0ZXI/ZGlzcGxheS5ndXR0ZXJzLm9mZnNldFdpZHRoOjApO3ZhciB0b29XaWRlPXgyLXgxPnNjcmVlbnc7aWYodG9vV2lkZSl7eDI9eDErc2NyZWVudzt9aWYoeDE8MTApe3Jlc3VsdC5zY3JvbGxMZWZ0PTA7fWVsc2UgaWYoeDE8c2NyZWVubGVmdCl7cmVzdWx0LnNjcm9sbExlZnQ9TWF0aC5tYXgoMCx4MS0odG9vV2lkZT8wOjEwKSk7fWVsc2UgaWYoeDI+c2NyZWVudytzY3JlZW5sZWZ0LTMpe3Jlc3VsdC5zY3JvbGxMZWZ0PXgyKyh0b29XaWRlPzA6MTApLXNjcmVlbnc7fXJldHVybiByZXN1bHQ7fS8vIFN0b3JlIGEgcmVsYXRpdmUgYWRqdXN0bWVudCB0byB0aGUgc2Nyb2xsIHBvc2l0aW9uIGluIHRoZSBjdXJyZW50XG4vLyBvcGVyYXRpb24gKHRvIGJlIGFwcGxpZWQgd2hlbiB0aGUgb3BlcmF0aW9uIGZpbmlzaGVzKS5cbmZ1bmN0aW9uIGFkZFRvU2Nyb2xsUG9zKGNtLGxlZnQsdG9wKXtpZihsZWZ0IT1udWxsfHx0b3AhPW51bGwpe3Jlc29sdmVTY3JvbGxUb1BvcyhjbSk7fWlmKGxlZnQhPW51bGwpe2NtLmN1ck9wLnNjcm9sbExlZnQ9KGNtLmN1ck9wLnNjcm9sbExlZnQ9PW51bGw/Y20uZG9jLnNjcm9sbExlZnQ6Y20uY3VyT3Auc2Nyb2xsTGVmdCkrbGVmdDt9aWYodG9wIT1udWxsKXtjbS5jdXJPcC5zY3JvbGxUb3A9KGNtLmN1ck9wLnNjcm9sbFRvcD09bnVsbD9jbS5kb2Muc2Nyb2xsVG9wOmNtLmN1ck9wLnNjcm9sbFRvcCkrdG9wO319Ly8gTWFrZSBzdXJlIHRoYXQgYXQgdGhlIGVuZCBvZiB0aGUgb3BlcmF0aW9uIHRoZSBjdXJyZW50IGN1cnNvciBpc1xuLy8gc2hvd24uXG5mdW5jdGlvbiBlbnN1cmVDdXJzb3JWaXNpYmxlKGNtKXtyZXNvbHZlU2Nyb2xsVG9Qb3MoY20pO3ZhciBjdXI9Y20uZ2V0Q3Vyc29yKCksZnJvbT1jdXIsdG89Y3VyO2lmKCFjbS5vcHRpb25zLmxpbmVXcmFwcGluZyl7ZnJvbT1jdXIuY2g/UG9zKGN1ci5saW5lLGN1ci5jaC0xKTpjdXI7dG89UG9zKGN1ci5saW5lLGN1ci5jaCsxKTt9Y20uY3VyT3Auc2Nyb2xsVG9Qb3M9e2Zyb206ZnJvbSx0bzp0byxtYXJnaW46Y20ub3B0aW9ucy5jdXJzb3JTY3JvbGxNYXJnaW4saXNDdXJzb3I6dHJ1ZX07fS8vIFdoZW4gYW4gb3BlcmF0aW9uIGhhcyBpdHMgc2Nyb2xsVG9Qb3MgcHJvcGVydHkgc2V0LCBhbmQgYW5vdGhlclxuLy8gc2Nyb2xsIGFjdGlvbiBpcyBhcHBsaWVkIGJlZm9yZSB0aGUgZW5kIG9mIHRoZSBvcGVyYXRpb24sIHRoaXNcbi8vICdzaW11bGF0ZXMnIHNjcm9sbGluZyB0aGF0IHBvc2l0aW9uIGludG8gdmlldyBpbiBhIGNoZWFwIHdheSwgc29cbi8vIHRoYXQgdGhlIGVmZmVjdCBvZiBpbnRlcm1lZGlhdGUgc2Nyb2xsIGNvbW1hbmRzIGlzIG5vdCBpZ25vcmVkLlxuZnVuY3Rpb24gcmVzb2x2ZVNjcm9sbFRvUG9zKGNtKXt2YXIgcmFuZ2U9Y20uY3VyT3Auc2Nyb2xsVG9Qb3M7aWYocmFuZ2Upe2NtLmN1ck9wLnNjcm9sbFRvUG9zPW51bGw7dmFyIGZyb209ZXN0aW1hdGVDb29yZHMoY20scmFuZ2UuZnJvbSksdG89ZXN0aW1hdGVDb29yZHMoY20scmFuZ2UudG8pO3ZhciBzUG9zPWNhbGN1bGF0ZVNjcm9sbFBvcyhjbSxNYXRoLm1pbihmcm9tLmxlZnQsdG8ubGVmdCksTWF0aC5taW4oZnJvbS50b3AsdG8udG9wKS1yYW5nZS5tYXJnaW4sTWF0aC5tYXgoZnJvbS5yaWdodCx0by5yaWdodCksTWF0aC5tYXgoZnJvbS5ib3R0b20sdG8uYm90dG9tKStyYW5nZS5tYXJnaW4pO2NtLnNjcm9sbFRvKHNQb3Muc2Nyb2xsTGVmdCxzUG9zLnNjcm9sbFRvcCk7fX0vLyBPcGVyYXRpb25zIGFyZSB1c2VkIHRvIHdyYXAgYSBzZXJpZXMgb2YgY2hhbmdlcyB0byB0aGUgZWRpdG9yXG4vLyBzdGF0ZSBpbiBzdWNoIGEgd2F5IHRoYXQgZWFjaCBjaGFuZ2Ugd29uJ3QgaGF2ZSB0byB1cGRhdGUgdGhlXG4vLyBjdXJzb3IgYW5kIGRpc3BsYXkgKHdoaWNoIHdvdWxkIGJlIGF3a3dhcmQsIHNsb3csIGFuZFxuLy8gZXJyb3ItcHJvbmUpLiBJbnN0ZWFkLCBkaXNwbGF5IHVwZGF0ZXMgYXJlIGJhdGNoZWQgYW5kIHRoZW4gYWxsXG4vLyBjb21iaW5lZCBhbmQgZXhlY3V0ZWQgYXQgb25jZS5cbnZhciBuZXh0T3BJZD0wOy8vIFN0YXJ0IGEgbmV3IG9wZXJhdGlvbi5cbmZ1bmN0aW9uIHN0YXJ0T3BlcmF0aW9uKGNtKXtjbS5jdXJPcD17Y206Y20sdmlld0NoYW5nZWQ6ZmFsc2UsLy8gRmxhZyB0aGF0IGluZGljYXRlcyB0aGF0IGxpbmVzIG1pZ2h0IG5lZWQgdG8gYmUgcmVkcmF3blxuc3RhcnRIZWlnaHQ6Y20uZG9jLmhlaWdodCwvLyBVc2VkIHRvIGRldGVjdCBuZWVkIHRvIHVwZGF0ZSBzY3JvbGxiYXJcbmZvcmNlVXBkYXRlOmZhbHNlLC8vIFVzZWQgdG8gZm9yY2UgYSByZWRyYXdcbnVwZGF0ZUlucHV0Om51bGwsLy8gV2hldGhlciB0byByZXNldCB0aGUgaW5wdXQgdGV4dGFyZWFcbnR5cGluZzpmYWxzZSwvLyBXaGV0aGVyIHRoaXMgcmVzZXQgc2hvdWxkIGJlIGNhcmVmdWwgdG8gbGVhdmUgZXhpc3RpbmcgdGV4dCAoZm9yIGNvbXBvc2l0aW5nKVxuY2hhbmdlT2JqczpudWxsLC8vIEFjY3VtdWxhdGVkIGNoYW5nZXMsIGZvciBmaXJpbmcgY2hhbmdlIGV2ZW50c1xuY3Vyc29yQWN0aXZpdHlIYW5kbGVyczpudWxsLC8vIFNldCBvZiBoYW5kbGVycyB0byBmaXJlIGN1cnNvckFjdGl2aXR5IG9uXG5jdXJzb3JBY3Rpdml0eUNhbGxlZDowLC8vIFRyYWNrcyB3aGljaCBjdXJzb3JBY3Rpdml0eSBoYW5kbGVycyBoYXZlIGJlZW4gY2FsbGVkIGFscmVhZHlcbnNlbGVjdGlvbkNoYW5nZWQ6ZmFsc2UsLy8gV2hldGhlciB0aGUgc2VsZWN0aW9uIG5lZWRzIHRvIGJlIHJlZHJhd25cbnVwZGF0ZU1heExpbmU6ZmFsc2UsLy8gU2V0IHdoZW4gdGhlIHdpZGVzdCBsaW5lIG5lZWRzIHRvIGJlIGRldGVybWluZWQgYW5ld1xuc2Nyb2xsTGVmdDpudWxsLHNjcm9sbFRvcDpudWxsLC8vIEludGVybWVkaWF0ZSBzY3JvbGwgcG9zaXRpb24sIG5vdCBwdXNoZWQgdG8gRE9NIHlldFxuc2Nyb2xsVG9Qb3M6bnVsbCwvLyBVc2VkIHRvIHNjcm9sbCB0byBhIHNwZWNpZmljIHBvc2l0aW9uXG5mb2N1czpmYWxzZSxpZDorK25leHRPcElkLy8gVW5pcXVlIElEXG59O3B1c2hPcGVyYXRpb24oY20uY3VyT3ApO30vLyBGaW5pc2ggYW4gb3BlcmF0aW9uLCB1cGRhdGluZyB0aGUgZGlzcGxheSBhbmQgc2lnbmFsbGluZyBkZWxheWVkIGV2ZW50c1xuZnVuY3Rpb24gZW5kT3BlcmF0aW9uKGNtKXt2YXIgb3A9Y20uY3VyT3A7ZmluaXNoT3BlcmF0aW9uKG9wLGZ1bmN0aW9uKGdyb3VwKXtmb3IodmFyIGk9MDtpPGdyb3VwLm9wcy5sZW5ndGg7aSsrKXtncm91cC5vcHNbaV0uY20uY3VyT3A9bnVsbDt9ZW5kT3BlcmF0aW9ucyhncm91cCk7fSk7fS8vIFRoZSBET00gdXBkYXRlcyBkb25lIHdoZW4gYW4gb3BlcmF0aW9uIGZpbmlzaGVzIGFyZSBiYXRjaGVkIHNvXG4vLyB0aGF0IHRoZSBtaW5pbXVtIG51bWJlciBvZiByZWxheW91dHMgYXJlIHJlcXVpcmVkLlxuZnVuY3Rpb24gZW5kT3BlcmF0aW9ucyhncm91cCl7dmFyIG9wcz1ncm91cC5vcHM7Zm9yKHZhciBpPTA7aTxvcHMubGVuZ3RoO2krKykvLyBSZWFkIERPTVxue2VuZE9wZXJhdGlvbl9SMShvcHNbaV0pO31mb3IodmFyIGkkMT0wO2kkMTxvcHMubGVuZ3RoO2kkMSsrKS8vIFdyaXRlIERPTSAobWF5YmUpXG57ZW5kT3BlcmF0aW9uX1cxKG9wc1tpJDFdKTt9Zm9yKHZhciBpJDI9MDtpJDI8b3BzLmxlbmd0aDtpJDIrKykvLyBSZWFkIERPTVxue2VuZE9wZXJhdGlvbl9SMihvcHNbaSQyXSk7fWZvcih2YXIgaSQzPTA7aSQzPG9wcy5sZW5ndGg7aSQzKyspLy8gV3JpdGUgRE9NIChtYXliZSlcbntlbmRPcGVyYXRpb25fVzIob3BzW2kkM10pO31mb3IodmFyIGkkND0wO2kkNDxvcHMubGVuZ3RoO2kkNCsrKS8vIFJlYWQgRE9NXG57ZW5kT3BlcmF0aW9uX2ZpbmlzaChvcHNbaSQ0XSk7fX1mdW5jdGlvbiBlbmRPcGVyYXRpb25fUjEob3Ape3ZhciBjbT1vcC5jbSxkaXNwbGF5PWNtLmRpc3BsYXk7bWF5YmVDbGlwU2Nyb2xsYmFycyhjbSk7aWYob3AudXBkYXRlTWF4TGluZSl7ZmluZE1heExpbmUoY20pO31vcC5tdXN0VXBkYXRlPW9wLnZpZXdDaGFuZ2VkfHxvcC5mb3JjZVVwZGF0ZXx8b3Auc2Nyb2xsVG9wIT1udWxsfHxvcC5zY3JvbGxUb1BvcyYmKG9wLnNjcm9sbFRvUG9zLmZyb20ubGluZTxkaXNwbGF5LnZpZXdGcm9tfHxvcC5zY3JvbGxUb1Bvcy50by5saW5lPj1kaXNwbGF5LnZpZXdUbyl8fGRpc3BsYXkubWF4TGluZUNoYW5nZWQmJmNtLm9wdGlvbnMubGluZVdyYXBwaW5nO29wLnVwZGF0ZT1vcC5tdXN0VXBkYXRlJiZuZXcgRGlzcGxheVVwZGF0ZShjbSxvcC5tdXN0VXBkYXRlJiZ7dG9wOm9wLnNjcm9sbFRvcCxlbnN1cmU6b3Auc2Nyb2xsVG9Qb3N9LG9wLmZvcmNlVXBkYXRlKTt9ZnVuY3Rpb24gZW5kT3BlcmF0aW9uX1cxKG9wKXtvcC51cGRhdGVkRGlzcGxheT1vcC5tdXN0VXBkYXRlJiZ1cGRhdGVEaXNwbGF5SWZOZWVkZWQob3AuY20sb3AudXBkYXRlKTt9ZnVuY3Rpb24gZW5kT3BlcmF0aW9uX1IyKG9wKXt2YXIgY209b3AuY20sZGlzcGxheT1jbS5kaXNwbGF5O2lmKG9wLnVwZGF0ZWREaXNwbGF5KXt1cGRhdGVIZWlnaHRzSW5WaWV3cG9ydChjbSk7fW9wLmJhck1lYXN1cmU9bWVhc3VyZUZvclNjcm9sbGJhcnMoY20pOy8vIElmIHRoZSBtYXggbGluZSBjaGFuZ2VkIHNpbmNlIGl0IHdhcyBsYXN0IG1lYXN1cmVkLCBtZWFzdXJlIGl0LFxuLy8gYW5kIGVuc3VyZSB0aGUgZG9jdW1lbnQncyB3aWR0aCBtYXRjaGVzIGl0LlxuLy8gdXBkYXRlRGlzcGxheV9XMiB3aWxsIHVzZSB0aGVzZSBwcm9wZXJ0aWVzIHRvIGRvIHRoZSBhY3R1YWwgcmVzaXppbmdcbmlmKGRpc3BsYXkubWF4TGluZUNoYW5nZWQmJiFjbS5vcHRpb25zLmxpbmVXcmFwcGluZyl7b3AuYWRqdXN0V2lkdGhUbz1tZWFzdXJlQ2hhcihjbSxkaXNwbGF5Lm1heExpbmUsZGlzcGxheS5tYXhMaW5lLnRleHQubGVuZ3RoKS5sZWZ0KzM7Y20uZGlzcGxheS5zaXplcldpZHRoPW9wLmFkanVzdFdpZHRoVG87b3AuYmFyTWVhc3VyZS5zY3JvbGxXaWR0aD1NYXRoLm1heChkaXNwbGF5LnNjcm9sbGVyLmNsaWVudFdpZHRoLGRpc3BsYXkuc2l6ZXIub2Zmc2V0TGVmdCtvcC5hZGp1c3RXaWR0aFRvK3Njcm9sbEdhcChjbSkrY20uZGlzcGxheS5iYXJXaWR0aCk7b3AubWF4U2Nyb2xsTGVmdD1NYXRoLm1heCgwLGRpc3BsYXkuc2l6ZXIub2Zmc2V0TGVmdCtvcC5hZGp1c3RXaWR0aFRvLWRpc3BsYXlXaWR0aChjbSkpO31pZihvcC51cGRhdGVkRGlzcGxheXx8b3Auc2VsZWN0aW9uQ2hhbmdlZCl7b3AucHJlcGFyZWRTZWxlY3Rpb249ZGlzcGxheS5pbnB1dC5wcmVwYXJlU2VsZWN0aW9uKG9wLmZvY3VzKTt9fWZ1bmN0aW9uIGVuZE9wZXJhdGlvbl9XMihvcCl7dmFyIGNtPW9wLmNtO2lmKG9wLmFkanVzdFdpZHRoVG8hPW51bGwpe2NtLmRpc3BsYXkuc2l6ZXIuc3R5bGUubWluV2lkdGg9b3AuYWRqdXN0V2lkdGhUbytcInB4XCI7aWYob3AubWF4U2Nyb2xsTGVmdDxjbS5kb2Muc2Nyb2xsTGVmdCl7c2V0U2Nyb2xsTGVmdChjbSxNYXRoLm1pbihjbS5kaXNwbGF5LnNjcm9sbGVyLnNjcm9sbExlZnQsb3AubWF4U2Nyb2xsTGVmdCksdHJ1ZSk7fWNtLmRpc3BsYXkubWF4TGluZUNoYW5nZWQ9ZmFsc2U7fXZhciB0YWtlRm9jdXM9b3AuZm9jdXMmJm9wLmZvY3VzPT1hY3RpdmVFbHQoKSYmKCFkb2N1bWVudC5oYXNGb2N1c3x8ZG9jdW1lbnQuaGFzRm9jdXMoKSk7aWYob3AucHJlcGFyZWRTZWxlY3Rpb24pe2NtLmRpc3BsYXkuaW5wdXQuc2hvd1NlbGVjdGlvbihvcC5wcmVwYXJlZFNlbGVjdGlvbix0YWtlRm9jdXMpO31pZihvcC51cGRhdGVkRGlzcGxheXx8b3Auc3RhcnRIZWlnaHQhPWNtLmRvYy5oZWlnaHQpe3VwZGF0ZVNjcm9sbGJhcnMoY20sb3AuYmFyTWVhc3VyZSk7fWlmKG9wLnVwZGF0ZWREaXNwbGF5KXtzZXREb2N1bWVudEhlaWdodChjbSxvcC5iYXJNZWFzdXJlKTt9aWYob3Auc2VsZWN0aW9uQ2hhbmdlZCl7cmVzdGFydEJsaW5rKGNtKTt9aWYoY20uc3RhdGUuZm9jdXNlZCYmb3AudXBkYXRlSW5wdXQpe2NtLmRpc3BsYXkuaW5wdXQucmVzZXQob3AudHlwaW5nKTt9aWYodGFrZUZvY3VzKXtlbnN1cmVGb2N1cyhvcC5jbSk7fX1mdW5jdGlvbiBlbmRPcGVyYXRpb25fZmluaXNoKG9wKXt2YXIgY209b3AuY20sZGlzcGxheT1jbS5kaXNwbGF5LGRvYz1jbS5kb2M7aWYob3AudXBkYXRlZERpc3BsYXkpe3Bvc3RVcGRhdGVEaXNwbGF5KGNtLG9wLnVwZGF0ZSk7fS8vIEFib3J0IG1vdXNlIHdoZWVsIGRlbHRhIG1lYXN1cmVtZW50LCB3aGVuIHNjcm9sbGluZyBleHBsaWNpdGx5XG5pZihkaXNwbGF5LndoZWVsU3RhcnRYIT1udWxsJiYob3Auc2Nyb2xsVG9wIT1udWxsfHxvcC5zY3JvbGxMZWZ0IT1udWxsfHxvcC5zY3JvbGxUb1Bvcykpe2Rpc3BsYXkud2hlZWxTdGFydFg9ZGlzcGxheS53aGVlbFN0YXJ0WT1udWxsO30vLyBQcm9wYWdhdGUgdGhlIHNjcm9sbCBwb3NpdGlvbiB0byB0aGUgYWN0dWFsIERPTSBzY3JvbGxlclxuaWYob3Auc2Nyb2xsVG9wIT1udWxsJiYoZGlzcGxheS5zY3JvbGxlci5zY3JvbGxUb3AhPW9wLnNjcm9sbFRvcHx8b3AuZm9yY2VTY3JvbGwpKXtkb2Muc2Nyb2xsVG9wPU1hdGgubWF4KDAsTWF0aC5taW4oZGlzcGxheS5zY3JvbGxlci5zY3JvbGxIZWlnaHQtZGlzcGxheS5zY3JvbGxlci5jbGllbnRIZWlnaHQsb3Auc2Nyb2xsVG9wKSk7ZGlzcGxheS5zY3JvbGxiYXJzLnNldFNjcm9sbFRvcChkb2Muc2Nyb2xsVG9wKTtkaXNwbGF5LnNjcm9sbGVyLnNjcm9sbFRvcD1kb2Muc2Nyb2xsVG9wO31pZihvcC5zY3JvbGxMZWZ0IT1udWxsJiYoZGlzcGxheS5zY3JvbGxlci5zY3JvbGxMZWZ0IT1vcC5zY3JvbGxMZWZ0fHxvcC5mb3JjZVNjcm9sbCkpe2RvYy5zY3JvbGxMZWZ0PU1hdGgubWF4KDAsTWF0aC5taW4oZGlzcGxheS5zY3JvbGxlci5zY3JvbGxXaWR0aC1kaXNwbGF5LnNjcm9sbGVyLmNsaWVudFdpZHRoLG9wLnNjcm9sbExlZnQpKTtkaXNwbGF5LnNjcm9sbGJhcnMuc2V0U2Nyb2xsTGVmdChkb2Muc2Nyb2xsTGVmdCk7ZGlzcGxheS5zY3JvbGxlci5zY3JvbGxMZWZ0PWRvYy5zY3JvbGxMZWZ0O2FsaWduSG9yaXpvbnRhbGx5KGNtKTt9Ly8gSWYgd2UgbmVlZCB0byBzY3JvbGwgYSBzcGVjaWZpYyBwb3NpdGlvbiBpbnRvIHZpZXcsIGRvIHNvLlxuaWYob3Auc2Nyb2xsVG9Qb3Mpe3ZhciBjb29yZHM9c2Nyb2xsUG9zSW50b1ZpZXcoY20sY2xpcFBvcyhkb2Msb3Auc2Nyb2xsVG9Qb3MuZnJvbSksY2xpcFBvcyhkb2Msb3Auc2Nyb2xsVG9Qb3MudG8pLG9wLnNjcm9sbFRvUG9zLm1hcmdpbik7aWYob3Auc2Nyb2xsVG9Qb3MuaXNDdXJzb3ImJmNtLnN0YXRlLmZvY3VzZWQpe21heWJlU2Nyb2xsV2luZG93KGNtLGNvb3Jkcyk7fX0vLyBGaXJlIGV2ZW50cyBmb3IgbWFya2VycyB0aGF0IGFyZSBoaWRkZW4vdW5pZGRlbiBieSBlZGl0aW5nIG9yXG4vLyB1bmRvaW5nXG52YXIgaGlkZGVuPW9wLm1heWJlSGlkZGVuTWFya2Vycyx1bmhpZGRlbj1vcC5tYXliZVVuaGlkZGVuTWFya2VycztpZihoaWRkZW4pe2Zvcih2YXIgaT0wO2k8aGlkZGVuLmxlbmd0aDsrK2kpe2lmKCFoaWRkZW5baV0ubGluZXMubGVuZ3RoKXtzaWduYWwoaGlkZGVuW2ldLFwiaGlkZVwiKTt9fX1pZih1bmhpZGRlbil7Zm9yKHZhciBpJDE9MDtpJDE8dW5oaWRkZW4ubGVuZ3RoOysraSQxKXtpZih1bmhpZGRlbltpJDFdLmxpbmVzLmxlbmd0aCl7c2lnbmFsKHVuaGlkZGVuW2kkMV0sXCJ1bmhpZGVcIik7fX19aWYoZGlzcGxheS53cmFwcGVyLm9mZnNldEhlaWdodCl7ZG9jLnNjcm9sbFRvcD1jbS5kaXNwbGF5LnNjcm9sbGVyLnNjcm9sbFRvcDt9Ly8gRmlyZSBjaGFuZ2UgZXZlbnRzLCBhbmQgZGVsYXllZCBldmVudCBoYW5kbGVyc1xuaWYob3AuY2hhbmdlT2Jqcyl7c2lnbmFsKGNtLFwiY2hhbmdlc1wiLGNtLG9wLmNoYW5nZU9ianMpO31pZihvcC51cGRhdGUpe29wLnVwZGF0ZS5maW5pc2goKTt9fS8vIFJ1biB0aGUgZ2l2ZW4gZnVuY3Rpb24gaW4gYW4gb3BlcmF0aW9uXG5mdW5jdGlvbiBydW5Jbk9wKGNtLGYpe2lmKGNtLmN1ck9wKXtyZXR1cm4gZigpO31zdGFydE9wZXJhdGlvbihjbSk7dHJ5e3JldHVybiBmKCk7fWZpbmFsbHl7ZW5kT3BlcmF0aW9uKGNtKTt9fS8vIFdyYXBzIGEgZnVuY3Rpb24gaW4gYW4gb3BlcmF0aW9uLiBSZXR1cm5zIHRoZSB3cmFwcGVkIGZ1bmN0aW9uLlxuZnVuY3Rpb24gb3BlcmF0aW9uKGNtLGYpe3JldHVybiBmdW5jdGlvbigpe2lmKGNtLmN1ck9wKXtyZXR1cm4gZi5hcHBseShjbSxhcmd1bWVudHMpO31zdGFydE9wZXJhdGlvbihjbSk7dHJ5e3JldHVybiBmLmFwcGx5KGNtLGFyZ3VtZW50cyk7fWZpbmFsbHl7ZW5kT3BlcmF0aW9uKGNtKTt9fTt9Ly8gVXNlZCB0byBhZGQgbWV0aG9kcyB0byBlZGl0b3IgYW5kIGRvYyBpbnN0YW5jZXMsIHdyYXBwaW5nIHRoZW0gaW5cbi8vIG9wZXJhdGlvbnMuXG5mdW5jdGlvbiBtZXRob2RPcChmKXtyZXR1cm4gZnVuY3Rpb24oKXtpZih0aGlzLmN1ck9wKXtyZXR1cm4gZi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fXN0YXJ0T3BlcmF0aW9uKHRoaXMpO3RyeXtyZXR1cm4gZi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fWZpbmFsbHl7ZW5kT3BlcmF0aW9uKHRoaXMpO319O31mdW5jdGlvbiBkb2NNZXRob2RPcChmKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgY209dGhpcy5jbTtpZighY218fGNtLmN1ck9wKXtyZXR1cm4gZi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fXN0YXJ0T3BlcmF0aW9uKGNtKTt0cnl7cmV0dXJuIGYuYXBwbHkodGhpcyxhcmd1bWVudHMpO31maW5hbGx5e2VuZE9wZXJhdGlvbihjbSk7fX07fS8vIFVwZGF0ZXMgdGhlIGRpc3BsYXkudmlldyBkYXRhIHN0cnVjdHVyZSBmb3IgYSBnaXZlbiBjaGFuZ2UgdG8gdGhlXG4vLyBkb2N1bWVudC4gRnJvbSBhbmQgdG8gYXJlIGluIHByZS1jaGFuZ2UgY29vcmRpbmF0ZXMuIExlbmRpZmYgaXNcbi8vIHRoZSBhbW91bnQgb2YgbGluZXMgYWRkZWQgb3Igc3VidHJhY3RlZCBieSB0aGUgY2hhbmdlLiBUaGlzIGlzXG4vLyB1c2VkIGZvciBjaGFuZ2VzIHRoYXQgc3BhbiBtdWx0aXBsZSBsaW5lcywgb3IgY2hhbmdlIHRoZSB3YXlcbi8vIGxpbmVzIGFyZSBkaXZpZGVkIGludG8gdmlzdWFsIGxpbmVzLiByZWdMaW5lQ2hhbmdlIChiZWxvdylcbi8vIHJlZ2lzdGVycyBzaW5nbGUtbGluZSBjaGFuZ2VzLlxuZnVuY3Rpb24gcmVnQ2hhbmdlKGNtLGZyb20sdG8sbGVuZGlmZil7aWYoZnJvbT09bnVsbCl7ZnJvbT1jbS5kb2MuZmlyc3Q7fWlmKHRvPT1udWxsKXt0bz1jbS5kb2MuZmlyc3QrY20uZG9jLnNpemU7fWlmKCFsZW5kaWZmKXtsZW5kaWZmPTA7fXZhciBkaXNwbGF5PWNtLmRpc3BsYXk7aWYobGVuZGlmZiYmdG88ZGlzcGxheS52aWV3VG8mJihkaXNwbGF5LnVwZGF0ZUxpbmVOdW1iZXJzPT1udWxsfHxkaXNwbGF5LnVwZGF0ZUxpbmVOdW1iZXJzPmZyb20pKXtkaXNwbGF5LnVwZGF0ZUxpbmVOdW1iZXJzPWZyb207fWNtLmN1ck9wLnZpZXdDaGFuZ2VkPXRydWU7aWYoZnJvbT49ZGlzcGxheS52aWV3VG8pey8vIENoYW5nZSBhZnRlclxuaWYoc2F3Q29sbGFwc2VkU3BhbnMmJnZpc3VhbExpbmVObyhjbS5kb2MsZnJvbSk8ZGlzcGxheS52aWV3VG8pe3Jlc2V0VmlldyhjbSk7fX1lbHNlIGlmKHRvPD1kaXNwbGF5LnZpZXdGcm9tKXsvLyBDaGFuZ2UgYmVmb3JlXG5pZihzYXdDb2xsYXBzZWRTcGFucyYmdmlzdWFsTGluZUVuZE5vKGNtLmRvYyx0bytsZW5kaWZmKT5kaXNwbGF5LnZpZXdGcm9tKXtyZXNldFZpZXcoY20pO31lbHNle2Rpc3BsYXkudmlld0Zyb20rPWxlbmRpZmY7ZGlzcGxheS52aWV3VG8rPWxlbmRpZmY7fX1lbHNlIGlmKGZyb208PWRpc3BsYXkudmlld0Zyb20mJnRvPj1kaXNwbGF5LnZpZXdUbyl7Ly8gRnVsbCBvdmVybGFwXG5yZXNldFZpZXcoY20pO31lbHNlIGlmKGZyb208PWRpc3BsYXkudmlld0Zyb20pey8vIFRvcCBvdmVybGFwXG52YXIgY3V0PXZpZXdDdXR0aW5nUG9pbnQoY20sdG8sdG8rbGVuZGlmZiwxKTtpZihjdXQpe2Rpc3BsYXkudmlldz1kaXNwbGF5LnZpZXcuc2xpY2UoY3V0LmluZGV4KTtkaXNwbGF5LnZpZXdGcm9tPWN1dC5saW5lTjtkaXNwbGF5LnZpZXdUbys9bGVuZGlmZjt9ZWxzZXtyZXNldFZpZXcoY20pO319ZWxzZSBpZih0bz49ZGlzcGxheS52aWV3VG8pey8vIEJvdHRvbSBvdmVybGFwXG52YXIgY3V0JDE9dmlld0N1dHRpbmdQb2ludChjbSxmcm9tLGZyb20sLTEpO2lmKGN1dCQxKXtkaXNwbGF5LnZpZXc9ZGlzcGxheS52aWV3LnNsaWNlKDAsY3V0JDEuaW5kZXgpO2Rpc3BsYXkudmlld1RvPWN1dCQxLmxpbmVOO31lbHNle3Jlc2V0VmlldyhjbSk7fX1lbHNley8vIEdhcCBpbiB0aGUgbWlkZGxlXG52YXIgY3V0VG9wPXZpZXdDdXR0aW5nUG9pbnQoY20sZnJvbSxmcm9tLC0xKTt2YXIgY3V0Qm90PXZpZXdDdXR0aW5nUG9pbnQoY20sdG8sdG8rbGVuZGlmZiwxKTtpZihjdXRUb3AmJmN1dEJvdCl7ZGlzcGxheS52aWV3PWRpc3BsYXkudmlldy5zbGljZSgwLGN1dFRvcC5pbmRleCkuY29uY2F0KGJ1aWxkVmlld0FycmF5KGNtLGN1dFRvcC5saW5lTixjdXRCb3QubGluZU4pKS5jb25jYXQoZGlzcGxheS52aWV3LnNsaWNlKGN1dEJvdC5pbmRleCkpO2Rpc3BsYXkudmlld1RvKz1sZW5kaWZmO31lbHNle3Jlc2V0VmlldyhjbSk7fX12YXIgZXh0PWRpc3BsYXkuZXh0ZXJuYWxNZWFzdXJlZDtpZihleHQpe2lmKHRvPGV4dC5saW5lTil7ZXh0LmxpbmVOKz1sZW5kaWZmO31lbHNlIGlmKGZyb208ZXh0LmxpbmVOK2V4dC5zaXplKXtkaXNwbGF5LmV4dGVybmFsTWVhc3VyZWQ9bnVsbDt9fX0vLyBSZWdpc3RlciBhIGNoYW5nZSB0byBhIHNpbmdsZSBsaW5lLiBUeXBlIG11c3QgYmUgb25lIG9mIFwidGV4dFwiLFxuLy8gXCJndXR0ZXJcIiwgXCJjbGFzc1wiLCBcIndpZGdldFwiXG5mdW5jdGlvbiByZWdMaW5lQ2hhbmdlKGNtLGxpbmUsdHlwZSl7Y20uY3VyT3Audmlld0NoYW5nZWQ9dHJ1ZTt2YXIgZGlzcGxheT1jbS5kaXNwbGF5LGV4dD1jbS5kaXNwbGF5LmV4dGVybmFsTWVhc3VyZWQ7aWYoZXh0JiZsaW5lPj1leHQubGluZU4mJmxpbmU8ZXh0LmxpbmVOK2V4dC5zaXplKXtkaXNwbGF5LmV4dGVybmFsTWVhc3VyZWQ9bnVsbDt9aWYobGluZTxkaXNwbGF5LnZpZXdGcm9tfHxsaW5lPj1kaXNwbGF5LnZpZXdUbyl7cmV0dXJuO312YXIgbGluZVZpZXc9ZGlzcGxheS52aWV3W2ZpbmRWaWV3SW5kZXgoY20sbGluZSldO2lmKGxpbmVWaWV3Lm5vZGU9PW51bGwpe3JldHVybjt9dmFyIGFycj1saW5lVmlldy5jaGFuZ2VzfHwobGluZVZpZXcuY2hhbmdlcz1bXSk7aWYoaW5kZXhPZihhcnIsdHlwZSk9PS0xKXthcnIucHVzaCh0eXBlKTt9fS8vIENsZWFyIHRoZSB2aWV3LlxuZnVuY3Rpb24gcmVzZXRWaWV3KGNtKXtjbS5kaXNwbGF5LnZpZXdGcm9tPWNtLmRpc3BsYXkudmlld1RvPWNtLmRvYy5maXJzdDtjbS5kaXNwbGF5LnZpZXc9W107Y20uZGlzcGxheS52aWV3T2Zmc2V0PTA7fWZ1bmN0aW9uIHZpZXdDdXR0aW5nUG9pbnQoY20sb2xkTixuZXdOLGRpcil7dmFyIGluZGV4PWZpbmRWaWV3SW5kZXgoY20sb2xkTiksZGlmZix2aWV3PWNtLmRpc3BsYXkudmlldztpZighc2F3Q29sbGFwc2VkU3BhbnN8fG5ld049PWNtLmRvYy5maXJzdCtjbS5kb2Muc2l6ZSl7cmV0dXJue2luZGV4OmluZGV4LGxpbmVOOm5ld059O312YXIgbj1jbS5kaXNwbGF5LnZpZXdGcm9tO2Zvcih2YXIgaT0wO2k8aW5kZXg7aSsrKXtuKz12aWV3W2ldLnNpemU7fWlmKG4hPW9sZE4pe2lmKGRpcj4wKXtpZihpbmRleD09dmlldy5sZW5ndGgtMSl7cmV0dXJuIG51bGw7fWRpZmY9bit2aWV3W2luZGV4XS5zaXplLW9sZE47aW5kZXgrKzt9ZWxzZXtkaWZmPW4tb2xkTjt9b2xkTis9ZGlmZjtuZXdOKz1kaWZmO313aGlsZSh2aXN1YWxMaW5lTm8oY20uZG9jLG5ld04pIT1uZXdOKXtpZihpbmRleD09KGRpcjwwPzA6dmlldy5sZW5ndGgtMSkpe3JldHVybiBudWxsO31uZXdOKz1kaXIqdmlld1tpbmRleC0oZGlyPDA/MTowKV0uc2l6ZTtpbmRleCs9ZGlyO31yZXR1cm57aW5kZXg6aW5kZXgsbGluZU46bmV3Tn07fS8vIEZvcmNlIHRoZSB2aWV3IHRvIGNvdmVyIGEgZ2l2ZW4gcmFuZ2UsIGFkZGluZyBlbXB0eSB2aWV3IGVsZW1lbnRcbi8vIG9yIGNsaXBwaW5nIG9mZiBleGlzdGluZyBvbmVzIGFzIG5lZWRlZC5cbmZ1bmN0aW9uIGFkanVzdFZpZXcoY20sZnJvbSx0byl7dmFyIGRpc3BsYXk9Y20uZGlzcGxheSx2aWV3PWRpc3BsYXkudmlldztpZih2aWV3Lmxlbmd0aD09MHx8ZnJvbT49ZGlzcGxheS52aWV3VG98fHRvPD1kaXNwbGF5LnZpZXdGcm9tKXtkaXNwbGF5LnZpZXc9YnVpbGRWaWV3QXJyYXkoY20sZnJvbSx0byk7ZGlzcGxheS52aWV3RnJvbT1mcm9tO31lbHNle2lmKGRpc3BsYXkudmlld0Zyb20+ZnJvbSl7ZGlzcGxheS52aWV3PWJ1aWxkVmlld0FycmF5KGNtLGZyb20sZGlzcGxheS52aWV3RnJvbSkuY29uY2F0KGRpc3BsYXkudmlldyk7fWVsc2UgaWYoZGlzcGxheS52aWV3RnJvbTxmcm9tKXtkaXNwbGF5LnZpZXc9ZGlzcGxheS52aWV3LnNsaWNlKGZpbmRWaWV3SW5kZXgoY20sZnJvbSkpO31kaXNwbGF5LnZpZXdGcm9tPWZyb207aWYoZGlzcGxheS52aWV3VG88dG8pe2Rpc3BsYXkudmlldz1kaXNwbGF5LnZpZXcuY29uY2F0KGJ1aWxkVmlld0FycmF5KGNtLGRpc3BsYXkudmlld1RvLHRvKSk7fWVsc2UgaWYoZGlzcGxheS52aWV3VG8+dG8pe2Rpc3BsYXkudmlldz1kaXNwbGF5LnZpZXcuc2xpY2UoMCxmaW5kVmlld0luZGV4KGNtLHRvKSk7fX1kaXNwbGF5LnZpZXdUbz10bzt9Ly8gQ291bnQgdGhlIG51bWJlciBvZiBsaW5lcyBpbiB0aGUgdmlldyB3aG9zZSBET00gcmVwcmVzZW50YXRpb24gaXNcbi8vIG91dCBvZiBkYXRlIChvciBub25leGlzdGVudCkuXG5mdW5jdGlvbiBjb3VudERpcnR5VmlldyhjbSl7dmFyIHZpZXc9Y20uZGlzcGxheS52aWV3LGRpcnR5PTA7Zm9yKHZhciBpPTA7aTx2aWV3Lmxlbmd0aDtpKyspe3ZhciBsaW5lVmlldz12aWV3W2ldO2lmKCFsaW5lVmlldy5oaWRkZW4mJighbGluZVZpZXcubm9kZXx8bGluZVZpZXcuY2hhbmdlcykpeysrZGlydHk7fX1yZXR1cm4gZGlydHk7fS8vIEhJR0hMSUdIVCBXT1JLRVJcbmZ1bmN0aW9uIHN0YXJ0V29ya2VyKGNtLHRpbWUpe2lmKGNtLmRvYy5tb2RlLnN0YXJ0U3RhdGUmJmNtLmRvYy5mcm9udGllcjxjbS5kaXNwbGF5LnZpZXdUbyl7Y20uc3RhdGUuaGlnaGxpZ2h0LnNldCh0aW1lLGJpbmQoaGlnaGxpZ2h0V29ya2VyLGNtKSk7fX1mdW5jdGlvbiBoaWdobGlnaHRXb3JrZXIoY20pe3ZhciBkb2M9Y20uZG9jO2lmKGRvYy5mcm9udGllcjxkb2MuZmlyc3Qpe2RvYy5mcm9udGllcj1kb2MuZmlyc3Q7fWlmKGRvYy5mcm9udGllcj49Y20uZGlzcGxheS52aWV3VG8pe3JldHVybjt9dmFyIGVuZD0rbmV3IERhdGUoKStjbS5vcHRpb25zLndvcmtUaW1lO3ZhciBzdGF0ZT1jb3B5U3RhdGUoZG9jLm1vZGUsZ2V0U3RhdGVCZWZvcmUoY20sZG9jLmZyb250aWVyKSk7dmFyIGNoYW5nZWRMaW5lcz1bXTtkb2MuaXRlcihkb2MuZnJvbnRpZXIsTWF0aC5taW4oZG9jLmZpcnN0K2RvYy5zaXplLGNtLmRpc3BsYXkudmlld1RvKzUwMCksZnVuY3Rpb24obGluZSl7aWYoZG9jLmZyb250aWVyPj1jbS5kaXNwbGF5LnZpZXdGcm9tKXsvLyBWaXNpYmxlXG52YXIgb2xkU3R5bGVzPWxpbmUuc3R5bGVzLHRvb0xvbmc9bGluZS50ZXh0Lmxlbmd0aD5jbS5vcHRpb25zLm1heEhpZ2hsaWdodExlbmd0aDt2YXIgaGlnaGxpZ2h0ZWQ9aGlnaGxpZ2h0TGluZShjbSxsaW5lLHRvb0xvbmc/Y29weVN0YXRlKGRvYy5tb2RlLHN0YXRlKTpzdGF0ZSx0cnVlKTtsaW5lLnN0eWxlcz1oaWdobGlnaHRlZC5zdHlsZXM7dmFyIG9sZENscz1saW5lLnN0eWxlQ2xhc3NlcyxuZXdDbHM9aGlnaGxpZ2h0ZWQuY2xhc3NlcztpZihuZXdDbHMpe2xpbmUuc3R5bGVDbGFzc2VzPW5ld0Nsczt9ZWxzZSBpZihvbGRDbHMpe2xpbmUuc3R5bGVDbGFzc2VzPW51bGw7fXZhciBpc2NoYW5nZT0hb2xkU3R5bGVzfHxvbGRTdHlsZXMubGVuZ3RoIT1saW5lLnN0eWxlcy5sZW5ndGh8fG9sZENscyE9bmV3Q2xzJiYoIW9sZENsc3x8IW5ld0Nsc3x8b2xkQ2xzLmJnQ2xhc3MhPW5ld0Nscy5iZ0NsYXNzfHxvbGRDbHMudGV4dENsYXNzIT1uZXdDbHMudGV4dENsYXNzKTtmb3IodmFyIGk9MDshaXNjaGFuZ2UmJmk8b2xkU3R5bGVzLmxlbmd0aDsrK2kpe2lzY2hhbmdlPW9sZFN0eWxlc1tpXSE9bGluZS5zdHlsZXNbaV07fWlmKGlzY2hhbmdlKXtjaGFuZ2VkTGluZXMucHVzaChkb2MuZnJvbnRpZXIpO31saW5lLnN0YXRlQWZ0ZXI9dG9vTG9uZz9zdGF0ZTpjb3B5U3RhdGUoZG9jLm1vZGUsc3RhdGUpO31lbHNle2lmKGxpbmUudGV4dC5sZW5ndGg8PWNtLm9wdGlvbnMubWF4SGlnaGxpZ2h0TGVuZ3RoKXtwcm9jZXNzTGluZShjbSxsaW5lLnRleHQsc3RhdGUpO31saW5lLnN0YXRlQWZ0ZXI9ZG9jLmZyb250aWVyJTU9PTA/Y29weVN0YXRlKGRvYy5tb2RlLHN0YXRlKTpudWxsO30rK2RvYy5mcm9udGllcjtpZigrbmV3IERhdGUoKT5lbmQpe3N0YXJ0V29ya2VyKGNtLGNtLm9wdGlvbnMud29ya0RlbGF5KTtyZXR1cm4gdHJ1ZTt9fSk7aWYoY2hhbmdlZExpbmVzLmxlbmd0aCl7cnVuSW5PcChjbSxmdW5jdGlvbigpe2Zvcih2YXIgaT0wO2k8Y2hhbmdlZExpbmVzLmxlbmd0aDtpKyspe3JlZ0xpbmVDaGFuZ2UoY20sY2hhbmdlZExpbmVzW2ldLFwidGV4dFwiKTt9fSk7fX0vLyBESVNQTEFZIERSQVdJTkdcbmZ1bmN0aW9uIERpc3BsYXlVcGRhdGUoY20sdmlld3BvcnQsZm9yY2Upe3ZhciBkaXNwbGF5PWNtLmRpc3BsYXk7dGhpcy52aWV3cG9ydD12aWV3cG9ydDsvLyBTdG9yZSBzb21lIHZhbHVlcyB0aGF0IHdlJ2xsIG5lZWQgbGF0ZXIgKGJ1dCBkb24ndCB3YW50IHRvIGZvcmNlIGEgcmVsYXlvdXQgZm9yKVxudGhpcy52aXNpYmxlPXZpc2libGVMaW5lcyhkaXNwbGF5LGNtLmRvYyx2aWV3cG9ydCk7dGhpcy5lZGl0b3JJc0hpZGRlbj0hZGlzcGxheS53cmFwcGVyLm9mZnNldFdpZHRoO3RoaXMud3JhcHBlckhlaWdodD1kaXNwbGF5LndyYXBwZXIuY2xpZW50SGVpZ2h0O3RoaXMud3JhcHBlcldpZHRoPWRpc3BsYXkud3JhcHBlci5jbGllbnRXaWR0aDt0aGlzLm9sZERpc3BsYXlXaWR0aD1kaXNwbGF5V2lkdGgoY20pO3RoaXMuZm9yY2U9Zm9yY2U7dGhpcy5kaW1zPWdldERpbWVuc2lvbnMoY20pO3RoaXMuZXZlbnRzPVtdO31EaXNwbGF5VXBkYXRlLnByb3RvdHlwZS5zaWduYWw9ZnVuY3Rpb24oZW1pdHRlcix0eXBlKXtpZihoYXNIYW5kbGVyKGVtaXR0ZXIsdHlwZSkpe3RoaXMuZXZlbnRzLnB1c2goYXJndW1lbnRzKTt9fTtEaXNwbGF5VXBkYXRlLnByb3RvdHlwZS5maW5pc2g9ZnVuY3Rpb24oKXt2YXIgdGhpcyQxPXRoaXM7Zm9yKHZhciBpPTA7aTx0aGlzLmV2ZW50cy5sZW5ndGg7aSsrKXtzaWduYWwuYXBwbHkobnVsbCx0aGlzJDEuZXZlbnRzW2ldKTt9fTtmdW5jdGlvbiBtYXliZUNsaXBTY3JvbGxiYXJzKGNtKXt2YXIgZGlzcGxheT1jbS5kaXNwbGF5O2lmKCFkaXNwbGF5LnNjcm9sbGJhcnNDbGlwcGVkJiZkaXNwbGF5LnNjcm9sbGVyLm9mZnNldFdpZHRoKXtkaXNwbGF5Lm5hdGl2ZUJhcldpZHRoPWRpc3BsYXkuc2Nyb2xsZXIub2Zmc2V0V2lkdGgtZGlzcGxheS5zY3JvbGxlci5jbGllbnRXaWR0aDtkaXNwbGF5LmhlaWdodEZvcmNlci5zdHlsZS5oZWlnaHQ9c2Nyb2xsR2FwKGNtKStcInB4XCI7ZGlzcGxheS5zaXplci5zdHlsZS5tYXJnaW5Cb3R0b209LWRpc3BsYXkubmF0aXZlQmFyV2lkdGgrXCJweFwiO2Rpc3BsYXkuc2l6ZXIuc3R5bGUuYm9yZGVyUmlnaHRXaWR0aD1zY3JvbGxHYXAoY20pK1wicHhcIjtkaXNwbGF5LnNjcm9sbGJhcnNDbGlwcGVkPXRydWU7fX0vLyBEb2VzIHRoZSBhY3R1YWwgdXBkYXRpbmcgb2YgdGhlIGxpbmUgZGlzcGxheS4gQmFpbHMgb3V0XG4vLyAocmV0dXJuaW5nIGZhbHNlKSB3aGVuIHRoZXJlIGlzIG5vdGhpbmcgdG8gYmUgZG9uZSBhbmQgZm9yY2VkIGlzXG4vLyBmYWxzZS5cbmZ1bmN0aW9uIHVwZGF0ZURpc3BsYXlJZk5lZWRlZChjbSx1cGRhdGUpe3ZhciBkaXNwbGF5PWNtLmRpc3BsYXksZG9jPWNtLmRvYztpZih1cGRhdGUuZWRpdG9ySXNIaWRkZW4pe3Jlc2V0VmlldyhjbSk7cmV0dXJuIGZhbHNlO30vLyBCYWlsIG91dCBpZiB0aGUgdmlzaWJsZSBhcmVhIGlzIGFscmVhZHkgcmVuZGVyZWQgYW5kIG5vdGhpbmcgY2hhbmdlZC5cbmlmKCF1cGRhdGUuZm9yY2UmJnVwZGF0ZS52aXNpYmxlLmZyb20+PWRpc3BsYXkudmlld0Zyb20mJnVwZGF0ZS52aXNpYmxlLnRvPD1kaXNwbGF5LnZpZXdUbyYmKGRpc3BsYXkudXBkYXRlTGluZU51bWJlcnM9PW51bGx8fGRpc3BsYXkudXBkYXRlTGluZU51bWJlcnM+PWRpc3BsYXkudmlld1RvKSYmZGlzcGxheS5yZW5kZXJlZFZpZXc9PWRpc3BsYXkudmlldyYmY291bnREaXJ0eVZpZXcoY20pPT0wKXtyZXR1cm4gZmFsc2U7fWlmKG1heWJlVXBkYXRlTGluZU51bWJlcldpZHRoKGNtKSl7cmVzZXRWaWV3KGNtKTt1cGRhdGUuZGltcz1nZXREaW1lbnNpb25zKGNtKTt9Ly8gQ29tcHV0ZSBhIHN1aXRhYmxlIG5ldyB2aWV3cG9ydCAoZnJvbSAmIHRvKVxudmFyIGVuZD1kb2MuZmlyc3QrZG9jLnNpemU7dmFyIGZyb209TWF0aC5tYXgodXBkYXRlLnZpc2libGUuZnJvbS1jbS5vcHRpb25zLnZpZXdwb3J0TWFyZ2luLGRvYy5maXJzdCk7dmFyIHRvPU1hdGgubWluKGVuZCx1cGRhdGUudmlzaWJsZS50bytjbS5vcHRpb25zLnZpZXdwb3J0TWFyZ2luKTtpZihkaXNwbGF5LnZpZXdGcm9tPGZyb20mJmZyb20tZGlzcGxheS52aWV3RnJvbTwyMCl7ZnJvbT1NYXRoLm1heChkb2MuZmlyc3QsZGlzcGxheS52aWV3RnJvbSk7fWlmKGRpc3BsYXkudmlld1RvPnRvJiZkaXNwbGF5LnZpZXdUby10bzwyMCl7dG89TWF0aC5taW4oZW5kLGRpc3BsYXkudmlld1RvKTt9aWYoc2F3Q29sbGFwc2VkU3BhbnMpe2Zyb209dmlzdWFsTGluZU5vKGNtLmRvYyxmcm9tKTt0bz12aXN1YWxMaW5lRW5kTm8oY20uZG9jLHRvKTt9dmFyIGRpZmZlcmVudD1mcm9tIT1kaXNwbGF5LnZpZXdGcm9tfHx0byE9ZGlzcGxheS52aWV3VG98fGRpc3BsYXkubGFzdFdyYXBIZWlnaHQhPXVwZGF0ZS53cmFwcGVySGVpZ2h0fHxkaXNwbGF5Lmxhc3RXcmFwV2lkdGghPXVwZGF0ZS53cmFwcGVyV2lkdGg7YWRqdXN0VmlldyhjbSxmcm9tLHRvKTtkaXNwbGF5LnZpZXdPZmZzZXQ9aGVpZ2h0QXRMaW5lKGdldExpbmUoY20uZG9jLGRpc3BsYXkudmlld0Zyb20pKTsvLyBQb3NpdGlvbiB0aGUgbW92ZXIgZGl2IHRvIGFsaWduIHdpdGggdGhlIGN1cnJlbnQgc2Nyb2xsIHBvc2l0aW9uXG5jbS5kaXNwbGF5Lm1vdmVyLnN0eWxlLnRvcD1kaXNwbGF5LnZpZXdPZmZzZXQrXCJweFwiO3ZhciB0b1VwZGF0ZT1jb3VudERpcnR5VmlldyhjbSk7aWYoIWRpZmZlcmVudCYmdG9VcGRhdGU9PTAmJiF1cGRhdGUuZm9yY2UmJmRpc3BsYXkucmVuZGVyZWRWaWV3PT1kaXNwbGF5LnZpZXcmJihkaXNwbGF5LnVwZGF0ZUxpbmVOdW1iZXJzPT1udWxsfHxkaXNwbGF5LnVwZGF0ZUxpbmVOdW1iZXJzPj1kaXNwbGF5LnZpZXdUbykpe3JldHVybiBmYWxzZTt9Ly8gRm9yIGJpZyBjaGFuZ2VzLCB3ZSBoaWRlIHRoZSBlbmNsb3NpbmcgZWxlbWVudCBkdXJpbmcgdGhlXG4vLyB1cGRhdGUsIHNpbmNlIHRoYXQgc3BlZWRzIHVwIHRoZSBvcGVyYXRpb25zIG9uIG1vc3QgYnJvd3NlcnMuXG52YXIgZm9jdXNlZD1hY3RpdmVFbHQoKTtpZih0b1VwZGF0ZT40KXtkaXNwbGF5LmxpbmVEaXYuc3R5bGUuZGlzcGxheT1cIm5vbmVcIjt9cGF0Y2hEaXNwbGF5KGNtLGRpc3BsYXkudXBkYXRlTGluZU51bWJlcnMsdXBkYXRlLmRpbXMpO2lmKHRvVXBkYXRlPjQpe2Rpc3BsYXkubGluZURpdi5zdHlsZS5kaXNwbGF5PVwiXCI7fWRpc3BsYXkucmVuZGVyZWRWaWV3PWRpc3BsYXkudmlldzsvLyBUaGVyZSBtaWdodCBoYXZlIGJlZW4gYSB3aWRnZXQgd2l0aCBhIGZvY3VzZWQgZWxlbWVudCB0aGF0IGdvdFxuLy8gaGlkZGVuIG9yIHVwZGF0ZWQsIGlmIHNvIHJlLWZvY3VzIGl0LlxuaWYoZm9jdXNlZCYmYWN0aXZlRWx0KCkhPWZvY3VzZWQmJmZvY3VzZWQub2Zmc2V0SGVpZ2h0KXtmb2N1c2VkLmZvY3VzKCk7fS8vIFByZXZlbnQgc2VsZWN0aW9uIGFuZCBjdXJzb3JzIGZyb20gaW50ZXJmZXJpbmcgd2l0aCB0aGUgc2Nyb2xsXG4vLyB3aWR0aCBhbmQgaGVpZ2h0LlxucmVtb3ZlQ2hpbGRyZW4oZGlzcGxheS5jdXJzb3JEaXYpO3JlbW92ZUNoaWxkcmVuKGRpc3BsYXkuc2VsZWN0aW9uRGl2KTtkaXNwbGF5Lmd1dHRlcnMuc3R5bGUuaGVpZ2h0PWRpc3BsYXkuc2l6ZXIuc3R5bGUubWluSGVpZ2h0PTA7aWYoZGlmZmVyZW50KXtkaXNwbGF5Lmxhc3RXcmFwSGVpZ2h0PXVwZGF0ZS53cmFwcGVySGVpZ2h0O2Rpc3BsYXkubGFzdFdyYXBXaWR0aD11cGRhdGUud3JhcHBlcldpZHRoO3N0YXJ0V29ya2VyKGNtLDQwMCk7fWRpc3BsYXkudXBkYXRlTGluZU51bWJlcnM9bnVsbDtyZXR1cm4gdHJ1ZTt9ZnVuY3Rpb24gcG9zdFVwZGF0ZURpc3BsYXkoY20sdXBkYXRlKXt2YXIgdmlld3BvcnQ9dXBkYXRlLnZpZXdwb3J0O2Zvcih2YXIgZmlyc3Q9dHJ1ZTs7Zmlyc3Q9ZmFsc2Upe2lmKCFmaXJzdHx8IWNtLm9wdGlvbnMubGluZVdyYXBwaW5nfHx1cGRhdGUub2xkRGlzcGxheVdpZHRoPT1kaXNwbGF5V2lkdGgoY20pKXsvLyBDbGlwIGZvcmNlZCB2aWV3cG9ydCB0byBhY3R1YWwgc2Nyb2xsYWJsZSBhcmVhLlxuaWYodmlld3BvcnQmJnZpZXdwb3J0LnRvcCE9bnVsbCl7dmlld3BvcnQ9e3RvcDpNYXRoLm1pbihjbS5kb2MuaGVpZ2h0K3BhZGRpbmdWZXJ0KGNtLmRpc3BsYXkpLWRpc3BsYXlIZWlnaHQoY20pLHZpZXdwb3J0LnRvcCl9O30vLyBVcGRhdGVkIGxpbmUgaGVpZ2h0cyBtaWdodCByZXN1bHQgaW4gdGhlIGRyYXduIGFyZWEgbm90XG4vLyBhY3R1YWxseSBjb3ZlcmluZyB0aGUgdmlld3BvcnQuIEtlZXAgbG9vcGluZyB1bnRpbCBpdCBkb2VzLlxudXBkYXRlLnZpc2libGU9dmlzaWJsZUxpbmVzKGNtLmRpc3BsYXksY20uZG9jLHZpZXdwb3J0KTtpZih1cGRhdGUudmlzaWJsZS5mcm9tPj1jbS5kaXNwbGF5LnZpZXdGcm9tJiZ1cGRhdGUudmlzaWJsZS50bzw9Y20uZGlzcGxheS52aWV3VG8pe2JyZWFrO319aWYoIXVwZGF0ZURpc3BsYXlJZk5lZWRlZChjbSx1cGRhdGUpKXticmVhazt9dXBkYXRlSGVpZ2h0c0luVmlld3BvcnQoY20pO3ZhciBiYXJNZWFzdXJlPW1lYXN1cmVGb3JTY3JvbGxiYXJzKGNtKTt1cGRhdGVTZWxlY3Rpb24oY20pO3VwZGF0ZVNjcm9sbGJhcnMoY20sYmFyTWVhc3VyZSk7c2V0RG9jdW1lbnRIZWlnaHQoY20sYmFyTWVhc3VyZSk7fXVwZGF0ZS5zaWduYWwoY20sXCJ1cGRhdGVcIixjbSk7aWYoY20uZGlzcGxheS52aWV3RnJvbSE9Y20uZGlzcGxheS5yZXBvcnRlZFZpZXdGcm9tfHxjbS5kaXNwbGF5LnZpZXdUbyE9Y20uZGlzcGxheS5yZXBvcnRlZFZpZXdUbyl7dXBkYXRlLnNpZ25hbChjbSxcInZpZXdwb3J0Q2hhbmdlXCIsY20sY20uZGlzcGxheS52aWV3RnJvbSxjbS5kaXNwbGF5LnZpZXdUbyk7Y20uZGlzcGxheS5yZXBvcnRlZFZpZXdGcm9tPWNtLmRpc3BsYXkudmlld0Zyb207Y20uZGlzcGxheS5yZXBvcnRlZFZpZXdUbz1jbS5kaXNwbGF5LnZpZXdUbzt9fWZ1bmN0aW9uIHVwZGF0ZURpc3BsYXlTaW1wbGUoY20sdmlld3BvcnQpe3ZhciB1cGRhdGU9bmV3IERpc3BsYXlVcGRhdGUoY20sdmlld3BvcnQpO2lmKHVwZGF0ZURpc3BsYXlJZk5lZWRlZChjbSx1cGRhdGUpKXt1cGRhdGVIZWlnaHRzSW5WaWV3cG9ydChjbSk7cG9zdFVwZGF0ZURpc3BsYXkoY20sdXBkYXRlKTt2YXIgYmFyTWVhc3VyZT1tZWFzdXJlRm9yU2Nyb2xsYmFycyhjbSk7dXBkYXRlU2VsZWN0aW9uKGNtKTt1cGRhdGVTY3JvbGxiYXJzKGNtLGJhck1lYXN1cmUpO3NldERvY3VtZW50SGVpZ2h0KGNtLGJhck1lYXN1cmUpO3VwZGF0ZS5maW5pc2goKTt9fS8vIFN5bmMgdGhlIGFjdHVhbCBkaXNwbGF5IERPTSBzdHJ1Y3R1cmUgd2l0aCBkaXNwbGF5LnZpZXcsIHJlbW92aW5nXG4vLyBub2RlcyBmb3IgbGluZXMgdGhhdCBhcmUgbm8gbG9uZ2VyIGluIHZpZXcsIGFuZCBjcmVhdGluZyB0aGUgb25lc1xuLy8gdGhhdCBhcmUgbm90IHRoZXJlIHlldCwgYW5kIHVwZGF0aW5nIHRoZSBvbmVzIHRoYXQgYXJlIG91dCBvZlxuLy8gZGF0ZS5cbmZ1bmN0aW9uIHBhdGNoRGlzcGxheShjbSx1cGRhdGVOdW1iZXJzRnJvbSxkaW1zKXt2YXIgZGlzcGxheT1jbS5kaXNwbGF5LGxpbmVOdW1iZXJzPWNtLm9wdGlvbnMubGluZU51bWJlcnM7dmFyIGNvbnRhaW5lcj1kaXNwbGF5LmxpbmVEaXYsY3VyPWNvbnRhaW5lci5maXJzdENoaWxkO2Z1bmN0aW9uIHJtKG5vZGUpe3ZhciBuZXh0PW5vZGUubmV4dFNpYmxpbmc7Ly8gV29ya3MgYXJvdW5kIGEgdGhyb3ctc2Nyb2xsIGJ1ZyBpbiBPUyBYIFdlYmtpdFxuaWYod2Via2l0JiZtYWMmJmNtLmRpc3BsYXkuY3VycmVudFdoZWVsVGFyZ2V0PT1ub2RlKXtub2RlLnN0eWxlLmRpc3BsYXk9XCJub25lXCI7fWVsc2V7bm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG5vZGUpO31yZXR1cm4gbmV4dDt9dmFyIHZpZXc9ZGlzcGxheS52aWV3LGxpbmVOPWRpc3BsYXkudmlld0Zyb207Ly8gTG9vcCBvdmVyIHRoZSBlbGVtZW50cyBpbiB0aGUgdmlldywgc3luY2luZyBjdXIgKHRoZSBET00gbm9kZXNcbi8vIGluIGRpc3BsYXkubGluZURpdikgd2l0aCB0aGUgdmlldyBhcyB3ZSBnby5cbmZvcih2YXIgaT0wO2k8dmlldy5sZW5ndGg7aSsrKXt2YXIgbGluZVZpZXc9dmlld1tpXTtpZihsaW5lVmlldy5oaWRkZW4pe31lbHNlIGlmKCFsaW5lVmlldy5ub2RlfHxsaW5lVmlldy5ub2RlLnBhcmVudE5vZGUhPWNvbnRhaW5lcil7Ly8gTm90IGRyYXduIHlldFxudmFyIG5vZGU9YnVpbGRMaW5lRWxlbWVudChjbSxsaW5lVmlldyxsaW5lTixkaW1zKTtjb250YWluZXIuaW5zZXJ0QmVmb3JlKG5vZGUsY3VyKTt9ZWxzZXsvLyBBbHJlYWR5IGRyYXduXG53aGlsZShjdXIhPWxpbmVWaWV3Lm5vZGUpe2N1cj1ybShjdXIpO312YXIgdXBkYXRlTnVtYmVyPWxpbmVOdW1iZXJzJiZ1cGRhdGVOdW1iZXJzRnJvbSE9bnVsbCYmdXBkYXRlTnVtYmVyc0Zyb208PWxpbmVOJiZsaW5lVmlldy5saW5lTnVtYmVyO2lmKGxpbmVWaWV3LmNoYW5nZXMpe2lmKGluZGV4T2YobGluZVZpZXcuY2hhbmdlcyxcImd1dHRlclwiKT4tMSl7dXBkYXRlTnVtYmVyPWZhbHNlO311cGRhdGVMaW5lRm9yQ2hhbmdlcyhjbSxsaW5lVmlldyxsaW5lTixkaW1zKTt9aWYodXBkYXRlTnVtYmVyKXtyZW1vdmVDaGlsZHJlbihsaW5lVmlldy5saW5lTnVtYmVyKTtsaW5lVmlldy5saW5lTnVtYmVyLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGxpbmVOdW1iZXJGb3IoY20ub3B0aW9ucyxsaW5lTikpKTt9Y3VyPWxpbmVWaWV3Lm5vZGUubmV4dFNpYmxpbmc7fWxpbmVOKz1saW5lVmlldy5zaXplO313aGlsZShjdXIpe2N1cj1ybShjdXIpO319ZnVuY3Rpb24gdXBkYXRlR3V0dGVyU3BhY2UoY20pe3ZhciB3aWR0aD1jbS5kaXNwbGF5Lmd1dHRlcnMub2Zmc2V0V2lkdGg7Y20uZGlzcGxheS5zaXplci5zdHlsZS5tYXJnaW5MZWZ0PXdpZHRoK1wicHhcIjt9ZnVuY3Rpb24gc2V0RG9jdW1lbnRIZWlnaHQoY20sbWVhc3VyZSl7Y20uZGlzcGxheS5zaXplci5zdHlsZS5taW5IZWlnaHQ9bWVhc3VyZS5kb2NIZWlnaHQrXCJweFwiO2NtLmRpc3BsYXkuaGVpZ2h0Rm9yY2VyLnN0eWxlLnRvcD1tZWFzdXJlLmRvY0hlaWdodCtcInB4XCI7Y20uZGlzcGxheS5ndXR0ZXJzLnN0eWxlLmhlaWdodD1tZWFzdXJlLmRvY0hlaWdodCtjbS5kaXNwbGF5LmJhckhlaWdodCtzY3JvbGxHYXAoY20pK1wicHhcIjt9Ly8gUmVidWlsZCB0aGUgZ3V0dGVyIGVsZW1lbnRzLCBlbnN1cmUgdGhlIG1hcmdpbiB0byB0aGUgbGVmdCBvZiB0aGVcbi8vIGNvZGUgbWF0Y2hlcyB0aGVpciB3aWR0aC5cbmZ1bmN0aW9uIHVwZGF0ZUd1dHRlcnMoY20pe3ZhciBndXR0ZXJzPWNtLmRpc3BsYXkuZ3V0dGVycyxzcGVjcz1jbS5vcHRpb25zLmd1dHRlcnM7cmVtb3ZlQ2hpbGRyZW4oZ3V0dGVycyk7dmFyIGk9MDtmb3IoO2k8c3BlY3MubGVuZ3RoOysraSl7dmFyIGd1dHRlckNsYXNzPXNwZWNzW2ldO3ZhciBnRWx0PWd1dHRlcnMuYXBwZW5kQ2hpbGQoZWx0KFwiZGl2XCIsbnVsbCxcIkNvZGVNaXJyb3ItZ3V0dGVyIFwiK2d1dHRlckNsYXNzKSk7aWYoZ3V0dGVyQ2xhc3M9PVwiQ29kZU1pcnJvci1saW5lbnVtYmVyc1wiKXtjbS5kaXNwbGF5LmxpbmVHdXR0ZXI9Z0VsdDtnRWx0LnN0eWxlLndpZHRoPShjbS5kaXNwbGF5LmxpbmVOdW1XaWR0aHx8MSkrXCJweFwiO319Z3V0dGVycy5zdHlsZS5kaXNwbGF5PWk/XCJcIjpcIm5vbmVcIjt1cGRhdGVHdXR0ZXJTcGFjZShjbSk7fS8vIE1ha2Ugc3VyZSB0aGUgZ3V0dGVycyBvcHRpb25zIGNvbnRhaW5zIHRoZSBlbGVtZW50XG4vLyBcIkNvZGVNaXJyb3ItbGluZW51bWJlcnNcIiB3aGVuIHRoZSBsaW5lTnVtYmVycyBvcHRpb24gaXMgdHJ1ZS5cbmZ1bmN0aW9uIHNldEd1dHRlcnNGb3JMaW5lTnVtYmVycyhvcHRpb25zKXt2YXIgZm91bmQ9aW5kZXhPZihvcHRpb25zLmd1dHRlcnMsXCJDb2RlTWlycm9yLWxpbmVudW1iZXJzXCIpO2lmKGZvdW5kPT0tMSYmb3B0aW9ucy5saW5lTnVtYmVycyl7b3B0aW9ucy5ndXR0ZXJzPW9wdGlvbnMuZ3V0dGVycy5jb25jYXQoW1wiQ29kZU1pcnJvci1saW5lbnVtYmVyc1wiXSk7fWVsc2UgaWYoZm91bmQ+LTEmJiFvcHRpb25zLmxpbmVOdW1iZXJzKXtvcHRpb25zLmd1dHRlcnM9b3B0aW9ucy5ndXR0ZXJzLnNsaWNlKDApO29wdGlvbnMuZ3V0dGVycy5zcGxpY2UoZm91bmQsMSk7fX0vLyBTZWxlY3Rpb24gb2JqZWN0cyBhcmUgaW1tdXRhYmxlLiBBIG5ldyBvbmUgaXMgY3JlYXRlZCBldmVyeSB0aW1lXG4vLyB0aGUgc2VsZWN0aW9uIGNoYW5nZXMuIEEgc2VsZWN0aW9uIGlzIG9uZSBvciBtb3JlIG5vbi1vdmVybGFwcGluZ1xuLy8gKGFuZCBub24tdG91Y2hpbmcpIHJhbmdlcywgc29ydGVkLCBhbmQgYW4gaW50ZWdlciB0aGF0IGluZGljYXRlc1xuLy8gd2hpY2ggb25lIGlzIHRoZSBwcmltYXJ5IHNlbGVjdGlvbiAodGhlIG9uZSB0aGF0J3Mgc2Nyb2xsZWQgaW50b1xuLy8gdmlldywgdGhhdCBnZXRDdXJzb3IgcmV0dXJucywgZXRjKS5cbmZ1bmN0aW9uIFNlbGVjdGlvbihyYW5nZXMscHJpbUluZGV4KXt0aGlzLnJhbmdlcz1yYW5nZXM7dGhpcy5wcmltSW5kZXg9cHJpbUluZGV4O31TZWxlY3Rpb24ucHJvdG90eXBlPXtwcmltYXJ5OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmFuZ2VzW3RoaXMucHJpbUluZGV4XTt9LGVxdWFsczpmdW5jdGlvbihvdGhlcil7dmFyIHRoaXMkMT10aGlzO2lmKG90aGVyPT10aGlzKXtyZXR1cm4gdHJ1ZTt9aWYob3RoZXIucHJpbUluZGV4IT10aGlzLnByaW1JbmRleHx8b3RoZXIucmFuZ2VzLmxlbmd0aCE9dGhpcy5yYW5nZXMubGVuZ3RoKXtyZXR1cm4gZmFsc2U7fWZvcih2YXIgaT0wO2k8dGhpcy5yYW5nZXMubGVuZ3RoO2krKyl7dmFyIGhlcmU9dGhpcyQxLnJhbmdlc1tpXSx0aGVyZT1vdGhlci5yYW5nZXNbaV07aWYoY21wKGhlcmUuYW5jaG9yLHRoZXJlLmFuY2hvcikhPTB8fGNtcChoZXJlLmhlYWQsdGhlcmUuaGVhZCkhPTApe3JldHVybiBmYWxzZTt9fXJldHVybiB0cnVlO30sZGVlcENvcHk6ZnVuY3Rpb24oKXt2YXIgdGhpcyQxPXRoaXM7dmFyIG91dD1bXTtmb3IodmFyIGk9MDtpPHRoaXMucmFuZ2VzLmxlbmd0aDtpKyspe291dFtpXT1uZXcgUmFuZ2UoY29weVBvcyh0aGlzJDEucmFuZ2VzW2ldLmFuY2hvciksY29weVBvcyh0aGlzJDEucmFuZ2VzW2ldLmhlYWQpKTt9cmV0dXJuIG5ldyBTZWxlY3Rpb24ob3V0LHRoaXMucHJpbUluZGV4KTt9LHNvbWV0aGluZ1NlbGVjdGVkOmZ1bmN0aW9uKCl7dmFyIHRoaXMkMT10aGlzO2Zvcih2YXIgaT0wO2k8dGhpcy5yYW5nZXMubGVuZ3RoO2krKyl7aWYoIXRoaXMkMS5yYW5nZXNbaV0uZW1wdHkoKSl7cmV0dXJuIHRydWU7fX1yZXR1cm4gZmFsc2U7fSxjb250YWluczpmdW5jdGlvbihwb3MsZW5kKXt2YXIgdGhpcyQxPXRoaXM7aWYoIWVuZCl7ZW5kPXBvczt9Zm9yKHZhciBpPTA7aTx0aGlzLnJhbmdlcy5sZW5ndGg7aSsrKXt2YXIgcmFuZ2U9dGhpcyQxLnJhbmdlc1tpXTtpZihjbXAoZW5kLHJhbmdlLmZyb20oKSk+PTAmJmNtcChwb3MscmFuZ2UudG8oKSk8PTApe3JldHVybiBpO319cmV0dXJuLTE7fX07ZnVuY3Rpb24gUmFuZ2UoYW5jaG9yLGhlYWQpe3RoaXMuYW5jaG9yPWFuY2hvcjt0aGlzLmhlYWQ9aGVhZDt9UmFuZ2UucHJvdG90eXBlPXtmcm9tOmZ1bmN0aW9uKCl7cmV0dXJuIG1pblBvcyh0aGlzLmFuY2hvcix0aGlzLmhlYWQpO30sdG86ZnVuY3Rpb24oKXtyZXR1cm4gbWF4UG9zKHRoaXMuYW5jaG9yLHRoaXMuaGVhZCk7fSxlbXB0eTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmhlYWQubGluZT09dGhpcy5hbmNob3IubGluZSYmdGhpcy5oZWFkLmNoPT10aGlzLmFuY2hvci5jaDt9fTsvLyBUYWtlIGFuIHVuc29ydGVkLCBwb3RlbnRpYWxseSBvdmVybGFwcGluZyBzZXQgb2YgcmFuZ2VzLCBhbmRcbi8vIGJ1aWxkIGEgc2VsZWN0aW9uIG91dCBvZiBpdC4gJ0NvbnN1bWVzJyByYW5nZXMgYXJyYXkgKG1vZGlmeWluZ1xuLy8gaXQpLlxuZnVuY3Rpb24gbm9ybWFsaXplU2VsZWN0aW9uKHJhbmdlcyxwcmltSW5kZXgpe3ZhciBwcmltPXJhbmdlc1twcmltSW5kZXhdO3Jhbmdlcy5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGNtcChhLmZyb20oKSxiLmZyb20oKSk7fSk7cHJpbUluZGV4PWluZGV4T2YocmFuZ2VzLHByaW0pO2Zvcih2YXIgaT0xO2k8cmFuZ2VzLmxlbmd0aDtpKyspe3ZhciBjdXI9cmFuZ2VzW2ldLHByZXY9cmFuZ2VzW2ktMV07aWYoY21wKHByZXYudG8oKSxjdXIuZnJvbSgpKT49MCl7dmFyIGZyb209bWluUG9zKHByZXYuZnJvbSgpLGN1ci5mcm9tKCkpLHRvPW1heFBvcyhwcmV2LnRvKCksY3VyLnRvKCkpO3ZhciBpbnY9cHJldi5lbXB0eSgpP2N1ci5mcm9tKCk9PWN1ci5oZWFkOnByZXYuZnJvbSgpPT1wcmV2LmhlYWQ7aWYoaTw9cHJpbUluZGV4KXstLXByaW1JbmRleDt9cmFuZ2VzLnNwbGljZSgtLWksMixuZXcgUmFuZ2UoaW52P3RvOmZyb20saW52P2Zyb206dG8pKTt9fXJldHVybiBuZXcgU2VsZWN0aW9uKHJhbmdlcyxwcmltSW5kZXgpO31mdW5jdGlvbiBzaW1wbGVTZWxlY3Rpb24oYW5jaG9yLGhlYWQpe3JldHVybiBuZXcgU2VsZWN0aW9uKFtuZXcgUmFuZ2UoYW5jaG9yLGhlYWR8fGFuY2hvcildLDApO30vLyBDb21wdXRlIHRoZSBwb3NpdGlvbiBvZiB0aGUgZW5kIG9mIGEgY2hhbmdlIChpdHMgJ3RvJyBwcm9wZXJ0eVxuLy8gcmVmZXJzIHRvIHRoZSBwcmUtY2hhbmdlIGVuZCkuXG5mdW5jdGlvbiBjaGFuZ2VFbmQoY2hhbmdlKXtpZighY2hhbmdlLnRleHQpe3JldHVybiBjaGFuZ2UudG87fXJldHVybiBQb3MoY2hhbmdlLmZyb20ubGluZStjaGFuZ2UudGV4dC5sZW5ndGgtMSxsc3QoY2hhbmdlLnRleHQpLmxlbmd0aCsoY2hhbmdlLnRleHQubGVuZ3RoPT0xP2NoYW5nZS5mcm9tLmNoOjApKTt9Ly8gQWRqdXN0IGEgcG9zaXRpb24gdG8gcmVmZXIgdG8gdGhlIHBvc3QtY2hhbmdlIHBvc2l0aW9uIG9mIHRoZVxuLy8gc2FtZSB0ZXh0LCBvciB0aGUgZW5kIG9mIHRoZSBjaGFuZ2UgaWYgdGhlIGNoYW5nZSBjb3ZlcnMgaXQuXG5mdW5jdGlvbiBhZGp1c3RGb3JDaGFuZ2UocG9zLGNoYW5nZSl7aWYoY21wKHBvcyxjaGFuZ2UuZnJvbSk8MCl7cmV0dXJuIHBvczt9aWYoY21wKHBvcyxjaGFuZ2UudG8pPD0wKXtyZXR1cm4gY2hhbmdlRW5kKGNoYW5nZSk7fXZhciBsaW5lPXBvcy5saW5lK2NoYW5nZS50ZXh0Lmxlbmd0aC0oY2hhbmdlLnRvLmxpbmUtY2hhbmdlLmZyb20ubGluZSktMSxjaD1wb3MuY2g7aWYocG9zLmxpbmU9PWNoYW5nZS50by5saW5lKXtjaCs9Y2hhbmdlRW5kKGNoYW5nZSkuY2gtY2hhbmdlLnRvLmNoO31yZXR1cm4gUG9zKGxpbmUsY2gpO31mdW5jdGlvbiBjb21wdXRlU2VsQWZ0ZXJDaGFuZ2UoZG9jLGNoYW5nZSl7dmFyIG91dD1bXTtmb3IodmFyIGk9MDtpPGRvYy5zZWwucmFuZ2VzLmxlbmd0aDtpKyspe3ZhciByYW5nZT1kb2Muc2VsLnJhbmdlc1tpXTtvdXQucHVzaChuZXcgUmFuZ2UoYWRqdXN0Rm9yQ2hhbmdlKHJhbmdlLmFuY2hvcixjaGFuZ2UpLGFkanVzdEZvckNoYW5nZShyYW5nZS5oZWFkLGNoYW5nZSkpKTt9cmV0dXJuIG5vcm1hbGl6ZVNlbGVjdGlvbihvdXQsZG9jLnNlbC5wcmltSW5kZXgpO31mdW5jdGlvbiBvZmZzZXRQb3MocG9zLG9sZCxudyl7aWYocG9zLmxpbmU9PW9sZC5saW5lKXtyZXR1cm4gUG9zKG53LmxpbmUscG9zLmNoLW9sZC5jaCtudy5jaCk7fWVsc2V7cmV0dXJuIFBvcyhudy5saW5lKyhwb3MubGluZS1vbGQubGluZSkscG9zLmNoKTt9fS8vIFVzZWQgYnkgcmVwbGFjZVNlbGVjdGlvbnMgdG8gYWxsb3cgbW92aW5nIHRoZSBzZWxlY3Rpb24gdG8gdGhlXG4vLyBzdGFydCBvciBhcm91bmQgdGhlIHJlcGxhY2VkIHRlc3QuIEhpbnQgbWF5IGJlIFwic3RhcnRcIiBvciBcImFyb3VuZFwiLlxuZnVuY3Rpb24gY29tcHV0ZVJlcGxhY2VkU2VsKGRvYyxjaGFuZ2VzLGhpbnQpe3ZhciBvdXQ9W107dmFyIG9sZFByZXY9UG9zKGRvYy5maXJzdCwwKSxuZXdQcmV2PW9sZFByZXY7Zm9yKHZhciBpPTA7aTxjaGFuZ2VzLmxlbmd0aDtpKyspe3ZhciBjaGFuZ2U9Y2hhbmdlc1tpXTt2YXIgZnJvbT1vZmZzZXRQb3MoY2hhbmdlLmZyb20sb2xkUHJldixuZXdQcmV2KTt2YXIgdG89b2Zmc2V0UG9zKGNoYW5nZUVuZChjaGFuZ2UpLG9sZFByZXYsbmV3UHJldik7b2xkUHJldj1jaGFuZ2UudG87bmV3UHJldj10bztpZihoaW50PT1cImFyb3VuZFwiKXt2YXIgcmFuZ2U9ZG9jLnNlbC5yYW5nZXNbaV0saW52PWNtcChyYW5nZS5oZWFkLHJhbmdlLmFuY2hvcik8MDtvdXRbaV09bmV3IFJhbmdlKGludj90bzpmcm9tLGludj9mcm9tOnRvKTt9ZWxzZXtvdXRbaV09bmV3IFJhbmdlKGZyb20sZnJvbSk7fX1yZXR1cm4gbmV3IFNlbGVjdGlvbihvdXQsZG9jLnNlbC5wcmltSW5kZXgpO30vLyBVc2VkIHRvIGdldCB0aGUgZWRpdG9yIGludG8gYSBjb25zaXN0ZW50IHN0YXRlIGFnYWluIHdoZW4gb3B0aW9ucyBjaGFuZ2UuXG5mdW5jdGlvbiBsb2FkTW9kZShjbSl7Y20uZG9jLm1vZGU9Z2V0TW9kZShjbS5vcHRpb25zLGNtLmRvYy5tb2RlT3B0aW9uKTtyZXNldE1vZGVTdGF0ZShjbSk7fWZ1bmN0aW9uIHJlc2V0TW9kZVN0YXRlKGNtKXtjbS5kb2MuaXRlcihmdW5jdGlvbihsaW5lKXtpZihsaW5lLnN0YXRlQWZ0ZXIpe2xpbmUuc3RhdGVBZnRlcj1udWxsO31pZihsaW5lLnN0eWxlcyl7bGluZS5zdHlsZXM9bnVsbDt9fSk7Y20uZG9jLmZyb250aWVyPWNtLmRvYy5maXJzdDtzdGFydFdvcmtlcihjbSwxMDApO2NtLnN0YXRlLm1vZGVHZW4rKztpZihjbS5jdXJPcCl7cmVnQ2hhbmdlKGNtKTt9fS8vIERPQ1VNRU5UIERBVEEgU1RSVUNUVVJFXG4vLyBCeSBkZWZhdWx0LCB1cGRhdGVzIHRoYXQgc3RhcnQgYW5kIGVuZCBhdCB0aGUgYmVnaW5uaW5nIG9mIGEgbGluZVxuLy8gYXJlIHRyZWF0ZWQgc3BlY2lhbGx5LCBpbiBvcmRlciB0byBtYWtlIHRoZSBhc3NvY2lhdGlvbiBvZiBsaW5lXG4vLyB3aWRnZXRzIGFuZCBtYXJrZXIgZWxlbWVudHMgd2l0aCB0aGUgdGV4dCBiZWhhdmUgbW9yZSBpbnR1aXRpdmUuXG5mdW5jdGlvbiBpc1dob2xlTGluZVVwZGF0ZShkb2MsY2hhbmdlKXtyZXR1cm4gY2hhbmdlLmZyb20uY2g9PTAmJmNoYW5nZS50by5jaD09MCYmbHN0KGNoYW5nZS50ZXh0KT09XCJcIiYmKCFkb2MuY218fGRvYy5jbS5vcHRpb25zLndob2xlTGluZVVwZGF0ZUJlZm9yZSk7fS8vIFBlcmZvcm0gYSBjaGFuZ2Ugb24gdGhlIGRvY3VtZW50IGRhdGEgc3RydWN0dXJlLlxuZnVuY3Rpb24gdXBkYXRlRG9jKGRvYyxjaGFuZ2UsbWFya2VkU3BhbnMsZXN0aW1hdGVIZWlnaHQpe2Z1bmN0aW9uIHNwYW5zRm9yKG4pe3JldHVybiBtYXJrZWRTcGFucz9tYXJrZWRTcGFuc1tuXTpudWxsO31mdW5jdGlvbiB1cGRhdGUobGluZSx0ZXh0LHNwYW5zKXt1cGRhdGVMaW5lKGxpbmUsdGV4dCxzcGFucyxlc3RpbWF0ZUhlaWdodCk7c2lnbmFsTGF0ZXIobGluZSxcImNoYW5nZVwiLGxpbmUsY2hhbmdlKTt9ZnVuY3Rpb24gbGluZXNGb3Ioc3RhcnQsZW5kKXt2YXIgcmVzdWx0PVtdO2Zvcih2YXIgaT1zdGFydDtpPGVuZDsrK2kpe3Jlc3VsdC5wdXNoKG5ldyBMaW5lKHRleHRbaV0sc3BhbnNGb3IoaSksZXN0aW1hdGVIZWlnaHQpKTt9cmV0dXJuIHJlc3VsdDt9dmFyIGZyb209Y2hhbmdlLmZyb20sdG89Y2hhbmdlLnRvLHRleHQ9Y2hhbmdlLnRleHQ7dmFyIGZpcnN0TGluZT1nZXRMaW5lKGRvYyxmcm9tLmxpbmUpLGxhc3RMaW5lPWdldExpbmUoZG9jLHRvLmxpbmUpO3ZhciBsYXN0VGV4dD1sc3QodGV4dCksbGFzdFNwYW5zPXNwYW5zRm9yKHRleHQubGVuZ3RoLTEpLG5saW5lcz10by5saW5lLWZyb20ubGluZTsvLyBBZGp1c3QgdGhlIGxpbmUgc3RydWN0dXJlXG5pZihjaGFuZ2UuZnVsbCl7ZG9jLmluc2VydCgwLGxpbmVzRm9yKDAsdGV4dC5sZW5ndGgpKTtkb2MucmVtb3ZlKHRleHQubGVuZ3RoLGRvYy5zaXplLXRleHQubGVuZ3RoKTt9ZWxzZSBpZihpc1dob2xlTGluZVVwZGF0ZShkb2MsY2hhbmdlKSl7Ly8gVGhpcyBpcyBhIHdob2xlLWxpbmUgcmVwbGFjZS4gVHJlYXRlZCBzcGVjaWFsbHkgdG8gbWFrZVxuLy8gc3VyZSBsaW5lIG9iamVjdHMgbW92ZSB0aGUgd2F5IHRoZXkgYXJlIHN1cHBvc2VkIHRvLlxudmFyIGFkZGVkPWxpbmVzRm9yKDAsdGV4dC5sZW5ndGgtMSk7dXBkYXRlKGxhc3RMaW5lLGxhc3RMaW5lLnRleHQsbGFzdFNwYW5zKTtpZihubGluZXMpe2RvYy5yZW1vdmUoZnJvbS5saW5lLG5saW5lcyk7fWlmKGFkZGVkLmxlbmd0aCl7ZG9jLmluc2VydChmcm9tLmxpbmUsYWRkZWQpO319ZWxzZSBpZihmaXJzdExpbmU9PWxhc3RMaW5lKXtpZih0ZXh0Lmxlbmd0aD09MSl7dXBkYXRlKGZpcnN0TGluZSxmaXJzdExpbmUudGV4dC5zbGljZSgwLGZyb20uY2gpK2xhc3RUZXh0K2ZpcnN0TGluZS50ZXh0LnNsaWNlKHRvLmNoKSxsYXN0U3BhbnMpO31lbHNle3ZhciBhZGRlZCQxPWxpbmVzRm9yKDEsdGV4dC5sZW5ndGgtMSk7YWRkZWQkMS5wdXNoKG5ldyBMaW5lKGxhc3RUZXh0K2ZpcnN0TGluZS50ZXh0LnNsaWNlKHRvLmNoKSxsYXN0U3BhbnMsZXN0aW1hdGVIZWlnaHQpKTt1cGRhdGUoZmlyc3RMaW5lLGZpcnN0TGluZS50ZXh0LnNsaWNlKDAsZnJvbS5jaCkrdGV4dFswXSxzcGFuc0ZvcigwKSk7ZG9jLmluc2VydChmcm9tLmxpbmUrMSxhZGRlZCQxKTt9fWVsc2UgaWYodGV4dC5sZW5ndGg9PTEpe3VwZGF0ZShmaXJzdExpbmUsZmlyc3RMaW5lLnRleHQuc2xpY2UoMCxmcm9tLmNoKSt0ZXh0WzBdK2xhc3RMaW5lLnRleHQuc2xpY2UodG8uY2gpLHNwYW5zRm9yKDApKTtkb2MucmVtb3ZlKGZyb20ubGluZSsxLG5saW5lcyk7fWVsc2V7dXBkYXRlKGZpcnN0TGluZSxmaXJzdExpbmUudGV4dC5zbGljZSgwLGZyb20uY2gpK3RleHRbMF0sc3BhbnNGb3IoMCkpO3VwZGF0ZShsYXN0TGluZSxsYXN0VGV4dCtsYXN0TGluZS50ZXh0LnNsaWNlKHRvLmNoKSxsYXN0U3BhbnMpO3ZhciBhZGRlZCQyPWxpbmVzRm9yKDEsdGV4dC5sZW5ndGgtMSk7aWYobmxpbmVzPjEpe2RvYy5yZW1vdmUoZnJvbS5saW5lKzEsbmxpbmVzLTEpO31kb2MuaW5zZXJ0KGZyb20ubGluZSsxLGFkZGVkJDIpO31zaWduYWxMYXRlcihkb2MsXCJjaGFuZ2VcIixkb2MsY2hhbmdlKTt9Ly8gQ2FsbCBmIGZvciBhbGwgbGlua2VkIGRvY3VtZW50cy5cbmZ1bmN0aW9uIGxpbmtlZERvY3MoZG9jLGYsc2hhcmVkSGlzdE9ubHkpe2Z1bmN0aW9uIHByb3BhZ2F0ZShkb2Msc2tpcCxzaGFyZWRIaXN0KXtpZihkb2MubGlua2VkKXtmb3IodmFyIGk9MDtpPGRvYy5saW5rZWQubGVuZ3RoOysraSl7dmFyIHJlbD1kb2MubGlua2VkW2ldO2lmKHJlbC5kb2M9PXNraXApe2NvbnRpbnVlO312YXIgc2hhcmVkPXNoYXJlZEhpc3QmJnJlbC5zaGFyZWRIaXN0O2lmKHNoYXJlZEhpc3RPbmx5JiYhc2hhcmVkKXtjb250aW51ZTt9ZihyZWwuZG9jLHNoYXJlZCk7cHJvcGFnYXRlKHJlbC5kb2MsZG9jLHNoYXJlZCk7fX19cHJvcGFnYXRlKGRvYyxudWxsLHRydWUpO30vLyBBdHRhY2ggYSBkb2N1bWVudCB0byBhbiBlZGl0b3IuXG5mdW5jdGlvbiBhdHRhY2hEb2MoY20sZG9jKXtpZihkb2MuY20pe3Rocm93IG5ldyBFcnJvcihcIlRoaXMgZG9jdW1lbnQgaXMgYWxyZWFkeSBpbiB1c2UuXCIpO31jbS5kb2M9ZG9jO2RvYy5jbT1jbTtlc3RpbWF0ZUxpbmVIZWlnaHRzKGNtKTtsb2FkTW9kZShjbSk7aWYoIWNtLm9wdGlvbnMubGluZVdyYXBwaW5nKXtmaW5kTWF4TGluZShjbSk7fWNtLm9wdGlvbnMubW9kZT1kb2MubW9kZU9wdGlvbjtyZWdDaGFuZ2UoY20pO31mdW5jdGlvbiBIaXN0b3J5KHN0YXJ0R2VuKXsvLyBBcnJheXMgb2YgY2hhbmdlIGV2ZW50cyBhbmQgc2VsZWN0aW9ucy4gRG9pbmcgc29tZXRoaW5nIGFkZHMgYW5cbi8vIGV2ZW50IHRvIGRvbmUgYW5kIGNsZWFycyB1bmRvLiBVbmRvaW5nIG1vdmVzIGV2ZW50cyBmcm9tIGRvbmVcbi8vIHRvIHVuZG9uZSwgcmVkb2luZyBtb3ZlcyB0aGVtIGluIHRoZSBvdGhlciBkaXJlY3Rpb24uXG50aGlzLmRvbmU9W107dGhpcy51bmRvbmU9W107dGhpcy51bmRvRGVwdGg9SW5maW5pdHk7Ly8gVXNlZCB0byB0cmFjayB3aGVuIGNoYW5nZXMgY2FuIGJlIG1lcmdlZCBpbnRvIGEgc2luZ2xlIHVuZG9cbi8vIGV2ZW50XG50aGlzLmxhc3RNb2RUaW1lPXRoaXMubGFzdFNlbFRpbWU9MDt0aGlzLmxhc3RPcD10aGlzLmxhc3RTZWxPcD1udWxsO3RoaXMubGFzdE9yaWdpbj10aGlzLmxhc3RTZWxPcmlnaW49bnVsbDsvLyBVc2VkIGJ5IHRoZSBpc0NsZWFuKCkgbWV0aG9kXG50aGlzLmdlbmVyYXRpb249dGhpcy5tYXhHZW5lcmF0aW9uPXN0YXJ0R2VufHwxO30vLyBDcmVhdGUgYSBoaXN0b3J5IGNoYW5nZSBldmVudCBmcm9tIGFuIHVwZGF0ZURvYy1zdHlsZSBjaGFuZ2Vcbi8vIG9iamVjdC5cbmZ1bmN0aW9uIGhpc3RvcnlDaGFuZ2VGcm9tQ2hhbmdlKGRvYyxjaGFuZ2Upe3ZhciBoaXN0Q2hhbmdlPXtmcm9tOmNvcHlQb3MoY2hhbmdlLmZyb20pLHRvOmNoYW5nZUVuZChjaGFuZ2UpLHRleHQ6Z2V0QmV0d2Vlbihkb2MsY2hhbmdlLmZyb20sY2hhbmdlLnRvKX07YXR0YWNoTG9jYWxTcGFucyhkb2MsaGlzdENoYW5nZSxjaGFuZ2UuZnJvbS5saW5lLGNoYW5nZS50by5saW5lKzEpO2xpbmtlZERvY3MoZG9jLGZ1bmN0aW9uKGRvYyl7cmV0dXJuIGF0dGFjaExvY2FsU3BhbnMoZG9jLGhpc3RDaGFuZ2UsY2hhbmdlLmZyb20ubGluZSxjaGFuZ2UudG8ubGluZSsxKTt9LHRydWUpO3JldHVybiBoaXN0Q2hhbmdlO30vLyBQb3AgYWxsIHNlbGVjdGlvbiBldmVudHMgb2ZmIHRoZSBlbmQgb2YgYSBoaXN0b3J5IGFycmF5LiBTdG9wIGF0XG4vLyBhIGNoYW5nZSBldmVudC5cbmZ1bmN0aW9uIGNsZWFyU2VsZWN0aW9uRXZlbnRzKGFycmF5KXt3aGlsZShhcnJheS5sZW5ndGgpe3ZhciBsYXN0PWxzdChhcnJheSk7aWYobGFzdC5yYW5nZXMpe2FycmF5LnBvcCgpO31lbHNle2JyZWFrO319fS8vIEZpbmQgdGhlIHRvcCBjaGFuZ2UgZXZlbnQgaW4gdGhlIGhpc3RvcnkuIFBvcCBvZmYgc2VsZWN0aW9uXG4vLyBldmVudHMgdGhhdCBhcmUgaW4gdGhlIHdheS5cbmZ1bmN0aW9uIGxhc3RDaGFuZ2VFdmVudChoaXN0LGZvcmNlKXtpZihmb3JjZSl7Y2xlYXJTZWxlY3Rpb25FdmVudHMoaGlzdC5kb25lKTtyZXR1cm4gbHN0KGhpc3QuZG9uZSk7fWVsc2UgaWYoaGlzdC5kb25lLmxlbmd0aCYmIWxzdChoaXN0LmRvbmUpLnJhbmdlcyl7cmV0dXJuIGxzdChoaXN0LmRvbmUpO31lbHNlIGlmKGhpc3QuZG9uZS5sZW5ndGg+MSYmIWhpc3QuZG9uZVtoaXN0LmRvbmUubGVuZ3RoLTJdLnJhbmdlcyl7aGlzdC5kb25lLnBvcCgpO3JldHVybiBsc3QoaGlzdC5kb25lKTt9fS8vIFJlZ2lzdGVyIGEgY2hhbmdlIGluIHRoZSBoaXN0b3J5LiBNZXJnZXMgY2hhbmdlcyB0aGF0IGFyZSB3aXRoaW5cbi8vIGEgc2luZ2xlIG9wZXJhdGlvbiwgb3IgYXJlIGNsb3NlIHRvZ2V0aGVyIHdpdGggYW4gb3JpZ2luIHRoYXRcbi8vIGFsbG93cyBtZXJnaW5nIChzdGFydGluZyB3aXRoIFwiK1wiKSBpbnRvIGEgc2luZ2xlIGV2ZW50LlxuZnVuY3Rpb24gYWRkQ2hhbmdlVG9IaXN0b3J5KGRvYyxjaGFuZ2Usc2VsQWZ0ZXIsb3BJZCl7dmFyIGhpc3Q9ZG9jLmhpc3Rvcnk7aGlzdC51bmRvbmUubGVuZ3RoPTA7dmFyIHRpbWU9K25ldyBEYXRlKCksY3VyO3ZhciBsYXN0O2lmKChoaXN0Lmxhc3RPcD09b3BJZHx8aGlzdC5sYXN0T3JpZ2luPT1jaGFuZ2Uub3JpZ2luJiZjaGFuZ2Uub3JpZ2luJiYoY2hhbmdlLm9yaWdpbi5jaGFyQXQoMCk9PVwiK1wiJiZkb2MuY20mJmhpc3QubGFzdE1vZFRpbWU+dGltZS1kb2MuY20ub3B0aW9ucy5oaXN0b3J5RXZlbnREZWxheXx8Y2hhbmdlLm9yaWdpbi5jaGFyQXQoMCk9PVwiKlwiKSkmJihjdXI9bGFzdENoYW5nZUV2ZW50KGhpc3QsaGlzdC5sYXN0T3A9PW9wSWQpKSl7Ly8gTWVyZ2UgdGhpcyBjaGFuZ2UgaW50byB0aGUgbGFzdCBldmVudFxubGFzdD1sc3QoY3VyLmNoYW5nZXMpO2lmKGNtcChjaGFuZ2UuZnJvbSxjaGFuZ2UudG8pPT0wJiZjbXAoY2hhbmdlLmZyb20sbGFzdC50byk9PTApey8vIE9wdGltaXplZCBjYXNlIGZvciBzaW1wbGUgaW5zZXJ0aW9uIC0tIGRvbid0IHdhbnQgdG8gYWRkXG4vLyBuZXcgY2hhbmdlc2V0cyBmb3IgZXZlcnkgY2hhcmFjdGVyIHR5cGVkXG5sYXN0LnRvPWNoYW5nZUVuZChjaGFuZ2UpO31lbHNley8vIEFkZCBuZXcgc3ViLWV2ZW50XG5jdXIuY2hhbmdlcy5wdXNoKGhpc3RvcnlDaGFuZ2VGcm9tQ2hhbmdlKGRvYyxjaGFuZ2UpKTt9fWVsc2V7Ly8gQ2FuIG5vdCBiZSBtZXJnZWQsIHN0YXJ0IGEgbmV3IGV2ZW50LlxudmFyIGJlZm9yZT1sc3QoaGlzdC5kb25lKTtpZighYmVmb3JlfHwhYmVmb3JlLnJhbmdlcyl7cHVzaFNlbGVjdGlvblRvSGlzdG9yeShkb2Muc2VsLGhpc3QuZG9uZSk7fWN1cj17Y2hhbmdlczpbaGlzdG9yeUNoYW5nZUZyb21DaGFuZ2UoZG9jLGNoYW5nZSldLGdlbmVyYXRpb246aGlzdC5nZW5lcmF0aW9ufTtoaXN0LmRvbmUucHVzaChjdXIpO3doaWxlKGhpc3QuZG9uZS5sZW5ndGg+aGlzdC51bmRvRGVwdGgpe2hpc3QuZG9uZS5zaGlmdCgpO2lmKCFoaXN0LmRvbmVbMF0ucmFuZ2VzKXtoaXN0LmRvbmUuc2hpZnQoKTt9fX1oaXN0LmRvbmUucHVzaChzZWxBZnRlcik7aGlzdC5nZW5lcmF0aW9uPSsraGlzdC5tYXhHZW5lcmF0aW9uO2hpc3QubGFzdE1vZFRpbWU9aGlzdC5sYXN0U2VsVGltZT10aW1lO2hpc3QubGFzdE9wPWhpc3QubGFzdFNlbE9wPW9wSWQ7aGlzdC5sYXN0T3JpZ2luPWhpc3QubGFzdFNlbE9yaWdpbj1jaGFuZ2Uub3JpZ2luO2lmKCFsYXN0KXtzaWduYWwoZG9jLFwiaGlzdG9yeUFkZGVkXCIpO319ZnVuY3Rpb24gc2VsZWN0aW9uRXZlbnRDYW5CZU1lcmdlZChkb2Msb3JpZ2luLHByZXYsc2VsKXt2YXIgY2g9b3JpZ2luLmNoYXJBdCgwKTtyZXR1cm4gY2g9PVwiKlwifHxjaD09XCIrXCImJnByZXYucmFuZ2VzLmxlbmd0aD09c2VsLnJhbmdlcy5sZW5ndGgmJnByZXYuc29tZXRoaW5nU2VsZWN0ZWQoKT09c2VsLnNvbWV0aGluZ1NlbGVjdGVkKCkmJm5ldyBEYXRlKCktZG9jLmhpc3RvcnkubGFzdFNlbFRpbWU8PShkb2MuY20/ZG9jLmNtLm9wdGlvbnMuaGlzdG9yeUV2ZW50RGVsYXk6NTAwKTt9Ly8gQ2FsbGVkIHdoZW5ldmVyIHRoZSBzZWxlY3Rpb24gY2hhbmdlcywgc2V0cyB0aGUgbmV3IHNlbGVjdGlvbiBhc1xuLy8gdGhlIHBlbmRpbmcgc2VsZWN0aW9uIGluIHRoZSBoaXN0b3J5LCBhbmQgcHVzaGVzIHRoZSBvbGQgcGVuZGluZ1xuLy8gc2VsZWN0aW9uIGludG8gdGhlICdkb25lJyBhcnJheSB3aGVuIGl0IHdhcyBzaWduaWZpY2FudGx5XG4vLyBkaWZmZXJlbnQgKGluIG51bWJlciBvZiBzZWxlY3RlZCByYW5nZXMsIGVtcHRpbmVzcywgb3IgdGltZSkuXG5mdW5jdGlvbiBhZGRTZWxlY3Rpb25Ub0hpc3RvcnkoZG9jLHNlbCxvcElkLG9wdGlvbnMpe3ZhciBoaXN0PWRvYy5oaXN0b3J5LG9yaWdpbj1vcHRpb25zJiZvcHRpb25zLm9yaWdpbjsvLyBBIG5ldyBldmVudCBpcyBzdGFydGVkIHdoZW4gdGhlIHByZXZpb3VzIG9yaWdpbiBkb2VzIG5vdCBtYXRjaFxuLy8gdGhlIGN1cnJlbnQsIG9yIHRoZSBvcmlnaW5zIGRvbid0IGFsbG93IG1hdGNoaW5nLiBPcmlnaW5zXG4vLyBzdGFydGluZyB3aXRoICogYXJlIGFsd2F5cyBtZXJnZWQsIHRob3NlIHN0YXJ0aW5nIHdpdGggKyBhcmVcbi8vIG1lcmdlZCB3aGVuIHNpbWlsYXIgYW5kIGNsb3NlIHRvZ2V0aGVyIGluIHRpbWUuXG5pZihvcElkPT1oaXN0Lmxhc3RTZWxPcHx8b3JpZ2luJiZoaXN0Lmxhc3RTZWxPcmlnaW49PW9yaWdpbiYmKGhpc3QubGFzdE1vZFRpbWU9PWhpc3QubGFzdFNlbFRpbWUmJmhpc3QubGFzdE9yaWdpbj09b3JpZ2lufHxzZWxlY3Rpb25FdmVudENhbkJlTWVyZ2VkKGRvYyxvcmlnaW4sbHN0KGhpc3QuZG9uZSksc2VsKSkpe2hpc3QuZG9uZVtoaXN0LmRvbmUubGVuZ3RoLTFdPXNlbDt9ZWxzZXtwdXNoU2VsZWN0aW9uVG9IaXN0b3J5KHNlbCxoaXN0LmRvbmUpO31oaXN0Lmxhc3RTZWxUaW1lPStuZXcgRGF0ZSgpO2hpc3QubGFzdFNlbE9yaWdpbj1vcmlnaW47aGlzdC5sYXN0U2VsT3A9b3BJZDtpZihvcHRpb25zJiZvcHRpb25zLmNsZWFyUmVkbyE9PWZhbHNlKXtjbGVhclNlbGVjdGlvbkV2ZW50cyhoaXN0LnVuZG9uZSk7fX1mdW5jdGlvbiBwdXNoU2VsZWN0aW9uVG9IaXN0b3J5KHNlbCxkZXN0KXt2YXIgdG9wPWxzdChkZXN0KTtpZighKHRvcCYmdG9wLnJhbmdlcyYmdG9wLmVxdWFscyhzZWwpKSl7ZGVzdC5wdXNoKHNlbCk7fX0vLyBVc2VkIHRvIHN0b3JlIG1hcmtlZCBzcGFuIGluZm9ybWF0aW9uIGluIHRoZSBoaXN0b3J5LlxuZnVuY3Rpb24gYXR0YWNoTG9jYWxTcGFucyhkb2MsY2hhbmdlLGZyb20sdG8pe3ZhciBleGlzdGluZz1jaGFuZ2VbXCJzcGFuc19cIitkb2MuaWRdLG49MDtkb2MuaXRlcihNYXRoLm1heChkb2MuZmlyc3QsZnJvbSksTWF0aC5taW4oZG9jLmZpcnN0K2RvYy5zaXplLHRvKSxmdW5jdGlvbihsaW5lKXtpZihsaW5lLm1hcmtlZFNwYW5zKXsoZXhpc3Rpbmd8fChleGlzdGluZz1jaGFuZ2VbXCJzcGFuc19cIitkb2MuaWRdPXt9KSlbbl09bGluZS5tYXJrZWRTcGFuczt9KytuO30pO30vLyBXaGVuIHVuL3JlLWRvaW5nIHJlc3RvcmVzIHRleHQgY29udGFpbmluZyBtYXJrZWQgc3BhbnMsIHRob3NlXG4vLyB0aGF0IGhhdmUgYmVlbiBleHBsaWNpdGx5IGNsZWFyZWQgc2hvdWxkIG5vdCBiZSByZXN0b3JlZC5cbmZ1bmN0aW9uIHJlbW92ZUNsZWFyZWRTcGFucyhzcGFucyl7aWYoIXNwYW5zKXtyZXR1cm4gbnVsbDt9dmFyIG91dDtmb3IodmFyIGk9MDtpPHNwYW5zLmxlbmd0aDsrK2kpe2lmKHNwYW5zW2ldLm1hcmtlci5leHBsaWNpdGx5Q2xlYXJlZCl7aWYoIW91dCl7b3V0PXNwYW5zLnNsaWNlKDAsaSk7fX1lbHNlIGlmKG91dCl7b3V0LnB1c2goc3BhbnNbaV0pO319cmV0dXJuIW91dD9zcGFuczpvdXQubGVuZ3RoP291dDpudWxsO30vLyBSZXRyaWV2ZSBhbmQgZmlsdGVyIHRoZSBvbGQgbWFya2VkIHNwYW5zIHN0b3JlZCBpbiBhIGNoYW5nZSBldmVudC5cbmZ1bmN0aW9uIGdldE9sZFNwYW5zKGRvYyxjaGFuZ2Upe3ZhciBmb3VuZD1jaGFuZ2VbXCJzcGFuc19cIitkb2MuaWRdO2lmKCFmb3VuZCl7cmV0dXJuIG51bGw7fXZhciBudz1bXTtmb3IodmFyIGk9MDtpPGNoYW5nZS50ZXh0Lmxlbmd0aDsrK2kpe253LnB1c2gocmVtb3ZlQ2xlYXJlZFNwYW5zKGZvdW5kW2ldKSk7fXJldHVybiBudzt9Ly8gVXNlZCBmb3IgdW4vcmUtZG9pbmcgY2hhbmdlcyBmcm9tIHRoZSBoaXN0b3J5LiBDb21iaW5lcyB0aGVcbi8vIHJlc3VsdCBvZiBjb21wdXRpbmcgdGhlIGV4aXN0aW5nIHNwYW5zIHdpdGggdGhlIHNldCBvZiBzcGFucyB0aGF0XG4vLyBleGlzdGVkIGluIHRoZSBoaXN0b3J5IChzbyB0aGF0IGRlbGV0aW5nIGFyb3VuZCBhIHNwYW4gYW5kIHRoZW5cbi8vIHVuZG9pbmcgYnJpbmdzIGJhY2sgdGhlIHNwYW4pLlxuZnVuY3Rpb24gbWVyZ2VPbGRTcGFucyhkb2MsY2hhbmdlKXt2YXIgb2xkPWdldE9sZFNwYW5zKGRvYyxjaGFuZ2UpO3ZhciBzdHJldGNoZWQ9c3RyZXRjaFNwYW5zT3ZlckNoYW5nZShkb2MsY2hhbmdlKTtpZighb2xkKXtyZXR1cm4gc3RyZXRjaGVkO31pZighc3RyZXRjaGVkKXtyZXR1cm4gb2xkO31mb3IodmFyIGk9MDtpPG9sZC5sZW5ndGg7KytpKXt2YXIgb2xkQ3VyPW9sZFtpXSxzdHJldGNoQ3VyPXN0cmV0Y2hlZFtpXTtpZihvbGRDdXImJnN0cmV0Y2hDdXIpe3NwYW5zOmZvcih2YXIgaj0wO2o8c3RyZXRjaEN1ci5sZW5ndGg7KytqKXt2YXIgc3Bhbj1zdHJldGNoQ3VyW2pdO2Zvcih2YXIgaz0wO2s8b2xkQ3VyLmxlbmd0aDsrK2spe2lmKG9sZEN1cltrXS5tYXJrZXI9PXNwYW4ubWFya2VyKXtjb250aW51ZSBzcGFuczt9fW9sZEN1ci5wdXNoKHNwYW4pO319ZWxzZSBpZihzdHJldGNoQ3VyKXtvbGRbaV09c3RyZXRjaEN1cjt9fXJldHVybiBvbGQ7fS8vIFVzZWQgYm90aCB0byBwcm92aWRlIGEgSlNPTi1zYWZlIG9iamVjdCBpbiAuZ2V0SGlzdG9yeSwgYW5kLCB3aGVuXG4vLyBkZXRhY2hpbmcgYSBkb2N1bWVudCwgdG8gc3BsaXQgdGhlIGhpc3RvcnkgaW4gdHdvXG5mdW5jdGlvbiBjb3B5SGlzdG9yeUFycmF5KGV2ZW50cyxuZXdHcm91cCxpbnN0YW50aWF0ZVNlbCl7dmFyIGNvcHk9W107Zm9yKHZhciBpPTA7aTxldmVudHMubGVuZ3RoOysraSl7dmFyIGV2ZW50PWV2ZW50c1tpXTtpZihldmVudC5yYW5nZXMpe2NvcHkucHVzaChpbnN0YW50aWF0ZVNlbD9TZWxlY3Rpb24ucHJvdG90eXBlLmRlZXBDb3B5LmNhbGwoZXZlbnQpOmV2ZW50KTtjb250aW51ZTt9dmFyIGNoYW5nZXM9ZXZlbnQuY2hhbmdlcyxuZXdDaGFuZ2VzPVtdO2NvcHkucHVzaCh7Y2hhbmdlczpuZXdDaGFuZ2VzfSk7Zm9yKHZhciBqPTA7ajxjaGFuZ2VzLmxlbmd0aDsrK2ope3ZhciBjaGFuZ2U9Y2hhbmdlc1tqXSxtPXZvaWQgMDtuZXdDaGFuZ2VzLnB1c2goe2Zyb206Y2hhbmdlLmZyb20sdG86Y2hhbmdlLnRvLHRleHQ6Y2hhbmdlLnRleHR9KTtpZihuZXdHcm91cCl7Zm9yKHZhciBwcm9wIGluIGNoYW5nZSl7aWYobT1wcm9wLm1hdGNoKC9ec3BhbnNfKFxcZCspJC8pKXtpZihpbmRleE9mKG5ld0dyb3VwLE51bWJlcihtWzFdKSk+LTEpe2xzdChuZXdDaGFuZ2VzKVtwcm9wXT1jaGFuZ2VbcHJvcF07ZGVsZXRlIGNoYW5nZVtwcm9wXTt9fX19fX1yZXR1cm4gY29weTt9Ly8gVGhlICdzY3JvbGwnIHBhcmFtZXRlciBnaXZlbiB0byBtYW55IG9mIHRoZXNlIGluZGljYXRlZCB3aGV0aGVyXG4vLyB0aGUgbmV3IGN1cnNvciBwb3NpdGlvbiBzaG91bGQgYmUgc2Nyb2xsZWQgaW50byB2aWV3IGFmdGVyXG4vLyBtb2RpZnlpbmcgdGhlIHNlbGVjdGlvbi5cbi8vIElmIHNoaWZ0IGlzIGhlbGQgb3IgdGhlIGV4dGVuZCBmbGFnIGlzIHNldCwgZXh0ZW5kcyBhIHJhbmdlIHRvXG4vLyBpbmNsdWRlIGEgZ2l2ZW4gcG9zaXRpb24gKGFuZCBvcHRpb25hbGx5IGEgc2Vjb25kIHBvc2l0aW9uKS5cbi8vIE90aGVyd2lzZSwgc2ltcGx5IHJldHVybnMgdGhlIHJhbmdlIGJldHdlZW4gdGhlIGdpdmVuIHBvc2l0aW9ucy5cbi8vIFVzZWQgZm9yIGN1cnNvciBtb3Rpb24gYW5kIHN1Y2guXG5mdW5jdGlvbiBleHRlbmRSYW5nZShkb2MscmFuZ2UsaGVhZCxvdGhlcil7aWYoZG9jLmNtJiZkb2MuY20uZGlzcGxheS5zaGlmdHx8ZG9jLmV4dGVuZCl7dmFyIGFuY2hvcj1yYW5nZS5hbmNob3I7aWYob3RoZXIpe3ZhciBwb3NCZWZvcmU9Y21wKGhlYWQsYW5jaG9yKTwwO2lmKHBvc0JlZm9yZSE9Y21wKG90aGVyLGFuY2hvcik8MCl7YW5jaG9yPWhlYWQ7aGVhZD1vdGhlcjt9ZWxzZSBpZihwb3NCZWZvcmUhPWNtcChoZWFkLG90aGVyKTwwKXtoZWFkPW90aGVyO319cmV0dXJuIG5ldyBSYW5nZShhbmNob3IsaGVhZCk7fWVsc2V7cmV0dXJuIG5ldyBSYW5nZShvdGhlcnx8aGVhZCxoZWFkKTt9fS8vIEV4dGVuZCB0aGUgcHJpbWFyeSBzZWxlY3Rpb24gcmFuZ2UsIGRpc2NhcmQgdGhlIHJlc3QuXG5mdW5jdGlvbiBleHRlbmRTZWxlY3Rpb24oZG9jLGhlYWQsb3RoZXIsb3B0aW9ucyl7c2V0U2VsZWN0aW9uKGRvYyxuZXcgU2VsZWN0aW9uKFtleHRlbmRSYW5nZShkb2MsZG9jLnNlbC5wcmltYXJ5KCksaGVhZCxvdGhlcildLDApLG9wdGlvbnMpO30vLyBFeHRlbmQgYWxsIHNlbGVjdGlvbnMgKHBvcyBpcyBhbiBhcnJheSBvZiBzZWxlY3Rpb25zIHdpdGggbGVuZ3RoXG4vLyBlcXVhbCB0aGUgbnVtYmVyIG9mIHNlbGVjdGlvbnMpXG5mdW5jdGlvbiBleHRlbmRTZWxlY3Rpb25zKGRvYyxoZWFkcyxvcHRpb25zKXt2YXIgb3V0PVtdO2Zvcih2YXIgaT0wO2k8ZG9jLnNlbC5yYW5nZXMubGVuZ3RoO2krKyl7b3V0W2ldPWV4dGVuZFJhbmdlKGRvYyxkb2Muc2VsLnJhbmdlc1tpXSxoZWFkc1tpXSxudWxsKTt9dmFyIG5ld1NlbD1ub3JtYWxpemVTZWxlY3Rpb24ob3V0LGRvYy5zZWwucHJpbUluZGV4KTtzZXRTZWxlY3Rpb24oZG9jLG5ld1NlbCxvcHRpb25zKTt9Ly8gVXBkYXRlcyBhIHNpbmdsZSByYW5nZSBpbiB0aGUgc2VsZWN0aW9uLlxuZnVuY3Rpb24gcmVwbGFjZU9uZVNlbGVjdGlvbihkb2MsaSxyYW5nZSxvcHRpb25zKXt2YXIgcmFuZ2VzPWRvYy5zZWwucmFuZ2VzLnNsaWNlKDApO3Jhbmdlc1tpXT1yYW5nZTtzZXRTZWxlY3Rpb24oZG9jLG5vcm1hbGl6ZVNlbGVjdGlvbihyYW5nZXMsZG9jLnNlbC5wcmltSW5kZXgpLG9wdGlvbnMpO30vLyBSZXNldCB0aGUgc2VsZWN0aW9uIHRvIGEgc2luZ2xlIHJhbmdlLlxuZnVuY3Rpb24gc2V0U2ltcGxlU2VsZWN0aW9uKGRvYyxhbmNob3IsaGVhZCxvcHRpb25zKXtzZXRTZWxlY3Rpb24oZG9jLHNpbXBsZVNlbGVjdGlvbihhbmNob3IsaGVhZCksb3B0aW9ucyk7fS8vIEdpdmUgYmVmb3JlU2VsZWN0aW9uQ2hhbmdlIGhhbmRsZXJzIGEgY2hhbmdlIHRvIGluZmx1ZW5jZSBhXG4vLyBzZWxlY3Rpb24gdXBkYXRlLlxuZnVuY3Rpb24gZmlsdGVyU2VsZWN0aW9uQ2hhbmdlKGRvYyxzZWwsb3B0aW9ucyl7dmFyIG9iaj17cmFuZ2VzOnNlbC5yYW5nZXMsdXBkYXRlOmZ1bmN0aW9uKHJhbmdlcyl7dmFyIHRoaXMkMT10aGlzO3RoaXMucmFuZ2VzPVtdO2Zvcih2YXIgaT0wO2k8cmFuZ2VzLmxlbmd0aDtpKyspe3RoaXMkMS5yYW5nZXNbaV09bmV3IFJhbmdlKGNsaXBQb3MoZG9jLHJhbmdlc1tpXS5hbmNob3IpLGNsaXBQb3MoZG9jLHJhbmdlc1tpXS5oZWFkKSk7fX0sb3JpZ2luOm9wdGlvbnMmJm9wdGlvbnMub3JpZ2lufTtzaWduYWwoZG9jLFwiYmVmb3JlU2VsZWN0aW9uQ2hhbmdlXCIsZG9jLG9iaik7aWYoZG9jLmNtKXtzaWduYWwoZG9jLmNtLFwiYmVmb3JlU2VsZWN0aW9uQ2hhbmdlXCIsZG9jLmNtLG9iaik7fWlmKG9iai5yYW5nZXMhPXNlbC5yYW5nZXMpe3JldHVybiBub3JtYWxpemVTZWxlY3Rpb24ob2JqLnJhbmdlcyxvYmoucmFuZ2VzLmxlbmd0aC0xKTt9ZWxzZXtyZXR1cm4gc2VsO319ZnVuY3Rpb24gc2V0U2VsZWN0aW9uUmVwbGFjZUhpc3RvcnkoZG9jLHNlbCxvcHRpb25zKXt2YXIgZG9uZT1kb2MuaGlzdG9yeS5kb25lLGxhc3Q9bHN0KGRvbmUpO2lmKGxhc3QmJmxhc3QucmFuZ2VzKXtkb25lW2RvbmUubGVuZ3RoLTFdPXNlbDtzZXRTZWxlY3Rpb25Ob1VuZG8oZG9jLHNlbCxvcHRpb25zKTt9ZWxzZXtzZXRTZWxlY3Rpb24oZG9jLHNlbCxvcHRpb25zKTt9fS8vIFNldCBhIG5ldyBzZWxlY3Rpb24uXG5mdW5jdGlvbiBzZXRTZWxlY3Rpb24oZG9jLHNlbCxvcHRpb25zKXtzZXRTZWxlY3Rpb25Ob1VuZG8oZG9jLHNlbCxvcHRpb25zKTthZGRTZWxlY3Rpb25Ub0hpc3RvcnkoZG9jLGRvYy5zZWwsZG9jLmNtP2RvYy5jbS5jdXJPcC5pZDpOYU4sb3B0aW9ucyk7fWZ1bmN0aW9uIHNldFNlbGVjdGlvbk5vVW5kbyhkb2Msc2VsLG9wdGlvbnMpe2lmKGhhc0hhbmRsZXIoZG9jLFwiYmVmb3JlU2VsZWN0aW9uQ2hhbmdlXCIpfHxkb2MuY20mJmhhc0hhbmRsZXIoZG9jLmNtLFwiYmVmb3JlU2VsZWN0aW9uQ2hhbmdlXCIpKXtzZWw9ZmlsdGVyU2VsZWN0aW9uQ2hhbmdlKGRvYyxzZWwsb3B0aW9ucyk7fXZhciBiaWFzPW9wdGlvbnMmJm9wdGlvbnMuYmlhc3x8KGNtcChzZWwucHJpbWFyeSgpLmhlYWQsZG9jLnNlbC5wcmltYXJ5KCkuaGVhZCk8MD8tMToxKTtzZXRTZWxlY3Rpb25Jbm5lcihkb2Msc2tpcEF0b21pY0luU2VsZWN0aW9uKGRvYyxzZWwsYmlhcyx0cnVlKSk7aWYoIShvcHRpb25zJiZvcHRpb25zLnNjcm9sbD09PWZhbHNlKSYmZG9jLmNtKXtlbnN1cmVDdXJzb3JWaXNpYmxlKGRvYy5jbSk7fX1mdW5jdGlvbiBzZXRTZWxlY3Rpb25Jbm5lcihkb2Msc2VsKXtpZihzZWwuZXF1YWxzKGRvYy5zZWwpKXtyZXR1cm47fWRvYy5zZWw9c2VsO2lmKGRvYy5jbSl7ZG9jLmNtLmN1ck9wLnVwZGF0ZUlucHV0PWRvYy5jbS5jdXJPcC5zZWxlY3Rpb25DaGFuZ2VkPXRydWU7c2lnbmFsQ3Vyc29yQWN0aXZpdHkoZG9jLmNtKTt9c2lnbmFsTGF0ZXIoZG9jLFwiY3Vyc29yQWN0aXZpdHlcIixkb2MpO30vLyBWZXJpZnkgdGhhdCB0aGUgc2VsZWN0aW9uIGRvZXMgbm90IHBhcnRpYWxseSBzZWxlY3QgYW55IGF0b21pY1xuLy8gbWFya2VkIHJhbmdlcy5cbmZ1bmN0aW9uIHJlQ2hlY2tTZWxlY3Rpb24oZG9jKXtzZXRTZWxlY3Rpb25Jbm5lcihkb2Msc2tpcEF0b21pY0luU2VsZWN0aW9uKGRvYyxkb2Muc2VsLG51bGwsZmFsc2UpLHNlbF9kb250U2Nyb2xsKTt9Ly8gUmV0dXJuIGEgc2VsZWN0aW9uIHRoYXQgZG9lcyBub3QgcGFydGlhbGx5IHNlbGVjdCBhbnkgYXRvbWljXG4vLyByYW5nZXMuXG5mdW5jdGlvbiBza2lwQXRvbWljSW5TZWxlY3Rpb24oZG9jLHNlbCxiaWFzLG1heUNsZWFyKXt2YXIgb3V0O2Zvcih2YXIgaT0wO2k8c2VsLnJhbmdlcy5sZW5ndGg7aSsrKXt2YXIgcmFuZ2U9c2VsLnJhbmdlc1tpXTt2YXIgb2xkPXNlbC5yYW5nZXMubGVuZ3RoPT1kb2Muc2VsLnJhbmdlcy5sZW5ndGgmJmRvYy5zZWwucmFuZ2VzW2ldO3ZhciBuZXdBbmNob3I9c2tpcEF0b21pYyhkb2MscmFuZ2UuYW5jaG9yLG9sZCYmb2xkLmFuY2hvcixiaWFzLG1heUNsZWFyKTt2YXIgbmV3SGVhZD1za2lwQXRvbWljKGRvYyxyYW5nZS5oZWFkLG9sZCYmb2xkLmhlYWQsYmlhcyxtYXlDbGVhcik7aWYob3V0fHxuZXdBbmNob3IhPXJhbmdlLmFuY2hvcnx8bmV3SGVhZCE9cmFuZ2UuaGVhZCl7aWYoIW91dCl7b3V0PXNlbC5yYW5nZXMuc2xpY2UoMCxpKTt9b3V0W2ldPW5ldyBSYW5nZShuZXdBbmNob3IsbmV3SGVhZCk7fX1yZXR1cm4gb3V0P25vcm1hbGl6ZVNlbGVjdGlvbihvdXQsc2VsLnByaW1JbmRleCk6c2VsO31mdW5jdGlvbiBza2lwQXRvbWljSW5uZXIoZG9jLHBvcyxvbGRQb3MsZGlyLG1heUNsZWFyKXt2YXIgbGluZT1nZXRMaW5lKGRvYyxwb3MubGluZSk7aWYobGluZS5tYXJrZWRTcGFucyl7Zm9yKHZhciBpPTA7aTxsaW5lLm1hcmtlZFNwYW5zLmxlbmd0aDsrK2kpe3ZhciBzcD1saW5lLm1hcmtlZFNwYW5zW2ldLG09c3AubWFya2VyO2lmKChzcC5mcm9tPT1udWxsfHwobS5pbmNsdXNpdmVMZWZ0P3NwLmZyb208PXBvcy5jaDpzcC5mcm9tPHBvcy5jaCkpJiYoc3AudG89PW51bGx8fChtLmluY2x1c2l2ZVJpZ2h0P3NwLnRvPj1wb3MuY2g6c3AudG8+cG9zLmNoKSkpe2lmKG1heUNsZWFyKXtzaWduYWwobSxcImJlZm9yZUN1cnNvckVudGVyXCIpO2lmKG0uZXhwbGljaXRseUNsZWFyZWQpe2lmKCFsaW5lLm1hcmtlZFNwYW5zKXticmVhazt9ZWxzZXstLWk7Y29udGludWU7fX19aWYoIW0uYXRvbWljKXtjb250aW51ZTt9aWYob2xkUG9zKXt2YXIgbmVhcj1tLmZpbmQoZGlyPDA/MTotMSksZGlmZj12b2lkIDA7aWYoZGlyPDA/bS5pbmNsdXNpdmVSaWdodDptLmluY2x1c2l2ZUxlZnQpe25lYXI9bW92ZVBvcyhkb2MsbmVhciwtZGlyLG5lYXImJm5lYXIubGluZT09cG9zLmxpbmU/bGluZTpudWxsKTt9aWYobmVhciYmbmVhci5saW5lPT1wb3MubGluZSYmKGRpZmY9Y21wKG5lYXIsb2xkUG9zKSkmJihkaXI8MD9kaWZmPDA6ZGlmZj4wKSl7cmV0dXJuIHNraXBBdG9taWNJbm5lcihkb2MsbmVhcixwb3MsZGlyLG1heUNsZWFyKTt9fXZhciBmYXI9bS5maW5kKGRpcjwwPy0xOjEpO2lmKGRpcjwwP20uaW5jbHVzaXZlTGVmdDptLmluY2x1c2l2ZVJpZ2h0KXtmYXI9bW92ZVBvcyhkb2MsZmFyLGRpcixmYXIubGluZT09cG9zLmxpbmU/bGluZTpudWxsKTt9cmV0dXJuIGZhcj9za2lwQXRvbWljSW5uZXIoZG9jLGZhcixwb3MsZGlyLG1heUNsZWFyKTpudWxsO319fXJldHVybiBwb3M7fS8vIEVuc3VyZSBhIGdpdmVuIHBvc2l0aW9uIGlzIG5vdCBpbnNpZGUgYW4gYXRvbWljIHJhbmdlLlxuZnVuY3Rpb24gc2tpcEF0b21pYyhkb2MscG9zLG9sZFBvcyxiaWFzLG1heUNsZWFyKXt2YXIgZGlyPWJpYXN8fDE7dmFyIGZvdW5kPXNraXBBdG9taWNJbm5lcihkb2MscG9zLG9sZFBvcyxkaXIsbWF5Q2xlYXIpfHwhbWF5Q2xlYXImJnNraXBBdG9taWNJbm5lcihkb2MscG9zLG9sZFBvcyxkaXIsdHJ1ZSl8fHNraXBBdG9taWNJbm5lcihkb2MscG9zLG9sZFBvcywtZGlyLG1heUNsZWFyKXx8IW1heUNsZWFyJiZza2lwQXRvbWljSW5uZXIoZG9jLHBvcyxvbGRQb3MsLWRpcix0cnVlKTtpZighZm91bmQpe2RvYy5jYW50RWRpdD10cnVlO3JldHVybiBQb3MoZG9jLmZpcnN0LDApO31yZXR1cm4gZm91bmQ7fWZ1bmN0aW9uIG1vdmVQb3MoZG9jLHBvcyxkaXIsbGluZSl7aWYoZGlyPDAmJnBvcy5jaD09MCl7aWYocG9zLmxpbmU+ZG9jLmZpcnN0KXtyZXR1cm4gY2xpcFBvcyhkb2MsUG9zKHBvcy5saW5lLTEpKTt9ZWxzZXtyZXR1cm4gbnVsbDt9fWVsc2UgaWYoZGlyPjAmJnBvcy5jaD09KGxpbmV8fGdldExpbmUoZG9jLHBvcy5saW5lKSkudGV4dC5sZW5ndGgpe2lmKHBvcy5saW5lPGRvYy5maXJzdCtkb2Muc2l6ZS0xKXtyZXR1cm4gUG9zKHBvcy5saW5lKzEsMCk7fWVsc2V7cmV0dXJuIG51bGw7fX1lbHNle3JldHVybiBuZXcgUG9zKHBvcy5saW5lLHBvcy5jaCtkaXIpO319ZnVuY3Rpb24gc2VsZWN0QWxsKGNtKXtjbS5zZXRTZWxlY3Rpb24oUG9zKGNtLmZpcnN0TGluZSgpLDApLFBvcyhjbS5sYXN0TGluZSgpKSxzZWxfZG9udFNjcm9sbCk7fS8vIFVQREFUSU5HXG4vLyBBbGxvdyBcImJlZm9yZUNoYW5nZVwiIGV2ZW50IGhhbmRsZXJzIHRvIGluZmx1ZW5jZSBhIGNoYW5nZVxuZnVuY3Rpb24gZmlsdGVyQ2hhbmdlKGRvYyxjaGFuZ2UsdXBkYXRlKXt2YXIgb2JqPXtjYW5jZWxlZDpmYWxzZSxmcm9tOmNoYW5nZS5mcm9tLHRvOmNoYW5nZS50byx0ZXh0OmNoYW5nZS50ZXh0LG9yaWdpbjpjaGFuZ2Uub3JpZ2luLGNhbmNlbDpmdW5jdGlvbigpe3JldHVybiBvYmouY2FuY2VsZWQ9dHJ1ZTt9fTtpZih1cGRhdGUpe29iai51cGRhdGU9ZnVuY3Rpb24oZnJvbSx0byx0ZXh0LG9yaWdpbil7aWYoZnJvbSl7b2JqLmZyb209Y2xpcFBvcyhkb2MsZnJvbSk7fWlmKHRvKXtvYmoudG89Y2xpcFBvcyhkb2MsdG8pO31pZih0ZXh0KXtvYmoudGV4dD10ZXh0O31pZihvcmlnaW4hPT11bmRlZmluZWQpe29iai5vcmlnaW49b3JpZ2luO319O31zaWduYWwoZG9jLFwiYmVmb3JlQ2hhbmdlXCIsZG9jLG9iaik7aWYoZG9jLmNtKXtzaWduYWwoZG9jLmNtLFwiYmVmb3JlQ2hhbmdlXCIsZG9jLmNtLG9iaik7fWlmKG9iai5jYW5jZWxlZCl7cmV0dXJuIG51bGw7fXJldHVybntmcm9tOm9iai5mcm9tLHRvOm9iai50byx0ZXh0Om9iai50ZXh0LG9yaWdpbjpvYmoub3JpZ2lufTt9Ly8gQXBwbHkgYSBjaGFuZ2UgdG8gYSBkb2N1bWVudCwgYW5kIGFkZCBpdCB0byB0aGUgZG9jdW1lbnQnc1xuLy8gaGlzdG9yeSwgYW5kIHByb3BhZ2F0aW5nIGl0IHRvIGFsbCBsaW5rZWQgZG9jdW1lbnRzLlxuZnVuY3Rpb24gbWFrZUNoYW5nZShkb2MsY2hhbmdlLGlnbm9yZVJlYWRPbmx5KXtpZihkb2MuY20pe2lmKCFkb2MuY20uY3VyT3Ape3JldHVybiBvcGVyYXRpb24oZG9jLmNtLG1ha2VDaGFuZ2UpKGRvYyxjaGFuZ2UsaWdub3JlUmVhZE9ubHkpO31pZihkb2MuY20uc3RhdGUuc3VwcHJlc3NFZGl0cyl7cmV0dXJuO319aWYoaGFzSGFuZGxlcihkb2MsXCJiZWZvcmVDaGFuZ2VcIil8fGRvYy5jbSYmaGFzSGFuZGxlcihkb2MuY20sXCJiZWZvcmVDaGFuZ2VcIikpe2NoYW5nZT1maWx0ZXJDaGFuZ2UoZG9jLGNoYW5nZSx0cnVlKTtpZighY2hhbmdlKXtyZXR1cm47fX0vLyBQb3NzaWJseSBzcGxpdCBvciBzdXBwcmVzcyB0aGUgdXBkYXRlIGJhc2VkIG9uIHRoZSBwcmVzZW5jZVxuLy8gb2YgcmVhZC1vbmx5IHNwYW5zIGluIGl0cyByYW5nZS5cbnZhciBzcGxpdD1zYXdSZWFkT25seVNwYW5zJiYhaWdub3JlUmVhZE9ubHkmJnJlbW92ZVJlYWRPbmx5UmFuZ2VzKGRvYyxjaGFuZ2UuZnJvbSxjaGFuZ2UudG8pO2lmKHNwbGl0KXtmb3IodmFyIGk9c3BsaXQubGVuZ3RoLTE7aT49MDstLWkpe21ha2VDaGFuZ2VJbm5lcihkb2Mse2Zyb206c3BsaXRbaV0uZnJvbSx0bzpzcGxpdFtpXS50byx0ZXh0Omk/W1wiXCJdOmNoYW5nZS50ZXh0fSk7fX1lbHNle21ha2VDaGFuZ2VJbm5lcihkb2MsY2hhbmdlKTt9fWZ1bmN0aW9uIG1ha2VDaGFuZ2VJbm5lcihkb2MsY2hhbmdlKXtpZihjaGFuZ2UudGV4dC5sZW5ndGg9PTEmJmNoYW5nZS50ZXh0WzBdPT1cIlwiJiZjbXAoY2hhbmdlLmZyb20sY2hhbmdlLnRvKT09MCl7cmV0dXJuO312YXIgc2VsQWZ0ZXI9Y29tcHV0ZVNlbEFmdGVyQ2hhbmdlKGRvYyxjaGFuZ2UpO2FkZENoYW5nZVRvSGlzdG9yeShkb2MsY2hhbmdlLHNlbEFmdGVyLGRvYy5jbT9kb2MuY20uY3VyT3AuaWQ6TmFOKTttYWtlQ2hhbmdlU2luZ2xlRG9jKGRvYyxjaGFuZ2Usc2VsQWZ0ZXIsc3RyZXRjaFNwYW5zT3ZlckNoYW5nZShkb2MsY2hhbmdlKSk7dmFyIHJlYmFzZWQ9W107bGlua2VkRG9jcyhkb2MsZnVuY3Rpb24oZG9jLHNoYXJlZEhpc3Qpe2lmKCFzaGFyZWRIaXN0JiZpbmRleE9mKHJlYmFzZWQsZG9jLmhpc3RvcnkpPT0tMSl7cmViYXNlSGlzdChkb2MuaGlzdG9yeSxjaGFuZ2UpO3JlYmFzZWQucHVzaChkb2MuaGlzdG9yeSk7fW1ha2VDaGFuZ2VTaW5nbGVEb2MoZG9jLGNoYW5nZSxudWxsLHN0cmV0Y2hTcGFuc092ZXJDaGFuZ2UoZG9jLGNoYW5nZSkpO30pO30vLyBSZXZlcnQgYSBjaGFuZ2Ugc3RvcmVkIGluIGEgZG9jdW1lbnQncyBoaXN0b3J5LlxuZnVuY3Rpb24gbWFrZUNoYW5nZUZyb21IaXN0b3J5KGRvYyx0eXBlLGFsbG93U2VsZWN0aW9uT25seSl7aWYoZG9jLmNtJiZkb2MuY20uc3RhdGUuc3VwcHJlc3NFZGl0cyYmIWFsbG93U2VsZWN0aW9uT25seSl7cmV0dXJuO312YXIgaGlzdD1kb2MuaGlzdG9yeSxldmVudCxzZWxBZnRlcj1kb2Muc2VsO3ZhciBzb3VyY2U9dHlwZT09XCJ1bmRvXCI/aGlzdC5kb25lOmhpc3QudW5kb25lLGRlc3Q9dHlwZT09XCJ1bmRvXCI/aGlzdC51bmRvbmU6aGlzdC5kb25lOy8vIFZlcmlmeSB0aGF0IHRoZXJlIGlzIGEgdXNlYWJsZSBldmVudCAoc28gdGhhdCBjdHJsLXogd29uJ3Rcbi8vIG5lZWRsZXNzbHkgY2xlYXIgc2VsZWN0aW9uIGV2ZW50cylcbnZhciBpPTA7Zm9yKDtpPHNvdXJjZS5sZW5ndGg7aSsrKXtldmVudD1zb3VyY2VbaV07aWYoYWxsb3dTZWxlY3Rpb25Pbmx5P2V2ZW50LnJhbmdlcyYmIWV2ZW50LmVxdWFscyhkb2Muc2VsKTohZXZlbnQucmFuZ2VzKXticmVhazt9fWlmKGk9PXNvdXJjZS5sZW5ndGgpe3JldHVybjt9aGlzdC5sYXN0T3JpZ2luPWhpc3QubGFzdFNlbE9yaWdpbj1udWxsO2Zvcig7Oyl7ZXZlbnQ9c291cmNlLnBvcCgpO2lmKGV2ZW50LnJhbmdlcyl7cHVzaFNlbGVjdGlvblRvSGlzdG9yeShldmVudCxkZXN0KTtpZihhbGxvd1NlbGVjdGlvbk9ubHkmJiFldmVudC5lcXVhbHMoZG9jLnNlbCkpe3NldFNlbGVjdGlvbihkb2MsZXZlbnQse2NsZWFyUmVkbzpmYWxzZX0pO3JldHVybjt9c2VsQWZ0ZXI9ZXZlbnQ7fWVsc2V7YnJlYWs7fX0vLyBCdWlsZCB1cCBhIHJldmVyc2UgY2hhbmdlIG9iamVjdCB0byBhZGQgdG8gdGhlIG9wcG9zaXRlIGhpc3Rvcnlcbi8vIHN0YWNrIChyZWRvIHdoZW4gdW5kb2luZywgYW5kIHZpY2UgdmVyc2EpLlxudmFyIGFudGlDaGFuZ2VzPVtdO3B1c2hTZWxlY3Rpb25Ub0hpc3Rvcnkoc2VsQWZ0ZXIsZGVzdCk7ZGVzdC5wdXNoKHtjaGFuZ2VzOmFudGlDaGFuZ2VzLGdlbmVyYXRpb246aGlzdC5nZW5lcmF0aW9ufSk7aGlzdC5nZW5lcmF0aW9uPWV2ZW50LmdlbmVyYXRpb258fCsraGlzdC5tYXhHZW5lcmF0aW9uO3ZhciBmaWx0ZXI9aGFzSGFuZGxlcihkb2MsXCJiZWZvcmVDaGFuZ2VcIil8fGRvYy5jbSYmaGFzSGFuZGxlcihkb2MuY20sXCJiZWZvcmVDaGFuZ2VcIik7dmFyIGxvb3A9ZnVuY3Rpb24oaSl7dmFyIGNoYW5nZT1ldmVudC5jaGFuZ2VzW2ldO2NoYW5nZS5vcmlnaW49dHlwZTtpZihmaWx0ZXImJiFmaWx0ZXJDaGFuZ2UoZG9jLGNoYW5nZSxmYWxzZSkpe3NvdXJjZS5sZW5ndGg9MDtyZXR1cm57fTt9YW50aUNoYW5nZXMucHVzaChoaXN0b3J5Q2hhbmdlRnJvbUNoYW5nZShkb2MsY2hhbmdlKSk7dmFyIGFmdGVyPWk/Y29tcHV0ZVNlbEFmdGVyQ2hhbmdlKGRvYyxjaGFuZ2UpOmxzdChzb3VyY2UpO21ha2VDaGFuZ2VTaW5nbGVEb2MoZG9jLGNoYW5nZSxhZnRlcixtZXJnZU9sZFNwYW5zKGRvYyxjaGFuZ2UpKTtpZighaSYmZG9jLmNtKXtkb2MuY20uc2Nyb2xsSW50b1ZpZXcoe2Zyb206Y2hhbmdlLmZyb20sdG86Y2hhbmdlRW5kKGNoYW5nZSl9KTt9dmFyIHJlYmFzZWQ9W107Ly8gUHJvcGFnYXRlIHRvIHRoZSBsaW5rZWQgZG9jdW1lbnRzXG5saW5rZWREb2NzKGRvYyxmdW5jdGlvbihkb2Msc2hhcmVkSGlzdCl7aWYoIXNoYXJlZEhpc3QmJmluZGV4T2YocmViYXNlZCxkb2MuaGlzdG9yeSk9PS0xKXtyZWJhc2VIaXN0KGRvYy5oaXN0b3J5LGNoYW5nZSk7cmViYXNlZC5wdXNoKGRvYy5oaXN0b3J5KTt9bWFrZUNoYW5nZVNpbmdsZURvYyhkb2MsY2hhbmdlLG51bGwsbWVyZ2VPbGRTcGFucyhkb2MsY2hhbmdlKSk7fSk7fTtmb3IodmFyIGkkMT1ldmVudC5jaGFuZ2VzLmxlbmd0aC0xO2kkMT49MDstLWkkMSl7dmFyIHJldHVybmVkPWxvb3AoaSQxKTtpZihyZXR1cm5lZClyZXR1cm4gcmV0dXJuZWQudjt9fS8vIFN1Yi12aWV3cyBuZWVkIHRoZWlyIGxpbmUgbnVtYmVycyBzaGlmdGVkIHdoZW4gdGV4dCBpcyBhZGRlZFxuLy8gYWJvdmUgb3IgYmVsb3cgdGhlbSBpbiB0aGUgcGFyZW50IGRvY3VtZW50LlxuZnVuY3Rpb24gc2hpZnREb2MoZG9jLGRpc3RhbmNlKXtpZihkaXN0YW5jZT09MCl7cmV0dXJuO31kb2MuZmlyc3QrPWRpc3RhbmNlO2RvYy5zZWw9bmV3IFNlbGVjdGlvbihtYXAoZG9jLnNlbC5yYW5nZXMsZnVuY3Rpb24ocmFuZ2Upe3JldHVybiBuZXcgUmFuZ2UoUG9zKHJhbmdlLmFuY2hvci5saW5lK2Rpc3RhbmNlLHJhbmdlLmFuY2hvci5jaCksUG9zKHJhbmdlLmhlYWQubGluZStkaXN0YW5jZSxyYW5nZS5oZWFkLmNoKSk7fSksZG9jLnNlbC5wcmltSW5kZXgpO2lmKGRvYy5jbSl7cmVnQ2hhbmdlKGRvYy5jbSxkb2MuZmlyc3QsZG9jLmZpcnN0LWRpc3RhbmNlLGRpc3RhbmNlKTtmb3IodmFyIGQ9ZG9jLmNtLmRpc3BsYXksbD1kLnZpZXdGcm9tO2w8ZC52aWV3VG87bCsrKXtyZWdMaW5lQ2hhbmdlKGRvYy5jbSxsLFwiZ3V0dGVyXCIpO319fS8vIE1vcmUgbG93ZXItbGV2ZWwgY2hhbmdlIGZ1bmN0aW9uLCBoYW5kbGluZyBvbmx5IGEgc2luZ2xlIGRvY3VtZW50XG4vLyAobm90IGxpbmtlZCBvbmVzKS5cbmZ1bmN0aW9uIG1ha2VDaGFuZ2VTaW5nbGVEb2MoZG9jLGNoYW5nZSxzZWxBZnRlcixzcGFucyl7aWYoZG9jLmNtJiYhZG9jLmNtLmN1ck9wKXtyZXR1cm4gb3BlcmF0aW9uKGRvYy5jbSxtYWtlQ2hhbmdlU2luZ2xlRG9jKShkb2MsY2hhbmdlLHNlbEFmdGVyLHNwYW5zKTt9aWYoY2hhbmdlLnRvLmxpbmU8ZG9jLmZpcnN0KXtzaGlmdERvYyhkb2MsY2hhbmdlLnRleHQubGVuZ3RoLTEtKGNoYW5nZS50by5saW5lLWNoYW5nZS5mcm9tLmxpbmUpKTtyZXR1cm47fWlmKGNoYW5nZS5mcm9tLmxpbmU+ZG9jLmxhc3RMaW5lKCkpe3JldHVybjt9Ly8gQ2xpcCB0aGUgY2hhbmdlIHRvIHRoZSBzaXplIG9mIHRoaXMgZG9jXG5pZihjaGFuZ2UuZnJvbS5saW5lPGRvYy5maXJzdCl7dmFyIHNoaWZ0PWNoYW5nZS50ZXh0Lmxlbmd0aC0xLShkb2MuZmlyc3QtY2hhbmdlLmZyb20ubGluZSk7c2hpZnREb2MoZG9jLHNoaWZ0KTtjaGFuZ2U9e2Zyb206UG9zKGRvYy5maXJzdCwwKSx0bzpQb3MoY2hhbmdlLnRvLmxpbmUrc2hpZnQsY2hhbmdlLnRvLmNoKSx0ZXh0Oltsc3QoY2hhbmdlLnRleHQpXSxvcmlnaW46Y2hhbmdlLm9yaWdpbn07fXZhciBsYXN0PWRvYy5sYXN0TGluZSgpO2lmKGNoYW5nZS50by5saW5lPmxhc3Qpe2NoYW5nZT17ZnJvbTpjaGFuZ2UuZnJvbSx0bzpQb3MobGFzdCxnZXRMaW5lKGRvYyxsYXN0KS50ZXh0Lmxlbmd0aCksdGV4dDpbY2hhbmdlLnRleHRbMF1dLG9yaWdpbjpjaGFuZ2Uub3JpZ2lufTt9Y2hhbmdlLnJlbW92ZWQ9Z2V0QmV0d2Vlbihkb2MsY2hhbmdlLmZyb20sY2hhbmdlLnRvKTtpZighc2VsQWZ0ZXIpe3NlbEFmdGVyPWNvbXB1dGVTZWxBZnRlckNoYW5nZShkb2MsY2hhbmdlKTt9aWYoZG9jLmNtKXttYWtlQ2hhbmdlU2luZ2xlRG9jSW5FZGl0b3IoZG9jLmNtLGNoYW5nZSxzcGFucyk7fWVsc2V7dXBkYXRlRG9jKGRvYyxjaGFuZ2Usc3BhbnMpO31zZXRTZWxlY3Rpb25Ob1VuZG8oZG9jLHNlbEFmdGVyLHNlbF9kb250U2Nyb2xsKTt9Ly8gSGFuZGxlIHRoZSBpbnRlcmFjdGlvbiBvZiBhIGNoYW5nZSB0byBhIGRvY3VtZW50IHdpdGggdGhlIGVkaXRvclxuLy8gdGhhdCB0aGlzIGRvY3VtZW50IGlzIHBhcnQgb2YuXG5mdW5jdGlvbiBtYWtlQ2hhbmdlU2luZ2xlRG9jSW5FZGl0b3IoY20sY2hhbmdlLHNwYW5zKXt2YXIgZG9jPWNtLmRvYyxkaXNwbGF5PWNtLmRpc3BsYXksZnJvbT1jaGFuZ2UuZnJvbSx0bz1jaGFuZ2UudG87dmFyIHJlY29tcHV0ZU1heExlbmd0aD1mYWxzZSxjaGVja1dpZHRoU3RhcnQ9ZnJvbS5saW5lO2lmKCFjbS5vcHRpb25zLmxpbmVXcmFwcGluZyl7Y2hlY2tXaWR0aFN0YXJ0PWxpbmVObyh2aXN1YWxMaW5lKGdldExpbmUoZG9jLGZyb20ubGluZSkpKTtkb2MuaXRlcihjaGVja1dpZHRoU3RhcnQsdG8ubGluZSsxLGZ1bmN0aW9uKGxpbmUpe2lmKGxpbmU9PWRpc3BsYXkubWF4TGluZSl7cmVjb21wdXRlTWF4TGVuZ3RoPXRydWU7cmV0dXJuIHRydWU7fX0pO31pZihkb2Muc2VsLmNvbnRhaW5zKGNoYW5nZS5mcm9tLGNoYW5nZS50byk+LTEpe3NpZ25hbEN1cnNvckFjdGl2aXR5KGNtKTt9dXBkYXRlRG9jKGRvYyxjaGFuZ2Usc3BhbnMsZXN0aW1hdGVIZWlnaHQoY20pKTtpZighY20ub3B0aW9ucy5saW5lV3JhcHBpbmcpe2RvYy5pdGVyKGNoZWNrV2lkdGhTdGFydCxmcm9tLmxpbmUrY2hhbmdlLnRleHQubGVuZ3RoLGZ1bmN0aW9uKGxpbmUpe3ZhciBsZW49bGluZUxlbmd0aChsaW5lKTtpZihsZW4+ZGlzcGxheS5tYXhMaW5lTGVuZ3RoKXtkaXNwbGF5Lm1heExpbmU9bGluZTtkaXNwbGF5Lm1heExpbmVMZW5ndGg9bGVuO2Rpc3BsYXkubWF4TGluZUNoYW5nZWQ9dHJ1ZTtyZWNvbXB1dGVNYXhMZW5ndGg9ZmFsc2U7fX0pO2lmKHJlY29tcHV0ZU1heExlbmd0aCl7Y20uY3VyT3AudXBkYXRlTWF4TGluZT10cnVlO319Ly8gQWRqdXN0IGZyb250aWVyLCBzY2hlZHVsZSB3b3JrZXJcbmRvYy5mcm9udGllcj1NYXRoLm1pbihkb2MuZnJvbnRpZXIsZnJvbS5saW5lKTtzdGFydFdvcmtlcihjbSw0MDApO3ZhciBsZW5kaWZmPWNoYW5nZS50ZXh0Lmxlbmd0aC0odG8ubGluZS1mcm9tLmxpbmUpLTE7Ly8gUmVtZW1iZXIgdGhhdCB0aGVzZSBsaW5lcyBjaGFuZ2VkLCBmb3IgdXBkYXRpbmcgdGhlIGRpc3BsYXlcbmlmKGNoYW5nZS5mdWxsKXtyZWdDaGFuZ2UoY20pO31lbHNlIGlmKGZyb20ubGluZT09dG8ubGluZSYmY2hhbmdlLnRleHQubGVuZ3RoPT0xJiYhaXNXaG9sZUxpbmVVcGRhdGUoY20uZG9jLGNoYW5nZSkpe3JlZ0xpbmVDaGFuZ2UoY20sZnJvbS5saW5lLFwidGV4dFwiKTt9ZWxzZXtyZWdDaGFuZ2UoY20sZnJvbS5saW5lLHRvLmxpbmUrMSxsZW5kaWZmKTt9dmFyIGNoYW5nZXNIYW5kbGVyPWhhc0hhbmRsZXIoY20sXCJjaGFuZ2VzXCIpLGNoYW5nZUhhbmRsZXI9aGFzSGFuZGxlcihjbSxcImNoYW5nZVwiKTtpZihjaGFuZ2VIYW5kbGVyfHxjaGFuZ2VzSGFuZGxlcil7dmFyIG9iaj17ZnJvbTpmcm9tLHRvOnRvLHRleHQ6Y2hhbmdlLnRleHQscmVtb3ZlZDpjaGFuZ2UucmVtb3ZlZCxvcmlnaW46Y2hhbmdlLm9yaWdpbn07aWYoY2hhbmdlSGFuZGxlcil7c2lnbmFsTGF0ZXIoY20sXCJjaGFuZ2VcIixjbSxvYmopO31pZihjaGFuZ2VzSGFuZGxlcil7KGNtLmN1ck9wLmNoYW5nZU9ianN8fChjbS5jdXJPcC5jaGFuZ2VPYmpzPVtdKSkucHVzaChvYmopO319Y20uZGlzcGxheS5zZWxGb3JDb250ZXh0TWVudT1udWxsO31mdW5jdGlvbiByZXBsYWNlUmFuZ2UoZG9jLGNvZGUsZnJvbSx0byxvcmlnaW4pe2lmKCF0byl7dG89ZnJvbTt9aWYoY21wKHRvLGZyb20pPDApe3ZhciB0bXA9dG87dG89ZnJvbTtmcm9tPXRtcDt9aWYodHlwZW9mIGNvZGU9PVwic3RyaW5nXCIpe2NvZGU9ZG9jLnNwbGl0TGluZXMoY29kZSk7fW1ha2VDaGFuZ2UoZG9jLHtmcm9tOmZyb20sdG86dG8sdGV4dDpjb2RlLG9yaWdpbjpvcmlnaW59KTt9Ly8gUmViYXNpbmcvcmVzZXR0aW5nIGhpc3RvcnkgdG8gZGVhbCB3aXRoIGV4dGVybmFsbHktc291cmNlZCBjaGFuZ2VzXG5mdW5jdGlvbiByZWJhc2VIaXN0U2VsU2luZ2xlKHBvcyxmcm9tLHRvLGRpZmYpe2lmKHRvPHBvcy5saW5lKXtwb3MubGluZSs9ZGlmZjt9ZWxzZSBpZihmcm9tPHBvcy5saW5lKXtwb3MubGluZT1mcm9tO3Bvcy5jaD0wO319Ly8gVHJpZXMgdG8gcmViYXNlIGFuIGFycmF5IG9mIGhpc3RvcnkgZXZlbnRzIGdpdmVuIGEgY2hhbmdlIGluIHRoZVxuLy8gZG9jdW1lbnQuIElmIHRoZSBjaGFuZ2UgdG91Y2hlcyB0aGUgc2FtZSBsaW5lcyBhcyB0aGUgZXZlbnQsIHRoZVxuLy8gZXZlbnQsIGFuZCBldmVyeXRoaW5nICdiZWhpbmQnIGl0LCBpcyBkaXNjYXJkZWQuIElmIHRoZSBjaGFuZ2UgaXNcbi8vIGJlZm9yZSB0aGUgZXZlbnQsIHRoZSBldmVudCdzIHBvc2l0aW9ucyBhcmUgdXBkYXRlZC4gVXNlcyBhXG4vLyBjb3B5LW9uLXdyaXRlIHNjaGVtZSBmb3IgdGhlIHBvc2l0aW9ucywgdG8gYXZvaWQgaGF2aW5nIHRvXG4vLyByZWFsbG9jYXRlIHRoZW0gYWxsIG9uIGV2ZXJ5IHJlYmFzZSwgYnV0IGFsc28gYXZvaWQgcHJvYmxlbXMgd2l0aFxuLy8gc2hhcmVkIHBvc2l0aW9uIG9iamVjdHMgYmVpbmcgdW5zYWZlbHkgdXBkYXRlZC5cbmZ1bmN0aW9uIHJlYmFzZUhpc3RBcnJheShhcnJheSxmcm9tLHRvLGRpZmYpe2Zvcih2YXIgaT0wO2k8YXJyYXkubGVuZ3RoOysraSl7dmFyIHN1Yj1hcnJheVtpXSxvaz10cnVlO2lmKHN1Yi5yYW5nZXMpe2lmKCFzdWIuY29waWVkKXtzdWI9YXJyYXlbaV09c3ViLmRlZXBDb3B5KCk7c3ViLmNvcGllZD10cnVlO31mb3IodmFyIGo9MDtqPHN1Yi5yYW5nZXMubGVuZ3RoO2orKyl7cmViYXNlSGlzdFNlbFNpbmdsZShzdWIucmFuZ2VzW2pdLmFuY2hvcixmcm9tLHRvLGRpZmYpO3JlYmFzZUhpc3RTZWxTaW5nbGUoc3ViLnJhbmdlc1tqXS5oZWFkLGZyb20sdG8sZGlmZik7fWNvbnRpbnVlO31mb3IodmFyIGokMT0wO2okMTxzdWIuY2hhbmdlcy5sZW5ndGg7KytqJDEpe3ZhciBjdXI9c3ViLmNoYW5nZXNbaiQxXTtpZih0bzxjdXIuZnJvbS5saW5lKXtjdXIuZnJvbT1Qb3MoY3VyLmZyb20ubGluZStkaWZmLGN1ci5mcm9tLmNoKTtjdXIudG89UG9zKGN1ci50by5saW5lK2RpZmYsY3VyLnRvLmNoKTt9ZWxzZSBpZihmcm9tPD1jdXIudG8ubGluZSl7b2s9ZmFsc2U7YnJlYWs7fX1pZighb2spe2FycmF5LnNwbGljZSgwLGkrMSk7aT0wO319fWZ1bmN0aW9uIHJlYmFzZUhpc3QoaGlzdCxjaGFuZ2Upe3ZhciBmcm9tPWNoYW5nZS5mcm9tLmxpbmUsdG89Y2hhbmdlLnRvLmxpbmUsZGlmZj1jaGFuZ2UudGV4dC5sZW5ndGgtKHRvLWZyb20pLTE7cmViYXNlSGlzdEFycmF5KGhpc3QuZG9uZSxmcm9tLHRvLGRpZmYpO3JlYmFzZUhpc3RBcnJheShoaXN0LnVuZG9uZSxmcm9tLHRvLGRpZmYpO30vLyBVdGlsaXR5IGZvciBhcHBseWluZyBhIGNoYW5nZSB0byBhIGxpbmUgYnkgaGFuZGxlIG9yIG51bWJlcixcbi8vIHJldHVybmluZyB0aGUgbnVtYmVyIGFuZCBvcHRpb25hbGx5IHJlZ2lzdGVyaW5nIHRoZSBsaW5lIGFzXG4vLyBjaGFuZ2VkLlxuZnVuY3Rpb24gY2hhbmdlTGluZShkb2MsaGFuZGxlLGNoYW5nZVR5cGUsb3Ape3ZhciBubz1oYW5kbGUsbGluZT1oYW5kbGU7aWYodHlwZW9mIGhhbmRsZT09XCJudW1iZXJcIil7bGluZT1nZXRMaW5lKGRvYyxjbGlwTGluZShkb2MsaGFuZGxlKSk7fWVsc2V7bm89bGluZU5vKGhhbmRsZSk7fWlmKG5vPT1udWxsKXtyZXR1cm4gbnVsbDt9aWYob3AobGluZSxubykmJmRvYy5jbSl7cmVnTGluZUNoYW5nZShkb2MuY20sbm8sY2hhbmdlVHlwZSk7fXJldHVybiBsaW5lO30vLyBUaGUgZG9jdW1lbnQgaXMgcmVwcmVzZW50ZWQgYXMgYSBCVHJlZSBjb25zaXN0aW5nIG9mIGxlYXZlcywgd2l0aFxuLy8gY2h1bmsgb2YgbGluZXMgaW4gdGhlbSwgYW5kIGJyYW5jaGVzLCB3aXRoIHVwIHRvIHRlbiBsZWF2ZXMgb3Jcbi8vIG90aGVyIGJyYW5jaCBub2RlcyBiZWxvdyB0aGVtLiBUaGUgdG9wIG5vZGUgaXMgYWx3YXlzIGEgYnJhbmNoXG4vLyBub2RlLCBhbmQgaXMgdGhlIGRvY3VtZW50IG9iamVjdCBpdHNlbGYgKG1lYW5pbmcgaXQgaGFzXG4vLyBhZGRpdGlvbmFsIG1ldGhvZHMgYW5kIHByb3BlcnRpZXMpLlxuLy9cbi8vIEFsbCBub2RlcyBoYXZlIHBhcmVudCBsaW5rcy4gVGhlIHRyZWUgaXMgdXNlZCBib3RoIHRvIGdvIGZyb21cbi8vIGxpbmUgbnVtYmVycyB0byBsaW5lIG9iamVjdHMsIGFuZCB0byBnbyBmcm9tIG9iamVjdHMgdG8gbnVtYmVycy5cbi8vIEl0IGFsc28gaW5kZXhlcyBieSBoZWlnaHQsIGFuZCBpcyB1c2VkIHRvIGNvbnZlcnQgYmV0d2VlbiBoZWlnaHRcbi8vIGFuZCBsaW5lIG9iamVjdCwgYW5kIHRvIGZpbmQgdGhlIHRvdGFsIGhlaWdodCBvZiB0aGUgZG9jdW1lbnQuXG4vL1xuLy8gU2VlIGFsc28gaHR0cDovL21hcmlqbmhhdmVyYmVrZS5ubC9ibG9nL2NvZGVtaXJyb3ItbGluZS10cmVlLmh0bWxcbmZ1bmN0aW9uIExlYWZDaHVuayhsaW5lcyl7dmFyIHRoaXMkMT10aGlzO3RoaXMubGluZXM9bGluZXM7dGhpcy5wYXJlbnQ9bnVsbDt2YXIgaGVpZ2h0PTA7Zm9yKHZhciBpPTA7aTxsaW5lcy5sZW5ndGg7KytpKXtsaW5lc1tpXS5wYXJlbnQ9dGhpcyQxO2hlaWdodCs9bGluZXNbaV0uaGVpZ2h0O310aGlzLmhlaWdodD1oZWlnaHQ7fUxlYWZDaHVuay5wcm90b3R5cGU9e2NodW5rU2l6ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmxpbmVzLmxlbmd0aDt9LC8vIFJlbW92ZSB0aGUgbiBsaW5lcyBhdCBvZmZzZXQgJ2F0Jy5cbnJlbW92ZUlubmVyOmZ1bmN0aW9uKGF0LG4pe3ZhciB0aGlzJDE9dGhpcztmb3IodmFyIGk9YXQsZT1hdCtuO2k8ZTsrK2kpe3ZhciBsaW5lPXRoaXMkMS5saW5lc1tpXTt0aGlzJDEuaGVpZ2h0LT1saW5lLmhlaWdodDtjbGVhblVwTGluZShsaW5lKTtzaWduYWxMYXRlcihsaW5lLFwiZGVsZXRlXCIpO310aGlzLmxpbmVzLnNwbGljZShhdCxuKTt9LC8vIEhlbHBlciB1c2VkIHRvIGNvbGxhcHNlIGEgc21hbGwgYnJhbmNoIGludG8gYSBzaW5nbGUgbGVhZi5cbmNvbGxhcHNlOmZ1bmN0aW9uKGxpbmVzKXtsaW5lcy5wdXNoLmFwcGx5KGxpbmVzLHRoaXMubGluZXMpO30sLy8gSW5zZXJ0IHRoZSBnaXZlbiBhcnJheSBvZiBsaW5lcyBhdCBvZmZzZXQgJ2F0JywgY291bnQgdGhlbSBhc1xuLy8gaGF2aW5nIHRoZSBnaXZlbiBoZWlnaHQuXG5pbnNlcnRJbm5lcjpmdW5jdGlvbihhdCxsaW5lcyxoZWlnaHQpe3ZhciB0aGlzJDE9dGhpczt0aGlzLmhlaWdodCs9aGVpZ2h0O3RoaXMubGluZXM9dGhpcy5saW5lcy5zbGljZSgwLGF0KS5jb25jYXQobGluZXMpLmNvbmNhdCh0aGlzLmxpbmVzLnNsaWNlKGF0KSk7Zm9yKHZhciBpPTA7aTxsaW5lcy5sZW5ndGg7KytpKXtsaW5lc1tpXS5wYXJlbnQ9dGhpcyQxO319LC8vIFVzZWQgdG8gaXRlcmF0ZSBvdmVyIGEgcGFydCBvZiB0aGUgdHJlZS5cbml0ZXJOOmZ1bmN0aW9uKGF0LG4sb3Ape3ZhciB0aGlzJDE9dGhpcztmb3IodmFyIGU9YXQrbjthdDxlOysrYXQpe2lmKG9wKHRoaXMkMS5saW5lc1thdF0pKXtyZXR1cm4gdHJ1ZTt9fX19O2Z1bmN0aW9uIEJyYW5jaENodW5rKGNoaWxkcmVuKXt2YXIgdGhpcyQxPXRoaXM7dGhpcy5jaGlsZHJlbj1jaGlsZHJlbjt2YXIgc2l6ZT0wLGhlaWdodD0wO2Zvcih2YXIgaT0wO2k8Y2hpbGRyZW4ubGVuZ3RoOysraSl7dmFyIGNoPWNoaWxkcmVuW2ldO3NpemUrPWNoLmNodW5rU2l6ZSgpO2hlaWdodCs9Y2guaGVpZ2h0O2NoLnBhcmVudD10aGlzJDE7fXRoaXMuc2l6ZT1zaXplO3RoaXMuaGVpZ2h0PWhlaWdodDt0aGlzLnBhcmVudD1udWxsO31CcmFuY2hDaHVuay5wcm90b3R5cGU9e2NodW5rU2l6ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnNpemU7fSxyZW1vdmVJbm5lcjpmdW5jdGlvbihhdCxuKXt2YXIgdGhpcyQxPXRoaXM7dGhpcy5zaXplLT1uO2Zvcih2YXIgaT0wO2k8dGhpcy5jaGlsZHJlbi5sZW5ndGg7KytpKXt2YXIgY2hpbGQ9dGhpcyQxLmNoaWxkcmVuW2ldLHN6PWNoaWxkLmNodW5rU2l6ZSgpO2lmKGF0PHN6KXt2YXIgcm09TWF0aC5taW4obixzei1hdCksb2xkSGVpZ2h0PWNoaWxkLmhlaWdodDtjaGlsZC5yZW1vdmVJbm5lcihhdCxybSk7dGhpcyQxLmhlaWdodC09b2xkSGVpZ2h0LWNoaWxkLmhlaWdodDtpZihzej09cm0pe3RoaXMkMS5jaGlsZHJlbi5zcGxpY2UoaS0tLDEpO2NoaWxkLnBhcmVudD1udWxsO31pZigobi09cm0pPT0wKXticmVhazt9YXQ9MDt9ZWxzZXthdC09c3o7fX0vLyBJZiB0aGUgcmVzdWx0IGlzIHNtYWxsZXIgdGhhbiAyNSBsaW5lcywgZW5zdXJlIHRoYXQgaXQgaXMgYVxuLy8gc2luZ2xlIGxlYWYgbm9kZS5cbmlmKHRoaXMuc2l6ZS1uPDI1JiYodGhpcy5jaGlsZHJlbi5sZW5ndGg+MXx8ISh0aGlzLmNoaWxkcmVuWzBdaW5zdGFuY2VvZiBMZWFmQ2h1bmspKSl7dmFyIGxpbmVzPVtdO3RoaXMuY29sbGFwc2UobGluZXMpO3RoaXMuY2hpbGRyZW49W25ldyBMZWFmQ2h1bmsobGluZXMpXTt0aGlzLmNoaWxkcmVuWzBdLnBhcmVudD10aGlzO319LGNvbGxhcHNlOmZ1bmN0aW9uKGxpbmVzKXt2YXIgdGhpcyQxPXRoaXM7Zm9yKHZhciBpPTA7aTx0aGlzLmNoaWxkcmVuLmxlbmd0aDsrK2kpe3RoaXMkMS5jaGlsZHJlbltpXS5jb2xsYXBzZShsaW5lcyk7fX0saW5zZXJ0SW5uZXI6ZnVuY3Rpb24oYXQsbGluZXMsaGVpZ2h0KXt2YXIgdGhpcyQxPXRoaXM7dGhpcy5zaXplKz1saW5lcy5sZW5ndGg7dGhpcy5oZWlnaHQrPWhlaWdodDtmb3IodmFyIGk9MDtpPHRoaXMuY2hpbGRyZW4ubGVuZ3RoOysraSl7dmFyIGNoaWxkPXRoaXMkMS5jaGlsZHJlbltpXSxzej1jaGlsZC5jaHVua1NpemUoKTtpZihhdDw9c3ope2NoaWxkLmluc2VydElubmVyKGF0LGxpbmVzLGhlaWdodCk7aWYoY2hpbGQubGluZXMmJmNoaWxkLmxpbmVzLmxlbmd0aD41MCl7Ly8gVG8gYXZvaWQgbWVtb3J5IHRocmFzaGluZyB3aGVuIGNoaWxkLmxpbmVzIGlzIGh1Z2UgKGUuZy4gZmlyc3QgdmlldyBvZiBhIGxhcmdlIGZpbGUpLCBpdCdzIG5ldmVyIHNwbGljZWQuXG4vLyBJbnN0ZWFkLCBzbWFsbCBzbGljZXMgYXJlIHRha2VuLiBUaGV5J3JlIHRha2VuIGluIG9yZGVyIGJlY2F1c2Ugc2VxdWVudGlhbCBtZW1vcnkgYWNjZXNzZXMgYXJlIGZhc3Rlc3QuXG52YXIgcmVtYWluaW5nPWNoaWxkLmxpbmVzLmxlbmd0aCUyNSsyNTtmb3IodmFyIHBvcz1yZW1haW5pbmc7cG9zPGNoaWxkLmxpbmVzLmxlbmd0aDspe3ZhciBsZWFmPW5ldyBMZWFmQ2h1bmsoY2hpbGQubGluZXMuc2xpY2UocG9zLHBvcys9MjUpKTtjaGlsZC5oZWlnaHQtPWxlYWYuaGVpZ2h0O3RoaXMkMS5jaGlsZHJlbi5zcGxpY2UoKytpLDAsbGVhZik7bGVhZi5wYXJlbnQ9dGhpcyQxO31jaGlsZC5saW5lcz1jaGlsZC5saW5lcy5zbGljZSgwLHJlbWFpbmluZyk7dGhpcyQxLm1heWJlU3BpbGwoKTt9YnJlYWs7fWF0LT1zejt9fSwvLyBXaGVuIGEgbm9kZSBoYXMgZ3Jvd24sIGNoZWNrIHdoZXRoZXIgaXQgc2hvdWxkIGJlIHNwbGl0LlxubWF5YmVTcGlsbDpmdW5jdGlvbigpe2lmKHRoaXMuY2hpbGRyZW4ubGVuZ3RoPD0xMCl7cmV0dXJuO312YXIgbWU9dGhpcztkb3t2YXIgc3BpbGxlZD1tZS5jaGlsZHJlbi5zcGxpY2UobWUuY2hpbGRyZW4ubGVuZ3RoLTUsNSk7dmFyIHNpYmxpbmc9bmV3IEJyYW5jaENodW5rKHNwaWxsZWQpO2lmKCFtZS5wYXJlbnQpey8vIEJlY29tZSB0aGUgcGFyZW50IG5vZGVcbnZhciBjb3B5PW5ldyBCcmFuY2hDaHVuayhtZS5jaGlsZHJlbik7Y29weS5wYXJlbnQ9bWU7bWUuY2hpbGRyZW49W2NvcHksc2libGluZ107bWU9Y29weTt9ZWxzZXttZS5zaXplLT1zaWJsaW5nLnNpemU7bWUuaGVpZ2h0LT1zaWJsaW5nLmhlaWdodDt2YXIgbXlJbmRleD1pbmRleE9mKG1lLnBhcmVudC5jaGlsZHJlbixtZSk7bWUucGFyZW50LmNoaWxkcmVuLnNwbGljZShteUluZGV4KzEsMCxzaWJsaW5nKTt9c2libGluZy5wYXJlbnQ9bWUucGFyZW50O313aGlsZShtZS5jaGlsZHJlbi5sZW5ndGg+MTApO21lLnBhcmVudC5tYXliZVNwaWxsKCk7fSxpdGVyTjpmdW5jdGlvbihhdCxuLG9wKXt2YXIgdGhpcyQxPXRoaXM7Zm9yKHZhciBpPTA7aTx0aGlzLmNoaWxkcmVuLmxlbmd0aDsrK2kpe3ZhciBjaGlsZD10aGlzJDEuY2hpbGRyZW5baV0sc3o9Y2hpbGQuY2h1bmtTaXplKCk7aWYoYXQ8c3ope3ZhciB1c2VkPU1hdGgubWluKG4sc3otYXQpO2lmKGNoaWxkLml0ZXJOKGF0LHVzZWQsb3ApKXtyZXR1cm4gdHJ1ZTt9aWYoKG4tPXVzZWQpPT0wKXticmVhazt9YXQ9MDt9ZWxzZXthdC09c3o7fX19fTsvLyBMaW5lIHdpZGdldHMgYXJlIGJsb2NrIGVsZW1lbnRzIGRpc3BsYXllZCBhYm92ZSBvciBiZWxvdyBhIGxpbmUuXG5mdW5jdGlvbiBMaW5lV2lkZ2V0KGRvYyxub2RlLG9wdGlvbnMpe3ZhciB0aGlzJDE9dGhpcztpZihvcHRpb25zKXtmb3IodmFyIG9wdCBpbiBvcHRpb25zKXtpZihvcHRpb25zLmhhc093blByb3BlcnR5KG9wdCkpe3RoaXMkMVtvcHRdPW9wdGlvbnNbb3B0XTt9fX10aGlzLmRvYz1kb2M7dGhpcy5ub2RlPW5vZGU7fWV2ZW50TWl4aW4oTGluZVdpZGdldCk7ZnVuY3Rpb24gYWRqdXN0U2Nyb2xsV2hlbkFib3ZlVmlzaWJsZShjbSxsaW5lLGRpZmYpe2lmKGhlaWdodEF0TGluZShsaW5lKTwoY20uY3VyT3AmJmNtLmN1ck9wLnNjcm9sbFRvcHx8Y20uZG9jLnNjcm9sbFRvcCkpe2FkZFRvU2Nyb2xsUG9zKGNtLG51bGwsZGlmZik7fX1MaW5lV2lkZ2V0LnByb3RvdHlwZS5jbGVhcj1mdW5jdGlvbigpe3ZhciB0aGlzJDE9dGhpczt2YXIgY209dGhpcy5kb2MuY20sd3M9dGhpcy5saW5lLndpZGdldHMsbGluZT10aGlzLmxpbmUsbm89bGluZU5vKGxpbmUpO2lmKG5vPT1udWxsfHwhd3Mpe3JldHVybjt9Zm9yKHZhciBpPTA7aTx3cy5sZW5ndGg7KytpKXtpZih3c1tpXT09dGhpcyQxKXt3cy5zcGxpY2UoaS0tLDEpO319aWYoIXdzLmxlbmd0aCl7bGluZS53aWRnZXRzPW51bGw7fXZhciBoZWlnaHQ9d2lkZ2V0SGVpZ2h0KHRoaXMpO3VwZGF0ZUxpbmVIZWlnaHQobGluZSxNYXRoLm1heCgwLGxpbmUuaGVpZ2h0LWhlaWdodCkpO2lmKGNtKXtydW5Jbk9wKGNtLGZ1bmN0aW9uKCl7YWRqdXN0U2Nyb2xsV2hlbkFib3ZlVmlzaWJsZShjbSxsaW5lLC1oZWlnaHQpO3JlZ0xpbmVDaGFuZ2UoY20sbm8sXCJ3aWRnZXRcIik7fSk7fX07TGluZVdpZGdldC5wcm90b3R5cGUuY2hhbmdlZD1mdW5jdGlvbigpe3ZhciBvbGRIPXRoaXMuaGVpZ2h0LGNtPXRoaXMuZG9jLmNtLGxpbmU9dGhpcy5saW5lO3RoaXMuaGVpZ2h0PW51bGw7dmFyIGRpZmY9d2lkZ2V0SGVpZ2h0KHRoaXMpLW9sZEg7aWYoIWRpZmYpe3JldHVybjt9dXBkYXRlTGluZUhlaWdodChsaW5lLGxpbmUuaGVpZ2h0K2RpZmYpO2lmKGNtKXtydW5Jbk9wKGNtLGZ1bmN0aW9uKCl7Y20uY3VyT3AuZm9yY2VVcGRhdGU9dHJ1ZTthZGp1c3RTY3JvbGxXaGVuQWJvdmVWaXNpYmxlKGNtLGxpbmUsZGlmZik7fSk7fX07ZnVuY3Rpb24gYWRkTGluZVdpZGdldChkb2MsaGFuZGxlLG5vZGUsb3B0aW9ucyl7dmFyIHdpZGdldD1uZXcgTGluZVdpZGdldChkb2Msbm9kZSxvcHRpb25zKTt2YXIgY209ZG9jLmNtO2lmKGNtJiZ3aWRnZXQubm9IU2Nyb2xsKXtjbS5kaXNwbGF5LmFsaWduV2lkZ2V0cz10cnVlO31jaGFuZ2VMaW5lKGRvYyxoYW5kbGUsXCJ3aWRnZXRcIixmdW5jdGlvbihsaW5lKXt2YXIgd2lkZ2V0cz1saW5lLndpZGdldHN8fChsaW5lLndpZGdldHM9W10pO2lmKHdpZGdldC5pbnNlcnRBdD09bnVsbCl7d2lkZ2V0cy5wdXNoKHdpZGdldCk7fWVsc2V7d2lkZ2V0cy5zcGxpY2UoTWF0aC5taW4od2lkZ2V0cy5sZW5ndGgtMSxNYXRoLm1heCgwLHdpZGdldC5pbnNlcnRBdCkpLDAsd2lkZ2V0KTt9d2lkZ2V0LmxpbmU9bGluZTtpZihjbSYmIWxpbmVJc0hpZGRlbihkb2MsbGluZSkpe3ZhciBhYm92ZVZpc2libGU9aGVpZ2h0QXRMaW5lKGxpbmUpPGRvYy5zY3JvbGxUb3A7dXBkYXRlTGluZUhlaWdodChsaW5lLGxpbmUuaGVpZ2h0K3dpZGdldEhlaWdodCh3aWRnZXQpKTtpZihhYm92ZVZpc2libGUpe2FkZFRvU2Nyb2xsUG9zKGNtLG51bGwsd2lkZ2V0LmhlaWdodCk7fWNtLmN1ck9wLmZvcmNlVXBkYXRlPXRydWU7fXJldHVybiB0cnVlO30pO3JldHVybiB3aWRnZXQ7fS8vIFRFWFRNQVJLRVJTXG4vLyBDcmVhdGVkIHdpdGggbWFya1RleHQgYW5kIHNldEJvb2ttYXJrIG1ldGhvZHMuIEEgVGV4dE1hcmtlciBpcyBhXG4vLyBoYW5kbGUgdGhhdCBjYW4gYmUgdXNlZCB0byBjbGVhciBvciBmaW5kIGEgbWFya2VkIHBvc2l0aW9uIGluIHRoZVxuLy8gZG9jdW1lbnQuIExpbmUgb2JqZWN0cyBob2xkIGFycmF5cyAobWFya2VkU3BhbnMpIGNvbnRhaW5pbmdcbi8vIHtmcm9tLCB0bywgbWFya2VyfSBvYmplY3QgcG9pbnRpbmcgdG8gc3VjaCBtYXJrZXIgb2JqZWN0cywgYW5kXG4vLyBpbmRpY2F0aW5nIHRoYXQgc3VjaCBhIG1hcmtlciBpcyBwcmVzZW50IG9uIHRoYXQgbGluZS4gTXVsdGlwbGVcbi8vIGxpbmVzIG1heSBwb2ludCB0byB0aGUgc2FtZSBtYXJrZXIgd2hlbiBpdCBzcGFucyBhY3Jvc3MgbGluZXMuXG4vLyBUaGUgc3BhbnMgd2lsbCBoYXZlIG51bGwgZm9yIHRoZWlyIGZyb20vdG8gcHJvcGVydGllcyB3aGVuIHRoZVxuLy8gbWFya2VyIGNvbnRpbnVlcyBiZXlvbmQgdGhlIHN0YXJ0L2VuZCBvZiB0aGUgbGluZS4gTWFya2VycyBoYXZlXG4vLyBsaW5rcyBiYWNrIHRvIHRoZSBsaW5lcyB0aGV5IGN1cnJlbnRseSB0b3VjaC5cbi8vIENvbGxhcHNlZCBtYXJrZXJzIGhhdmUgdW5pcXVlIGlkcywgaW4gb3JkZXIgdG8gYmUgYWJsZSB0byBvcmRlclxuLy8gdGhlbSwgd2hpY2ggaXMgbmVlZGVkIGZvciB1bmlxdWVseSBkZXRlcm1pbmluZyBhbiBvdXRlciBtYXJrZXJcbi8vIHdoZW4gdGhleSBvdmVybGFwICh0aGV5IG1heSBuZXN0LCBidXQgbm90IHBhcnRpYWxseSBvdmVybGFwKS5cbnZhciBuZXh0TWFya2VySWQ9MDtmdW5jdGlvbiBUZXh0TWFya2VyKGRvYyx0eXBlKXt0aGlzLmxpbmVzPVtdO3RoaXMudHlwZT10eXBlO3RoaXMuZG9jPWRvYzt0aGlzLmlkPSsrbmV4dE1hcmtlcklkO31ldmVudE1peGluKFRleHRNYXJrZXIpOy8vIENsZWFyIHRoZSBtYXJrZXIuXG5UZXh0TWFya2VyLnByb3RvdHlwZS5jbGVhcj1mdW5jdGlvbigpe3ZhciB0aGlzJDE9dGhpcztpZih0aGlzLmV4cGxpY2l0bHlDbGVhcmVkKXtyZXR1cm47fXZhciBjbT10aGlzLmRvYy5jbSx3aXRoT3A9Y20mJiFjbS5jdXJPcDtpZih3aXRoT3Ape3N0YXJ0T3BlcmF0aW9uKGNtKTt9aWYoaGFzSGFuZGxlcih0aGlzLFwiY2xlYXJcIikpe3ZhciBmb3VuZD10aGlzLmZpbmQoKTtpZihmb3VuZCl7c2lnbmFsTGF0ZXIodGhpcyxcImNsZWFyXCIsZm91bmQuZnJvbSxmb3VuZC50byk7fX12YXIgbWluPW51bGwsbWF4PW51bGw7Zm9yKHZhciBpPTA7aTx0aGlzLmxpbmVzLmxlbmd0aDsrK2kpe3ZhciBsaW5lPXRoaXMkMS5saW5lc1tpXTt2YXIgc3Bhbj1nZXRNYXJrZWRTcGFuRm9yKGxpbmUubWFya2VkU3BhbnMsdGhpcyQxKTtpZihjbSYmIXRoaXMkMS5jb2xsYXBzZWQpe3JlZ0xpbmVDaGFuZ2UoY20sbGluZU5vKGxpbmUpLFwidGV4dFwiKTt9ZWxzZSBpZihjbSl7aWYoc3Bhbi50byE9bnVsbCl7bWF4PWxpbmVObyhsaW5lKTt9aWYoc3Bhbi5mcm9tIT1udWxsKXttaW49bGluZU5vKGxpbmUpO319bGluZS5tYXJrZWRTcGFucz1yZW1vdmVNYXJrZWRTcGFuKGxpbmUubWFya2VkU3BhbnMsc3Bhbik7aWYoc3Bhbi5mcm9tPT1udWxsJiZ0aGlzJDEuY29sbGFwc2VkJiYhbGluZUlzSGlkZGVuKHRoaXMkMS5kb2MsbGluZSkmJmNtKXt1cGRhdGVMaW5lSGVpZ2h0KGxpbmUsdGV4dEhlaWdodChjbS5kaXNwbGF5KSk7fX1pZihjbSYmdGhpcy5jb2xsYXBzZWQmJiFjbS5vcHRpb25zLmxpbmVXcmFwcGluZyl7Zm9yKHZhciBpJDE9MDtpJDE8dGhpcy5saW5lcy5sZW5ndGg7KytpJDEpe3ZhciB2aXN1YWw9dmlzdWFsTGluZSh0aGlzJDEubGluZXNbaSQxXSksbGVuPWxpbmVMZW5ndGgodmlzdWFsKTtpZihsZW4+Y20uZGlzcGxheS5tYXhMaW5lTGVuZ3RoKXtjbS5kaXNwbGF5Lm1heExpbmU9dmlzdWFsO2NtLmRpc3BsYXkubWF4TGluZUxlbmd0aD1sZW47Y20uZGlzcGxheS5tYXhMaW5lQ2hhbmdlZD10cnVlO319fWlmKG1pbiE9bnVsbCYmY20mJnRoaXMuY29sbGFwc2VkKXtyZWdDaGFuZ2UoY20sbWluLG1heCsxKTt9dGhpcy5saW5lcy5sZW5ndGg9MDt0aGlzLmV4cGxpY2l0bHlDbGVhcmVkPXRydWU7aWYodGhpcy5hdG9taWMmJnRoaXMuZG9jLmNhbnRFZGl0KXt0aGlzLmRvYy5jYW50RWRpdD1mYWxzZTtpZihjbSl7cmVDaGVja1NlbGVjdGlvbihjbS5kb2MpO319aWYoY20pe3NpZ25hbExhdGVyKGNtLFwibWFya2VyQ2xlYXJlZFwiLGNtLHRoaXMpO31pZih3aXRoT3Ape2VuZE9wZXJhdGlvbihjbSk7fWlmKHRoaXMucGFyZW50KXt0aGlzLnBhcmVudC5jbGVhcigpO319Oy8vIEZpbmQgdGhlIHBvc2l0aW9uIG9mIHRoZSBtYXJrZXIgaW4gdGhlIGRvY3VtZW50LiBSZXR1cm5zIGEge2Zyb20sXG4vLyB0b30gb2JqZWN0IGJ5IGRlZmF1bHQuIFNpZGUgY2FuIGJlIHBhc3NlZCB0byBnZXQgYSBzcGVjaWZpYyBzaWRlXG4vLyAtLSAwIChib3RoKSwgLTEgKGxlZnQpLCBvciAxIChyaWdodCkuIFdoZW4gbGluZU9iaiBpcyB0cnVlLCB0aGVcbi8vIFBvcyBvYmplY3RzIHJldHVybmVkIGNvbnRhaW4gYSBsaW5lIG9iamVjdCwgcmF0aGVyIHRoYW4gYSBsaW5lXG4vLyBudW1iZXIgKHVzZWQgdG8gcHJldmVudCBsb29raW5nIHVwIHRoZSBzYW1lIGxpbmUgdHdpY2UpLlxuVGV4dE1hcmtlci5wcm90b3R5cGUuZmluZD1mdW5jdGlvbihzaWRlLGxpbmVPYmope3ZhciB0aGlzJDE9dGhpcztpZihzaWRlPT1udWxsJiZ0aGlzLnR5cGU9PVwiYm9va21hcmtcIil7c2lkZT0xO312YXIgZnJvbSx0bztmb3IodmFyIGk9MDtpPHRoaXMubGluZXMubGVuZ3RoOysraSl7dmFyIGxpbmU9dGhpcyQxLmxpbmVzW2ldO3ZhciBzcGFuPWdldE1hcmtlZFNwYW5Gb3IobGluZS5tYXJrZWRTcGFucyx0aGlzJDEpO2lmKHNwYW4uZnJvbSE9bnVsbCl7ZnJvbT1Qb3MobGluZU9iaj9saW5lOmxpbmVObyhsaW5lKSxzcGFuLmZyb20pO2lmKHNpZGU9PS0xKXtyZXR1cm4gZnJvbTt9fWlmKHNwYW4udG8hPW51bGwpe3RvPVBvcyhsaW5lT2JqP2xpbmU6bGluZU5vKGxpbmUpLHNwYW4udG8pO2lmKHNpZGU9PTEpe3JldHVybiB0bzt9fX1yZXR1cm4gZnJvbSYme2Zyb206ZnJvbSx0bzp0b307fTsvLyBTaWduYWxzIHRoYXQgdGhlIG1hcmtlcidzIHdpZGdldCBjaGFuZ2VkLCBhbmQgc3Vycm91bmRpbmcgbGF5b3V0XG4vLyBzaG91bGQgYmUgcmVjb21wdXRlZC5cblRleHRNYXJrZXIucHJvdG90eXBlLmNoYW5nZWQ9ZnVuY3Rpb24oKXt2YXIgcG9zPXRoaXMuZmluZCgtMSx0cnVlKSx3aWRnZXQ9dGhpcyxjbT10aGlzLmRvYy5jbTtpZighcG9zfHwhY20pe3JldHVybjt9cnVuSW5PcChjbSxmdW5jdGlvbigpe3ZhciBsaW5lPXBvcy5saW5lLGxpbmVOPWxpbmVObyhwb3MubGluZSk7dmFyIHZpZXc9ZmluZFZpZXdGb3JMaW5lKGNtLGxpbmVOKTtpZih2aWV3KXtjbGVhckxpbmVNZWFzdXJlbWVudENhY2hlRm9yKHZpZXcpO2NtLmN1ck9wLnNlbGVjdGlvbkNoYW5nZWQ9Y20uY3VyT3AuZm9yY2VVcGRhdGU9dHJ1ZTt9Y20uY3VyT3AudXBkYXRlTWF4TGluZT10cnVlO2lmKCFsaW5lSXNIaWRkZW4od2lkZ2V0LmRvYyxsaW5lKSYmd2lkZ2V0LmhlaWdodCE9bnVsbCl7dmFyIG9sZEhlaWdodD13aWRnZXQuaGVpZ2h0O3dpZGdldC5oZWlnaHQ9bnVsbDt2YXIgZEhlaWdodD13aWRnZXRIZWlnaHQod2lkZ2V0KS1vbGRIZWlnaHQ7aWYoZEhlaWdodCl7dXBkYXRlTGluZUhlaWdodChsaW5lLGxpbmUuaGVpZ2h0K2RIZWlnaHQpO319fSk7fTtUZXh0TWFya2VyLnByb3RvdHlwZS5hdHRhY2hMaW5lPWZ1bmN0aW9uKGxpbmUpe2lmKCF0aGlzLmxpbmVzLmxlbmd0aCYmdGhpcy5kb2MuY20pe3ZhciBvcD10aGlzLmRvYy5jbS5jdXJPcDtpZighb3AubWF5YmVIaWRkZW5NYXJrZXJzfHxpbmRleE9mKG9wLm1heWJlSGlkZGVuTWFya2Vycyx0aGlzKT09LTEpeyhvcC5tYXliZVVuaGlkZGVuTWFya2Vyc3x8KG9wLm1heWJlVW5oaWRkZW5NYXJrZXJzPVtdKSkucHVzaCh0aGlzKTt9fXRoaXMubGluZXMucHVzaChsaW5lKTt9O1RleHRNYXJrZXIucHJvdG90eXBlLmRldGFjaExpbmU9ZnVuY3Rpb24obGluZSl7dGhpcy5saW5lcy5zcGxpY2UoaW5kZXhPZih0aGlzLmxpbmVzLGxpbmUpLDEpO2lmKCF0aGlzLmxpbmVzLmxlbmd0aCYmdGhpcy5kb2MuY20pe3ZhciBvcD10aGlzLmRvYy5jbS5jdXJPcDsob3AubWF5YmVIaWRkZW5NYXJrZXJzfHwob3AubWF5YmVIaWRkZW5NYXJrZXJzPVtdKSkucHVzaCh0aGlzKTt9fTsvLyBDcmVhdGUgYSBtYXJrZXIsIHdpcmUgaXQgdXAgdG8gdGhlIHJpZ2h0IGxpbmVzLCBhbmRcbmZ1bmN0aW9uIG1hcmtUZXh0KGRvYyxmcm9tLHRvLG9wdGlvbnMsdHlwZSl7Ly8gU2hhcmVkIG1hcmtlcnMgKGFjcm9zcyBsaW5rZWQgZG9jdW1lbnRzKSBhcmUgaGFuZGxlZCBzZXBhcmF0ZWx5XG4vLyAobWFya1RleHRTaGFyZWQgd2lsbCBjYWxsIG91dCB0byB0aGlzIGFnYWluLCBvbmNlIHBlclxuLy8gZG9jdW1lbnQpLlxuaWYob3B0aW9ucyYmb3B0aW9ucy5zaGFyZWQpe3JldHVybiBtYXJrVGV4dFNoYXJlZChkb2MsZnJvbSx0byxvcHRpb25zLHR5cGUpO30vLyBFbnN1cmUgd2UgYXJlIGluIGFuIG9wZXJhdGlvbi5cbmlmKGRvYy5jbSYmIWRvYy5jbS5jdXJPcCl7cmV0dXJuIG9wZXJhdGlvbihkb2MuY20sbWFya1RleHQpKGRvYyxmcm9tLHRvLG9wdGlvbnMsdHlwZSk7fXZhciBtYXJrZXI9bmV3IFRleHRNYXJrZXIoZG9jLHR5cGUpLGRpZmY9Y21wKGZyb20sdG8pO2lmKG9wdGlvbnMpe2NvcHlPYmoob3B0aW9ucyxtYXJrZXIsZmFsc2UpO30vLyBEb24ndCBjb25uZWN0IGVtcHR5IG1hcmtlcnMgdW5sZXNzIGNsZWFyV2hlbkVtcHR5IGlzIGZhbHNlXG5pZihkaWZmPjB8fGRpZmY9PTAmJm1hcmtlci5jbGVhcldoZW5FbXB0eSE9PWZhbHNlKXtyZXR1cm4gbWFya2VyO31pZihtYXJrZXIucmVwbGFjZWRXaXRoKXsvLyBTaG93aW5nIHVwIGFzIGEgd2lkZ2V0IGltcGxpZXMgY29sbGFwc2VkICh3aWRnZXQgcmVwbGFjZXMgdGV4dClcbm1hcmtlci5jb2xsYXBzZWQ9dHJ1ZTttYXJrZXIud2lkZ2V0Tm9kZT1lbHQoXCJzcGFuXCIsW21hcmtlci5yZXBsYWNlZFdpdGhdLFwiQ29kZU1pcnJvci13aWRnZXRcIik7aWYoIW9wdGlvbnMuaGFuZGxlTW91c2VFdmVudHMpe21hcmtlci53aWRnZXROb2RlLnNldEF0dHJpYnV0ZShcImNtLWlnbm9yZS1ldmVudHNcIixcInRydWVcIik7fWlmKG9wdGlvbnMuaW5zZXJ0TGVmdCl7bWFya2VyLndpZGdldE5vZGUuaW5zZXJ0TGVmdD10cnVlO319aWYobWFya2VyLmNvbGxhcHNlZCl7aWYoY29uZmxpY3RpbmdDb2xsYXBzZWRSYW5nZShkb2MsZnJvbS5saW5lLGZyb20sdG8sbWFya2VyKXx8ZnJvbS5saW5lIT10by5saW5lJiZjb25mbGljdGluZ0NvbGxhcHNlZFJhbmdlKGRvYyx0by5saW5lLGZyb20sdG8sbWFya2VyKSl7dGhyb3cgbmV3IEVycm9yKFwiSW5zZXJ0aW5nIGNvbGxhcHNlZCBtYXJrZXIgcGFydGlhbGx5IG92ZXJsYXBwaW5nIGFuIGV4aXN0aW5nIG9uZVwiKTt9c2VlQ29sbGFwc2VkU3BhbnMoKTt9aWYobWFya2VyLmFkZFRvSGlzdG9yeSl7YWRkQ2hhbmdlVG9IaXN0b3J5KGRvYyx7ZnJvbTpmcm9tLHRvOnRvLG9yaWdpbjpcIm1hcmtUZXh0XCJ9LGRvYy5zZWwsTmFOKTt9dmFyIGN1ckxpbmU9ZnJvbS5saW5lLGNtPWRvYy5jbSx1cGRhdGVNYXhMaW5lO2RvYy5pdGVyKGN1ckxpbmUsdG8ubGluZSsxLGZ1bmN0aW9uKGxpbmUpe2lmKGNtJiZtYXJrZXIuY29sbGFwc2VkJiYhY20ub3B0aW9ucy5saW5lV3JhcHBpbmcmJnZpc3VhbExpbmUobGluZSk9PWNtLmRpc3BsYXkubWF4TGluZSl7dXBkYXRlTWF4TGluZT10cnVlO31pZihtYXJrZXIuY29sbGFwc2VkJiZjdXJMaW5lIT1mcm9tLmxpbmUpe3VwZGF0ZUxpbmVIZWlnaHQobGluZSwwKTt9YWRkTWFya2VkU3BhbihsaW5lLG5ldyBNYXJrZWRTcGFuKG1hcmtlcixjdXJMaW5lPT1mcm9tLmxpbmU/ZnJvbS5jaDpudWxsLGN1ckxpbmU9PXRvLmxpbmU/dG8uY2g6bnVsbCkpOysrY3VyTGluZTt9KTsvLyBsaW5lSXNIaWRkZW4gZGVwZW5kcyBvbiB0aGUgcHJlc2VuY2Ugb2YgdGhlIHNwYW5zLCBzbyBuZWVkcyBhIHNlY29uZCBwYXNzXG5pZihtYXJrZXIuY29sbGFwc2VkKXtkb2MuaXRlcihmcm9tLmxpbmUsdG8ubGluZSsxLGZ1bmN0aW9uKGxpbmUpe2lmKGxpbmVJc0hpZGRlbihkb2MsbGluZSkpe3VwZGF0ZUxpbmVIZWlnaHQobGluZSwwKTt9fSk7fWlmKG1hcmtlci5jbGVhck9uRW50ZXIpe29uKG1hcmtlcixcImJlZm9yZUN1cnNvckVudGVyXCIsZnVuY3Rpb24oKXtyZXR1cm4gbWFya2VyLmNsZWFyKCk7fSk7fWlmKG1hcmtlci5yZWFkT25seSl7c2VlUmVhZE9ubHlTcGFucygpO2lmKGRvYy5oaXN0b3J5LmRvbmUubGVuZ3RofHxkb2MuaGlzdG9yeS51bmRvbmUubGVuZ3RoKXtkb2MuY2xlYXJIaXN0b3J5KCk7fX1pZihtYXJrZXIuY29sbGFwc2VkKXttYXJrZXIuaWQ9KytuZXh0TWFya2VySWQ7bWFya2VyLmF0b21pYz10cnVlO31pZihjbSl7Ly8gU3luYyBlZGl0b3Igc3RhdGVcbmlmKHVwZGF0ZU1heExpbmUpe2NtLmN1ck9wLnVwZGF0ZU1heExpbmU9dHJ1ZTt9aWYobWFya2VyLmNvbGxhcHNlZCl7cmVnQ2hhbmdlKGNtLGZyb20ubGluZSx0by5saW5lKzEpO31lbHNlIGlmKG1hcmtlci5jbGFzc05hbWV8fG1hcmtlci50aXRsZXx8bWFya2VyLnN0YXJ0U3R5bGV8fG1hcmtlci5lbmRTdHlsZXx8bWFya2VyLmNzcyl7Zm9yKHZhciBpPWZyb20ubGluZTtpPD10by5saW5lO2krKyl7cmVnTGluZUNoYW5nZShjbSxpLFwidGV4dFwiKTt9fWlmKG1hcmtlci5hdG9taWMpe3JlQ2hlY2tTZWxlY3Rpb24oY20uZG9jKTt9c2lnbmFsTGF0ZXIoY20sXCJtYXJrZXJBZGRlZFwiLGNtLG1hcmtlcik7fXJldHVybiBtYXJrZXI7fS8vIFNIQVJFRCBURVhUTUFSS0VSU1xuLy8gQSBzaGFyZWQgbWFya2VyIHNwYW5zIG11bHRpcGxlIGxpbmtlZCBkb2N1bWVudHMuIEl0IGlzXG4vLyBpbXBsZW1lbnRlZCBhcyBhIG1ldGEtbWFya2VyLW9iamVjdCBjb250cm9sbGluZyBtdWx0aXBsZSBub3JtYWxcbi8vIG1hcmtlcnMuXG5mdW5jdGlvbiBTaGFyZWRUZXh0TWFya2VyKG1hcmtlcnMscHJpbWFyeSl7dmFyIHRoaXMkMT10aGlzO3RoaXMubWFya2Vycz1tYXJrZXJzO3RoaXMucHJpbWFyeT1wcmltYXJ5O2Zvcih2YXIgaT0wO2k8bWFya2Vycy5sZW5ndGg7KytpKXttYXJrZXJzW2ldLnBhcmVudD10aGlzJDE7fX1ldmVudE1peGluKFNoYXJlZFRleHRNYXJrZXIpO1NoYXJlZFRleHRNYXJrZXIucHJvdG90eXBlLmNsZWFyPWZ1bmN0aW9uKCl7dmFyIHRoaXMkMT10aGlzO2lmKHRoaXMuZXhwbGljaXRseUNsZWFyZWQpe3JldHVybjt9dGhpcy5leHBsaWNpdGx5Q2xlYXJlZD10cnVlO2Zvcih2YXIgaT0wO2k8dGhpcy5tYXJrZXJzLmxlbmd0aDsrK2kpe3RoaXMkMS5tYXJrZXJzW2ldLmNsZWFyKCk7fXNpZ25hbExhdGVyKHRoaXMsXCJjbGVhclwiKTt9O1NoYXJlZFRleHRNYXJrZXIucHJvdG90eXBlLmZpbmQ9ZnVuY3Rpb24oc2lkZSxsaW5lT2JqKXtyZXR1cm4gdGhpcy5wcmltYXJ5LmZpbmQoc2lkZSxsaW5lT2JqKTt9O2Z1bmN0aW9uIG1hcmtUZXh0U2hhcmVkKGRvYyxmcm9tLHRvLG9wdGlvbnMsdHlwZSl7b3B0aW9ucz1jb3B5T2JqKG9wdGlvbnMpO29wdGlvbnMuc2hhcmVkPWZhbHNlO3ZhciBtYXJrZXJzPVttYXJrVGV4dChkb2MsZnJvbSx0byxvcHRpb25zLHR5cGUpXSxwcmltYXJ5PW1hcmtlcnNbMF07dmFyIHdpZGdldD1vcHRpb25zLndpZGdldE5vZGU7bGlua2VkRG9jcyhkb2MsZnVuY3Rpb24oZG9jKXtpZih3aWRnZXQpe29wdGlvbnMud2lkZ2V0Tm9kZT13aWRnZXQuY2xvbmVOb2RlKHRydWUpO31tYXJrZXJzLnB1c2gobWFya1RleHQoZG9jLGNsaXBQb3MoZG9jLGZyb20pLGNsaXBQb3MoZG9jLHRvKSxvcHRpb25zLHR5cGUpKTtmb3IodmFyIGk9MDtpPGRvYy5saW5rZWQubGVuZ3RoOysraSl7aWYoZG9jLmxpbmtlZFtpXS5pc1BhcmVudCl7cmV0dXJuO319cHJpbWFyeT1sc3QobWFya2Vycyk7fSk7cmV0dXJuIG5ldyBTaGFyZWRUZXh0TWFya2VyKG1hcmtlcnMscHJpbWFyeSk7fWZ1bmN0aW9uIGZpbmRTaGFyZWRNYXJrZXJzKGRvYyl7cmV0dXJuIGRvYy5maW5kTWFya3MoUG9zKGRvYy5maXJzdCwwKSxkb2MuY2xpcFBvcyhQb3MoZG9jLmxhc3RMaW5lKCkpKSxmdW5jdGlvbihtKXtyZXR1cm4gbS5wYXJlbnQ7fSk7fWZ1bmN0aW9uIGNvcHlTaGFyZWRNYXJrZXJzKGRvYyxtYXJrZXJzKXtmb3IodmFyIGk9MDtpPG1hcmtlcnMubGVuZ3RoO2krKyl7dmFyIG1hcmtlcj1tYXJrZXJzW2ldLHBvcz1tYXJrZXIuZmluZCgpO3ZhciBtRnJvbT1kb2MuY2xpcFBvcyhwb3MuZnJvbSksbVRvPWRvYy5jbGlwUG9zKHBvcy50byk7aWYoY21wKG1Gcm9tLG1Ubykpe3ZhciBzdWJNYXJrPW1hcmtUZXh0KGRvYyxtRnJvbSxtVG8sbWFya2VyLnByaW1hcnksbWFya2VyLnByaW1hcnkudHlwZSk7bWFya2VyLm1hcmtlcnMucHVzaChzdWJNYXJrKTtzdWJNYXJrLnBhcmVudD1tYXJrZXI7fX19ZnVuY3Rpb24gZGV0YWNoU2hhcmVkTWFya2VycyhtYXJrZXJzKXt2YXIgbG9vcD1mdW5jdGlvbihpKXt2YXIgbWFya2VyPW1hcmtlcnNbaV0sbGlua2VkPVttYXJrZXIucHJpbWFyeS5kb2NdO2xpbmtlZERvY3MobWFya2VyLnByaW1hcnkuZG9jLGZ1bmN0aW9uKGQpe3JldHVybiBsaW5rZWQucHVzaChkKTt9KTtmb3IodmFyIGo9MDtqPG1hcmtlci5tYXJrZXJzLmxlbmd0aDtqKyspe3ZhciBzdWJNYXJrZXI9bWFya2VyLm1hcmtlcnNbal07aWYoaW5kZXhPZihsaW5rZWQsc3ViTWFya2VyLmRvYyk9PS0xKXtzdWJNYXJrZXIucGFyZW50PW51bGw7bWFya2VyLm1hcmtlcnMuc3BsaWNlKGotLSwxKTt9fX07Zm9yKHZhciBpPTA7aTxtYXJrZXJzLmxlbmd0aDtpKyspbG9vcChpKTt9dmFyIG5leHREb2NJZD0wO3ZhciBEb2M9ZnVuY3Rpb24odGV4dCxtb2RlLGZpcnN0TGluZSxsaW5lU2VwKXtpZighKHRoaXMgaW5zdGFuY2VvZiBEb2MpKXtyZXR1cm4gbmV3IERvYyh0ZXh0LG1vZGUsZmlyc3RMaW5lLGxpbmVTZXApO31pZihmaXJzdExpbmU9PW51bGwpe2ZpcnN0TGluZT0wO31CcmFuY2hDaHVuay5jYWxsKHRoaXMsW25ldyBMZWFmQ2h1bmsoW25ldyBMaW5lKFwiXCIsbnVsbCldKV0pO3RoaXMuZmlyc3Q9Zmlyc3RMaW5lO3RoaXMuc2Nyb2xsVG9wPXRoaXMuc2Nyb2xsTGVmdD0wO3RoaXMuY2FudEVkaXQ9ZmFsc2U7dGhpcy5jbGVhbkdlbmVyYXRpb249MTt0aGlzLmZyb250aWVyPWZpcnN0TGluZTt2YXIgc3RhcnQ9UG9zKGZpcnN0TGluZSwwKTt0aGlzLnNlbD1zaW1wbGVTZWxlY3Rpb24oc3RhcnQpO3RoaXMuaGlzdG9yeT1uZXcgSGlzdG9yeShudWxsKTt0aGlzLmlkPSsrbmV4dERvY0lkO3RoaXMubW9kZU9wdGlvbj1tb2RlO3RoaXMubGluZVNlcD1saW5lU2VwO3RoaXMuZXh0ZW5kPWZhbHNlO2lmKHR5cGVvZiB0ZXh0PT1cInN0cmluZ1wiKXt0ZXh0PXRoaXMuc3BsaXRMaW5lcyh0ZXh0KTt9dXBkYXRlRG9jKHRoaXMse2Zyb206c3RhcnQsdG86c3RhcnQsdGV4dDp0ZXh0fSk7c2V0U2VsZWN0aW9uKHRoaXMsc2ltcGxlU2VsZWN0aW9uKHN0YXJ0KSxzZWxfZG9udFNjcm9sbCk7fTtEb2MucHJvdG90eXBlPWNyZWF0ZU9iaihCcmFuY2hDaHVuay5wcm90b3R5cGUse2NvbnN0cnVjdG9yOkRvYywvLyBJdGVyYXRlIG92ZXIgdGhlIGRvY3VtZW50LiBTdXBwb3J0cyB0d28gZm9ybXMgLS0gd2l0aCBvbmx5IG9uZVxuLy8gYXJndW1lbnQsIGl0IGNhbGxzIHRoYXQgZm9yIGVhY2ggbGluZSBpbiB0aGUgZG9jdW1lbnQuIFdpdGhcbi8vIHRocmVlLCBpdCBpdGVyYXRlcyBvdmVyIHRoZSByYW5nZSBnaXZlbiBieSB0aGUgZmlyc3QgdHdvICh3aXRoXG4vLyB0aGUgc2Vjb25kIGJlaW5nIG5vbi1pbmNsdXNpdmUpLlxuaXRlcjpmdW5jdGlvbihmcm9tLHRvLG9wKXtpZihvcCl7dGhpcy5pdGVyTihmcm9tLXRoaXMuZmlyc3QsdG8tZnJvbSxvcCk7fWVsc2V7dGhpcy5pdGVyTih0aGlzLmZpcnN0LHRoaXMuZmlyc3QrdGhpcy5zaXplLGZyb20pO319LC8vIE5vbi1wdWJsaWMgaW50ZXJmYWNlIGZvciBhZGRpbmcgYW5kIHJlbW92aW5nIGxpbmVzLlxuaW5zZXJ0OmZ1bmN0aW9uKGF0LGxpbmVzKXt2YXIgaGVpZ2h0PTA7Zm9yKHZhciBpPTA7aTxsaW5lcy5sZW5ndGg7KytpKXtoZWlnaHQrPWxpbmVzW2ldLmhlaWdodDt9dGhpcy5pbnNlcnRJbm5lcihhdC10aGlzLmZpcnN0LGxpbmVzLGhlaWdodCk7fSxyZW1vdmU6ZnVuY3Rpb24oYXQsbil7dGhpcy5yZW1vdmVJbm5lcihhdC10aGlzLmZpcnN0LG4pO30sLy8gRnJvbSBoZXJlLCB0aGUgbWV0aG9kcyBhcmUgcGFydCBvZiB0aGUgcHVibGljIGludGVyZmFjZS4gTW9zdFxuLy8gYXJlIGFsc28gYXZhaWxhYmxlIGZyb20gQ29kZU1pcnJvciAoZWRpdG9yKSBpbnN0YW5jZXMuXG5nZXRWYWx1ZTpmdW5jdGlvbihsaW5lU2VwKXt2YXIgbGluZXM9Z2V0TGluZXModGhpcyx0aGlzLmZpcnN0LHRoaXMuZmlyc3QrdGhpcy5zaXplKTtpZihsaW5lU2VwPT09ZmFsc2Upe3JldHVybiBsaW5lczt9cmV0dXJuIGxpbmVzLmpvaW4obGluZVNlcHx8dGhpcy5saW5lU2VwYXJhdG9yKCkpO30sc2V0VmFsdWU6ZG9jTWV0aG9kT3AoZnVuY3Rpb24oY29kZSl7dmFyIHRvcD1Qb3ModGhpcy5maXJzdCwwKSxsYXN0PXRoaXMuZmlyc3QrdGhpcy5zaXplLTE7bWFrZUNoYW5nZSh0aGlzLHtmcm9tOnRvcCx0bzpQb3MobGFzdCxnZXRMaW5lKHRoaXMsbGFzdCkudGV4dC5sZW5ndGgpLHRleHQ6dGhpcy5zcGxpdExpbmVzKGNvZGUpLG9yaWdpbjpcInNldFZhbHVlXCIsZnVsbDp0cnVlfSx0cnVlKTtzZXRTZWxlY3Rpb24odGhpcyxzaW1wbGVTZWxlY3Rpb24odG9wKSk7fSkscmVwbGFjZVJhbmdlOmZ1bmN0aW9uKGNvZGUsZnJvbSx0byxvcmlnaW4pe2Zyb209Y2xpcFBvcyh0aGlzLGZyb20pO3RvPXRvP2NsaXBQb3ModGhpcyx0byk6ZnJvbTtyZXBsYWNlUmFuZ2UodGhpcyxjb2RlLGZyb20sdG8sb3JpZ2luKTt9LGdldFJhbmdlOmZ1bmN0aW9uKGZyb20sdG8sbGluZVNlcCl7dmFyIGxpbmVzPWdldEJldHdlZW4odGhpcyxjbGlwUG9zKHRoaXMsZnJvbSksY2xpcFBvcyh0aGlzLHRvKSk7aWYobGluZVNlcD09PWZhbHNlKXtyZXR1cm4gbGluZXM7fXJldHVybiBsaW5lcy5qb2luKGxpbmVTZXB8fHRoaXMubGluZVNlcGFyYXRvcigpKTt9LGdldExpbmU6ZnVuY3Rpb24obGluZSl7dmFyIGw9dGhpcy5nZXRMaW5lSGFuZGxlKGxpbmUpO3JldHVybiBsJiZsLnRleHQ7fSxnZXRMaW5lSGFuZGxlOmZ1bmN0aW9uKGxpbmUpe2lmKGlzTGluZSh0aGlzLGxpbmUpKXtyZXR1cm4gZ2V0TGluZSh0aGlzLGxpbmUpO319LGdldExpbmVOdW1iZXI6ZnVuY3Rpb24obGluZSl7cmV0dXJuIGxpbmVObyhsaW5lKTt9LGdldExpbmVIYW5kbGVWaXN1YWxTdGFydDpmdW5jdGlvbihsaW5lKXtpZih0eXBlb2YgbGluZT09XCJudW1iZXJcIil7bGluZT1nZXRMaW5lKHRoaXMsbGluZSk7fXJldHVybiB2aXN1YWxMaW5lKGxpbmUpO30sbGluZUNvdW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2l6ZTt9LGZpcnN0TGluZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmZpcnN0O30sbGFzdExpbmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5maXJzdCt0aGlzLnNpemUtMTt9LGNsaXBQb3M6ZnVuY3Rpb24ocG9zKXtyZXR1cm4gY2xpcFBvcyh0aGlzLHBvcyk7fSxnZXRDdXJzb3I6ZnVuY3Rpb24oc3RhcnQpe3ZhciByYW5nZT10aGlzLnNlbC5wcmltYXJ5KCkscG9zO2lmKHN0YXJ0PT1udWxsfHxzdGFydD09XCJoZWFkXCIpe3Bvcz1yYW5nZS5oZWFkO31lbHNlIGlmKHN0YXJ0PT1cImFuY2hvclwiKXtwb3M9cmFuZ2UuYW5jaG9yO31lbHNlIGlmKHN0YXJ0PT1cImVuZFwifHxzdGFydD09XCJ0b1wifHxzdGFydD09PWZhbHNlKXtwb3M9cmFuZ2UudG8oKTt9ZWxzZXtwb3M9cmFuZ2UuZnJvbSgpO31yZXR1cm4gcG9zO30sbGlzdFNlbGVjdGlvbnM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZWwucmFuZ2VzO30sc29tZXRoaW5nU2VsZWN0ZWQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZWwuc29tZXRoaW5nU2VsZWN0ZWQoKTt9LHNldEN1cnNvcjpkb2NNZXRob2RPcChmdW5jdGlvbihsaW5lLGNoLG9wdGlvbnMpe3NldFNpbXBsZVNlbGVjdGlvbih0aGlzLGNsaXBQb3ModGhpcyx0eXBlb2YgbGluZT09XCJudW1iZXJcIj9Qb3MobGluZSxjaHx8MCk6bGluZSksbnVsbCxvcHRpb25zKTt9KSxzZXRTZWxlY3Rpb246ZG9jTWV0aG9kT3AoZnVuY3Rpb24oYW5jaG9yLGhlYWQsb3B0aW9ucyl7c2V0U2ltcGxlU2VsZWN0aW9uKHRoaXMsY2xpcFBvcyh0aGlzLGFuY2hvciksY2xpcFBvcyh0aGlzLGhlYWR8fGFuY2hvciksb3B0aW9ucyk7fSksZXh0ZW5kU2VsZWN0aW9uOmRvY01ldGhvZE9wKGZ1bmN0aW9uKGhlYWQsb3RoZXIsb3B0aW9ucyl7ZXh0ZW5kU2VsZWN0aW9uKHRoaXMsY2xpcFBvcyh0aGlzLGhlYWQpLG90aGVyJiZjbGlwUG9zKHRoaXMsb3RoZXIpLG9wdGlvbnMpO30pLGV4dGVuZFNlbGVjdGlvbnM6ZG9jTWV0aG9kT3AoZnVuY3Rpb24oaGVhZHMsb3B0aW9ucyl7ZXh0ZW5kU2VsZWN0aW9ucyh0aGlzLGNsaXBQb3NBcnJheSh0aGlzLGhlYWRzKSxvcHRpb25zKTt9KSxleHRlbmRTZWxlY3Rpb25zQnk6ZG9jTWV0aG9kT3AoZnVuY3Rpb24oZixvcHRpb25zKXt2YXIgaGVhZHM9bWFwKHRoaXMuc2VsLnJhbmdlcyxmKTtleHRlbmRTZWxlY3Rpb25zKHRoaXMsY2xpcFBvc0FycmF5KHRoaXMsaGVhZHMpLG9wdGlvbnMpO30pLHNldFNlbGVjdGlvbnM6ZG9jTWV0aG9kT3AoZnVuY3Rpb24ocmFuZ2VzLHByaW1hcnksb3B0aW9ucyl7dmFyIHRoaXMkMT10aGlzO2lmKCFyYW5nZXMubGVuZ3RoKXtyZXR1cm47fXZhciBvdXQ9W107Zm9yKHZhciBpPTA7aTxyYW5nZXMubGVuZ3RoO2krKyl7b3V0W2ldPW5ldyBSYW5nZShjbGlwUG9zKHRoaXMkMSxyYW5nZXNbaV0uYW5jaG9yKSxjbGlwUG9zKHRoaXMkMSxyYW5nZXNbaV0uaGVhZCkpO31pZihwcmltYXJ5PT1udWxsKXtwcmltYXJ5PU1hdGgubWluKHJhbmdlcy5sZW5ndGgtMSx0aGlzLnNlbC5wcmltSW5kZXgpO31zZXRTZWxlY3Rpb24odGhpcyxub3JtYWxpemVTZWxlY3Rpb24ob3V0LHByaW1hcnkpLG9wdGlvbnMpO30pLGFkZFNlbGVjdGlvbjpkb2NNZXRob2RPcChmdW5jdGlvbihhbmNob3IsaGVhZCxvcHRpb25zKXt2YXIgcmFuZ2VzPXRoaXMuc2VsLnJhbmdlcy5zbGljZSgwKTtyYW5nZXMucHVzaChuZXcgUmFuZ2UoY2xpcFBvcyh0aGlzLGFuY2hvciksY2xpcFBvcyh0aGlzLGhlYWR8fGFuY2hvcikpKTtzZXRTZWxlY3Rpb24odGhpcyxub3JtYWxpemVTZWxlY3Rpb24ocmFuZ2VzLHJhbmdlcy5sZW5ndGgtMSksb3B0aW9ucyk7fSksZ2V0U2VsZWN0aW9uOmZ1bmN0aW9uKGxpbmVTZXApe3ZhciB0aGlzJDE9dGhpczt2YXIgcmFuZ2VzPXRoaXMuc2VsLnJhbmdlcyxsaW5lcztmb3IodmFyIGk9MDtpPHJhbmdlcy5sZW5ndGg7aSsrKXt2YXIgc2VsPWdldEJldHdlZW4odGhpcyQxLHJhbmdlc1tpXS5mcm9tKCkscmFuZ2VzW2ldLnRvKCkpO2xpbmVzPWxpbmVzP2xpbmVzLmNvbmNhdChzZWwpOnNlbDt9aWYobGluZVNlcD09PWZhbHNlKXtyZXR1cm4gbGluZXM7fWVsc2V7cmV0dXJuIGxpbmVzLmpvaW4obGluZVNlcHx8dGhpcy5saW5lU2VwYXJhdG9yKCkpO319LGdldFNlbGVjdGlvbnM6ZnVuY3Rpb24obGluZVNlcCl7dmFyIHRoaXMkMT10aGlzO3ZhciBwYXJ0cz1bXSxyYW5nZXM9dGhpcy5zZWwucmFuZ2VzO2Zvcih2YXIgaT0wO2k8cmFuZ2VzLmxlbmd0aDtpKyspe3ZhciBzZWw9Z2V0QmV0d2Vlbih0aGlzJDEscmFuZ2VzW2ldLmZyb20oKSxyYW5nZXNbaV0udG8oKSk7aWYobGluZVNlcCE9PWZhbHNlKXtzZWw9c2VsLmpvaW4obGluZVNlcHx8dGhpcyQxLmxpbmVTZXBhcmF0b3IoKSk7fXBhcnRzW2ldPXNlbDt9cmV0dXJuIHBhcnRzO30scmVwbGFjZVNlbGVjdGlvbjpmdW5jdGlvbihjb2RlLGNvbGxhcHNlLG9yaWdpbil7dmFyIGR1cD1bXTtmb3IodmFyIGk9MDtpPHRoaXMuc2VsLnJhbmdlcy5sZW5ndGg7aSsrKXtkdXBbaV09Y29kZTt9dGhpcy5yZXBsYWNlU2VsZWN0aW9ucyhkdXAsY29sbGFwc2Usb3JpZ2lufHxcIitpbnB1dFwiKTt9LHJlcGxhY2VTZWxlY3Rpb25zOmRvY01ldGhvZE9wKGZ1bmN0aW9uKGNvZGUsY29sbGFwc2Usb3JpZ2luKXt2YXIgdGhpcyQxPXRoaXM7dmFyIGNoYW5nZXM9W10sc2VsPXRoaXMuc2VsO2Zvcih2YXIgaT0wO2k8c2VsLnJhbmdlcy5sZW5ndGg7aSsrKXt2YXIgcmFuZ2U9c2VsLnJhbmdlc1tpXTtjaGFuZ2VzW2ldPXtmcm9tOnJhbmdlLmZyb20oKSx0bzpyYW5nZS50bygpLHRleHQ6dGhpcyQxLnNwbGl0TGluZXMoY29kZVtpXSksb3JpZ2luOm9yaWdpbn07fXZhciBuZXdTZWw9Y29sbGFwc2UmJmNvbGxhcHNlIT1cImVuZFwiJiZjb21wdXRlUmVwbGFjZWRTZWwodGhpcyxjaGFuZ2VzLGNvbGxhcHNlKTtmb3IodmFyIGkkMT1jaGFuZ2VzLmxlbmd0aC0xO2kkMT49MDtpJDEtLSl7bWFrZUNoYW5nZSh0aGlzJDEsY2hhbmdlc1tpJDFdKTt9aWYobmV3U2VsKXtzZXRTZWxlY3Rpb25SZXBsYWNlSGlzdG9yeSh0aGlzLG5ld1NlbCk7fWVsc2UgaWYodGhpcy5jbSl7ZW5zdXJlQ3Vyc29yVmlzaWJsZSh0aGlzLmNtKTt9fSksdW5kbzpkb2NNZXRob2RPcChmdW5jdGlvbigpe21ha2VDaGFuZ2VGcm9tSGlzdG9yeSh0aGlzLFwidW5kb1wiKTt9KSxyZWRvOmRvY01ldGhvZE9wKGZ1bmN0aW9uKCl7bWFrZUNoYW5nZUZyb21IaXN0b3J5KHRoaXMsXCJyZWRvXCIpO30pLHVuZG9TZWxlY3Rpb246ZG9jTWV0aG9kT3AoZnVuY3Rpb24oKXttYWtlQ2hhbmdlRnJvbUhpc3RvcnkodGhpcyxcInVuZG9cIix0cnVlKTt9KSxyZWRvU2VsZWN0aW9uOmRvY01ldGhvZE9wKGZ1bmN0aW9uKCl7bWFrZUNoYW5nZUZyb21IaXN0b3J5KHRoaXMsXCJyZWRvXCIsdHJ1ZSk7fSksc2V0RXh0ZW5kaW5nOmZ1bmN0aW9uKHZhbCl7dGhpcy5leHRlbmQ9dmFsO30sZ2V0RXh0ZW5kaW5nOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZXh0ZW5kO30saGlzdG9yeVNpemU6ZnVuY3Rpb24oKXt2YXIgaGlzdD10aGlzLmhpc3RvcnksZG9uZT0wLHVuZG9uZT0wO2Zvcih2YXIgaT0wO2k8aGlzdC5kb25lLmxlbmd0aDtpKyspe2lmKCFoaXN0LmRvbmVbaV0ucmFuZ2VzKXsrK2RvbmU7fX1mb3IodmFyIGkkMT0wO2kkMTxoaXN0LnVuZG9uZS5sZW5ndGg7aSQxKyspe2lmKCFoaXN0LnVuZG9uZVtpJDFdLnJhbmdlcyl7Kyt1bmRvbmU7fX1yZXR1cm57dW5kbzpkb25lLHJlZG86dW5kb25lfTt9LGNsZWFySGlzdG9yeTpmdW5jdGlvbigpe3RoaXMuaGlzdG9yeT1uZXcgSGlzdG9yeSh0aGlzLmhpc3RvcnkubWF4R2VuZXJhdGlvbik7fSxtYXJrQ2xlYW46ZnVuY3Rpb24oKXt0aGlzLmNsZWFuR2VuZXJhdGlvbj10aGlzLmNoYW5nZUdlbmVyYXRpb24odHJ1ZSk7fSxjaGFuZ2VHZW5lcmF0aW9uOmZ1bmN0aW9uKGZvcmNlU3BsaXQpe2lmKGZvcmNlU3BsaXQpe3RoaXMuaGlzdG9yeS5sYXN0T3A9dGhpcy5oaXN0b3J5Lmxhc3RTZWxPcD10aGlzLmhpc3RvcnkubGFzdE9yaWdpbj1udWxsO31yZXR1cm4gdGhpcy5oaXN0b3J5LmdlbmVyYXRpb247fSxpc0NsZWFuOmZ1bmN0aW9uKGdlbil7cmV0dXJuIHRoaXMuaGlzdG9yeS5nZW5lcmF0aW9uPT0oZ2VufHx0aGlzLmNsZWFuR2VuZXJhdGlvbik7fSxnZXRIaXN0b3J5OmZ1bmN0aW9uKCl7cmV0dXJue2RvbmU6Y29weUhpc3RvcnlBcnJheSh0aGlzLmhpc3RvcnkuZG9uZSksdW5kb25lOmNvcHlIaXN0b3J5QXJyYXkodGhpcy5oaXN0b3J5LnVuZG9uZSl9O30sc2V0SGlzdG9yeTpmdW5jdGlvbihoaXN0RGF0YSl7dmFyIGhpc3Q9dGhpcy5oaXN0b3J5PW5ldyBIaXN0b3J5KHRoaXMuaGlzdG9yeS5tYXhHZW5lcmF0aW9uKTtoaXN0LmRvbmU9Y29weUhpc3RvcnlBcnJheShoaXN0RGF0YS5kb25lLnNsaWNlKDApLG51bGwsdHJ1ZSk7aGlzdC51bmRvbmU9Y29weUhpc3RvcnlBcnJheShoaXN0RGF0YS51bmRvbmUuc2xpY2UoMCksbnVsbCx0cnVlKTt9LGFkZExpbmVDbGFzczpkb2NNZXRob2RPcChmdW5jdGlvbihoYW5kbGUsd2hlcmUsY2xzKXtyZXR1cm4gY2hhbmdlTGluZSh0aGlzLGhhbmRsZSx3aGVyZT09XCJndXR0ZXJcIj9cImd1dHRlclwiOlwiY2xhc3NcIixmdW5jdGlvbihsaW5lKXt2YXIgcHJvcD13aGVyZT09XCJ0ZXh0XCI/XCJ0ZXh0Q2xhc3NcIjp3aGVyZT09XCJiYWNrZ3JvdW5kXCI/XCJiZ0NsYXNzXCI6d2hlcmU9PVwiZ3V0dGVyXCI/XCJndXR0ZXJDbGFzc1wiOlwid3JhcENsYXNzXCI7aWYoIWxpbmVbcHJvcF0pe2xpbmVbcHJvcF09Y2xzO31lbHNlIGlmKGNsYXNzVGVzdChjbHMpLnRlc3QobGluZVtwcm9wXSkpe3JldHVybiBmYWxzZTt9ZWxzZXtsaW5lW3Byb3BdKz1cIiBcIitjbHM7fXJldHVybiB0cnVlO30pO30pLHJlbW92ZUxpbmVDbGFzczpkb2NNZXRob2RPcChmdW5jdGlvbihoYW5kbGUsd2hlcmUsY2xzKXtyZXR1cm4gY2hhbmdlTGluZSh0aGlzLGhhbmRsZSx3aGVyZT09XCJndXR0ZXJcIj9cImd1dHRlclwiOlwiY2xhc3NcIixmdW5jdGlvbihsaW5lKXt2YXIgcHJvcD13aGVyZT09XCJ0ZXh0XCI/XCJ0ZXh0Q2xhc3NcIjp3aGVyZT09XCJiYWNrZ3JvdW5kXCI/XCJiZ0NsYXNzXCI6d2hlcmU9PVwiZ3V0dGVyXCI/XCJndXR0ZXJDbGFzc1wiOlwid3JhcENsYXNzXCI7dmFyIGN1cj1saW5lW3Byb3BdO2lmKCFjdXIpe3JldHVybiBmYWxzZTt9ZWxzZSBpZihjbHM9PW51bGwpe2xpbmVbcHJvcF09bnVsbDt9ZWxzZXt2YXIgZm91bmQ9Y3VyLm1hdGNoKGNsYXNzVGVzdChjbHMpKTtpZighZm91bmQpe3JldHVybiBmYWxzZTt9dmFyIGVuZD1mb3VuZC5pbmRleCtmb3VuZFswXS5sZW5ndGg7bGluZVtwcm9wXT1jdXIuc2xpY2UoMCxmb3VuZC5pbmRleCkrKCFmb3VuZC5pbmRleHx8ZW5kPT1jdXIubGVuZ3RoP1wiXCI6XCIgXCIpK2N1ci5zbGljZShlbmQpfHxudWxsO31yZXR1cm4gdHJ1ZTt9KTt9KSxhZGRMaW5lV2lkZ2V0OmRvY01ldGhvZE9wKGZ1bmN0aW9uKGhhbmRsZSxub2RlLG9wdGlvbnMpe3JldHVybiBhZGRMaW5lV2lkZ2V0KHRoaXMsaGFuZGxlLG5vZGUsb3B0aW9ucyk7fSkscmVtb3ZlTGluZVdpZGdldDpmdW5jdGlvbih3aWRnZXQpe3dpZGdldC5jbGVhcigpO30sbWFya1RleHQ6ZnVuY3Rpb24oZnJvbSx0byxvcHRpb25zKXtyZXR1cm4gbWFya1RleHQodGhpcyxjbGlwUG9zKHRoaXMsZnJvbSksY2xpcFBvcyh0aGlzLHRvKSxvcHRpb25zLG9wdGlvbnMmJm9wdGlvbnMudHlwZXx8XCJyYW5nZVwiKTt9LHNldEJvb2ttYXJrOmZ1bmN0aW9uKHBvcyxvcHRpb25zKXt2YXIgcmVhbE9wdHM9e3JlcGxhY2VkV2l0aDpvcHRpb25zJiYob3B0aW9ucy5ub2RlVHlwZT09bnVsbD9vcHRpb25zLndpZGdldDpvcHRpb25zKSxpbnNlcnRMZWZ0Om9wdGlvbnMmJm9wdGlvbnMuaW5zZXJ0TGVmdCxjbGVhcldoZW5FbXB0eTpmYWxzZSxzaGFyZWQ6b3B0aW9ucyYmb3B0aW9ucy5zaGFyZWQsaGFuZGxlTW91c2VFdmVudHM6b3B0aW9ucyYmb3B0aW9ucy5oYW5kbGVNb3VzZUV2ZW50c307cG9zPWNsaXBQb3ModGhpcyxwb3MpO3JldHVybiBtYXJrVGV4dCh0aGlzLHBvcyxwb3MscmVhbE9wdHMsXCJib29rbWFya1wiKTt9LGZpbmRNYXJrc0F0OmZ1bmN0aW9uKHBvcyl7cG9zPWNsaXBQb3ModGhpcyxwb3MpO3ZhciBtYXJrZXJzPVtdLHNwYW5zPWdldExpbmUodGhpcyxwb3MubGluZSkubWFya2VkU3BhbnM7aWYoc3BhbnMpe2Zvcih2YXIgaT0wO2k8c3BhbnMubGVuZ3RoOysraSl7dmFyIHNwYW49c3BhbnNbaV07aWYoKHNwYW4uZnJvbT09bnVsbHx8c3Bhbi5mcm9tPD1wb3MuY2gpJiYoc3Bhbi50bz09bnVsbHx8c3Bhbi50bz49cG9zLmNoKSl7bWFya2Vycy5wdXNoKHNwYW4ubWFya2VyLnBhcmVudHx8c3Bhbi5tYXJrZXIpO319fXJldHVybiBtYXJrZXJzO30sZmluZE1hcmtzOmZ1bmN0aW9uKGZyb20sdG8sZmlsdGVyKXtmcm9tPWNsaXBQb3ModGhpcyxmcm9tKTt0bz1jbGlwUG9zKHRoaXMsdG8pO3ZhciBmb3VuZD1bXSxsaW5lTm89ZnJvbS5saW5lO3RoaXMuaXRlcihmcm9tLmxpbmUsdG8ubGluZSsxLGZ1bmN0aW9uKGxpbmUpe3ZhciBzcGFucz1saW5lLm1hcmtlZFNwYW5zO2lmKHNwYW5zKXtmb3IodmFyIGk9MDtpPHNwYW5zLmxlbmd0aDtpKyspe3ZhciBzcGFuPXNwYW5zW2ldO2lmKCEoc3Bhbi50byE9bnVsbCYmbGluZU5vPT1mcm9tLmxpbmUmJmZyb20uY2g+PXNwYW4udG98fHNwYW4uZnJvbT09bnVsbCYmbGluZU5vIT1mcm9tLmxpbmV8fHNwYW4uZnJvbSE9bnVsbCYmbGluZU5vPT10by5saW5lJiZzcGFuLmZyb20+PXRvLmNoKSYmKCFmaWx0ZXJ8fGZpbHRlcihzcGFuLm1hcmtlcikpKXtmb3VuZC5wdXNoKHNwYW4ubWFya2VyLnBhcmVudHx8c3Bhbi5tYXJrZXIpO319fSsrbGluZU5vO30pO3JldHVybiBmb3VuZDt9LGdldEFsbE1hcmtzOmZ1bmN0aW9uKCl7dmFyIG1hcmtlcnM9W107dGhpcy5pdGVyKGZ1bmN0aW9uKGxpbmUpe3ZhciBzcHM9bGluZS5tYXJrZWRTcGFucztpZihzcHMpe2Zvcih2YXIgaT0wO2k8c3BzLmxlbmd0aDsrK2kpe2lmKHNwc1tpXS5mcm9tIT1udWxsKXttYXJrZXJzLnB1c2goc3BzW2ldLm1hcmtlcik7fX19fSk7cmV0dXJuIG1hcmtlcnM7fSxwb3NGcm9tSW5kZXg6ZnVuY3Rpb24ob2ZmKXt2YXIgY2gsbGluZU5vPXRoaXMuZmlyc3Qsc2VwU2l6ZT10aGlzLmxpbmVTZXBhcmF0b3IoKS5sZW5ndGg7dGhpcy5pdGVyKGZ1bmN0aW9uKGxpbmUpe3ZhciBzej1saW5lLnRleHQubGVuZ3RoK3NlcFNpemU7aWYoc3o+b2ZmKXtjaD1vZmY7cmV0dXJuIHRydWU7fW9mZi09c3o7KytsaW5lTm87fSk7cmV0dXJuIGNsaXBQb3ModGhpcyxQb3MobGluZU5vLGNoKSk7fSxpbmRleEZyb21Qb3M6ZnVuY3Rpb24oY29vcmRzKXtjb29yZHM9Y2xpcFBvcyh0aGlzLGNvb3Jkcyk7dmFyIGluZGV4PWNvb3Jkcy5jaDtpZihjb29yZHMubGluZTx0aGlzLmZpcnN0fHxjb29yZHMuY2g8MCl7cmV0dXJuIDA7fXZhciBzZXBTaXplPXRoaXMubGluZVNlcGFyYXRvcigpLmxlbmd0aDt0aGlzLml0ZXIodGhpcy5maXJzdCxjb29yZHMubGluZSxmdW5jdGlvbihsaW5lKXsvLyBpdGVyIGFib3J0cyB3aGVuIGNhbGxiYWNrIHJldHVybnMgYSB0cnV0aHkgdmFsdWVcbmluZGV4Kz1saW5lLnRleHQubGVuZ3RoK3NlcFNpemU7fSk7cmV0dXJuIGluZGV4O30sY29weTpmdW5jdGlvbihjb3B5SGlzdG9yeSl7dmFyIGRvYz1uZXcgRG9jKGdldExpbmVzKHRoaXMsdGhpcy5maXJzdCx0aGlzLmZpcnN0K3RoaXMuc2l6ZSksdGhpcy5tb2RlT3B0aW9uLHRoaXMuZmlyc3QsdGhpcy5saW5lU2VwKTtkb2Muc2Nyb2xsVG9wPXRoaXMuc2Nyb2xsVG9wO2RvYy5zY3JvbGxMZWZ0PXRoaXMuc2Nyb2xsTGVmdDtkb2Muc2VsPXRoaXMuc2VsO2RvYy5leHRlbmQ9ZmFsc2U7aWYoY29weUhpc3Rvcnkpe2RvYy5oaXN0b3J5LnVuZG9EZXB0aD10aGlzLmhpc3RvcnkudW5kb0RlcHRoO2RvYy5zZXRIaXN0b3J5KHRoaXMuZ2V0SGlzdG9yeSgpKTt9cmV0dXJuIGRvYzt9LGxpbmtlZERvYzpmdW5jdGlvbihvcHRpb25zKXtpZighb3B0aW9ucyl7b3B0aW9ucz17fTt9dmFyIGZyb209dGhpcy5maXJzdCx0bz10aGlzLmZpcnN0K3RoaXMuc2l6ZTtpZihvcHRpb25zLmZyb20hPW51bGwmJm9wdGlvbnMuZnJvbT5mcm9tKXtmcm9tPW9wdGlvbnMuZnJvbTt9aWYob3B0aW9ucy50byE9bnVsbCYmb3B0aW9ucy50bzx0byl7dG89b3B0aW9ucy50bzt9dmFyIGNvcHk9bmV3IERvYyhnZXRMaW5lcyh0aGlzLGZyb20sdG8pLG9wdGlvbnMubW9kZXx8dGhpcy5tb2RlT3B0aW9uLGZyb20sdGhpcy5saW5lU2VwKTtpZihvcHRpb25zLnNoYXJlZEhpc3Qpe2NvcHkuaGlzdG9yeT10aGlzLmhpc3Rvcnk7fSh0aGlzLmxpbmtlZHx8KHRoaXMubGlua2VkPVtdKSkucHVzaCh7ZG9jOmNvcHksc2hhcmVkSGlzdDpvcHRpb25zLnNoYXJlZEhpc3R9KTtjb3B5LmxpbmtlZD1be2RvYzp0aGlzLGlzUGFyZW50OnRydWUsc2hhcmVkSGlzdDpvcHRpb25zLnNoYXJlZEhpc3R9XTtjb3B5U2hhcmVkTWFya2Vycyhjb3B5LGZpbmRTaGFyZWRNYXJrZXJzKHRoaXMpKTtyZXR1cm4gY29weTt9LHVubGlua0RvYzpmdW5jdGlvbihvdGhlcil7dmFyIHRoaXMkMT10aGlzO2lmKG90aGVyIGluc3RhbmNlb2YgQ29kZU1pcnJvcil7b3RoZXI9b3RoZXIuZG9jO31pZih0aGlzLmxpbmtlZCl7Zm9yKHZhciBpPTA7aTx0aGlzLmxpbmtlZC5sZW5ndGg7KytpKXt2YXIgbGluaz10aGlzJDEubGlua2VkW2ldO2lmKGxpbmsuZG9jIT1vdGhlcil7Y29udGludWU7fXRoaXMkMS5saW5rZWQuc3BsaWNlKGksMSk7b3RoZXIudW5saW5rRG9jKHRoaXMkMSk7ZGV0YWNoU2hhcmVkTWFya2VycyhmaW5kU2hhcmVkTWFya2Vycyh0aGlzJDEpKTticmVhazt9fS8vIElmIHRoZSBoaXN0b3JpZXMgd2VyZSBzaGFyZWQsIHNwbGl0IHRoZW0gYWdhaW5cbmlmKG90aGVyLmhpc3Rvcnk9PXRoaXMuaGlzdG9yeSl7dmFyIHNwbGl0SWRzPVtvdGhlci5pZF07bGlua2VkRG9jcyhvdGhlcixmdW5jdGlvbihkb2Mpe3JldHVybiBzcGxpdElkcy5wdXNoKGRvYy5pZCk7fSx0cnVlKTtvdGhlci5oaXN0b3J5PW5ldyBIaXN0b3J5KG51bGwpO290aGVyLmhpc3RvcnkuZG9uZT1jb3B5SGlzdG9yeUFycmF5KHRoaXMuaGlzdG9yeS5kb25lLHNwbGl0SWRzKTtvdGhlci5oaXN0b3J5LnVuZG9uZT1jb3B5SGlzdG9yeUFycmF5KHRoaXMuaGlzdG9yeS51bmRvbmUsc3BsaXRJZHMpO319LGl0ZXJMaW5rZWREb2NzOmZ1bmN0aW9uKGYpe2xpbmtlZERvY3ModGhpcyxmKTt9LGdldE1vZGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb2RlO30sZ2V0RWRpdG9yOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY207fSxzcGxpdExpbmVzOmZ1bmN0aW9uKHN0cil7aWYodGhpcy5saW5lU2VwKXtyZXR1cm4gc3RyLnNwbGl0KHRoaXMubGluZVNlcCk7fXJldHVybiBzcGxpdExpbmVzQXV0byhzdHIpO30sbGluZVNlcGFyYXRvcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmxpbmVTZXB8fFwiXFxuXCI7fX0pOy8vIFB1YmxpYyBhbGlhcy5cbkRvYy5wcm90b3R5cGUuZWFjaExpbmU9RG9jLnByb3RvdHlwZS5pdGVyOy8vIEtsdWRnZSB0byB3b3JrIGFyb3VuZCBzdHJhbmdlIElFIGJlaGF2aW9yIHdoZXJlIGl0J2xsIHNvbWV0aW1lc1xuLy8gcmUtZmlyZSBhIHNlcmllcyBvZiBkcmFnLXJlbGF0ZWQgZXZlbnRzIHJpZ2h0IGFmdGVyIHRoZSBkcm9wICgjMTU1MSlcbnZhciBsYXN0RHJvcD0wO2Z1bmN0aW9uIG9uRHJvcChlKXt2YXIgY209dGhpcztjbGVhckRyYWdDdXJzb3IoY20pO2lmKHNpZ25hbERPTUV2ZW50KGNtLGUpfHxldmVudEluV2lkZ2V0KGNtLmRpc3BsYXksZSkpe3JldHVybjt9ZV9wcmV2ZW50RGVmYXVsdChlKTtpZihpZSl7bGFzdERyb3A9K25ldyBEYXRlKCk7fXZhciBwb3M9cG9zRnJvbU1vdXNlKGNtLGUsdHJ1ZSksZmlsZXM9ZS5kYXRhVHJhbnNmZXIuZmlsZXM7aWYoIXBvc3x8Y20uaXNSZWFkT25seSgpKXtyZXR1cm47fS8vIE1pZ2h0IGJlIGEgZmlsZSBkcm9wLCBpbiB3aGljaCBjYXNlIHdlIHNpbXBseSBleHRyYWN0IHRoZSB0ZXh0XG4vLyBhbmQgaW5zZXJ0IGl0LlxuaWYoZmlsZXMmJmZpbGVzLmxlbmd0aCYmd2luZG93LkZpbGVSZWFkZXImJndpbmRvdy5GaWxlKXt2YXIgbj1maWxlcy5sZW5ndGgsdGV4dD1BcnJheShuKSxyZWFkPTA7dmFyIGxvYWRGaWxlPWZ1bmN0aW9uKGZpbGUsaSl7aWYoY20ub3B0aW9ucy5hbGxvd0Ryb3BGaWxlVHlwZXMmJmluZGV4T2YoY20ub3B0aW9ucy5hbGxvd0Ryb3BGaWxlVHlwZXMsZmlsZS50eXBlKT09LTEpe3JldHVybjt9dmFyIHJlYWRlcj1uZXcgRmlsZVJlYWRlcigpO3JlYWRlci5vbmxvYWQ9b3BlcmF0aW9uKGNtLGZ1bmN0aW9uKCl7dmFyIGNvbnRlbnQ9cmVhZGVyLnJlc3VsdDtpZigvW1xceDAwLVxceDA4XFx4MGUtXFx4MWZdezJ9Ly50ZXN0KGNvbnRlbnQpKXtjb250ZW50PVwiXCI7fXRleHRbaV09Y29udGVudDtpZigrK3JlYWQ9PW4pe3Bvcz1jbGlwUG9zKGNtLmRvYyxwb3MpO3ZhciBjaGFuZ2U9e2Zyb206cG9zLHRvOnBvcyx0ZXh0OmNtLmRvYy5zcGxpdExpbmVzKHRleHQuam9pbihjbS5kb2MubGluZVNlcGFyYXRvcigpKSksb3JpZ2luOlwicGFzdGVcIn07bWFrZUNoYW5nZShjbS5kb2MsY2hhbmdlKTtzZXRTZWxlY3Rpb25SZXBsYWNlSGlzdG9yeShjbS5kb2Msc2ltcGxlU2VsZWN0aW9uKHBvcyxjaGFuZ2VFbmQoY2hhbmdlKSkpO319KTtyZWFkZXIucmVhZEFzVGV4dChmaWxlKTt9O2Zvcih2YXIgaT0wO2k8bjsrK2kpe2xvYWRGaWxlKGZpbGVzW2ldLGkpO319ZWxzZXsvLyBOb3JtYWwgZHJvcFxuLy8gRG9uJ3QgZG8gYSByZXBsYWNlIGlmIHRoZSBkcm9wIGhhcHBlbmVkIGluc2lkZSBvZiB0aGUgc2VsZWN0ZWQgdGV4dC5cbmlmKGNtLnN0YXRlLmRyYWdnaW5nVGV4dCYmY20uZG9jLnNlbC5jb250YWlucyhwb3MpPi0xKXtjbS5zdGF0ZS5kcmFnZ2luZ1RleHQoZSk7Ly8gRW5zdXJlIHRoZSBlZGl0b3IgaXMgcmUtZm9jdXNlZFxuc2V0VGltZW91dChmdW5jdGlvbigpe3JldHVybiBjbS5kaXNwbGF5LmlucHV0LmZvY3VzKCk7fSwyMCk7cmV0dXJuO310cnl7dmFyIHRleHQkMT1lLmRhdGFUcmFuc2Zlci5nZXREYXRhKFwiVGV4dFwiKTtpZih0ZXh0JDEpe3ZhciBzZWxlY3RlZDtpZihjbS5zdGF0ZS5kcmFnZ2luZ1RleHQmJiFjbS5zdGF0ZS5kcmFnZ2luZ1RleHQuY29weSl7c2VsZWN0ZWQ9Y20ubGlzdFNlbGVjdGlvbnMoKTt9c2V0U2VsZWN0aW9uTm9VbmRvKGNtLmRvYyxzaW1wbGVTZWxlY3Rpb24ocG9zLHBvcykpO2lmKHNlbGVjdGVkKXtmb3IodmFyIGkkMT0wO2kkMTxzZWxlY3RlZC5sZW5ndGg7KytpJDEpe3JlcGxhY2VSYW5nZShjbS5kb2MsXCJcIixzZWxlY3RlZFtpJDFdLmFuY2hvcixzZWxlY3RlZFtpJDFdLmhlYWQsXCJkcmFnXCIpO319Y20ucmVwbGFjZVNlbGVjdGlvbih0ZXh0JDEsXCJhcm91bmRcIixcInBhc3RlXCIpO2NtLmRpc3BsYXkuaW5wdXQuZm9jdXMoKTt9fWNhdGNoKGUpe319fWZ1bmN0aW9uIG9uRHJhZ1N0YXJ0KGNtLGUpe2lmKGllJiYoIWNtLnN0YXRlLmRyYWdnaW5nVGV4dHx8K25ldyBEYXRlKCktbGFzdERyb3A8MTAwKSl7ZV9zdG9wKGUpO3JldHVybjt9aWYoc2lnbmFsRE9NRXZlbnQoY20sZSl8fGV2ZW50SW5XaWRnZXQoY20uZGlzcGxheSxlKSl7cmV0dXJuO31lLmRhdGFUcmFuc2Zlci5zZXREYXRhKFwiVGV4dFwiLGNtLmdldFNlbGVjdGlvbigpKTtlLmRhdGFUcmFuc2Zlci5lZmZlY3RBbGxvd2VkPVwiY29weU1vdmVcIjsvLyBVc2UgZHVtbXkgaW1hZ2UgaW5zdGVhZCBvZiBkZWZhdWx0IGJyb3dzZXJzIGltYWdlLlxuLy8gUmVjZW50IFNhZmFyaSAofjYuMC4yKSBoYXZlIGEgdGVuZGVuY3kgdG8gc2VnZmF1bHQgd2hlbiB0aGlzIGhhcHBlbnMsIHNvIHdlIGRvbid0IGRvIGl0IHRoZXJlLlxuaWYoZS5kYXRhVHJhbnNmZXIuc2V0RHJhZ0ltYWdlJiYhc2FmYXJpKXt2YXIgaW1nPWVsdChcImltZ1wiLG51bGwsbnVsbCxcInBvc2l0aW9uOiBmaXhlZDsgbGVmdDogMDsgdG9wOiAwO1wiKTtpbWcuc3JjPVwiZGF0YTppbWFnZS9naWY7YmFzZTY0LFIwbEdPRGxoQVFBQkFBQUFBQ0g1QkFFS0FBRUFMQUFBQUFBQkFBRUFBQUlDVEFFQU93PT1cIjtpZihwcmVzdG8pe2ltZy53aWR0aD1pbWcuaGVpZ2h0PTE7Y20uZGlzcGxheS53cmFwcGVyLmFwcGVuZENoaWxkKGltZyk7Ly8gRm9yY2UgYSByZWxheW91dCwgb3IgT3BlcmEgd29uJ3QgdXNlIG91ciBpbWFnZSBmb3Igc29tZSBvYnNjdXJlIHJlYXNvblxuaW1nLl90b3A9aW1nLm9mZnNldFRvcDt9ZS5kYXRhVHJhbnNmZXIuc2V0RHJhZ0ltYWdlKGltZywwLDApO2lmKHByZXN0byl7aW1nLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoaW1nKTt9fX1mdW5jdGlvbiBvbkRyYWdPdmVyKGNtLGUpe3ZhciBwb3M9cG9zRnJvbU1vdXNlKGNtLGUpO2lmKCFwb3Mpe3JldHVybjt9dmFyIGZyYWc9ZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO2RyYXdTZWxlY3Rpb25DdXJzb3IoY20scG9zLGZyYWcpO2lmKCFjbS5kaXNwbGF5LmRyYWdDdXJzb3Ipe2NtLmRpc3BsYXkuZHJhZ0N1cnNvcj1lbHQoXCJkaXZcIixudWxsLFwiQ29kZU1pcnJvci1jdXJzb3JzIENvZGVNaXJyb3ItZHJhZ2N1cnNvcnNcIik7Y20uZGlzcGxheS5saW5lU3BhY2UuaW5zZXJ0QmVmb3JlKGNtLmRpc3BsYXkuZHJhZ0N1cnNvcixjbS5kaXNwbGF5LmN1cnNvckRpdik7fXJlbW92ZUNoaWxkcmVuQW5kQWRkKGNtLmRpc3BsYXkuZHJhZ0N1cnNvcixmcmFnKTt9ZnVuY3Rpb24gY2xlYXJEcmFnQ3Vyc29yKGNtKXtpZihjbS5kaXNwbGF5LmRyYWdDdXJzb3Ipe2NtLmRpc3BsYXkubGluZVNwYWNlLnJlbW92ZUNoaWxkKGNtLmRpc3BsYXkuZHJhZ0N1cnNvcik7Y20uZGlzcGxheS5kcmFnQ3Vyc29yPW51bGw7fX0vLyBUaGVzZSBtdXN0IGJlIGhhbmRsZWQgY2FyZWZ1bGx5LCBiZWNhdXNlIG5haXZlbHkgcmVnaXN0ZXJpbmcgYVxuLy8gaGFuZGxlciBmb3IgZWFjaCBlZGl0b3Igd2lsbCBjYXVzZSB0aGUgZWRpdG9ycyB0byBuZXZlciBiZVxuLy8gZ2FyYmFnZSBjb2xsZWN0ZWQuXG5mdW5jdGlvbiBmb3JFYWNoQ29kZU1pcnJvcihmKXtpZighZG9jdW1lbnQuYm9keS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKXtyZXR1cm47fXZhciBieUNsYXNzPWRvY3VtZW50LmJvZHkuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcIkNvZGVNaXJyb3JcIik7Zm9yKHZhciBpPTA7aTxieUNsYXNzLmxlbmd0aDtpKyspe3ZhciBjbT1ieUNsYXNzW2ldLkNvZGVNaXJyb3I7aWYoY20pe2YoY20pO319fXZhciBnbG9iYWxzUmVnaXN0ZXJlZD1mYWxzZTtmdW5jdGlvbiBlbnN1cmVHbG9iYWxIYW5kbGVycygpe2lmKGdsb2JhbHNSZWdpc3RlcmVkKXtyZXR1cm47fXJlZ2lzdGVyR2xvYmFsSGFuZGxlcnMoKTtnbG9iYWxzUmVnaXN0ZXJlZD10cnVlO31mdW5jdGlvbiByZWdpc3Rlckdsb2JhbEhhbmRsZXJzKCl7Ly8gV2hlbiB0aGUgd2luZG93IHJlc2l6ZXMsIHdlIG5lZWQgdG8gcmVmcmVzaCBhY3RpdmUgZWRpdG9ycy5cbnZhciByZXNpemVUaW1lcjtvbih3aW5kb3csXCJyZXNpemVcIixmdW5jdGlvbigpe2lmKHJlc2l6ZVRpbWVyPT1udWxsKXtyZXNpemVUaW1lcj1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7cmVzaXplVGltZXI9bnVsbDtmb3JFYWNoQ29kZU1pcnJvcihvblJlc2l6ZSk7fSwxMDApO319KTsvLyBXaGVuIHRoZSB3aW5kb3cgbG9zZXMgZm9jdXMsIHdlIHdhbnQgdG8gc2hvdyB0aGUgZWRpdG9yIGFzIGJsdXJyZWRcbm9uKHdpbmRvdyxcImJsdXJcIixmdW5jdGlvbigpe3JldHVybiBmb3JFYWNoQ29kZU1pcnJvcihvbkJsdXIpO30pO30vLyBDYWxsZWQgd2hlbiB0aGUgd2luZG93IHJlc2l6ZXNcbmZ1bmN0aW9uIG9uUmVzaXplKGNtKXt2YXIgZD1jbS5kaXNwbGF5O2lmKGQubGFzdFdyYXBIZWlnaHQ9PWQud3JhcHBlci5jbGllbnRIZWlnaHQmJmQubGFzdFdyYXBXaWR0aD09ZC53cmFwcGVyLmNsaWVudFdpZHRoKXtyZXR1cm47fS8vIE1pZ2h0IGJlIGEgdGV4dCBzY2FsaW5nIG9wZXJhdGlvbiwgY2xlYXIgc2l6ZSBjYWNoZXMuXG5kLmNhY2hlZENoYXJXaWR0aD1kLmNhY2hlZFRleHRIZWlnaHQ9ZC5jYWNoZWRQYWRkaW5nSD1udWxsO2Quc2Nyb2xsYmFyc0NsaXBwZWQ9ZmFsc2U7Y20uc2V0U2l6ZSgpO312YXIga2V5TmFtZXM9ezM6XCJFbnRlclwiLDg6XCJCYWNrc3BhY2VcIiw5OlwiVGFiXCIsMTM6XCJFbnRlclwiLDE2OlwiU2hpZnRcIiwxNzpcIkN0cmxcIiwxODpcIkFsdFwiLDE5OlwiUGF1c2VcIiwyMDpcIkNhcHNMb2NrXCIsMjc6XCJFc2NcIiwzMjpcIlNwYWNlXCIsMzM6XCJQYWdlVXBcIiwzNDpcIlBhZ2VEb3duXCIsMzU6XCJFbmRcIiwzNjpcIkhvbWVcIiwzNzpcIkxlZnRcIiwzODpcIlVwXCIsMzk6XCJSaWdodFwiLDQwOlwiRG93blwiLDQ0OlwiUHJpbnRTY3JuXCIsNDU6XCJJbnNlcnRcIiw0NjpcIkRlbGV0ZVwiLDU5OlwiO1wiLDYxOlwiPVwiLDkxOlwiTW9kXCIsOTI6XCJNb2RcIiw5MzpcIk1vZFwiLDEwNjpcIipcIiwxMDc6XCI9XCIsMTA5OlwiLVwiLDExMDpcIi5cIiwxMTE6XCIvXCIsMTI3OlwiRGVsZXRlXCIsMTczOlwiLVwiLDE4NjpcIjtcIiwxODc6XCI9XCIsMTg4OlwiLFwiLDE4OTpcIi1cIiwxOTA6XCIuXCIsMTkxOlwiL1wiLDE5MjpcImBcIiwyMTk6XCJbXCIsMjIwOlwiXFxcXFwiLDIyMTpcIl1cIiwyMjI6XCInXCIsNjMyMzI6XCJVcFwiLDYzMjMzOlwiRG93blwiLDYzMjM0OlwiTGVmdFwiLDYzMjM1OlwiUmlnaHRcIiw2MzI3MjpcIkRlbGV0ZVwiLDYzMjczOlwiSG9tZVwiLDYzMjc1OlwiRW5kXCIsNjMyNzY6XCJQYWdlVXBcIiw2MzI3NzpcIlBhZ2VEb3duXCIsNjMzMDI6XCJJbnNlcnRcIn07Ly8gTnVtYmVyIGtleXNcbmZvcih2YXIgaT0wO2k8MTA7aSsrKXtrZXlOYW1lc1tpKzQ4XT1rZXlOYW1lc1tpKzk2XT1TdHJpbmcoaSk7fS8vIEFscGhhYmV0aWMga2V5c1xuZm9yKHZhciBpJDE9NjU7aSQxPD05MDtpJDErKyl7a2V5TmFtZXNbaSQxXT1TdHJpbmcuZnJvbUNoYXJDb2RlKGkkMSk7fS8vIEZ1bmN0aW9uIGtleXNcbmZvcih2YXIgaSQyPTE7aSQyPD0xMjtpJDIrKyl7a2V5TmFtZXNbaSQyKzExMV09a2V5TmFtZXNbaSQyKzYzMjM1XT1cIkZcIitpJDI7fXZhciBrZXlNYXA9e307a2V5TWFwLmJhc2ljPXtcIkxlZnRcIjpcImdvQ2hhckxlZnRcIixcIlJpZ2h0XCI6XCJnb0NoYXJSaWdodFwiLFwiVXBcIjpcImdvTGluZVVwXCIsXCJEb3duXCI6XCJnb0xpbmVEb3duXCIsXCJFbmRcIjpcImdvTGluZUVuZFwiLFwiSG9tZVwiOlwiZ29MaW5lU3RhcnRTbWFydFwiLFwiUGFnZVVwXCI6XCJnb1BhZ2VVcFwiLFwiUGFnZURvd25cIjpcImdvUGFnZURvd25cIixcIkRlbGV0ZVwiOlwiZGVsQ2hhckFmdGVyXCIsXCJCYWNrc3BhY2VcIjpcImRlbENoYXJCZWZvcmVcIixcIlNoaWZ0LUJhY2tzcGFjZVwiOlwiZGVsQ2hhckJlZm9yZVwiLFwiVGFiXCI6XCJkZWZhdWx0VGFiXCIsXCJTaGlmdC1UYWJcIjpcImluZGVudEF1dG9cIixcIkVudGVyXCI6XCJuZXdsaW5lQW5kSW5kZW50XCIsXCJJbnNlcnRcIjpcInRvZ2dsZU92ZXJ3cml0ZVwiLFwiRXNjXCI6XCJzaW5nbGVTZWxlY3Rpb25cIn07Ly8gTm90ZSB0aGF0IHRoZSBzYXZlIGFuZCBmaW5kLXJlbGF0ZWQgY29tbWFuZHMgYXJlbid0IGRlZmluZWQgYnlcbi8vIGRlZmF1bHQuIFVzZXIgY29kZSBvciBhZGRvbnMgY2FuIGRlZmluZSB0aGVtLiBVbmtub3duIGNvbW1hbmRzXG4vLyBhcmUgc2ltcGx5IGlnbm9yZWQuXG5rZXlNYXAucGNEZWZhdWx0PXtcIkN0cmwtQVwiOlwic2VsZWN0QWxsXCIsXCJDdHJsLURcIjpcImRlbGV0ZUxpbmVcIixcIkN0cmwtWlwiOlwidW5kb1wiLFwiU2hpZnQtQ3RybC1aXCI6XCJyZWRvXCIsXCJDdHJsLVlcIjpcInJlZG9cIixcIkN0cmwtSG9tZVwiOlwiZ29Eb2NTdGFydFwiLFwiQ3RybC1FbmRcIjpcImdvRG9jRW5kXCIsXCJDdHJsLVVwXCI6XCJnb0xpbmVVcFwiLFwiQ3RybC1Eb3duXCI6XCJnb0xpbmVEb3duXCIsXCJDdHJsLUxlZnRcIjpcImdvR3JvdXBMZWZ0XCIsXCJDdHJsLVJpZ2h0XCI6XCJnb0dyb3VwUmlnaHRcIixcIkFsdC1MZWZ0XCI6XCJnb0xpbmVTdGFydFwiLFwiQWx0LVJpZ2h0XCI6XCJnb0xpbmVFbmRcIixcIkN0cmwtQmFja3NwYWNlXCI6XCJkZWxHcm91cEJlZm9yZVwiLFwiQ3RybC1EZWxldGVcIjpcImRlbEdyb3VwQWZ0ZXJcIixcIkN0cmwtU1wiOlwic2F2ZVwiLFwiQ3RybC1GXCI6XCJmaW5kXCIsXCJDdHJsLUdcIjpcImZpbmROZXh0XCIsXCJTaGlmdC1DdHJsLUdcIjpcImZpbmRQcmV2XCIsXCJTaGlmdC1DdHJsLUZcIjpcInJlcGxhY2VcIixcIlNoaWZ0LUN0cmwtUlwiOlwicmVwbGFjZUFsbFwiLFwiQ3RybC1bXCI6XCJpbmRlbnRMZXNzXCIsXCJDdHJsLV1cIjpcImluZGVudE1vcmVcIixcIkN0cmwtVVwiOlwidW5kb1NlbGVjdGlvblwiLFwiU2hpZnQtQ3RybC1VXCI6XCJyZWRvU2VsZWN0aW9uXCIsXCJBbHQtVVwiOlwicmVkb1NlbGVjdGlvblwiLGZhbGx0aHJvdWdoOlwiYmFzaWNcIn07Ly8gVmVyeSBiYXNpYyByZWFkbGluZS9lbWFjcy1zdHlsZSBiaW5kaW5ncywgd2hpY2ggYXJlIHN0YW5kYXJkIG9uIE1hYy5cbmtleU1hcC5lbWFjc3k9e1wiQ3RybC1GXCI6XCJnb0NoYXJSaWdodFwiLFwiQ3RybC1CXCI6XCJnb0NoYXJMZWZ0XCIsXCJDdHJsLVBcIjpcImdvTGluZVVwXCIsXCJDdHJsLU5cIjpcImdvTGluZURvd25cIixcIkFsdC1GXCI6XCJnb1dvcmRSaWdodFwiLFwiQWx0LUJcIjpcImdvV29yZExlZnRcIixcIkN0cmwtQVwiOlwiZ29MaW5lU3RhcnRcIixcIkN0cmwtRVwiOlwiZ29MaW5lRW5kXCIsXCJDdHJsLVZcIjpcImdvUGFnZURvd25cIixcIlNoaWZ0LUN0cmwtVlwiOlwiZ29QYWdlVXBcIixcIkN0cmwtRFwiOlwiZGVsQ2hhckFmdGVyXCIsXCJDdHJsLUhcIjpcImRlbENoYXJCZWZvcmVcIixcIkFsdC1EXCI6XCJkZWxXb3JkQWZ0ZXJcIixcIkFsdC1CYWNrc3BhY2VcIjpcImRlbFdvcmRCZWZvcmVcIixcIkN0cmwtS1wiOlwia2lsbExpbmVcIixcIkN0cmwtVFwiOlwidHJhbnNwb3NlQ2hhcnNcIixcIkN0cmwtT1wiOlwib3BlbkxpbmVcIn07a2V5TWFwLm1hY0RlZmF1bHQ9e1wiQ21kLUFcIjpcInNlbGVjdEFsbFwiLFwiQ21kLURcIjpcImRlbGV0ZUxpbmVcIixcIkNtZC1aXCI6XCJ1bmRvXCIsXCJTaGlmdC1DbWQtWlwiOlwicmVkb1wiLFwiQ21kLVlcIjpcInJlZG9cIixcIkNtZC1Ib21lXCI6XCJnb0RvY1N0YXJ0XCIsXCJDbWQtVXBcIjpcImdvRG9jU3RhcnRcIixcIkNtZC1FbmRcIjpcImdvRG9jRW5kXCIsXCJDbWQtRG93blwiOlwiZ29Eb2NFbmRcIixcIkFsdC1MZWZ0XCI6XCJnb0dyb3VwTGVmdFwiLFwiQWx0LVJpZ2h0XCI6XCJnb0dyb3VwUmlnaHRcIixcIkNtZC1MZWZ0XCI6XCJnb0xpbmVMZWZ0XCIsXCJDbWQtUmlnaHRcIjpcImdvTGluZVJpZ2h0XCIsXCJBbHQtQmFja3NwYWNlXCI6XCJkZWxHcm91cEJlZm9yZVwiLFwiQ3RybC1BbHQtQmFja3NwYWNlXCI6XCJkZWxHcm91cEFmdGVyXCIsXCJBbHQtRGVsZXRlXCI6XCJkZWxHcm91cEFmdGVyXCIsXCJDbWQtU1wiOlwic2F2ZVwiLFwiQ21kLUZcIjpcImZpbmRcIixcIkNtZC1HXCI6XCJmaW5kTmV4dFwiLFwiU2hpZnQtQ21kLUdcIjpcImZpbmRQcmV2XCIsXCJDbWQtQWx0LUZcIjpcInJlcGxhY2VcIixcIlNoaWZ0LUNtZC1BbHQtRlwiOlwicmVwbGFjZUFsbFwiLFwiQ21kLVtcIjpcImluZGVudExlc3NcIixcIkNtZC1dXCI6XCJpbmRlbnRNb3JlXCIsXCJDbWQtQmFja3NwYWNlXCI6XCJkZWxXcmFwcGVkTGluZUxlZnRcIixcIkNtZC1EZWxldGVcIjpcImRlbFdyYXBwZWRMaW5lUmlnaHRcIixcIkNtZC1VXCI6XCJ1bmRvU2VsZWN0aW9uXCIsXCJTaGlmdC1DbWQtVVwiOlwicmVkb1NlbGVjdGlvblwiLFwiQ3RybC1VcFwiOlwiZ29Eb2NTdGFydFwiLFwiQ3RybC1Eb3duXCI6XCJnb0RvY0VuZFwiLGZhbGx0aHJvdWdoOltcImJhc2ljXCIsXCJlbWFjc3lcIl19O2tleU1hcFtcImRlZmF1bHRcIl09bWFjP2tleU1hcC5tYWNEZWZhdWx0OmtleU1hcC5wY0RlZmF1bHQ7Ly8gS0VZTUFQIERJU1BBVENIXG5mdW5jdGlvbiBub3JtYWxpemVLZXlOYW1lKG5hbWUpe3ZhciBwYXJ0cz1uYW1lLnNwbGl0KC8tKD8hJCkvKTtuYW1lPXBhcnRzW3BhcnRzLmxlbmd0aC0xXTt2YXIgYWx0LGN0cmwsc2hpZnQsY21kO2Zvcih2YXIgaT0wO2k8cGFydHMubGVuZ3RoLTE7aSsrKXt2YXIgbW9kPXBhcnRzW2ldO2lmKC9eKGNtZHxtZXRhfG0pJC9pLnRlc3QobW9kKSl7Y21kPXRydWU7fWVsc2UgaWYoL15hKGx0KT8kL2kudGVzdChtb2QpKXthbHQ9dHJ1ZTt9ZWxzZSBpZigvXihjfGN0cmx8Y29udHJvbCkkL2kudGVzdChtb2QpKXtjdHJsPXRydWU7fWVsc2UgaWYoL15zKGhpZnQpPyQvaS50ZXN0KG1vZCkpe3NoaWZ0PXRydWU7fWVsc2V7dGhyb3cgbmV3IEVycm9yKFwiVW5yZWNvZ25pemVkIG1vZGlmaWVyIG5hbWU6IFwiK21vZCk7fX1pZihhbHQpe25hbWU9XCJBbHQtXCIrbmFtZTt9aWYoY3RybCl7bmFtZT1cIkN0cmwtXCIrbmFtZTt9aWYoY21kKXtuYW1lPVwiQ21kLVwiK25hbWU7fWlmKHNoaWZ0KXtuYW1lPVwiU2hpZnQtXCIrbmFtZTt9cmV0dXJuIG5hbWU7fS8vIFRoaXMgaXMgYSBrbHVkZ2UgdG8ga2VlcCBrZXltYXBzIG1vc3RseSB3b3JraW5nIGFzIHJhdyBvYmplY3RzXG4vLyAoYmFja3dhcmRzIGNvbXBhdGliaWxpdHkpIHdoaWxlIGF0IHRoZSBzYW1lIHRpbWUgc3VwcG9ydCBmZWF0dXJlc1xuLy8gbGlrZSBub3JtYWxpemF0aW9uIGFuZCBtdWx0aS1zdHJva2Uga2V5IGJpbmRpbmdzLiBJdCBjb21waWxlcyBhXG4vLyBuZXcgbm9ybWFsaXplZCBrZXltYXAsIGFuZCB0aGVuIHVwZGF0ZXMgdGhlIG9sZCBvYmplY3QgdG8gcmVmbGVjdFxuLy8gdGhpcy5cbmZ1bmN0aW9uIG5vcm1hbGl6ZUtleU1hcChrZXltYXApe3ZhciBjb3B5PXt9O2Zvcih2YXIga2V5bmFtZSBpbiBrZXltYXApe2lmKGtleW1hcC5oYXNPd25Qcm9wZXJ0eShrZXluYW1lKSl7dmFyIHZhbHVlPWtleW1hcFtrZXluYW1lXTtpZigvXihuYW1lfGZhbGx0aHJvdWdofChkZXxhdCl0YWNoKSQvLnRlc3Qoa2V5bmFtZSkpe2NvbnRpbnVlO31pZih2YWx1ZT09XCIuLi5cIil7ZGVsZXRlIGtleW1hcFtrZXluYW1lXTtjb250aW51ZTt9dmFyIGtleXM9bWFwKGtleW5hbWUuc3BsaXQoXCIgXCIpLG5vcm1hbGl6ZUtleU5hbWUpO2Zvcih2YXIgaT0wO2k8a2V5cy5sZW5ndGg7aSsrKXt2YXIgdmFsPXZvaWQgMCxuYW1lPXZvaWQgMDtpZihpPT1rZXlzLmxlbmd0aC0xKXtuYW1lPWtleXMuam9pbihcIiBcIik7dmFsPXZhbHVlO31lbHNle25hbWU9a2V5cy5zbGljZSgwLGkrMSkuam9pbihcIiBcIik7dmFsPVwiLi4uXCI7fXZhciBwcmV2PWNvcHlbbmFtZV07aWYoIXByZXYpe2NvcHlbbmFtZV09dmFsO31lbHNlIGlmKHByZXYhPXZhbCl7dGhyb3cgbmV3IEVycm9yKFwiSW5jb25zaXN0ZW50IGJpbmRpbmdzIGZvciBcIituYW1lKTt9fWRlbGV0ZSBrZXltYXBba2V5bmFtZV07fX1mb3IodmFyIHByb3AgaW4gY29weSl7a2V5bWFwW3Byb3BdPWNvcHlbcHJvcF07fXJldHVybiBrZXltYXA7fWZ1bmN0aW9uIGxvb2t1cEtleShrZXksbWFwLGhhbmRsZSxjb250ZXh0KXttYXA9Z2V0S2V5TWFwKG1hcCk7dmFyIGZvdW5kPW1hcC5jYWxsP21hcC5jYWxsKGtleSxjb250ZXh0KTptYXBba2V5XTtpZihmb3VuZD09PWZhbHNlKXtyZXR1cm5cIm5vdGhpbmdcIjt9aWYoZm91bmQ9PT1cIi4uLlwiKXtyZXR1cm5cIm11bHRpXCI7fWlmKGZvdW5kIT1udWxsJiZoYW5kbGUoZm91bmQpKXtyZXR1cm5cImhhbmRsZWRcIjt9aWYobWFwLmZhbGx0aHJvdWdoKXtpZihPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobWFwLmZhbGx0aHJvdWdoKSE9XCJbb2JqZWN0IEFycmF5XVwiKXtyZXR1cm4gbG9va3VwS2V5KGtleSxtYXAuZmFsbHRocm91Z2gsaGFuZGxlLGNvbnRleHQpO31mb3IodmFyIGk9MDtpPG1hcC5mYWxsdGhyb3VnaC5sZW5ndGg7aSsrKXt2YXIgcmVzdWx0PWxvb2t1cEtleShrZXksbWFwLmZhbGx0aHJvdWdoW2ldLGhhbmRsZSxjb250ZXh0KTtpZihyZXN1bHQpe3JldHVybiByZXN1bHQ7fX19fS8vIE1vZGlmaWVyIGtleSBwcmVzc2VzIGRvbid0IGNvdW50IGFzICdyZWFsJyBrZXkgcHJlc3NlcyBmb3IgdGhlXG4vLyBwdXJwb3NlIG9mIGtleW1hcCBmYWxsdGhyb3VnaC5cbmZ1bmN0aW9uIGlzTW9kaWZpZXJLZXkodmFsdWUpe3ZhciBuYW1lPXR5cGVvZiB2YWx1ZT09XCJzdHJpbmdcIj92YWx1ZTprZXlOYW1lc1t2YWx1ZS5rZXlDb2RlXTtyZXR1cm4gbmFtZT09XCJDdHJsXCJ8fG5hbWU9PVwiQWx0XCJ8fG5hbWU9PVwiU2hpZnRcInx8bmFtZT09XCJNb2RcIjt9Ly8gTG9vayB1cCB0aGUgbmFtZSBvZiBhIGtleSBhcyBpbmRpY2F0ZWQgYnkgYW4gZXZlbnQgb2JqZWN0LlxuZnVuY3Rpb24ga2V5TmFtZShldmVudCxub1NoaWZ0KXtpZihwcmVzdG8mJmV2ZW50LmtleUNvZGU9PTM0JiZldmVudFtcImNoYXJcIl0pe3JldHVybiBmYWxzZTt9dmFyIGJhc2U9a2V5TmFtZXNbZXZlbnQua2V5Q29kZV0sbmFtZT1iYXNlO2lmKG5hbWU9PW51bGx8fGV2ZW50LmFsdEdyYXBoS2V5KXtyZXR1cm4gZmFsc2U7fWlmKGV2ZW50LmFsdEtleSYmYmFzZSE9XCJBbHRcIil7bmFtZT1cIkFsdC1cIituYW1lO31pZigoZmxpcEN0cmxDbWQ/ZXZlbnQubWV0YUtleTpldmVudC5jdHJsS2V5KSYmYmFzZSE9XCJDdHJsXCIpe25hbWU9XCJDdHJsLVwiK25hbWU7fWlmKChmbGlwQ3RybENtZD9ldmVudC5jdHJsS2V5OmV2ZW50Lm1ldGFLZXkpJiZiYXNlIT1cIkNtZFwiKXtuYW1lPVwiQ21kLVwiK25hbWU7fWlmKCFub1NoaWZ0JiZldmVudC5zaGlmdEtleSYmYmFzZSE9XCJTaGlmdFwiKXtuYW1lPVwiU2hpZnQtXCIrbmFtZTt9cmV0dXJuIG5hbWU7fWZ1bmN0aW9uIGdldEtleU1hcCh2YWwpe3JldHVybiB0eXBlb2YgdmFsPT1cInN0cmluZ1wiP2tleU1hcFt2YWxdOnZhbDt9Ly8gSGVscGVyIGZvciBkZWxldGluZyB0ZXh0IG5lYXIgdGhlIHNlbGVjdGlvbihzKSwgdXNlZCB0byBpbXBsZW1lbnRcbi8vIGJhY2tzcGFjZSwgZGVsZXRlLCBhbmQgc2ltaWxhciBmdW5jdGlvbmFsaXR5LlxuZnVuY3Rpb24gZGVsZXRlTmVhclNlbGVjdGlvbihjbSxjb21wdXRlKXt2YXIgcmFuZ2VzPWNtLmRvYy5zZWwucmFuZ2VzLGtpbGw9W107Ly8gQnVpbGQgdXAgYSBzZXQgb2YgcmFuZ2VzIHRvIGtpbGwgZmlyc3QsIG1lcmdpbmcgb3ZlcmxhcHBpbmdcbi8vIHJhbmdlcy5cbmZvcih2YXIgaT0wO2k8cmFuZ2VzLmxlbmd0aDtpKyspe3ZhciB0b0tpbGw9Y29tcHV0ZShyYW5nZXNbaV0pO3doaWxlKGtpbGwubGVuZ3RoJiZjbXAodG9LaWxsLmZyb20sbHN0KGtpbGwpLnRvKTw9MCl7dmFyIHJlcGxhY2VkPWtpbGwucG9wKCk7aWYoY21wKHJlcGxhY2VkLmZyb20sdG9LaWxsLmZyb20pPDApe3RvS2lsbC5mcm9tPXJlcGxhY2VkLmZyb207YnJlYWs7fX1raWxsLnB1c2godG9LaWxsKTt9Ly8gTmV4dCwgcmVtb3ZlIHRob3NlIGFjdHVhbCByYW5nZXMuXG5ydW5Jbk9wKGNtLGZ1bmN0aW9uKCl7Zm9yKHZhciBpPWtpbGwubGVuZ3RoLTE7aT49MDtpLS0pe3JlcGxhY2VSYW5nZShjbS5kb2MsXCJcIixraWxsW2ldLmZyb20sa2lsbFtpXS50byxcIitkZWxldGVcIik7fWVuc3VyZUN1cnNvclZpc2libGUoY20pO30pO30vLyBDb21tYW5kcyBhcmUgcGFyYW1ldGVyLWxlc3MgYWN0aW9ucyB0aGF0IGNhbiBiZSBwZXJmb3JtZWQgb24gYW5cbi8vIGVkaXRvciwgbW9zdGx5IHVzZWQgZm9yIGtleWJpbmRpbmdzLlxudmFyIGNvbW1hbmRzPXtzZWxlY3RBbGw6c2VsZWN0QWxsLHNpbmdsZVNlbGVjdGlvbjpmdW5jdGlvbihjbSl7cmV0dXJuIGNtLnNldFNlbGVjdGlvbihjbS5nZXRDdXJzb3IoXCJhbmNob3JcIiksY20uZ2V0Q3Vyc29yKFwiaGVhZFwiKSxzZWxfZG9udFNjcm9sbCk7fSxraWxsTGluZTpmdW5jdGlvbihjbSl7cmV0dXJuIGRlbGV0ZU5lYXJTZWxlY3Rpb24oY20sZnVuY3Rpb24ocmFuZ2Upe2lmKHJhbmdlLmVtcHR5KCkpe3ZhciBsZW49Z2V0TGluZShjbS5kb2MscmFuZ2UuaGVhZC5saW5lKS50ZXh0Lmxlbmd0aDtpZihyYW5nZS5oZWFkLmNoPT1sZW4mJnJhbmdlLmhlYWQubGluZTxjbS5sYXN0TGluZSgpKXtyZXR1cm57ZnJvbTpyYW5nZS5oZWFkLHRvOlBvcyhyYW5nZS5oZWFkLmxpbmUrMSwwKX07fWVsc2V7cmV0dXJue2Zyb206cmFuZ2UuaGVhZCx0bzpQb3MocmFuZ2UuaGVhZC5saW5lLGxlbil9O319ZWxzZXtyZXR1cm57ZnJvbTpyYW5nZS5mcm9tKCksdG86cmFuZ2UudG8oKX07fX0pO30sZGVsZXRlTGluZTpmdW5jdGlvbihjbSl7cmV0dXJuIGRlbGV0ZU5lYXJTZWxlY3Rpb24oY20sZnVuY3Rpb24ocmFuZ2Upe3JldHVybntmcm9tOlBvcyhyYW5nZS5mcm9tKCkubGluZSwwKSx0bzpjbGlwUG9zKGNtLmRvYyxQb3MocmFuZ2UudG8oKS5saW5lKzEsMCkpfTt9KTt9LGRlbExpbmVMZWZ0OmZ1bmN0aW9uKGNtKXtyZXR1cm4gZGVsZXRlTmVhclNlbGVjdGlvbihjbSxmdW5jdGlvbihyYW5nZSl7cmV0dXJue2Zyb206UG9zKHJhbmdlLmZyb20oKS5saW5lLDApLHRvOnJhbmdlLmZyb20oKX07fSk7fSxkZWxXcmFwcGVkTGluZUxlZnQ6ZnVuY3Rpb24oY20pe3JldHVybiBkZWxldGVOZWFyU2VsZWN0aW9uKGNtLGZ1bmN0aW9uKHJhbmdlKXt2YXIgdG9wPWNtLmNoYXJDb29yZHMocmFuZ2UuaGVhZCxcImRpdlwiKS50b3ArNTt2YXIgbGVmdFBvcz1jbS5jb29yZHNDaGFyKHtsZWZ0OjAsdG9wOnRvcH0sXCJkaXZcIik7cmV0dXJue2Zyb206bGVmdFBvcyx0bzpyYW5nZS5mcm9tKCl9O30pO30sZGVsV3JhcHBlZExpbmVSaWdodDpmdW5jdGlvbihjbSl7cmV0dXJuIGRlbGV0ZU5lYXJTZWxlY3Rpb24oY20sZnVuY3Rpb24ocmFuZ2Upe3ZhciB0b3A9Y20uY2hhckNvb3JkcyhyYW5nZS5oZWFkLFwiZGl2XCIpLnRvcCs1O3ZhciByaWdodFBvcz1jbS5jb29yZHNDaGFyKHtsZWZ0OmNtLmRpc3BsYXkubGluZURpdi5vZmZzZXRXaWR0aCsxMDAsdG9wOnRvcH0sXCJkaXZcIik7cmV0dXJue2Zyb206cmFuZ2UuZnJvbSgpLHRvOnJpZ2h0UG9zfTt9KTt9LHVuZG86ZnVuY3Rpb24oY20pe3JldHVybiBjbS51bmRvKCk7fSxyZWRvOmZ1bmN0aW9uKGNtKXtyZXR1cm4gY20ucmVkbygpO30sdW5kb1NlbGVjdGlvbjpmdW5jdGlvbihjbSl7cmV0dXJuIGNtLnVuZG9TZWxlY3Rpb24oKTt9LHJlZG9TZWxlY3Rpb246ZnVuY3Rpb24oY20pe3JldHVybiBjbS5yZWRvU2VsZWN0aW9uKCk7fSxnb0RvY1N0YXJ0OmZ1bmN0aW9uKGNtKXtyZXR1cm4gY20uZXh0ZW5kU2VsZWN0aW9uKFBvcyhjbS5maXJzdExpbmUoKSwwKSk7fSxnb0RvY0VuZDpmdW5jdGlvbihjbSl7cmV0dXJuIGNtLmV4dGVuZFNlbGVjdGlvbihQb3MoY20ubGFzdExpbmUoKSkpO30sZ29MaW5lU3RhcnQ6ZnVuY3Rpb24oY20pe3JldHVybiBjbS5leHRlbmRTZWxlY3Rpb25zQnkoZnVuY3Rpb24ocmFuZ2Upe3JldHVybiBsaW5lU3RhcnQoY20scmFuZ2UuaGVhZC5saW5lKTt9LHtvcmlnaW46XCIrbW92ZVwiLGJpYXM6MX0pO30sZ29MaW5lU3RhcnRTbWFydDpmdW5jdGlvbihjbSl7cmV0dXJuIGNtLmV4dGVuZFNlbGVjdGlvbnNCeShmdW5jdGlvbihyYW5nZSl7cmV0dXJuIGxpbmVTdGFydFNtYXJ0KGNtLHJhbmdlLmhlYWQpO30se29yaWdpbjpcIittb3ZlXCIsYmlhczoxfSk7fSxnb0xpbmVFbmQ6ZnVuY3Rpb24oY20pe3JldHVybiBjbS5leHRlbmRTZWxlY3Rpb25zQnkoZnVuY3Rpb24ocmFuZ2Upe3JldHVybiBsaW5lRW5kKGNtLHJhbmdlLmhlYWQubGluZSk7fSx7b3JpZ2luOlwiK21vdmVcIixiaWFzOi0xfSk7fSxnb0xpbmVSaWdodDpmdW5jdGlvbihjbSl7cmV0dXJuIGNtLmV4dGVuZFNlbGVjdGlvbnNCeShmdW5jdGlvbihyYW5nZSl7dmFyIHRvcD1jbS5jaGFyQ29vcmRzKHJhbmdlLmhlYWQsXCJkaXZcIikudG9wKzU7cmV0dXJuIGNtLmNvb3Jkc0NoYXIoe2xlZnQ6Y20uZGlzcGxheS5saW5lRGl2Lm9mZnNldFdpZHRoKzEwMCx0b3A6dG9wfSxcImRpdlwiKTt9LHNlbF9tb3ZlKTt9LGdvTGluZUxlZnQ6ZnVuY3Rpb24oY20pe3JldHVybiBjbS5leHRlbmRTZWxlY3Rpb25zQnkoZnVuY3Rpb24ocmFuZ2Upe3ZhciB0b3A9Y20uY2hhckNvb3JkcyhyYW5nZS5oZWFkLFwiZGl2XCIpLnRvcCs1O3JldHVybiBjbS5jb29yZHNDaGFyKHtsZWZ0OjAsdG9wOnRvcH0sXCJkaXZcIik7fSxzZWxfbW92ZSk7fSxnb0xpbmVMZWZ0U21hcnQ6ZnVuY3Rpb24oY20pe3JldHVybiBjbS5leHRlbmRTZWxlY3Rpb25zQnkoZnVuY3Rpb24ocmFuZ2Upe3ZhciB0b3A9Y20uY2hhckNvb3JkcyhyYW5nZS5oZWFkLFwiZGl2XCIpLnRvcCs1O3ZhciBwb3M9Y20uY29vcmRzQ2hhcih7bGVmdDowLHRvcDp0b3B9LFwiZGl2XCIpO2lmKHBvcy5jaDxjbS5nZXRMaW5lKHBvcy5saW5lKS5zZWFyY2goL1xcUy8pKXtyZXR1cm4gbGluZVN0YXJ0U21hcnQoY20scmFuZ2UuaGVhZCk7fXJldHVybiBwb3M7fSxzZWxfbW92ZSk7fSxnb0xpbmVVcDpmdW5jdGlvbihjbSl7cmV0dXJuIGNtLm1vdmVWKC0xLFwibGluZVwiKTt9LGdvTGluZURvd246ZnVuY3Rpb24oY20pe3JldHVybiBjbS5tb3ZlVigxLFwibGluZVwiKTt9LGdvUGFnZVVwOmZ1bmN0aW9uKGNtKXtyZXR1cm4gY20ubW92ZVYoLTEsXCJwYWdlXCIpO30sZ29QYWdlRG93bjpmdW5jdGlvbihjbSl7cmV0dXJuIGNtLm1vdmVWKDEsXCJwYWdlXCIpO30sZ29DaGFyTGVmdDpmdW5jdGlvbihjbSl7cmV0dXJuIGNtLm1vdmVIKC0xLFwiY2hhclwiKTt9LGdvQ2hhclJpZ2h0OmZ1bmN0aW9uKGNtKXtyZXR1cm4gY20ubW92ZUgoMSxcImNoYXJcIik7fSxnb0NvbHVtbkxlZnQ6ZnVuY3Rpb24oY20pe3JldHVybiBjbS5tb3ZlSCgtMSxcImNvbHVtblwiKTt9LGdvQ29sdW1uUmlnaHQ6ZnVuY3Rpb24oY20pe3JldHVybiBjbS5tb3ZlSCgxLFwiY29sdW1uXCIpO30sZ29Xb3JkTGVmdDpmdW5jdGlvbihjbSl7cmV0dXJuIGNtLm1vdmVIKC0xLFwid29yZFwiKTt9LGdvR3JvdXBSaWdodDpmdW5jdGlvbihjbSl7cmV0dXJuIGNtLm1vdmVIKDEsXCJncm91cFwiKTt9LGdvR3JvdXBMZWZ0OmZ1bmN0aW9uKGNtKXtyZXR1cm4gY20ubW92ZUgoLTEsXCJncm91cFwiKTt9LGdvV29yZFJpZ2h0OmZ1bmN0aW9uKGNtKXtyZXR1cm4gY20ubW92ZUgoMSxcIndvcmRcIik7fSxkZWxDaGFyQmVmb3JlOmZ1bmN0aW9uKGNtKXtyZXR1cm4gY20uZGVsZXRlSCgtMSxcImNoYXJcIik7fSxkZWxDaGFyQWZ0ZXI6ZnVuY3Rpb24oY20pe3JldHVybiBjbS5kZWxldGVIKDEsXCJjaGFyXCIpO30sZGVsV29yZEJlZm9yZTpmdW5jdGlvbihjbSl7cmV0dXJuIGNtLmRlbGV0ZUgoLTEsXCJ3b3JkXCIpO30sZGVsV29yZEFmdGVyOmZ1bmN0aW9uKGNtKXtyZXR1cm4gY20uZGVsZXRlSCgxLFwid29yZFwiKTt9LGRlbEdyb3VwQmVmb3JlOmZ1bmN0aW9uKGNtKXtyZXR1cm4gY20uZGVsZXRlSCgtMSxcImdyb3VwXCIpO30sZGVsR3JvdXBBZnRlcjpmdW5jdGlvbihjbSl7cmV0dXJuIGNtLmRlbGV0ZUgoMSxcImdyb3VwXCIpO30saW5kZW50QXV0bzpmdW5jdGlvbihjbSl7cmV0dXJuIGNtLmluZGVudFNlbGVjdGlvbihcInNtYXJ0XCIpO30saW5kZW50TW9yZTpmdW5jdGlvbihjbSl7cmV0dXJuIGNtLmluZGVudFNlbGVjdGlvbihcImFkZFwiKTt9LGluZGVudExlc3M6ZnVuY3Rpb24oY20pe3JldHVybiBjbS5pbmRlbnRTZWxlY3Rpb24oXCJzdWJ0cmFjdFwiKTt9LGluc2VydFRhYjpmdW5jdGlvbihjbSl7cmV0dXJuIGNtLnJlcGxhY2VTZWxlY3Rpb24oXCJcXHRcIik7fSxpbnNlcnRTb2Z0VGFiOmZ1bmN0aW9uKGNtKXt2YXIgc3BhY2VzPVtdLHJhbmdlcz1jbS5saXN0U2VsZWN0aW9ucygpLHRhYlNpemU9Y20ub3B0aW9ucy50YWJTaXplO2Zvcih2YXIgaT0wO2k8cmFuZ2VzLmxlbmd0aDtpKyspe3ZhciBwb3M9cmFuZ2VzW2ldLmZyb20oKTt2YXIgY29sPWNvdW50Q29sdW1uKGNtLmdldExpbmUocG9zLmxpbmUpLHBvcy5jaCx0YWJTaXplKTtzcGFjZXMucHVzaChzcGFjZVN0cih0YWJTaXplLWNvbCV0YWJTaXplKSk7fWNtLnJlcGxhY2VTZWxlY3Rpb25zKHNwYWNlcyk7fSxkZWZhdWx0VGFiOmZ1bmN0aW9uKGNtKXtpZihjbS5zb21ldGhpbmdTZWxlY3RlZCgpKXtjbS5pbmRlbnRTZWxlY3Rpb24oXCJhZGRcIik7fWVsc2V7Y20uZXhlY0NvbW1hbmQoXCJpbnNlcnRUYWJcIik7fX0sLy8gU3dhcCB0aGUgdHdvIGNoYXJzIGxlZnQgYW5kIHJpZ2h0IG9mIGVhY2ggc2VsZWN0aW9uJ3MgaGVhZC5cbi8vIE1vdmUgY3Vyc29yIGJlaGluZCB0aGUgdHdvIHN3YXBwZWQgY2hhcmFjdGVycyBhZnRlcndhcmRzLlxuLy9cbi8vIERvZXNuJ3QgY29uc2lkZXIgbGluZSBmZWVkcyBhIGNoYXJhY3Rlci5cbi8vIERvZXNuJ3Qgc2NhbiBtb3JlIHRoYW4gb25lIGxpbmUgYWJvdmUgdG8gZmluZCBhIGNoYXJhY3Rlci5cbi8vIERvZXNuJ3QgZG8gYW55dGhpbmcgb24gYW4gZW1wdHkgbGluZS5cbi8vIERvZXNuJ3QgZG8gYW55dGhpbmcgd2l0aCBub24tZW1wdHkgc2VsZWN0aW9ucy5cbnRyYW5zcG9zZUNoYXJzOmZ1bmN0aW9uKGNtKXtyZXR1cm4gcnVuSW5PcChjbSxmdW5jdGlvbigpe3ZhciByYW5nZXM9Y20ubGlzdFNlbGVjdGlvbnMoKSxuZXdTZWw9W107Zm9yKHZhciBpPTA7aTxyYW5nZXMubGVuZ3RoO2krKyl7aWYoIXJhbmdlc1tpXS5lbXB0eSgpKXtjb250aW51ZTt9dmFyIGN1cj1yYW5nZXNbaV0uaGVhZCxsaW5lPWdldExpbmUoY20uZG9jLGN1ci5saW5lKS50ZXh0O2lmKGxpbmUpe2lmKGN1ci5jaD09bGluZS5sZW5ndGgpe2N1cj1uZXcgUG9zKGN1ci5saW5lLGN1ci5jaC0xKTt9aWYoY3VyLmNoPjApe2N1cj1uZXcgUG9zKGN1ci5saW5lLGN1ci5jaCsxKTtjbS5yZXBsYWNlUmFuZ2UobGluZS5jaGFyQXQoY3VyLmNoLTEpK2xpbmUuY2hhckF0KGN1ci5jaC0yKSxQb3MoY3VyLmxpbmUsY3VyLmNoLTIpLGN1cixcIit0cmFuc3Bvc2VcIik7fWVsc2UgaWYoY3VyLmxpbmU+Y20uZG9jLmZpcnN0KXt2YXIgcHJldj1nZXRMaW5lKGNtLmRvYyxjdXIubGluZS0xKS50ZXh0O2lmKHByZXYpe2N1cj1uZXcgUG9zKGN1ci5saW5lLDEpO2NtLnJlcGxhY2VSYW5nZShsaW5lLmNoYXJBdCgwKStjbS5kb2MubGluZVNlcGFyYXRvcigpK3ByZXYuY2hhckF0KHByZXYubGVuZ3RoLTEpLFBvcyhjdXIubGluZS0xLHByZXYubGVuZ3RoLTEpLGN1cixcIit0cmFuc3Bvc2VcIik7fX19bmV3U2VsLnB1c2gobmV3IFJhbmdlKGN1cixjdXIpKTt9Y20uc2V0U2VsZWN0aW9ucyhuZXdTZWwpO30pO30sbmV3bGluZUFuZEluZGVudDpmdW5jdGlvbihjbSl7cmV0dXJuIHJ1bkluT3AoY20sZnVuY3Rpb24oKXt2YXIgc2Vscz1jbS5saXN0U2VsZWN0aW9ucygpO2Zvcih2YXIgaT1zZWxzLmxlbmd0aC0xO2k+PTA7aS0tKXtjbS5yZXBsYWNlUmFuZ2UoY20uZG9jLmxpbmVTZXBhcmF0b3IoKSxzZWxzW2ldLmFuY2hvcixzZWxzW2ldLmhlYWQsXCIraW5wdXRcIik7fXNlbHM9Y20ubGlzdFNlbGVjdGlvbnMoKTtmb3IodmFyIGkkMT0wO2kkMTxzZWxzLmxlbmd0aDtpJDErKyl7Y20uaW5kZW50TGluZShzZWxzW2kkMV0uZnJvbSgpLmxpbmUsbnVsbCx0cnVlKTt9ZW5zdXJlQ3Vyc29yVmlzaWJsZShjbSk7fSk7fSxvcGVuTGluZTpmdW5jdGlvbihjbSl7cmV0dXJuIGNtLnJlcGxhY2VTZWxlY3Rpb24oXCJcXG5cIixcInN0YXJ0XCIpO30sdG9nZ2xlT3ZlcndyaXRlOmZ1bmN0aW9uKGNtKXtyZXR1cm4gY20udG9nZ2xlT3ZlcndyaXRlKCk7fX07ZnVuY3Rpb24gbGluZVN0YXJ0KGNtLGxpbmVOKXt2YXIgbGluZT1nZXRMaW5lKGNtLmRvYyxsaW5lTik7dmFyIHZpc3VhbD12aXN1YWxMaW5lKGxpbmUpO2lmKHZpc3VhbCE9bGluZSl7bGluZU49bGluZU5vKHZpc3VhbCk7fXZhciBvcmRlcj1nZXRPcmRlcih2aXN1YWwpO3ZhciBjaD0hb3JkZXI/MDpvcmRlclswXS5sZXZlbCUyP2xpbmVSaWdodCh2aXN1YWwpOmxpbmVMZWZ0KHZpc3VhbCk7cmV0dXJuIFBvcyhsaW5lTixjaCk7fWZ1bmN0aW9uIGxpbmVFbmQoY20sbGluZU4pe3ZhciBtZXJnZWQsbGluZT1nZXRMaW5lKGNtLmRvYyxsaW5lTik7d2hpbGUobWVyZ2VkPWNvbGxhcHNlZFNwYW5BdEVuZChsaW5lKSl7bGluZT1tZXJnZWQuZmluZCgxLHRydWUpLmxpbmU7bGluZU49bnVsbDt9dmFyIG9yZGVyPWdldE9yZGVyKGxpbmUpO3ZhciBjaD0hb3JkZXI/bGluZS50ZXh0Lmxlbmd0aDpvcmRlclswXS5sZXZlbCUyP2xpbmVMZWZ0KGxpbmUpOmxpbmVSaWdodChsaW5lKTtyZXR1cm4gUG9zKGxpbmVOPT1udWxsP2xpbmVObyhsaW5lKTpsaW5lTixjaCk7fWZ1bmN0aW9uIGxpbmVTdGFydFNtYXJ0KGNtLHBvcyl7dmFyIHN0YXJ0PWxpbmVTdGFydChjbSxwb3MubGluZSk7dmFyIGxpbmU9Z2V0TGluZShjbS5kb2Msc3RhcnQubGluZSk7dmFyIG9yZGVyPWdldE9yZGVyKGxpbmUpO2lmKCFvcmRlcnx8b3JkZXJbMF0ubGV2ZWw9PTApe3ZhciBmaXJzdE5vbldTPU1hdGgubWF4KDAsbGluZS50ZXh0LnNlYXJjaCgvXFxTLykpO3ZhciBpbldTPXBvcy5saW5lPT1zdGFydC5saW5lJiZwb3MuY2g8PWZpcnN0Tm9uV1MmJnBvcy5jaDtyZXR1cm4gUG9zKHN0YXJ0LmxpbmUsaW5XUz8wOmZpcnN0Tm9uV1MpO31yZXR1cm4gc3RhcnQ7fS8vIFJ1biBhIGhhbmRsZXIgdGhhdCB3YXMgYm91bmQgdG8gYSBrZXkuXG5mdW5jdGlvbiBkb0hhbmRsZUJpbmRpbmcoY20sYm91bmQsZHJvcFNoaWZ0KXtpZih0eXBlb2YgYm91bmQ9PVwic3RyaW5nXCIpe2JvdW5kPWNvbW1hbmRzW2JvdW5kXTtpZighYm91bmQpe3JldHVybiBmYWxzZTt9fS8vIEVuc3VyZSBwcmV2aW91cyBpbnB1dCBoYXMgYmVlbiByZWFkLCBzbyB0aGF0IHRoZSBoYW5kbGVyIHNlZXMgYVxuLy8gY29uc2lzdGVudCB2aWV3IG9mIHRoZSBkb2N1bWVudFxuY20uZGlzcGxheS5pbnB1dC5lbnN1cmVQb2xsZWQoKTt2YXIgcHJldlNoaWZ0PWNtLmRpc3BsYXkuc2hpZnQsZG9uZT1mYWxzZTt0cnl7aWYoY20uaXNSZWFkT25seSgpKXtjbS5zdGF0ZS5zdXBwcmVzc0VkaXRzPXRydWU7fWlmKGRyb3BTaGlmdCl7Y20uZGlzcGxheS5zaGlmdD1mYWxzZTt9ZG9uZT1ib3VuZChjbSkhPVBhc3M7fWZpbmFsbHl7Y20uZGlzcGxheS5zaGlmdD1wcmV2U2hpZnQ7Y20uc3RhdGUuc3VwcHJlc3NFZGl0cz1mYWxzZTt9cmV0dXJuIGRvbmU7fWZ1bmN0aW9uIGxvb2t1cEtleUZvckVkaXRvcihjbSxuYW1lLGhhbmRsZSl7Zm9yKHZhciBpPTA7aTxjbS5zdGF0ZS5rZXlNYXBzLmxlbmd0aDtpKyspe3ZhciByZXN1bHQ9bG9va3VwS2V5KG5hbWUsY20uc3RhdGUua2V5TWFwc1tpXSxoYW5kbGUsY20pO2lmKHJlc3VsdCl7cmV0dXJuIHJlc3VsdDt9fXJldHVybiBjbS5vcHRpb25zLmV4dHJhS2V5cyYmbG9va3VwS2V5KG5hbWUsY20ub3B0aW9ucy5leHRyYUtleXMsaGFuZGxlLGNtKXx8bG9va3VwS2V5KG5hbWUsY20ub3B0aW9ucy5rZXlNYXAsaGFuZGxlLGNtKTt9dmFyIHN0b3BTZXE9bmV3IERlbGF5ZWQoKTtmdW5jdGlvbiBkaXNwYXRjaEtleShjbSxuYW1lLGUsaGFuZGxlKXt2YXIgc2VxPWNtLnN0YXRlLmtleVNlcTtpZihzZXEpe2lmKGlzTW9kaWZpZXJLZXkobmFtZSkpe3JldHVyblwiaGFuZGxlZFwiO31zdG9wU2VxLnNldCg1MCxmdW5jdGlvbigpe2lmKGNtLnN0YXRlLmtleVNlcT09c2VxKXtjbS5zdGF0ZS5rZXlTZXE9bnVsbDtjbS5kaXNwbGF5LmlucHV0LnJlc2V0KCk7fX0pO25hbWU9c2VxK1wiIFwiK25hbWU7fXZhciByZXN1bHQ9bG9va3VwS2V5Rm9yRWRpdG9yKGNtLG5hbWUsaGFuZGxlKTtpZihyZXN1bHQ9PVwibXVsdGlcIil7Y20uc3RhdGUua2V5U2VxPW5hbWU7fWlmKHJlc3VsdD09XCJoYW5kbGVkXCIpe3NpZ25hbExhdGVyKGNtLFwia2V5SGFuZGxlZFwiLGNtLG5hbWUsZSk7fWlmKHJlc3VsdD09XCJoYW5kbGVkXCJ8fHJlc3VsdD09XCJtdWx0aVwiKXtlX3ByZXZlbnREZWZhdWx0KGUpO3Jlc3RhcnRCbGluayhjbSk7fWlmKHNlcSYmIXJlc3VsdCYmL1xcJyQvLnRlc3QobmFtZSkpe2VfcHJldmVudERlZmF1bHQoZSk7cmV0dXJuIHRydWU7fXJldHVybiEhcmVzdWx0O30vLyBIYW5kbGUgYSBrZXkgZnJvbSB0aGUga2V5ZG93biBldmVudC5cbmZ1bmN0aW9uIGhhbmRsZUtleUJpbmRpbmcoY20sZSl7dmFyIG5hbWU9a2V5TmFtZShlLHRydWUpO2lmKCFuYW1lKXtyZXR1cm4gZmFsc2U7fWlmKGUuc2hpZnRLZXkmJiFjbS5zdGF0ZS5rZXlTZXEpey8vIEZpcnN0IHRyeSB0byByZXNvbHZlIGZ1bGwgbmFtZSAoaW5jbHVkaW5nICdTaGlmdC0nKS4gRmFpbGluZ1xuLy8gdGhhdCwgc2VlIGlmIHRoZXJlIGlzIGEgY3Vyc29yLW1vdGlvbiBjb21tYW5kIChzdGFydGluZyB3aXRoXG4vLyAnZ28nKSBib3VuZCB0byB0aGUga2V5bmFtZSB3aXRob3V0ICdTaGlmdC0nLlxucmV0dXJuIGRpc3BhdGNoS2V5KGNtLFwiU2hpZnQtXCIrbmFtZSxlLGZ1bmN0aW9uKGIpe3JldHVybiBkb0hhbmRsZUJpbmRpbmcoY20sYix0cnVlKTt9KXx8ZGlzcGF0Y2hLZXkoY20sbmFtZSxlLGZ1bmN0aW9uKGIpe2lmKHR5cGVvZiBiPT1cInN0cmluZ1wiPy9eZ29bQS1aXS8udGVzdChiKTpiLm1vdGlvbil7cmV0dXJuIGRvSGFuZGxlQmluZGluZyhjbSxiKTt9fSk7fWVsc2V7cmV0dXJuIGRpc3BhdGNoS2V5KGNtLG5hbWUsZSxmdW5jdGlvbihiKXtyZXR1cm4gZG9IYW5kbGVCaW5kaW5nKGNtLGIpO30pO319Ly8gSGFuZGxlIGEga2V5IGZyb20gdGhlIGtleXByZXNzIGV2ZW50XG5mdW5jdGlvbiBoYW5kbGVDaGFyQmluZGluZyhjbSxlLGNoKXtyZXR1cm4gZGlzcGF0Y2hLZXkoY20sXCInXCIrY2grXCInXCIsZSxmdW5jdGlvbihiKXtyZXR1cm4gZG9IYW5kbGVCaW5kaW5nKGNtLGIsdHJ1ZSk7fSk7fXZhciBsYXN0U3RvcHBlZEtleT1udWxsO2Z1bmN0aW9uIG9uS2V5RG93bihlKXt2YXIgY209dGhpcztjbS5jdXJPcC5mb2N1cz1hY3RpdmVFbHQoKTtpZihzaWduYWxET01FdmVudChjbSxlKSl7cmV0dXJuO30vLyBJRSBkb2VzIHN0cmFuZ2UgdGhpbmdzIHdpdGggZXNjYXBlLlxuaWYoaWUmJmllX3ZlcnNpb248MTEmJmUua2V5Q29kZT09Mjcpe2UucmV0dXJuVmFsdWU9ZmFsc2U7fXZhciBjb2RlPWUua2V5Q29kZTtjbS5kaXNwbGF5LnNoaWZ0PWNvZGU9PTE2fHxlLnNoaWZ0S2V5O3ZhciBoYW5kbGVkPWhhbmRsZUtleUJpbmRpbmcoY20sZSk7aWYocHJlc3RvKXtsYXN0U3RvcHBlZEtleT1oYW5kbGVkP2NvZGU6bnVsbDsvLyBPcGVyYSBoYXMgbm8gY3V0IGV2ZW50Li4uIHdlIHRyeSB0byBhdCBsZWFzdCBjYXRjaCB0aGUga2V5IGNvbWJvXG5pZighaGFuZGxlZCYmY29kZT09ODgmJiFoYXNDb3B5RXZlbnQmJihtYWM/ZS5tZXRhS2V5OmUuY3RybEtleSkpe2NtLnJlcGxhY2VTZWxlY3Rpb24oXCJcIixudWxsLFwiY3V0XCIpO319Ly8gVHVybiBtb3VzZSBpbnRvIGNyb3NzaGFpciB3aGVuIEFsdCBpcyBoZWxkIG9uIE1hYy5cbmlmKGNvZGU9PTE4JiYhL1xcYkNvZGVNaXJyb3ItY3Jvc3NoYWlyXFxiLy50ZXN0KGNtLmRpc3BsYXkubGluZURpdi5jbGFzc05hbWUpKXtzaG93Q3Jvc3NIYWlyKGNtKTt9fWZ1bmN0aW9uIHNob3dDcm9zc0hhaXIoY20pe3ZhciBsaW5lRGl2PWNtLmRpc3BsYXkubGluZURpdjthZGRDbGFzcyhsaW5lRGl2LFwiQ29kZU1pcnJvci1jcm9zc2hhaXJcIik7ZnVuY3Rpb24gdXAoZSl7aWYoZS5rZXlDb2RlPT0xOHx8IWUuYWx0S2V5KXtybUNsYXNzKGxpbmVEaXYsXCJDb2RlTWlycm9yLWNyb3NzaGFpclwiKTtvZmYoZG9jdW1lbnQsXCJrZXl1cFwiLHVwKTtvZmYoZG9jdW1lbnQsXCJtb3VzZW92ZXJcIix1cCk7fX1vbihkb2N1bWVudCxcImtleXVwXCIsdXApO29uKGRvY3VtZW50LFwibW91c2VvdmVyXCIsdXApO31mdW5jdGlvbiBvbktleVVwKGUpe2lmKGUua2V5Q29kZT09MTYpe3RoaXMuZG9jLnNlbC5zaGlmdD1mYWxzZTt9c2lnbmFsRE9NRXZlbnQodGhpcyxlKTt9ZnVuY3Rpb24gb25LZXlQcmVzcyhlKXt2YXIgY209dGhpcztpZihldmVudEluV2lkZ2V0KGNtLmRpc3BsYXksZSl8fHNpZ25hbERPTUV2ZW50KGNtLGUpfHxlLmN0cmxLZXkmJiFlLmFsdEtleXx8bWFjJiZlLm1ldGFLZXkpe3JldHVybjt9dmFyIGtleUNvZGU9ZS5rZXlDb2RlLGNoYXJDb2RlPWUuY2hhckNvZGU7aWYocHJlc3RvJiZrZXlDb2RlPT1sYXN0U3RvcHBlZEtleSl7bGFzdFN0b3BwZWRLZXk9bnVsbDtlX3ByZXZlbnREZWZhdWx0KGUpO3JldHVybjt9aWYocHJlc3RvJiYoIWUud2hpY2h8fGUud2hpY2g8MTApJiZoYW5kbGVLZXlCaW5kaW5nKGNtLGUpKXtyZXR1cm47fXZhciBjaD1TdHJpbmcuZnJvbUNoYXJDb2RlKGNoYXJDb2RlPT1udWxsP2tleUNvZGU6Y2hhckNvZGUpOy8vIFNvbWUgYnJvd3NlcnMgZmlyZSBrZXlwcmVzcyBldmVudHMgZm9yIGJhY2tzcGFjZVxuaWYoY2g9PVwiXFx4MDhcIil7cmV0dXJuO31pZihoYW5kbGVDaGFyQmluZGluZyhjbSxlLGNoKSl7cmV0dXJuO31jbS5kaXNwbGF5LmlucHV0Lm9uS2V5UHJlc3MoZSk7fS8vIEEgbW91c2UgZG93biBjYW4gYmUgYSBzaW5nbGUgY2xpY2ssIGRvdWJsZSBjbGljaywgdHJpcGxlIGNsaWNrLFxuLy8gc3RhcnQgb2Ygc2VsZWN0aW9uIGRyYWcsIHN0YXJ0IG9mIHRleHQgZHJhZywgbmV3IGN1cnNvclxuLy8gKGN0cmwtY2xpY2spLCByZWN0YW5nbGUgZHJhZyAoYWx0LWRyYWcpLCBvciB4d2luXG4vLyBtaWRkbGUtY2xpY2stcGFzdGUuIE9yIGl0IG1pZ2h0IGJlIGEgY2xpY2sgb24gc29tZXRoaW5nIHdlIHNob3VsZFxuLy8gbm90IGludGVyZmVyZSB3aXRoLCBzdWNoIGFzIGEgc2Nyb2xsYmFyIG9yIHdpZGdldC5cbmZ1bmN0aW9uIG9uTW91c2VEb3duKGUpe3ZhciBjbT10aGlzLGRpc3BsYXk9Y20uZGlzcGxheTtpZihzaWduYWxET01FdmVudChjbSxlKXx8ZGlzcGxheS5hY3RpdmVUb3VjaCYmZGlzcGxheS5pbnB1dC5zdXBwb3J0c1RvdWNoKCkpe3JldHVybjt9ZGlzcGxheS5zaGlmdD1lLnNoaWZ0S2V5O2lmKGV2ZW50SW5XaWRnZXQoZGlzcGxheSxlKSl7aWYoIXdlYmtpdCl7Ly8gQnJpZWZseSB0dXJuIG9mZiBkcmFnZ2FiaWxpdHksIHRvIGFsbG93IHdpZGdldHMgdG8gZG9cbi8vIG5vcm1hbCBkcmFnZ2luZyB0aGluZ3MuXG5kaXNwbGF5LnNjcm9sbGVyLmRyYWdnYWJsZT1mYWxzZTtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7cmV0dXJuIGRpc3BsYXkuc2Nyb2xsZXIuZHJhZ2dhYmxlPXRydWU7fSwxMDApO31yZXR1cm47fWlmKGNsaWNrSW5HdXR0ZXIoY20sZSkpe3JldHVybjt9dmFyIHN0YXJ0PXBvc0Zyb21Nb3VzZShjbSxlKTt3aW5kb3cuZm9jdXMoKTtzd2l0Y2goZV9idXR0b24oZSkpe2Nhc2UgMTovLyAjMzI2MTogbWFrZSBzdXJlLCB0aGF0IHdlJ3JlIG5vdCBzdGFydGluZyBhIHNlY29uZCBzZWxlY3Rpb25cbmlmKGNtLnN0YXRlLnNlbGVjdGluZ1RleHQpe2NtLnN0YXRlLnNlbGVjdGluZ1RleHQoZSk7fWVsc2UgaWYoc3RhcnQpe2xlZnRCdXR0b25Eb3duKGNtLGUsc3RhcnQpO31lbHNlIGlmKGVfdGFyZ2V0KGUpPT1kaXNwbGF5LnNjcm9sbGVyKXtlX3ByZXZlbnREZWZhdWx0KGUpO31icmVhaztjYXNlIDI6aWYod2Via2l0KXtjbS5zdGF0ZS5sYXN0TWlkZGxlRG93bj0rbmV3IERhdGUoKTt9aWYoc3RhcnQpe2V4dGVuZFNlbGVjdGlvbihjbS5kb2Msc3RhcnQpO31zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7cmV0dXJuIGRpc3BsYXkuaW5wdXQuZm9jdXMoKTt9LDIwKTtlX3ByZXZlbnREZWZhdWx0KGUpO2JyZWFrO2Nhc2UgMzppZihjYXB0dXJlUmlnaHRDbGljayl7b25Db250ZXh0TWVudShjbSxlKTt9ZWxzZXtkZWxheUJsdXJFdmVudChjbSk7fWJyZWFrO319dmFyIGxhc3RDbGljazt2YXIgbGFzdERvdWJsZUNsaWNrO2Z1bmN0aW9uIGxlZnRCdXR0b25Eb3duKGNtLGUsc3RhcnQpe2lmKGllKXtzZXRUaW1lb3V0KGJpbmQoZW5zdXJlRm9jdXMsY20pLDApO31lbHNle2NtLmN1ck9wLmZvY3VzPWFjdGl2ZUVsdCgpO312YXIgbm93PStuZXcgRGF0ZSgpLHR5cGU7aWYobGFzdERvdWJsZUNsaWNrJiZsYXN0RG91YmxlQ2xpY2sudGltZT5ub3ctNDAwJiZjbXAobGFzdERvdWJsZUNsaWNrLnBvcyxzdGFydCk9PTApe3R5cGU9XCJ0cmlwbGVcIjt9ZWxzZSBpZihsYXN0Q2xpY2smJmxhc3RDbGljay50aW1lPm5vdy00MDAmJmNtcChsYXN0Q2xpY2sucG9zLHN0YXJ0KT09MCl7dHlwZT1cImRvdWJsZVwiO2xhc3REb3VibGVDbGljaz17dGltZTpub3cscG9zOnN0YXJ0fTt9ZWxzZXt0eXBlPVwic2luZ2xlXCI7bGFzdENsaWNrPXt0aW1lOm5vdyxwb3M6c3RhcnR9O312YXIgc2VsPWNtLmRvYy5zZWwsbW9kaWZpZXI9bWFjP2UubWV0YUtleTplLmN0cmxLZXksY29udGFpbmVkO2lmKGNtLm9wdGlvbnMuZHJhZ0Ryb3AmJmRyYWdBbmREcm9wJiYhY20uaXNSZWFkT25seSgpJiZ0eXBlPT1cInNpbmdsZVwiJiYoY29udGFpbmVkPXNlbC5jb250YWlucyhzdGFydCkpPi0xJiYoY21wKChjb250YWluZWQ9c2VsLnJhbmdlc1tjb250YWluZWRdKS5mcm9tKCksc3RhcnQpPDB8fHN0YXJ0LnhSZWw+MCkmJihjbXAoY29udGFpbmVkLnRvKCksc3RhcnQpPjB8fHN0YXJ0LnhSZWw8MCkpe2xlZnRCdXR0b25TdGFydERyYWcoY20sZSxzdGFydCxtb2RpZmllcik7fWVsc2V7bGVmdEJ1dHRvblNlbGVjdChjbSxlLHN0YXJ0LHR5cGUsbW9kaWZpZXIpO319Ly8gU3RhcnQgYSB0ZXh0IGRyYWcuIFdoZW4gaXQgZW5kcywgc2VlIGlmIGFueSBkcmFnZ2luZyBhY3R1YWxseVxuLy8gaGFwcGVuLCBhbmQgdHJlYXQgYXMgYSBjbGljayBpZiBpdCBkaWRuJ3QuXG5mdW5jdGlvbiBsZWZ0QnV0dG9uU3RhcnREcmFnKGNtLGUsc3RhcnQsbW9kaWZpZXIpe3ZhciBkaXNwbGF5PWNtLmRpc3BsYXksc3RhcnRUaW1lPStuZXcgRGF0ZSgpO3ZhciBkcmFnRW5kPW9wZXJhdGlvbihjbSxmdW5jdGlvbihlMil7aWYod2Via2l0KXtkaXNwbGF5LnNjcm9sbGVyLmRyYWdnYWJsZT1mYWxzZTt9Y20uc3RhdGUuZHJhZ2dpbmdUZXh0PWZhbHNlO29mZihkb2N1bWVudCxcIm1vdXNldXBcIixkcmFnRW5kKTtvZmYoZGlzcGxheS5zY3JvbGxlcixcImRyb3BcIixkcmFnRW5kKTtpZihNYXRoLmFicyhlLmNsaWVudFgtZTIuY2xpZW50WCkrTWF0aC5hYnMoZS5jbGllbnRZLWUyLmNsaWVudFkpPDEwKXtlX3ByZXZlbnREZWZhdWx0KGUyKTtpZighbW9kaWZpZXImJituZXcgRGF0ZSgpLTIwMDxzdGFydFRpbWUpe2V4dGVuZFNlbGVjdGlvbihjbS5kb2Msc3RhcnQpO30vLyBXb3JrIGFyb3VuZCB1bmV4cGxhaW5hYmxlIGZvY3VzIHByb2JsZW0gaW4gSUU5ICgjMjEyNykgYW5kIENocm9tZSAoIzMwODEpXG5pZih3ZWJraXR8fGllJiZpZV92ZXJzaW9uPT05KXtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ZG9jdW1lbnQuYm9keS5mb2N1cygpO2Rpc3BsYXkuaW5wdXQuZm9jdXMoKTt9LDIwKTt9ZWxzZXtkaXNwbGF5LmlucHV0LmZvY3VzKCk7fX19KTsvLyBMZXQgdGhlIGRyYWcgaGFuZGxlciBoYW5kbGUgdGhpcy5cbmlmKHdlYmtpdCl7ZGlzcGxheS5zY3JvbGxlci5kcmFnZ2FibGU9dHJ1ZTt9Y20uc3RhdGUuZHJhZ2dpbmdUZXh0PWRyYWdFbmQ7ZHJhZ0VuZC5jb3B5PW1hYz9lLmFsdEtleTplLmN0cmxLZXk7Ly8gSUUncyBhcHByb2FjaCB0byBkcmFnZ2FibGVcbmlmKGRpc3BsYXkuc2Nyb2xsZXIuZHJhZ0Ryb3Ape2Rpc3BsYXkuc2Nyb2xsZXIuZHJhZ0Ryb3AoKTt9b24oZG9jdW1lbnQsXCJtb3VzZXVwXCIsZHJhZ0VuZCk7b24oZGlzcGxheS5zY3JvbGxlcixcImRyb3BcIixkcmFnRW5kKTt9Ly8gTm9ybWFsIHNlbGVjdGlvbiwgYXMgb3Bwb3NlZCB0byB0ZXh0IGRyYWdnaW5nLlxuZnVuY3Rpb24gbGVmdEJ1dHRvblNlbGVjdChjbSxlLHN0YXJ0LHR5cGUsYWRkTmV3KXt2YXIgZGlzcGxheT1jbS5kaXNwbGF5LGRvYz1jbS5kb2M7ZV9wcmV2ZW50RGVmYXVsdChlKTt2YXIgb3VyUmFuZ2Usb3VySW5kZXgsc3RhcnRTZWw9ZG9jLnNlbCxyYW5nZXM9c3RhcnRTZWwucmFuZ2VzO2lmKGFkZE5ldyYmIWUuc2hpZnRLZXkpe291ckluZGV4PWRvYy5zZWwuY29udGFpbnMoc3RhcnQpO2lmKG91ckluZGV4Pi0xKXtvdXJSYW5nZT1yYW5nZXNbb3VySW5kZXhdO31lbHNle291clJhbmdlPW5ldyBSYW5nZShzdGFydCxzdGFydCk7fX1lbHNle291clJhbmdlPWRvYy5zZWwucHJpbWFyeSgpO291ckluZGV4PWRvYy5zZWwucHJpbUluZGV4O31pZihjaHJvbWVPUz9lLnNoaWZ0S2V5JiZlLm1ldGFLZXk6ZS5hbHRLZXkpe3R5cGU9XCJyZWN0XCI7aWYoIWFkZE5ldyl7b3VyUmFuZ2U9bmV3IFJhbmdlKHN0YXJ0LHN0YXJ0KTt9c3RhcnQ9cG9zRnJvbU1vdXNlKGNtLGUsdHJ1ZSx0cnVlKTtvdXJJbmRleD0tMTt9ZWxzZSBpZih0eXBlPT1cImRvdWJsZVwiKXt2YXIgd29yZD1jbS5maW5kV29yZEF0KHN0YXJ0KTtpZihjbS5kaXNwbGF5LnNoaWZ0fHxkb2MuZXh0ZW5kKXtvdXJSYW5nZT1leHRlbmRSYW5nZShkb2Msb3VyUmFuZ2Usd29yZC5hbmNob3Isd29yZC5oZWFkKTt9ZWxzZXtvdXJSYW5nZT13b3JkO319ZWxzZSBpZih0eXBlPT1cInRyaXBsZVwiKXt2YXIgbGluZT1uZXcgUmFuZ2UoUG9zKHN0YXJ0LmxpbmUsMCksY2xpcFBvcyhkb2MsUG9zKHN0YXJ0LmxpbmUrMSwwKSkpO2lmKGNtLmRpc3BsYXkuc2hpZnR8fGRvYy5leHRlbmQpe291clJhbmdlPWV4dGVuZFJhbmdlKGRvYyxvdXJSYW5nZSxsaW5lLmFuY2hvcixsaW5lLmhlYWQpO31lbHNle291clJhbmdlPWxpbmU7fX1lbHNle291clJhbmdlPWV4dGVuZFJhbmdlKGRvYyxvdXJSYW5nZSxzdGFydCk7fWlmKCFhZGROZXcpe291ckluZGV4PTA7c2V0U2VsZWN0aW9uKGRvYyxuZXcgU2VsZWN0aW9uKFtvdXJSYW5nZV0sMCksc2VsX21vdXNlKTtzdGFydFNlbD1kb2Muc2VsO31lbHNlIGlmKG91ckluZGV4PT0tMSl7b3VySW5kZXg9cmFuZ2VzLmxlbmd0aDtzZXRTZWxlY3Rpb24oZG9jLG5vcm1hbGl6ZVNlbGVjdGlvbihyYW5nZXMuY29uY2F0KFtvdXJSYW5nZV0pLG91ckluZGV4KSx7c2Nyb2xsOmZhbHNlLG9yaWdpbjpcIiptb3VzZVwifSk7fWVsc2UgaWYocmFuZ2VzLmxlbmd0aD4xJiZyYW5nZXNbb3VySW5kZXhdLmVtcHR5KCkmJnR5cGU9PVwic2luZ2xlXCImJiFlLnNoaWZ0S2V5KXtzZXRTZWxlY3Rpb24oZG9jLG5vcm1hbGl6ZVNlbGVjdGlvbihyYW5nZXMuc2xpY2UoMCxvdXJJbmRleCkuY29uY2F0KHJhbmdlcy5zbGljZShvdXJJbmRleCsxKSksMCkse3Njcm9sbDpmYWxzZSxvcmlnaW46XCIqbW91c2VcIn0pO3N0YXJ0U2VsPWRvYy5zZWw7fWVsc2V7cmVwbGFjZU9uZVNlbGVjdGlvbihkb2Msb3VySW5kZXgsb3VyUmFuZ2Usc2VsX21vdXNlKTt9dmFyIGxhc3RQb3M9c3RhcnQ7ZnVuY3Rpb24gZXh0ZW5kVG8ocG9zKXtpZihjbXAobGFzdFBvcyxwb3MpPT0wKXtyZXR1cm47fWxhc3RQb3M9cG9zO2lmKHR5cGU9PVwicmVjdFwiKXt2YXIgcmFuZ2VzPVtdLHRhYlNpemU9Y20ub3B0aW9ucy50YWJTaXplO3ZhciBzdGFydENvbD1jb3VudENvbHVtbihnZXRMaW5lKGRvYyxzdGFydC5saW5lKS50ZXh0LHN0YXJ0LmNoLHRhYlNpemUpO3ZhciBwb3NDb2w9Y291bnRDb2x1bW4oZ2V0TGluZShkb2MscG9zLmxpbmUpLnRleHQscG9zLmNoLHRhYlNpemUpO3ZhciBsZWZ0PU1hdGgubWluKHN0YXJ0Q29sLHBvc0NvbCkscmlnaHQ9TWF0aC5tYXgoc3RhcnRDb2wscG9zQ29sKTtmb3IodmFyIGxpbmU9TWF0aC5taW4oc3RhcnQubGluZSxwb3MubGluZSksZW5kPU1hdGgubWluKGNtLmxhc3RMaW5lKCksTWF0aC5tYXgoc3RhcnQubGluZSxwb3MubGluZSkpO2xpbmU8PWVuZDtsaW5lKyspe3ZhciB0ZXh0PWdldExpbmUoZG9jLGxpbmUpLnRleHQsbGVmdFBvcz1maW5kQ29sdW1uKHRleHQsbGVmdCx0YWJTaXplKTtpZihsZWZ0PT1yaWdodCl7cmFuZ2VzLnB1c2gobmV3IFJhbmdlKFBvcyhsaW5lLGxlZnRQb3MpLFBvcyhsaW5lLGxlZnRQb3MpKSk7fWVsc2UgaWYodGV4dC5sZW5ndGg+bGVmdFBvcyl7cmFuZ2VzLnB1c2gobmV3IFJhbmdlKFBvcyhsaW5lLGxlZnRQb3MpLFBvcyhsaW5lLGZpbmRDb2x1bW4odGV4dCxyaWdodCx0YWJTaXplKSkpKTt9fWlmKCFyYW5nZXMubGVuZ3RoKXtyYW5nZXMucHVzaChuZXcgUmFuZ2Uoc3RhcnQsc3RhcnQpKTt9c2V0U2VsZWN0aW9uKGRvYyxub3JtYWxpemVTZWxlY3Rpb24oc3RhcnRTZWwucmFuZ2VzLnNsaWNlKDAsb3VySW5kZXgpLmNvbmNhdChyYW5nZXMpLG91ckluZGV4KSx7b3JpZ2luOlwiKm1vdXNlXCIsc2Nyb2xsOmZhbHNlfSk7Y20uc2Nyb2xsSW50b1ZpZXcocG9zKTt9ZWxzZXt2YXIgb2xkUmFuZ2U9b3VyUmFuZ2U7dmFyIGFuY2hvcj1vbGRSYW5nZS5hbmNob3IsaGVhZD1wb3M7aWYodHlwZSE9XCJzaW5nbGVcIil7dmFyIHJhbmdlO2lmKHR5cGU9PVwiZG91YmxlXCIpe3JhbmdlPWNtLmZpbmRXb3JkQXQocG9zKTt9ZWxzZXtyYW5nZT1uZXcgUmFuZ2UoUG9zKHBvcy5saW5lLDApLGNsaXBQb3MoZG9jLFBvcyhwb3MubGluZSsxLDApKSk7fWlmKGNtcChyYW5nZS5hbmNob3IsYW5jaG9yKT4wKXtoZWFkPXJhbmdlLmhlYWQ7YW5jaG9yPW1pblBvcyhvbGRSYW5nZS5mcm9tKCkscmFuZ2UuYW5jaG9yKTt9ZWxzZXtoZWFkPXJhbmdlLmFuY2hvcjthbmNob3I9bWF4UG9zKG9sZFJhbmdlLnRvKCkscmFuZ2UuaGVhZCk7fX12YXIgcmFuZ2VzJDE9c3RhcnRTZWwucmFuZ2VzLnNsaWNlKDApO3JhbmdlcyQxW291ckluZGV4XT1uZXcgUmFuZ2UoY2xpcFBvcyhkb2MsYW5jaG9yKSxoZWFkKTtzZXRTZWxlY3Rpb24oZG9jLG5vcm1hbGl6ZVNlbGVjdGlvbihyYW5nZXMkMSxvdXJJbmRleCksc2VsX21vdXNlKTt9fXZhciBlZGl0b3JTaXplPWRpc3BsYXkud3JhcHBlci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsvLyBVc2VkIHRvIGVuc3VyZSB0aW1lb3V0IHJlLXRyaWVzIGRvbid0IGZpcmUgd2hlbiBhbm90aGVyIGV4dGVuZFxuLy8gaGFwcGVuZWQgaW4gdGhlIG1lYW50aW1lIChjbGVhclRpbWVvdXQgaXNuJ3QgcmVsaWFibGUgLS0gYXRcbi8vIGxlYXN0IG9uIENocm9tZSwgdGhlIHRpbWVvdXRzIHN0aWxsIGhhcHBlbiBldmVuIHdoZW4gY2xlYXJlZCxcbi8vIGlmIHRoZSBjbGVhciBoYXBwZW5zIGFmdGVyIHRoZWlyIHNjaGVkdWxlZCBmaXJpbmcgdGltZSkuXG52YXIgY291bnRlcj0wO2Z1bmN0aW9uIGV4dGVuZChlKXt2YXIgY3VyQ291bnQ9Kytjb3VudGVyO3ZhciBjdXI9cG9zRnJvbU1vdXNlKGNtLGUsdHJ1ZSx0eXBlPT1cInJlY3RcIik7aWYoIWN1cil7cmV0dXJuO31pZihjbXAoY3VyLGxhc3RQb3MpIT0wKXtjbS5jdXJPcC5mb2N1cz1hY3RpdmVFbHQoKTtleHRlbmRUbyhjdXIpO3ZhciB2aXNpYmxlPXZpc2libGVMaW5lcyhkaXNwbGF5LGRvYyk7aWYoY3VyLmxpbmU+PXZpc2libGUudG98fGN1ci5saW5lPHZpc2libGUuZnJvbSl7c2V0VGltZW91dChvcGVyYXRpb24oY20sZnVuY3Rpb24oKXtpZihjb3VudGVyPT1jdXJDb3VudCl7ZXh0ZW5kKGUpO319KSwxNTApO319ZWxzZXt2YXIgb3V0c2lkZT1lLmNsaWVudFk8ZWRpdG9yU2l6ZS50b3A/LTIwOmUuY2xpZW50WT5lZGl0b3JTaXplLmJvdHRvbT8yMDowO2lmKG91dHNpZGUpe3NldFRpbWVvdXQob3BlcmF0aW9uKGNtLGZ1bmN0aW9uKCl7aWYoY291bnRlciE9Y3VyQ291bnQpe3JldHVybjt9ZGlzcGxheS5zY3JvbGxlci5zY3JvbGxUb3ArPW91dHNpZGU7ZXh0ZW5kKGUpO30pLDUwKTt9fX1mdW5jdGlvbiBkb25lKGUpe2NtLnN0YXRlLnNlbGVjdGluZ1RleHQ9ZmFsc2U7Y291bnRlcj1JbmZpbml0eTtlX3ByZXZlbnREZWZhdWx0KGUpO2Rpc3BsYXkuaW5wdXQuZm9jdXMoKTtvZmYoZG9jdW1lbnQsXCJtb3VzZW1vdmVcIixtb3ZlKTtvZmYoZG9jdW1lbnQsXCJtb3VzZXVwXCIsdXApO2RvYy5oaXN0b3J5Lmxhc3RTZWxPcmlnaW49bnVsbDt9dmFyIG1vdmU9b3BlcmF0aW9uKGNtLGZ1bmN0aW9uKGUpe2lmKCFlX2J1dHRvbihlKSl7ZG9uZShlKTt9ZWxzZXtleHRlbmQoZSk7fX0pO3ZhciB1cD1vcGVyYXRpb24oY20sZG9uZSk7Y20uc3RhdGUuc2VsZWN0aW5nVGV4dD11cDtvbihkb2N1bWVudCxcIm1vdXNlbW92ZVwiLG1vdmUpO29uKGRvY3VtZW50LFwibW91c2V1cFwiLHVwKTt9Ly8gRGV0ZXJtaW5lcyB3aGV0aGVyIGFuIGV2ZW50IGhhcHBlbmVkIGluIHRoZSBndXR0ZXIsIGFuZCBmaXJlcyB0aGVcbi8vIGhhbmRsZXJzIGZvciB0aGUgY29ycmVzcG9uZGluZyBldmVudC5cbmZ1bmN0aW9uIGd1dHRlckV2ZW50KGNtLGUsdHlwZSxwcmV2ZW50KXt2YXIgbVgsbVk7dHJ5e21YPWUuY2xpZW50WDttWT1lLmNsaWVudFk7fWNhdGNoKGUpe3JldHVybiBmYWxzZTt9aWYobVg+PU1hdGguZmxvb3IoY20uZGlzcGxheS5ndXR0ZXJzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnJpZ2h0KSl7cmV0dXJuIGZhbHNlO31pZihwcmV2ZW50KXtlX3ByZXZlbnREZWZhdWx0KGUpO312YXIgZGlzcGxheT1jbS5kaXNwbGF5O3ZhciBsaW5lQm94PWRpc3BsYXkubGluZURpdi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtpZihtWT5saW5lQm94LmJvdHRvbXx8IWhhc0hhbmRsZXIoY20sdHlwZSkpe3JldHVybiBlX2RlZmF1bHRQcmV2ZW50ZWQoZSk7fW1ZLT1saW5lQm94LnRvcC1kaXNwbGF5LnZpZXdPZmZzZXQ7Zm9yKHZhciBpPTA7aTxjbS5vcHRpb25zLmd1dHRlcnMubGVuZ3RoOysraSl7dmFyIGc9ZGlzcGxheS5ndXR0ZXJzLmNoaWxkTm9kZXNbaV07aWYoZyYmZy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5yaWdodD49bVgpe3ZhciBsaW5lPWxpbmVBdEhlaWdodChjbS5kb2MsbVkpO3ZhciBndXR0ZXI9Y20ub3B0aW9ucy5ndXR0ZXJzW2ldO3NpZ25hbChjbSx0eXBlLGNtLGxpbmUsZ3V0dGVyLGUpO3JldHVybiBlX2RlZmF1bHRQcmV2ZW50ZWQoZSk7fX19ZnVuY3Rpb24gY2xpY2tJbkd1dHRlcihjbSxlKXtyZXR1cm4gZ3V0dGVyRXZlbnQoY20sZSxcImd1dHRlckNsaWNrXCIsdHJ1ZSk7fS8vIENPTlRFWFQgTUVOVSBIQU5ETElOR1xuLy8gVG8gbWFrZSB0aGUgY29udGV4dCBtZW51IHdvcmssIHdlIG5lZWQgdG8gYnJpZWZseSB1bmhpZGUgdGhlXG4vLyB0ZXh0YXJlYSAobWFraW5nIGl0IGFzIHVub2J0cnVzaXZlIGFzIHBvc3NpYmxlKSB0byBsZXQgdGhlXG4vLyByaWdodC1jbGljayB0YWtlIGVmZmVjdCBvbiBpdC5cbmZ1bmN0aW9uIG9uQ29udGV4dE1lbnUoY20sZSl7aWYoZXZlbnRJbldpZGdldChjbS5kaXNwbGF5LGUpfHxjb250ZXh0TWVudUluR3V0dGVyKGNtLGUpKXtyZXR1cm47fWlmKHNpZ25hbERPTUV2ZW50KGNtLGUsXCJjb250ZXh0bWVudVwiKSl7cmV0dXJuO31jbS5kaXNwbGF5LmlucHV0Lm9uQ29udGV4dE1lbnUoZSk7fWZ1bmN0aW9uIGNvbnRleHRNZW51SW5HdXR0ZXIoY20sZSl7aWYoIWhhc0hhbmRsZXIoY20sXCJndXR0ZXJDb250ZXh0TWVudVwiKSl7cmV0dXJuIGZhbHNlO31yZXR1cm4gZ3V0dGVyRXZlbnQoY20sZSxcImd1dHRlckNvbnRleHRNZW51XCIsZmFsc2UpO31mdW5jdGlvbiB0aGVtZUNoYW5nZWQoY20pe2NtLmRpc3BsYXkud3JhcHBlci5jbGFzc05hbWU9Y20uZGlzcGxheS53cmFwcGVyLmNsYXNzTmFtZS5yZXBsYWNlKC9cXHMqY20tcy1cXFMrL2csXCJcIikrY20ub3B0aW9ucy50aGVtZS5yZXBsYWNlKC8oXnxcXHMpXFxzKi9nLFwiIGNtLXMtXCIpO2NsZWFyQ2FjaGVzKGNtKTt9dmFyIEluaXQ9e3RvU3RyaW5nOmZ1bmN0aW9uKCl7cmV0dXJuXCJDb2RlTWlycm9yLkluaXRcIjt9fTt2YXIgZGVmYXVsdHM9e307dmFyIG9wdGlvbkhhbmRsZXJzPXt9O2Z1bmN0aW9uIGRlZmluZU9wdGlvbnMoQ29kZU1pcnJvcil7dmFyIG9wdGlvbkhhbmRsZXJzPUNvZGVNaXJyb3Iub3B0aW9uSGFuZGxlcnM7ZnVuY3Rpb24gb3B0aW9uKG5hbWUsZGVmbHQsaGFuZGxlLG5vdE9uSW5pdCl7Q29kZU1pcnJvci5kZWZhdWx0c1tuYW1lXT1kZWZsdDtpZihoYW5kbGUpe29wdGlvbkhhbmRsZXJzW25hbWVdPW5vdE9uSW5pdD9mdW5jdGlvbihjbSx2YWwsb2xkKXtpZihvbGQhPUluaXQpe2hhbmRsZShjbSx2YWwsb2xkKTt9fTpoYW5kbGU7fX1Db2RlTWlycm9yLmRlZmluZU9wdGlvbj1vcHRpb247Ly8gUGFzc2VkIHRvIG9wdGlvbiBoYW5kbGVycyB3aGVuIHRoZXJlIGlzIG5vIG9sZCB2YWx1ZS5cbkNvZGVNaXJyb3IuSW5pdD1Jbml0Oy8vIFRoZXNlIHR3byBhcmUsIG9uIGluaXQsIGNhbGxlZCBmcm9tIHRoZSBjb25zdHJ1Y3RvciBiZWNhdXNlIHRoZXlcbi8vIGhhdmUgdG8gYmUgaW5pdGlhbGl6ZWQgYmVmb3JlIHRoZSBlZGl0b3IgY2FuIHN0YXJ0IGF0IGFsbC5cbm9wdGlvbihcInZhbHVlXCIsXCJcIixmdW5jdGlvbihjbSx2YWwpe3JldHVybiBjbS5zZXRWYWx1ZSh2YWwpO30sdHJ1ZSk7b3B0aW9uKFwibW9kZVwiLG51bGwsZnVuY3Rpb24oY20sdmFsKXtjbS5kb2MubW9kZU9wdGlvbj12YWw7bG9hZE1vZGUoY20pO30sdHJ1ZSk7b3B0aW9uKFwiaW5kZW50VW5pdFwiLDIsbG9hZE1vZGUsdHJ1ZSk7b3B0aW9uKFwiaW5kZW50V2l0aFRhYnNcIixmYWxzZSk7b3B0aW9uKFwic21hcnRJbmRlbnRcIix0cnVlKTtvcHRpb24oXCJ0YWJTaXplXCIsNCxmdW5jdGlvbihjbSl7cmVzZXRNb2RlU3RhdGUoY20pO2NsZWFyQ2FjaGVzKGNtKTtyZWdDaGFuZ2UoY20pO30sdHJ1ZSk7b3B0aW9uKFwibGluZVNlcGFyYXRvclwiLG51bGwsZnVuY3Rpb24oY20sdmFsKXtjbS5kb2MubGluZVNlcD12YWw7aWYoIXZhbCl7cmV0dXJuO312YXIgbmV3QnJlYWtzPVtdLGxpbmVObz1jbS5kb2MuZmlyc3Q7Y20uZG9jLml0ZXIoZnVuY3Rpb24obGluZSl7Zm9yKHZhciBwb3M9MDs7KXt2YXIgZm91bmQ9bGluZS50ZXh0LmluZGV4T2YodmFsLHBvcyk7aWYoZm91bmQ9PS0xKXticmVhazt9cG9zPWZvdW5kK3ZhbC5sZW5ndGg7bmV3QnJlYWtzLnB1c2goUG9zKGxpbmVObyxmb3VuZCkpO31saW5lTm8rKzt9KTtmb3IodmFyIGk9bmV3QnJlYWtzLmxlbmd0aC0xO2k+PTA7aS0tKXtyZXBsYWNlUmFuZ2UoY20uZG9jLHZhbCxuZXdCcmVha3NbaV0sUG9zKG5ld0JyZWFrc1tpXS5saW5lLG5ld0JyZWFrc1tpXS5jaCt2YWwubGVuZ3RoKSk7fX0pO29wdGlvbihcInNwZWNpYWxDaGFyc1wiLC9bXFx1MDAwMC1cXHUwMDFmXFx1MDA3ZlxcdTAwYWRcXHUyMDBiLVxcdTIwMGZcXHUyMDI4XFx1MjAyOVxcdWZlZmZdL2csZnVuY3Rpb24oY20sdmFsLG9sZCl7Y20uc3RhdGUuc3BlY2lhbENoYXJzPW5ldyBSZWdFeHAodmFsLnNvdXJjZSsodmFsLnRlc3QoXCJcXHRcIik/XCJcIjpcInxcXHRcIiksXCJnXCIpO2lmKG9sZCE9SW5pdCl7Y20ucmVmcmVzaCgpO319KTtvcHRpb24oXCJzcGVjaWFsQ2hhclBsYWNlaG9sZGVyXCIsZGVmYXVsdFNwZWNpYWxDaGFyUGxhY2Vob2xkZXIsZnVuY3Rpb24oY20pe3JldHVybiBjbS5yZWZyZXNoKCk7fSx0cnVlKTtvcHRpb24oXCJlbGVjdHJpY0NoYXJzXCIsdHJ1ZSk7b3B0aW9uKFwiaW5wdXRTdHlsZVwiLG1vYmlsZT9cImNvbnRlbnRlZGl0YWJsZVwiOlwidGV4dGFyZWFcIixmdW5jdGlvbigpe3Rocm93IG5ldyBFcnJvcihcImlucHV0U3R5bGUgY2FuIG5vdCAoeWV0KSBiZSBjaGFuZ2VkIGluIGEgcnVubmluZyBlZGl0b3JcIik7Ly8gRklYTUVcbn0sdHJ1ZSk7b3B0aW9uKFwic3BlbGxjaGVja1wiLGZhbHNlLGZ1bmN0aW9uKGNtLHZhbCl7cmV0dXJuIGNtLmdldElucHV0RmllbGQoKS5zcGVsbGNoZWNrPXZhbDt9LHRydWUpO29wdGlvbihcInJ0bE1vdmVWaXN1YWxseVwiLCF3aW5kb3dzKTtvcHRpb24oXCJ3aG9sZUxpbmVVcGRhdGVCZWZvcmVcIix0cnVlKTtvcHRpb24oXCJ0aGVtZVwiLFwiZGVmYXVsdFwiLGZ1bmN0aW9uKGNtKXt0aGVtZUNoYW5nZWQoY20pO2d1dHRlcnNDaGFuZ2VkKGNtKTt9LHRydWUpO29wdGlvbihcImtleU1hcFwiLFwiZGVmYXVsdFwiLGZ1bmN0aW9uKGNtLHZhbCxvbGQpe3ZhciBuZXh0PWdldEtleU1hcCh2YWwpO3ZhciBwcmV2PW9sZCE9SW5pdCYmZ2V0S2V5TWFwKG9sZCk7aWYocHJldiYmcHJldi5kZXRhY2gpe3ByZXYuZGV0YWNoKGNtLG5leHQpO31pZihuZXh0LmF0dGFjaCl7bmV4dC5hdHRhY2goY20scHJldnx8bnVsbCk7fX0pO29wdGlvbihcImV4dHJhS2V5c1wiLG51bGwpO29wdGlvbihcImxpbmVXcmFwcGluZ1wiLGZhbHNlLHdyYXBwaW5nQ2hhbmdlZCx0cnVlKTtvcHRpb24oXCJndXR0ZXJzXCIsW10sZnVuY3Rpb24oY20pe3NldEd1dHRlcnNGb3JMaW5lTnVtYmVycyhjbS5vcHRpb25zKTtndXR0ZXJzQ2hhbmdlZChjbSk7fSx0cnVlKTtvcHRpb24oXCJmaXhlZEd1dHRlclwiLHRydWUsZnVuY3Rpb24oY20sdmFsKXtjbS5kaXNwbGF5Lmd1dHRlcnMuc3R5bGUubGVmdD12YWw/Y29tcGVuc2F0ZUZvckhTY3JvbGwoY20uZGlzcGxheSkrXCJweFwiOlwiMFwiO2NtLnJlZnJlc2goKTt9LHRydWUpO29wdGlvbihcImNvdmVyR3V0dGVyTmV4dFRvU2Nyb2xsYmFyXCIsZmFsc2UsZnVuY3Rpb24oY20pe3JldHVybiB1cGRhdGVTY3JvbGxiYXJzKGNtKTt9LHRydWUpO29wdGlvbihcInNjcm9sbGJhclN0eWxlXCIsXCJuYXRpdmVcIixmdW5jdGlvbihjbSl7aW5pdFNjcm9sbGJhcnMoY20pO3VwZGF0ZVNjcm9sbGJhcnMoY20pO2NtLmRpc3BsYXkuc2Nyb2xsYmFycy5zZXRTY3JvbGxUb3AoY20uZG9jLnNjcm9sbFRvcCk7Y20uZGlzcGxheS5zY3JvbGxiYXJzLnNldFNjcm9sbExlZnQoY20uZG9jLnNjcm9sbExlZnQpO30sdHJ1ZSk7b3B0aW9uKFwibGluZU51bWJlcnNcIixmYWxzZSxmdW5jdGlvbihjbSl7c2V0R3V0dGVyc0ZvckxpbmVOdW1iZXJzKGNtLm9wdGlvbnMpO2d1dHRlcnNDaGFuZ2VkKGNtKTt9LHRydWUpO29wdGlvbihcImZpcnN0TGluZU51bWJlclwiLDEsZ3V0dGVyc0NoYW5nZWQsdHJ1ZSk7b3B0aW9uKFwibGluZU51bWJlckZvcm1hdHRlclwiLGZ1bmN0aW9uKGludGVnZXIpe3JldHVybiBpbnRlZ2VyO30sZ3V0dGVyc0NoYW5nZWQsdHJ1ZSk7b3B0aW9uKFwic2hvd0N1cnNvcldoZW5TZWxlY3RpbmdcIixmYWxzZSx1cGRhdGVTZWxlY3Rpb24sdHJ1ZSk7b3B0aW9uKFwicmVzZXRTZWxlY3Rpb25PbkNvbnRleHRNZW51XCIsdHJ1ZSk7b3B0aW9uKFwibGluZVdpc2VDb3B5Q3V0XCIsdHJ1ZSk7b3B0aW9uKFwicmVhZE9ubHlcIixmYWxzZSxmdW5jdGlvbihjbSx2YWwpe2lmKHZhbD09XCJub2N1cnNvclwiKXtvbkJsdXIoY20pO2NtLmRpc3BsYXkuaW5wdXQuYmx1cigpO2NtLmRpc3BsYXkuZGlzYWJsZWQ9dHJ1ZTt9ZWxzZXtjbS5kaXNwbGF5LmRpc2FibGVkPWZhbHNlO31jbS5kaXNwbGF5LmlucHV0LnJlYWRPbmx5Q2hhbmdlZCh2YWwpO30pO29wdGlvbihcImRpc2FibGVJbnB1dFwiLGZhbHNlLGZ1bmN0aW9uKGNtLHZhbCl7aWYoIXZhbCl7Y20uZGlzcGxheS5pbnB1dC5yZXNldCgpO319LHRydWUpO29wdGlvbihcImRyYWdEcm9wXCIsdHJ1ZSxkcmFnRHJvcENoYW5nZWQpO29wdGlvbihcImFsbG93RHJvcEZpbGVUeXBlc1wiLG51bGwpO29wdGlvbihcImN1cnNvckJsaW5rUmF0ZVwiLDUzMCk7b3B0aW9uKFwiY3Vyc29yU2Nyb2xsTWFyZ2luXCIsMCk7b3B0aW9uKFwiY3Vyc29ySGVpZ2h0XCIsMSx1cGRhdGVTZWxlY3Rpb24sdHJ1ZSk7b3B0aW9uKFwic2luZ2xlQ3Vyc29ySGVpZ2h0UGVyTGluZVwiLHRydWUsdXBkYXRlU2VsZWN0aW9uLHRydWUpO29wdGlvbihcIndvcmtUaW1lXCIsMTAwKTtvcHRpb24oXCJ3b3JrRGVsYXlcIiwxMDApO29wdGlvbihcImZsYXR0ZW5TcGFuc1wiLHRydWUscmVzZXRNb2RlU3RhdGUsdHJ1ZSk7b3B0aW9uKFwiYWRkTW9kZUNsYXNzXCIsZmFsc2UscmVzZXRNb2RlU3RhdGUsdHJ1ZSk7b3B0aW9uKFwicG9sbEludGVydmFsXCIsMTAwKTtvcHRpb24oXCJ1bmRvRGVwdGhcIiwyMDAsZnVuY3Rpb24oY20sdmFsKXtyZXR1cm4gY20uZG9jLmhpc3RvcnkudW5kb0RlcHRoPXZhbDt9KTtvcHRpb24oXCJoaXN0b3J5RXZlbnREZWxheVwiLDEyNTApO29wdGlvbihcInZpZXdwb3J0TWFyZ2luXCIsMTAsZnVuY3Rpb24oY20pe3JldHVybiBjbS5yZWZyZXNoKCk7fSx0cnVlKTtvcHRpb24oXCJtYXhIaWdobGlnaHRMZW5ndGhcIiwxMDAwMCxyZXNldE1vZGVTdGF0ZSx0cnVlKTtvcHRpb24oXCJtb3ZlSW5wdXRXaXRoQ3Vyc29yXCIsdHJ1ZSxmdW5jdGlvbihjbSx2YWwpe2lmKCF2YWwpe2NtLmRpc3BsYXkuaW5wdXQucmVzZXRQb3NpdGlvbigpO319KTtvcHRpb24oXCJ0YWJpbmRleFwiLG51bGwsZnVuY3Rpb24oY20sdmFsKXtyZXR1cm4gY20uZGlzcGxheS5pbnB1dC5nZXRGaWVsZCgpLnRhYkluZGV4PXZhbHx8XCJcIjt9KTtvcHRpb24oXCJhdXRvZm9jdXNcIixudWxsKTt9ZnVuY3Rpb24gZ3V0dGVyc0NoYW5nZWQoY20pe3VwZGF0ZUd1dHRlcnMoY20pO3JlZ0NoYW5nZShjbSk7c2V0VGltZW91dChmdW5jdGlvbigpe3JldHVybiBhbGlnbkhvcml6b250YWxseShjbSk7fSwyMCk7fWZ1bmN0aW9uIGRyYWdEcm9wQ2hhbmdlZChjbSx2YWx1ZSxvbGQpe3ZhciB3YXNPbj1vbGQmJm9sZCE9SW5pdDtpZighdmFsdWUhPSF3YXNPbil7dmFyIGZ1bmNzPWNtLmRpc3BsYXkuZHJhZ0Z1bmN0aW9uczt2YXIgdG9nZ2xlPXZhbHVlP29uOm9mZjt0b2dnbGUoY20uZGlzcGxheS5zY3JvbGxlcixcImRyYWdzdGFydFwiLGZ1bmNzLnN0YXJ0KTt0b2dnbGUoY20uZGlzcGxheS5zY3JvbGxlcixcImRyYWdlbnRlclwiLGZ1bmNzLmVudGVyKTt0b2dnbGUoY20uZGlzcGxheS5zY3JvbGxlcixcImRyYWdvdmVyXCIsZnVuY3Mub3Zlcik7dG9nZ2xlKGNtLmRpc3BsYXkuc2Nyb2xsZXIsXCJkcmFnbGVhdmVcIixmdW5jcy5sZWF2ZSk7dG9nZ2xlKGNtLmRpc3BsYXkuc2Nyb2xsZXIsXCJkcm9wXCIsZnVuY3MuZHJvcCk7fX1mdW5jdGlvbiB3cmFwcGluZ0NoYW5nZWQoY20pe2lmKGNtLm9wdGlvbnMubGluZVdyYXBwaW5nKXthZGRDbGFzcyhjbS5kaXNwbGF5LndyYXBwZXIsXCJDb2RlTWlycm9yLXdyYXBcIik7Y20uZGlzcGxheS5zaXplci5zdHlsZS5taW5XaWR0aD1cIlwiO2NtLmRpc3BsYXkuc2l6ZXJXaWR0aD1udWxsO31lbHNle3JtQ2xhc3MoY20uZGlzcGxheS53cmFwcGVyLFwiQ29kZU1pcnJvci13cmFwXCIpO2ZpbmRNYXhMaW5lKGNtKTt9ZXN0aW1hdGVMaW5lSGVpZ2h0cyhjbSk7cmVnQ2hhbmdlKGNtKTtjbGVhckNhY2hlcyhjbSk7c2V0VGltZW91dChmdW5jdGlvbigpe3JldHVybiB1cGRhdGVTY3JvbGxiYXJzKGNtKTt9LDEwMCk7fS8vIEEgQ29kZU1pcnJvciBpbnN0YW5jZSByZXByZXNlbnRzIGFuIGVkaXRvci4gVGhpcyBpcyB0aGUgb2JqZWN0XG4vLyB0aGF0IHVzZXIgY29kZSBpcyB1c3VhbGx5IGRlYWxpbmcgd2l0aC5cbmZ1bmN0aW9uIENvZGVNaXJyb3IocGxhY2Usb3B0aW9ucyl7dmFyIHRoaXMkMT10aGlzO2lmKCEodGhpcyBpbnN0YW5jZW9mIENvZGVNaXJyb3IpKXtyZXR1cm4gbmV3IENvZGVNaXJyb3IocGxhY2Usb3B0aW9ucyk7fXRoaXMub3B0aW9ucz1vcHRpb25zPW9wdGlvbnM/Y29weU9iaihvcHRpb25zKTp7fTsvLyBEZXRlcm1pbmUgZWZmZWN0aXZlIG9wdGlvbnMgYmFzZWQgb24gZ2l2ZW4gdmFsdWVzIGFuZCBkZWZhdWx0cy5cbmNvcHlPYmooZGVmYXVsdHMsb3B0aW9ucyxmYWxzZSk7c2V0R3V0dGVyc0ZvckxpbmVOdW1iZXJzKG9wdGlvbnMpO3ZhciBkb2M9b3B0aW9ucy52YWx1ZTtpZih0eXBlb2YgZG9jPT1cInN0cmluZ1wiKXtkb2M9bmV3IERvYyhkb2Msb3B0aW9ucy5tb2RlLG51bGwsb3B0aW9ucy5saW5lU2VwYXJhdG9yKTt9dGhpcy5kb2M9ZG9jO3ZhciBpbnB1dD1uZXcgQ29kZU1pcnJvci5pbnB1dFN0eWxlc1tvcHRpb25zLmlucHV0U3R5bGVdKHRoaXMpO3ZhciBkaXNwbGF5PXRoaXMuZGlzcGxheT1uZXcgRGlzcGxheShwbGFjZSxkb2MsaW5wdXQpO2Rpc3BsYXkud3JhcHBlci5Db2RlTWlycm9yPXRoaXM7dXBkYXRlR3V0dGVycyh0aGlzKTt0aGVtZUNoYW5nZWQodGhpcyk7aWYob3B0aW9ucy5saW5lV3JhcHBpbmcpe3RoaXMuZGlzcGxheS53cmFwcGVyLmNsYXNzTmFtZSs9XCIgQ29kZU1pcnJvci13cmFwXCI7fWlmKG9wdGlvbnMuYXV0b2ZvY3VzJiYhbW9iaWxlKXtkaXNwbGF5LmlucHV0LmZvY3VzKCk7fWluaXRTY3JvbGxiYXJzKHRoaXMpO3RoaXMuc3RhdGU9e2tleU1hcHM6W10sLy8gc3RvcmVzIG1hcHMgYWRkZWQgYnkgYWRkS2V5TWFwXG5vdmVybGF5czpbXSwvLyBoaWdobGlnaHRpbmcgb3ZlcmxheXMsIGFzIGFkZGVkIGJ5IGFkZE92ZXJsYXlcbm1vZGVHZW46MCwvLyBidW1wZWQgd2hlbiBtb2RlL292ZXJsYXkgY2hhbmdlcywgdXNlZCB0byBpbnZhbGlkYXRlIGhpZ2hsaWdodGluZyBpbmZvXG5vdmVyd3JpdGU6ZmFsc2UsZGVsYXlpbmdCbHVyRXZlbnQ6ZmFsc2UsZm9jdXNlZDpmYWxzZSxzdXBwcmVzc0VkaXRzOmZhbHNlLC8vIHVzZWQgdG8gZGlzYWJsZSBlZGl0aW5nIGR1cmluZyBrZXkgaGFuZGxlcnMgd2hlbiBpbiByZWFkT25seSBtb2RlXG5wYXN0ZUluY29taW5nOmZhbHNlLGN1dEluY29taW5nOmZhbHNlLC8vIGhlbHAgcmVjb2duaXplIHBhc3RlL2N1dCBlZGl0cyBpbiBpbnB1dC5wb2xsXG5zZWxlY3RpbmdUZXh0OmZhbHNlLGRyYWdnaW5nVGV4dDpmYWxzZSxoaWdobGlnaHQ6bmV3IERlbGF5ZWQoKSwvLyBzdG9yZXMgaGlnaGxpZ2h0IHdvcmtlciB0aW1lb3V0XG5rZXlTZXE6bnVsbCwvLyBVbmZpbmlzaGVkIGtleSBzZXF1ZW5jZVxuc3BlY2lhbENoYXJzOm51bGx9Oy8vIE92ZXJyaWRlIG1hZ2ljIHRleHRhcmVhIGNvbnRlbnQgcmVzdG9yZSB0aGF0IElFIHNvbWV0aW1lcyBkb2VzXG4vLyBvbiBvdXIgaGlkZGVuIHRleHRhcmVhIG9uIHJlbG9hZFxuaWYoaWUmJmllX3ZlcnNpb248MTEpe3NldFRpbWVvdXQoZnVuY3Rpb24oKXtyZXR1cm4gdGhpcyQxLmRpc3BsYXkuaW5wdXQucmVzZXQodHJ1ZSk7fSwyMCk7fXJlZ2lzdGVyRXZlbnRIYW5kbGVycyh0aGlzKTtlbnN1cmVHbG9iYWxIYW5kbGVycygpO3N0YXJ0T3BlcmF0aW9uKHRoaXMpO3RoaXMuY3VyT3AuZm9yY2VVcGRhdGU9dHJ1ZTthdHRhY2hEb2ModGhpcyxkb2MpO2lmKG9wdGlvbnMuYXV0b2ZvY3VzJiYhbW9iaWxlfHx0aGlzLmhhc0ZvY3VzKCkpe3NldFRpbWVvdXQoYmluZChvbkZvY3VzLHRoaXMpLDIwKTt9ZWxzZXtvbkJsdXIodGhpcyk7fWZvcih2YXIgb3B0IGluIG9wdGlvbkhhbmRsZXJzKXtpZihvcHRpb25IYW5kbGVycy5oYXNPd25Qcm9wZXJ0eShvcHQpKXtvcHRpb25IYW5kbGVyc1tvcHRdKHRoaXMkMSxvcHRpb25zW29wdF0sSW5pdCk7fX1tYXliZVVwZGF0ZUxpbmVOdW1iZXJXaWR0aCh0aGlzKTtpZihvcHRpb25zLmZpbmlzaEluaXQpe29wdGlvbnMuZmluaXNoSW5pdCh0aGlzKTt9Zm9yKHZhciBpPTA7aTxpbml0SG9va3MubGVuZ3RoOysraSl7aW5pdEhvb2tzW2ldKHRoaXMkMSk7fWVuZE9wZXJhdGlvbih0aGlzKTsvLyBTdXBwcmVzcyBvcHRpbWl6ZWxlZ2liaWxpdHkgaW4gV2Via2l0LCBzaW5jZSBpdCBicmVha3MgdGV4dFxuLy8gbWVhc3VyaW5nIG9uIGxpbmUgd3JhcHBpbmcgYm91bmRhcmllcy5cbmlmKHdlYmtpdCYmb3B0aW9ucy5saW5lV3JhcHBpbmcmJmdldENvbXB1dGVkU3R5bGUoZGlzcGxheS5saW5lRGl2KS50ZXh0UmVuZGVyaW5nPT1cIm9wdGltaXplbGVnaWJpbGl0eVwiKXtkaXNwbGF5LmxpbmVEaXYuc3R5bGUudGV4dFJlbmRlcmluZz1cImF1dG9cIjt9fS8vIFRoZSBkZWZhdWx0IGNvbmZpZ3VyYXRpb24gb3B0aW9ucy5cbkNvZGVNaXJyb3IuZGVmYXVsdHM9ZGVmYXVsdHM7Ly8gRnVuY3Rpb25zIHRvIHJ1biB3aGVuIG9wdGlvbnMgYXJlIGNoYW5nZWQuXG5Db2RlTWlycm9yLm9wdGlvbkhhbmRsZXJzPW9wdGlvbkhhbmRsZXJzOy8vIEF0dGFjaCB0aGUgbmVjZXNzYXJ5IGV2ZW50IGhhbmRsZXJzIHdoZW4gaW5pdGlhbGl6aW5nIHRoZSBlZGl0b3JcbmZ1bmN0aW9uIHJlZ2lzdGVyRXZlbnRIYW5kbGVycyhjbSl7dmFyIGQ9Y20uZGlzcGxheTtvbihkLnNjcm9sbGVyLFwibW91c2Vkb3duXCIsb3BlcmF0aW9uKGNtLG9uTW91c2VEb3duKSk7Ly8gT2xkZXIgSUUncyB3aWxsIG5vdCBmaXJlIGEgc2Vjb25kIG1vdXNlZG93biBmb3IgYSBkb3VibGUgY2xpY2tcbmlmKGllJiZpZV92ZXJzaW9uPDExKXtvbihkLnNjcm9sbGVyLFwiZGJsY2xpY2tcIixvcGVyYXRpb24oY20sZnVuY3Rpb24oZSl7aWYoc2lnbmFsRE9NRXZlbnQoY20sZSkpe3JldHVybjt9dmFyIHBvcz1wb3NGcm9tTW91c2UoY20sZSk7aWYoIXBvc3x8Y2xpY2tJbkd1dHRlcihjbSxlKXx8ZXZlbnRJbldpZGdldChjbS5kaXNwbGF5LGUpKXtyZXR1cm47fWVfcHJldmVudERlZmF1bHQoZSk7dmFyIHdvcmQ9Y20uZmluZFdvcmRBdChwb3MpO2V4dGVuZFNlbGVjdGlvbihjbS5kb2Msd29yZC5hbmNob3Isd29yZC5oZWFkKTt9KSk7fWVsc2V7b24oZC5zY3JvbGxlcixcImRibGNsaWNrXCIsZnVuY3Rpb24oZSl7cmV0dXJuIHNpZ25hbERPTUV2ZW50KGNtLGUpfHxlX3ByZXZlbnREZWZhdWx0KGUpO30pO30vLyBTb21lIGJyb3dzZXJzIGZpcmUgY29udGV4dG1lbnUgKmFmdGVyKiBvcGVuaW5nIHRoZSBtZW51LCBhdFxuLy8gd2hpY2ggcG9pbnQgd2UgY2FuJ3QgbWVzcyB3aXRoIGl0IGFueW1vcmUuIENvbnRleHQgbWVudSBpc1xuLy8gaGFuZGxlZCBpbiBvbk1vdXNlRG93biBmb3IgdGhlc2UgYnJvd3NlcnMuXG5pZighY2FwdHVyZVJpZ2h0Q2xpY2spe29uKGQuc2Nyb2xsZXIsXCJjb250ZXh0bWVudVwiLGZ1bmN0aW9uKGUpe3JldHVybiBvbkNvbnRleHRNZW51KGNtLGUpO30pO30vLyBVc2VkIHRvIHN1cHByZXNzIG1vdXNlIGV2ZW50IGhhbmRsaW5nIHdoZW4gYSB0b3VjaCBoYXBwZW5zXG52YXIgdG91Y2hGaW5pc2hlZCxwcmV2VG91Y2g9e2VuZDowfTtmdW5jdGlvbiBmaW5pc2hUb3VjaCgpe2lmKGQuYWN0aXZlVG91Y2gpe3RvdWNoRmluaXNoZWQ9c2V0VGltZW91dChmdW5jdGlvbigpe3JldHVybiBkLmFjdGl2ZVRvdWNoPW51bGw7fSwxMDAwKTtwcmV2VG91Y2g9ZC5hY3RpdmVUb3VjaDtwcmV2VG91Y2guZW5kPStuZXcgRGF0ZSgpO319ZnVuY3Rpb24gaXNNb3VzZUxpa2VUb3VjaEV2ZW50KGUpe2lmKGUudG91Y2hlcy5sZW5ndGghPTEpe3JldHVybiBmYWxzZTt9dmFyIHRvdWNoPWUudG91Y2hlc1swXTtyZXR1cm4gdG91Y2gucmFkaXVzWDw9MSYmdG91Y2gucmFkaXVzWTw9MTt9ZnVuY3Rpb24gZmFyQXdheSh0b3VjaCxvdGhlcil7aWYob3RoZXIubGVmdD09bnVsbCl7cmV0dXJuIHRydWU7fXZhciBkeD1vdGhlci5sZWZ0LXRvdWNoLmxlZnQsZHk9b3RoZXIudG9wLXRvdWNoLnRvcDtyZXR1cm4gZHgqZHgrZHkqZHk+MjAqMjA7fW9uKGQuc2Nyb2xsZXIsXCJ0b3VjaHN0YXJ0XCIsZnVuY3Rpb24oZSl7aWYoIXNpZ25hbERPTUV2ZW50KGNtLGUpJiYhaXNNb3VzZUxpa2VUb3VjaEV2ZW50KGUpKXtjbGVhclRpbWVvdXQodG91Y2hGaW5pc2hlZCk7dmFyIG5vdz0rbmV3IERhdGUoKTtkLmFjdGl2ZVRvdWNoPXtzdGFydDpub3csbW92ZWQ6ZmFsc2UscHJldjpub3ctcHJldlRvdWNoLmVuZDw9MzAwP3ByZXZUb3VjaDpudWxsfTtpZihlLnRvdWNoZXMubGVuZ3RoPT0xKXtkLmFjdGl2ZVRvdWNoLmxlZnQ9ZS50b3VjaGVzWzBdLnBhZ2VYO2QuYWN0aXZlVG91Y2gudG9wPWUudG91Y2hlc1swXS5wYWdlWTt9fX0pO29uKGQuc2Nyb2xsZXIsXCJ0b3VjaG1vdmVcIixmdW5jdGlvbigpe2lmKGQuYWN0aXZlVG91Y2gpe2QuYWN0aXZlVG91Y2gubW92ZWQ9dHJ1ZTt9fSk7b24oZC5zY3JvbGxlcixcInRvdWNoZW5kXCIsZnVuY3Rpb24oZSl7dmFyIHRvdWNoPWQuYWN0aXZlVG91Y2g7aWYodG91Y2gmJiFldmVudEluV2lkZ2V0KGQsZSkmJnRvdWNoLmxlZnQhPW51bGwmJiF0b3VjaC5tb3ZlZCYmbmV3IERhdGUoKS10b3VjaC5zdGFydDwzMDApe3ZhciBwb3M9Y20uY29vcmRzQ2hhcihkLmFjdGl2ZVRvdWNoLFwicGFnZVwiKSxyYW5nZTtpZighdG91Y2gucHJldnx8ZmFyQXdheSh0b3VjaCx0b3VjaC5wcmV2KSkvLyBTaW5nbGUgdGFwXG57cmFuZ2U9bmV3IFJhbmdlKHBvcyxwb3MpO31lbHNlIGlmKCF0b3VjaC5wcmV2LnByZXZ8fGZhckF3YXkodG91Y2gsdG91Y2gucHJldi5wcmV2KSkvLyBEb3VibGUgdGFwXG57cmFuZ2U9Y20uZmluZFdvcmRBdChwb3MpO31lbHNlLy8gVHJpcGxlIHRhcFxue3JhbmdlPW5ldyBSYW5nZShQb3MocG9zLmxpbmUsMCksY2xpcFBvcyhjbS5kb2MsUG9zKHBvcy5saW5lKzEsMCkpKTt9Y20uc2V0U2VsZWN0aW9uKHJhbmdlLmFuY2hvcixyYW5nZS5oZWFkKTtjbS5mb2N1cygpO2VfcHJldmVudERlZmF1bHQoZSk7fWZpbmlzaFRvdWNoKCk7fSk7b24oZC5zY3JvbGxlcixcInRvdWNoY2FuY2VsXCIsZmluaXNoVG91Y2gpOy8vIFN5bmMgc2Nyb2xsaW5nIGJldHdlZW4gZmFrZSBzY3JvbGxiYXJzIGFuZCByZWFsIHNjcm9sbGFibGVcbi8vIGFyZWEsIGVuc3VyZSB2aWV3cG9ydCBpcyB1cGRhdGVkIHdoZW4gc2Nyb2xsaW5nLlxub24oZC5zY3JvbGxlcixcInNjcm9sbFwiLGZ1bmN0aW9uKCl7aWYoZC5zY3JvbGxlci5jbGllbnRIZWlnaHQpe3NldFNjcm9sbFRvcChjbSxkLnNjcm9sbGVyLnNjcm9sbFRvcCk7c2V0U2Nyb2xsTGVmdChjbSxkLnNjcm9sbGVyLnNjcm9sbExlZnQsdHJ1ZSk7c2lnbmFsKGNtLFwic2Nyb2xsXCIsY20pO319KTsvLyBMaXN0ZW4gdG8gd2hlZWwgZXZlbnRzIGluIG9yZGVyIHRvIHRyeSBhbmQgdXBkYXRlIHRoZSB2aWV3cG9ydCBvbiB0aW1lLlxub24oZC5zY3JvbGxlcixcIm1vdXNld2hlZWxcIixmdW5jdGlvbihlKXtyZXR1cm4gb25TY3JvbGxXaGVlbChjbSxlKTt9KTtvbihkLnNjcm9sbGVyLFwiRE9NTW91c2VTY3JvbGxcIixmdW5jdGlvbihlKXtyZXR1cm4gb25TY3JvbGxXaGVlbChjbSxlKTt9KTsvLyBQcmV2ZW50IHdyYXBwZXIgZnJvbSBldmVyIHNjcm9sbGluZ1xub24oZC53cmFwcGVyLFwic2Nyb2xsXCIsZnVuY3Rpb24oKXtyZXR1cm4gZC53cmFwcGVyLnNjcm9sbFRvcD1kLndyYXBwZXIuc2Nyb2xsTGVmdD0wO30pO2QuZHJhZ0Z1bmN0aW9ucz17ZW50ZXI6ZnVuY3Rpb24oZSl7aWYoIXNpZ25hbERPTUV2ZW50KGNtLGUpKXtlX3N0b3AoZSk7fX0sb3ZlcjpmdW5jdGlvbihlKXtpZighc2lnbmFsRE9NRXZlbnQoY20sZSkpe29uRHJhZ092ZXIoY20sZSk7ZV9zdG9wKGUpO319LHN0YXJ0OmZ1bmN0aW9uKGUpe3JldHVybiBvbkRyYWdTdGFydChjbSxlKTt9LGRyb3A6b3BlcmF0aW9uKGNtLG9uRHJvcCksbGVhdmU6ZnVuY3Rpb24oZSl7aWYoIXNpZ25hbERPTUV2ZW50KGNtLGUpKXtjbGVhckRyYWdDdXJzb3IoY20pO319fTt2YXIgaW5wPWQuaW5wdXQuZ2V0RmllbGQoKTtvbihpbnAsXCJrZXl1cFwiLGZ1bmN0aW9uKGUpe3JldHVybiBvbktleVVwLmNhbGwoY20sZSk7fSk7b24oaW5wLFwia2V5ZG93blwiLG9wZXJhdGlvbihjbSxvbktleURvd24pKTtvbihpbnAsXCJrZXlwcmVzc1wiLG9wZXJhdGlvbihjbSxvbktleVByZXNzKSk7b24oaW5wLFwiZm9jdXNcIixmdW5jdGlvbihlKXtyZXR1cm4gb25Gb2N1cyhjbSxlKTt9KTtvbihpbnAsXCJibHVyXCIsZnVuY3Rpb24oZSl7cmV0dXJuIG9uQmx1cihjbSxlKTt9KTt9dmFyIGluaXRIb29rcz1bXTtDb2RlTWlycm9yLmRlZmluZUluaXRIb29rPWZ1bmN0aW9uKGYpe3JldHVybiBpbml0SG9va3MucHVzaChmKTt9Oy8vIEluZGVudCB0aGUgZ2l2ZW4gbGluZS4gVGhlIGhvdyBwYXJhbWV0ZXIgY2FuIGJlIFwic21hcnRcIixcbi8vIFwiYWRkXCIvbnVsbCwgXCJzdWJ0cmFjdFwiLCBvciBcInByZXZcIi4gV2hlbiBhZ2dyZXNzaXZlIGlzIGZhbHNlXG4vLyAodHlwaWNhbGx5IHNldCB0byB0cnVlIGZvciBmb3JjZWQgc2luZ2xlLWxpbmUgaW5kZW50cyksIGVtcHR5XG4vLyBsaW5lcyBhcmUgbm90IGluZGVudGVkLCBhbmQgcGxhY2VzIHdoZXJlIHRoZSBtb2RlIHJldHVybnMgUGFzc1xuLy8gYXJlIGxlZnQgYWxvbmUuXG5mdW5jdGlvbiBpbmRlbnRMaW5lKGNtLG4saG93LGFnZ3Jlc3NpdmUpe3ZhciBkb2M9Y20uZG9jLHN0YXRlO2lmKGhvdz09bnVsbCl7aG93PVwiYWRkXCI7fWlmKGhvdz09XCJzbWFydFwiKXsvLyBGYWxsIGJhY2sgdG8gXCJwcmV2XCIgd2hlbiB0aGUgbW9kZSBkb2Vzbid0IGhhdmUgYW4gaW5kZW50YXRpb25cbi8vIG1ldGhvZC5cbmlmKCFkb2MubW9kZS5pbmRlbnQpe2hvdz1cInByZXZcIjt9ZWxzZXtzdGF0ZT1nZXRTdGF0ZUJlZm9yZShjbSxuKTt9fXZhciB0YWJTaXplPWNtLm9wdGlvbnMudGFiU2l6ZTt2YXIgbGluZT1nZXRMaW5lKGRvYyxuKSxjdXJTcGFjZT1jb3VudENvbHVtbihsaW5lLnRleHQsbnVsbCx0YWJTaXplKTtpZihsaW5lLnN0YXRlQWZ0ZXIpe2xpbmUuc3RhdGVBZnRlcj1udWxsO312YXIgY3VyU3BhY2VTdHJpbmc9bGluZS50ZXh0Lm1hdGNoKC9eXFxzKi8pWzBdLGluZGVudGF0aW9uO2lmKCFhZ2dyZXNzaXZlJiYhL1xcUy8udGVzdChsaW5lLnRleHQpKXtpbmRlbnRhdGlvbj0wO2hvdz1cIm5vdFwiO31lbHNlIGlmKGhvdz09XCJzbWFydFwiKXtpbmRlbnRhdGlvbj1kb2MubW9kZS5pbmRlbnQoc3RhdGUsbGluZS50ZXh0LnNsaWNlKGN1clNwYWNlU3RyaW5nLmxlbmd0aCksbGluZS50ZXh0KTtpZihpbmRlbnRhdGlvbj09UGFzc3x8aW5kZW50YXRpb24+MTUwKXtpZighYWdncmVzc2l2ZSl7cmV0dXJuO31ob3c9XCJwcmV2XCI7fX1pZihob3c9PVwicHJldlwiKXtpZihuPmRvYy5maXJzdCl7aW5kZW50YXRpb249Y291bnRDb2x1bW4oZ2V0TGluZShkb2Msbi0xKS50ZXh0LG51bGwsdGFiU2l6ZSk7fWVsc2V7aW5kZW50YXRpb249MDt9fWVsc2UgaWYoaG93PT1cImFkZFwiKXtpbmRlbnRhdGlvbj1jdXJTcGFjZStjbS5vcHRpb25zLmluZGVudFVuaXQ7fWVsc2UgaWYoaG93PT1cInN1YnRyYWN0XCIpe2luZGVudGF0aW9uPWN1clNwYWNlLWNtLm9wdGlvbnMuaW5kZW50VW5pdDt9ZWxzZSBpZih0eXBlb2YgaG93PT1cIm51bWJlclwiKXtpbmRlbnRhdGlvbj1jdXJTcGFjZStob3c7fWluZGVudGF0aW9uPU1hdGgubWF4KDAsaW5kZW50YXRpb24pO3ZhciBpbmRlbnRTdHJpbmc9XCJcIixwb3M9MDtpZihjbS5vcHRpb25zLmluZGVudFdpdGhUYWJzKXtmb3IodmFyIGk9TWF0aC5mbG9vcihpbmRlbnRhdGlvbi90YWJTaXplKTtpOy0taSl7cG9zKz10YWJTaXplO2luZGVudFN0cmluZys9XCJcXHRcIjt9fWlmKHBvczxpbmRlbnRhdGlvbil7aW5kZW50U3RyaW5nKz1zcGFjZVN0cihpbmRlbnRhdGlvbi1wb3MpO31pZihpbmRlbnRTdHJpbmchPWN1clNwYWNlU3RyaW5nKXtyZXBsYWNlUmFuZ2UoZG9jLGluZGVudFN0cmluZyxQb3MobiwwKSxQb3MobixjdXJTcGFjZVN0cmluZy5sZW5ndGgpLFwiK2lucHV0XCIpO2xpbmUuc3RhdGVBZnRlcj1udWxsO3JldHVybiB0cnVlO31lbHNley8vIEVuc3VyZSB0aGF0LCBpZiB0aGUgY3Vyc29yIHdhcyBpbiB0aGUgd2hpdGVzcGFjZSBhdCB0aGUgc3RhcnRcbi8vIG9mIHRoZSBsaW5lLCBpdCBpcyBtb3ZlZCB0byB0aGUgZW5kIG9mIHRoYXQgc3BhY2UuXG5mb3IodmFyIGkkMT0wO2kkMTxkb2Muc2VsLnJhbmdlcy5sZW5ndGg7aSQxKyspe3ZhciByYW5nZT1kb2Muc2VsLnJhbmdlc1tpJDFdO2lmKHJhbmdlLmhlYWQubGluZT09biYmcmFuZ2UuaGVhZC5jaDxjdXJTcGFjZVN0cmluZy5sZW5ndGgpe3ZhciBwb3MkMT1Qb3MobixjdXJTcGFjZVN0cmluZy5sZW5ndGgpO3JlcGxhY2VPbmVTZWxlY3Rpb24oZG9jLGkkMSxuZXcgUmFuZ2UocG9zJDEscG9zJDEpKTticmVhazt9fX19Ly8gVGhpcyB3aWxsIGJlIHNldCB0byBhIHtsaW5lV2lzZTogYm9vbCwgdGV4dDogW3N0cmluZ119IG9iamVjdCwgc29cbi8vIHRoYXQsIHdoZW4gcGFzdGluZywgd2Uga25vdyB3aGF0IGtpbmQgb2Ygc2VsZWN0aW9ucyB0aGUgY29waWVkXG4vLyB0ZXh0IHdhcyBtYWRlIG91dCBvZi5cbnZhciBsYXN0Q29waWVkPW51bGw7ZnVuY3Rpb24gc2V0TGFzdENvcGllZChuZXdMYXN0Q29waWVkKXtsYXN0Q29waWVkPW5ld0xhc3RDb3BpZWQ7fWZ1bmN0aW9uIGFwcGx5VGV4dElucHV0KGNtLGluc2VydGVkLGRlbGV0ZWQsc2VsLG9yaWdpbil7dmFyIGRvYz1jbS5kb2M7Y20uZGlzcGxheS5zaGlmdD1mYWxzZTtpZighc2VsKXtzZWw9ZG9jLnNlbDt9dmFyIHBhc3RlPWNtLnN0YXRlLnBhc3RlSW5jb21pbmd8fG9yaWdpbj09XCJwYXN0ZVwiO3ZhciB0ZXh0TGluZXM9c3BsaXRMaW5lc0F1dG8oaW5zZXJ0ZWQpLG11bHRpUGFzdGU9bnVsbDsvLyBXaGVuIHBhc2luZyBOIGxpbmVzIGludG8gTiBzZWxlY3Rpb25zLCBpbnNlcnQgb25lIGxpbmUgcGVyIHNlbGVjdGlvblxuaWYocGFzdGUmJnNlbC5yYW5nZXMubGVuZ3RoPjEpe2lmKGxhc3RDb3BpZWQmJmxhc3RDb3BpZWQudGV4dC5qb2luKFwiXFxuXCIpPT1pbnNlcnRlZCl7aWYoc2VsLnJhbmdlcy5sZW5ndGglbGFzdENvcGllZC50ZXh0Lmxlbmd0aD09MCl7bXVsdGlQYXN0ZT1bXTtmb3IodmFyIGk9MDtpPGxhc3RDb3BpZWQudGV4dC5sZW5ndGg7aSsrKXttdWx0aVBhc3RlLnB1c2goZG9jLnNwbGl0TGluZXMobGFzdENvcGllZC50ZXh0W2ldKSk7fX19ZWxzZSBpZih0ZXh0TGluZXMubGVuZ3RoPT1zZWwucmFuZ2VzLmxlbmd0aCl7bXVsdGlQYXN0ZT1tYXAodGV4dExpbmVzLGZ1bmN0aW9uKGwpe3JldHVybltsXTt9KTt9fXZhciB1cGRhdGVJbnB1dDsvLyBOb3JtYWwgYmVoYXZpb3IgaXMgdG8gaW5zZXJ0IHRoZSBuZXcgdGV4dCBpbnRvIGV2ZXJ5IHNlbGVjdGlvblxuZm9yKHZhciBpJDE9c2VsLnJhbmdlcy5sZW5ndGgtMTtpJDE+PTA7aSQxLS0pe3ZhciByYW5nZT1zZWwucmFuZ2VzW2kkMV07dmFyIGZyb209cmFuZ2UuZnJvbSgpLHRvPXJhbmdlLnRvKCk7aWYocmFuZ2UuZW1wdHkoKSl7aWYoZGVsZXRlZCYmZGVsZXRlZD4wKS8vIEhhbmRsZSBkZWxldGlvblxue2Zyb209UG9zKGZyb20ubGluZSxmcm9tLmNoLWRlbGV0ZWQpO31lbHNlIGlmKGNtLnN0YXRlLm92ZXJ3cml0ZSYmIXBhc3RlKS8vIEhhbmRsZSBvdmVyd3JpdGVcbnt0bz1Qb3ModG8ubGluZSxNYXRoLm1pbihnZXRMaW5lKGRvYyx0by5saW5lKS50ZXh0Lmxlbmd0aCx0by5jaCtsc3QodGV4dExpbmVzKS5sZW5ndGgpKTt9ZWxzZSBpZihsYXN0Q29waWVkJiZsYXN0Q29waWVkLmxpbmVXaXNlJiZsYXN0Q29waWVkLnRleHQuam9pbihcIlxcblwiKT09aW5zZXJ0ZWQpe2Zyb209dG89UG9zKGZyb20ubGluZSwwKTt9fXVwZGF0ZUlucHV0PWNtLmN1ck9wLnVwZGF0ZUlucHV0O3ZhciBjaGFuZ2VFdmVudD17ZnJvbTpmcm9tLHRvOnRvLHRleHQ6bXVsdGlQYXN0ZT9tdWx0aVBhc3RlW2kkMSVtdWx0aVBhc3RlLmxlbmd0aF06dGV4dExpbmVzLG9yaWdpbjpvcmlnaW58fChwYXN0ZT9cInBhc3RlXCI6Y20uc3RhdGUuY3V0SW5jb21pbmc/XCJjdXRcIjpcIitpbnB1dFwiKX07bWFrZUNoYW5nZShjbS5kb2MsY2hhbmdlRXZlbnQpO3NpZ25hbExhdGVyKGNtLFwiaW5wdXRSZWFkXCIsY20sY2hhbmdlRXZlbnQpO31pZihpbnNlcnRlZCYmIXBhc3RlKXt0cmlnZ2VyRWxlY3RyaWMoY20saW5zZXJ0ZWQpO31lbnN1cmVDdXJzb3JWaXNpYmxlKGNtKTtjbS5jdXJPcC51cGRhdGVJbnB1dD11cGRhdGVJbnB1dDtjbS5jdXJPcC50eXBpbmc9dHJ1ZTtjbS5zdGF0ZS5wYXN0ZUluY29taW5nPWNtLnN0YXRlLmN1dEluY29taW5nPWZhbHNlO31mdW5jdGlvbiBoYW5kbGVQYXN0ZShlLGNtKXt2YXIgcGFzdGVkPWUuY2xpcGJvYXJkRGF0YSYmZS5jbGlwYm9hcmREYXRhLmdldERhdGEoXCJUZXh0XCIpO2lmKHBhc3RlZCl7ZS5wcmV2ZW50RGVmYXVsdCgpO2lmKCFjbS5pc1JlYWRPbmx5KCkmJiFjbS5vcHRpb25zLmRpc2FibGVJbnB1dCl7cnVuSW5PcChjbSxmdW5jdGlvbigpe3JldHVybiBhcHBseVRleHRJbnB1dChjbSxwYXN0ZWQsMCxudWxsLFwicGFzdGVcIik7fSk7fXJldHVybiB0cnVlO319ZnVuY3Rpb24gdHJpZ2dlckVsZWN0cmljKGNtLGluc2VydGVkKXsvLyBXaGVuIGFuICdlbGVjdHJpYycgY2hhcmFjdGVyIGlzIGluc2VydGVkLCBpbW1lZGlhdGVseSB0cmlnZ2VyIGEgcmVpbmRlbnRcbmlmKCFjbS5vcHRpb25zLmVsZWN0cmljQ2hhcnN8fCFjbS5vcHRpb25zLnNtYXJ0SW5kZW50KXtyZXR1cm47fXZhciBzZWw9Y20uZG9jLnNlbDtmb3IodmFyIGk9c2VsLnJhbmdlcy5sZW5ndGgtMTtpPj0wO2ktLSl7dmFyIHJhbmdlPXNlbC5yYW5nZXNbaV07aWYocmFuZ2UuaGVhZC5jaD4xMDB8fGkmJnNlbC5yYW5nZXNbaS0xXS5oZWFkLmxpbmU9PXJhbmdlLmhlYWQubGluZSl7Y29udGludWU7fXZhciBtb2RlPWNtLmdldE1vZGVBdChyYW5nZS5oZWFkKTt2YXIgaW5kZW50ZWQ9ZmFsc2U7aWYobW9kZS5lbGVjdHJpY0NoYXJzKXtmb3IodmFyIGo9MDtqPG1vZGUuZWxlY3RyaWNDaGFycy5sZW5ndGg7aisrKXtpZihpbnNlcnRlZC5pbmRleE9mKG1vZGUuZWxlY3RyaWNDaGFycy5jaGFyQXQoaikpPi0xKXtpbmRlbnRlZD1pbmRlbnRMaW5lKGNtLHJhbmdlLmhlYWQubGluZSxcInNtYXJ0XCIpO2JyZWFrO319fWVsc2UgaWYobW9kZS5lbGVjdHJpY0lucHV0KXtpZihtb2RlLmVsZWN0cmljSW5wdXQudGVzdChnZXRMaW5lKGNtLmRvYyxyYW5nZS5oZWFkLmxpbmUpLnRleHQuc2xpY2UoMCxyYW5nZS5oZWFkLmNoKSkpe2luZGVudGVkPWluZGVudExpbmUoY20scmFuZ2UuaGVhZC5saW5lLFwic21hcnRcIik7fX1pZihpbmRlbnRlZCl7c2lnbmFsTGF0ZXIoY20sXCJlbGVjdHJpY0lucHV0XCIsY20scmFuZ2UuaGVhZC5saW5lKTt9fX1mdW5jdGlvbiBjb3B5YWJsZVJhbmdlcyhjbSl7dmFyIHRleHQ9W10scmFuZ2VzPVtdO2Zvcih2YXIgaT0wO2k8Y20uZG9jLnNlbC5yYW5nZXMubGVuZ3RoO2krKyl7dmFyIGxpbmU9Y20uZG9jLnNlbC5yYW5nZXNbaV0uaGVhZC5saW5lO3ZhciBsaW5lUmFuZ2U9e2FuY2hvcjpQb3MobGluZSwwKSxoZWFkOlBvcyhsaW5lKzEsMCl9O3Jhbmdlcy5wdXNoKGxpbmVSYW5nZSk7dGV4dC5wdXNoKGNtLmdldFJhbmdlKGxpbmVSYW5nZS5hbmNob3IsbGluZVJhbmdlLmhlYWQpKTt9cmV0dXJue3RleHQ6dGV4dCxyYW5nZXM6cmFuZ2VzfTt9ZnVuY3Rpb24gZGlzYWJsZUJyb3dzZXJNYWdpYyhmaWVsZCxzcGVsbGNoZWNrKXtmaWVsZC5zZXRBdHRyaWJ1dGUoXCJhdXRvY29ycmVjdFwiLFwib2ZmXCIpO2ZpZWxkLnNldEF0dHJpYnV0ZShcImF1dG9jYXBpdGFsaXplXCIsXCJvZmZcIik7ZmllbGQuc2V0QXR0cmlidXRlKFwic3BlbGxjaGVja1wiLCEhc3BlbGxjaGVjayk7fWZ1bmN0aW9uIGhpZGRlblRleHRhcmVhKCl7dmFyIHRlPWVsdChcInRleHRhcmVhXCIsbnVsbCxudWxsLFwicG9zaXRpb246IGFic29sdXRlOyBib3R0b206IC0xZW07IHBhZGRpbmc6IDA7IHdpZHRoOiAxcHg7IGhlaWdodDogMWVtOyBvdXRsaW5lOiBub25lXCIpO3ZhciBkaXY9ZWx0KFwiZGl2XCIsW3RlXSxudWxsLFwib3ZlcmZsb3c6IGhpZGRlbjsgcG9zaXRpb246IHJlbGF0aXZlOyB3aWR0aDogM3B4OyBoZWlnaHQ6IDBweDtcIik7Ly8gVGhlIHRleHRhcmVhIGlzIGtlcHQgcG9zaXRpb25lZCBuZWFyIHRoZSBjdXJzb3IgdG8gcHJldmVudCB0aGVcbi8vIGZhY3QgdGhhdCBpdCdsbCBiZSBzY3JvbGxlZCBpbnRvIHZpZXcgb24gaW5wdXQgZnJvbSBzY3JvbGxpbmdcbi8vIG91ciBmYWtlIGN1cnNvciBvdXQgb2Ygdmlldy4gT24gd2Via2l0LCB3aGVuIHdyYXA9b2ZmLCBwYXN0ZSBpc1xuLy8gdmVyeSBzbG93LiBTbyBtYWtlIHRoZSBhcmVhIHdpZGUgaW5zdGVhZC5cbmlmKHdlYmtpdCl7dGUuc3R5bGUud2lkdGg9XCIxMDAwcHhcIjt9ZWxzZXt0ZS5zZXRBdHRyaWJ1dGUoXCJ3cmFwXCIsXCJvZmZcIik7fS8vIElmIGJvcmRlcjogMDsgLS0gaU9TIGZhaWxzIHRvIG9wZW4ga2V5Ym9hcmQgKGlzc3VlICMxMjg3KVxuaWYoaW9zKXt0ZS5zdHlsZS5ib3JkZXI9XCIxcHggc29saWQgYmxhY2tcIjt9ZGlzYWJsZUJyb3dzZXJNYWdpYyh0ZSk7cmV0dXJuIGRpdjt9Ly8gVGhlIHB1YmxpY2x5IHZpc2libGUgQVBJLiBOb3RlIHRoYXQgbWV0aG9kT3AoZikgbWVhbnNcbi8vICd3cmFwIGYgaW4gYW4gb3BlcmF0aW9uLCBwZXJmb3JtZWQgb24gaXRzIGB0aGlzYCBwYXJhbWV0ZXInLlxuLy8gVGhpcyBpcyBub3QgdGhlIGNvbXBsZXRlIHNldCBvZiBlZGl0b3IgbWV0aG9kcy4gTW9zdCBvZiB0aGVcbi8vIG1ldGhvZHMgZGVmaW5lZCBvbiB0aGUgRG9jIHR5cGUgYXJlIGFsc28gaW5qZWN0ZWQgaW50b1xuLy8gQ29kZU1pcnJvci5wcm90b3R5cGUsIGZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSBhbmRcbi8vIGNvbnZlbmllbmNlLlxuZnVuY3Rpb24gYWRkRWRpdG9yTWV0aG9kcyhDb2RlTWlycm9yKXt2YXIgb3B0aW9uSGFuZGxlcnM9Q29kZU1pcnJvci5vcHRpb25IYW5kbGVyczt2YXIgaGVscGVycz1Db2RlTWlycm9yLmhlbHBlcnM9e307Q29kZU1pcnJvci5wcm90b3R5cGU9e2NvbnN0cnVjdG9yOkNvZGVNaXJyb3IsZm9jdXM6ZnVuY3Rpb24oKXt3aW5kb3cuZm9jdXMoKTt0aGlzLmRpc3BsYXkuaW5wdXQuZm9jdXMoKTt9LHNldE9wdGlvbjpmdW5jdGlvbihvcHRpb24sdmFsdWUpe3ZhciBvcHRpb25zPXRoaXMub3B0aW9ucyxvbGQ9b3B0aW9uc1tvcHRpb25dO2lmKG9wdGlvbnNbb3B0aW9uXT09dmFsdWUmJm9wdGlvbiE9XCJtb2RlXCIpe3JldHVybjt9b3B0aW9uc1tvcHRpb25dPXZhbHVlO2lmKG9wdGlvbkhhbmRsZXJzLmhhc093blByb3BlcnR5KG9wdGlvbikpe29wZXJhdGlvbih0aGlzLG9wdGlvbkhhbmRsZXJzW29wdGlvbl0pKHRoaXMsdmFsdWUsb2xkKTt9fSxnZXRPcHRpb246ZnVuY3Rpb24ob3B0aW9uKXtyZXR1cm4gdGhpcy5vcHRpb25zW29wdGlvbl07fSxnZXREb2M6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb2M7fSxhZGRLZXlNYXA6ZnVuY3Rpb24obWFwLGJvdHRvbSl7dGhpcy5zdGF0ZS5rZXlNYXBzW2JvdHRvbT9cInB1c2hcIjpcInVuc2hpZnRcIl0oZ2V0S2V5TWFwKG1hcCkpO30scmVtb3ZlS2V5TWFwOmZ1bmN0aW9uKG1hcCl7dmFyIG1hcHM9dGhpcy5zdGF0ZS5rZXlNYXBzO2Zvcih2YXIgaT0wO2k8bWFwcy5sZW5ndGg7KytpKXtpZihtYXBzW2ldPT1tYXB8fG1hcHNbaV0ubmFtZT09bWFwKXttYXBzLnNwbGljZShpLDEpO3JldHVybiB0cnVlO319fSxhZGRPdmVybGF5Om1ldGhvZE9wKGZ1bmN0aW9uKHNwZWMsb3B0aW9ucyl7dmFyIG1vZGU9c3BlYy50b2tlbj9zcGVjOkNvZGVNaXJyb3IuZ2V0TW9kZSh0aGlzLm9wdGlvbnMsc3BlYyk7aWYobW9kZS5zdGFydFN0YXRlKXt0aHJvdyBuZXcgRXJyb3IoXCJPdmVybGF5cyBtYXkgbm90IGJlIHN0YXRlZnVsLlwiKTt9aW5zZXJ0U29ydGVkKHRoaXMuc3RhdGUub3ZlcmxheXMse21vZGU6bW9kZSxtb2RlU3BlYzpzcGVjLG9wYXF1ZTpvcHRpb25zJiZvcHRpb25zLm9wYXF1ZSxwcmlvcml0eTpvcHRpb25zJiZvcHRpb25zLnByaW9yaXR5fHwwfSxmdW5jdGlvbihvdmVybGF5KXtyZXR1cm4gb3ZlcmxheS5wcmlvcml0eTt9KTt0aGlzLnN0YXRlLm1vZGVHZW4rKztyZWdDaGFuZ2UodGhpcyk7fSkscmVtb3ZlT3ZlcmxheTptZXRob2RPcChmdW5jdGlvbihzcGVjKXt2YXIgdGhpcyQxPXRoaXM7dmFyIG92ZXJsYXlzPXRoaXMuc3RhdGUub3ZlcmxheXM7Zm9yKHZhciBpPTA7aTxvdmVybGF5cy5sZW5ndGg7KytpKXt2YXIgY3VyPW92ZXJsYXlzW2ldLm1vZGVTcGVjO2lmKGN1cj09c3BlY3x8dHlwZW9mIHNwZWM9PVwic3RyaW5nXCImJmN1ci5uYW1lPT1zcGVjKXtvdmVybGF5cy5zcGxpY2UoaSwxKTt0aGlzJDEuc3RhdGUubW9kZUdlbisrO3JlZ0NoYW5nZSh0aGlzJDEpO3JldHVybjt9fX0pLGluZGVudExpbmU6bWV0aG9kT3AoZnVuY3Rpb24obixkaXIsYWdncmVzc2l2ZSl7aWYodHlwZW9mIGRpciE9XCJzdHJpbmdcIiYmdHlwZW9mIGRpciE9XCJudW1iZXJcIil7aWYoZGlyPT1udWxsKXtkaXI9dGhpcy5vcHRpb25zLnNtYXJ0SW5kZW50P1wic21hcnRcIjpcInByZXZcIjt9ZWxzZXtkaXI9ZGlyP1wiYWRkXCI6XCJzdWJ0cmFjdFwiO319aWYoaXNMaW5lKHRoaXMuZG9jLG4pKXtpbmRlbnRMaW5lKHRoaXMsbixkaXIsYWdncmVzc2l2ZSk7fX0pLGluZGVudFNlbGVjdGlvbjptZXRob2RPcChmdW5jdGlvbihob3cpe3ZhciB0aGlzJDE9dGhpczt2YXIgcmFuZ2VzPXRoaXMuZG9jLnNlbC5yYW5nZXMsZW5kPS0xO2Zvcih2YXIgaT0wO2k8cmFuZ2VzLmxlbmd0aDtpKyspe3ZhciByYW5nZT1yYW5nZXNbaV07aWYoIXJhbmdlLmVtcHR5KCkpe3ZhciBmcm9tPXJhbmdlLmZyb20oKSx0bz1yYW5nZS50bygpO3ZhciBzdGFydD1NYXRoLm1heChlbmQsZnJvbS5saW5lKTtlbmQ9TWF0aC5taW4odGhpcyQxLmxhc3RMaW5lKCksdG8ubGluZS0odG8uY2g/MDoxKSkrMTtmb3IodmFyIGo9c3RhcnQ7ajxlbmQ7KytqKXtpbmRlbnRMaW5lKHRoaXMkMSxqLGhvdyk7fXZhciBuZXdSYW5nZXM9dGhpcyQxLmRvYy5zZWwucmFuZ2VzO2lmKGZyb20uY2g9PTAmJnJhbmdlcy5sZW5ndGg9PW5ld1Jhbmdlcy5sZW5ndGgmJm5ld1Jhbmdlc1tpXS5mcm9tKCkuY2g+MCl7cmVwbGFjZU9uZVNlbGVjdGlvbih0aGlzJDEuZG9jLGksbmV3IFJhbmdlKGZyb20sbmV3UmFuZ2VzW2ldLnRvKCkpLHNlbF9kb250U2Nyb2xsKTt9fWVsc2UgaWYocmFuZ2UuaGVhZC5saW5lPmVuZCl7aW5kZW50TGluZSh0aGlzJDEscmFuZ2UuaGVhZC5saW5lLGhvdyx0cnVlKTtlbmQ9cmFuZ2UuaGVhZC5saW5lO2lmKGk9PXRoaXMkMS5kb2Muc2VsLnByaW1JbmRleCl7ZW5zdXJlQ3Vyc29yVmlzaWJsZSh0aGlzJDEpO319fX0pLC8vIEZldGNoIHRoZSBwYXJzZXIgdG9rZW4gZm9yIGEgZ2l2ZW4gY2hhcmFjdGVyLiBVc2VmdWwgZm9yIGhhY2tzXG4vLyB0aGF0IHdhbnQgdG8gaW5zcGVjdCB0aGUgbW9kZSBzdGF0ZSAoc2F5LCBmb3IgY29tcGxldGlvbikuXG5nZXRUb2tlbkF0OmZ1bmN0aW9uKHBvcyxwcmVjaXNlKXtyZXR1cm4gdGFrZVRva2VuKHRoaXMscG9zLHByZWNpc2UpO30sZ2V0TGluZVRva2VuczpmdW5jdGlvbihsaW5lLHByZWNpc2Upe3JldHVybiB0YWtlVG9rZW4odGhpcyxQb3MobGluZSkscHJlY2lzZSx0cnVlKTt9LGdldFRva2VuVHlwZUF0OmZ1bmN0aW9uKHBvcyl7cG9zPWNsaXBQb3ModGhpcy5kb2MscG9zKTt2YXIgc3R5bGVzPWdldExpbmVTdHlsZXModGhpcyxnZXRMaW5lKHRoaXMuZG9jLHBvcy5saW5lKSk7dmFyIGJlZm9yZT0wLGFmdGVyPShzdHlsZXMubGVuZ3RoLTEpLzIsY2g9cG9zLmNoO3ZhciB0eXBlO2lmKGNoPT0wKXt0eXBlPXN0eWxlc1syXTt9ZWxzZXtmb3IoOzspe3ZhciBtaWQ9YmVmb3JlK2FmdGVyPj4xO2lmKChtaWQ/c3R5bGVzW21pZCoyLTFdOjApPj1jaCl7YWZ0ZXI9bWlkO31lbHNlIGlmKHN0eWxlc1ttaWQqMisxXTxjaCl7YmVmb3JlPW1pZCsxO31lbHNle3R5cGU9c3R5bGVzW21pZCoyKzJdO2JyZWFrO319fXZhciBjdXQ9dHlwZT90eXBlLmluZGV4T2YoXCJvdmVybGF5IFwiKTotMTtyZXR1cm4gY3V0PDA/dHlwZTpjdXQ9PTA/bnVsbDp0eXBlLnNsaWNlKDAsY3V0LTEpO30sZ2V0TW9kZUF0OmZ1bmN0aW9uKHBvcyl7dmFyIG1vZGU9dGhpcy5kb2MubW9kZTtpZighbW9kZS5pbm5lck1vZGUpe3JldHVybiBtb2RlO31yZXR1cm4gQ29kZU1pcnJvci5pbm5lck1vZGUobW9kZSx0aGlzLmdldFRva2VuQXQocG9zKS5zdGF0ZSkubW9kZTt9LGdldEhlbHBlcjpmdW5jdGlvbihwb3MsdHlwZSl7cmV0dXJuIHRoaXMuZ2V0SGVscGVycyhwb3MsdHlwZSlbMF07fSxnZXRIZWxwZXJzOmZ1bmN0aW9uKHBvcyx0eXBlKXt2YXIgdGhpcyQxPXRoaXM7dmFyIGZvdW5kPVtdO2lmKCFoZWxwZXJzLmhhc093blByb3BlcnR5KHR5cGUpKXtyZXR1cm4gZm91bmQ7fXZhciBoZWxwPWhlbHBlcnNbdHlwZV0sbW9kZT10aGlzLmdldE1vZGVBdChwb3MpO2lmKHR5cGVvZiBtb2RlW3R5cGVdPT1cInN0cmluZ1wiKXtpZihoZWxwW21vZGVbdHlwZV1dKXtmb3VuZC5wdXNoKGhlbHBbbW9kZVt0eXBlXV0pO319ZWxzZSBpZihtb2RlW3R5cGVdKXtmb3IodmFyIGk9MDtpPG1vZGVbdHlwZV0ubGVuZ3RoO2krKyl7dmFyIHZhbD1oZWxwW21vZGVbdHlwZV1baV1dO2lmKHZhbCl7Zm91bmQucHVzaCh2YWwpO319fWVsc2UgaWYobW9kZS5oZWxwZXJUeXBlJiZoZWxwW21vZGUuaGVscGVyVHlwZV0pe2ZvdW5kLnB1c2goaGVscFttb2RlLmhlbHBlclR5cGVdKTt9ZWxzZSBpZihoZWxwW21vZGUubmFtZV0pe2ZvdW5kLnB1c2goaGVscFttb2RlLm5hbWVdKTt9Zm9yKHZhciBpJDE9MDtpJDE8aGVscC5fZ2xvYmFsLmxlbmd0aDtpJDErKyl7dmFyIGN1cj1oZWxwLl9nbG9iYWxbaSQxXTtpZihjdXIucHJlZChtb2RlLHRoaXMkMSkmJmluZGV4T2YoZm91bmQsY3VyLnZhbCk9PS0xKXtmb3VuZC5wdXNoKGN1ci52YWwpO319cmV0dXJuIGZvdW5kO30sZ2V0U3RhdGVBZnRlcjpmdW5jdGlvbihsaW5lLHByZWNpc2Upe3ZhciBkb2M9dGhpcy5kb2M7bGluZT1jbGlwTGluZShkb2MsbGluZT09bnVsbD9kb2MuZmlyc3QrZG9jLnNpemUtMTpsaW5lKTtyZXR1cm4gZ2V0U3RhdGVCZWZvcmUodGhpcyxsaW5lKzEscHJlY2lzZSk7fSxjdXJzb3JDb29yZHM6ZnVuY3Rpb24oc3RhcnQsbW9kZSl7dmFyIHBvcyxyYW5nZT10aGlzLmRvYy5zZWwucHJpbWFyeSgpO2lmKHN0YXJ0PT1udWxsKXtwb3M9cmFuZ2UuaGVhZDt9ZWxzZSBpZih0eXBlb2Ygc3RhcnQ9PVwib2JqZWN0XCIpe3Bvcz1jbGlwUG9zKHRoaXMuZG9jLHN0YXJ0KTt9ZWxzZXtwb3M9c3RhcnQ/cmFuZ2UuZnJvbSgpOnJhbmdlLnRvKCk7fXJldHVybiBjdXJzb3JDb29yZHModGhpcyxwb3MsbW9kZXx8XCJwYWdlXCIpO30sY2hhckNvb3JkczpmdW5jdGlvbihwb3MsbW9kZSl7cmV0dXJuIGNoYXJDb29yZHModGhpcyxjbGlwUG9zKHRoaXMuZG9jLHBvcyksbW9kZXx8XCJwYWdlXCIpO30sY29vcmRzQ2hhcjpmdW5jdGlvbihjb29yZHMsbW9kZSl7Y29vcmRzPWZyb21Db29yZFN5c3RlbSh0aGlzLGNvb3Jkcyxtb2RlfHxcInBhZ2VcIik7cmV0dXJuIGNvb3Jkc0NoYXIodGhpcyxjb29yZHMubGVmdCxjb29yZHMudG9wKTt9LGxpbmVBdEhlaWdodDpmdW5jdGlvbihoZWlnaHQsbW9kZSl7aGVpZ2h0PWZyb21Db29yZFN5c3RlbSh0aGlzLHt0b3A6aGVpZ2h0LGxlZnQ6MH0sbW9kZXx8XCJwYWdlXCIpLnRvcDtyZXR1cm4gbGluZUF0SGVpZ2h0KHRoaXMuZG9jLGhlaWdodCt0aGlzLmRpc3BsYXkudmlld09mZnNldCk7fSxoZWlnaHRBdExpbmU6ZnVuY3Rpb24obGluZSxtb2RlKXt2YXIgZW5kPWZhbHNlLGxpbmVPYmo7aWYodHlwZW9mIGxpbmU9PVwibnVtYmVyXCIpe3ZhciBsYXN0PXRoaXMuZG9jLmZpcnN0K3RoaXMuZG9jLnNpemUtMTtpZihsaW5lPHRoaXMuZG9jLmZpcnN0KXtsaW5lPXRoaXMuZG9jLmZpcnN0O31lbHNlIGlmKGxpbmU+bGFzdCl7bGluZT1sYXN0O2VuZD10cnVlO31saW5lT2JqPWdldExpbmUodGhpcy5kb2MsbGluZSk7fWVsc2V7bGluZU9iaj1saW5lO31yZXR1cm4gaW50b0Nvb3JkU3lzdGVtKHRoaXMsbGluZU9iaix7dG9wOjAsbGVmdDowfSxtb2RlfHxcInBhZ2VcIikudG9wKyhlbmQ/dGhpcy5kb2MuaGVpZ2h0LWhlaWdodEF0TGluZShsaW5lT2JqKTowKTt9LGRlZmF1bHRUZXh0SGVpZ2h0OmZ1bmN0aW9uKCl7cmV0dXJuIHRleHRIZWlnaHQodGhpcy5kaXNwbGF5KTt9LGRlZmF1bHRDaGFyV2lkdGg6ZnVuY3Rpb24oKXtyZXR1cm4gY2hhcldpZHRoKHRoaXMuZGlzcGxheSk7fSxzZXRHdXR0ZXJNYXJrZXI6bWV0aG9kT3AoZnVuY3Rpb24obGluZSxndXR0ZXJJRCx2YWx1ZSl7cmV0dXJuIGNoYW5nZUxpbmUodGhpcy5kb2MsbGluZSxcImd1dHRlclwiLGZ1bmN0aW9uKGxpbmUpe3ZhciBtYXJrZXJzPWxpbmUuZ3V0dGVyTWFya2Vyc3x8KGxpbmUuZ3V0dGVyTWFya2Vycz17fSk7bWFya2Vyc1tndXR0ZXJJRF09dmFsdWU7aWYoIXZhbHVlJiZpc0VtcHR5KG1hcmtlcnMpKXtsaW5lLmd1dHRlck1hcmtlcnM9bnVsbDt9cmV0dXJuIHRydWU7fSk7fSksY2xlYXJHdXR0ZXI6bWV0aG9kT3AoZnVuY3Rpb24oZ3V0dGVySUQpe3ZhciB0aGlzJDE9dGhpczt2YXIgZG9jPXRoaXMuZG9jLGk9ZG9jLmZpcnN0O2RvYy5pdGVyKGZ1bmN0aW9uKGxpbmUpe2lmKGxpbmUuZ3V0dGVyTWFya2VycyYmbGluZS5ndXR0ZXJNYXJrZXJzW2d1dHRlcklEXSl7bGluZS5ndXR0ZXJNYXJrZXJzW2d1dHRlcklEXT1udWxsO3JlZ0xpbmVDaGFuZ2UodGhpcyQxLGksXCJndXR0ZXJcIik7aWYoaXNFbXB0eShsaW5lLmd1dHRlck1hcmtlcnMpKXtsaW5lLmd1dHRlck1hcmtlcnM9bnVsbDt9fSsraTt9KTt9KSxsaW5lSW5mbzpmdW5jdGlvbihsaW5lKXt2YXIgbjtpZih0eXBlb2YgbGluZT09XCJudW1iZXJcIil7aWYoIWlzTGluZSh0aGlzLmRvYyxsaW5lKSl7cmV0dXJuIG51bGw7fW49bGluZTtsaW5lPWdldExpbmUodGhpcy5kb2MsbGluZSk7aWYoIWxpbmUpe3JldHVybiBudWxsO319ZWxzZXtuPWxpbmVObyhsaW5lKTtpZihuPT1udWxsKXtyZXR1cm4gbnVsbDt9fXJldHVybntsaW5lOm4saGFuZGxlOmxpbmUsdGV4dDpsaW5lLnRleHQsZ3V0dGVyTWFya2VyczpsaW5lLmd1dHRlck1hcmtlcnMsdGV4dENsYXNzOmxpbmUudGV4dENsYXNzLGJnQ2xhc3M6bGluZS5iZ0NsYXNzLHdyYXBDbGFzczpsaW5lLndyYXBDbGFzcyx3aWRnZXRzOmxpbmUud2lkZ2V0c307fSxnZXRWaWV3cG9ydDpmdW5jdGlvbigpe3JldHVybntmcm9tOnRoaXMuZGlzcGxheS52aWV3RnJvbSx0bzp0aGlzLmRpc3BsYXkudmlld1RvfTt9LGFkZFdpZGdldDpmdW5jdGlvbihwb3Msbm9kZSxzY3JvbGwsdmVydCxob3Jpeil7dmFyIGRpc3BsYXk9dGhpcy5kaXNwbGF5O3Bvcz1jdXJzb3JDb29yZHModGhpcyxjbGlwUG9zKHRoaXMuZG9jLHBvcykpO3ZhciB0b3A9cG9zLmJvdHRvbSxsZWZ0PXBvcy5sZWZ0O25vZGUuc3R5bGUucG9zaXRpb249XCJhYnNvbHV0ZVwiO25vZGUuc2V0QXR0cmlidXRlKFwiY20taWdub3JlLWV2ZW50c1wiLFwidHJ1ZVwiKTt0aGlzLmRpc3BsYXkuaW5wdXQuc2V0VW5lZGl0YWJsZShub2RlKTtkaXNwbGF5LnNpemVyLmFwcGVuZENoaWxkKG5vZGUpO2lmKHZlcnQ9PVwib3ZlclwiKXt0b3A9cG9zLnRvcDt9ZWxzZSBpZih2ZXJ0PT1cImFib3ZlXCJ8fHZlcnQ9PVwibmVhclwiKXt2YXIgdnNwYWNlPU1hdGgubWF4KGRpc3BsYXkud3JhcHBlci5jbGllbnRIZWlnaHQsdGhpcy5kb2MuaGVpZ2h0KSxoc3BhY2U9TWF0aC5tYXgoZGlzcGxheS5zaXplci5jbGllbnRXaWR0aCxkaXNwbGF5LmxpbmVTcGFjZS5jbGllbnRXaWR0aCk7Ly8gRGVmYXVsdCB0byBwb3NpdGlvbmluZyBhYm92ZSAoaWYgc3BlY2lmaWVkIGFuZCBwb3NzaWJsZSk7IG90aGVyd2lzZSBkZWZhdWx0IHRvIHBvc2l0aW9uaW5nIGJlbG93XG5pZigodmVydD09J2Fib3ZlJ3x8cG9zLmJvdHRvbStub2RlLm9mZnNldEhlaWdodD52c3BhY2UpJiZwb3MudG9wPm5vZGUub2Zmc2V0SGVpZ2h0KXt0b3A9cG9zLnRvcC1ub2RlLm9mZnNldEhlaWdodDt9ZWxzZSBpZihwb3MuYm90dG9tK25vZGUub2Zmc2V0SGVpZ2h0PD12c3BhY2Upe3RvcD1wb3MuYm90dG9tO31pZihsZWZ0K25vZGUub2Zmc2V0V2lkdGg+aHNwYWNlKXtsZWZ0PWhzcGFjZS1ub2RlLm9mZnNldFdpZHRoO319bm9kZS5zdHlsZS50b3A9dG9wK1wicHhcIjtub2RlLnN0eWxlLmxlZnQ9bm9kZS5zdHlsZS5yaWdodD1cIlwiO2lmKGhvcml6PT1cInJpZ2h0XCIpe2xlZnQ9ZGlzcGxheS5zaXplci5jbGllbnRXaWR0aC1ub2RlLm9mZnNldFdpZHRoO25vZGUuc3R5bGUucmlnaHQ9XCIwcHhcIjt9ZWxzZXtpZihob3Jpej09XCJsZWZ0XCIpe2xlZnQ9MDt9ZWxzZSBpZihob3Jpej09XCJtaWRkbGVcIil7bGVmdD0oZGlzcGxheS5zaXplci5jbGllbnRXaWR0aC1ub2RlLm9mZnNldFdpZHRoKS8yO31ub2RlLnN0eWxlLmxlZnQ9bGVmdCtcInB4XCI7fWlmKHNjcm9sbCl7c2Nyb2xsSW50b1ZpZXcodGhpcyxsZWZ0LHRvcCxsZWZ0K25vZGUub2Zmc2V0V2lkdGgsdG9wK25vZGUub2Zmc2V0SGVpZ2h0KTt9fSx0cmlnZ2VyT25LZXlEb3duOm1ldGhvZE9wKG9uS2V5RG93biksdHJpZ2dlck9uS2V5UHJlc3M6bWV0aG9kT3Aob25LZXlQcmVzcyksdHJpZ2dlck9uS2V5VXA6b25LZXlVcCxleGVjQ29tbWFuZDpmdW5jdGlvbihjbWQpe2lmKGNvbW1hbmRzLmhhc093blByb3BlcnR5KGNtZCkpe3JldHVybiBjb21tYW5kc1tjbWRdLmNhbGwobnVsbCx0aGlzKTt9fSx0cmlnZ2VyRWxlY3RyaWM6bWV0aG9kT3AoZnVuY3Rpb24odGV4dCl7dHJpZ2dlckVsZWN0cmljKHRoaXMsdGV4dCk7fSksZmluZFBvc0g6ZnVuY3Rpb24oZnJvbSxhbW91bnQsdW5pdCx2aXN1YWxseSl7dmFyIHRoaXMkMT10aGlzO3ZhciBkaXI9MTtpZihhbW91bnQ8MCl7ZGlyPS0xO2Ftb3VudD0tYW1vdW50O312YXIgY3VyPWNsaXBQb3ModGhpcy5kb2MsZnJvbSk7Zm9yKHZhciBpPTA7aTxhbW91bnQ7KytpKXtjdXI9ZmluZFBvc0godGhpcyQxLmRvYyxjdXIsZGlyLHVuaXQsdmlzdWFsbHkpO2lmKGN1ci5oaXRTaWRlKXticmVhazt9fXJldHVybiBjdXI7fSxtb3ZlSDptZXRob2RPcChmdW5jdGlvbihkaXIsdW5pdCl7dmFyIHRoaXMkMT10aGlzO3RoaXMuZXh0ZW5kU2VsZWN0aW9uc0J5KGZ1bmN0aW9uKHJhbmdlKXtpZih0aGlzJDEuZGlzcGxheS5zaGlmdHx8dGhpcyQxLmRvYy5leHRlbmR8fHJhbmdlLmVtcHR5KCkpe3JldHVybiBmaW5kUG9zSCh0aGlzJDEuZG9jLHJhbmdlLmhlYWQsZGlyLHVuaXQsdGhpcyQxLm9wdGlvbnMucnRsTW92ZVZpc3VhbGx5KTt9ZWxzZXtyZXR1cm4gZGlyPDA/cmFuZ2UuZnJvbSgpOnJhbmdlLnRvKCk7fX0sc2VsX21vdmUpO30pLGRlbGV0ZUg6bWV0aG9kT3AoZnVuY3Rpb24oZGlyLHVuaXQpe3ZhciBzZWw9dGhpcy5kb2Muc2VsLGRvYz10aGlzLmRvYztpZihzZWwuc29tZXRoaW5nU2VsZWN0ZWQoKSl7ZG9jLnJlcGxhY2VTZWxlY3Rpb24oXCJcIixudWxsLFwiK2RlbGV0ZVwiKTt9ZWxzZXtkZWxldGVOZWFyU2VsZWN0aW9uKHRoaXMsZnVuY3Rpb24ocmFuZ2Upe3ZhciBvdGhlcj1maW5kUG9zSChkb2MscmFuZ2UuaGVhZCxkaXIsdW5pdCxmYWxzZSk7cmV0dXJuIGRpcjwwP3tmcm9tOm90aGVyLHRvOnJhbmdlLmhlYWR9Ontmcm9tOnJhbmdlLmhlYWQsdG86b3RoZXJ9O30pO319KSxmaW5kUG9zVjpmdW5jdGlvbihmcm9tLGFtb3VudCx1bml0LGdvYWxDb2x1bW4pe3ZhciB0aGlzJDE9dGhpczt2YXIgZGlyPTEseD1nb2FsQ29sdW1uO2lmKGFtb3VudDwwKXtkaXI9LTE7YW1vdW50PS1hbW91bnQ7fXZhciBjdXI9Y2xpcFBvcyh0aGlzLmRvYyxmcm9tKTtmb3IodmFyIGk9MDtpPGFtb3VudDsrK2kpe3ZhciBjb29yZHM9Y3Vyc29yQ29vcmRzKHRoaXMkMSxjdXIsXCJkaXZcIik7aWYoeD09bnVsbCl7eD1jb29yZHMubGVmdDt9ZWxzZXtjb29yZHMubGVmdD14O31jdXI9ZmluZFBvc1YodGhpcyQxLGNvb3JkcyxkaXIsdW5pdCk7aWYoY3VyLmhpdFNpZGUpe2JyZWFrO319cmV0dXJuIGN1cjt9LG1vdmVWOm1ldGhvZE9wKGZ1bmN0aW9uKGRpcix1bml0KXt2YXIgdGhpcyQxPXRoaXM7dmFyIGRvYz10aGlzLmRvYyxnb2Fscz1bXTt2YXIgY29sbGFwc2U9IXRoaXMuZGlzcGxheS5zaGlmdCYmIWRvYy5leHRlbmQmJmRvYy5zZWwuc29tZXRoaW5nU2VsZWN0ZWQoKTtkb2MuZXh0ZW5kU2VsZWN0aW9uc0J5KGZ1bmN0aW9uKHJhbmdlKXtpZihjb2xsYXBzZSl7cmV0dXJuIGRpcjwwP3JhbmdlLmZyb20oKTpyYW5nZS50bygpO312YXIgaGVhZFBvcz1jdXJzb3JDb29yZHModGhpcyQxLHJhbmdlLmhlYWQsXCJkaXZcIik7aWYocmFuZ2UuZ29hbENvbHVtbiE9bnVsbCl7aGVhZFBvcy5sZWZ0PXJhbmdlLmdvYWxDb2x1bW47fWdvYWxzLnB1c2goaGVhZFBvcy5sZWZ0KTt2YXIgcG9zPWZpbmRQb3NWKHRoaXMkMSxoZWFkUG9zLGRpcix1bml0KTtpZih1bml0PT1cInBhZ2VcIiYmcmFuZ2U9PWRvYy5zZWwucHJpbWFyeSgpKXthZGRUb1Njcm9sbFBvcyh0aGlzJDEsbnVsbCxjaGFyQ29vcmRzKHRoaXMkMSxwb3MsXCJkaXZcIikudG9wLWhlYWRQb3MudG9wKTt9cmV0dXJuIHBvczt9LHNlbF9tb3ZlKTtpZihnb2Fscy5sZW5ndGgpe2Zvcih2YXIgaT0wO2k8ZG9jLnNlbC5yYW5nZXMubGVuZ3RoO2krKyl7ZG9jLnNlbC5yYW5nZXNbaV0uZ29hbENvbHVtbj1nb2Fsc1tpXTt9fX0pLC8vIEZpbmQgdGhlIHdvcmQgYXQgdGhlIGdpdmVuIHBvc2l0aW9uIChhcyByZXR1cm5lZCBieSBjb29yZHNDaGFyKS5cbmZpbmRXb3JkQXQ6ZnVuY3Rpb24ocG9zKXt2YXIgZG9jPXRoaXMuZG9jLGxpbmU9Z2V0TGluZShkb2MscG9zLmxpbmUpLnRleHQ7dmFyIHN0YXJ0PXBvcy5jaCxlbmQ9cG9zLmNoO2lmKGxpbmUpe3ZhciBoZWxwZXI9dGhpcy5nZXRIZWxwZXIocG9zLFwid29yZENoYXJzXCIpO2lmKChwb3MueFJlbDwwfHxlbmQ9PWxpbmUubGVuZ3RoKSYmc3RhcnQpey0tc3RhcnQ7fWVsc2V7KytlbmQ7fXZhciBzdGFydENoYXI9bGluZS5jaGFyQXQoc3RhcnQpO3ZhciBjaGVjaz1pc1dvcmRDaGFyKHN0YXJ0Q2hhcixoZWxwZXIpP2Z1bmN0aW9uKGNoKXtyZXR1cm4gaXNXb3JkQ2hhcihjaCxoZWxwZXIpO306L1xccy8udGVzdChzdGFydENoYXIpP2Z1bmN0aW9uKGNoKXtyZXR1cm4gL1xccy8udGVzdChjaCk7fTpmdW5jdGlvbihjaCl7cmV0dXJuIS9cXHMvLnRlc3QoY2gpJiYhaXNXb3JkQ2hhcihjaCk7fTt3aGlsZShzdGFydD4wJiZjaGVjayhsaW5lLmNoYXJBdChzdGFydC0xKSkpey0tc3RhcnQ7fXdoaWxlKGVuZDxsaW5lLmxlbmd0aCYmY2hlY2sobGluZS5jaGFyQXQoZW5kKSkpeysrZW5kO319cmV0dXJuIG5ldyBSYW5nZShQb3MocG9zLmxpbmUsc3RhcnQpLFBvcyhwb3MubGluZSxlbmQpKTt9LHRvZ2dsZU92ZXJ3cml0ZTpmdW5jdGlvbih2YWx1ZSl7aWYodmFsdWUhPW51bGwmJnZhbHVlPT10aGlzLnN0YXRlLm92ZXJ3cml0ZSl7cmV0dXJuO31pZih0aGlzLnN0YXRlLm92ZXJ3cml0ZT0hdGhpcy5zdGF0ZS5vdmVyd3JpdGUpe2FkZENsYXNzKHRoaXMuZGlzcGxheS5jdXJzb3JEaXYsXCJDb2RlTWlycm9yLW92ZXJ3cml0ZVwiKTt9ZWxzZXtybUNsYXNzKHRoaXMuZGlzcGxheS5jdXJzb3JEaXYsXCJDb2RlTWlycm9yLW92ZXJ3cml0ZVwiKTt9c2lnbmFsKHRoaXMsXCJvdmVyd3JpdGVUb2dnbGVcIix0aGlzLHRoaXMuc3RhdGUub3ZlcndyaXRlKTt9LGhhc0ZvY3VzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGlzcGxheS5pbnB1dC5nZXRGaWVsZCgpPT1hY3RpdmVFbHQoKTt9LGlzUmVhZE9ubHk6ZnVuY3Rpb24oKXtyZXR1cm4hISh0aGlzLm9wdGlvbnMucmVhZE9ubHl8fHRoaXMuZG9jLmNhbnRFZGl0KTt9LHNjcm9sbFRvOm1ldGhvZE9wKGZ1bmN0aW9uKHgseSl7aWYoeCE9bnVsbHx8eSE9bnVsbCl7cmVzb2x2ZVNjcm9sbFRvUG9zKHRoaXMpO31pZih4IT1udWxsKXt0aGlzLmN1ck9wLnNjcm9sbExlZnQ9eDt9aWYoeSE9bnVsbCl7dGhpcy5jdXJPcC5zY3JvbGxUb3A9eTt9fSksZ2V0U2Nyb2xsSW5mbzpmdW5jdGlvbigpe3ZhciBzY3JvbGxlcj10aGlzLmRpc3BsYXkuc2Nyb2xsZXI7cmV0dXJue2xlZnQ6c2Nyb2xsZXIuc2Nyb2xsTGVmdCx0b3A6c2Nyb2xsZXIuc2Nyb2xsVG9wLGhlaWdodDpzY3JvbGxlci5zY3JvbGxIZWlnaHQtc2Nyb2xsR2FwKHRoaXMpLXRoaXMuZGlzcGxheS5iYXJIZWlnaHQsd2lkdGg6c2Nyb2xsZXIuc2Nyb2xsV2lkdGgtc2Nyb2xsR2FwKHRoaXMpLXRoaXMuZGlzcGxheS5iYXJXaWR0aCxjbGllbnRIZWlnaHQ6ZGlzcGxheUhlaWdodCh0aGlzKSxjbGllbnRXaWR0aDpkaXNwbGF5V2lkdGgodGhpcyl9O30sc2Nyb2xsSW50b1ZpZXc6bWV0aG9kT3AoZnVuY3Rpb24ocmFuZ2UsbWFyZ2luKXtpZihyYW5nZT09bnVsbCl7cmFuZ2U9e2Zyb206dGhpcy5kb2Muc2VsLnByaW1hcnkoKS5oZWFkLHRvOm51bGx9O2lmKG1hcmdpbj09bnVsbCl7bWFyZ2luPXRoaXMub3B0aW9ucy5jdXJzb3JTY3JvbGxNYXJnaW47fX1lbHNlIGlmKHR5cGVvZiByYW5nZT09XCJudW1iZXJcIil7cmFuZ2U9e2Zyb206UG9zKHJhbmdlLDApLHRvOm51bGx9O31lbHNlIGlmKHJhbmdlLmZyb209PW51bGwpe3JhbmdlPXtmcm9tOnJhbmdlLHRvOm51bGx9O31pZighcmFuZ2UudG8pe3JhbmdlLnRvPXJhbmdlLmZyb207fXJhbmdlLm1hcmdpbj1tYXJnaW58fDA7aWYocmFuZ2UuZnJvbS5saW5lIT1udWxsKXtyZXNvbHZlU2Nyb2xsVG9Qb3ModGhpcyk7dGhpcy5jdXJPcC5zY3JvbGxUb1Bvcz1yYW5nZTt9ZWxzZXt2YXIgc1Bvcz1jYWxjdWxhdGVTY3JvbGxQb3ModGhpcyxNYXRoLm1pbihyYW5nZS5mcm9tLmxlZnQscmFuZ2UudG8ubGVmdCksTWF0aC5taW4ocmFuZ2UuZnJvbS50b3AscmFuZ2UudG8udG9wKS1yYW5nZS5tYXJnaW4sTWF0aC5tYXgocmFuZ2UuZnJvbS5yaWdodCxyYW5nZS50by5yaWdodCksTWF0aC5tYXgocmFuZ2UuZnJvbS5ib3R0b20scmFuZ2UudG8uYm90dG9tKStyYW5nZS5tYXJnaW4pO3RoaXMuc2Nyb2xsVG8oc1Bvcy5zY3JvbGxMZWZ0LHNQb3Muc2Nyb2xsVG9wKTt9fSksc2V0U2l6ZTptZXRob2RPcChmdW5jdGlvbih3aWR0aCxoZWlnaHQpe3ZhciB0aGlzJDE9dGhpczt2YXIgaW50ZXJwcmV0PWZ1bmN0aW9uKHZhbCl7cmV0dXJuIHR5cGVvZiB2YWw9PVwibnVtYmVyXCJ8fC9eXFxkKyQvLnRlc3QoU3RyaW5nKHZhbCkpP3ZhbCtcInB4XCI6dmFsO307aWYod2lkdGghPW51bGwpe3RoaXMuZGlzcGxheS53cmFwcGVyLnN0eWxlLndpZHRoPWludGVycHJldCh3aWR0aCk7fWlmKGhlaWdodCE9bnVsbCl7dGhpcy5kaXNwbGF5LndyYXBwZXIuc3R5bGUuaGVpZ2h0PWludGVycHJldChoZWlnaHQpO31pZih0aGlzLm9wdGlvbnMubGluZVdyYXBwaW5nKXtjbGVhckxpbmVNZWFzdXJlbWVudENhY2hlKHRoaXMpO312YXIgbGluZU5vPXRoaXMuZGlzcGxheS52aWV3RnJvbTt0aGlzLmRvYy5pdGVyKGxpbmVObyx0aGlzLmRpc3BsYXkudmlld1RvLGZ1bmN0aW9uKGxpbmUpe2lmKGxpbmUud2lkZ2V0cyl7Zm9yKHZhciBpPTA7aTxsaW5lLndpZGdldHMubGVuZ3RoO2krKyl7aWYobGluZS53aWRnZXRzW2ldLm5vSFNjcm9sbCl7cmVnTGluZUNoYW5nZSh0aGlzJDEsbGluZU5vLFwid2lkZ2V0XCIpO2JyZWFrO319fSsrbGluZU5vO30pO3RoaXMuY3VyT3AuZm9yY2VVcGRhdGU9dHJ1ZTtzaWduYWwodGhpcyxcInJlZnJlc2hcIix0aGlzKTt9KSxvcGVyYXRpb246ZnVuY3Rpb24oZil7cmV0dXJuIHJ1bkluT3AodGhpcyxmKTt9LHJlZnJlc2g6bWV0aG9kT3AoZnVuY3Rpb24oKXt2YXIgb2xkSGVpZ2h0PXRoaXMuZGlzcGxheS5jYWNoZWRUZXh0SGVpZ2h0O3JlZ0NoYW5nZSh0aGlzKTt0aGlzLmN1ck9wLmZvcmNlVXBkYXRlPXRydWU7Y2xlYXJDYWNoZXModGhpcyk7dGhpcy5zY3JvbGxUbyh0aGlzLmRvYy5zY3JvbGxMZWZ0LHRoaXMuZG9jLnNjcm9sbFRvcCk7dXBkYXRlR3V0dGVyU3BhY2UodGhpcyk7aWYob2xkSGVpZ2h0PT1udWxsfHxNYXRoLmFicyhvbGRIZWlnaHQtdGV4dEhlaWdodCh0aGlzLmRpc3BsYXkpKT4uNSl7ZXN0aW1hdGVMaW5lSGVpZ2h0cyh0aGlzKTt9c2lnbmFsKHRoaXMsXCJyZWZyZXNoXCIsdGhpcyk7fSksc3dhcERvYzptZXRob2RPcChmdW5jdGlvbihkb2Mpe3ZhciBvbGQ9dGhpcy5kb2M7b2xkLmNtPW51bGw7YXR0YWNoRG9jKHRoaXMsZG9jKTtjbGVhckNhY2hlcyh0aGlzKTt0aGlzLmRpc3BsYXkuaW5wdXQucmVzZXQoKTt0aGlzLnNjcm9sbFRvKGRvYy5zY3JvbGxMZWZ0LGRvYy5zY3JvbGxUb3ApO3RoaXMuY3VyT3AuZm9yY2VTY3JvbGw9dHJ1ZTtzaWduYWxMYXRlcih0aGlzLFwic3dhcERvY1wiLHRoaXMsb2xkKTtyZXR1cm4gb2xkO30pLGdldElucHV0RmllbGQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kaXNwbGF5LmlucHV0LmdldEZpZWxkKCk7fSxnZXRXcmFwcGVyRWxlbWVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmRpc3BsYXkud3JhcHBlcjt9LGdldFNjcm9sbGVyRWxlbWVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmRpc3BsYXkuc2Nyb2xsZXI7fSxnZXRHdXR0ZXJFbGVtZW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGlzcGxheS5ndXR0ZXJzO319O2V2ZW50TWl4aW4oQ29kZU1pcnJvcik7Q29kZU1pcnJvci5yZWdpc3RlckhlbHBlcj1mdW5jdGlvbih0eXBlLG5hbWUsdmFsdWUpe2lmKCFoZWxwZXJzLmhhc093blByb3BlcnR5KHR5cGUpKXtoZWxwZXJzW3R5cGVdPUNvZGVNaXJyb3JbdHlwZV09e19nbG9iYWw6W119O31oZWxwZXJzW3R5cGVdW25hbWVdPXZhbHVlO307Q29kZU1pcnJvci5yZWdpc3Rlckdsb2JhbEhlbHBlcj1mdW5jdGlvbih0eXBlLG5hbWUscHJlZGljYXRlLHZhbHVlKXtDb2RlTWlycm9yLnJlZ2lzdGVySGVscGVyKHR5cGUsbmFtZSx2YWx1ZSk7aGVscGVyc1t0eXBlXS5fZ2xvYmFsLnB1c2goe3ByZWQ6cHJlZGljYXRlLHZhbDp2YWx1ZX0pO307fS8vIFVzZWQgZm9yIGhvcml6b250YWwgcmVsYXRpdmUgbW90aW9uLiBEaXIgaXMgLTEgb3IgMSAobGVmdCBvclxuLy8gcmlnaHQpLCB1bml0IGNhbiBiZSBcImNoYXJcIiwgXCJjb2x1bW5cIiAobGlrZSBjaGFyLCBidXQgZG9lc24ndFxuLy8gY3Jvc3MgbGluZSBib3VuZGFyaWVzKSwgXCJ3b3JkXCIgKGFjcm9zcyBuZXh0IHdvcmQpLCBvciBcImdyb3VwXCIgKHRvXG4vLyB0aGUgc3RhcnQgb2YgbmV4dCBncm91cCBvZiB3b3JkIG9yIG5vbi13b3JkLW5vbi13aGl0ZXNwYWNlXG4vLyBjaGFycykuIFRoZSB2aXN1YWxseSBwYXJhbSBjb250cm9scyB3aGV0aGVyLCBpbiByaWdodC10by1sZWZ0XG4vLyB0ZXh0LCBkaXJlY3Rpb24gMSBtZWFucyB0byBtb3ZlIHRvd2FyZHMgdGhlIG5leHQgaW5kZXggaW4gdGhlXG4vLyBzdHJpbmcsIG9yIHRvd2FyZHMgdGhlIGNoYXJhY3RlciB0byB0aGUgcmlnaHQgb2YgdGhlIGN1cnJlbnRcbi8vIHBvc2l0aW9uLiBUaGUgcmVzdWx0aW5nIHBvc2l0aW9uIHdpbGwgaGF2ZSBhIGhpdFNpZGU9dHJ1ZVxuLy8gcHJvcGVydHkgaWYgaXQgcmVhY2hlZCB0aGUgZW5kIG9mIHRoZSBkb2N1bWVudC5cbmZ1bmN0aW9uIGZpbmRQb3NIKGRvYyxwb3MsZGlyLHVuaXQsdmlzdWFsbHkpe3ZhciBsaW5lPXBvcy5saW5lLGNoPXBvcy5jaCxvcmlnRGlyPWRpcjt2YXIgbGluZU9iaj1nZXRMaW5lKGRvYyxsaW5lKTtmdW5jdGlvbiBmaW5kTmV4dExpbmUoKXt2YXIgbD1saW5lK2RpcjtpZihsPGRvYy5maXJzdHx8bD49ZG9jLmZpcnN0K2RvYy5zaXplKXtyZXR1cm4gZmFsc2U7fWxpbmU9bDtyZXR1cm4gbGluZU9iaj1nZXRMaW5lKGRvYyxsKTt9ZnVuY3Rpb24gbW92ZU9uY2UoYm91bmRUb0xpbmUpe3ZhciBuZXh0PSh2aXN1YWxseT9tb3ZlVmlzdWFsbHk6bW92ZUxvZ2ljYWxseSkobGluZU9iaixjaCxkaXIsdHJ1ZSk7aWYobmV4dD09bnVsbCl7aWYoIWJvdW5kVG9MaW5lJiZmaW5kTmV4dExpbmUoKSl7aWYodmlzdWFsbHkpe2NoPShkaXI8MD9saW5lUmlnaHQ6bGluZUxlZnQpKGxpbmVPYmopO31lbHNle2NoPWRpcjwwP2xpbmVPYmoudGV4dC5sZW5ndGg6MDt9fWVsc2V7cmV0dXJuIGZhbHNlO319ZWxzZXtjaD1uZXh0O31yZXR1cm4gdHJ1ZTt9aWYodW5pdD09XCJjaGFyXCIpe21vdmVPbmNlKCk7fWVsc2UgaWYodW5pdD09XCJjb2x1bW5cIil7bW92ZU9uY2UodHJ1ZSk7fWVsc2UgaWYodW5pdD09XCJ3b3JkXCJ8fHVuaXQ9PVwiZ3JvdXBcIil7dmFyIHNhd1R5cGU9bnVsbCxncm91cD11bml0PT1cImdyb3VwXCI7dmFyIGhlbHBlcj1kb2MuY20mJmRvYy5jbS5nZXRIZWxwZXIocG9zLFwid29yZENoYXJzXCIpO2Zvcih2YXIgZmlyc3Q9dHJ1ZTs7Zmlyc3Q9ZmFsc2Upe2lmKGRpcjwwJiYhbW92ZU9uY2UoIWZpcnN0KSl7YnJlYWs7fXZhciBjdXI9bGluZU9iai50ZXh0LmNoYXJBdChjaCl8fFwiXFxuXCI7dmFyIHR5cGU9aXNXb3JkQ2hhcihjdXIsaGVscGVyKT9cIndcIjpncm91cCYmY3VyPT1cIlxcblwiP1wiblwiOiFncm91cHx8L1xccy8udGVzdChjdXIpP251bGw6XCJwXCI7aWYoZ3JvdXAmJiFmaXJzdCYmIXR5cGUpe3R5cGU9XCJzXCI7fWlmKHNhd1R5cGUmJnNhd1R5cGUhPXR5cGUpe2lmKGRpcjwwKXtkaXI9MTttb3ZlT25jZSgpO31icmVhazt9aWYodHlwZSl7c2F3VHlwZT10eXBlO31pZihkaXI+MCYmIW1vdmVPbmNlKCFmaXJzdCkpe2JyZWFrO319fXZhciByZXN1bHQ9c2tpcEF0b21pYyhkb2MsUG9zKGxpbmUsY2gpLHBvcyxvcmlnRGlyLHRydWUpO2lmKCFjbXAocG9zLHJlc3VsdCkpe3Jlc3VsdC5oaXRTaWRlPXRydWU7fXJldHVybiByZXN1bHQ7fS8vIEZvciByZWxhdGl2ZSB2ZXJ0aWNhbCBtb3ZlbWVudC4gRGlyIG1heSBiZSAtMSBvciAxLiBVbml0IGNhbiBiZVxuLy8gXCJwYWdlXCIgb3IgXCJsaW5lXCIuIFRoZSByZXN1bHRpbmcgcG9zaXRpb24gd2lsbCBoYXZlIGEgaGl0U2lkZT10cnVlXG4vLyBwcm9wZXJ0eSBpZiBpdCByZWFjaGVkIHRoZSBlbmQgb2YgdGhlIGRvY3VtZW50LlxuZnVuY3Rpb24gZmluZFBvc1YoY20scG9zLGRpcix1bml0KXt2YXIgZG9jPWNtLmRvYyx4PXBvcy5sZWZ0LHk7aWYodW5pdD09XCJwYWdlXCIpe3ZhciBwYWdlU2l6ZT1NYXRoLm1pbihjbS5kaXNwbGF5LndyYXBwZXIuY2xpZW50SGVpZ2h0LHdpbmRvdy5pbm5lckhlaWdodHx8ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCk7dmFyIG1vdmVBbW91bnQ9TWF0aC5tYXgocGFnZVNpemUtLjUqdGV4dEhlaWdodChjbS5kaXNwbGF5KSwzKTt5PShkaXI+MD9wb3MuYm90dG9tOnBvcy50b3ApK2Rpciptb3ZlQW1vdW50O31lbHNlIGlmKHVuaXQ9PVwibGluZVwiKXt5PWRpcj4wP3Bvcy5ib3R0b20rMzpwb3MudG9wLTM7fXZhciB0YXJnZXQ7Zm9yKDs7KXt0YXJnZXQ9Y29vcmRzQ2hhcihjbSx4LHkpO2lmKCF0YXJnZXQub3V0c2lkZSl7YnJlYWs7fWlmKGRpcjwwP3k8PTA6eT49ZG9jLmhlaWdodCl7dGFyZ2V0LmhpdFNpZGU9dHJ1ZTticmVhazt9eSs9ZGlyKjU7fXJldHVybiB0YXJnZXQ7fS8vIENPTlRFTlRFRElUQUJMRSBJTlBVVCBTVFlMRVxuZnVuY3Rpb24gQ29udGVudEVkaXRhYmxlSW5wdXQoY20pe3RoaXMuY209Y207dGhpcy5sYXN0QW5jaG9yTm9kZT10aGlzLmxhc3RBbmNob3JPZmZzZXQ9dGhpcy5sYXN0Rm9jdXNOb2RlPXRoaXMubGFzdEZvY3VzT2Zmc2V0PW51bGw7dGhpcy5wb2xsaW5nPW5ldyBEZWxheWVkKCk7dGhpcy5ncmFjZVBlcmlvZD1mYWxzZTt9Q29udGVudEVkaXRhYmxlSW5wdXQucHJvdG90eXBlPWNvcHlPYmooe2luaXQ6ZnVuY3Rpb24oZGlzcGxheSl7dmFyIGlucHV0PXRoaXMsY209aW5wdXQuY207dmFyIGRpdj1pbnB1dC5kaXY9ZGlzcGxheS5saW5lRGl2O2Rpc2FibGVCcm93c2VyTWFnaWMoZGl2LGNtLm9wdGlvbnMuc3BlbGxjaGVjayk7b24oZGl2LFwicGFzdGVcIixmdW5jdGlvbihlKXtpZihzaWduYWxET01FdmVudChjbSxlKXx8aGFuZGxlUGFzdGUoZSxjbSkpe3JldHVybjt9Ly8gSUUgZG9lc24ndCBmaXJlIGlucHV0IGV2ZW50cywgc28gd2Ugc2NoZWR1bGUgYSByZWFkIGZvciB0aGUgcGFzdGVkIGNvbnRlbnQgaW4gdGhpcyB3YXlcbmlmKGllX3ZlcnNpb248PTExKXtzZXRUaW1lb3V0KG9wZXJhdGlvbihjbSxmdW5jdGlvbigpe2lmKCFpbnB1dC5wb2xsQ29udGVudCgpKXtyZWdDaGFuZ2UoY20pO319KSwyMCk7fX0pO29uKGRpdixcImNvbXBvc2l0aW9uc3RhcnRcIixmdW5jdGlvbihlKXt2YXIgZGF0YT1lLmRhdGE7aW5wdXQuY29tcG9zaW5nPXtzZWw6Y20uZG9jLnNlbCxkYXRhOmRhdGEsc3RhcnREYXRhOmRhdGF9O2lmKCFkYXRhKXtyZXR1cm47fXZhciBwcmltPWNtLmRvYy5zZWwucHJpbWFyeSgpO3ZhciBsaW5lPWNtLmdldExpbmUocHJpbS5oZWFkLmxpbmUpO3ZhciBmb3VuZD1saW5lLmluZGV4T2YoZGF0YSxNYXRoLm1heCgwLHByaW0uaGVhZC5jaC1kYXRhLmxlbmd0aCkpO2lmKGZvdW5kPi0xJiZmb3VuZDw9cHJpbS5oZWFkLmNoKXtpbnB1dC5jb21wb3Npbmcuc2VsPXNpbXBsZVNlbGVjdGlvbihQb3MocHJpbS5oZWFkLmxpbmUsZm91bmQpLFBvcyhwcmltLmhlYWQubGluZSxmb3VuZCtkYXRhLmxlbmd0aCkpO319KTtvbihkaXYsXCJjb21wb3NpdGlvbnVwZGF0ZVwiLGZ1bmN0aW9uKGUpe3JldHVybiBpbnB1dC5jb21wb3NpbmcuZGF0YT1lLmRhdGE7fSk7b24oZGl2LFwiY29tcG9zaXRpb25lbmRcIixmdW5jdGlvbihlKXt2YXIgb3Vycz1pbnB1dC5jb21wb3Npbmc7aWYoIW91cnMpe3JldHVybjt9aWYoZS5kYXRhIT1vdXJzLnN0YXJ0RGF0YSYmIS9cXHUyMDBiLy50ZXN0KGUuZGF0YSkpe291cnMuZGF0YT1lLmRhdGE7fS8vIE5lZWQgYSBzbWFsbCBkZWxheSB0byBwcmV2ZW50IG90aGVyIGNvZGUgKGlucHV0IGV2ZW50LFxuLy8gc2VsZWN0aW9uIHBvbGxpbmcpIGZyb20gZG9pbmcgZGFtYWdlIHdoZW4gZmlyZWQgcmlnaHQgYWZ0ZXJcbi8vIGNvbXBvc2l0aW9uZW5kLlxuc2V0VGltZW91dChmdW5jdGlvbigpe2lmKCFvdXJzLmhhbmRsZWQpe2lucHV0LmFwcGx5Q29tcG9zaXRpb24ob3Vycyk7fWlmKGlucHV0LmNvbXBvc2luZz09b3Vycyl7aW5wdXQuY29tcG9zaW5nPW51bGw7fX0sNTApO30pO29uKGRpdixcInRvdWNoc3RhcnRcIixmdW5jdGlvbigpe3JldHVybiBpbnB1dC5mb3JjZUNvbXBvc2l0aW9uRW5kKCk7fSk7b24oZGl2LFwiaW5wdXRcIixmdW5jdGlvbigpe2lmKGlucHV0LmNvbXBvc2luZyl7cmV0dXJuO31pZihjbS5pc1JlYWRPbmx5KCl8fCFpbnB1dC5wb2xsQ29udGVudCgpKXtydW5Jbk9wKGlucHV0LmNtLGZ1bmN0aW9uKCl7cmV0dXJuIHJlZ0NoYW5nZShjbSk7fSk7fX0pO2Z1bmN0aW9uIG9uQ29weUN1dChlKXtpZihzaWduYWxET01FdmVudChjbSxlKSl7cmV0dXJuO31pZihjbS5zb21ldGhpbmdTZWxlY3RlZCgpKXtzZXRMYXN0Q29waWVkKHtsaW5lV2lzZTpmYWxzZSx0ZXh0OmNtLmdldFNlbGVjdGlvbnMoKX0pO2lmKGUudHlwZT09XCJjdXRcIil7Y20ucmVwbGFjZVNlbGVjdGlvbihcIlwiLG51bGwsXCJjdXRcIik7fX1lbHNlIGlmKCFjbS5vcHRpb25zLmxpbmVXaXNlQ29weUN1dCl7cmV0dXJuO31lbHNle3ZhciByYW5nZXM9Y29weWFibGVSYW5nZXMoY20pO3NldExhc3RDb3BpZWQoe2xpbmVXaXNlOnRydWUsdGV4dDpyYW5nZXMudGV4dH0pO2lmKGUudHlwZT09XCJjdXRcIil7Y20ub3BlcmF0aW9uKGZ1bmN0aW9uKCl7Y20uc2V0U2VsZWN0aW9ucyhyYW5nZXMucmFuZ2VzLDAsc2VsX2RvbnRTY3JvbGwpO2NtLnJlcGxhY2VTZWxlY3Rpb24oXCJcIixudWxsLFwiY3V0XCIpO30pO319aWYoZS5jbGlwYm9hcmREYXRhKXtlLmNsaXBib2FyZERhdGEuY2xlYXJEYXRhKCk7dmFyIGNvbnRlbnQ9bGFzdENvcGllZC50ZXh0LmpvaW4oXCJcXG5cIik7Ly8gaU9TIGV4cG9zZXMgdGhlIGNsaXBib2FyZCBBUEksIGJ1dCBzZWVtcyB0byBkaXNjYXJkIGNvbnRlbnQgaW5zZXJ0ZWQgaW50byBpdFxuZS5jbGlwYm9hcmREYXRhLnNldERhdGEoXCJUZXh0XCIsY29udGVudCk7aWYoZS5jbGlwYm9hcmREYXRhLmdldERhdGEoXCJUZXh0XCIpPT1jb250ZW50KXtlLnByZXZlbnREZWZhdWx0KCk7cmV0dXJuO319Ly8gT2xkLWZhc2hpb25lZCBicmllZmx5LWZvY3VzLWEtdGV4dGFyZWEgaGFja1xudmFyIGtsdWRnZT1oaWRkZW5UZXh0YXJlYSgpLHRlPWtsdWRnZS5maXJzdENoaWxkO2NtLmRpc3BsYXkubGluZVNwYWNlLmluc2VydEJlZm9yZShrbHVkZ2UsY20uZGlzcGxheS5saW5lU3BhY2UuZmlyc3RDaGlsZCk7dGUudmFsdWU9bGFzdENvcGllZC50ZXh0LmpvaW4oXCJcXG5cIik7dmFyIGhhZEZvY3VzPWRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7c2VsZWN0SW5wdXQodGUpO3NldFRpbWVvdXQoZnVuY3Rpb24oKXtjbS5kaXNwbGF5LmxpbmVTcGFjZS5yZW1vdmVDaGlsZChrbHVkZ2UpO2hhZEZvY3VzLmZvY3VzKCk7aWYoaGFkRm9jdXM9PWRpdil7aW5wdXQuc2hvd1ByaW1hcnlTZWxlY3Rpb24oKTt9fSw1MCk7fW9uKGRpdixcImNvcHlcIixvbkNvcHlDdXQpO29uKGRpdixcImN1dFwiLG9uQ29weUN1dCk7fSxwcmVwYXJlU2VsZWN0aW9uOmZ1bmN0aW9uKCl7dmFyIHJlc3VsdD1wcmVwYXJlU2VsZWN0aW9uKHRoaXMuY20sZmFsc2UpO3Jlc3VsdC5mb2N1cz10aGlzLmNtLnN0YXRlLmZvY3VzZWQ7cmV0dXJuIHJlc3VsdDt9LHNob3dTZWxlY3Rpb246ZnVuY3Rpb24oaW5mbyx0YWtlRm9jdXMpe2lmKCFpbmZvfHwhdGhpcy5jbS5kaXNwbGF5LnZpZXcubGVuZ3RoKXtyZXR1cm47fWlmKGluZm8uZm9jdXN8fHRha2VGb2N1cyl7dGhpcy5zaG93UHJpbWFyeVNlbGVjdGlvbigpO310aGlzLnNob3dNdWx0aXBsZVNlbGVjdGlvbnMoaW5mbyk7fSxzaG93UHJpbWFyeVNlbGVjdGlvbjpmdW5jdGlvbigpe3ZhciBzZWw9d2luZG93LmdldFNlbGVjdGlvbigpLHByaW09dGhpcy5jbS5kb2Muc2VsLnByaW1hcnkoKTt2YXIgY3VyQW5jaG9yPWRvbVRvUG9zKHRoaXMuY20sc2VsLmFuY2hvck5vZGUsc2VsLmFuY2hvck9mZnNldCk7dmFyIGN1ckZvY3VzPWRvbVRvUG9zKHRoaXMuY20sc2VsLmZvY3VzTm9kZSxzZWwuZm9jdXNPZmZzZXQpO2lmKGN1ckFuY2hvciYmIWN1ckFuY2hvci5iYWQmJmN1ckZvY3VzJiYhY3VyRm9jdXMuYmFkJiZjbXAobWluUG9zKGN1ckFuY2hvcixjdXJGb2N1cykscHJpbS5mcm9tKCkpPT0wJiZjbXAobWF4UG9zKGN1ckFuY2hvcixjdXJGb2N1cykscHJpbS50bygpKT09MCl7cmV0dXJuO312YXIgc3RhcnQ9cG9zVG9ET00odGhpcy5jbSxwcmltLmZyb20oKSk7dmFyIGVuZD1wb3NUb0RPTSh0aGlzLmNtLHByaW0udG8oKSk7aWYoIXN0YXJ0JiYhZW5kKXtyZXR1cm47fXZhciB2aWV3PXRoaXMuY20uZGlzcGxheS52aWV3O3ZhciBvbGQ9c2VsLnJhbmdlQ291bnQmJnNlbC5nZXRSYW5nZUF0KDApO2lmKCFzdGFydCl7c3RhcnQ9e25vZGU6dmlld1swXS5tZWFzdXJlLm1hcFsyXSxvZmZzZXQ6MH07fWVsc2UgaWYoIWVuZCl7Ly8gRklYTUUgZGFuZ2Vyb3VzbHkgaGFja3lcbnZhciBtZWFzdXJlPXZpZXdbdmlldy5sZW5ndGgtMV0ubWVhc3VyZTt2YXIgbWFwPW1lYXN1cmUubWFwcz9tZWFzdXJlLm1hcHNbbWVhc3VyZS5tYXBzLmxlbmd0aC0xXTptZWFzdXJlLm1hcDtlbmQ9e25vZGU6bWFwW21hcC5sZW5ndGgtMV0sb2Zmc2V0Om1hcFttYXAubGVuZ3RoLTJdLW1hcFttYXAubGVuZ3RoLTNdfTt9dmFyIHJuZzt0cnl7cm5nPXJhbmdlKHN0YXJ0Lm5vZGUsc3RhcnQub2Zmc2V0LGVuZC5vZmZzZXQsZW5kLm5vZGUpO31jYXRjaChlKXt9Ly8gT3VyIG1vZGVsIG9mIHRoZSBET00gbWlnaHQgYmUgb3V0ZGF0ZWQsIGluIHdoaWNoIGNhc2UgdGhlIHJhbmdlIHdlIHRyeSB0byBzZXQgY2FuIGJlIGltcG9zc2libGVcbmlmKHJuZyl7aWYoIWdlY2tvJiZ0aGlzLmNtLnN0YXRlLmZvY3VzZWQpe3NlbC5jb2xsYXBzZShzdGFydC5ub2RlLHN0YXJ0Lm9mZnNldCk7aWYoIXJuZy5jb2xsYXBzZWQpe3NlbC5yZW1vdmVBbGxSYW5nZXMoKTtzZWwuYWRkUmFuZ2Uocm5nKTt9fWVsc2V7c2VsLnJlbW92ZUFsbFJhbmdlcygpO3NlbC5hZGRSYW5nZShybmcpO31pZihvbGQmJnNlbC5hbmNob3JOb2RlPT1udWxsKXtzZWwuYWRkUmFuZ2Uob2xkKTt9ZWxzZSBpZihnZWNrbyl7dGhpcy5zdGFydEdyYWNlUGVyaW9kKCk7fX10aGlzLnJlbWVtYmVyU2VsZWN0aW9uKCk7fSxzdGFydEdyYWNlUGVyaW9kOmZ1bmN0aW9uKCl7dmFyIHRoaXMkMT10aGlzO2NsZWFyVGltZW91dCh0aGlzLmdyYWNlUGVyaW9kKTt0aGlzLmdyYWNlUGVyaW9kPXNldFRpbWVvdXQoZnVuY3Rpb24oKXt0aGlzJDEuZ3JhY2VQZXJpb2Q9ZmFsc2U7aWYodGhpcyQxLnNlbGVjdGlvbkNoYW5nZWQoKSl7dGhpcyQxLmNtLm9wZXJhdGlvbihmdW5jdGlvbigpe3JldHVybiB0aGlzJDEuY20uY3VyT3Auc2VsZWN0aW9uQ2hhbmdlZD10cnVlO30pO319LDIwKTt9LHNob3dNdWx0aXBsZVNlbGVjdGlvbnM6ZnVuY3Rpb24oaW5mbyl7cmVtb3ZlQ2hpbGRyZW5BbmRBZGQodGhpcy5jbS5kaXNwbGF5LmN1cnNvckRpdixpbmZvLmN1cnNvcnMpO3JlbW92ZUNoaWxkcmVuQW5kQWRkKHRoaXMuY20uZGlzcGxheS5zZWxlY3Rpb25EaXYsaW5mby5zZWxlY3Rpb24pO30scmVtZW1iZXJTZWxlY3Rpb246ZnVuY3Rpb24oKXt2YXIgc2VsPXdpbmRvdy5nZXRTZWxlY3Rpb24oKTt0aGlzLmxhc3RBbmNob3JOb2RlPXNlbC5hbmNob3JOb2RlO3RoaXMubGFzdEFuY2hvck9mZnNldD1zZWwuYW5jaG9yT2Zmc2V0O3RoaXMubGFzdEZvY3VzTm9kZT1zZWwuZm9jdXNOb2RlO3RoaXMubGFzdEZvY3VzT2Zmc2V0PXNlbC5mb2N1c09mZnNldDt9LHNlbGVjdGlvbkluRWRpdG9yOmZ1bmN0aW9uKCl7dmFyIHNlbD13aW5kb3cuZ2V0U2VsZWN0aW9uKCk7aWYoIXNlbC5yYW5nZUNvdW50KXtyZXR1cm4gZmFsc2U7fXZhciBub2RlPXNlbC5nZXRSYW5nZUF0KDApLmNvbW1vbkFuY2VzdG9yQ29udGFpbmVyO3JldHVybiBjb250YWlucyh0aGlzLmRpdixub2RlKTt9LGZvY3VzOmZ1bmN0aW9uKCl7aWYodGhpcy5jbS5vcHRpb25zLnJlYWRPbmx5IT1cIm5vY3Vyc29yXCIpe3RoaXMuZGl2LmZvY3VzKCk7fX0sYmx1cjpmdW5jdGlvbigpe3RoaXMuZGl2LmJsdXIoKTt9LGdldEZpZWxkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGl2O30sc3VwcG9ydHNUb3VjaDpmdW5jdGlvbigpe3JldHVybiB0cnVlO30scmVjZWl2ZWRGb2N1czpmdW5jdGlvbigpe3ZhciBpbnB1dD10aGlzO2lmKHRoaXMuc2VsZWN0aW9uSW5FZGl0b3IoKSl7dGhpcy5wb2xsU2VsZWN0aW9uKCk7fWVsc2V7cnVuSW5PcCh0aGlzLmNtLGZ1bmN0aW9uKCl7cmV0dXJuIGlucHV0LmNtLmN1ck9wLnNlbGVjdGlvbkNoYW5nZWQ9dHJ1ZTt9KTt9ZnVuY3Rpb24gcG9sbCgpe2lmKGlucHV0LmNtLnN0YXRlLmZvY3VzZWQpe2lucHV0LnBvbGxTZWxlY3Rpb24oKTtpbnB1dC5wb2xsaW5nLnNldChpbnB1dC5jbS5vcHRpb25zLnBvbGxJbnRlcnZhbCxwb2xsKTt9fXRoaXMucG9sbGluZy5zZXQodGhpcy5jbS5vcHRpb25zLnBvbGxJbnRlcnZhbCxwb2xsKTt9LHNlbGVjdGlvbkNoYW5nZWQ6ZnVuY3Rpb24oKXt2YXIgc2VsPXdpbmRvdy5nZXRTZWxlY3Rpb24oKTtyZXR1cm4gc2VsLmFuY2hvck5vZGUhPXRoaXMubGFzdEFuY2hvck5vZGV8fHNlbC5hbmNob3JPZmZzZXQhPXRoaXMubGFzdEFuY2hvck9mZnNldHx8c2VsLmZvY3VzTm9kZSE9dGhpcy5sYXN0Rm9jdXNOb2RlfHxzZWwuZm9jdXNPZmZzZXQhPXRoaXMubGFzdEZvY3VzT2Zmc2V0O30scG9sbFNlbGVjdGlvbjpmdW5jdGlvbigpe2lmKCF0aGlzLmNvbXBvc2luZyYmIXRoaXMuZ3JhY2VQZXJpb2QmJnRoaXMuc2VsZWN0aW9uQ2hhbmdlZCgpKXt2YXIgc2VsPXdpbmRvdy5nZXRTZWxlY3Rpb24oKSxjbT10aGlzLmNtO3RoaXMucmVtZW1iZXJTZWxlY3Rpb24oKTt2YXIgYW5jaG9yPWRvbVRvUG9zKGNtLHNlbC5hbmNob3JOb2RlLHNlbC5hbmNob3JPZmZzZXQpO3ZhciBoZWFkPWRvbVRvUG9zKGNtLHNlbC5mb2N1c05vZGUsc2VsLmZvY3VzT2Zmc2V0KTtpZihhbmNob3ImJmhlYWQpe3J1bkluT3AoY20sZnVuY3Rpb24oKXtzZXRTZWxlY3Rpb24oY20uZG9jLHNpbXBsZVNlbGVjdGlvbihhbmNob3IsaGVhZCksc2VsX2RvbnRTY3JvbGwpO2lmKGFuY2hvci5iYWR8fGhlYWQuYmFkKXtjbS5jdXJPcC5zZWxlY3Rpb25DaGFuZ2VkPXRydWU7fX0pO319fSxwb2xsQ29udGVudDpmdW5jdGlvbigpe3ZhciBjbT10aGlzLmNtLGRpc3BsYXk9Y20uZGlzcGxheSxzZWw9Y20uZG9jLnNlbC5wcmltYXJ5KCk7dmFyIGZyb209c2VsLmZyb20oKSx0bz1zZWwudG8oKTtpZihmcm9tLmxpbmU8ZGlzcGxheS52aWV3RnJvbXx8dG8ubGluZT5kaXNwbGF5LnZpZXdUby0xKXtyZXR1cm4gZmFsc2U7fXZhciBmcm9tSW5kZXgsZnJvbUxpbmUsZnJvbU5vZGU7aWYoZnJvbS5saW5lPT1kaXNwbGF5LnZpZXdGcm9tfHwoZnJvbUluZGV4PWZpbmRWaWV3SW5kZXgoY20sZnJvbS5saW5lKSk9PTApe2Zyb21MaW5lPWxpbmVObyhkaXNwbGF5LnZpZXdbMF0ubGluZSk7ZnJvbU5vZGU9ZGlzcGxheS52aWV3WzBdLm5vZGU7fWVsc2V7ZnJvbUxpbmU9bGluZU5vKGRpc3BsYXkudmlld1tmcm9tSW5kZXhdLmxpbmUpO2Zyb21Ob2RlPWRpc3BsYXkudmlld1tmcm9tSW5kZXgtMV0ubm9kZS5uZXh0U2libGluZzt9dmFyIHRvSW5kZXg9ZmluZFZpZXdJbmRleChjbSx0by5saW5lKTt2YXIgdG9MaW5lLHRvTm9kZTtpZih0b0luZGV4PT1kaXNwbGF5LnZpZXcubGVuZ3RoLTEpe3RvTGluZT1kaXNwbGF5LnZpZXdUby0xO3RvTm9kZT1kaXNwbGF5LmxpbmVEaXYubGFzdENoaWxkO31lbHNle3RvTGluZT1saW5lTm8oZGlzcGxheS52aWV3W3RvSW5kZXgrMV0ubGluZSktMTt0b05vZGU9ZGlzcGxheS52aWV3W3RvSW5kZXgrMV0ubm9kZS5wcmV2aW91c1NpYmxpbmc7fXZhciBuZXdUZXh0PWNtLmRvYy5zcGxpdExpbmVzKGRvbVRleHRCZXR3ZWVuKGNtLGZyb21Ob2RlLHRvTm9kZSxmcm9tTGluZSx0b0xpbmUpKTt2YXIgb2xkVGV4dD1nZXRCZXR3ZWVuKGNtLmRvYyxQb3MoZnJvbUxpbmUsMCksUG9zKHRvTGluZSxnZXRMaW5lKGNtLmRvYyx0b0xpbmUpLnRleHQubGVuZ3RoKSk7d2hpbGUobmV3VGV4dC5sZW5ndGg+MSYmb2xkVGV4dC5sZW5ndGg+MSl7aWYobHN0KG5ld1RleHQpPT1sc3Qob2xkVGV4dCkpe25ld1RleHQucG9wKCk7b2xkVGV4dC5wb3AoKTt0b0xpbmUtLTt9ZWxzZSBpZihuZXdUZXh0WzBdPT1vbGRUZXh0WzBdKXtuZXdUZXh0LnNoaWZ0KCk7b2xkVGV4dC5zaGlmdCgpO2Zyb21MaW5lKys7fWVsc2V7YnJlYWs7fX12YXIgY3V0RnJvbnQ9MCxjdXRFbmQ9MDt2YXIgbmV3VG9wPW5ld1RleHRbMF0sb2xkVG9wPW9sZFRleHRbMF0sbWF4Q3V0RnJvbnQ9TWF0aC5taW4obmV3VG9wLmxlbmd0aCxvbGRUb3AubGVuZ3RoKTt3aGlsZShjdXRGcm9udDxtYXhDdXRGcm9udCYmbmV3VG9wLmNoYXJDb2RlQXQoY3V0RnJvbnQpPT1vbGRUb3AuY2hhckNvZGVBdChjdXRGcm9udCkpeysrY3V0RnJvbnQ7fXZhciBuZXdCb3Q9bHN0KG5ld1RleHQpLG9sZEJvdD1sc3Qob2xkVGV4dCk7dmFyIG1heEN1dEVuZD1NYXRoLm1pbihuZXdCb3QubGVuZ3RoLShuZXdUZXh0Lmxlbmd0aD09MT9jdXRGcm9udDowKSxvbGRCb3QubGVuZ3RoLShvbGRUZXh0Lmxlbmd0aD09MT9jdXRGcm9udDowKSk7d2hpbGUoY3V0RW5kPG1heEN1dEVuZCYmbmV3Qm90LmNoYXJDb2RlQXQobmV3Qm90Lmxlbmd0aC1jdXRFbmQtMSk9PW9sZEJvdC5jaGFyQ29kZUF0KG9sZEJvdC5sZW5ndGgtY3V0RW5kLTEpKXsrK2N1dEVuZDt9bmV3VGV4dFtuZXdUZXh0Lmxlbmd0aC0xXT1uZXdCb3Quc2xpY2UoMCxuZXdCb3QubGVuZ3RoLWN1dEVuZCk7bmV3VGV4dFswXT1uZXdUZXh0WzBdLnNsaWNlKGN1dEZyb250KTt2YXIgY2hGcm9tPVBvcyhmcm9tTGluZSxjdXRGcm9udCk7dmFyIGNoVG89UG9zKHRvTGluZSxvbGRUZXh0Lmxlbmd0aD9sc3Qob2xkVGV4dCkubGVuZ3RoLWN1dEVuZDowKTtpZihuZXdUZXh0Lmxlbmd0aD4xfHxuZXdUZXh0WzBdfHxjbXAoY2hGcm9tLGNoVG8pKXtyZXBsYWNlUmFuZ2UoY20uZG9jLG5ld1RleHQsY2hGcm9tLGNoVG8sXCIraW5wdXRcIik7cmV0dXJuIHRydWU7fX0sZW5zdXJlUG9sbGVkOmZ1bmN0aW9uKCl7dGhpcy5mb3JjZUNvbXBvc2l0aW9uRW5kKCk7fSxyZXNldDpmdW5jdGlvbigpe3RoaXMuZm9yY2VDb21wb3NpdGlvbkVuZCgpO30sZm9yY2VDb21wb3NpdGlvbkVuZDpmdW5jdGlvbigpe2lmKCF0aGlzLmNvbXBvc2luZ3x8dGhpcy5jb21wb3NpbmcuaGFuZGxlZCl7cmV0dXJuO310aGlzLmFwcGx5Q29tcG9zaXRpb24odGhpcy5jb21wb3NpbmcpO3RoaXMuY29tcG9zaW5nLmhhbmRsZWQ9dHJ1ZTt0aGlzLmRpdi5ibHVyKCk7dGhpcy5kaXYuZm9jdXMoKTt9LGFwcGx5Q29tcG9zaXRpb246ZnVuY3Rpb24oY29tcG9zaW5nKXtpZih0aGlzLmNtLmlzUmVhZE9ubHkoKSl7b3BlcmF0aW9uKHRoaXMuY20scmVnQ2hhbmdlKSh0aGlzLmNtKTt9ZWxzZSBpZihjb21wb3NpbmcuZGF0YSYmY29tcG9zaW5nLmRhdGEhPWNvbXBvc2luZy5zdGFydERhdGEpe29wZXJhdGlvbih0aGlzLmNtLGFwcGx5VGV4dElucHV0KSh0aGlzLmNtLGNvbXBvc2luZy5kYXRhLDAsY29tcG9zaW5nLnNlbCk7fX0sc2V0VW5lZGl0YWJsZTpmdW5jdGlvbihub2RlKXtub2RlLmNvbnRlbnRFZGl0YWJsZT1cImZhbHNlXCI7fSxvbktleVByZXNzOmZ1bmN0aW9uKGUpe2UucHJldmVudERlZmF1bHQoKTtpZighdGhpcy5jbS5pc1JlYWRPbmx5KCkpe29wZXJhdGlvbih0aGlzLmNtLGFwcGx5VGV4dElucHV0KSh0aGlzLmNtLFN0cmluZy5mcm9tQ2hhckNvZGUoZS5jaGFyQ29kZT09bnVsbD9lLmtleUNvZGU6ZS5jaGFyQ29kZSksMCk7fX0scmVhZE9ubHlDaGFuZ2VkOmZ1bmN0aW9uKHZhbCl7dGhpcy5kaXYuY29udGVudEVkaXRhYmxlPVN0cmluZyh2YWwhPVwibm9jdXJzb3JcIik7fSxvbkNvbnRleHRNZW51Om5vdGhpbmcscmVzZXRQb3NpdGlvbjpub3RoaW5nLG5lZWRzQ29udGVudEF0dHJpYnV0ZTp0cnVlfSxDb250ZW50RWRpdGFibGVJbnB1dC5wcm90b3R5cGUpO2Z1bmN0aW9uIHBvc1RvRE9NKGNtLHBvcyl7dmFyIHZpZXc9ZmluZFZpZXdGb3JMaW5lKGNtLHBvcy5saW5lKTtpZighdmlld3x8dmlldy5oaWRkZW4pe3JldHVybiBudWxsO312YXIgbGluZT1nZXRMaW5lKGNtLmRvYyxwb3MubGluZSk7dmFyIGluZm89bWFwRnJvbUxpbmVWaWV3KHZpZXcsbGluZSxwb3MubGluZSk7dmFyIG9yZGVyPWdldE9yZGVyKGxpbmUpLHNpZGU9XCJsZWZ0XCI7aWYob3JkZXIpe3ZhciBwYXJ0UG9zPWdldEJpZGlQYXJ0QXQob3JkZXIscG9zLmNoKTtzaWRlPXBhcnRQb3MlMj9cInJpZ2h0XCI6XCJsZWZ0XCI7fXZhciByZXN1bHQ9bm9kZUFuZE9mZnNldEluTGluZU1hcChpbmZvLm1hcCxwb3MuY2gsc2lkZSk7cmVzdWx0Lm9mZnNldD1yZXN1bHQuY29sbGFwc2U9PVwicmlnaHRcIj9yZXN1bHQuZW5kOnJlc3VsdC5zdGFydDtyZXR1cm4gcmVzdWx0O31mdW5jdGlvbiBiYWRQb3MocG9zLGJhZCl7aWYoYmFkKXtwb3MuYmFkPXRydWU7fXJldHVybiBwb3M7fWZ1bmN0aW9uIGRvbVRleHRCZXR3ZWVuKGNtLGZyb20sdG8sZnJvbUxpbmUsdG9MaW5lKXt2YXIgdGV4dD1cIlwiLGNsb3Npbmc9ZmFsc2UsbGluZVNlcD1jbS5kb2MubGluZVNlcGFyYXRvcigpO2Z1bmN0aW9uIHJlY29nbml6ZU1hcmtlcihpZCl7cmV0dXJuIGZ1bmN0aW9uKG1hcmtlcil7cmV0dXJuIG1hcmtlci5pZD09aWQ7fTt9ZnVuY3Rpb24gd2Fsayhub2RlKXtpZihub2RlLm5vZGVUeXBlPT0xKXt2YXIgY21UZXh0PW5vZGUuZ2V0QXR0cmlidXRlKFwiY20tdGV4dFwiKTtpZihjbVRleHQhPW51bGwpe2lmKGNtVGV4dD09XCJcIil7Y21UZXh0PW5vZGUudGV4dENvbnRlbnQucmVwbGFjZSgvXFx1MjAwYi9nLFwiXCIpO310ZXh0Kz1jbVRleHQ7cmV0dXJuO312YXIgbWFya2VySUQ9bm9kZS5nZXRBdHRyaWJ1dGUoXCJjbS1tYXJrZXJcIikscmFuZ2U7aWYobWFya2VySUQpe3ZhciBmb3VuZD1jbS5maW5kTWFya3MoUG9zKGZyb21MaW5lLDApLFBvcyh0b0xpbmUrMSwwKSxyZWNvZ25pemVNYXJrZXIoK21hcmtlcklEKSk7aWYoZm91bmQubGVuZ3RoJiYocmFuZ2U9Zm91bmRbMF0uZmluZCgpKSl7dGV4dCs9Z2V0QmV0d2VlbihjbS5kb2MscmFuZ2UuZnJvbSxyYW5nZS50bykuam9pbihsaW5lU2VwKTt9cmV0dXJuO31pZihub2RlLmdldEF0dHJpYnV0ZShcImNvbnRlbnRlZGl0YWJsZVwiKT09XCJmYWxzZVwiKXtyZXR1cm47fWZvcih2YXIgaT0wO2k8bm9kZS5jaGlsZE5vZGVzLmxlbmd0aDtpKyspe3dhbGsobm9kZS5jaGlsZE5vZGVzW2ldKTt9aWYoL14ocHJlfGRpdnxwKSQvaS50ZXN0KG5vZGUubm9kZU5hbWUpKXtjbG9zaW5nPXRydWU7fX1lbHNlIGlmKG5vZGUubm9kZVR5cGU9PTMpe3ZhciB2YWw9bm9kZS5ub2RlVmFsdWU7aWYoIXZhbCl7cmV0dXJuO31pZihjbG9zaW5nKXt0ZXh0Kz1saW5lU2VwO2Nsb3Npbmc9ZmFsc2U7fXRleHQrPXZhbDt9fWZvcig7Oyl7d2Fsayhmcm9tKTtpZihmcm9tPT10byl7YnJlYWs7fWZyb209ZnJvbS5uZXh0U2libGluZzt9cmV0dXJuIHRleHQ7fWZ1bmN0aW9uIGRvbVRvUG9zKGNtLG5vZGUsb2Zmc2V0KXt2YXIgbGluZU5vZGU7aWYobm9kZT09Y20uZGlzcGxheS5saW5lRGl2KXtsaW5lTm9kZT1jbS5kaXNwbGF5LmxpbmVEaXYuY2hpbGROb2Rlc1tvZmZzZXRdO2lmKCFsaW5lTm9kZSl7cmV0dXJuIGJhZFBvcyhjbS5jbGlwUG9zKFBvcyhjbS5kaXNwbGF5LnZpZXdUby0xKSksdHJ1ZSk7fW5vZGU9bnVsbDtvZmZzZXQ9MDt9ZWxzZXtmb3IobGluZU5vZGU9bm9kZTs7bGluZU5vZGU9bGluZU5vZGUucGFyZW50Tm9kZSl7aWYoIWxpbmVOb2RlfHxsaW5lTm9kZT09Y20uZGlzcGxheS5saW5lRGl2KXtyZXR1cm4gbnVsbDt9aWYobGluZU5vZGUucGFyZW50Tm9kZSYmbGluZU5vZGUucGFyZW50Tm9kZT09Y20uZGlzcGxheS5saW5lRGl2KXticmVhazt9fX1mb3IodmFyIGk9MDtpPGNtLmRpc3BsYXkudmlldy5sZW5ndGg7aSsrKXt2YXIgbGluZVZpZXc9Y20uZGlzcGxheS52aWV3W2ldO2lmKGxpbmVWaWV3Lm5vZGU9PWxpbmVOb2RlKXtyZXR1cm4gbG9jYXRlTm9kZUluTGluZVZpZXcobGluZVZpZXcsbm9kZSxvZmZzZXQpO319fWZ1bmN0aW9uIGxvY2F0ZU5vZGVJbkxpbmVWaWV3KGxpbmVWaWV3LG5vZGUsb2Zmc2V0KXt2YXIgd3JhcHBlcj1saW5lVmlldy50ZXh0LmZpcnN0Q2hpbGQsYmFkPWZhbHNlO2lmKCFub2RlfHwhY29udGFpbnMod3JhcHBlcixub2RlKSl7cmV0dXJuIGJhZFBvcyhQb3MobGluZU5vKGxpbmVWaWV3LmxpbmUpLDApLHRydWUpO31pZihub2RlPT13cmFwcGVyKXtiYWQ9dHJ1ZTtub2RlPXdyYXBwZXIuY2hpbGROb2Rlc1tvZmZzZXRdO29mZnNldD0wO2lmKCFub2RlKXt2YXIgbGluZT1saW5lVmlldy5yZXN0P2xzdChsaW5lVmlldy5yZXN0KTpsaW5lVmlldy5saW5lO3JldHVybiBiYWRQb3MoUG9zKGxpbmVObyhsaW5lKSxsaW5lLnRleHQubGVuZ3RoKSxiYWQpO319dmFyIHRleHROb2RlPW5vZGUubm9kZVR5cGU9PTM/bm9kZTpudWxsLHRvcE5vZGU9bm9kZTtpZighdGV4dE5vZGUmJm5vZGUuY2hpbGROb2Rlcy5sZW5ndGg9PTEmJm5vZGUuZmlyc3RDaGlsZC5ub2RlVHlwZT09Myl7dGV4dE5vZGU9bm9kZS5maXJzdENoaWxkO2lmKG9mZnNldCl7b2Zmc2V0PXRleHROb2RlLm5vZGVWYWx1ZS5sZW5ndGg7fX13aGlsZSh0b3BOb2RlLnBhcmVudE5vZGUhPXdyYXBwZXIpe3RvcE5vZGU9dG9wTm9kZS5wYXJlbnROb2RlO312YXIgbWVhc3VyZT1saW5lVmlldy5tZWFzdXJlLG1hcHM9bWVhc3VyZS5tYXBzO2Z1bmN0aW9uIGZpbmQodGV4dE5vZGUsdG9wTm9kZSxvZmZzZXQpe2Zvcih2YXIgaT0tMTtpPChtYXBzP21hcHMubGVuZ3RoOjApO2krKyl7dmFyIG1hcD1pPDA/bWVhc3VyZS5tYXA6bWFwc1tpXTtmb3IodmFyIGo9MDtqPG1hcC5sZW5ndGg7ais9Myl7dmFyIGN1ck5vZGU9bWFwW2orMl07aWYoY3VyTm9kZT09dGV4dE5vZGV8fGN1ck5vZGU9PXRvcE5vZGUpe3ZhciBsaW5lPWxpbmVObyhpPDA/bGluZVZpZXcubGluZTpsaW5lVmlldy5yZXN0W2ldKTt2YXIgY2g9bWFwW2pdK29mZnNldDtpZihvZmZzZXQ8MHx8Y3VyTm9kZSE9dGV4dE5vZGUpe2NoPW1hcFtqKyhvZmZzZXQ/MTowKV07fXJldHVybiBQb3MobGluZSxjaCk7fX19fXZhciBmb3VuZD1maW5kKHRleHROb2RlLHRvcE5vZGUsb2Zmc2V0KTtpZihmb3VuZCl7cmV0dXJuIGJhZFBvcyhmb3VuZCxiYWQpO30vLyBGSVhNRSB0aGlzIGlzIGFsbCByZWFsbHkgc2hha3kuIG1pZ2h0IGhhbmRsZSB0aGUgZmV3IGNhc2VzIGl0IG5lZWRzIHRvIGhhbmRsZSwgYnV0IGxpa2VseSB0byBjYXVzZSBwcm9ibGVtc1xuZm9yKHZhciBhZnRlcj10b3BOb2RlLm5leHRTaWJsaW5nLGRpc3Q9dGV4dE5vZGU/dGV4dE5vZGUubm9kZVZhbHVlLmxlbmd0aC1vZmZzZXQ6MDthZnRlcjthZnRlcj1hZnRlci5uZXh0U2libGluZyl7Zm91bmQ9ZmluZChhZnRlcixhZnRlci5maXJzdENoaWxkLDApO2lmKGZvdW5kKXtyZXR1cm4gYmFkUG9zKFBvcyhmb3VuZC5saW5lLGZvdW5kLmNoLWRpc3QpLGJhZCk7fWVsc2V7ZGlzdCs9YWZ0ZXIudGV4dENvbnRlbnQubGVuZ3RoO319Zm9yKHZhciBiZWZvcmU9dG9wTm9kZS5wcmV2aW91c1NpYmxpbmcsZGlzdCQxPW9mZnNldDtiZWZvcmU7YmVmb3JlPWJlZm9yZS5wcmV2aW91c1NpYmxpbmcpe2ZvdW5kPWZpbmQoYmVmb3JlLGJlZm9yZS5maXJzdENoaWxkLC0xKTtpZihmb3VuZCl7cmV0dXJuIGJhZFBvcyhQb3MoZm91bmQubGluZSxmb3VuZC5jaCtkaXN0JDEpLGJhZCk7fWVsc2V7ZGlzdCQxKz1iZWZvcmUudGV4dENvbnRlbnQubGVuZ3RoO319fS8vIFRFWFRBUkVBIElOUFVUIFNUWUxFXG5mdW5jdGlvbiBUZXh0YXJlYUlucHV0KGNtKXt0aGlzLmNtPWNtOy8vIFNlZSBpbnB1dC5wb2xsIGFuZCBpbnB1dC5yZXNldFxudGhpcy5wcmV2SW5wdXQ9XCJcIjsvLyBGbGFnIHRoYXQgaW5kaWNhdGVzIHdoZXRoZXIgd2UgZXhwZWN0IGlucHV0IHRvIGFwcGVhciByZWFsIHNvb25cbi8vIG5vdyAoYWZ0ZXIgc29tZSBldmVudCBsaWtlICdrZXlwcmVzcycgb3IgJ2lucHV0JykgYW5kIGFyZVxuLy8gcG9sbGluZyBpbnRlbnNpdmVseS5cbnRoaXMucG9sbGluZ0Zhc3Q9ZmFsc2U7Ly8gU2VsZi1yZXNldHRpbmcgdGltZW91dCBmb3IgdGhlIHBvbGxlclxudGhpcy5wb2xsaW5nPW5ldyBEZWxheWVkKCk7Ly8gVHJhY2tzIHdoZW4gaW5wdXQucmVzZXQgaGFzIHB1bnRlZCB0byBqdXN0IHB1dHRpbmcgYSBzaG9ydFxuLy8gc3RyaW5nIGludG8gdGhlIHRleHRhcmVhIGluc3RlYWQgb2YgdGhlIGZ1bGwgc2VsZWN0aW9uLlxudGhpcy5pbmFjY3VyYXRlU2VsZWN0aW9uPWZhbHNlOy8vIFVzZWQgdG8gd29yayBhcm91bmQgSUUgaXNzdWUgd2l0aCBzZWxlY3Rpb24gYmVpbmcgZm9yZ290dGVuIHdoZW4gZm9jdXMgbW92ZXMgYXdheSBmcm9tIHRleHRhcmVhXG50aGlzLmhhc1NlbGVjdGlvbj1mYWxzZTt0aGlzLmNvbXBvc2luZz1udWxsO31UZXh0YXJlYUlucHV0LnByb3RvdHlwZT1jb3B5T2JqKHtpbml0OmZ1bmN0aW9uKGRpc3BsYXkpe3ZhciB0aGlzJDE9dGhpczt2YXIgaW5wdXQ9dGhpcyxjbT10aGlzLmNtOy8vIFdyYXBzIGFuZCBoaWRlcyBpbnB1dCB0ZXh0YXJlYVxudmFyIGRpdj10aGlzLndyYXBwZXI9aGlkZGVuVGV4dGFyZWEoKTsvLyBUaGUgc2VtaWhpZGRlbiB0ZXh0YXJlYSB0aGF0IGlzIGZvY3VzZWQgd2hlbiB0aGUgZWRpdG9yIGlzXG4vLyBmb2N1c2VkLCBhbmQgcmVjZWl2ZXMgaW5wdXQuXG52YXIgdGU9dGhpcy50ZXh0YXJlYT1kaXYuZmlyc3RDaGlsZDtkaXNwbGF5LndyYXBwZXIuaW5zZXJ0QmVmb3JlKGRpdixkaXNwbGF5LndyYXBwZXIuZmlyc3RDaGlsZCk7Ly8gTmVlZGVkIHRvIGhpZGUgYmlnIGJsdWUgYmxpbmtpbmcgY3Vyc29yIG9uIE1vYmlsZSBTYWZhcmkgKGRvZXNuJ3Qgc2VlbSB0byB3b3JrIGluIGlPUyA4IGFueW1vcmUpXG5pZihpb3Mpe3RlLnN0eWxlLndpZHRoPVwiMHB4XCI7fW9uKHRlLFwiaW5wdXRcIixmdW5jdGlvbigpe2lmKGllJiZpZV92ZXJzaW9uPj05JiZ0aGlzJDEuaGFzU2VsZWN0aW9uKXt0aGlzJDEuaGFzU2VsZWN0aW9uPW51bGw7fWlucHV0LnBvbGwoKTt9KTtvbih0ZSxcInBhc3RlXCIsZnVuY3Rpb24oZSl7aWYoc2lnbmFsRE9NRXZlbnQoY20sZSl8fGhhbmRsZVBhc3RlKGUsY20pKXtyZXR1cm47fWNtLnN0YXRlLnBhc3RlSW5jb21pbmc9dHJ1ZTtpbnB1dC5mYXN0UG9sbCgpO30pO2Z1bmN0aW9uIHByZXBhcmVDb3B5Q3V0KGUpe2lmKHNpZ25hbERPTUV2ZW50KGNtLGUpKXtyZXR1cm47fWlmKGNtLnNvbWV0aGluZ1NlbGVjdGVkKCkpe3NldExhc3RDb3BpZWQoe2xpbmVXaXNlOmZhbHNlLHRleHQ6Y20uZ2V0U2VsZWN0aW9ucygpfSk7aWYoaW5wdXQuaW5hY2N1cmF0ZVNlbGVjdGlvbil7aW5wdXQucHJldklucHV0PVwiXCI7aW5wdXQuaW5hY2N1cmF0ZVNlbGVjdGlvbj1mYWxzZTt0ZS52YWx1ZT1sYXN0Q29waWVkLnRleHQuam9pbihcIlxcblwiKTtzZWxlY3RJbnB1dCh0ZSk7fX1lbHNlIGlmKCFjbS5vcHRpb25zLmxpbmVXaXNlQ29weUN1dCl7cmV0dXJuO31lbHNle3ZhciByYW5nZXM9Y29weWFibGVSYW5nZXMoY20pO3NldExhc3RDb3BpZWQoe2xpbmVXaXNlOnRydWUsdGV4dDpyYW5nZXMudGV4dH0pO2lmKGUudHlwZT09XCJjdXRcIil7Y20uc2V0U2VsZWN0aW9ucyhyYW5nZXMucmFuZ2VzLG51bGwsc2VsX2RvbnRTY3JvbGwpO31lbHNle2lucHV0LnByZXZJbnB1dD1cIlwiO3RlLnZhbHVlPXJhbmdlcy50ZXh0LmpvaW4oXCJcXG5cIik7c2VsZWN0SW5wdXQodGUpO319aWYoZS50eXBlPT1cImN1dFwiKXtjbS5zdGF0ZS5jdXRJbmNvbWluZz10cnVlO319b24odGUsXCJjdXRcIixwcmVwYXJlQ29weUN1dCk7b24odGUsXCJjb3B5XCIscHJlcGFyZUNvcHlDdXQpO29uKGRpc3BsYXkuc2Nyb2xsZXIsXCJwYXN0ZVwiLGZ1bmN0aW9uKGUpe2lmKGV2ZW50SW5XaWRnZXQoZGlzcGxheSxlKXx8c2lnbmFsRE9NRXZlbnQoY20sZSkpe3JldHVybjt9Y20uc3RhdGUucGFzdGVJbmNvbWluZz10cnVlO2lucHV0LmZvY3VzKCk7fSk7Ly8gUHJldmVudCBub3JtYWwgc2VsZWN0aW9uIGluIHRoZSBlZGl0b3IgKHdlIGhhbmRsZSBvdXIgb3duKVxub24oZGlzcGxheS5saW5lU3BhY2UsXCJzZWxlY3RzdGFydFwiLGZ1bmN0aW9uKGUpe2lmKCFldmVudEluV2lkZ2V0KGRpc3BsYXksZSkpe2VfcHJldmVudERlZmF1bHQoZSk7fX0pO29uKHRlLFwiY29tcG9zaXRpb25zdGFydFwiLGZ1bmN0aW9uKCl7dmFyIHN0YXJ0PWNtLmdldEN1cnNvcihcImZyb21cIik7aWYoaW5wdXQuY29tcG9zaW5nKXtpbnB1dC5jb21wb3NpbmcucmFuZ2UuY2xlYXIoKTt9aW5wdXQuY29tcG9zaW5nPXtzdGFydDpzdGFydCxyYW5nZTpjbS5tYXJrVGV4dChzdGFydCxjbS5nZXRDdXJzb3IoXCJ0b1wiKSx7Y2xhc3NOYW1lOlwiQ29kZU1pcnJvci1jb21wb3NpbmdcIn0pfTt9KTtvbih0ZSxcImNvbXBvc2l0aW9uZW5kXCIsZnVuY3Rpb24oKXtpZihpbnB1dC5jb21wb3Npbmcpe2lucHV0LnBvbGwoKTtpbnB1dC5jb21wb3NpbmcucmFuZ2UuY2xlYXIoKTtpbnB1dC5jb21wb3Npbmc9bnVsbDt9fSk7fSxwcmVwYXJlU2VsZWN0aW9uOmZ1bmN0aW9uKCl7Ly8gUmVkcmF3IHRoZSBzZWxlY3Rpb24gYW5kL29yIGN1cnNvclxudmFyIGNtPXRoaXMuY20sZGlzcGxheT1jbS5kaXNwbGF5LGRvYz1jbS5kb2M7dmFyIHJlc3VsdD1wcmVwYXJlU2VsZWN0aW9uKGNtKTsvLyBNb3ZlIHRoZSBoaWRkZW4gdGV4dGFyZWEgbmVhciB0aGUgY3Vyc29yIHRvIHByZXZlbnQgc2Nyb2xsaW5nIGFydGlmYWN0c1xuaWYoY20ub3B0aW9ucy5tb3ZlSW5wdXRXaXRoQ3Vyc29yKXt2YXIgaGVhZFBvcz1jdXJzb3JDb29yZHMoY20sZG9jLnNlbC5wcmltYXJ5KCkuaGVhZCxcImRpdlwiKTt2YXIgd3JhcE9mZj1kaXNwbGF5LndyYXBwZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksbGluZU9mZj1kaXNwbGF5LmxpbmVEaXYuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7cmVzdWx0LnRlVG9wPU1hdGgubWF4KDAsTWF0aC5taW4oZGlzcGxheS53cmFwcGVyLmNsaWVudEhlaWdodC0xMCxoZWFkUG9zLnRvcCtsaW5lT2ZmLnRvcC13cmFwT2ZmLnRvcCkpO3Jlc3VsdC50ZUxlZnQ9TWF0aC5tYXgoMCxNYXRoLm1pbihkaXNwbGF5LndyYXBwZXIuY2xpZW50V2lkdGgtMTAsaGVhZFBvcy5sZWZ0K2xpbmVPZmYubGVmdC13cmFwT2ZmLmxlZnQpKTt9cmV0dXJuIHJlc3VsdDt9LHNob3dTZWxlY3Rpb246ZnVuY3Rpb24oZHJhd24pe3ZhciBjbT10aGlzLmNtLGRpc3BsYXk9Y20uZGlzcGxheTtyZW1vdmVDaGlsZHJlbkFuZEFkZChkaXNwbGF5LmN1cnNvckRpdixkcmF3bi5jdXJzb3JzKTtyZW1vdmVDaGlsZHJlbkFuZEFkZChkaXNwbGF5LnNlbGVjdGlvbkRpdixkcmF3bi5zZWxlY3Rpb24pO2lmKGRyYXduLnRlVG9wIT1udWxsKXt0aGlzLndyYXBwZXIuc3R5bGUudG9wPWRyYXduLnRlVG9wK1wicHhcIjt0aGlzLndyYXBwZXIuc3R5bGUubGVmdD1kcmF3bi50ZUxlZnQrXCJweFwiO319LC8vIFJlc2V0IHRoZSBpbnB1dCB0byBjb3JyZXNwb25kIHRvIHRoZSBzZWxlY3Rpb24gKG9yIHRvIGJlIGVtcHR5LFxuLy8gd2hlbiBub3QgdHlwaW5nIGFuZCBub3RoaW5nIGlzIHNlbGVjdGVkKVxucmVzZXQ6ZnVuY3Rpb24odHlwaW5nKXtpZih0aGlzLmNvbnRleHRNZW51UGVuZGluZyl7cmV0dXJuO312YXIgbWluaW1hbCxzZWxlY3RlZCxjbT10aGlzLmNtLGRvYz1jbS5kb2M7aWYoY20uc29tZXRoaW5nU2VsZWN0ZWQoKSl7dGhpcy5wcmV2SW5wdXQ9XCJcIjt2YXIgcmFuZ2U9ZG9jLnNlbC5wcmltYXJ5KCk7bWluaW1hbD1oYXNDb3B5RXZlbnQmJihyYW5nZS50bygpLmxpbmUtcmFuZ2UuZnJvbSgpLmxpbmU+MTAwfHwoc2VsZWN0ZWQ9Y20uZ2V0U2VsZWN0aW9uKCkpLmxlbmd0aD4xMDAwKTt2YXIgY29udGVudD1taW5pbWFsP1wiLVwiOnNlbGVjdGVkfHxjbS5nZXRTZWxlY3Rpb24oKTt0aGlzLnRleHRhcmVhLnZhbHVlPWNvbnRlbnQ7aWYoY20uc3RhdGUuZm9jdXNlZCl7c2VsZWN0SW5wdXQodGhpcy50ZXh0YXJlYSk7fWlmKGllJiZpZV92ZXJzaW9uPj05KXt0aGlzLmhhc1NlbGVjdGlvbj1jb250ZW50O319ZWxzZSBpZighdHlwaW5nKXt0aGlzLnByZXZJbnB1dD10aGlzLnRleHRhcmVhLnZhbHVlPVwiXCI7aWYoaWUmJmllX3ZlcnNpb24+PTkpe3RoaXMuaGFzU2VsZWN0aW9uPW51bGw7fX10aGlzLmluYWNjdXJhdGVTZWxlY3Rpb249bWluaW1hbDt9LGdldEZpZWxkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudGV4dGFyZWE7fSxzdXBwb3J0c1RvdWNoOmZ1bmN0aW9uKCl7cmV0dXJuIGZhbHNlO30sZm9jdXM6ZnVuY3Rpb24oKXtpZih0aGlzLmNtLm9wdGlvbnMucmVhZE9ubHkhPVwibm9jdXJzb3JcIiYmKCFtb2JpbGV8fGFjdGl2ZUVsdCgpIT10aGlzLnRleHRhcmVhKSl7dHJ5e3RoaXMudGV4dGFyZWEuZm9jdXMoKTt9Y2F0Y2goZSl7fS8vIElFOCB3aWxsIHRocm93IGlmIHRoZSB0ZXh0YXJlYSBpcyBkaXNwbGF5OiBub25lIG9yIG5vdCBpbiBET01cbn19LGJsdXI6ZnVuY3Rpb24oKXt0aGlzLnRleHRhcmVhLmJsdXIoKTt9LHJlc2V0UG9zaXRpb246ZnVuY3Rpb24oKXt0aGlzLndyYXBwZXIuc3R5bGUudG9wPXRoaXMud3JhcHBlci5zdHlsZS5sZWZ0PTA7fSxyZWNlaXZlZEZvY3VzOmZ1bmN0aW9uKCl7dGhpcy5zbG93UG9sbCgpO30sLy8gUG9sbCBmb3IgaW5wdXQgY2hhbmdlcywgdXNpbmcgdGhlIG5vcm1hbCByYXRlIG9mIHBvbGxpbmcuIFRoaXNcbi8vIHJ1bnMgYXMgbG9uZyBhcyB0aGUgZWRpdG9yIGlzIGZvY3VzZWQuXG5zbG93UG9sbDpmdW5jdGlvbigpe3ZhciB0aGlzJDE9dGhpcztpZih0aGlzLnBvbGxpbmdGYXN0KXtyZXR1cm47fXRoaXMucG9sbGluZy5zZXQodGhpcy5jbS5vcHRpb25zLnBvbGxJbnRlcnZhbCxmdW5jdGlvbigpe3RoaXMkMS5wb2xsKCk7aWYodGhpcyQxLmNtLnN0YXRlLmZvY3VzZWQpe3RoaXMkMS5zbG93UG9sbCgpO319KTt9LC8vIFdoZW4gYW4gZXZlbnQgaGFzIGp1c3QgY29tZSBpbiB0aGF0IGlzIGxpa2VseSB0byBhZGQgb3IgY2hhbmdlXG4vLyBzb21ldGhpbmcgaW4gdGhlIGlucHV0IHRleHRhcmVhLCB3ZSBwb2xsIGZhc3RlciwgdG8gZW5zdXJlIHRoYXRcbi8vIHRoZSBjaGFuZ2UgYXBwZWFycyBvbiB0aGUgc2NyZWVuIHF1aWNrbHkuXG5mYXN0UG9sbDpmdW5jdGlvbigpe3ZhciBtaXNzZWQ9ZmFsc2UsaW5wdXQ9dGhpcztpbnB1dC5wb2xsaW5nRmFzdD10cnVlO2Z1bmN0aW9uIHAoKXt2YXIgY2hhbmdlZD1pbnB1dC5wb2xsKCk7aWYoIWNoYW5nZWQmJiFtaXNzZWQpe21pc3NlZD10cnVlO2lucHV0LnBvbGxpbmcuc2V0KDYwLHApO31lbHNle2lucHV0LnBvbGxpbmdGYXN0PWZhbHNlO2lucHV0LnNsb3dQb2xsKCk7fX1pbnB1dC5wb2xsaW5nLnNldCgyMCxwKTt9LC8vIFJlYWQgaW5wdXQgZnJvbSB0aGUgdGV4dGFyZWEsIGFuZCB1cGRhdGUgdGhlIGRvY3VtZW50IHRvIG1hdGNoLlxuLy8gV2hlbiBzb21ldGhpbmcgaXMgc2VsZWN0ZWQsIGl0IGlzIHByZXNlbnQgaW4gdGhlIHRleHRhcmVhLCBhbmRcbi8vIHNlbGVjdGVkICh1bmxlc3MgaXQgaXMgaHVnZSwgaW4gd2hpY2ggY2FzZSBhIHBsYWNlaG9sZGVyIGlzXG4vLyB1c2VkKS4gV2hlbiBub3RoaW5nIGlzIHNlbGVjdGVkLCB0aGUgY3Vyc29yIHNpdHMgYWZ0ZXIgcHJldmlvdXNseVxuLy8gc2VlbiB0ZXh0IChjYW4gYmUgZW1wdHkpLCB3aGljaCBpcyBzdG9yZWQgaW4gcHJldklucHV0ICh3ZSBtdXN0XG4vLyBub3QgcmVzZXQgdGhlIHRleHRhcmVhIHdoZW4gdHlwaW5nLCBiZWNhdXNlIHRoYXQgYnJlYWtzIElNRSkuXG5wb2xsOmZ1bmN0aW9uKCl7dmFyIHRoaXMkMT10aGlzO3ZhciBjbT10aGlzLmNtLGlucHV0PXRoaXMudGV4dGFyZWEscHJldklucHV0PXRoaXMucHJldklucHV0Oy8vIFNpbmNlIHRoaXMgaXMgY2FsbGVkIGEgKmxvdCosIHRyeSB0byBiYWlsIG91dCBhcyBjaGVhcGx5IGFzXG4vLyBwb3NzaWJsZSB3aGVuIGl0IGlzIGNsZWFyIHRoYXQgbm90aGluZyBoYXBwZW5lZC4gaGFzU2VsZWN0aW9uXG4vLyB3aWxsIGJlIHRoZSBjYXNlIHdoZW4gdGhlcmUgaXMgYSBsb3Qgb2YgdGV4dCBpbiB0aGUgdGV4dGFyZWEsXG4vLyBpbiB3aGljaCBjYXNlIHJlYWRpbmcgaXRzIHZhbHVlIHdvdWxkIGJlIGV4cGVuc2l2ZS5cbmlmKHRoaXMuY29udGV4dE1lbnVQZW5kaW5nfHwhY20uc3RhdGUuZm9jdXNlZHx8aGFzU2VsZWN0aW9uKGlucHV0KSYmIXByZXZJbnB1dCYmIXRoaXMuY29tcG9zaW5nfHxjbS5pc1JlYWRPbmx5KCl8fGNtLm9wdGlvbnMuZGlzYWJsZUlucHV0fHxjbS5zdGF0ZS5rZXlTZXEpe3JldHVybiBmYWxzZTt9dmFyIHRleHQ9aW5wdXQudmFsdWU7Ly8gSWYgbm90aGluZyBjaGFuZ2VkLCBiYWlsLlxuaWYodGV4dD09cHJldklucHV0JiYhY20uc29tZXRoaW5nU2VsZWN0ZWQoKSl7cmV0dXJuIGZhbHNlO30vLyBXb3JrIGFyb3VuZCBub25zZW5zaWNhbCBzZWxlY3Rpb24gcmVzZXR0aW5nIGluIElFOS8xMCwgYW5kXG4vLyBpbmV4cGxpY2FibGUgYXBwZWFyYW5jZSBvZiBwcml2YXRlIGFyZWEgdW5pY29kZSBjaGFyYWN0ZXJzIG9uXG4vLyBzb21lIGtleSBjb21ib3MgaW4gTWFjICgjMjY4OSkuXG5pZihpZSYmaWVfdmVyc2lvbj49OSYmdGhpcy5oYXNTZWxlY3Rpb249PT10ZXh0fHxtYWMmJi9bXFx1ZjcwMC1cXHVmN2ZmXS8udGVzdCh0ZXh0KSl7Y20uZGlzcGxheS5pbnB1dC5yZXNldCgpO3JldHVybiBmYWxzZTt9aWYoY20uZG9jLnNlbD09Y20uZGlzcGxheS5zZWxGb3JDb250ZXh0TWVudSl7dmFyIGZpcnN0PXRleHQuY2hhckNvZGVBdCgwKTtpZihmaXJzdD09MHgyMDBiJiYhcHJldklucHV0KXtwcmV2SW5wdXQ9XCJcXHUyMDBiXCI7fWlmKGZpcnN0PT0weDIxZGEpe3RoaXMucmVzZXQoKTtyZXR1cm4gdGhpcy5jbS5leGVjQ29tbWFuZChcInVuZG9cIik7fX0vLyBGaW5kIHRoZSBwYXJ0IG9mIHRoZSBpbnB1dCB0aGF0IGlzIGFjdHVhbGx5IG5ld1xudmFyIHNhbWU9MCxsPU1hdGgubWluKHByZXZJbnB1dC5sZW5ndGgsdGV4dC5sZW5ndGgpO3doaWxlKHNhbWU8bCYmcHJldklucHV0LmNoYXJDb2RlQXQoc2FtZSk9PXRleHQuY2hhckNvZGVBdChzYW1lKSl7KytzYW1lO31ydW5Jbk9wKGNtLGZ1bmN0aW9uKCl7YXBwbHlUZXh0SW5wdXQoY20sdGV4dC5zbGljZShzYW1lKSxwcmV2SW5wdXQubGVuZ3RoLXNhbWUsbnVsbCx0aGlzJDEuY29tcG9zaW5nP1wiKmNvbXBvc2VcIjpudWxsKTsvLyBEb24ndCBsZWF2ZSBsb25nIHRleHQgaW4gdGhlIHRleHRhcmVhLCBzaW5jZSBpdCBtYWtlcyBmdXJ0aGVyIHBvbGxpbmcgc2xvd1xuaWYodGV4dC5sZW5ndGg+MTAwMHx8dGV4dC5pbmRleE9mKFwiXFxuXCIpPi0xKXtpbnB1dC52YWx1ZT10aGlzJDEucHJldklucHV0PVwiXCI7fWVsc2V7dGhpcyQxLnByZXZJbnB1dD10ZXh0O31pZih0aGlzJDEuY29tcG9zaW5nKXt0aGlzJDEuY29tcG9zaW5nLnJhbmdlLmNsZWFyKCk7dGhpcyQxLmNvbXBvc2luZy5yYW5nZT1jbS5tYXJrVGV4dCh0aGlzJDEuY29tcG9zaW5nLnN0YXJ0LGNtLmdldEN1cnNvcihcInRvXCIpLHtjbGFzc05hbWU6XCJDb2RlTWlycm9yLWNvbXBvc2luZ1wifSk7fX0pO3JldHVybiB0cnVlO30sZW5zdXJlUG9sbGVkOmZ1bmN0aW9uKCl7aWYodGhpcy5wb2xsaW5nRmFzdCYmdGhpcy5wb2xsKCkpe3RoaXMucG9sbGluZ0Zhc3Q9ZmFsc2U7fX0sb25LZXlQcmVzczpmdW5jdGlvbigpe2lmKGllJiZpZV92ZXJzaW9uPj05KXt0aGlzLmhhc1NlbGVjdGlvbj1udWxsO310aGlzLmZhc3RQb2xsKCk7fSxvbkNvbnRleHRNZW51OmZ1bmN0aW9uKGUpe3ZhciBpbnB1dD10aGlzLGNtPWlucHV0LmNtLGRpc3BsYXk9Y20uZGlzcGxheSx0ZT1pbnB1dC50ZXh0YXJlYTt2YXIgcG9zPXBvc0Zyb21Nb3VzZShjbSxlKSxzY3JvbGxQb3M9ZGlzcGxheS5zY3JvbGxlci5zY3JvbGxUb3A7aWYoIXBvc3x8cHJlc3RvKXtyZXR1cm47fS8vIE9wZXJhIGlzIGRpZmZpY3VsdC5cbi8vIFJlc2V0IHRoZSBjdXJyZW50IHRleHQgc2VsZWN0aW9uIG9ubHkgaWYgdGhlIGNsaWNrIGlzIGRvbmUgb3V0c2lkZSBvZiB0aGUgc2VsZWN0aW9uXG4vLyBhbmQgJ3Jlc2V0U2VsZWN0aW9uT25Db250ZXh0TWVudScgb3B0aW9uIGlzIHRydWUuXG52YXIgcmVzZXQ9Y20ub3B0aW9ucy5yZXNldFNlbGVjdGlvbk9uQ29udGV4dE1lbnU7aWYocmVzZXQmJmNtLmRvYy5zZWwuY29udGFpbnMocG9zKT09LTEpe29wZXJhdGlvbihjbSxzZXRTZWxlY3Rpb24pKGNtLmRvYyxzaW1wbGVTZWxlY3Rpb24ocG9zKSxzZWxfZG9udFNjcm9sbCk7fXZhciBvbGRDU1M9dGUuc3R5bGUuY3NzVGV4dCxvbGRXcmFwcGVyQ1NTPWlucHV0LndyYXBwZXIuc3R5bGUuY3NzVGV4dDtpbnB1dC53cmFwcGVyLnN0eWxlLmNzc1RleHQ9XCJwb3NpdGlvbjogYWJzb2x1dGVcIjt2YXIgd3JhcHBlckJveD1pbnB1dC53cmFwcGVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO3RlLnN0eWxlLmNzc1RleHQ9XCJwb3NpdGlvbjogYWJzb2x1dGU7IHdpZHRoOiAzMHB4OyBoZWlnaHQ6IDMwcHg7XFxuICAgICAgdG9wOiBcIisoZS5jbGllbnRZLXdyYXBwZXJCb3gudG9wLTUpK1wicHg7IGxlZnQ6IFwiKyhlLmNsaWVudFgtd3JhcHBlckJveC5sZWZ0LTUpK1wicHg7XFxuICAgICAgei1pbmRleDogMTAwMDsgYmFja2dyb3VuZDogXCIrKGllP1wicmdiYSgyNTUsIDI1NSwgMjU1LCAuMDUpXCI6XCJ0cmFuc3BhcmVudFwiKStcIjtcXG4gICAgICBvdXRsaW5lOiBub25lOyBib3JkZXItd2lkdGg6IDA7IG91dGxpbmU6IG5vbmU7IG92ZXJmbG93OiBoaWRkZW47IG9wYWNpdHk6IC4wNTsgZmlsdGVyOiBhbHBoYShvcGFjaXR5PTUpO1wiO3ZhciBvbGRTY3JvbGxZO2lmKHdlYmtpdCl7b2xkU2Nyb2xsWT13aW5kb3cuc2Nyb2xsWTt9Ly8gV29yayBhcm91bmQgQ2hyb21lIGlzc3VlICgjMjcxMilcbmRpc3BsYXkuaW5wdXQuZm9jdXMoKTtpZih3ZWJraXQpe3dpbmRvdy5zY3JvbGxUbyhudWxsLG9sZFNjcm9sbFkpO31kaXNwbGF5LmlucHV0LnJlc2V0KCk7Ly8gQWRkcyBcIlNlbGVjdCBhbGxcIiB0byBjb250ZXh0IG1lbnUgaW4gRkZcbmlmKCFjbS5zb21ldGhpbmdTZWxlY3RlZCgpKXt0ZS52YWx1ZT1pbnB1dC5wcmV2SW5wdXQ9XCIgXCI7fWlucHV0LmNvbnRleHRNZW51UGVuZGluZz10cnVlO2Rpc3BsYXkuc2VsRm9yQ29udGV4dE1lbnU9Y20uZG9jLnNlbDtjbGVhclRpbWVvdXQoZGlzcGxheS5kZXRlY3RpbmdTZWxlY3RBbGwpOy8vIFNlbGVjdC1hbGwgd2lsbCBiZSBncmV5ZWQgb3V0IGlmIHRoZXJlJ3Mgbm90aGluZyB0byBzZWxlY3QsIHNvXG4vLyB0aGlzIGFkZHMgYSB6ZXJvLXdpZHRoIHNwYWNlIHNvIHRoYXQgd2UgY2FuIGxhdGVyIGNoZWNrIHdoZXRoZXJcbi8vIGl0IGdvdCBzZWxlY3RlZC5cbmZ1bmN0aW9uIHByZXBhcmVTZWxlY3RBbGxIYWNrKCl7aWYodGUuc2VsZWN0aW9uU3RhcnQhPW51bGwpe3ZhciBzZWxlY3RlZD1jbS5zb21ldGhpbmdTZWxlY3RlZCgpO3ZhciBleHR2YWw9XCJcXHUyMDBiXCIrKHNlbGVjdGVkP3RlLnZhbHVlOlwiXCIpO3RlLnZhbHVlPVwiXFx1MjFkYVwiOy8vIFVzZWQgdG8gY2F0Y2ggY29udGV4dC1tZW51IHVuZG9cbnRlLnZhbHVlPWV4dHZhbDtpbnB1dC5wcmV2SW5wdXQ9c2VsZWN0ZWQ/XCJcIjpcIlxcdTIwMGJcIjt0ZS5zZWxlY3Rpb25TdGFydD0xO3RlLnNlbGVjdGlvbkVuZD1leHR2YWwubGVuZ3RoOy8vIFJlLXNldCB0aGlzLCBpbiBjYXNlIHNvbWUgb3RoZXIgaGFuZGxlciB0b3VjaGVkIHRoZVxuLy8gc2VsZWN0aW9uIGluIHRoZSBtZWFudGltZS5cbmRpc3BsYXkuc2VsRm9yQ29udGV4dE1lbnU9Y20uZG9jLnNlbDt9fWZ1bmN0aW9uIHJlaGlkZSgpe2lucHV0LmNvbnRleHRNZW51UGVuZGluZz1mYWxzZTtpbnB1dC53cmFwcGVyLnN0eWxlLmNzc1RleHQ9b2xkV3JhcHBlckNTUzt0ZS5zdHlsZS5jc3NUZXh0PW9sZENTUztpZihpZSYmaWVfdmVyc2lvbjw5KXtkaXNwbGF5LnNjcm9sbGJhcnMuc2V0U2Nyb2xsVG9wKGRpc3BsYXkuc2Nyb2xsZXIuc2Nyb2xsVG9wPXNjcm9sbFBvcyk7fS8vIFRyeSB0byBkZXRlY3QgdGhlIHVzZXIgY2hvb3Npbmcgc2VsZWN0LWFsbFxuaWYodGUuc2VsZWN0aW9uU3RhcnQhPW51bGwpe2lmKCFpZXx8aWUmJmllX3ZlcnNpb248OSl7cHJlcGFyZVNlbGVjdEFsbEhhY2soKTt9dmFyIGk9MCxwb2xsPWZ1bmN0aW9uKCl7aWYoZGlzcGxheS5zZWxGb3JDb250ZXh0TWVudT09Y20uZG9jLnNlbCYmdGUuc2VsZWN0aW9uU3RhcnQ9PTAmJnRlLnNlbGVjdGlvbkVuZD4wJiZpbnB1dC5wcmV2SW5wdXQ9PVwiXFx1MjAwYlwiKXtvcGVyYXRpb24oY20sc2VsZWN0QWxsKShjbSk7fWVsc2UgaWYoaSsrPDEwKXtkaXNwbGF5LmRldGVjdGluZ1NlbGVjdEFsbD1zZXRUaW1lb3V0KHBvbGwsNTAwKTt9ZWxzZXtkaXNwbGF5LmlucHV0LnJlc2V0KCk7fX07ZGlzcGxheS5kZXRlY3RpbmdTZWxlY3RBbGw9c2V0VGltZW91dChwb2xsLDIwMCk7fX1pZihpZSYmaWVfdmVyc2lvbj49OSl7cHJlcGFyZVNlbGVjdEFsbEhhY2soKTt9aWYoY2FwdHVyZVJpZ2h0Q2xpY2spe2Vfc3RvcChlKTt2YXIgbW91c2V1cD1mdW5jdGlvbigpe29mZih3aW5kb3csXCJtb3VzZXVwXCIsbW91c2V1cCk7c2V0VGltZW91dChyZWhpZGUsMjApO307b24od2luZG93LFwibW91c2V1cFwiLG1vdXNldXApO31lbHNle3NldFRpbWVvdXQocmVoaWRlLDUwKTt9fSxyZWFkT25seUNoYW5nZWQ6ZnVuY3Rpb24odmFsKXtpZighdmFsKXt0aGlzLnJlc2V0KCk7fX0sc2V0VW5lZGl0YWJsZTpub3RoaW5nLG5lZWRzQ29udGVudEF0dHJpYnV0ZTpmYWxzZX0sVGV4dGFyZWFJbnB1dC5wcm90b3R5cGUpO2Z1bmN0aW9uIGZyb21UZXh0QXJlYSh0ZXh0YXJlYSxvcHRpb25zKXtvcHRpb25zPW9wdGlvbnM/Y29weU9iaihvcHRpb25zKTp7fTtvcHRpb25zLnZhbHVlPXRleHRhcmVhLnZhbHVlO2lmKCFvcHRpb25zLnRhYmluZGV4JiZ0ZXh0YXJlYS50YWJJbmRleCl7b3B0aW9ucy50YWJpbmRleD10ZXh0YXJlYS50YWJJbmRleDt9aWYoIW9wdGlvbnMucGxhY2Vob2xkZXImJnRleHRhcmVhLnBsYWNlaG9sZGVyKXtvcHRpb25zLnBsYWNlaG9sZGVyPXRleHRhcmVhLnBsYWNlaG9sZGVyO30vLyBTZXQgYXV0b2ZvY3VzIHRvIHRydWUgaWYgdGhpcyB0ZXh0YXJlYSBpcyBmb2N1c2VkLCBvciBpZiBpdCBoYXNcbi8vIGF1dG9mb2N1cyBhbmQgbm8gb3RoZXIgZWxlbWVudCBpcyBmb2N1c2VkLlxuaWYob3B0aW9ucy5hdXRvZm9jdXM9PW51bGwpe3ZhciBoYXNGb2N1cz1hY3RpdmVFbHQoKTtvcHRpb25zLmF1dG9mb2N1cz1oYXNGb2N1cz09dGV4dGFyZWF8fHRleHRhcmVhLmdldEF0dHJpYnV0ZShcImF1dG9mb2N1c1wiKSE9bnVsbCYmaGFzRm9jdXM9PWRvY3VtZW50LmJvZHk7fWZ1bmN0aW9uIHNhdmUoKXt0ZXh0YXJlYS52YWx1ZT1jbS5nZXRWYWx1ZSgpO312YXIgcmVhbFN1Ym1pdDtpZih0ZXh0YXJlYS5mb3JtKXtvbih0ZXh0YXJlYS5mb3JtLFwic3VibWl0XCIsc2F2ZSk7Ly8gRGVwbG9yYWJsZSBoYWNrIHRvIG1ha2UgdGhlIHN1Ym1pdCBtZXRob2QgZG8gdGhlIHJpZ2h0IHRoaW5nLlxuaWYoIW9wdGlvbnMubGVhdmVTdWJtaXRNZXRob2RBbG9uZSl7dmFyIGZvcm09dGV4dGFyZWEuZm9ybTtyZWFsU3VibWl0PWZvcm0uc3VibWl0O3RyeXt2YXIgd3JhcHBlZFN1Ym1pdD1mb3JtLnN1Ym1pdD1mdW5jdGlvbigpe3NhdmUoKTtmb3JtLnN1Ym1pdD1yZWFsU3VibWl0O2Zvcm0uc3VibWl0KCk7Zm9ybS5zdWJtaXQ9d3JhcHBlZFN1Ym1pdDt9O31jYXRjaChlKXt9fX1vcHRpb25zLmZpbmlzaEluaXQ9ZnVuY3Rpb24oY20pe2NtLnNhdmU9c2F2ZTtjbS5nZXRUZXh0QXJlYT1mdW5jdGlvbigpe3JldHVybiB0ZXh0YXJlYTt9O2NtLnRvVGV4dEFyZWE9ZnVuY3Rpb24oKXtjbS50b1RleHRBcmVhPWlzTmFOOy8vIFByZXZlbnQgdGhpcyBmcm9tIGJlaW5nIHJhbiB0d2ljZVxuc2F2ZSgpO3RleHRhcmVhLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoY20uZ2V0V3JhcHBlckVsZW1lbnQoKSk7dGV4dGFyZWEuc3R5bGUuZGlzcGxheT1cIlwiO2lmKHRleHRhcmVhLmZvcm0pe29mZih0ZXh0YXJlYS5mb3JtLFwic3VibWl0XCIsc2F2ZSk7aWYodHlwZW9mIHRleHRhcmVhLmZvcm0uc3VibWl0PT1cImZ1bmN0aW9uXCIpe3RleHRhcmVhLmZvcm0uc3VibWl0PXJlYWxTdWJtaXQ7fX19O307dGV4dGFyZWEuc3R5bGUuZGlzcGxheT1cIm5vbmVcIjt2YXIgY209Q29kZU1pcnJvcihmdW5jdGlvbihub2RlKXtyZXR1cm4gdGV4dGFyZWEucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobm9kZSx0ZXh0YXJlYS5uZXh0U2libGluZyk7fSxvcHRpb25zKTtyZXR1cm4gY207fWZ1bmN0aW9uIGFkZExlZ2FjeVByb3BzKENvZGVNaXJyb3Ipe0NvZGVNaXJyb3Iub2ZmPW9mZjtDb2RlTWlycm9yLm9uPW9uO0NvZGVNaXJyb3Iud2hlZWxFdmVudFBpeGVscz13aGVlbEV2ZW50UGl4ZWxzO0NvZGVNaXJyb3IuRG9jPURvYztDb2RlTWlycm9yLnNwbGl0TGluZXM9c3BsaXRMaW5lc0F1dG87Q29kZU1pcnJvci5jb3VudENvbHVtbj1jb3VudENvbHVtbjtDb2RlTWlycm9yLmZpbmRDb2x1bW49ZmluZENvbHVtbjtDb2RlTWlycm9yLmlzV29yZENoYXI9aXNXb3JkQ2hhckJhc2ljO0NvZGVNaXJyb3IuUGFzcz1QYXNzO0NvZGVNaXJyb3Iuc2lnbmFsPXNpZ25hbDtDb2RlTWlycm9yLkxpbmU9TGluZTtDb2RlTWlycm9yLmNoYW5nZUVuZD1jaGFuZ2VFbmQ7Q29kZU1pcnJvci5zY3JvbGxiYXJNb2RlbD1zY3JvbGxiYXJNb2RlbDtDb2RlTWlycm9yLlBvcz1Qb3M7Q29kZU1pcnJvci5jbXBQb3M9Y21wO0NvZGVNaXJyb3IubW9kZXM9bW9kZXM7Q29kZU1pcnJvci5taW1lTW9kZXM9bWltZU1vZGVzO0NvZGVNaXJyb3IucmVzb2x2ZU1vZGU9cmVzb2x2ZU1vZGU7Q29kZU1pcnJvci5nZXRNb2RlPWdldE1vZGU7Q29kZU1pcnJvci5tb2RlRXh0ZW5zaW9ucz1tb2RlRXh0ZW5zaW9ucztDb2RlTWlycm9yLmV4dGVuZE1vZGU9ZXh0ZW5kTW9kZTtDb2RlTWlycm9yLmNvcHlTdGF0ZT1jb3B5U3RhdGU7Q29kZU1pcnJvci5zdGFydFN0YXRlPXN0YXJ0U3RhdGU7Q29kZU1pcnJvci5pbm5lck1vZGU9aW5uZXJNb2RlO0NvZGVNaXJyb3IuY29tbWFuZHM9Y29tbWFuZHM7Q29kZU1pcnJvci5rZXlNYXA9a2V5TWFwO0NvZGVNaXJyb3Iua2V5TmFtZT1rZXlOYW1lO0NvZGVNaXJyb3IuaXNNb2RpZmllcktleT1pc01vZGlmaWVyS2V5O0NvZGVNaXJyb3IubG9va3VwS2V5PWxvb2t1cEtleTtDb2RlTWlycm9yLm5vcm1hbGl6ZUtleU1hcD1ub3JtYWxpemVLZXlNYXA7Q29kZU1pcnJvci5TdHJpbmdTdHJlYW09U3RyaW5nU3RyZWFtO0NvZGVNaXJyb3IuU2hhcmVkVGV4dE1hcmtlcj1TaGFyZWRUZXh0TWFya2VyO0NvZGVNaXJyb3IuVGV4dE1hcmtlcj1UZXh0TWFya2VyO0NvZGVNaXJyb3IuTGluZVdpZGdldD1MaW5lV2lkZ2V0O0NvZGVNaXJyb3IuZV9wcmV2ZW50RGVmYXVsdD1lX3ByZXZlbnREZWZhdWx0O0NvZGVNaXJyb3IuZV9zdG9wUHJvcGFnYXRpb249ZV9zdG9wUHJvcGFnYXRpb247Q29kZU1pcnJvci5lX3N0b3A9ZV9zdG9wO0NvZGVNaXJyb3IuYWRkQ2xhc3M9YWRkQ2xhc3M7Q29kZU1pcnJvci5jb250YWlucz1jb250YWlucztDb2RlTWlycm9yLnJtQ2xhc3M9cm1DbGFzcztDb2RlTWlycm9yLmtleU5hbWVzPWtleU5hbWVzO30vLyBFRElUT1IgQ09OU1RSVUNUT1JcbmRlZmluZU9wdGlvbnMoQ29kZU1pcnJvcik7YWRkRWRpdG9yTWV0aG9kcyhDb2RlTWlycm9yKTsvLyBTZXQgdXAgbWV0aG9kcyBvbiBDb2RlTWlycm9yJ3MgcHJvdG90eXBlIHRvIHJlZGlyZWN0IHRvIHRoZSBlZGl0b3IncyBkb2N1bWVudC5cbnZhciBkb250RGVsZWdhdGU9XCJpdGVyIGluc2VydCByZW1vdmUgY29weSBnZXRFZGl0b3IgY29uc3RydWN0b3JcIi5zcGxpdChcIiBcIik7Zm9yKHZhciBwcm9wIGluIERvYy5wcm90b3R5cGUpe2lmKERvYy5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkocHJvcCkmJmluZGV4T2YoZG9udERlbGVnYXRlLHByb3ApPDApe0NvZGVNaXJyb3IucHJvdG90eXBlW3Byb3BdPWZ1bmN0aW9uKG1ldGhvZCl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIG1ldGhvZC5hcHBseSh0aGlzLmRvYyxhcmd1bWVudHMpO307fShEb2MucHJvdG90eXBlW3Byb3BdKTt9fWV2ZW50TWl4aW4oRG9jKTsvLyBJTlBVVCBIQU5ETElOR1xuQ29kZU1pcnJvci5pbnB1dFN0eWxlcz17XCJ0ZXh0YXJlYVwiOlRleHRhcmVhSW5wdXQsXCJjb250ZW50ZWRpdGFibGVcIjpDb250ZW50RWRpdGFibGVJbnB1dH07Ly8gTU9ERSBERUZJTklUSU9OIEFORCBRVUVSWUlOR1xuLy8gRXh0cmEgYXJndW1lbnRzIGFyZSBzdG9yZWQgYXMgdGhlIG1vZGUncyBkZXBlbmRlbmNpZXMsIHdoaWNoIGlzXG4vLyB1c2VkIGJ5IChsZWdhY3kpIG1lY2hhbmlzbXMgbGlrZSBsb2FkbW9kZS5qcyB0byBhdXRvbWF0aWNhbGx5XG4vLyBsb2FkIGEgbW9kZS4gKFByZWZlcnJlZCBtZWNoYW5pc20gaXMgdGhlIHJlcXVpcmUvZGVmaW5lIGNhbGxzLilcbkNvZGVNaXJyb3IuZGVmaW5lTW9kZT1mdW5jdGlvbihuYW1lLyosIG1vZGUsIOKApiovKXtpZighQ29kZU1pcnJvci5kZWZhdWx0cy5tb2RlJiZuYW1lIT1cIm51bGxcIil7Q29kZU1pcnJvci5kZWZhdWx0cy5tb2RlPW5hbWU7fWRlZmluZU1vZGUuYXBwbHkodGhpcyxhcmd1bWVudHMpO307Q29kZU1pcnJvci5kZWZpbmVNSU1FPWRlZmluZU1JTUU7Ly8gTWluaW1hbCBkZWZhdWx0IG1vZGUuXG5Db2RlTWlycm9yLmRlZmluZU1vZGUoXCJudWxsXCIsZnVuY3Rpb24oKXtyZXR1cm57dG9rZW46ZnVuY3Rpb24oc3RyZWFtKXtyZXR1cm4gc3RyZWFtLnNraXBUb0VuZCgpO319O30pO0NvZGVNaXJyb3IuZGVmaW5lTUlNRShcInRleHQvcGxhaW5cIixcIm51bGxcIik7Ly8gRVhURU5TSU9OU1xuQ29kZU1pcnJvci5kZWZpbmVFeHRlbnNpb249ZnVuY3Rpb24obmFtZSxmdW5jKXtDb2RlTWlycm9yLnByb3RvdHlwZVtuYW1lXT1mdW5jO307Q29kZU1pcnJvci5kZWZpbmVEb2NFeHRlbnNpb249ZnVuY3Rpb24obmFtZSxmdW5jKXtEb2MucHJvdG90eXBlW25hbWVdPWZ1bmM7fTtDb2RlTWlycm9yLmZyb21UZXh0QXJlYT1mcm9tVGV4dEFyZWE7YWRkTGVnYWN5UHJvcHMoQ29kZU1pcnJvcik7Q29kZU1pcnJvci52ZXJzaW9uPVwiNS4yMC4yXCI7cmV0dXJuIENvZGVNaXJyb3I7fSk7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2NvZGVtaXJyb3IvbGliL2NvZGVtaXJyb3IuanNcbi8vIG1vZHVsZSBpZCA9IDU1XG4vLyBtb2R1bGUgY2h1bmtzID0gMiAyMCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9');
},131:function(module,exports,__webpack_require__){eval("var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/*\n* Project: Bootstrap Notify = v3.1.3\n* Description: Turns standard Bootstrap alerts into \"Growl-like\" notifications.\n* Author: Mouse0270 aka Robert McIntosh\n* License: MIT License\n* Website: https://github.com/mouse0270/bootstrap-growl\n*/\n(function (factory) {\n\tif (true) {\n\t\t// AMD. Register as an anonymous module.\n\t\t!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(1)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t} else if (typeof exports === 'object') {\n\t\t// Node/CommonJS\n\t\tfactory(require('jquery'));\n\t} else {\n\t\t// Browser globals\n\t\tfactory(jQuery);\n\t}\n})(function ($) {\n\t// Create the defaults once\n\tvar defaults = {\n\t\telement: 'body',\n\t\tposition: null,\n\t\ttype: \"info\",\n\t\tallow_dismiss: true,\n\t\tnewest_on_top: false,\n\t\tshowProgressbar: false,\n\t\tplacement: {\n\t\t\tfrom: \"top\",\n\t\t\talign: \"right\"\n\t\t},\n\t\toffset: 20,\n\t\tspacing: 10,\n\t\tz_index: 1031,\n\t\tdelay: 5000,\n\t\ttimer: 1000,\n\t\turl_target: '_blank',\n\t\tmouse_over: null,\n\t\tanimate: {\n\t\t\tenter: 'animated fadeInDown',\n\t\t\texit: 'animated fadeOutUp'\n\t\t},\n\t\tonShow: null,\n\t\tonShown: null,\n\t\tonClose: null,\n\t\tonClosed: null,\n\t\ticon_type: 'class',\n\t\ttemplate: '<div data-notify=\"container\" class=\"col-xs-11 col-sm-4 alert alert-{0}\" role=\"alert\"><button type=\"button\" aria-hidden=\"true\" class=\"close\" data-notify=\"dismiss\">&times;</button><span data-notify=\"icon\"></span> <span data-notify=\"title\">{1}</span> <span data-notify=\"message\">{2}</span><div class=\"progress\" data-notify=\"progressbar\"><div class=\"progress-bar progress-bar-{0}\" role=\"progressbar\" aria-valuenow=\"0\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 0%;\"></div></div><a href=\"{3}\" target=\"{4}\" data-notify=\"url\"></a></div>'\n\t};\n\n\tString.format = function () {\n\t\tvar str = arguments[0];\n\t\tfor (var i = 1; i < arguments.length; i++) {\n\t\t\tstr = str.replace(RegExp(\"\\\\{\" + (i - 1) + \"\\\\}\", \"gm\"), arguments[i]);\n\t\t}\n\t\treturn str;\n\t};\n\n\tfunction Notify(element, content, options) {\n\t\t// Setup Content of Notify\n\t\tvar content = {\n\t\t\tcontent: {\n\t\t\t\tmessage: typeof content == 'object' ? content.message : content,\n\t\t\t\ttitle: content.title ? content.title : '',\n\t\t\t\ticon: content.icon ? content.icon : '',\n\t\t\t\turl: content.url ? content.url : '#',\n\t\t\t\ttarget: content.target ? content.target : '-'\n\t\t\t}\n\t\t};\n\n\t\toptions = $.extend(true, {}, content, options);\n\t\tthis.settings = $.extend(true, {}, defaults, options);\n\t\tthis._defaults = defaults;\n\t\tif (this.settings.content.target == \"-\") {\n\t\t\tthis.settings.content.target = this.settings.url_target;\n\t\t}\n\t\tthis.animations = {\n\t\t\tstart: 'webkitAnimationStart oanimationstart MSAnimationStart animationstart',\n\t\t\tend: 'webkitAnimationEnd oanimationend MSAnimationEnd animationend'\n\t\t};\n\n\t\tif (typeof this.settings.offset == 'number') {\n\t\t\tthis.settings.offset = {\n\t\t\t\tx: this.settings.offset,\n\t\t\t\ty: this.settings.offset\n\t\t\t};\n\t\t}\n\n\t\tthis.init();\n\t};\n\n\t$.extend(Notify.prototype, {\n\t\tinit: function () {\n\t\t\tvar self = this;\n\n\t\t\tthis.buildNotify();\n\t\t\tif (this.settings.content.icon) {\n\t\t\t\tthis.setIcon();\n\t\t\t}\n\t\t\tif (this.settings.content.url != \"#\") {\n\t\t\t\tthis.styleURL();\n\t\t\t}\n\t\t\tthis.styleDismiss();\n\t\t\tthis.placement();\n\t\t\tthis.bind();\n\n\t\t\tthis.notify = {\n\t\t\t\t$ele: this.$ele,\n\t\t\t\tupdate: function (command, update) {\n\t\t\t\t\tvar commands = {};\n\t\t\t\t\tif (typeof command == \"string\") {\n\t\t\t\t\t\tcommands[command] = update;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcommands = command;\n\t\t\t\t\t}\n\t\t\t\t\tfor (var command in commands) {\n\t\t\t\t\t\tswitch (command) {\n\t\t\t\t\t\t\tcase \"type\":\n\t\t\t\t\t\t\t\tthis.$ele.removeClass('alert-' + self.settings.type);\n\t\t\t\t\t\t\t\tthis.$ele.find('[data-notify=\"progressbar\"] > .progress-bar').removeClass('progress-bar-' + self.settings.type);\n\t\t\t\t\t\t\t\tself.settings.type = commands[command];\n\t\t\t\t\t\t\t\tthis.$ele.addClass('alert-' + commands[command]).find('[data-notify=\"progressbar\"] > .progress-bar').addClass('progress-bar-' + commands[command]);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"icon\":\n\t\t\t\t\t\t\t\tvar $icon = this.$ele.find('[data-notify=\"icon\"]');\n\t\t\t\t\t\t\t\tif (self.settings.icon_type.toLowerCase() == 'class') {\n\t\t\t\t\t\t\t\t\t$icon.removeClass(self.settings.content.icon).addClass(commands[command]);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif (!$icon.is('img')) {\n\t\t\t\t\t\t\t\t\t\t$icon.find('img');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t$icon.attr('src', commands[command]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"progress\":\n\t\t\t\t\t\t\t\tvar newDelay = self.settings.delay - self.settings.delay * (commands[command] / 100);\n\t\t\t\t\t\t\t\tthis.$ele.data('notify-delay', newDelay);\n\t\t\t\t\t\t\t\tthis.$ele.find('[data-notify=\"progressbar\"] > div').attr('aria-valuenow', commands[command]).css('width', commands[command] + '%');\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"url\":\n\t\t\t\t\t\t\t\tthis.$ele.find('[data-notify=\"url\"]').attr('href', commands[command]);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"target\":\n\t\t\t\t\t\t\t\tthis.$ele.find('[data-notify=\"url\"]').attr('target', commands[command]);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tthis.$ele.find('[data-notify=\"' + command + '\"]').html(commands[command]);\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tvar posX = this.$ele.outerHeight() + parseInt(self.settings.spacing) + parseInt(self.settings.offset.y);\n\t\t\t\t\tself.reposition(posX);\n\t\t\t\t},\n\t\t\t\tclose: function () {\n\t\t\t\t\tself.close();\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tbuildNotify: function () {\n\t\t\tvar content = this.settings.content;\n\t\t\tthis.$ele = $(String.format(this.settings.template, this.settings.type, content.title, content.message, content.url, content.target));\n\t\t\tthis.$ele.attr('data-notify-position', this.settings.placement.from + '-' + this.settings.placement.align);\n\t\t\tif (!this.settings.allow_dismiss) {\n\t\t\t\tthis.$ele.find('[data-notify=\"dismiss\"]').css('display', 'none');\n\t\t\t}\n\t\t\tif (this.settings.delay <= 0 && !this.settings.showProgressbar || !this.settings.showProgressbar) {\n\t\t\t\tthis.$ele.find('[data-notify=\"progressbar\"]').remove();\n\t\t\t}\n\t\t},\n\t\tsetIcon: function () {\n\t\t\tif (this.settings.icon_type.toLowerCase() == 'class') {\n\t\t\t\tthis.$ele.find('[data-notify=\"icon\"]').addClass(this.settings.content.icon);\n\t\t\t} else {\n\t\t\t\tif (this.$ele.find('[data-notify=\"icon\"]').is('img')) {\n\t\t\t\t\tthis.$ele.find('[data-notify=\"icon\"]').attr('src', this.settings.content.icon);\n\t\t\t\t} else {\n\t\t\t\t\tthis.$ele.find('[data-notify=\"icon\"]').append('<img src=\"' + this.settings.content.icon + '\" alt=\"Notify Icon\" />');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tstyleDismiss: function () {\n\t\t\tthis.$ele.find('[data-notify=\"dismiss\"]').css({\n\t\t\t\tposition: 'absolute',\n\t\t\t\tright: '10px',\n\t\t\t\ttop: '5px',\n\t\t\t\tzIndex: this.settings.z_index + 2\n\t\t\t});\n\t\t},\n\t\tstyleURL: function () {\n\t\t\tthis.$ele.find('[data-notify=\"url\"]').css({\n\t\t\t\tbackgroundImage: 'url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)',\n\t\t\t\theight: '100%',\n\t\t\t\tleft: '0px',\n\t\t\t\tposition: 'absolute',\n\t\t\t\ttop: '0px',\n\t\t\t\twidth: '100%',\n\t\t\t\tzIndex: this.settings.z_index + 1\n\t\t\t});\n\t\t},\n\t\tplacement: function () {\n\t\t\tvar self = this,\n\t\t\t    offsetAmt = this.settings.offset.y,\n\t\t\t    css = {\n\t\t\t\tdisplay: 'inline-block',\n\t\t\t\tmargin: '0px auto',\n\t\t\t\tposition: this.settings.position ? this.settings.position : this.settings.element === 'body' ? 'fixed' : 'absolute',\n\t\t\t\ttransition: 'all .5s ease-in-out',\n\t\t\t\tzIndex: this.settings.z_index\n\t\t\t},\n\t\t\t    hasAnimation = false,\n\t\t\t    settings = this.settings;\n\n\t\t\t$('[data-notify-position=\"' + this.settings.placement.from + '-' + this.settings.placement.align + '\"]:not([data-closing=\"true\"])').each(function () {\n\t\t\t\treturn offsetAmt = Math.max(offsetAmt, parseInt($(this).css(settings.placement.from)) + parseInt($(this).outerHeight()) + parseInt(settings.spacing));\n\t\t\t});\n\t\t\tif (this.settings.newest_on_top == true) {\n\t\t\t\toffsetAmt = this.settings.offset.y;\n\t\t\t}\n\t\t\tcss[this.settings.placement.from] = offsetAmt + 'px';\n\n\t\t\tswitch (this.settings.placement.align) {\n\t\t\t\tcase \"left\":\n\t\t\t\tcase \"right\":\n\t\t\t\t\tcss[this.settings.placement.align] = this.settings.offset.x + 'px';\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"center\":\n\t\t\t\t\tcss.left = 0;\n\t\t\t\t\tcss.right = 0;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tthis.$ele.css(css).addClass(this.settings.animate.enter);\n\t\t\t$.each(Array('webkit-', 'moz-', 'o-', 'ms-', ''), function (index, prefix) {\n\t\t\t\tself.$ele[0].style[prefix + 'AnimationIterationCount'] = 1;\n\t\t\t});\n\n\t\t\t$(this.settings.element).append(this.$ele);\n\n\t\t\tif (this.settings.newest_on_top == true) {\n\t\t\t\toffsetAmt = parseInt(offsetAmt) + parseInt(this.settings.spacing) + this.$ele.outerHeight();\n\t\t\t\tthis.reposition(offsetAmt);\n\t\t\t}\n\n\t\t\tif ($.isFunction(self.settings.onShow)) {\n\t\t\t\tself.settings.onShow.call(this.$ele);\n\t\t\t}\n\n\t\t\tthis.$ele.one(this.animations.start, function (event) {\n\t\t\t\thasAnimation = true;\n\t\t\t}).one(this.animations.end, function (event) {\n\t\t\t\tif ($.isFunction(self.settings.onShown)) {\n\t\t\t\t\tself.settings.onShown.call(this);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tsetTimeout(function () {\n\t\t\t\tif (!hasAnimation) {\n\t\t\t\t\tif ($.isFunction(self.settings.onShown)) {\n\t\t\t\t\t\tself.settings.onShown.call(this);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, 600);\n\t\t},\n\t\tbind: function () {\n\t\t\tvar self = this;\n\n\t\t\tthis.$ele.find('[data-notify=\"dismiss\"]').on('click', function () {\n\t\t\t\tself.close();\n\t\t\t});\n\n\t\t\tthis.$ele.mouseover(function (e) {\n\t\t\t\t$(this).data('data-hover', \"true\");\n\t\t\t}).mouseout(function (e) {\n\t\t\t\t$(this).data('data-hover', \"false\");\n\t\t\t});\n\t\t\tthis.$ele.data('data-hover', \"false\");\n\n\t\t\tif (this.settings.delay > 0) {\n\t\t\t\tself.$ele.data('notify-delay', self.settings.delay);\n\t\t\t\tvar timer = setInterval(function () {\n\t\t\t\t\tvar delay = parseInt(self.$ele.data('notify-delay')) - self.settings.timer;\n\t\t\t\t\tif (self.$ele.data('data-hover') === 'false' && self.settings.mouse_over == \"pause\" || self.settings.mouse_over != \"pause\") {\n\t\t\t\t\t\tvar percent = (self.settings.delay - delay) / self.settings.delay * 100;\n\t\t\t\t\t\tself.$ele.data('notify-delay', delay);\n\t\t\t\t\t\tself.$ele.find('[data-notify=\"progressbar\"] > div').attr('aria-valuenow', percent).css('width', percent + '%');\n\t\t\t\t\t}\n\t\t\t\t\tif (delay <= -self.settings.timer) {\n\t\t\t\t\t\tclearInterval(timer);\n\t\t\t\t\t\tself.close();\n\t\t\t\t\t}\n\t\t\t\t}, self.settings.timer);\n\t\t\t}\n\t\t},\n\t\tclose: function () {\n\t\t\tvar self = this,\n\t\t\t    $successors = null,\n\t\t\t    posX = parseInt(this.$ele.css(this.settings.placement.from)),\n\t\t\t    hasAnimation = false;\n\n\t\t\tthis.$ele.data('closing', 'true').addClass(this.settings.animate.exit);\n\t\t\tself.reposition(posX);\n\n\t\t\tif ($.isFunction(self.settings.onClose)) {\n\t\t\t\tself.settings.onClose.call(this.$ele);\n\t\t\t}\n\n\t\t\tthis.$ele.one(this.animations.start, function (event) {\n\t\t\t\thasAnimation = true;\n\t\t\t}).one(this.animations.end, function (event) {\n\t\t\t\t$(this).remove();\n\t\t\t\tif ($.isFunction(self.settings.onClosed)) {\n\t\t\t\t\tself.settings.onClosed.call(this);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tsetTimeout(function () {\n\t\t\t\tif (!hasAnimation) {\n\t\t\t\t\tself.$ele.remove();\n\t\t\t\t\tif (self.settings.onClosed) {\n\t\t\t\t\t\tself.settings.onClosed(self.$ele);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, 600);\n\t\t},\n\t\treposition: function (posX) {\n\t\t\tvar self = this,\n\t\t\t    notifies = '[data-notify-position=\"' + this.settings.placement.from + '-' + this.settings.placement.align + '\"]:not([data-closing=\"true\"])',\n\t\t\t    $elements = this.$ele.nextAll(notifies);\n\t\t\tif (this.settings.newest_on_top == true) {\n\t\t\t\t$elements = this.$ele.prevAll(notifies);\n\t\t\t}\n\t\t\t$elements.each(function () {\n\t\t\t\t$(this).css(self.settings.placement.from, posX);\n\t\t\t\tposX = parseInt(posX) + parseInt(self.settings.spacing) + $(this).outerHeight();\n\t\t\t});\n\t\t}\n\t});\n\n\t$.notify = function (content, options) {\n\t\tvar plugin = new Notify(this, content, options);\n\t\treturn plugin.notify;\n\t};\n\t$.notifyDefaults = function (options) {\n\t\tdefaults = $.extend(true, {}, defaults, options);\n\t\treturn defaults;\n\t};\n\t$.notifyClose = function (command) {\n\t\tif (typeof command === \"undefined\" || command == \"all\") {\n\t\t\t$('[data-notify]').find('[data-notify=\"dismiss\"]').trigger('click');\n\t\t} else {\n\t\t\t$('[data-notify-position=\"' + command + '\"]').find('[data-notify=\"dismiss\"]').trigger('click');\n\t\t}\n\t};\n});//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTMxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vfi9ib290c3RyYXAtZ3Jvd2wvYm9vdHN0cmFwLW5vdGlmeS5qcz9jNDU4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qXG4qIFByb2plY3Q6IEJvb3RzdHJhcCBOb3RpZnkgPSB2My4xLjNcbiogRGVzY3JpcHRpb246IFR1cm5zIHN0YW5kYXJkIEJvb3RzdHJhcCBhbGVydHMgaW50byBcIkdyb3dsLWxpa2VcIiBub3RpZmljYXRpb25zLlxuKiBBdXRob3I6IE1vdXNlMDI3MCBha2EgUm9iZXJ0IE1jSW50b3NoXG4qIExpY2Vuc2U6IE1JVCBMaWNlbnNlXG4qIFdlYnNpdGU6IGh0dHBzOi8vZ2l0aHViLmNvbS9tb3VzZTAyNzAvYm9vdHN0cmFwLWdyb3dsXG4qL1xuKGZ1bmN0aW9uIChmYWN0b3J5KSB7XG5cdGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcblx0XHQvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG5cdFx0ZGVmaW5lKFsnanF1ZXJ5J10sIGZhY3RvcnkpO1xuXHR9IGVsc2UgaWYgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jykge1xuXHRcdC8vIE5vZGUvQ29tbW9uSlNcblx0XHRmYWN0b3J5KHJlcXVpcmUoJ2pxdWVyeScpKTtcblx0fSBlbHNlIHtcblx0XHQvLyBCcm93c2VyIGdsb2JhbHNcblx0XHRmYWN0b3J5KGpRdWVyeSk7XG5cdH1cbn0pKGZ1bmN0aW9uICgkKSB7XG5cdC8vIENyZWF0ZSB0aGUgZGVmYXVsdHMgb25jZVxuXHR2YXIgZGVmYXVsdHMgPSB7XG5cdFx0ZWxlbWVudDogJ2JvZHknLFxuXHRcdHBvc2l0aW9uOiBudWxsLFxuXHRcdHR5cGU6IFwiaW5mb1wiLFxuXHRcdGFsbG93X2Rpc21pc3M6IHRydWUsXG5cdFx0bmV3ZXN0X29uX3RvcDogZmFsc2UsXG5cdFx0c2hvd1Byb2dyZXNzYmFyOiBmYWxzZSxcblx0XHRwbGFjZW1lbnQ6IHtcblx0XHRcdGZyb206IFwidG9wXCIsXG5cdFx0XHRhbGlnbjogXCJyaWdodFwiXG5cdFx0fSxcblx0XHRvZmZzZXQ6IDIwLFxuXHRcdHNwYWNpbmc6IDEwLFxuXHRcdHpfaW5kZXg6IDEwMzEsXG5cdFx0ZGVsYXk6IDUwMDAsXG5cdFx0dGltZXI6IDEwMDAsXG5cdFx0dXJsX3RhcmdldDogJ19ibGFuaycsXG5cdFx0bW91c2Vfb3ZlcjogbnVsbCxcblx0XHRhbmltYXRlOiB7XG5cdFx0XHRlbnRlcjogJ2FuaW1hdGVkIGZhZGVJbkRvd24nLFxuXHRcdFx0ZXhpdDogJ2FuaW1hdGVkIGZhZGVPdXRVcCdcblx0XHR9LFxuXHRcdG9uU2hvdzogbnVsbCxcblx0XHRvblNob3duOiBudWxsLFxuXHRcdG9uQ2xvc2U6IG51bGwsXG5cdFx0b25DbG9zZWQ6IG51bGwsXG5cdFx0aWNvbl90eXBlOiAnY2xhc3MnLFxuXHRcdHRlbXBsYXRlOiAnPGRpdiBkYXRhLW5vdGlmeT1cImNvbnRhaW5lclwiIGNsYXNzPVwiY29sLXhzLTExIGNvbC1zbS00IGFsZXJ0IGFsZXJ0LXswfVwiIHJvbGU9XCJhbGVydFwiPjxidXR0b24gdHlwZT1cImJ1dHRvblwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiIGNsYXNzPVwiY2xvc2VcIiBkYXRhLW5vdGlmeT1cImRpc21pc3NcIj4mdGltZXM7PC9idXR0b24+PHNwYW4gZGF0YS1ub3RpZnk9XCJpY29uXCI+PC9zcGFuPiA8c3BhbiBkYXRhLW5vdGlmeT1cInRpdGxlXCI+ezF9PC9zcGFuPiA8c3BhbiBkYXRhLW5vdGlmeT1cIm1lc3NhZ2VcIj57Mn08L3NwYW4+PGRpdiBjbGFzcz1cInByb2dyZXNzXCIgZGF0YS1ub3RpZnk9XCJwcm9ncmVzc2JhclwiPjxkaXYgY2xhc3M9XCJwcm9ncmVzcy1iYXIgcHJvZ3Jlc3MtYmFyLXswfVwiIHJvbGU9XCJwcm9ncmVzc2JhclwiIGFyaWEtdmFsdWVub3c9XCIwXCIgYXJpYS12YWx1ZW1pbj1cIjBcIiBhcmlhLXZhbHVlbWF4PVwiMTAwXCIgc3R5bGU9XCJ3aWR0aDogMCU7XCI+PC9kaXY+PC9kaXY+PGEgaHJlZj1cInszfVwiIHRhcmdldD1cIns0fVwiIGRhdGEtbm90aWZ5PVwidXJsXCI+PC9hPjwvZGl2Pidcblx0fTtcblxuXHRTdHJpbmcuZm9ybWF0ID0gZnVuY3Rpb24gKCkge1xuXHRcdHZhciBzdHIgPSBhcmd1bWVudHNbMF07XG5cdFx0Zm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdHN0ciA9IHN0ci5yZXBsYWNlKFJlZ0V4cChcIlxcXFx7XCIgKyAoaSAtIDEpICsgXCJcXFxcfVwiLCBcImdtXCIpLCBhcmd1bWVudHNbaV0pO1xuXHRcdH1cblx0XHRyZXR1cm4gc3RyO1xuXHR9O1xuXG5cdGZ1bmN0aW9uIE5vdGlmeShlbGVtZW50LCBjb250ZW50LCBvcHRpb25zKSB7XG5cdFx0Ly8gU2V0dXAgQ29udGVudCBvZiBOb3RpZnlcblx0XHR2YXIgY29udGVudCA9IHtcblx0XHRcdGNvbnRlbnQ6IHtcblx0XHRcdFx0bWVzc2FnZTogdHlwZW9mIGNvbnRlbnQgPT0gJ29iamVjdCcgPyBjb250ZW50Lm1lc3NhZ2UgOiBjb250ZW50LFxuXHRcdFx0XHR0aXRsZTogY29udGVudC50aXRsZSA/IGNvbnRlbnQudGl0bGUgOiAnJyxcblx0XHRcdFx0aWNvbjogY29udGVudC5pY29uID8gY29udGVudC5pY29uIDogJycsXG5cdFx0XHRcdHVybDogY29udGVudC51cmwgPyBjb250ZW50LnVybCA6ICcjJyxcblx0XHRcdFx0dGFyZ2V0OiBjb250ZW50LnRhcmdldCA/IGNvbnRlbnQudGFyZ2V0IDogJy0nXG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdG9wdGlvbnMgPSAkLmV4dGVuZCh0cnVlLCB7fSwgY29udGVudCwgb3B0aW9ucyk7XG5cdFx0dGhpcy5zZXR0aW5ncyA9ICQuZXh0ZW5kKHRydWUsIHt9LCBkZWZhdWx0cywgb3B0aW9ucyk7XG5cdFx0dGhpcy5fZGVmYXVsdHMgPSBkZWZhdWx0cztcblx0XHRpZiAodGhpcy5zZXR0aW5ncy5jb250ZW50LnRhcmdldCA9PSBcIi1cIikge1xuXHRcdFx0dGhpcy5zZXR0aW5ncy5jb250ZW50LnRhcmdldCA9IHRoaXMuc2V0dGluZ3MudXJsX3RhcmdldDtcblx0XHR9XG5cdFx0dGhpcy5hbmltYXRpb25zID0ge1xuXHRcdFx0c3RhcnQ6ICd3ZWJraXRBbmltYXRpb25TdGFydCBvYW5pbWF0aW9uc3RhcnQgTVNBbmltYXRpb25TdGFydCBhbmltYXRpb25zdGFydCcsXG5cdFx0XHRlbmQ6ICd3ZWJraXRBbmltYXRpb25FbmQgb2FuaW1hdGlvbmVuZCBNU0FuaW1hdGlvbkVuZCBhbmltYXRpb25lbmQnXG5cdFx0fTtcblxuXHRcdGlmICh0eXBlb2YgdGhpcy5zZXR0aW5ncy5vZmZzZXQgPT0gJ251bWJlcicpIHtcblx0XHRcdHRoaXMuc2V0dGluZ3Mub2Zmc2V0ID0ge1xuXHRcdFx0XHR4OiB0aGlzLnNldHRpbmdzLm9mZnNldCxcblx0XHRcdFx0eTogdGhpcy5zZXR0aW5ncy5vZmZzZXRcblx0XHRcdH07XG5cdFx0fVxuXG5cdFx0dGhpcy5pbml0KCk7XG5cdH07XG5cblx0JC5leHRlbmQoTm90aWZ5LnByb3RvdHlwZSwge1xuXHRcdGluaXQ6IGZ1bmN0aW9uICgpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0dGhpcy5idWlsZE5vdGlmeSgpO1xuXHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MuY29udGVudC5pY29uKSB7XG5cdFx0XHRcdHRoaXMuc2V0SWNvbigpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MuY29udGVudC51cmwgIT0gXCIjXCIpIHtcblx0XHRcdFx0dGhpcy5zdHlsZVVSTCgpO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy5zdHlsZURpc21pc3MoKTtcblx0XHRcdHRoaXMucGxhY2VtZW50KCk7XG5cdFx0XHR0aGlzLmJpbmQoKTtcblxuXHRcdFx0dGhpcy5ub3RpZnkgPSB7XG5cdFx0XHRcdCRlbGU6IHRoaXMuJGVsZSxcblx0XHRcdFx0dXBkYXRlOiBmdW5jdGlvbiAoY29tbWFuZCwgdXBkYXRlKSB7XG5cdFx0XHRcdFx0dmFyIGNvbW1hbmRzID0ge307XG5cdFx0XHRcdFx0aWYgKHR5cGVvZiBjb21tYW5kID09IFwic3RyaW5nXCIpIHtcblx0XHRcdFx0XHRcdGNvbW1hbmRzW2NvbW1hbmRdID0gdXBkYXRlO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRjb21tYW5kcyA9IGNvbW1hbmQ7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGZvciAodmFyIGNvbW1hbmQgaW4gY29tbWFuZHMpIHtcblx0XHRcdFx0XHRcdHN3aXRjaCAoY29tbWFuZCkge1xuXHRcdFx0XHRcdFx0XHRjYXNlIFwidHlwZVwiOlxuXHRcdFx0XHRcdFx0XHRcdHRoaXMuJGVsZS5yZW1vdmVDbGFzcygnYWxlcnQtJyArIHNlbGYuc2V0dGluZ3MudHlwZSk7XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy4kZWxlLmZpbmQoJ1tkYXRhLW5vdGlmeT1cInByb2dyZXNzYmFyXCJdID4gLnByb2dyZXNzLWJhcicpLnJlbW92ZUNsYXNzKCdwcm9ncmVzcy1iYXItJyArIHNlbGYuc2V0dGluZ3MudHlwZSk7XG5cdFx0XHRcdFx0XHRcdFx0c2VsZi5zZXR0aW5ncy50eXBlID0gY29tbWFuZHNbY29tbWFuZF07XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy4kZWxlLmFkZENsYXNzKCdhbGVydC0nICsgY29tbWFuZHNbY29tbWFuZF0pLmZpbmQoJ1tkYXRhLW5vdGlmeT1cInByb2dyZXNzYmFyXCJdID4gLnByb2dyZXNzLWJhcicpLmFkZENsYXNzKCdwcm9ncmVzcy1iYXItJyArIGNvbW1hbmRzW2NvbW1hbmRdKTtcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdFx0Y2FzZSBcImljb25cIjpcblx0XHRcdFx0XHRcdFx0XHR2YXIgJGljb24gPSB0aGlzLiRlbGUuZmluZCgnW2RhdGEtbm90aWZ5PVwiaWNvblwiXScpO1xuXHRcdFx0XHRcdFx0XHRcdGlmIChzZWxmLnNldHRpbmdzLmljb25fdHlwZS50b0xvd2VyQ2FzZSgpID09ICdjbGFzcycpIHtcblx0XHRcdFx0XHRcdFx0XHRcdCRpY29uLnJlbW92ZUNsYXNzKHNlbGYuc2V0dGluZ3MuY29udGVudC5pY29uKS5hZGRDbGFzcyhjb21tYW5kc1tjb21tYW5kXSk7XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdGlmICghJGljb24uaXMoJ2ltZycpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdCRpY29uLmZpbmQoJ2ltZycpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0JGljb24uYXR0cignc3JjJywgY29tbWFuZHNbY29tbWFuZF0pO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdFx0Y2FzZSBcInByb2dyZXNzXCI6XG5cdFx0XHRcdFx0XHRcdFx0dmFyIG5ld0RlbGF5ID0gc2VsZi5zZXR0aW5ncy5kZWxheSAtIHNlbGYuc2V0dGluZ3MuZGVsYXkgKiAoY29tbWFuZHNbY29tbWFuZF0gLyAxMDApO1xuXHRcdFx0XHRcdFx0XHRcdHRoaXMuJGVsZS5kYXRhKCdub3RpZnktZGVsYXknLCBuZXdEZWxheSk7XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy4kZWxlLmZpbmQoJ1tkYXRhLW5vdGlmeT1cInByb2dyZXNzYmFyXCJdID4gZGl2JykuYXR0cignYXJpYS12YWx1ZW5vdycsIGNvbW1hbmRzW2NvbW1hbmRdKS5jc3MoJ3dpZHRoJywgY29tbWFuZHNbY29tbWFuZF0gKyAnJScpO1xuXHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XHRjYXNlIFwidXJsXCI6XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy4kZWxlLmZpbmQoJ1tkYXRhLW5vdGlmeT1cInVybFwiXScpLmF0dHIoJ2hyZWYnLCBjb21tYW5kc1tjb21tYW5kXSk7XG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdGNhc2UgXCJ0YXJnZXRcIjpcblx0XHRcdFx0XHRcdFx0XHR0aGlzLiRlbGUuZmluZCgnW2RhdGEtbm90aWZ5PVwidXJsXCJdJykuYXR0cigndGFyZ2V0JywgY29tbWFuZHNbY29tbWFuZF0pO1xuXHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdFx0XHRcdHRoaXMuJGVsZS5maW5kKCdbZGF0YS1ub3RpZnk9XCInICsgY29tbWFuZCArICdcIl0nKS5odG1sKGNvbW1hbmRzW2NvbW1hbmRdKTtcblx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHZhciBwb3NYID0gdGhpcy4kZWxlLm91dGVySGVpZ2h0KCkgKyBwYXJzZUludChzZWxmLnNldHRpbmdzLnNwYWNpbmcpICsgcGFyc2VJbnQoc2VsZi5zZXR0aW5ncy5vZmZzZXQueSk7XG5cdFx0XHRcdFx0c2VsZi5yZXBvc2l0aW9uKHBvc1gpO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRjbG9zZTogZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdHNlbGYuY2xvc2UoKTtcblx0XHRcdFx0fVxuXHRcdFx0fTtcblx0XHR9LFxuXHRcdGJ1aWxkTm90aWZ5OiBmdW5jdGlvbiAoKSB7XG5cdFx0XHR2YXIgY29udGVudCA9IHRoaXMuc2V0dGluZ3MuY29udGVudDtcblx0XHRcdHRoaXMuJGVsZSA9ICQoU3RyaW5nLmZvcm1hdCh0aGlzLnNldHRpbmdzLnRlbXBsYXRlLCB0aGlzLnNldHRpbmdzLnR5cGUsIGNvbnRlbnQudGl0bGUsIGNvbnRlbnQubWVzc2FnZSwgY29udGVudC51cmwsIGNvbnRlbnQudGFyZ2V0KSk7XG5cdFx0XHR0aGlzLiRlbGUuYXR0cignZGF0YS1ub3RpZnktcG9zaXRpb24nLCB0aGlzLnNldHRpbmdzLnBsYWNlbWVudC5mcm9tICsgJy0nICsgdGhpcy5zZXR0aW5ncy5wbGFjZW1lbnQuYWxpZ24pO1xuXHRcdFx0aWYgKCF0aGlzLnNldHRpbmdzLmFsbG93X2Rpc21pc3MpIHtcblx0XHRcdFx0dGhpcy4kZWxlLmZpbmQoJ1tkYXRhLW5vdGlmeT1cImRpc21pc3NcIl0nKS5jc3MoJ2Rpc3BsYXknLCAnbm9uZScpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MuZGVsYXkgPD0gMCAmJiAhdGhpcy5zZXR0aW5ncy5zaG93UHJvZ3Jlc3NiYXIgfHwgIXRoaXMuc2V0dGluZ3Muc2hvd1Byb2dyZXNzYmFyKSB7XG5cdFx0XHRcdHRoaXMuJGVsZS5maW5kKCdbZGF0YS1ub3RpZnk9XCJwcm9ncmVzc2JhclwiXScpLnJlbW92ZSgpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0c2V0SWNvbjogZnVuY3Rpb24gKCkge1xuXHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MuaWNvbl90eXBlLnRvTG93ZXJDYXNlKCkgPT0gJ2NsYXNzJykge1xuXHRcdFx0XHR0aGlzLiRlbGUuZmluZCgnW2RhdGEtbm90aWZ5PVwiaWNvblwiXScpLmFkZENsYXNzKHRoaXMuc2V0dGluZ3MuY29udGVudC5pY29uKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGlmICh0aGlzLiRlbGUuZmluZCgnW2RhdGEtbm90aWZ5PVwiaWNvblwiXScpLmlzKCdpbWcnKSkge1xuXHRcdFx0XHRcdHRoaXMuJGVsZS5maW5kKCdbZGF0YS1ub3RpZnk9XCJpY29uXCJdJykuYXR0cignc3JjJywgdGhpcy5zZXR0aW5ncy5jb250ZW50Lmljb24pO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRoaXMuJGVsZS5maW5kKCdbZGF0YS1ub3RpZnk9XCJpY29uXCJdJykuYXBwZW5kKCc8aW1nIHNyYz1cIicgKyB0aGlzLnNldHRpbmdzLmNvbnRlbnQuaWNvbiArICdcIiBhbHQ9XCJOb3RpZnkgSWNvblwiIC8+Jyk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9LFxuXHRcdHN0eWxlRGlzbWlzczogZnVuY3Rpb24gKCkge1xuXHRcdFx0dGhpcy4kZWxlLmZpbmQoJ1tkYXRhLW5vdGlmeT1cImRpc21pc3NcIl0nKS5jc3Moe1xuXHRcdFx0XHRwb3NpdGlvbjogJ2Fic29sdXRlJyxcblx0XHRcdFx0cmlnaHQ6ICcxMHB4Jyxcblx0XHRcdFx0dG9wOiAnNXB4Jyxcblx0XHRcdFx0ekluZGV4OiB0aGlzLnNldHRpbmdzLnpfaW5kZXggKyAyXG5cdFx0XHR9KTtcblx0XHR9LFxuXHRcdHN0eWxlVVJMOiBmdW5jdGlvbiAoKSB7XG5cdFx0XHR0aGlzLiRlbGUuZmluZCgnW2RhdGEtbm90aWZ5PVwidXJsXCJdJykuY3NzKHtcblx0XHRcdFx0YmFja2dyb3VuZEltYWdlOiAndXJsKGRhdGE6aW1hZ2UvZ2lmO2Jhc2U2NCxSMGxHT0RsaEFRQUJBSUFBQUFBQUFQLy8veUg1QkFFQUFBQUFMQUFBQUFBQkFBRUFBQUlCUkFBNyknLFxuXHRcdFx0XHRoZWlnaHQ6ICcxMDAlJyxcblx0XHRcdFx0bGVmdDogJzBweCcsXG5cdFx0XHRcdHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuXHRcdFx0XHR0b3A6ICcwcHgnLFxuXHRcdFx0XHR3aWR0aDogJzEwMCUnLFxuXHRcdFx0XHR6SW5kZXg6IHRoaXMuc2V0dGluZ3Muel9pbmRleCArIDFcblx0XHRcdH0pO1xuXHRcdH0sXG5cdFx0cGxhY2VtZW50OiBmdW5jdGlvbiAoKSB7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXMsXG5cdFx0XHQgICAgb2Zmc2V0QW10ID0gdGhpcy5zZXR0aW5ncy5vZmZzZXQueSxcblx0XHRcdCAgICBjc3MgPSB7XG5cdFx0XHRcdGRpc3BsYXk6ICdpbmxpbmUtYmxvY2snLFxuXHRcdFx0XHRtYXJnaW46ICcwcHggYXV0bycsXG5cdFx0XHRcdHBvc2l0aW9uOiB0aGlzLnNldHRpbmdzLnBvc2l0aW9uID8gdGhpcy5zZXR0aW5ncy5wb3NpdGlvbiA6IHRoaXMuc2V0dGluZ3MuZWxlbWVudCA9PT0gJ2JvZHknID8gJ2ZpeGVkJyA6ICdhYnNvbHV0ZScsXG5cdFx0XHRcdHRyYW5zaXRpb246ICdhbGwgLjVzIGVhc2UtaW4tb3V0Jyxcblx0XHRcdFx0ekluZGV4OiB0aGlzLnNldHRpbmdzLnpfaW5kZXhcblx0XHRcdH0sXG5cdFx0XHQgICAgaGFzQW5pbWF0aW9uID0gZmFsc2UsXG5cdFx0XHQgICAgc2V0dGluZ3MgPSB0aGlzLnNldHRpbmdzO1xuXG5cdFx0XHQkKCdbZGF0YS1ub3RpZnktcG9zaXRpb249XCInICsgdGhpcy5zZXR0aW5ncy5wbGFjZW1lbnQuZnJvbSArICctJyArIHRoaXMuc2V0dGluZ3MucGxhY2VtZW50LmFsaWduICsgJ1wiXTpub3QoW2RhdGEtY2xvc2luZz1cInRydWVcIl0pJykuZWFjaChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdHJldHVybiBvZmZzZXRBbXQgPSBNYXRoLm1heChvZmZzZXRBbXQsIHBhcnNlSW50KCQodGhpcykuY3NzKHNldHRpbmdzLnBsYWNlbWVudC5mcm9tKSkgKyBwYXJzZUludCgkKHRoaXMpLm91dGVySGVpZ2h0KCkpICsgcGFyc2VJbnQoc2V0dGluZ3Muc3BhY2luZykpO1xuXHRcdFx0fSk7XG5cdFx0XHRpZiAodGhpcy5zZXR0aW5ncy5uZXdlc3Rfb25fdG9wID09IHRydWUpIHtcblx0XHRcdFx0b2Zmc2V0QW10ID0gdGhpcy5zZXR0aW5ncy5vZmZzZXQueTtcblx0XHRcdH1cblx0XHRcdGNzc1t0aGlzLnNldHRpbmdzLnBsYWNlbWVudC5mcm9tXSA9IG9mZnNldEFtdCArICdweCc7XG5cblx0XHRcdHN3aXRjaCAodGhpcy5zZXR0aW5ncy5wbGFjZW1lbnQuYWxpZ24pIHtcblx0XHRcdFx0Y2FzZSBcImxlZnRcIjpcblx0XHRcdFx0Y2FzZSBcInJpZ2h0XCI6XG5cdFx0XHRcdFx0Y3NzW3RoaXMuc2V0dGluZ3MucGxhY2VtZW50LmFsaWduXSA9IHRoaXMuc2V0dGluZ3Mub2Zmc2V0LnggKyAncHgnO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIFwiY2VudGVyXCI6XG5cdFx0XHRcdFx0Y3NzLmxlZnQgPSAwO1xuXHRcdFx0XHRcdGNzcy5yaWdodCA9IDA7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLiRlbGUuY3NzKGNzcykuYWRkQ2xhc3ModGhpcy5zZXR0aW5ncy5hbmltYXRlLmVudGVyKTtcblx0XHRcdCQuZWFjaChBcnJheSgnd2Via2l0LScsICdtb3otJywgJ28tJywgJ21zLScsICcnKSwgZnVuY3Rpb24gKGluZGV4LCBwcmVmaXgpIHtcblx0XHRcdFx0c2VsZi4kZWxlWzBdLnN0eWxlW3ByZWZpeCArICdBbmltYXRpb25JdGVyYXRpb25Db3VudCddID0gMTtcblx0XHRcdH0pO1xuXG5cdFx0XHQkKHRoaXMuc2V0dGluZ3MuZWxlbWVudCkuYXBwZW5kKHRoaXMuJGVsZSk7XG5cblx0XHRcdGlmICh0aGlzLnNldHRpbmdzLm5ld2VzdF9vbl90b3AgPT0gdHJ1ZSkge1xuXHRcdFx0XHRvZmZzZXRBbXQgPSBwYXJzZUludChvZmZzZXRBbXQpICsgcGFyc2VJbnQodGhpcy5zZXR0aW5ncy5zcGFjaW5nKSArIHRoaXMuJGVsZS5vdXRlckhlaWdodCgpO1xuXHRcdFx0XHR0aGlzLnJlcG9zaXRpb24ob2Zmc2V0QW10KTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCQuaXNGdW5jdGlvbihzZWxmLnNldHRpbmdzLm9uU2hvdykpIHtcblx0XHRcdFx0c2VsZi5zZXR0aW5ncy5vblNob3cuY2FsbCh0aGlzLiRlbGUpO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLiRlbGUub25lKHRoaXMuYW5pbWF0aW9ucy5zdGFydCwgZnVuY3Rpb24gKGV2ZW50KSB7XG5cdFx0XHRcdGhhc0FuaW1hdGlvbiA9IHRydWU7XG5cdFx0XHR9KS5vbmUodGhpcy5hbmltYXRpb25zLmVuZCwgZnVuY3Rpb24gKGV2ZW50KSB7XG5cdFx0XHRcdGlmICgkLmlzRnVuY3Rpb24oc2VsZi5zZXR0aW5ncy5vblNob3duKSkge1xuXHRcdFx0XHRcdHNlbGYuc2V0dGluZ3Mub25TaG93bi5jYWxsKHRoaXMpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0c2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdGlmICghaGFzQW5pbWF0aW9uKSB7XG5cdFx0XHRcdFx0aWYgKCQuaXNGdW5jdGlvbihzZWxmLnNldHRpbmdzLm9uU2hvd24pKSB7XG5cdFx0XHRcdFx0XHRzZWxmLnNldHRpbmdzLm9uU2hvd24uY2FsbCh0aGlzKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0sIDYwMCk7XG5cdFx0fSxcblx0XHRiaW5kOiBmdW5jdGlvbiAoKSB7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cblx0XHRcdHRoaXMuJGVsZS5maW5kKCdbZGF0YS1ub3RpZnk9XCJkaXNtaXNzXCJdJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRzZWxmLmNsb3NlKCk7XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy4kZWxlLm1vdXNlb3ZlcihmdW5jdGlvbiAoZSkge1xuXHRcdFx0XHQkKHRoaXMpLmRhdGEoJ2RhdGEtaG92ZXInLCBcInRydWVcIik7XG5cdFx0XHR9KS5tb3VzZW91dChmdW5jdGlvbiAoZSkge1xuXHRcdFx0XHQkKHRoaXMpLmRhdGEoJ2RhdGEtaG92ZXInLCBcImZhbHNlXCIpO1xuXHRcdFx0fSk7XG5cdFx0XHR0aGlzLiRlbGUuZGF0YSgnZGF0YS1ob3ZlcicsIFwiZmFsc2VcIik7XG5cblx0XHRcdGlmICh0aGlzLnNldHRpbmdzLmRlbGF5ID4gMCkge1xuXHRcdFx0XHRzZWxmLiRlbGUuZGF0YSgnbm90aWZ5LWRlbGF5Jywgc2VsZi5zZXR0aW5ncy5kZWxheSk7XG5cdFx0XHRcdHZhciB0aW1lciA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHR2YXIgZGVsYXkgPSBwYXJzZUludChzZWxmLiRlbGUuZGF0YSgnbm90aWZ5LWRlbGF5JykpIC0gc2VsZi5zZXR0aW5ncy50aW1lcjtcblx0XHRcdFx0XHRpZiAoc2VsZi4kZWxlLmRhdGEoJ2RhdGEtaG92ZXInKSA9PT0gJ2ZhbHNlJyAmJiBzZWxmLnNldHRpbmdzLm1vdXNlX292ZXIgPT0gXCJwYXVzZVwiIHx8IHNlbGYuc2V0dGluZ3MubW91c2Vfb3ZlciAhPSBcInBhdXNlXCIpIHtcblx0XHRcdFx0XHRcdHZhciBwZXJjZW50ID0gKHNlbGYuc2V0dGluZ3MuZGVsYXkgLSBkZWxheSkgLyBzZWxmLnNldHRpbmdzLmRlbGF5ICogMTAwO1xuXHRcdFx0XHRcdFx0c2VsZi4kZWxlLmRhdGEoJ25vdGlmeS1kZWxheScsIGRlbGF5KTtcblx0XHRcdFx0XHRcdHNlbGYuJGVsZS5maW5kKCdbZGF0YS1ub3RpZnk9XCJwcm9ncmVzc2JhclwiXSA+IGRpdicpLmF0dHIoJ2FyaWEtdmFsdWVub3cnLCBwZXJjZW50KS5jc3MoJ3dpZHRoJywgcGVyY2VudCArICclJyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmIChkZWxheSA8PSAtc2VsZi5zZXR0aW5ncy50aW1lcikge1xuXHRcdFx0XHRcdFx0Y2xlYXJJbnRlcnZhbCh0aW1lcik7XG5cdFx0XHRcdFx0XHRzZWxmLmNsb3NlKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9LCBzZWxmLnNldHRpbmdzLnRpbWVyKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdGNsb3NlOiBmdW5jdGlvbiAoKSB7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXMsXG5cdFx0XHQgICAgJHN1Y2Nlc3NvcnMgPSBudWxsLFxuXHRcdFx0ICAgIHBvc1ggPSBwYXJzZUludCh0aGlzLiRlbGUuY3NzKHRoaXMuc2V0dGluZ3MucGxhY2VtZW50LmZyb20pKSxcblx0XHRcdCAgICBoYXNBbmltYXRpb24gPSBmYWxzZTtcblxuXHRcdFx0dGhpcy4kZWxlLmRhdGEoJ2Nsb3NpbmcnLCAndHJ1ZScpLmFkZENsYXNzKHRoaXMuc2V0dGluZ3MuYW5pbWF0ZS5leGl0KTtcblx0XHRcdHNlbGYucmVwb3NpdGlvbihwb3NYKTtcblxuXHRcdFx0aWYgKCQuaXNGdW5jdGlvbihzZWxmLnNldHRpbmdzLm9uQ2xvc2UpKSB7XG5cdFx0XHRcdHNlbGYuc2V0dGluZ3Mub25DbG9zZS5jYWxsKHRoaXMuJGVsZSk7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMuJGVsZS5vbmUodGhpcy5hbmltYXRpb25zLnN0YXJ0LCBmdW5jdGlvbiAoZXZlbnQpIHtcblx0XHRcdFx0aGFzQW5pbWF0aW9uID0gdHJ1ZTtcblx0XHRcdH0pLm9uZSh0aGlzLmFuaW1hdGlvbnMuZW5kLCBmdW5jdGlvbiAoZXZlbnQpIHtcblx0XHRcdFx0JCh0aGlzKS5yZW1vdmUoKTtcblx0XHRcdFx0aWYgKCQuaXNGdW5jdGlvbihzZWxmLnNldHRpbmdzLm9uQ2xvc2VkKSkge1xuXHRcdFx0XHRcdHNlbGYuc2V0dGluZ3Mub25DbG9zZWQuY2FsbCh0aGlzKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRpZiAoIWhhc0FuaW1hdGlvbikge1xuXHRcdFx0XHRcdHNlbGYuJGVsZS5yZW1vdmUoKTtcblx0XHRcdFx0XHRpZiAoc2VsZi5zZXR0aW5ncy5vbkNsb3NlZCkge1xuXHRcdFx0XHRcdFx0c2VsZi5zZXR0aW5ncy5vbkNsb3NlZChzZWxmLiRlbGUpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSwgNjAwKTtcblx0XHR9LFxuXHRcdHJlcG9zaXRpb246IGZ1bmN0aW9uIChwb3NYKSB7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXMsXG5cdFx0XHQgICAgbm90aWZpZXMgPSAnW2RhdGEtbm90aWZ5LXBvc2l0aW9uPVwiJyArIHRoaXMuc2V0dGluZ3MucGxhY2VtZW50LmZyb20gKyAnLScgKyB0aGlzLnNldHRpbmdzLnBsYWNlbWVudC5hbGlnbiArICdcIl06bm90KFtkYXRhLWNsb3Npbmc9XCJ0cnVlXCJdKScsXG5cdFx0XHQgICAgJGVsZW1lbnRzID0gdGhpcy4kZWxlLm5leHRBbGwobm90aWZpZXMpO1xuXHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MubmV3ZXN0X29uX3RvcCA9PSB0cnVlKSB7XG5cdFx0XHRcdCRlbGVtZW50cyA9IHRoaXMuJGVsZS5wcmV2QWxsKG5vdGlmaWVzKTtcblx0XHRcdH1cblx0XHRcdCRlbGVtZW50cy5lYWNoKGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0JCh0aGlzKS5jc3Moc2VsZi5zZXR0aW5ncy5wbGFjZW1lbnQuZnJvbSwgcG9zWCk7XG5cdFx0XHRcdHBvc1ggPSBwYXJzZUludChwb3NYKSArIHBhcnNlSW50KHNlbGYuc2V0dGluZ3Muc3BhY2luZykgKyAkKHRoaXMpLm91dGVySGVpZ2h0KCk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH0pO1xuXG5cdCQubm90aWZ5ID0gZnVuY3Rpb24gKGNvbnRlbnQsIG9wdGlvbnMpIHtcblx0XHR2YXIgcGx1Z2luID0gbmV3IE5vdGlmeSh0aGlzLCBjb250ZW50LCBvcHRpb25zKTtcblx0XHRyZXR1cm4gcGx1Z2luLm5vdGlmeTtcblx0fTtcblx0JC5ub3RpZnlEZWZhdWx0cyA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG5cdFx0ZGVmYXVsdHMgPSAkLmV4dGVuZCh0cnVlLCB7fSwgZGVmYXVsdHMsIG9wdGlvbnMpO1xuXHRcdHJldHVybiBkZWZhdWx0cztcblx0fTtcblx0JC5ub3RpZnlDbG9zZSA9IGZ1bmN0aW9uIChjb21tYW5kKSB7XG5cdFx0aWYgKHR5cGVvZiBjb21tYW5kID09PSBcInVuZGVmaW5lZFwiIHx8IGNvbW1hbmQgPT0gXCJhbGxcIikge1xuXHRcdFx0JCgnW2RhdGEtbm90aWZ5XScpLmZpbmQoJ1tkYXRhLW5vdGlmeT1cImRpc21pc3NcIl0nKS50cmlnZ2VyKCdjbGljaycpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQkKCdbZGF0YS1ub3RpZnktcG9zaXRpb249XCInICsgY29tbWFuZCArICdcIl0nKS5maW5kKCdbZGF0YS1ub3RpZnk9XCJkaXNtaXNzXCJdJykudHJpZ2dlcignY2xpY2snKTtcblx0XHR9XG5cdH07XG59KTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYm9vdHN0cmFwLWdyb3dsL2Jvb3RzdHJhcC1ub3RpZnkuanNcbi8vIG1vZHVsZSBpZCA9IDEzMVxuLy8gbW9kdWxlIGNodW5rcyA9IDIwIDMzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");
},132:function(module,exports,__webpack_require__){eval("// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = __webpack_require__(133);\nif(typeof content === 'string') content = [[module.id, content, '']];\n// add the styles to the DOM\nvar update = __webpack_require__(5)(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(false) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!./../../css-loader/index.js!./summernote.css\", function() {\n\t\t\tvar newContent = require(\"!!./../../css-loader/index.js!./summernote.css\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTMyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vfi9zdW1tZXJub3RlL2Rpc3Qvc3VtbWVybm90ZS5jc3M/YzFhZiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzdHlsZS1sb2FkZXI6IEFkZHMgc29tZSBjc3MgdG8gdGhlIERPTSBieSBhZGRpbmcgYSA8c3R5bGU+IHRhZ1xuXG4vLyBsb2FkIHRoZSBzdHlsZXNcbnZhciBjb250ZW50ID0gcmVxdWlyZShcIiEhLi8uLi8uLi9jc3MtbG9hZGVyL2luZGV4LmpzIS4vc3VtbWVybm90ZS5jc3NcIik7XG5pZih0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycpIGNvbnRlbnQgPSBbW21vZHVsZS5pZCwgY29udGVudCwgJyddXTtcbi8vIGFkZCB0aGUgc3R5bGVzIHRvIHRoZSBET01cbnZhciB1cGRhdGUgPSByZXF1aXJlKFwiIS4vLi4vLi4vc3R5bGUtbG9hZGVyL2FkZFN0eWxlcy5qc1wiKShjb250ZW50LCB7fSk7XG5pZihjb250ZW50LmxvY2FscykgbW9kdWxlLmV4cG9ydHMgPSBjb250ZW50LmxvY2Fscztcbi8vIEhvdCBNb2R1bGUgUmVwbGFjZW1lbnRcbmlmKG1vZHVsZS5ob3QpIHtcblx0Ly8gV2hlbiB0aGUgc3R5bGVzIGNoYW5nZSwgdXBkYXRlIHRoZSA8c3R5bGU+IHRhZ3Ncblx0aWYoIWNvbnRlbnQubG9jYWxzKSB7XG5cdFx0bW9kdWxlLmhvdC5hY2NlcHQoXCIhIS4vLi4vLi4vY3NzLWxvYWRlci9pbmRleC5qcyEuL3N1bW1lcm5vdGUuY3NzXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIG5ld0NvbnRlbnQgPSByZXF1aXJlKFwiISEuLy4uLy4uL2Nzcy1sb2FkZXIvaW5kZXguanMhLi9zdW1tZXJub3RlLmNzc1wiKTtcblx0XHRcdGlmKHR5cGVvZiBuZXdDb250ZW50ID09PSAnc3RyaW5nJykgbmV3Q29udGVudCA9IFtbbW9kdWxlLmlkLCBuZXdDb250ZW50LCAnJ11dO1xuXHRcdFx0dXBkYXRlKG5ld0NvbnRlbnQpO1xuXHRcdH0pO1xuXHR9XG5cdC8vIFdoZW4gdGhlIG1vZHVsZSBpcyBkaXNwb3NlZCwgcmVtb3ZlIHRoZSA8c3R5bGU+IHRhZ3Ncblx0bW9kdWxlLmhvdC5kaXNwb3NlKGZ1bmN0aW9uKCkgeyB1cGRhdGUoKTsgfSk7XG59XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L3N1bW1lcm5vdGUvZGlzdC9zdW1tZXJub3RlLmNzc1xuLy8gbW9kdWxlIGlkID0gMTMyXG4vLyBtb2R1bGUgY2h1bmtzID0gMjAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==")},133:function(module,exports,__webpack_require__){eval('exports = module.exports = __webpack_require__(4)();\n// imports\n\n\n// module\nexports.push([module.id, "@font-face{font-family:summernote;font-style:normal;font-weight:400;src:url(" + __webpack_require__(134) + ");src:url(" + __webpack_require__(135) + "?#iefix) format(\\"embedded-opentype\\"),url(" + __webpack_require__(136) + ") format(\\"woff\\"),url(" + __webpack_require__(137) + ") format(\\"truetype\\")}[class*=\\" note-icon-\\"]:before,[class^=note-icon-]:before{display:inline-block;font:normal normal normal 14px summernote;font-size:inherit;-webkit-font-smoothing:antialiased;text-decoration:inherit;text-rendering:auto;text-transform:none;vertical-align:middle;speak:none;-moz-osx-font-smoothing:grayscale}.note-icon-align-center:before{content:\\"\\\\F101\\"}.note-icon-align-indent:before{content:\\"\\\\F102\\"}.note-icon-align-justify:before{content:\\"\\\\F103\\"}.note-icon-align-left:before{content:\\"\\\\F104\\"}.note-icon-align-outdent:before{content:\\"\\\\F105\\"}.note-icon-align-right:before{content:\\"\\\\F106\\"}.note-icon-align:before{content:\\"\\\\F107\\"}.note-icon-arrows-alt:before{content:\\"\\\\F108\\"}.note-icon-bold:before{content:\\"\\\\F109\\"}.note-icon-caret:before{content:\\"\\\\F10A\\"}.note-icon-chain-broken:before{content:\\"\\\\F10B\\"}.note-icon-circle:before{content:\\"\\\\F10C\\"}.note-icon-close:before{content:\\"\\\\F10D\\"}.note-icon-code:before{content:\\"\\\\F10E\\"}.note-icon-eraser:before{content:\\"\\\\F10F\\"}.note-icon-font:before{content:\\"\\\\F110\\"}.note-icon-frame:before{content:\\"\\\\F111\\"}.note-icon-italic:before{content:\\"\\\\F112\\"}.note-icon-link:before{content:\\"\\\\F113\\"}.note-icon-magic:before{content:\\"\\\\F114\\"}.note-icon-menu-check:before{content:\\"\\\\F115\\"}.note-icon-minus:before{content:\\"\\\\F116\\"}.note-icon-orderedlist:before{content:\\"\\\\F117\\"}.note-icon-pencil:before{content:\\"\\\\F118\\"}.note-icon-picture:before{content:\\"\\\\F119\\"}.note-icon-question:before{content:\\"\\\\F11A\\"}.note-icon-redo:before{content:\\"\\\\F11B\\"}.note-icon-special-character:before{content:\\"\\\\F11C\\"}.note-icon-square:before{content:\\"\\\\F11D\\"}.note-icon-strikethrough:before{content:\\"\\\\F11E\\"}.note-icon-subscript:before{content:\\"\\\\F11F\\"}.note-icon-summernote:before{content:\\"\\\\F120\\"}.note-icon-superscript:before{content:\\"\\\\F121\\"}.note-icon-table:before{content:\\"\\\\F122\\"}.note-icon-text-height:before{content:\\"\\\\F123\\"}.note-icon-trash:before{content:\\"\\\\F124\\"}.note-icon-underline:before{content:\\"\\\\F125\\"}.note-icon-undo:before{content:\\"\\\\F126\\"}.note-icon-unorderedlist:before{content:\\"\\\\F127\\"}.note-icon-video:before{content:\\"\\\\F128\\"}.note-editor{position:relative}.note-editor .note-dropzone{position:absolute;z-index:100;display:none;color:#87cefa;background-color:#fff;opacity:.95}.note-editor .note-dropzone .note-dropzone-message{display:table-cell;font-size:28px;font-weight:700;text-align:center;vertical-align:middle}.note-editor .note-dropzone.hover{color:#098ddf}.note-editor.dragover .note-dropzone{display:table}.note-editor .note-editing-area{position:relative}.note-editor .note-editing-area .note-editable{outline:0}.note-editor .note-editing-area .note-editable sup{vertical-align:super}.note-editor .note-editing-area .note-editable sub{vertical-align:sub}.note-editor.note-frame{border:1px solid #a9a9a9}.note-editor.note-frame.codeview .note-editing-area .note-editable{display:none}.note-editor.note-frame.codeview .note-editing-area .note-codable{display:block}.note-editor.note-frame .note-editing-area{overflow:hidden}.note-editor.note-frame .note-editing-area .note-editable{padding:10px;overflow:auto;color:#000;background-color:#fff}.note-editor.note-frame .note-editing-area .note-editable[contenteditable=false]{background-color:#e5e5e5}.note-editor.note-frame .note-editing-area .note-codable{display:none;width:100%;padding:10px;margin-bottom:0;font-family:Menlo,Monaco,monospace,sans-serif;font-size:14px;color:#ccc;background-color:#222;border:0;border-radius:0;box-shadow:none;-ms-box-sizing:border-box;box-sizing:border-box;resize:none}.note-editor.note-frame.fullscreen{position:fixed;top:0;left:0;z-index:1050;width:100%!important}.note-editor.note-frame.fullscreen .note-editable{background-color:#fff}.note-editor.note-frame.fullscreen .note-resizebar{display:none}.note-editor.note-frame .note-statusbar{background-color:#f5f5f5;border-bottom-right-radius:4px;border-bottom-left-radius:4px}.note-editor.note-frame .note-statusbar .note-resizebar{width:100%;height:8px;padding-top:1px;cursor:ns-resize}.note-editor.note-frame .note-statusbar .note-resizebar .note-icon-bar{width:20px;margin:1px auto;border-top:1px solid #a9a9a9}.note-editor.note-frame .note-placeholder{padding:10px}.note-popover.popover{max-width:none}.note-popover.popover .popover-content a{display:inline-block;max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;vertical-align:middle}.note-popover.popover .arrow{left:20px!important}.note-popover .popover-content,.panel-heading.note-toolbar{padding:0 0 5px 5px;margin:0}.note-popover .popover-content>.btn-group,.panel-heading.note-toolbar>.btn-group{margin-top:5px;margin-right:5px;margin-left:0}.note-popover .popover-content .btn-group .note-table,.panel-heading.note-toolbar .btn-group .note-table{min-width:0;padding:5px}.note-popover .popover-content .btn-group .note-table .note-dimension-picker,.panel-heading.note-toolbar .btn-group .note-table .note-dimension-picker{font-size:18px}.note-popover .popover-content .btn-group .note-table .note-dimension-picker .note-dimension-picker-mousecatcher,.panel-heading.note-toolbar .btn-group .note-table .note-dimension-picker .note-dimension-picker-mousecatcher{position:absolute!important;z-index:3;width:10em;height:10em;cursor:pointer}.note-popover .popover-content .btn-group .note-table .note-dimension-picker .note-dimension-picker-unhighlighted,.panel-heading.note-toolbar .btn-group .note-table .note-dimension-picker .note-dimension-picker-unhighlighted{position:relative!important;z-index:1;width:5em;height:5em;background:url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASAgMAAAAroGbEAAAACVBMVEUAAIj4+Pjp6ekKlAqjAAAAAXRSTlMAQObYZgAAAAFiS0dEAIgFHUgAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfYAR0BKhmnaJzPAAAAG0lEQVQI12NgAAOtVatWMTCohoaGUY+EmIkEAEruEzK2J7tvAAAAAElFTkSuQmCC\') repeat}.note-popover .popover-content .btn-group .note-table .note-dimension-picker .note-dimension-picker-highlighted,.panel-heading.note-toolbar .btn-group .note-table .note-dimension-picker .note-dimension-picker-highlighted{position:absolute!important;z-index:2;width:1em;height:1em;background:url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASAgMAAAAroGbEAAAACVBMVEUAAIjd6vvD2f9LKLW+AAAAAXRSTlMAQObYZgAAAAFiS0dEAIgFHUgAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfYAR0BKwNDEVT0AAAAG0lEQVQI12NgAAOtVatWMTCohoaGUY+EmIkEAEruEzK2J7tvAAAAAElFTkSuQmCC\') repeat}.note-popover .popover-content .note-style blockquote,.note-popover .popover-content .note-style h1,.note-popover .popover-content .note-style h2,.note-popover .popover-content .note-style h3,.note-popover .popover-content .note-style h4,.note-popover .popover-content .note-style h5,.note-popover .popover-content .note-style h6,.panel-heading.note-toolbar .note-style blockquote,.panel-heading.note-toolbar .note-style h1,.panel-heading.note-toolbar .note-style h2,.panel-heading.note-toolbar .note-style h3,.panel-heading.note-toolbar .note-style h4,.panel-heading.note-toolbar .note-style h5,.panel-heading.note-toolbar .note-style h6{margin:0}.note-popover .popover-content .note-color .dropdown-toggle,.panel-heading.note-toolbar .note-color .dropdown-toggle{width:20px;padding-left:5px}.note-popover .popover-content .note-color .dropdown-menu,.panel-heading.note-toolbar .note-color .dropdown-menu{min-width:340px}.note-popover .popover-content .note-color .dropdown-menu .btn-group,.panel-heading.note-toolbar .note-color .dropdown-menu .btn-group{margin:0}.note-popover .popover-content .note-color .dropdown-menu .btn-group:first-child,.panel-heading.note-toolbar .note-color .dropdown-menu .btn-group:first-child{margin:0 5px}.note-popover .popover-content .note-color .dropdown-menu .btn-group .note-palette-title,.panel-heading.note-toolbar .note-color .dropdown-menu .btn-group .note-palette-title{margin:2px 7px;font-size:12px;text-align:center;border-bottom:1px solid #eee}.note-popover .popover-content .note-color .dropdown-menu .btn-group .note-color-reset,.panel-heading.note-toolbar .note-color .dropdown-menu .btn-group .note-color-reset{width:100%;padding:0 3px;margin:3px;font-size:11px;cursor:pointer;border-radius:5px}.note-popover .popover-content .note-color .dropdown-menu .btn-group .note-color-row,.panel-heading.note-toolbar .note-color .dropdown-menu .btn-group .note-color-row{height:20px}.note-popover .popover-content .note-color .dropdown-menu .btn-group .note-color-reset:hover,.panel-heading.note-toolbar .note-color .dropdown-menu .btn-group .note-color-reset:hover{background:#eee}.note-popover .popover-content .note-para .dropdown-menu,.panel-heading.note-toolbar .note-para .dropdown-menu{min-width:216px;padding:5px}.note-popover .popover-content .note-para .dropdown-menu>div:first-child,.panel-heading.note-toolbar .note-para .dropdown-menu>div:first-child{margin-right:5px}.note-popover .popover-content .dropdown-menu,.panel-heading.note-toolbar .dropdown-menu{min-width:90px}.note-popover .popover-content .dropdown-menu.right,.panel-heading.note-toolbar .dropdown-menu.right{right:0;left:auto}.note-popover .popover-content .dropdown-menu.right:before,.panel-heading.note-toolbar .dropdown-menu.right:before{right:9px;left:auto!important}.note-popover .popover-content .dropdown-menu.right:after,.panel-heading.note-toolbar .dropdown-menu.right:after{right:10px;left:auto!important}.note-popover .popover-content .dropdown-menu.note-check li a i,.panel-heading.note-toolbar .dropdown-menu.note-check li a i{color:#00bfff;visibility:hidden}.note-popover .popover-content .dropdown-menu.note-check li a.checked i,.panel-heading.note-toolbar .dropdown-menu.note-check li a.checked i{visibility:visible}.note-popover .popover-content .note-fontsize-10,.panel-heading.note-toolbar .note-fontsize-10{font-size:10px}.note-popover .popover-content .note-color-palette,.panel-heading.note-toolbar .note-color-palette{line-height:1}.note-popover .popover-content .note-color-palette div .note-color-btn,.panel-heading.note-toolbar .note-color-palette div .note-color-btn{width:20px;height:20px;padding:0;margin:0;border:1px solid #fff}.note-popover .popover-content .note-color-palette div .note-color-btn:hover,.panel-heading.note-toolbar .note-color-palette div .note-color-btn:hover{border:1px solid #000}.note-dialog>div{display:none}.note-dialog .form-group{margin-right:0;margin-left:0}.note-dialog .note-modal-form{margin:0}.note-dialog .note-image-dialog .note-dropzone{min-height:100px;margin-bottom:10px;font-size:30px;line-height:4;color:#d3d3d3;text-align:center;border:4px dashed #d3d3d3}@-moz-document url-prefix(){.note-image-input{height:auto}}.note-placeholder{position:absolute;display:none;color:gray}.note-handle .note-control-selection{position:absolute;display:none;border:1px solid #000}.note-handle .note-control-selection>div{position:absolute}.note-handle .note-control-selection .note-control-selection-bg{width:100%;height:100%;background-color:#000;-webkit-opacity:.3;-khtml-opacity:.3;-moz-opacity:.3;opacity:.3;-ms-filter:alpha(opacity=30);filter:alpha(opacity=30)}.note-handle .note-control-selection .note-control-handle,.note-handle .note-control-selection .note-control-holder{width:7px;height:7px;border:1px solid #000}.note-handle .note-control-selection .note-control-sizing{width:7px;height:7px;background-color:#fff;border:1px solid #000}.note-handle .note-control-selection .note-control-nw{top:-5px;left:-5px;border-right:0;border-bottom:0}.note-handle .note-control-selection .note-control-ne{top:-5px;right:-5px;border-bottom:0;border-left:none}.note-handle .note-control-selection .note-control-sw{bottom:-5px;left:-5px;border-top:0;border-right:0}.note-handle .note-control-selection .note-control-se{right:-5px;bottom:-5px;cursor:se-resize}.note-handle .note-control-selection .note-control-se.note-control-holder{cursor:default;border-top:0;border-left:none}.note-handle .note-control-selection .note-control-selection-info{right:0;bottom:0;padding:5px;margin:5px;font-size:12px;color:#fff;background-color:#000;border-radius:5px;-webkit-opacity:.7;-khtml-opacity:.7;-moz-opacity:.7;opacity:.7;-ms-filter:alpha(opacity=70);filter:alpha(opacity=70)}.note-hint-popover{min-width:100px;padding:2px}.note-hint-popover .popover-content{max-height:150px;padding:3px;overflow:auto}.note-hint-popover .popover-content .note-hint-group .note-hint-item{display:block!important;padding:3px}.note-hint-popover .popover-content .note-hint-group .note-hint-item.active,.note-hint-popover .popover-content .note-hint-group .note-hint-item:hover{display:block;clear:both;font-weight:400;line-height:1.4;color:#fff;text-decoration:none;white-space:nowrap;cursor:pointer;background-color:#428bca;outline:0}", ""]);\n\n// exports\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTMzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vfi9zdW1tZXJub3RlL2Rpc3Qvc3VtbWVybm90ZS5jc3M/NmM1OCJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiLi8uLi8uLi9jc3MtbG9hZGVyL2xpYi9jc3MtYmFzZS5qc1wiKSgpO1xuLy8gaW1wb3J0c1xuXG5cbi8vIG1vZHVsZVxuZXhwb3J0cy5wdXNoKFttb2R1bGUuaWQsIFwiQGZvbnQtZmFjZXtmb250LWZhbWlseTpzdW1tZXJub3RlO2ZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtd2VpZ2h0OjQwMDtzcmM6dXJsKFwiICsgcmVxdWlyZShcIi4vZm9udC9zdW1tZXJub3RlLmVvdD9hZDhkN2UyZDE3N2QyNDczYWVjZDliMzVkMTYyMTFmYlwiKSArIFwiKTtzcmM6dXJsKFwiICsgcmVxdWlyZShcIi4vZm9udC9zdW1tZXJub3RlLmVvdFwiKSArIFwiPyNpZWZpeCkgZm9ybWF0KFxcXCJlbWJlZGRlZC1vcGVudHlwZVxcXCIpLHVybChcIiArIHJlcXVpcmUoXCIuL2ZvbnQvc3VtbWVybm90ZS53b2ZmP2FkOGQ3ZTJkMTc3ZDI0NzNhZWNkOWIzNWQxNjIxMWZiXCIpICsgXCIpIGZvcm1hdChcXFwid29mZlxcXCIpLHVybChcIiArIHJlcXVpcmUoXCIuL2ZvbnQvc3VtbWVybm90ZS50dGY/YWQ4ZDdlMmQxNzdkMjQ3M2FlY2Q5YjM1ZDE2MjExZmJcIikgKyBcIikgZm9ybWF0KFxcXCJ0cnVldHlwZVxcXCIpfVtjbGFzcyo9XFxcIiBub3RlLWljb24tXFxcIl06YmVmb3JlLFtjbGFzc149bm90ZS1pY29uLV06YmVmb3Jle2Rpc3BsYXk6aW5saW5lLWJsb2NrO2ZvbnQ6bm9ybWFsIG5vcm1hbCBub3JtYWwgMTRweCBzdW1tZXJub3RlO2ZvbnQtc2l6ZTppbmhlcml0Oy13ZWJraXQtZm9udC1zbW9vdGhpbmc6YW50aWFsaWFzZWQ7dGV4dC1kZWNvcmF0aW9uOmluaGVyaXQ7dGV4dC1yZW5kZXJpbmc6YXV0bzt0ZXh0LXRyYW5zZm9ybTpub25lO3ZlcnRpY2FsLWFsaWduOm1pZGRsZTtzcGVhazpub25lOy1tb3otb3N4LWZvbnQtc21vb3RoaW5nOmdyYXlzY2FsZX0ubm90ZS1pY29uLWFsaWduLWNlbnRlcjpiZWZvcmV7Y29udGVudDpcXFwiXFxcXEYxMDFcXFwifS5ub3RlLWljb24tYWxpZ24taW5kZW50OmJlZm9yZXtjb250ZW50OlxcXCJcXFxcRjEwMlxcXCJ9Lm5vdGUtaWNvbi1hbGlnbi1qdXN0aWZ5OmJlZm9yZXtjb250ZW50OlxcXCJcXFxcRjEwM1xcXCJ9Lm5vdGUtaWNvbi1hbGlnbi1sZWZ0OmJlZm9yZXtjb250ZW50OlxcXCJcXFxcRjEwNFxcXCJ9Lm5vdGUtaWNvbi1hbGlnbi1vdXRkZW50OmJlZm9yZXtjb250ZW50OlxcXCJcXFxcRjEwNVxcXCJ9Lm5vdGUtaWNvbi1hbGlnbi1yaWdodDpiZWZvcmV7Y29udGVudDpcXFwiXFxcXEYxMDZcXFwifS5ub3RlLWljb24tYWxpZ246YmVmb3Jle2NvbnRlbnQ6XFxcIlxcXFxGMTA3XFxcIn0ubm90ZS1pY29uLWFycm93cy1hbHQ6YmVmb3Jle2NvbnRlbnQ6XFxcIlxcXFxGMTA4XFxcIn0ubm90ZS1pY29uLWJvbGQ6YmVmb3Jle2NvbnRlbnQ6XFxcIlxcXFxGMTA5XFxcIn0ubm90ZS1pY29uLWNhcmV0OmJlZm9yZXtjb250ZW50OlxcXCJcXFxcRjEwQVxcXCJ9Lm5vdGUtaWNvbi1jaGFpbi1icm9rZW46YmVmb3Jle2NvbnRlbnQ6XFxcIlxcXFxGMTBCXFxcIn0ubm90ZS1pY29uLWNpcmNsZTpiZWZvcmV7Y29udGVudDpcXFwiXFxcXEYxMENcXFwifS5ub3RlLWljb24tY2xvc2U6YmVmb3Jle2NvbnRlbnQ6XFxcIlxcXFxGMTBEXFxcIn0ubm90ZS1pY29uLWNvZGU6YmVmb3Jle2NvbnRlbnQ6XFxcIlxcXFxGMTBFXFxcIn0ubm90ZS1pY29uLWVyYXNlcjpiZWZvcmV7Y29udGVudDpcXFwiXFxcXEYxMEZcXFwifS5ub3RlLWljb24tZm9udDpiZWZvcmV7Y29udGVudDpcXFwiXFxcXEYxMTBcXFwifS5ub3RlLWljb24tZnJhbWU6YmVmb3Jle2NvbnRlbnQ6XFxcIlxcXFxGMTExXFxcIn0ubm90ZS1pY29uLWl0YWxpYzpiZWZvcmV7Y29udGVudDpcXFwiXFxcXEYxMTJcXFwifS5ub3RlLWljb24tbGluazpiZWZvcmV7Y29udGVudDpcXFwiXFxcXEYxMTNcXFwifS5ub3RlLWljb24tbWFnaWM6YmVmb3Jle2NvbnRlbnQ6XFxcIlxcXFxGMTE0XFxcIn0ubm90ZS1pY29uLW1lbnUtY2hlY2s6YmVmb3Jle2NvbnRlbnQ6XFxcIlxcXFxGMTE1XFxcIn0ubm90ZS1pY29uLW1pbnVzOmJlZm9yZXtjb250ZW50OlxcXCJcXFxcRjExNlxcXCJ9Lm5vdGUtaWNvbi1vcmRlcmVkbGlzdDpiZWZvcmV7Y29udGVudDpcXFwiXFxcXEYxMTdcXFwifS5ub3RlLWljb24tcGVuY2lsOmJlZm9yZXtjb250ZW50OlxcXCJcXFxcRjExOFxcXCJ9Lm5vdGUtaWNvbi1waWN0dXJlOmJlZm9yZXtjb250ZW50OlxcXCJcXFxcRjExOVxcXCJ9Lm5vdGUtaWNvbi1xdWVzdGlvbjpiZWZvcmV7Y29udGVudDpcXFwiXFxcXEYxMUFcXFwifS5ub3RlLWljb24tcmVkbzpiZWZvcmV7Y29udGVudDpcXFwiXFxcXEYxMUJcXFwifS5ub3RlLWljb24tc3BlY2lhbC1jaGFyYWN0ZXI6YmVmb3Jle2NvbnRlbnQ6XFxcIlxcXFxGMTFDXFxcIn0ubm90ZS1pY29uLXNxdWFyZTpiZWZvcmV7Y29udGVudDpcXFwiXFxcXEYxMURcXFwifS5ub3RlLWljb24tc3RyaWtldGhyb3VnaDpiZWZvcmV7Y29udGVudDpcXFwiXFxcXEYxMUVcXFwifS5ub3RlLWljb24tc3Vic2NyaXB0OmJlZm9yZXtjb250ZW50OlxcXCJcXFxcRjExRlxcXCJ9Lm5vdGUtaWNvbi1zdW1tZXJub3RlOmJlZm9yZXtjb250ZW50OlxcXCJcXFxcRjEyMFxcXCJ9Lm5vdGUtaWNvbi1zdXBlcnNjcmlwdDpiZWZvcmV7Y29udGVudDpcXFwiXFxcXEYxMjFcXFwifS5ub3RlLWljb24tdGFibGU6YmVmb3Jle2NvbnRlbnQ6XFxcIlxcXFxGMTIyXFxcIn0ubm90ZS1pY29uLXRleHQtaGVpZ2h0OmJlZm9yZXtjb250ZW50OlxcXCJcXFxcRjEyM1xcXCJ9Lm5vdGUtaWNvbi10cmFzaDpiZWZvcmV7Y29udGVudDpcXFwiXFxcXEYxMjRcXFwifS5ub3RlLWljb24tdW5kZXJsaW5lOmJlZm9yZXtjb250ZW50OlxcXCJcXFxcRjEyNVxcXCJ9Lm5vdGUtaWNvbi11bmRvOmJlZm9yZXtjb250ZW50OlxcXCJcXFxcRjEyNlxcXCJ9Lm5vdGUtaWNvbi11bm9yZGVyZWRsaXN0OmJlZm9yZXtjb250ZW50OlxcXCJcXFxcRjEyN1xcXCJ9Lm5vdGUtaWNvbi12aWRlbzpiZWZvcmV7Y29udGVudDpcXFwiXFxcXEYxMjhcXFwifS5ub3RlLWVkaXRvcntwb3NpdGlvbjpyZWxhdGl2ZX0ubm90ZS1lZGl0b3IgLm5vdGUtZHJvcHpvbmV7cG9zaXRpb246YWJzb2x1dGU7ei1pbmRleDoxMDA7ZGlzcGxheTpub25lO2NvbG9yOiM4N2NlZmE7YmFja2dyb3VuZC1jb2xvcjojZmZmO29wYWNpdHk6Ljk1fS5ub3RlLWVkaXRvciAubm90ZS1kcm9wem9uZSAubm90ZS1kcm9wem9uZS1tZXNzYWdle2Rpc3BsYXk6dGFibGUtY2VsbDtmb250LXNpemU6MjhweDtmb250LXdlaWdodDo3MDA7dGV4dC1hbGlnbjpjZW50ZXI7dmVydGljYWwtYWxpZ246bWlkZGxlfS5ub3RlLWVkaXRvciAubm90ZS1kcm9wem9uZS5ob3Zlcntjb2xvcjojMDk4ZGRmfS5ub3RlLWVkaXRvci5kcmFnb3ZlciAubm90ZS1kcm9wem9uZXtkaXNwbGF5OnRhYmxlfS5ub3RlLWVkaXRvciAubm90ZS1lZGl0aW5nLWFyZWF7cG9zaXRpb246cmVsYXRpdmV9Lm5vdGUtZWRpdG9yIC5ub3RlLWVkaXRpbmctYXJlYSAubm90ZS1lZGl0YWJsZXtvdXRsaW5lOjB9Lm5vdGUtZWRpdG9yIC5ub3RlLWVkaXRpbmctYXJlYSAubm90ZS1lZGl0YWJsZSBzdXB7dmVydGljYWwtYWxpZ246c3VwZXJ9Lm5vdGUtZWRpdG9yIC5ub3RlLWVkaXRpbmctYXJlYSAubm90ZS1lZGl0YWJsZSBzdWJ7dmVydGljYWwtYWxpZ246c3VifS5ub3RlLWVkaXRvci5ub3RlLWZyYW1le2JvcmRlcjoxcHggc29saWQgI2E5YTlhOX0ubm90ZS1lZGl0b3Iubm90ZS1mcmFtZS5jb2RldmlldyAubm90ZS1lZGl0aW5nLWFyZWEgLm5vdGUtZWRpdGFibGV7ZGlzcGxheTpub25lfS5ub3RlLWVkaXRvci5ub3RlLWZyYW1lLmNvZGV2aWV3IC5ub3RlLWVkaXRpbmctYXJlYSAubm90ZS1jb2RhYmxle2Rpc3BsYXk6YmxvY2t9Lm5vdGUtZWRpdG9yLm5vdGUtZnJhbWUgLm5vdGUtZWRpdGluZy1hcmVhe292ZXJmbG93OmhpZGRlbn0ubm90ZS1lZGl0b3Iubm90ZS1mcmFtZSAubm90ZS1lZGl0aW5nLWFyZWEgLm5vdGUtZWRpdGFibGV7cGFkZGluZzoxMHB4O292ZXJmbG93OmF1dG87Y29sb3I6IzAwMDtiYWNrZ3JvdW5kLWNvbG9yOiNmZmZ9Lm5vdGUtZWRpdG9yLm5vdGUtZnJhbWUgLm5vdGUtZWRpdGluZy1hcmVhIC5ub3RlLWVkaXRhYmxlW2NvbnRlbnRlZGl0YWJsZT1mYWxzZV17YmFja2dyb3VuZC1jb2xvcjojZTVlNWU1fS5ub3RlLWVkaXRvci5ub3RlLWZyYW1lIC5ub3RlLWVkaXRpbmctYXJlYSAubm90ZS1jb2RhYmxle2Rpc3BsYXk6bm9uZTt3aWR0aDoxMDAlO3BhZGRpbmc6MTBweDttYXJnaW4tYm90dG9tOjA7Zm9udC1mYW1pbHk6TWVubG8sTW9uYWNvLG1vbm9zcGFjZSxzYW5zLXNlcmlmO2ZvbnQtc2l6ZToxNHB4O2NvbG9yOiNjY2M7YmFja2dyb3VuZC1jb2xvcjojMjIyO2JvcmRlcjowO2JvcmRlci1yYWRpdXM6MDtib3gtc2hhZG93Om5vbmU7LW1zLWJveC1zaXppbmc6Ym9yZGVyLWJveDtib3gtc2l6aW5nOmJvcmRlci1ib3g7cmVzaXplOm5vbmV9Lm5vdGUtZWRpdG9yLm5vdGUtZnJhbWUuZnVsbHNjcmVlbntwb3NpdGlvbjpmaXhlZDt0b3A6MDtsZWZ0OjA7ei1pbmRleDoxMDUwO3dpZHRoOjEwMCUhaW1wb3J0YW50fS5ub3RlLWVkaXRvci5ub3RlLWZyYW1lLmZ1bGxzY3JlZW4gLm5vdGUtZWRpdGFibGV7YmFja2dyb3VuZC1jb2xvcjojZmZmfS5ub3RlLWVkaXRvci5ub3RlLWZyYW1lLmZ1bGxzY3JlZW4gLm5vdGUtcmVzaXplYmFye2Rpc3BsYXk6bm9uZX0ubm90ZS1lZGl0b3Iubm90ZS1mcmFtZSAubm90ZS1zdGF0dXNiYXJ7YmFja2dyb3VuZC1jb2xvcjojZjVmNWY1O2JvcmRlci1ib3R0b20tcmlnaHQtcmFkaXVzOjRweDtib3JkZXItYm90dG9tLWxlZnQtcmFkaXVzOjRweH0ubm90ZS1lZGl0b3Iubm90ZS1mcmFtZSAubm90ZS1zdGF0dXNiYXIgLm5vdGUtcmVzaXplYmFye3dpZHRoOjEwMCU7aGVpZ2h0OjhweDtwYWRkaW5nLXRvcDoxcHg7Y3Vyc29yOm5zLXJlc2l6ZX0ubm90ZS1lZGl0b3Iubm90ZS1mcmFtZSAubm90ZS1zdGF0dXNiYXIgLm5vdGUtcmVzaXplYmFyIC5ub3RlLWljb24tYmFye3dpZHRoOjIwcHg7bWFyZ2luOjFweCBhdXRvO2JvcmRlci10b3A6MXB4IHNvbGlkICNhOWE5YTl9Lm5vdGUtZWRpdG9yLm5vdGUtZnJhbWUgLm5vdGUtcGxhY2Vob2xkZXJ7cGFkZGluZzoxMHB4fS5ub3RlLXBvcG92ZXIucG9wb3ZlcnttYXgtd2lkdGg6bm9uZX0ubm90ZS1wb3BvdmVyLnBvcG92ZXIgLnBvcG92ZXItY29udGVudCBhe2Rpc3BsYXk6aW5saW5lLWJsb2NrO21heC13aWR0aDoyMDBweDtvdmVyZmxvdzpoaWRkZW47dGV4dC1vdmVyZmxvdzplbGxpcHNpczt3aGl0ZS1zcGFjZTpub3dyYXA7dmVydGljYWwtYWxpZ246bWlkZGxlfS5ub3RlLXBvcG92ZXIucG9wb3ZlciAuYXJyb3d7bGVmdDoyMHB4IWltcG9ydGFudH0ubm90ZS1wb3BvdmVyIC5wb3BvdmVyLWNvbnRlbnQsLnBhbmVsLWhlYWRpbmcubm90ZS10b29sYmFye3BhZGRpbmc6MCAwIDVweCA1cHg7bWFyZ2luOjB9Lm5vdGUtcG9wb3ZlciAucG9wb3Zlci1jb250ZW50Pi5idG4tZ3JvdXAsLnBhbmVsLWhlYWRpbmcubm90ZS10b29sYmFyPi5idG4tZ3JvdXB7bWFyZ2luLXRvcDo1cHg7bWFyZ2luLXJpZ2h0OjVweDttYXJnaW4tbGVmdDowfS5ub3RlLXBvcG92ZXIgLnBvcG92ZXItY29udGVudCAuYnRuLWdyb3VwIC5ub3RlLXRhYmxlLC5wYW5lbC1oZWFkaW5nLm5vdGUtdG9vbGJhciAuYnRuLWdyb3VwIC5ub3RlLXRhYmxle21pbi13aWR0aDowO3BhZGRpbmc6NXB4fS5ub3RlLXBvcG92ZXIgLnBvcG92ZXItY29udGVudCAuYnRuLWdyb3VwIC5ub3RlLXRhYmxlIC5ub3RlLWRpbWVuc2lvbi1waWNrZXIsLnBhbmVsLWhlYWRpbmcubm90ZS10b29sYmFyIC5idG4tZ3JvdXAgLm5vdGUtdGFibGUgLm5vdGUtZGltZW5zaW9uLXBpY2tlcntmb250LXNpemU6MThweH0ubm90ZS1wb3BvdmVyIC5wb3BvdmVyLWNvbnRlbnQgLmJ0bi1ncm91cCAubm90ZS10YWJsZSAubm90ZS1kaW1lbnNpb24tcGlja2VyIC5ub3RlLWRpbWVuc2lvbi1waWNrZXItbW91c2VjYXRjaGVyLC5wYW5lbC1oZWFkaW5nLm5vdGUtdG9vbGJhciAuYnRuLWdyb3VwIC5ub3RlLXRhYmxlIC5ub3RlLWRpbWVuc2lvbi1waWNrZXIgLm5vdGUtZGltZW5zaW9uLXBpY2tlci1tb3VzZWNhdGNoZXJ7cG9zaXRpb246YWJzb2x1dGUhaW1wb3J0YW50O3otaW5kZXg6Mzt3aWR0aDoxMGVtO2hlaWdodDoxMGVtO2N1cnNvcjpwb2ludGVyfS5ub3RlLXBvcG92ZXIgLnBvcG92ZXItY29udGVudCAuYnRuLWdyb3VwIC5ub3RlLXRhYmxlIC5ub3RlLWRpbWVuc2lvbi1waWNrZXIgLm5vdGUtZGltZW5zaW9uLXBpY2tlci11bmhpZ2hsaWdodGVkLC5wYW5lbC1oZWFkaW5nLm5vdGUtdG9vbGJhciAuYnRuLWdyb3VwIC5ub3RlLXRhYmxlIC5ub3RlLWRpbWVuc2lvbi1waWNrZXIgLm5vdGUtZGltZW5zaW9uLXBpY2tlci11bmhpZ2hsaWdodGVke3Bvc2l0aW9uOnJlbGF0aXZlIWltcG9ydGFudDt6LWluZGV4OjE7d2lkdGg6NWVtO2hlaWdodDo1ZW07YmFja2dyb3VuZDp1cmwoJ2RhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQklBQUFBU0FnTUFBQUFyb0diRUFBQUFDVkJNVkVVQUFJajQrUGpwNmVrS2xBcWpBQUFBQVhSU1RsTUFRT2JZWmdBQUFBRmlTMGRFQUlnRkhVZ0FBQUFKY0VoWmN3QUFDeE1BQUFzVEFRQ2FuQmdBQUFBSGRFbE5SUWZZQVIwQktobW5hSnpQQUFBQUcwbEVRVlFJMTJOZ0FBT3RWYXRXTVRDb2hvYUdVWStFbUlrRUFFcnVFeksySjd0dkFBQUFBRWxGVGtTdVFtQ0MnKSByZXBlYXR9Lm5vdGUtcG9wb3ZlciAucG9wb3Zlci1jb250ZW50IC5idG4tZ3JvdXAgLm5vdGUtdGFibGUgLm5vdGUtZGltZW5zaW9uLXBpY2tlciAubm90ZS1kaW1lbnNpb24tcGlja2VyLWhpZ2hsaWdodGVkLC5wYW5lbC1oZWFkaW5nLm5vdGUtdG9vbGJhciAuYnRuLWdyb3VwIC5ub3RlLXRhYmxlIC5ub3RlLWRpbWVuc2lvbi1waWNrZXIgLm5vdGUtZGltZW5zaW9uLXBpY2tlci1oaWdobGlnaHRlZHtwb3NpdGlvbjphYnNvbHV0ZSFpbXBvcnRhbnQ7ei1pbmRleDoyO3dpZHRoOjFlbTtoZWlnaHQ6MWVtO2JhY2tncm91bmQ6dXJsKCdkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUJJQUFBQVNBZ01BQUFBcm9HYkVBQUFBQ1ZCTVZFVUFBSWpkNnZ2RDJmOUxLTFcrQUFBQUFYUlNUbE1BUU9iWVpnQUFBQUZpUzBkRUFJZ0ZIVWdBQUFBSmNFaFpjd0FBQ3hNQUFBc1RBUUNhbkJnQUFBQUhkRWxOUlFmWUFSMEJLd05ERVZUMEFBQUFHMGxFUVZRSTEyTmdBQU90VmF0V01UQ29ob2FHVVkrRW1Ja0VBRXJ1RXpLMko3dHZBQUFBQUVsRlRrU3VRbUNDJykgcmVwZWF0fS5ub3RlLXBvcG92ZXIgLnBvcG92ZXItY29udGVudCAubm90ZS1zdHlsZSBibG9ja3F1b3RlLC5ub3RlLXBvcG92ZXIgLnBvcG92ZXItY29udGVudCAubm90ZS1zdHlsZSBoMSwubm90ZS1wb3BvdmVyIC5wb3BvdmVyLWNvbnRlbnQgLm5vdGUtc3R5bGUgaDIsLm5vdGUtcG9wb3ZlciAucG9wb3Zlci1jb250ZW50IC5ub3RlLXN0eWxlIGgzLC5ub3RlLXBvcG92ZXIgLnBvcG92ZXItY29udGVudCAubm90ZS1zdHlsZSBoNCwubm90ZS1wb3BvdmVyIC5wb3BvdmVyLWNvbnRlbnQgLm5vdGUtc3R5bGUgaDUsLm5vdGUtcG9wb3ZlciAucG9wb3Zlci1jb250ZW50IC5ub3RlLXN0eWxlIGg2LC5wYW5lbC1oZWFkaW5nLm5vdGUtdG9vbGJhciAubm90ZS1zdHlsZSBibG9ja3F1b3RlLC5wYW5lbC1oZWFkaW5nLm5vdGUtdG9vbGJhciAubm90ZS1zdHlsZSBoMSwucGFuZWwtaGVhZGluZy5ub3RlLXRvb2xiYXIgLm5vdGUtc3R5bGUgaDIsLnBhbmVsLWhlYWRpbmcubm90ZS10b29sYmFyIC5ub3RlLXN0eWxlIGgzLC5wYW5lbC1oZWFkaW5nLm5vdGUtdG9vbGJhciAubm90ZS1zdHlsZSBoNCwucGFuZWwtaGVhZGluZy5ub3RlLXRvb2xiYXIgLm5vdGUtc3R5bGUgaDUsLnBhbmVsLWhlYWRpbmcubm90ZS10b29sYmFyIC5ub3RlLXN0eWxlIGg2e21hcmdpbjowfS5ub3RlLXBvcG92ZXIgLnBvcG92ZXItY29udGVudCAubm90ZS1jb2xvciAuZHJvcGRvd24tdG9nZ2xlLC5wYW5lbC1oZWFkaW5nLm5vdGUtdG9vbGJhciAubm90ZS1jb2xvciAuZHJvcGRvd24tdG9nZ2xle3dpZHRoOjIwcHg7cGFkZGluZy1sZWZ0OjVweH0ubm90ZS1wb3BvdmVyIC5wb3BvdmVyLWNvbnRlbnQgLm5vdGUtY29sb3IgLmRyb3Bkb3duLW1lbnUsLnBhbmVsLWhlYWRpbmcubm90ZS10b29sYmFyIC5ub3RlLWNvbG9yIC5kcm9wZG93bi1tZW51e21pbi13aWR0aDozNDBweH0ubm90ZS1wb3BvdmVyIC5wb3BvdmVyLWNvbnRlbnQgLm5vdGUtY29sb3IgLmRyb3Bkb3duLW1lbnUgLmJ0bi1ncm91cCwucGFuZWwtaGVhZGluZy5ub3RlLXRvb2xiYXIgLm5vdGUtY29sb3IgLmRyb3Bkb3duLW1lbnUgLmJ0bi1ncm91cHttYXJnaW46MH0ubm90ZS1wb3BvdmVyIC5wb3BvdmVyLWNvbnRlbnQgLm5vdGUtY29sb3IgLmRyb3Bkb3duLW1lbnUgLmJ0bi1ncm91cDpmaXJzdC1jaGlsZCwucGFuZWwtaGVhZGluZy5ub3RlLXRvb2xiYXIgLm5vdGUtY29sb3IgLmRyb3Bkb3duLW1lbnUgLmJ0bi1ncm91cDpmaXJzdC1jaGlsZHttYXJnaW46MCA1cHh9Lm5vdGUtcG9wb3ZlciAucG9wb3Zlci1jb250ZW50IC5ub3RlLWNvbG9yIC5kcm9wZG93bi1tZW51IC5idG4tZ3JvdXAgLm5vdGUtcGFsZXR0ZS10aXRsZSwucGFuZWwtaGVhZGluZy5ub3RlLXRvb2xiYXIgLm5vdGUtY29sb3IgLmRyb3Bkb3duLW1lbnUgLmJ0bi1ncm91cCAubm90ZS1wYWxldHRlLXRpdGxle21hcmdpbjoycHggN3B4O2ZvbnQtc2l6ZToxMnB4O3RleHQtYWxpZ246Y2VudGVyO2JvcmRlci1ib3R0b206MXB4IHNvbGlkICNlZWV9Lm5vdGUtcG9wb3ZlciAucG9wb3Zlci1jb250ZW50IC5ub3RlLWNvbG9yIC5kcm9wZG93bi1tZW51IC5idG4tZ3JvdXAgLm5vdGUtY29sb3ItcmVzZXQsLnBhbmVsLWhlYWRpbmcubm90ZS10b29sYmFyIC5ub3RlLWNvbG9yIC5kcm9wZG93bi1tZW51IC5idG4tZ3JvdXAgLm5vdGUtY29sb3ItcmVzZXR7d2lkdGg6MTAwJTtwYWRkaW5nOjAgM3B4O21hcmdpbjozcHg7Zm9udC1zaXplOjExcHg7Y3Vyc29yOnBvaW50ZXI7Ym9yZGVyLXJhZGl1czo1cHh9Lm5vdGUtcG9wb3ZlciAucG9wb3Zlci1jb250ZW50IC5ub3RlLWNvbG9yIC5kcm9wZG93bi1tZW51IC5idG4tZ3JvdXAgLm5vdGUtY29sb3Itcm93LC5wYW5lbC1oZWFkaW5nLm5vdGUtdG9vbGJhciAubm90ZS1jb2xvciAuZHJvcGRvd24tbWVudSAuYnRuLWdyb3VwIC5ub3RlLWNvbG9yLXJvd3toZWlnaHQ6MjBweH0ubm90ZS1wb3BvdmVyIC5wb3BvdmVyLWNvbnRlbnQgLm5vdGUtY29sb3IgLmRyb3Bkb3duLW1lbnUgLmJ0bi1ncm91cCAubm90ZS1jb2xvci1yZXNldDpob3ZlciwucGFuZWwtaGVhZGluZy5ub3RlLXRvb2xiYXIgLm5vdGUtY29sb3IgLmRyb3Bkb3duLW1lbnUgLmJ0bi1ncm91cCAubm90ZS1jb2xvci1yZXNldDpob3ZlcntiYWNrZ3JvdW5kOiNlZWV9Lm5vdGUtcG9wb3ZlciAucG9wb3Zlci1jb250ZW50IC5ub3RlLXBhcmEgLmRyb3Bkb3duLW1lbnUsLnBhbmVsLWhlYWRpbmcubm90ZS10b29sYmFyIC5ub3RlLXBhcmEgLmRyb3Bkb3duLW1lbnV7bWluLXdpZHRoOjIxNnB4O3BhZGRpbmc6NXB4fS5ub3RlLXBvcG92ZXIgLnBvcG92ZXItY29udGVudCAubm90ZS1wYXJhIC5kcm9wZG93bi1tZW51PmRpdjpmaXJzdC1jaGlsZCwucGFuZWwtaGVhZGluZy5ub3RlLXRvb2xiYXIgLm5vdGUtcGFyYSAuZHJvcGRvd24tbWVudT5kaXY6Zmlyc3QtY2hpbGR7bWFyZ2luLXJpZ2h0OjVweH0ubm90ZS1wb3BvdmVyIC5wb3BvdmVyLWNvbnRlbnQgLmRyb3Bkb3duLW1lbnUsLnBhbmVsLWhlYWRpbmcubm90ZS10b29sYmFyIC5kcm9wZG93bi1tZW51e21pbi13aWR0aDo5MHB4fS5ub3RlLXBvcG92ZXIgLnBvcG92ZXItY29udGVudCAuZHJvcGRvd24tbWVudS5yaWdodCwucGFuZWwtaGVhZGluZy5ub3RlLXRvb2xiYXIgLmRyb3Bkb3duLW1lbnUucmlnaHR7cmlnaHQ6MDtsZWZ0OmF1dG99Lm5vdGUtcG9wb3ZlciAucG9wb3Zlci1jb250ZW50IC5kcm9wZG93bi1tZW51LnJpZ2h0OmJlZm9yZSwucGFuZWwtaGVhZGluZy5ub3RlLXRvb2xiYXIgLmRyb3Bkb3duLW1lbnUucmlnaHQ6YmVmb3Jle3JpZ2h0OjlweDtsZWZ0OmF1dG8haW1wb3J0YW50fS5ub3RlLXBvcG92ZXIgLnBvcG92ZXItY29udGVudCAuZHJvcGRvd24tbWVudS5yaWdodDphZnRlciwucGFuZWwtaGVhZGluZy5ub3RlLXRvb2xiYXIgLmRyb3Bkb3duLW1lbnUucmlnaHQ6YWZ0ZXJ7cmlnaHQ6MTBweDtsZWZ0OmF1dG8haW1wb3J0YW50fS5ub3RlLXBvcG92ZXIgLnBvcG92ZXItY29udGVudCAuZHJvcGRvd24tbWVudS5ub3RlLWNoZWNrIGxpIGEgaSwucGFuZWwtaGVhZGluZy5ub3RlLXRvb2xiYXIgLmRyb3Bkb3duLW1lbnUubm90ZS1jaGVjayBsaSBhIGl7Y29sb3I6IzAwYmZmZjt2aXNpYmlsaXR5OmhpZGRlbn0ubm90ZS1wb3BvdmVyIC5wb3BvdmVyLWNvbnRlbnQgLmRyb3Bkb3duLW1lbnUubm90ZS1jaGVjayBsaSBhLmNoZWNrZWQgaSwucGFuZWwtaGVhZGluZy5ub3RlLXRvb2xiYXIgLmRyb3Bkb3duLW1lbnUubm90ZS1jaGVjayBsaSBhLmNoZWNrZWQgaXt2aXNpYmlsaXR5OnZpc2libGV9Lm5vdGUtcG9wb3ZlciAucG9wb3Zlci1jb250ZW50IC5ub3RlLWZvbnRzaXplLTEwLC5wYW5lbC1oZWFkaW5nLm5vdGUtdG9vbGJhciAubm90ZS1mb250c2l6ZS0xMHtmb250LXNpemU6MTBweH0ubm90ZS1wb3BvdmVyIC5wb3BvdmVyLWNvbnRlbnQgLm5vdGUtY29sb3ItcGFsZXR0ZSwucGFuZWwtaGVhZGluZy5ub3RlLXRvb2xiYXIgLm5vdGUtY29sb3ItcGFsZXR0ZXtsaW5lLWhlaWdodDoxfS5ub3RlLXBvcG92ZXIgLnBvcG92ZXItY29udGVudCAubm90ZS1jb2xvci1wYWxldHRlIGRpdiAubm90ZS1jb2xvci1idG4sLnBhbmVsLWhlYWRpbmcubm90ZS10b29sYmFyIC5ub3RlLWNvbG9yLXBhbGV0dGUgZGl2IC5ub3RlLWNvbG9yLWJ0bnt3aWR0aDoyMHB4O2hlaWdodDoyMHB4O3BhZGRpbmc6MDttYXJnaW46MDtib3JkZXI6MXB4IHNvbGlkICNmZmZ9Lm5vdGUtcG9wb3ZlciAucG9wb3Zlci1jb250ZW50IC5ub3RlLWNvbG9yLXBhbGV0dGUgZGl2IC5ub3RlLWNvbG9yLWJ0bjpob3ZlciwucGFuZWwtaGVhZGluZy5ub3RlLXRvb2xiYXIgLm5vdGUtY29sb3ItcGFsZXR0ZSBkaXYgLm5vdGUtY29sb3ItYnRuOmhvdmVye2JvcmRlcjoxcHggc29saWQgIzAwMH0ubm90ZS1kaWFsb2c+ZGl2e2Rpc3BsYXk6bm9uZX0ubm90ZS1kaWFsb2cgLmZvcm0tZ3JvdXB7bWFyZ2luLXJpZ2h0OjA7bWFyZ2luLWxlZnQ6MH0ubm90ZS1kaWFsb2cgLm5vdGUtbW9kYWwtZm9ybXttYXJnaW46MH0ubm90ZS1kaWFsb2cgLm5vdGUtaW1hZ2UtZGlhbG9nIC5ub3RlLWRyb3B6b25le21pbi1oZWlnaHQ6MTAwcHg7bWFyZ2luLWJvdHRvbToxMHB4O2ZvbnQtc2l6ZTozMHB4O2xpbmUtaGVpZ2h0OjQ7Y29sb3I6I2QzZDNkMzt0ZXh0LWFsaWduOmNlbnRlcjtib3JkZXI6NHB4IGRhc2hlZCAjZDNkM2QzfUAtbW96LWRvY3VtZW50IHVybC1wcmVmaXgoKXsubm90ZS1pbWFnZS1pbnB1dHtoZWlnaHQ6YXV0b319Lm5vdGUtcGxhY2Vob2xkZXJ7cG9zaXRpb246YWJzb2x1dGU7ZGlzcGxheTpub25lO2NvbG9yOmdyYXl9Lm5vdGUtaGFuZGxlIC5ub3RlLWNvbnRyb2wtc2VsZWN0aW9ue3Bvc2l0aW9uOmFic29sdXRlO2Rpc3BsYXk6bm9uZTtib3JkZXI6MXB4IHNvbGlkICMwMDB9Lm5vdGUtaGFuZGxlIC5ub3RlLWNvbnRyb2wtc2VsZWN0aW9uPmRpdntwb3NpdGlvbjphYnNvbHV0ZX0ubm90ZS1oYW5kbGUgLm5vdGUtY29udHJvbC1zZWxlY3Rpb24gLm5vdGUtY29udHJvbC1zZWxlY3Rpb24tYmd7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTtiYWNrZ3JvdW5kLWNvbG9yOiMwMDA7LXdlYmtpdC1vcGFjaXR5Oi4zOy1raHRtbC1vcGFjaXR5Oi4zOy1tb3otb3BhY2l0eTouMztvcGFjaXR5Oi4zOy1tcy1maWx0ZXI6YWxwaGEob3BhY2l0eT0zMCk7ZmlsdGVyOmFscGhhKG9wYWNpdHk9MzApfS5ub3RlLWhhbmRsZSAubm90ZS1jb250cm9sLXNlbGVjdGlvbiAubm90ZS1jb250cm9sLWhhbmRsZSwubm90ZS1oYW5kbGUgLm5vdGUtY29udHJvbC1zZWxlY3Rpb24gLm5vdGUtY29udHJvbC1ob2xkZXJ7d2lkdGg6N3B4O2hlaWdodDo3cHg7Ym9yZGVyOjFweCBzb2xpZCAjMDAwfS5ub3RlLWhhbmRsZSAubm90ZS1jb250cm9sLXNlbGVjdGlvbiAubm90ZS1jb250cm9sLXNpemluZ3t3aWR0aDo3cHg7aGVpZ2h0OjdweDtiYWNrZ3JvdW5kLWNvbG9yOiNmZmY7Ym9yZGVyOjFweCBzb2xpZCAjMDAwfS5ub3RlLWhhbmRsZSAubm90ZS1jb250cm9sLXNlbGVjdGlvbiAubm90ZS1jb250cm9sLW53e3RvcDotNXB4O2xlZnQ6LTVweDtib3JkZXItcmlnaHQ6MDtib3JkZXItYm90dG9tOjB9Lm5vdGUtaGFuZGxlIC5ub3RlLWNvbnRyb2wtc2VsZWN0aW9uIC5ub3RlLWNvbnRyb2wtbmV7dG9wOi01cHg7cmlnaHQ6LTVweDtib3JkZXItYm90dG9tOjA7Ym9yZGVyLWxlZnQ6bm9uZX0ubm90ZS1oYW5kbGUgLm5vdGUtY29udHJvbC1zZWxlY3Rpb24gLm5vdGUtY29udHJvbC1zd3tib3R0b206LTVweDtsZWZ0Oi01cHg7Ym9yZGVyLXRvcDowO2JvcmRlci1yaWdodDowfS5ub3RlLWhhbmRsZSAubm90ZS1jb250cm9sLXNlbGVjdGlvbiAubm90ZS1jb250cm9sLXNle3JpZ2h0Oi01cHg7Ym90dG9tOi01cHg7Y3Vyc29yOnNlLXJlc2l6ZX0ubm90ZS1oYW5kbGUgLm5vdGUtY29udHJvbC1zZWxlY3Rpb24gLm5vdGUtY29udHJvbC1zZS5ub3RlLWNvbnRyb2wtaG9sZGVye2N1cnNvcjpkZWZhdWx0O2JvcmRlci10b3A6MDtib3JkZXItbGVmdDpub25lfS5ub3RlLWhhbmRsZSAubm90ZS1jb250cm9sLXNlbGVjdGlvbiAubm90ZS1jb250cm9sLXNlbGVjdGlvbi1pbmZve3JpZ2h0OjA7Ym90dG9tOjA7cGFkZGluZzo1cHg7bWFyZ2luOjVweDtmb250LXNpemU6MTJweDtjb2xvcjojZmZmO2JhY2tncm91bmQtY29sb3I6IzAwMDtib3JkZXItcmFkaXVzOjVweDstd2Via2l0LW9wYWNpdHk6Ljc7LWtodG1sLW9wYWNpdHk6Ljc7LW1vei1vcGFjaXR5Oi43O29wYWNpdHk6Ljc7LW1zLWZpbHRlcjphbHBoYShvcGFjaXR5PTcwKTtmaWx0ZXI6YWxwaGEob3BhY2l0eT03MCl9Lm5vdGUtaGludC1wb3BvdmVye21pbi13aWR0aDoxMDBweDtwYWRkaW5nOjJweH0ubm90ZS1oaW50LXBvcG92ZXIgLnBvcG92ZXItY29udGVudHttYXgtaGVpZ2h0OjE1MHB4O3BhZGRpbmc6M3B4O292ZXJmbG93OmF1dG99Lm5vdGUtaGludC1wb3BvdmVyIC5wb3BvdmVyLWNvbnRlbnQgLm5vdGUtaGludC1ncm91cCAubm90ZS1oaW50LWl0ZW17ZGlzcGxheTpibG9jayFpbXBvcnRhbnQ7cGFkZGluZzozcHh9Lm5vdGUtaGludC1wb3BvdmVyIC5wb3BvdmVyLWNvbnRlbnQgLm5vdGUtaGludC1ncm91cCAubm90ZS1oaW50LWl0ZW0uYWN0aXZlLC5ub3RlLWhpbnQtcG9wb3ZlciAucG9wb3Zlci1jb250ZW50IC5ub3RlLWhpbnQtZ3JvdXAgLm5vdGUtaGludC1pdGVtOmhvdmVye2Rpc3BsYXk6YmxvY2s7Y2xlYXI6Ym90aDtmb250LXdlaWdodDo0MDA7bGluZS1oZWlnaHQ6MS40O2NvbG9yOiNmZmY7dGV4dC1kZWNvcmF0aW9uOm5vbmU7d2hpdGUtc3BhY2U6bm93cmFwO2N1cnNvcjpwb2ludGVyO2JhY2tncm91bmQtY29sb3I6IzQyOGJjYTtvdXRsaW5lOjB9XCIsIFwiXCJdKTtcblxuLy8gZXhwb3J0c1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2Nzcy1sb2FkZXIhLi9+L3N1bW1lcm5vdGUvZGlzdC9zdW1tZXJub3RlLmNzc1xuLy8gbW9kdWxlIGlkID0gMTMzXG4vLyBtb2R1bGUgY2h1bmtzID0gMjAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9');
},134:function(module,exports,__webpack_require__){eval('module.exports = __webpack_require__.p + "./font/9cd6e041544b63fb70f4b3e898a9878d.eot";//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTM0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vfi9zdW1tZXJub3RlL2Rpc3QvZm9udC9zdW1tZXJub3RlLmVvdD8wNDM3Il0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3B1YmxpY19wYXRoX18gKyBcIi4vZm9udC85Y2Q2ZTA0MTU0NGI2M2ZiNzBmNGIzZTg5OGE5ODc4ZC5lb3RcIjtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vc3VtbWVybm90ZS9kaXN0L2ZvbnQvc3VtbWVybm90ZS5lb3Q/YWQ4ZDdlMmQxNzdkMjQ3M2FlY2Q5YjM1ZDE2MjExZmJcbi8vIG1vZHVsZSBpZCA9IDEzNFxuLy8gbW9kdWxlIGNodW5rcyA9IDIwIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==')},135:function(module,exports,__webpack_require__){eval('module.exports = __webpack_require__.p + "./font/9cd6e041544b63fb70f4b3e898a9878d.eot";//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTM1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vfi9zdW1tZXJub3RlL2Rpc3QvZm9udC9zdW1tZXJub3RlLmVvdD80OGM4Il0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3B1YmxpY19wYXRoX18gKyBcIi4vZm9udC85Y2Q2ZTA0MTU0NGI2M2ZiNzBmNGIzZTg5OGE5ODc4ZC5lb3RcIjtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vc3VtbWVybm90ZS9kaXN0L2ZvbnQvc3VtbWVybm90ZS5lb3Rcbi8vIG1vZHVsZSBpZCA9IDEzNVxuLy8gbW9kdWxlIGNodW5rcyA9IDIwIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==')},136:function(module,exports,__webpack_require__){eval('module.exports = __webpack_require__.p + "./font/df36508b58279b852bce0bc1a503eb8d.woff";//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTM2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vfi9zdW1tZXJub3RlL2Rpc3QvZm9udC9zdW1tZXJub3RlLndvZmY/YjM5ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19wdWJsaWNfcGF0aF9fICsgXCIuL2ZvbnQvZGYzNjUwOGI1ODI3OWI4NTJiY2UwYmMxYTUwM2ViOGQud29mZlwiO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9zdW1tZXJub3RlL2Rpc3QvZm9udC9zdW1tZXJub3RlLndvZmY/YWQ4ZDdlMmQxNzdkMjQ3M2FlY2Q5YjM1ZDE2MjExZmJcbi8vIG1vZHVsZSBpZCA9IDEzNlxuLy8gbW9kdWxlIGNodW5rcyA9IDIwIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==')},137:function(module,exports,__webpack_require__){eval('module.exports = __webpack_require__.p + "./font/fce9a0f2784bc80eeb2f2f25f670f3da.ttf";//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTM3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vfi9zdW1tZXJub3RlL2Rpc3QvZm9udC9zdW1tZXJub3RlLnR0Zj8xZjg5Il0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3B1YmxpY19wYXRoX18gKyBcIi4vZm9udC9mY2U5YTBmMjc4NGJjODBlZWIyZjJmMjVmNjcwZjNkYS50dGZcIjtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vc3VtbWVybm90ZS9kaXN0L2ZvbnQvc3VtbWVybm90ZS50dGY/YWQ4ZDdlMmQxNzdkMjQ3M2FlY2Q5YjM1ZDE2MjExZmJcbi8vIG1vZHVsZSBpZCA9IDEzN1xuLy8gbW9kdWxlIGNodW5rcyA9IDIwIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==')},138:function(module,exports,__webpack_require__){eval("var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/**\n * Super simple wysiwyg editor v0.8.2\n * http://summernote.org/\n *\n * summernote.js\n * Copyright 2013-2016 Alan Hong. and other contributors\n * summernote may be freely distributed under the MIT license./\n *\n * Date: 2016-08-07T05:11Z\n */(function(factory){/* global define */if(true){// AMD. Register as an anonymous module.\n!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(1)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));}else if(typeof module==='object'&&module.exports){// Node/CommonJS\nmodule.exports=factory(require('jquery'));}else{// Browser globals\nfactory(window.jQuery);}})(function($){'use strict';/**\n   * @class core.func\n   *\n   * func utils (for high-order func's arg)\n   *\n   * @singleton\n   * @alternateClassName func\n   */var func=function(){var eq=function(itemA){return function(itemB){return itemA===itemB;};};var eq2=function(itemA,itemB){return itemA===itemB;};var peq2=function(propName){return function(itemA,itemB){return itemA[propName]===itemB[propName];};};var ok=function(){return true;};var fail=function(){return false;};var not=function(f){return function(){return!f.apply(f,arguments);};};var and=function(fA,fB){return function(item){return fA(item)&&fB(item);};};var self=function(a){return a;};var invoke=function(obj,method){return function(){return obj[method].apply(obj,arguments);};};var idCounter=0;/**\n     * generate a globally-unique id\n     *\n     * @param {String} [prefix]\n     */var uniqueId=function(prefix){var id=++idCounter+'';return prefix?prefix+id:id;};/**\n     * returns bnd (bounds) from rect\n     *\n     * - IE Compatibility Issue: http://goo.gl/sRLOAo\n     * - Scroll Issue: http://goo.gl/sNjUc\n     *\n     * @param {Rect} rect\n     * @return {Object} bounds\n     * @return {Number} bounds.top\n     * @return {Number} bounds.left\n     * @return {Number} bounds.width\n     * @return {Number} bounds.height\n     */var rect2bnd=function(rect){var $document=$(document);return{top:rect.top+$document.scrollTop(),left:rect.left+$document.scrollLeft(),width:rect.right-rect.left,height:rect.bottom-rect.top};};/**\n     * returns a copy of the object where the keys have become the values and the values the keys.\n     * @param {Object} obj\n     * @return {Object}\n     */var invertObject=function(obj){var inverted={};for(var key in obj){if(obj.hasOwnProperty(key)){inverted[obj[key]]=key;}}return inverted;};/**\n     * @param {String} namespace\n     * @param {String} [prefix]\n     * @return {String}\n     */var namespaceToCamel=function(namespace,prefix){prefix=prefix||'';return prefix+namespace.split('.').map(function(name){return name.substring(0,1).toUpperCase()+name.substring(1);}).join('');};/**\n     * Returns a function, that, as long as it continues to be invoked, will not\n     * be triggered. The function will be called after it stops being called for\n     * N milliseconds. If `immediate` is passed, trigger the function on the\n     * leading edge, instead of the trailing.\n     * @param {Function} func\n     * @param {Number} wait\n     * @param {Boolean} immediate\n     * @return {Function}\n     */var debounce=function(func,wait,immediate){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate){func.apply(context,args);}};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow){func.apply(context,args);}};};return{eq:eq,eq2:eq2,peq2:peq2,ok:ok,fail:fail,self:self,not:not,and:and,invoke:invoke,uniqueId:uniqueId,rect2bnd:rect2bnd,invertObject:invertObject,namespaceToCamel:namespaceToCamel,debounce:debounce};}();/**\n   * @class core.list\n   *\n   * list utils\n   *\n   * @singleton\n   * @alternateClassName list\n   */var list=function(){/**\n     * returns the first item of an array.\n     *\n     * @param {Array} array\n     */var head=function(array){return array[0];};/**\n     * returns the last item of an array.\n     *\n     * @param {Array} array\n     */var last=function(array){return array[array.length-1];};/**\n     * returns everything but the last entry of the array.\n     *\n     * @param {Array} array\n     */var initial=function(array){return array.slice(0,array.length-1);};/**\n     * returns the rest of the items in an array.\n     *\n     * @param {Array} array\n     */var tail=function(array){return array.slice(1);};/**\n     * returns item of array\n     */var find=function(array,pred){for(var idx=0,len=array.length;idx<len;idx++){var item=array[idx];if(pred(item)){return item;}}};/**\n     * returns true if all of the values in the array pass the predicate truth test.\n     */var all=function(array,pred){for(var idx=0,len=array.length;idx<len;idx++){if(!pred(array[idx])){return false;}}return true;};/**\n     * returns index of item\n     */var indexOf=function(array,item){return $.inArray(item,array);};/**\n     * returns true if the value is present in the list.\n     */var contains=function(array,item){return indexOf(array,item)!==-1;};/**\n     * get sum from a list\n     *\n     * @param {Array} array - array\n     * @param {Function} fn - iterator\n     */var sum=function(array,fn){fn=fn||func.self;return array.reduce(function(memo,v){return memo+fn(v);},0);};/**\n     * returns a copy of the collection with array type.\n     * @param {Collection} collection - collection eg) node.childNodes, ...\n     */var from=function(collection){var result=[],idx=-1,length=collection.length;while(++idx<length){result[idx]=collection[idx];}return result;};/**\n     * returns whether list is empty or not\n     */var isEmpty=function(array){return!array||!array.length;};/**\n     * cluster elements by predicate function.\n     *\n     * @param {Array} array - array\n     * @param {Function} fn - predicate function for cluster rule\n     * @param {Array[]}\n     */var clusterBy=function(array,fn){if(!array.length){return[];}var aTail=tail(array);return aTail.reduce(function(memo,v){var aLast=last(memo);if(fn(last(aLast),v)){aLast[aLast.length]=v;}else{memo[memo.length]=[v];}return memo;},[[head(array)]]);};/**\n     * returns a copy of the array with all false values removed\n     *\n     * @param {Array} array - array\n     * @param {Function} fn - predicate function for cluster rule\n     */var compact=function(array){var aResult=[];for(var idx=0,len=array.length;idx<len;idx++){if(array[idx]){aResult.push(array[idx]);}}return aResult;};/**\n     * produces a duplicate-free version of the array\n     *\n     * @param {Array} array\n     */var unique=function(array){var results=[];for(var idx=0,len=array.length;idx<len;idx++){if(!contains(results,array[idx])){results.push(array[idx]);}}return results;};/**\n     * returns next item.\n     * @param {Array} array\n     */var next=function(array,item){var idx=indexOf(array,item);if(idx===-1){return null;}return array[idx+1];};/**\n     * returns prev item.\n     * @param {Array} array\n     */var prev=function(array,item){var idx=indexOf(array,item);if(idx===-1){return null;}return array[idx-1];};return{head:head,last:last,initial:initial,tail:tail,prev:prev,next:next,find:find,contains:contains,all:all,sum:sum,from:from,isEmpty:isEmpty,clusterBy:clusterBy,compact:compact,unique:unique};}();var isSupportAmd=\"function\"==='function'&&__webpack_require__(139);/**\n   * returns whether font is installed or not.\n   *\n   * @param {String} fontName\n   * @return {Boolean}\n   */var isFontInstalled=function(fontName){var testFontName=fontName==='Comic Sans MS'?'Courier New':'Comic Sans MS';var $tester=$('<div>').css({position:'absolute',left:'-9999px',top:'-9999px',fontSize:'200px'}).text('mmmmmmmmmwwwwwww').appendTo(document.body);var originalWidth=$tester.css('fontFamily',testFontName).width();var width=$tester.css('fontFamily',fontName+','+testFontName).width();$tester.remove();return originalWidth!==width;};var userAgent=navigator.userAgent;var isMSIE=/MSIE|Trident/i.test(userAgent);var browserVersion;if(isMSIE){var matches=/MSIE (\\d+[.]\\d+)/.exec(userAgent);if(matches){browserVersion=parseFloat(matches[1]);}matches=/Trident\\/.*rv:([0-9]{1,}[\\.0-9]{0,})/.exec(userAgent);if(matches){browserVersion=parseFloat(matches[1]);}}var isEdge=/Edge\\/\\d+/.test(userAgent);var hasCodeMirror=!!window.CodeMirror;if(!hasCodeMirror&&isSupportAmd&&\"function\"!=='undefined'){if(true){try{// If CodeMirror can't be resolved, `require.resolve` will throw an\n// exception and `hasCodeMirror` won't be set to `true`.\n/*require.resolve*/(55);hasCodeMirror=true;}catch(e){// Do nothing.\n}}else if(typeof eval('require').specified!=='undefined'){hasCodeMirror=eval('require').specified('codemirror');}}/**\n   * @class core.agent\n   *\n   * Object which check platform and agent\n   *\n   * @singleton\n   * @alternateClassName agent\n   */var agent={isMac:navigator.appVersion.indexOf('Mac')>-1,isMSIE:isMSIE,isEdge:isEdge,isFF:!isEdge&&/firefox/i.test(userAgent),isPhantom:/PhantomJS/i.test(userAgent),isWebkit:!isEdge&&/webkit/i.test(userAgent),isChrome:!isEdge&&/chrome/i.test(userAgent),isSafari:!isEdge&&/safari/i.test(userAgent),browserVersion:browserVersion,jqueryVersion:parseFloat($.fn.jquery),isSupportAmd:isSupportAmd,hasCodeMirror:hasCodeMirror,isFontInstalled:isFontInstalled,isW3CRangeSupport:!!document.createRange};var NBSP_CHAR=String.fromCharCode(160);var ZERO_WIDTH_NBSP_CHAR='\\ufeff';/**\n   * @class core.dom\n   *\n   * Dom functions\n   *\n   * @singleton\n   * @alternateClassName dom\n   */var dom=function(){/**\n     * @method isEditable\n     *\n     * returns whether node is `note-editable` or not.\n     *\n     * @param {Node} node\n     * @return {Boolean}\n     */var isEditable=function(node){return node&&$(node).hasClass('note-editable');};/**\n     * @method isControlSizing\n     *\n     * returns whether node is `note-control-sizing` or not.\n     *\n     * @param {Node} node\n     * @return {Boolean}\n     */var isControlSizing=function(node){return node&&$(node).hasClass('note-control-sizing');};/**\n     * @method makePredByNodeName\n     *\n     * returns predicate which judge whether nodeName is same\n     *\n     * @param {String} nodeName\n     * @return {Function}\n     */var makePredByNodeName=function(nodeName){nodeName=nodeName.toUpperCase();return function(node){return node&&node.nodeName.toUpperCase()===nodeName;};};/**\n     * @method isText\n     *\n     *\n     *\n     * @param {Node} node\n     * @return {Boolean} true if node's type is text(3)\n     */var isText=function(node){return node&&node.nodeType===3;};/**\n     * @method isElement\n     *\n     *\n     *\n     * @param {Node} node\n     * @return {Boolean} true if node's type is element(1)\n     */var isElement=function(node){return node&&node.nodeType===1;};/**\n     * ex) br, col, embed, hr, img, input, ...\n     * @see http://www.w3.org/html/wg/drafts/html/master/syntax.html#void-elements\n     */var isVoid=function(node){return node&&/^BR|^IMG|^HR|^IFRAME|^BUTTON/.test(node.nodeName.toUpperCase());};var isPara=function(node){if(isEditable(node)){return false;}// Chrome(v31.0), FF(v25.0.1) use DIV for paragraph\nreturn node&&/^DIV|^P|^LI|^H[1-7]/.test(node.nodeName.toUpperCase());};var isHeading=function(node){return node&&/^H[1-7]/.test(node.nodeName.toUpperCase());};var isPre=makePredByNodeName('PRE');var isLi=makePredByNodeName('LI');var isPurePara=function(node){return isPara(node)&&!isLi(node);};var isTable=makePredByNodeName('TABLE');var isData=makePredByNodeName('DATA');var isInline=function(node){return!isBodyContainer(node)&&!isList(node)&&!isHr(node)&&!isPara(node)&&!isTable(node)&&!isBlockquote(node)&&!isData(node);};var isList=function(node){return node&&/^UL|^OL/.test(node.nodeName.toUpperCase());};var isHr=makePredByNodeName('HR');var isCell=function(node){return node&&/^TD|^TH/.test(node.nodeName.toUpperCase());};var isBlockquote=makePredByNodeName('BLOCKQUOTE');var isBodyContainer=function(node){return isCell(node)||isBlockquote(node)||isEditable(node);};var isAnchor=makePredByNodeName('A');var isParaInline=function(node){return isInline(node)&&!!ancestor(node,isPara);};var isBodyInline=function(node){return isInline(node)&&!ancestor(node,isPara);};var isBody=makePredByNodeName('BODY');/**\n     * returns whether nodeB is closest sibling of nodeA\n     *\n     * @param {Node} nodeA\n     * @param {Node} nodeB\n     * @return {Boolean}\n     */var isClosestSibling=function(nodeA,nodeB){return nodeA.nextSibling===nodeB||nodeA.previousSibling===nodeB;};/**\n     * returns array of closest siblings with node\n     *\n     * @param {Node} node\n     * @param {function} [pred] - predicate function\n     * @return {Node[]}\n     */var withClosestSiblings=function(node,pred){pred=pred||func.ok;var siblings=[];if(node.previousSibling&&pred(node.previousSibling)){siblings.push(node.previousSibling);}siblings.push(node);if(node.nextSibling&&pred(node.nextSibling)){siblings.push(node.nextSibling);}return siblings;};/**\n     * blank HTML for cursor position\n     * - [workaround] old IE only works with &nbsp;\n     * - [workaround] IE11 and other browser works with bogus br\n     */var blankHTML=agent.isMSIE&&agent.browserVersion<11?'&nbsp;':'<br>';/**\n     * @method nodeLength\n     *\n     * returns #text's text size or element's childNodes size\n     *\n     * @param {Node} node\n     */var nodeLength=function(node){if(isText(node)){return node.nodeValue.length;}if(node){return node.childNodes.length;}return 0;};/**\n     * returns whether node is empty or not.\n     *\n     * @param {Node} node\n     * @return {Boolean}\n     */var isEmpty=function(node){var len=nodeLength(node);if(len===0){return true;}else if(!isText(node)&&len===1&&node.innerHTML===blankHTML){// ex) <p><br></p>, <span><br></span>\nreturn true;}else if(list.all(node.childNodes,isText)&&node.innerHTML===''){// ex) <p></p>, <span></span>\nreturn true;}return false;};/**\n     * padding blankHTML if node is empty (for cursor position)\n     */var paddingBlankHTML=function(node){if(!isVoid(node)&&!nodeLength(node)){node.innerHTML=blankHTML;}};/**\n     * find nearest ancestor predicate hit\n     *\n     * @param {Node} node\n     * @param {Function} pred - predicate function\n     */var ancestor=function(node,pred){while(node){if(pred(node)){return node;}if(isEditable(node)){break;}node=node.parentNode;}return null;};/**\n     * find nearest ancestor only single child blood line and predicate hit\n     *\n     * @param {Node} node\n     * @param {Function} pred - predicate function\n     */var singleChildAncestor=function(node,pred){node=node.parentNode;while(node){if(nodeLength(node)!==1){break;}if(pred(node)){return node;}if(isEditable(node)){break;}node=node.parentNode;}return null;};/**\n     * returns new array of ancestor nodes (until predicate hit).\n     *\n     * @param {Node} node\n     * @param {Function} [optional] pred - predicate function\n     */var listAncestor=function(node,pred){pred=pred||func.fail;var ancestors=[];ancestor(node,function(el){if(!isEditable(el)){ancestors.push(el);}return pred(el);});return ancestors;};/**\n     * find farthest ancestor predicate hit\n     */var lastAncestor=function(node,pred){var ancestors=listAncestor(node);return list.last(ancestors.filter(pred));};/**\n     * returns common ancestor node between two nodes.\n     *\n     * @param {Node} nodeA\n     * @param {Node} nodeB\n     */var commonAncestor=function(nodeA,nodeB){var ancestors=listAncestor(nodeA);for(var n=nodeB;n;n=n.parentNode){if($.inArray(n,ancestors)>-1){return n;}}return null;// difference document area\n};/**\n     * listing all previous siblings (until predicate hit).\n     *\n     * @param {Node} node\n     * @param {Function} [optional] pred - predicate function\n     */var listPrev=function(node,pred){pred=pred||func.fail;var nodes=[];while(node){if(pred(node)){break;}nodes.push(node);node=node.previousSibling;}return nodes;};/**\n     * listing next siblings (until predicate hit).\n     *\n     * @param {Node} node\n     * @param {Function} [pred] - predicate function\n     */var listNext=function(node,pred){pred=pred||func.fail;var nodes=[];while(node){if(pred(node)){break;}nodes.push(node);node=node.nextSibling;}return nodes;};/**\n     * listing descendant nodes\n     *\n     * @param {Node} node\n     * @param {Function} [pred] - predicate function\n     */var listDescendant=function(node,pred){var descendants=[];pred=pred||func.ok;// start DFS(depth first search) with node\n(function fnWalk(current){if(node!==current&&pred(current)){descendants.push(current);}for(var idx=0,len=current.childNodes.length;idx<len;idx++){fnWalk(current.childNodes[idx]);}})(node);return descendants;};/**\n     * wrap node with new tag.\n     *\n     * @param {Node} node\n     * @param {Node} tagName of wrapper\n     * @return {Node} - wrapper\n     */var wrap=function(node,wrapperName){var parent=node.parentNode;var wrapper=$('<'+wrapperName+'>')[0];parent.insertBefore(wrapper,node);wrapper.appendChild(node);return wrapper;};/**\n     * insert node after preceding\n     *\n     * @param {Node} node\n     * @param {Node} preceding - predicate function\n     */var insertAfter=function(node,preceding){var next=preceding.nextSibling,parent=preceding.parentNode;if(next){parent.insertBefore(node,next);}else{parent.appendChild(node);}return node;};/**\n     * append elements.\n     *\n     * @param {Node} node\n     * @param {Collection} aChild\n     */var appendChildNodes=function(node,aChild){$.each(aChild,function(idx,child){node.appendChild(child);});return node;};/**\n     * returns whether boundaryPoint is left edge or not.\n     *\n     * @param {BoundaryPoint} point\n     * @return {Boolean}\n     */var isLeftEdgePoint=function(point){return point.offset===0;};/**\n     * returns whether boundaryPoint is right edge or not.\n     *\n     * @param {BoundaryPoint} point\n     * @return {Boolean}\n     */var isRightEdgePoint=function(point){return point.offset===nodeLength(point.node);};/**\n     * returns whether boundaryPoint is edge or not.\n     *\n     * @param {BoundaryPoint} point\n     * @return {Boolean}\n     */var isEdgePoint=function(point){return isLeftEdgePoint(point)||isRightEdgePoint(point);};/**\n     * returns whether node is left edge of ancestor or not.\n     *\n     * @param {Node} node\n     * @param {Node} ancestor\n     * @return {Boolean}\n     */var isLeftEdgeOf=function(node,ancestor){while(node&&node!==ancestor){if(position(node)!==0){return false;}node=node.parentNode;}return true;};/**\n     * returns whether node is right edge of ancestor or not.\n     *\n     * @param {Node} node\n     * @param {Node} ancestor\n     * @return {Boolean}\n     */var isRightEdgeOf=function(node,ancestor){if(!ancestor){return false;}while(node&&node!==ancestor){if(position(node)!==nodeLength(node.parentNode)-1){return false;}node=node.parentNode;}return true;};/**\n     * returns whether point is left edge of ancestor or not.\n     * @param {BoundaryPoint} point\n     * @param {Node} ancestor\n     * @return {Boolean}\n     */var isLeftEdgePointOf=function(point,ancestor){return isLeftEdgePoint(point)&&isLeftEdgeOf(point.node,ancestor);};/**\n     * returns whether point is right edge of ancestor or not.\n     * @param {BoundaryPoint} point\n     * @param {Node} ancestor\n     * @return {Boolean}\n     */var isRightEdgePointOf=function(point,ancestor){return isRightEdgePoint(point)&&isRightEdgeOf(point.node,ancestor);};/**\n     * returns offset from parent.\n     *\n     * @param {Node} node\n     */var position=function(node){var offset=0;while(node=node.previousSibling){offset+=1;}return offset;};var hasChildren=function(node){return!!(node&&node.childNodes&&node.childNodes.length);};/**\n     * returns previous boundaryPoint\n     *\n     * @param {BoundaryPoint} point\n     * @param {Boolean} isSkipInnerOffset\n     * @return {BoundaryPoint}\n     */var prevPoint=function(point,isSkipInnerOffset){var node,offset;if(point.offset===0){if(isEditable(point.node)){return null;}node=point.node.parentNode;offset=position(point.node);}else if(hasChildren(point.node)){node=point.node.childNodes[point.offset-1];offset=nodeLength(node);}else{node=point.node;offset=isSkipInnerOffset?0:point.offset-1;}return{node:node,offset:offset};};/**\n     * returns next boundaryPoint\n     *\n     * @param {BoundaryPoint} point\n     * @param {Boolean} isSkipInnerOffset\n     * @return {BoundaryPoint}\n     */var nextPoint=function(point,isSkipInnerOffset){var node,offset;if(nodeLength(point.node)===point.offset){if(isEditable(point.node)){return null;}node=point.node.parentNode;offset=position(point.node)+1;}else if(hasChildren(point.node)){node=point.node.childNodes[point.offset];offset=0;}else{node=point.node;offset=isSkipInnerOffset?nodeLength(point.node):point.offset+1;}return{node:node,offset:offset};};/**\n     * returns whether pointA and pointB is same or not.\n     *\n     * @param {BoundaryPoint} pointA\n     * @param {BoundaryPoint} pointB\n     * @return {Boolean}\n     */var isSamePoint=function(pointA,pointB){return pointA.node===pointB.node&&pointA.offset===pointB.offset;};/**\n     * returns whether point is visible (can set cursor) or not.\n     *\n     * @param {BoundaryPoint} point\n     * @return {Boolean}\n     */var isVisiblePoint=function(point){if(isText(point.node)||!hasChildren(point.node)||isEmpty(point.node)){return true;}var leftNode=point.node.childNodes[point.offset-1];var rightNode=point.node.childNodes[point.offset];if((!leftNode||isVoid(leftNode))&&(!rightNode||isVoid(rightNode))){return true;}return false;};/**\n     * @method prevPointUtil\n     *\n     * @param {BoundaryPoint} point\n     * @param {Function} pred\n     * @return {BoundaryPoint}\n     */var prevPointUntil=function(point,pred){while(point){if(pred(point)){return point;}point=prevPoint(point);}return null;};/**\n     * @method nextPointUntil\n     *\n     * @param {BoundaryPoint} point\n     * @param {Function} pred\n     * @return {BoundaryPoint}\n     */var nextPointUntil=function(point,pred){while(point){if(pred(point)){return point;}point=nextPoint(point);}return null;};/**\n     * returns whether point has character or not.\n     *\n     * @param {Point} point\n     * @return {Boolean}\n     */var isCharPoint=function(point){if(!isText(point.node)){return false;}var ch=point.node.nodeValue.charAt(point.offset-1);return ch&&ch!==' '&&ch!==NBSP_CHAR;};/**\n     * @method walkPoint\n     *\n     * @param {BoundaryPoint} startPoint\n     * @param {BoundaryPoint} endPoint\n     * @param {Function} handler\n     * @param {Boolean} isSkipInnerOffset\n     */var walkPoint=function(startPoint,endPoint,handler,isSkipInnerOffset){var point=startPoint;while(point){handler(point);if(isSamePoint(point,endPoint)){break;}var isSkipOffset=isSkipInnerOffset&&startPoint.node!==point.node&&endPoint.node!==point.node;point=nextPoint(point,isSkipOffset);}};/**\n     * @method makeOffsetPath\n     *\n     * return offsetPath(array of offset) from ancestor\n     *\n     * @param {Node} ancestor - ancestor node\n     * @param {Node} node\n     */var makeOffsetPath=function(ancestor,node){var ancestors=listAncestor(node,func.eq(ancestor));return ancestors.map(position).reverse();};/**\n     * @method fromOffsetPath\n     *\n     * return element from offsetPath(array of offset)\n     *\n     * @param {Node} ancestor - ancestor node\n     * @param {array} offsets - offsetPath\n     */var fromOffsetPath=function(ancestor,offsets){var current=ancestor;for(var i=0,len=offsets.length;i<len;i++){if(current.childNodes.length<=offsets[i]){current=current.childNodes[current.childNodes.length-1];}else{current=current.childNodes[offsets[i]];}}return current;};/**\n     * @method splitNode\n     *\n     * split element or #text\n     *\n     * @param {BoundaryPoint} point\n     * @param {Object} [options]\n     * @param {Boolean} [options.isSkipPaddingBlankHTML] - default: false\n     * @param {Boolean} [options.isNotSplitEdgePoint] - default: false\n     * @return {Node} right node of boundaryPoint\n     */var splitNode=function(point,options){var isSkipPaddingBlankHTML=options&&options.isSkipPaddingBlankHTML;var isNotSplitEdgePoint=options&&options.isNotSplitEdgePoint;// edge case\nif(isEdgePoint(point)&&(isText(point.node)||isNotSplitEdgePoint)){if(isLeftEdgePoint(point)){return point.node;}else if(isRightEdgePoint(point)){return point.node.nextSibling;}}// split #text\nif(isText(point.node)){return point.node.splitText(point.offset);}else{var childNode=point.node.childNodes[point.offset];var clone=insertAfter(point.node.cloneNode(false),point.node);appendChildNodes(clone,listNext(childNode));if(!isSkipPaddingBlankHTML){paddingBlankHTML(point.node);paddingBlankHTML(clone);}return clone;}};/**\n     * @method splitTree\n     *\n     * split tree by point\n     *\n     * @param {Node} root - split root\n     * @param {BoundaryPoint} point\n     * @param {Object} [options]\n     * @param {Boolean} [options.isSkipPaddingBlankHTML] - default: false\n     * @param {Boolean} [options.isNotSplitEdgePoint] - default: false\n     * @return {Node} right node of boundaryPoint\n     */var splitTree=function(root,point,options){// ex) [#text, <span>, <p>]\nvar ancestors=listAncestor(point.node,func.eq(root));if(!ancestors.length){return null;}else if(ancestors.length===1){return splitNode(point,options);}return ancestors.reduce(function(node,parent){if(node===point.node){node=splitNode(point,options);}return splitNode({node:parent,offset:node?dom.position(node):nodeLength(parent)},options);});};/**\n     * split point\n     *\n     * @param {Point} point\n     * @param {Boolean} isInline\n     * @return {Object}\n     */var splitPoint=function(point,isInline){// find splitRoot, container\n//  - inline: splitRoot is a child of paragraph\n//  - block: splitRoot is a child of bodyContainer\nvar pred=isInline?isPara:isBodyContainer;var ancestors=listAncestor(point.node,pred);var topAncestor=list.last(ancestors)||point.node;var splitRoot,container;if(pred(topAncestor)){splitRoot=ancestors[ancestors.length-2];container=topAncestor;}else{splitRoot=topAncestor;container=splitRoot.parentNode;}// if splitRoot is exists, split with splitTree\nvar pivot=splitRoot&&splitTree(splitRoot,point,{isSkipPaddingBlankHTML:isInline,isNotSplitEdgePoint:isInline});// if container is point.node, find pivot with point.offset\nif(!pivot&&container===point.node){pivot=point.node.childNodes[point.offset];}return{rightNode:pivot,container:container};};var create=function(nodeName){return document.createElement(nodeName);};var createText=function(text){return document.createTextNode(text);};/**\n     * @method remove\n     *\n     * remove node, (isRemoveChild: remove child or not)\n     *\n     * @param {Node} node\n     * @param {Boolean} isRemoveChild\n     */var remove=function(node,isRemoveChild){if(!node||!node.parentNode){return;}if(node.removeNode){return node.removeNode(isRemoveChild);}var parent=node.parentNode;if(!isRemoveChild){var nodes=[];var i,len;for(i=0,len=node.childNodes.length;i<len;i++){nodes.push(node.childNodes[i]);}for(i=0,len=nodes.length;i<len;i++){parent.insertBefore(nodes[i],node);}}parent.removeChild(node);};/**\n     * @method removeWhile\n     *\n     * @param {Node} node\n     * @param {Function} pred\n     */var removeWhile=function(node,pred){while(node){if(isEditable(node)||!pred(node)){break;}var parent=node.parentNode;remove(node);node=parent;}};/**\n     * @method replace\n     *\n     * replace node with provided nodeName\n     *\n     * @param {Node} node\n     * @param {String} nodeName\n     * @return {Node} - new node\n     */var replace=function(node,nodeName){if(node.nodeName.toUpperCase()===nodeName.toUpperCase()){return node;}var newNode=create(nodeName);if(node.style.cssText){newNode.style.cssText=node.style.cssText;}appendChildNodes(newNode,list.from(node.childNodes));insertAfter(newNode,node);remove(node);return newNode;};var isTextarea=makePredByNodeName('TEXTAREA');/**\n     * @param {jQuery} $node\n     * @param {Boolean} [stripLinebreaks] - default: false\n     */var value=function($node,stripLinebreaks){var val=isTextarea($node[0])?$node.val():$node.html();if(stripLinebreaks){return val.replace(/[\\n\\r]/g,'');}return val;};/**\n     * @method html\n     *\n     * get the HTML contents of node\n     *\n     * @param {jQuery} $node\n     * @param {Boolean} [isNewlineOnBlock]\n     */var html=function($node,isNewlineOnBlock){var markup=value($node);if(isNewlineOnBlock){var regexTag=/<(\\/?)(\\b(?!!)[^>\\s]*)(.*?)(\\s*\\/?>)/g;markup=markup.replace(regexTag,function(match,endSlash,name){name=name.toUpperCase();var isEndOfInlineContainer=/^DIV|^TD|^TH|^P|^LI|^H[1-7]/.test(name)&&!!endSlash;var isBlockNode=/^BLOCKQUOTE|^TABLE|^TBODY|^TR|^HR|^UL|^OL/.test(name);return match+(isEndOfInlineContainer||isBlockNode?'\\n':'');});markup=$.trim(markup);}return markup;};var posFromPlaceholder=function(placeholder){var $placeholder=$(placeholder);var pos=$placeholder.offset();var height=$placeholder.outerHeight(true);// include margin\nreturn{left:pos.left,top:pos.top+height};};var attachEvents=function($node,events){Object.keys(events).forEach(function(key){$node.on(key,events[key]);});};var detachEvents=function($node,events){Object.keys(events).forEach(function(key){$node.off(key,events[key]);});};return{/** @property {String} NBSP_CHAR */NBSP_CHAR:NBSP_CHAR,/** @property {String} ZERO_WIDTH_NBSP_CHAR */ZERO_WIDTH_NBSP_CHAR:ZERO_WIDTH_NBSP_CHAR,/** @property {String} blank */blank:blankHTML,/** @property {String} emptyPara */emptyPara:'<p>'+blankHTML+'</p>',makePredByNodeName:makePredByNodeName,isEditable:isEditable,isControlSizing:isControlSizing,isText:isText,isElement:isElement,isVoid:isVoid,isPara:isPara,isPurePara:isPurePara,isHeading:isHeading,isInline:isInline,isBlock:func.not(isInline),isBodyInline:isBodyInline,isBody:isBody,isParaInline:isParaInline,isPre:isPre,isList:isList,isTable:isTable,isData:isData,isCell:isCell,isBlockquote:isBlockquote,isBodyContainer:isBodyContainer,isAnchor:isAnchor,isDiv:makePredByNodeName('DIV'),isLi:isLi,isBR:makePredByNodeName('BR'),isSpan:makePredByNodeName('SPAN'),isB:makePredByNodeName('B'),isU:makePredByNodeName('U'),isS:makePredByNodeName('S'),isI:makePredByNodeName('I'),isImg:makePredByNodeName('IMG'),isTextarea:isTextarea,isEmpty:isEmpty,isEmptyAnchor:func.and(isAnchor,isEmpty),isClosestSibling:isClosestSibling,withClosestSiblings:withClosestSiblings,nodeLength:nodeLength,isLeftEdgePoint:isLeftEdgePoint,isRightEdgePoint:isRightEdgePoint,isEdgePoint:isEdgePoint,isLeftEdgeOf:isLeftEdgeOf,isRightEdgeOf:isRightEdgeOf,isLeftEdgePointOf:isLeftEdgePointOf,isRightEdgePointOf:isRightEdgePointOf,prevPoint:prevPoint,nextPoint:nextPoint,isSamePoint:isSamePoint,isVisiblePoint:isVisiblePoint,prevPointUntil:prevPointUntil,nextPointUntil:nextPointUntil,isCharPoint:isCharPoint,walkPoint:walkPoint,ancestor:ancestor,singleChildAncestor:singleChildAncestor,listAncestor:listAncestor,lastAncestor:lastAncestor,listNext:listNext,listPrev:listPrev,listDescendant:listDescendant,commonAncestor:commonAncestor,wrap:wrap,insertAfter:insertAfter,appendChildNodes:appendChildNodes,position:position,hasChildren:hasChildren,makeOffsetPath:makeOffsetPath,fromOffsetPath:fromOffsetPath,splitTree:splitTree,splitPoint:splitPoint,create:create,createText:createText,remove:remove,removeWhile:removeWhile,replace:replace,html:html,value:value,posFromPlaceholder:posFromPlaceholder,attachEvents:attachEvents,detachEvents:detachEvents};}();/**\n   * @param {jQuery} $note\n   * @param {Object} options\n   * @return {Context}\n   */var Context=function($note,options){var self=this;var ui=$.summernote.ui;this.memos={};this.modules={};this.layoutInfo={};this.options=options;/**\n     * create layout and initialize modules and other resources\n     */this.initialize=function(){this.layoutInfo=ui.createLayout($note,options);this._initialize();$note.hide();return this;};/**\n     * destroy modules and other resources and remove layout\n     */this.destroy=function(){this._destroy();$note.removeData('summernote');ui.removeLayout($note,this.layoutInfo);};/**\n     * destory modules and other resources and initialize it again\n     */this.reset=function(){var disabled=self.isDisabled();this.code(dom.emptyPara);this._destroy();this._initialize();if(disabled){self.disable();}};this._initialize=function(){// add optional buttons\nvar buttons=$.extend({},this.options.buttons);Object.keys(buttons).forEach(function(key){self.memo('button.'+key,buttons[key]);});var modules=$.extend({},this.options.modules,$.summernote.plugins||{});// add and initialize modules\nObject.keys(modules).forEach(function(key){self.module(key,modules[key],true);});Object.keys(this.modules).forEach(function(key){self.initializeModule(key);});};this._destroy=function(){// destroy modules with reversed order\nObject.keys(this.modules).reverse().forEach(function(key){self.removeModule(key);});Object.keys(this.memos).forEach(function(key){self.removeMemo(key);});};this.code=function(html){var isActivated=this.invoke('codeview.isActivated');if(html===undefined){this.invoke('codeview.sync');return isActivated?this.layoutInfo.codable.val():this.layoutInfo.editable.html();}else{if(isActivated){this.layoutInfo.codable.val(html);}else{this.layoutInfo.editable.html(html);}$note.val(html);this.triggerEvent('change',html);}};this.isDisabled=function(){return this.layoutInfo.editable.attr('contenteditable')==='false';};this.enable=function(){this.layoutInfo.editable.attr('contenteditable',true);this.invoke('toolbar.activate',true);};this.disable=function(){// close codeview if codeview is opend\nif(this.invoke('codeview.isActivated')){this.invoke('codeview.deactivate');}this.layoutInfo.editable.attr('contenteditable',false);this.invoke('toolbar.deactivate',true);};this.triggerEvent=function(){var namespace=list.head(arguments);var args=list.tail(list.from(arguments));var callback=this.options.callbacks[func.namespaceToCamel(namespace,'on')];if(callback){callback.apply($note[0],args);}$note.trigger('summernote.'+namespace,args);};this.initializeModule=function(key){var module=this.modules[key];module.shouldInitialize=module.shouldInitialize||func.ok;if(!module.shouldInitialize()){return;}// initialize module\nif(module.initialize){module.initialize();}// attach events\nif(module.events){dom.attachEvents($note,module.events);}};this.module=function(key,ModuleClass,withoutIntialize){if(arguments.length===1){return this.modules[key];}this.modules[key]=new ModuleClass(this);if(!withoutIntialize){this.initializeModule(key);}};this.removeModule=function(key){var module=this.modules[key];if(module.shouldInitialize()){if(module.events){dom.detachEvents($note,module.events);}if(module.destroy){module.destroy();}}delete this.modules[key];};this.memo=function(key,obj){if(arguments.length===1){return this.memos[key];}this.memos[key]=obj;};this.removeMemo=function(key){if(this.memos[key]&&this.memos[key].destroy){this.memos[key].destroy();}delete this.memos[key];};this.createInvokeHandler=function(namespace,value){return function(event){event.preventDefault();self.invoke(namespace,value||$(event.target).closest('[data-value]').data('value'));};};this.invoke=function(){var namespace=list.head(arguments);var args=list.tail(list.from(arguments));var splits=namespace.split('.');var hasSeparator=splits.length>1;var moduleName=hasSeparator&&list.head(splits);var methodName=hasSeparator?list.last(splits):list.head(splits);var module=this.modules[moduleName||'editor'];if(!moduleName&&this[methodName]){return this[methodName].apply(this,args);}else if(module&&module[methodName]&&module.shouldInitialize()){return module[methodName].apply(module,args);}};return this.initialize();};$.fn.extend({/**\n     * Summernote API\n     *\n     * @param {Object|String}\n     * @return {this}\n     */summernote:function(){var type=$.type(list.head(arguments));var isExternalAPICalled=type==='string';var hasInitOptions=type==='object';var options=hasInitOptions?list.head(arguments):{};options=$.extend({},$.summernote.options,options);options.langInfo=$.extend(true,{},$.summernote.lang['en-US'],$.summernote.lang[options.lang]);options.icons=$.extend(true,{},$.summernote.options.icons,options.icons);this.each(function(idx,note){var $note=$(note);if(!$note.data('summernote')){var context=new Context($note,options);$note.data('summernote',context);$note.data('summernote').triggerEvent('init',context.layoutInfo);}});var $note=this.first();if($note.length){var context=$note.data('summernote');if(isExternalAPICalled){return context.invoke.apply(context,list.from(arguments));}else if(options.focus){context.invoke('editor.focus');}}return this;}});var Renderer=function(markup,children,options,callback){this.render=function($parent){var $node=$(markup);if(options&&options.contents){$node.html(options.contents);}if(options&&options.className){$node.addClass(options.className);}if(options&&options.data){$.each(options.data,function(k,v){$node.attr('data-'+k,v);});}if(options&&options.click){$node.on('click',options.click);}if(children){var $container=$node.find('.note-children-container');children.forEach(function(child){child.render($container.length?$container:$node);});}if(callback){callback($node,options);}if(options&&options.callback){options.callback($node);}if($parent){$parent.append($node);}return $node;};};var renderer={create:function(markup,callback){return function(){var children=$.isArray(arguments[0])?arguments[0]:[];var options=typeof arguments[1]==='object'?arguments[1]:arguments[0];if(options&&options.children){children=options.children;}return new Renderer(markup,children,options,callback);};}};var editor=renderer.create('<div class=\"note-editor note-frame panel panel-default\"/>');var toolbar=renderer.create('<div class=\"note-toolbar panel-heading\"/>');var editingArea=renderer.create('<div class=\"note-editing-area\"/>');var codable=renderer.create('<textarea class=\"note-codable\"/>');var editable=renderer.create('<div class=\"note-editable panel-body\" contentEditable=\"true\"/>');var statusbar=renderer.create(['<div class=\"note-statusbar\">','  <div class=\"note-resizebar\">','    <div class=\"note-icon-bar\"/>','    <div class=\"note-icon-bar\"/>','    <div class=\"note-icon-bar\"/>','  </div>','</div>'].join(''));var airEditor=renderer.create('<div class=\"note-editor\"/>');var airEditable=renderer.create('<div class=\"note-editable\" contentEditable=\"true\"/>');var buttonGroup=renderer.create('<div class=\"note-btn-group btn-group\">');var button=renderer.create('<button type=\"button\" class=\"note-btn btn btn-default btn-sm\" tabindex=\"-1\">',function($node,options){if(options&&options.tooltip){$node.attr({title:options.tooltip}).tooltip({container:'body',trigger:'hover',placement:'bottom'});}});var dropdown=renderer.create('<div class=\"dropdown-menu\">',function($node,options){var markup=$.isArray(options.items)?options.items.map(function(item){var value=typeof item==='string'?item:item.value||'';var content=options.template?options.template(item):item;return'<li><a href=\"#\" data-value=\"'+value+'\">'+content+'</a></li>';}).join(''):options.items;$node.html(markup);});var dropdownCheck=renderer.create('<div class=\"dropdown-menu note-check\">',function($node,options){var markup=$.isArray(options.items)?options.items.map(function(item){var value=typeof item==='string'?item:item.value||'';var content=options.template?options.template(item):item;return'<li><a href=\"#\" data-value=\"'+value+'\">'+icon(options.checkClassName)+' '+content+'</a></li>';}).join(''):options.items;$node.html(markup);});var palette=renderer.create('<div class=\"note-color-palette\"/>',function($node,options){var contents=[];for(var row=0,rowSize=options.colors.length;row<rowSize;row++){var eventName=options.eventName;var colors=options.colors[row];var buttons=[];for(var col=0,colSize=colors.length;col<colSize;col++){var color=colors[col];buttons.push(['<button type=\"button\" class=\"note-color-btn\"','style=\"background-color:',color,'\" ','data-event=\"',eventName,'\" ','data-value=\"',color,'\" ','title=\"',color,'\" ','data-toggle=\"button\" tabindex=\"-1\"></button>'].join(''));}contents.push('<div class=\"note-color-row\">'+buttons.join('')+'</div>');}$node.html(contents.join(''));$node.find('.note-color-btn').tooltip({container:'body',trigger:'hover',placement:'bottom'});});var dialog=renderer.create('<div class=\"modal\" aria-hidden=\"false\" tabindex=\"-1\"/>',function($node,options){if(options.fade){$node.addClass('fade');}$node.html(['<div class=\"modal-dialog\">','  <div class=\"modal-content\">',options.title?'    <div class=\"modal-header\">'+'      <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>'+'      <h4 class=\"modal-title\">'+options.title+'</h4>'+'    </div>':'','    <div class=\"modal-body\">'+options.body+'</div>',options.footer?'    <div class=\"modal-footer\">'+options.footer+'</div>':'','  </div>','</div>'].join(''));});var popover=renderer.create(['<div class=\"note-popover popover in\">','  <div class=\"arrow\"/>','  <div class=\"popover-content note-children-container\"/>','</div>'].join(''),function($node,options){var direction=typeof options.direction!=='undefined'?options.direction:'bottom';$node.addClass(direction);if(options.hideArrow){$node.find('.arrow').hide();}});var icon=function(iconClassName,tagName){tagName=tagName||'i';return'<'+tagName+' class=\"'+iconClassName+'\"/>';};var ui={editor:editor,toolbar:toolbar,editingArea:editingArea,codable:codable,editable:editable,statusbar:statusbar,airEditor:airEditor,airEditable:airEditable,buttonGroup:buttonGroup,button:button,dropdown:dropdown,dropdownCheck:dropdownCheck,palette:palette,dialog:dialog,popover:popover,icon:icon,toggleBtn:function($btn,isEnable){$btn.toggleClass('disabled',!isEnable);$btn.attr('disabled',!isEnable);},toggleBtnActive:function($btn,isActive){$btn.toggleClass('active',isActive);},onDialogShown:function($dialog,handler){$dialog.one('shown.bs.modal',handler);},onDialogHidden:function($dialog,handler){$dialog.one('hidden.bs.modal',handler);},showDialog:function($dialog){$dialog.modal('show');},hideDialog:function($dialog){$dialog.modal('hide');},createLayout:function($note,options){var $editor=(options.airMode?ui.airEditor([ui.editingArea([ui.airEditable()])]):ui.editor([ui.toolbar(),ui.editingArea([ui.codable(),ui.editable()]),ui.statusbar()])).render();$editor.insertAfter($note);return{note:$note,editor:$editor,toolbar:$editor.find('.note-toolbar'),editingArea:$editor.find('.note-editing-area'),editable:$editor.find('.note-editable'),codable:$editor.find('.note-codable'),statusbar:$editor.find('.note-statusbar')};},removeLayout:function($note,layoutInfo){$note.html(layoutInfo.editable.html());layoutInfo.editor.remove();$note.show();}};$.summernote=$.summernote||{lang:{}};$.extend($.summernote.lang,{'en-US':{font:{bold:'Bold',italic:'Italic',underline:'Underline',clear:'Remove Font Style',height:'Line Height',name:'Font Family',strikethrough:'Strikethrough',subscript:'Subscript',superscript:'Superscript',size:'Font Size'},image:{image:'Picture',insert:'Insert Image',resizeFull:'Resize Full',resizeHalf:'Resize Half',resizeQuarter:'Resize Quarter',floatLeft:'Float Left',floatRight:'Float Right',floatNone:'Float None',shapeRounded:'Shape: Rounded',shapeCircle:'Shape: Circle',shapeThumbnail:'Shape: Thumbnail',shapeNone:'Shape: None',dragImageHere:'Drag image or text here',dropImage:'Drop image or Text',selectFromFiles:'Select from files',maximumFileSize:'Maximum file size',maximumFileSizeError:'Maximum file size exceeded.',url:'Image URL',remove:'Remove Image'},video:{video:'Video',videoLink:'Video Link',insert:'Insert Video',url:'Video URL?',providers:'(YouTube, Vimeo, Vine, Instagram, DailyMotion or Youku)'},link:{link:'Link',insert:'Insert Link',unlink:'Unlink',edit:'Edit',textToDisplay:'Text to display',url:'To what URL should this link go?',openInNewWindow:'Open in new window'},table:{table:'Table'},hr:{insert:'Insert Horizontal Rule'},style:{style:'Style',normal:'Normal',blockquote:'Quote',pre:'Code',h1:'Header 1',h2:'Header 2',h3:'Header 3',h4:'Header 4',h5:'Header 5',h6:'Header 6'},lists:{unordered:'Unordered list',ordered:'Ordered list'},options:{help:'Help',fullscreen:'Full Screen',codeview:'Code View'},paragraph:{paragraph:'Paragraph',outdent:'Outdent',indent:'Indent',left:'Align left',center:'Align center',right:'Align right',justify:'Justify full'},color:{recent:'Recent Color',more:'More Color',background:'Background Color',foreground:'Foreground Color',transparent:'Transparent',setTransparent:'Set transparent',reset:'Reset',resetToDefault:'Reset to default'},shortcut:{shortcuts:'Keyboard shortcuts',close:'Close',textFormatting:'Text formatting',action:'Action',paragraphFormatting:'Paragraph formatting',documentStyle:'Document Style',extraKeys:'Extra keys'},help:{'insertParagraph':'Insert Paragraph','undo':'Undoes the last command','redo':'Redoes the last command','tab':'Tab','untab':'Untab','bold':'Set a bold style','italic':'Set a italic style','underline':'Set a underline style','strikethrough':'Set a strikethrough style','removeFormat':'Clean a style','justifyLeft':'Set left align','justifyCenter':'Set center align','justifyRight':'Set right align','justifyFull':'Set full align','insertUnorderedList':'Toggle unordered list','insertOrderedList':'Toggle ordered list','outdent':'Outdent on current paragraph','indent':'Indent on current paragraph','formatPara':'Change current block\\'s format as a paragraph(P tag)','formatH1':'Change current block\\'s format as H1','formatH2':'Change current block\\'s format as H2','formatH3':'Change current block\\'s format as H3','formatH4':'Change current block\\'s format as H4','formatH5':'Change current block\\'s format as H5','formatH6':'Change current block\\'s format as H6','insertHorizontalRule':'Insert horizontal rule','linkDialog.show':'Show Link Dialog'},history:{undo:'Undo',redo:'Redo'},specialChar:{specialChar:'SPECIAL CHARACTERS',select:'Select Special characters'}}});/**\n   * @class core.key\n   *\n   * Object for keycodes.\n   *\n   * @singleton\n   * @alternateClassName key\n   */var key=function(){var keyMap={'BACKSPACE':8,'TAB':9,'ENTER':13,'SPACE':32,// Arrow\n'LEFT':37,'UP':38,'RIGHT':39,'DOWN':40,// Number: 0-9\n'NUM0':48,'NUM1':49,'NUM2':50,'NUM3':51,'NUM4':52,'NUM5':53,'NUM6':54,'NUM7':55,'NUM8':56,// Alphabet: a-z\n'B':66,'E':69,'I':73,'J':74,'K':75,'L':76,'R':82,'S':83,'U':85,'V':86,'Y':89,'Z':90,'SLASH':191,'LEFTBRACKET':219,'BACKSLASH':220,'RIGHTBRACKET':221};return{/**\n       * @method isEdit\n       *\n       * @param {Number} keyCode\n       * @return {Boolean}\n       */isEdit:function(keyCode){return list.contains([keyMap.BACKSPACE,keyMap.TAB,keyMap.ENTER,keyMap.SPACE],keyCode);},/**\n       * @method isMove\n       *\n       * @param {Number} keyCode\n       * @return {Boolean}\n       */isMove:function(keyCode){return list.contains([keyMap.LEFT,keyMap.UP,keyMap.RIGHT,keyMap.DOWN],keyCode);},/**\n       * @property {Object} nameFromCode\n       * @property {String} nameFromCode.8 \"BACKSPACE\"\n       */nameFromCode:func.invertObject(keyMap),code:keyMap};}();var range=function(){/**\n     * return boundaryPoint from TextRange, inspired by Andy Na's HuskyRange.js\n     *\n     * @param {TextRange} textRange\n     * @param {Boolean} isStart\n     * @return {BoundaryPoint}\n     *\n     * @see http://msdn.microsoft.com/en-us/library/ie/ms535872(v=vs.85).aspx\n     */var textRangeToPoint=function(textRange,isStart){var container=textRange.parentElement(),offset;var tester=document.body.createTextRange(),prevContainer;var childNodes=list.from(container.childNodes);for(offset=0;offset<childNodes.length;offset++){if(dom.isText(childNodes[offset])){continue;}tester.moveToElementText(childNodes[offset]);if(tester.compareEndPoints('StartToStart',textRange)>=0){break;}prevContainer=childNodes[offset];}if(offset!==0&&dom.isText(childNodes[offset-1])){var textRangeStart=document.body.createTextRange(),curTextNode=null;textRangeStart.moveToElementText(prevContainer||container);textRangeStart.collapse(!prevContainer);curTextNode=prevContainer?prevContainer.nextSibling:container.firstChild;var pointTester=textRange.duplicate();pointTester.setEndPoint('StartToStart',textRangeStart);var textCount=pointTester.text.replace(/[\\r\\n]/g,'').length;while(textCount>curTextNode.nodeValue.length&&curTextNode.nextSibling){textCount-=curTextNode.nodeValue.length;curTextNode=curTextNode.nextSibling;}/* jshint ignore:start */var dummy=curTextNode.nodeValue;// enforce IE to re-reference curTextNode, hack\n/* jshint ignore:end */if(isStart&&curTextNode.nextSibling&&dom.isText(curTextNode.nextSibling)&&textCount===curTextNode.nodeValue.length){textCount-=curTextNode.nodeValue.length;curTextNode=curTextNode.nextSibling;}container=curTextNode;offset=textCount;}return{cont:container,offset:offset};};/**\n     * return TextRange from boundary point (inspired by google closure-library)\n     * @param {BoundaryPoint} point\n     * @return {TextRange}\n     */var pointToTextRange=function(point){var textRangeInfo=function(container,offset){var node,isCollapseToStart;if(dom.isText(container)){var prevTextNodes=dom.listPrev(container,func.not(dom.isText));var prevContainer=list.last(prevTextNodes).previousSibling;node=prevContainer||container.parentNode;offset+=list.sum(list.tail(prevTextNodes),dom.nodeLength);isCollapseToStart=!prevContainer;}else{node=container.childNodes[offset]||container;if(dom.isText(node)){return textRangeInfo(node,0);}offset=0;isCollapseToStart=false;}return{node:node,collapseToStart:isCollapseToStart,offset:offset};};var textRange=document.body.createTextRange();var info=textRangeInfo(point.node,point.offset);textRange.moveToElementText(info.node);textRange.collapse(info.collapseToStart);textRange.moveStart('character',info.offset);return textRange;};/**\n     * Wrapped Range\n     *\n     * @constructor\n     * @param {Node} sc - start container\n     * @param {Number} so - start offset\n     * @param {Node} ec - end container\n     * @param {Number} eo - end offset\n     */var WrappedRange=function(sc,so,ec,eo){this.sc=sc;this.so=so;this.ec=ec;this.eo=eo;// nativeRange: get nativeRange from sc, so, ec, eo\nvar nativeRange=function(){if(agent.isW3CRangeSupport){var w3cRange=document.createRange();w3cRange.setStart(sc,so);w3cRange.setEnd(ec,eo);return w3cRange;}else{var textRange=pointToTextRange({node:sc,offset:so});textRange.setEndPoint('EndToEnd',pointToTextRange({node:ec,offset:eo}));return textRange;}};this.getPoints=function(){return{sc:sc,so:so,ec:ec,eo:eo};};this.getStartPoint=function(){return{node:sc,offset:so};};this.getEndPoint=function(){return{node:ec,offset:eo};};/**\n       * select update visible range\n       */this.select=function(){var nativeRng=nativeRange();if(agent.isW3CRangeSupport){var selection=document.getSelection();if(selection.rangeCount>0){selection.removeAllRanges();}selection.addRange(nativeRng);}else{nativeRng.select();}return this;};/**\n       * Moves the scrollbar to start container(sc) of current range\n       *\n       * @return {WrappedRange}\n       */this.scrollIntoView=function(container){var height=$(container).height();if(container.scrollTop+height<this.sc.offsetTop){container.scrollTop+=Math.abs(container.scrollTop+height-this.sc.offsetTop);}return this;};/**\n       * @return {WrappedRange}\n       */this.normalize=function(){/**\n         * @param {BoundaryPoint} point\n         * @param {Boolean} isLeftToRight\n         * @return {BoundaryPoint}\n         */var getVisiblePoint=function(point,isLeftToRight){if(dom.isVisiblePoint(point)&&!dom.isEdgePoint(point)||dom.isVisiblePoint(point)&&dom.isRightEdgePoint(point)&&!isLeftToRight||dom.isVisiblePoint(point)&&dom.isLeftEdgePoint(point)&&isLeftToRight||dom.isVisiblePoint(point)&&dom.isBlock(point.node)&&dom.isEmpty(point.node)){return point;}// point on block's edge\nvar block=dom.ancestor(point.node,dom.isBlock);if((dom.isLeftEdgePointOf(point,block)||dom.isVoid(dom.prevPoint(point).node))&&!isLeftToRight||(dom.isRightEdgePointOf(point,block)||dom.isVoid(dom.nextPoint(point).node))&&isLeftToRight){// returns point already on visible point\nif(dom.isVisiblePoint(point)){return point;}// reverse direction \nisLeftToRight=!isLeftToRight;}var nextPoint=isLeftToRight?dom.nextPointUntil(dom.nextPoint(point),dom.isVisiblePoint):dom.prevPointUntil(dom.prevPoint(point),dom.isVisiblePoint);return nextPoint||point;};var endPoint=getVisiblePoint(this.getEndPoint(),false);var startPoint=this.isCollapsed()?endPoint:getVisiblePoint(this.getStartPoint(),true);return new WrappedRange(startPoint.node,startPoint.offset,endPoint.node,endPoint.offset);};/**\n       * returns matched nodes on range\n       *\n       * @param {Function} [pred] - predicate function\n       * @param {Object} [options]\n       * @param {Boolean} [options.includeAncestor]\n       * @param {Boolean} [options.fullyContains]\n       * @return {Node[]}\n       */this.nodes=function(pred,options){pred=pred||func.ok;var includeAncestor=options&&options.includeAncestor;var fullyContains=options&&options.fullyContains;// TODO compare points and sort\nvar startPoint=this.getStartPoint();var endPoint=this.getEndPoint();var nodes=[];var leftEdgeNodes=[];dom.walkPoint(startPoint,endPoint,function(point){if(dom.isEditable(point.node)){return;}var node;if(fullyContains){if(dom.isLeftEdgePoint(point)){leftEdgeNodes.push(point.node);}if(dom.isRightEdgePoint(point)&&list.contains(leftEdgeNodes,point.node)){node=point.node;}}else if(includeAncestor){node=dom.ancestor(point.node,pred);}else{node=point.node;}if(node&&pred(node)){nodes.push(node);}},true);return list.unique(nodes);};/**\n       * returns commonAncestor of range\n       * @return {Element} - commonAncestor\n       */this.commonAncestor=function(){return dom.commonAncestor(sc,ec);};/**\n       * returns expanded range by pred\n       *\n       * @param {Function} pred - predicate function\n       * @return {WrappedRange}\n       */this.expand=function(pred){var startAncestor=dom.ancestor(sc,pred);var endAncestor=dom.ancestor(ec,pred);if(!startAncestor&&!endAncestor){return new WrappedRange(sc,so,ec,eo);}var boundaryPoints=this.getPoints();if(startAncestor){boundaryPoints.sc=startAncestor;boundaryPoints.so=0;}if(endAncestor){boundaryPoints.ec=endAncestor;boundaryPoints.eo=dom.nodeLength(endAncestor);}return new WrappedRange(boundaryPoints.sc,boundaryPoints.so,boundaryPoints.ec,boundaryPoints.eo);};/**\n       * @param {Boolean} isCollapseToStart\n       * @return {WrappedRange}\n       */this.collapse=function(isCollapseToStart){if(isCollapseToStart){return new WrappedRange(sc,so,sc,so);}else{return new WrappedRange(ec,eo,ec,eo);}};/**\n       * splitText on range\n       */this.splitText=function(){var isSameContainer=sc===ec;var boundaryPoints=this.getPoints();if(dom.isText(ec)&&!dom.isEdgePoint(this.getEndPoint())){ec.splitText(eo);}if(dom.isText(sc)&&!dom.isEdgePoint(this.getStartPoint())){boundaryPoints.sc=sc.splitText(so);boundaryPoints.so=0;if(isSameContainer){boundaryPoints.ec=boundaryPoints.sc;boundaryPoints.eo=eo-so;}}return new WrappedRange(boundaryPoints.sc,boundaryPoints.so,boundaryPoints.ec,boundaryPoints.eo);};/**\n       * delete contents on range\n       * @return {WrappedRange}\n       */this.deleteContents=function(){if(this.isCollapsed()){return this;}var rng=this.splitText();var nodes=rng.nodes(null,{fullyContains:true});// find new cursor point\nvar point=dom.prevPointUntil(rng.getStartPoint(),function(point){return!list.contains(nodes,point.node);});var emptyParents=[];$.each(nodes,function(idx,node){// find empty parents\nvar parent=node.parentNode;if(point.node!==parent&&dom.nodeLength(parent)===1){emptyParents.push(parent);}dom.remove(node,false);});// remove empty parents\n$.each(emptyParents,function(idx,node){dom.remove(node,false);});return new WrappedRange(point.node,point.offset,point.node,point.offset).normalize();};/**\n       * makeIsOn: return isOn(pred) function\n       */var makeIsOn=function(pred){return function(){var ancestor=dom.ancestor(sc,pred);return!!ancestor&&ancestor===dom.ancestor(ec,pred);};};// isOnEditable: judge whether range is on editable or not\nthis.isOnEditable=makeIsOn(dom.isEditable);// isOnList: judge whether range is on list node or not\nthis.isOnList=makeIsOn(dom.isList);// isOnAnchor: judge whether range is on anchor node or not\nthis.isOnAnchor=makeIsOn(dom.isAnchor);// isOnCell: judge whether range is on cell node or not\nthis.isOnCell=makeIsOn(dom.isCell);// isOnData: judge whether range is on data node or not\nthis.isOnData=makeIsOn(dom.isData);/**\n       * @param {Function} pred\n       * @return {Boolean}\n       */this.isLeftEdgeOf=function(pred){if(!dom.isLeftEdgePoint(this.getStartPoint())){return false;}var node=dom.ancestor(this.sc,pred);return node&&dom.isLeftEdgeOf(this.sc,node);};/**\n       * returns whether range was collapsed or not\n       */this.isCollapsed=function(){return sc===ec&&so===eo;};/**\n       * wrap inline nodes which children of body with paragraph\n       *\n       * @return {WrappedRange}\n       */this.wrapBodyInlineWithPara=function(){if(dom.isBodyContainer(sc)&&dom.isEmpty(sc)){sc.innerHTML=dom.emptyPara;return new WrappedRange(sc.firstChild,0,sc.firstChild,0);}/**\n         * [workaround] firefox often create range on not visible point. so normalize here.\n         *  - firefox: |<p>text</p>|\n         *  - chrome: <p>|text|</p>\n         */var rng=this.normalize();if(dom.isParaInline(sc)||dom.isPara(sc)){return rng;}// find inline top ancestor\nvar topAncestor;if(dom.isInline(rng.sc)){var ancestors=dom.listAncestor(rng.sc,func.not(dom.isInline));topAncestor=list.last(ancestors);if(!dom.isInline(topAncestor)){topAncestor=ancestors[ancestors.length-2]||rng.sc.childNodes[rng.so];}}else{topAncestor=rng.sc.childNodes[rng.so>0?rng.so-1:0];}// siblings not in paragraph\nvar inlineSiblings=dom.listPrev(topAncestor,dom.isParaInline).reverse();inlineSiblings=inlineSiblings.concat(dom.listNext(topAncestor.nextSibling,dom.isParaInline));// wrap with paragraph\nif(inlineSiblings.length){var para=dom.wrap(list.head(inlineSiblings),'p');dom.appendChildNodes(para,list.tail(inlineSiblings));}return this.normalize();};/**\n       * insert node at current cursor\n       *\n       * @param {Node} node\n       * @return {Node}\n       */this.insertNode=function(node){var rng=this.wrapBodyInlineWithPara().deleteContents();var info=dom.splitPoint(rng.getStartPoint(),dom.isInline(node));if(info.rightNode){info.rightNode.parentNode.insertBefore(node,info.rightNode);}else{info.container.appendChild(node);}return node;};/**\n       * insert html at current cursor\n       */this.pasteHTML=function(markup){var contentsContainer=$('<div></div>').html(markup)[0];var childNodes=list.from(contentsContainer.childNodes);var rng=this.wrapBodyInlineWithPara().deleteContents();return childNodes.reverse().map(function(childNode){return rng.insertNode(childNode);}).reverse();};/**\n       * returns text in range\n       *\n       * @return {String}\n       */this.toString=function(){var nativeRng=nativeRange();return agent.isW3CRangeSupport?nativeRng.toString():nativeRng.text;};/**\n       * returns range for word before cursor\n       *\n       * @param {Boolean} [findAfter] - find after cursor, default: false\n       * @return {WrappedRange}\n       */this.getWordRange=function(findAfter){var endPoint=this.getEndPoint();if(!dom.isCharPoint(endPoint)){return this;}var startPoint=dom.prevPointUntil(endPoint,function(point){return!dom.isCharPoint(point);});if(findAfter){endPoint=dom.nextPointUntil(endPoint,function(point){return!dom.isCharPoint(point);});}return new WrappedRange(startPoint.node,startPoint.offset,endPoint.node,endPoint.offset);};/**\n       * create offsetPath bookmark\n       *\n       * @param {Node} editable\n       */this.bookmark=function(editable){return{s:{path:dom.makeOffsetPath(editable,sc),offset:so},e:{path:dom.makeOffsetPath(editable,ec),offset:eo}};};/**\n       * create offsetPath bookmark base on paragraph\n       *\n       * @param {Node[]} paras\n       */this.paraBookmark=function(paras){return{s:{path:list.tail(dom.makeOffsetPath(list.head(paras),sc)),offset:so},e:{path:list.tail(dom.makeOffsetPath(list.last(paras),ec)),offset:eo}};};/**\n       * getClientRects\n       * @return {Rect[]}\n       */this.getClientRects=function(){var nativeRng=nativeRange();return nativeRng.getClientRects();};};/**\n   * @class core.range\n   *\n   * Data structure\n   *  * BoundaryPoint: a point of dom tree\n   *  * BoundaryPoints: two boundaryPoints corresponding to the start and the end of the Range\n   *\n   * See to http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Position\n   *\n   * @singleton\n   * @alternateClassName range\n   */return{/**\n       * create Range Object From arguments or Browser Selection\n       *\n       * @param {Node} sc - start container\n       * @param {Number} so - start offset\n       * @param {Node} ec - end container\n       * @param {Number} eo - end offset\n       * @return {WrappedRange}\n       */create:function(sc,so,ec,eo){if(arguments.length===4){return new WrappedRange(sc,so,ec,eo);}else if(arguments.length===2){//collapsed\nec=sc;eo=so;return new WrappedRange(sc,so,ec,eo);}else{var wrappedRange=this.createFromSelection();if(!wrappedRange&&arguments.length===1){wrappedRange=this.createFromNode(arguments[0]);return wrappedRange.collapse(dom.emptyPara===arguments[0].innerHTML);}return wrappedRange;}},createFromSelection:function(){var sc,so,ec,eo;if(agent.isW3CRangeSupport){var selection=document.getSelection();if(!selection||selection.rangeCount===0){return null;}else if(dom.isBody(selection.anchorNode)){// Firefox: returns entire body as range on initialization.\n// We won't never need it.\nreturn null;}var nativeRng=selection.getRangeAt(0);sc=nativeRng.startContainer;so=nativeRng.startOffset;ec=nativeRng.endContainer;eo=nativeRng.endOffset;}else{// IE8: TextRange\nvar textRange=document.selection.createRange();var textRangeEnd=textRange.duplicate();textRangeEnd.collapse(false);var textRangeStart=textRange;textRangeStart.collapse(true);var startPoint=textRangeToPoint(textRangeStart,true),endPoint=textRangeToPoint(textRangeEnd,false);// same visible point case: range was collapsed.\nif(dom.isText(startPoint.node)&&dom.isLeftEdgePoint(startPoint)&&dom.isTextNode(endPoint.node)&&dom.isRightEdgePoint(endPoint)&&endPoint.node.nextSibling===startPoint.node){startPoint=endPoint;}sc=startPoint.cont;so=startPoint.offset;ec=endPoint.cont;eo=endPoint.offset;}return new WrappedRange(sc,so,ec,eo);},/**\n       * @method \n       * \n       * create WrappedRange from node\n       *\n       * @param {Node} node\n       * @return {WrappedRange}\n       */createFromNode:function(node){var sc=node;var so=0;var ec=node;var eo=dom.nodeLength(ec);// browsers can't target a picture or void node\nif(dom.isVoid(sc)){so=dom.listPrev(sc).length-1;sc=sc.parentNode;}if(dom.isBR(ec)){eo=dom.listPrev(ec).length-1;ec=ec.parentNode;}else if(dom.isVoid(ec)){eo=dom.listPrev(ec).length;ec=ec.parentNode;}return this.create(sc,so,ec,eo);},/**\n       * create WrappedRange from node after position\n       *\n       * @param {Node} node\n       * @return {WrappedRange}\n       */createFromNodeBefore:function(node){return this.createFromNode(node).collapse(true);},/**\n       * create WrappedRange from node after position\n       *\n       * @param {Node} node\n       * @return {WrappedRange}\n       */createFromNodeAfter:function(node){return this.createFromNode(node).collapse();},/**\n       * @method \n       * \n       * create WrappedRange from bookmark\n       *\n       * @param {Node} editable\n       * @param {Object} bookmark\n       * @return {WrappedRange}\n       */createFromBookmark:function(editable,bookmark){var sc=dom.fromOffsetPath(editable,bookmark.s.path);var so=bookmark.s.offset;var ec=dom.fromOffsetPath(editable,bookmark.e.path);var eo=bookmark.e.offset;return new WrappedRange(sc,so,ec,eo);},/**\n       * @method \n       *\n       * create WrappedRange from paraBookmark\n       *\n       * @param {Object} bookmark\n       * @param {Node[]} paras\n       * @return {WrappedRange}\n       */createFromParaBookmark:function(bookmark,paras){var so=bookmark.s.offset;var eo=bookmark.e.offset;var sc=dom.fromOffsetPath(list.head(paras),bookmark.s.path);var ec=dom.fromOffsetPath(list.last(paras),bookmark.e.path);return new WrappedRange(sc,so,ec,eo);}};}();/**\n   * @class core.async\n   *\n   * Async functions which returns `Promise`\n   *\n   * @singleton\n   * @alternateClassName async\n   */var async=function(){/**\n     * @method readFileAsDataURL\n     *\n     * read contents of file as representing URL\n     *\n     * @param {File} file\n     * @return {Promise} - then: dataUrl\n     */var readFileAsDataURL=function(file){return $.Deferred(function(deferred){$.extend(new FileReader(),{onload:function(e){var dataURL=e.target.result;deferred.resolve(dataURL);},onerror:function(){deferred.reject(this);}}).readAsDataURL(file);}).promise();};/**\n     * @method createImage\n     *\n     * create `<image>` from url string\n     *\n     * @param {String} url\n     * @return {Promise} - then: $image\n     */var createImage=function(url){return $.Deferred(function(deferred){var $img=$('<img>');$img.one('load',function(){$img.off('error abort');deferred.resolve($img);}).one('error abort',function(){$img.off('load').detach();deferred.reject($img);}).css({display:'none'}).appendTo(document.body).attr('src',url);}).promise();};return{readFileAsDataURL:readFileAsDataURL,createImage:createImage};}();/**\n   * @class editing.History\n   *\n   * Editor History\n   *\n   */var History=function($editable){var stack=[],stackOffset=-1;var editable=$editable[0];var makeSnapshot=function(){var rng=range.create(editable);var emptyBookmark={s:{path:[],offset:0},e:{path:[],offset:0}};return{contents:$editable.html(),bookmark:rng?rng.bookmark(editable):emptyBookmark};};var applySnapshot=function(snapshot){if(snapshot.contents!==null){$editable.html(snapshot.contents);}if(snapshot.bookmark!==null){range.createFromBookmark(editable,snapshot.bookmark).select();}};/**\n    * @method rewind\n    * Rewinds the history stack back to the first snapshot taken.\n    * Leaves the stack intact, so that \"Redo\" can still be used.\n    */this.rewind=function(){// Create snap shot if not yet recorded\nif($editable.html()!==stack[stackOffset].contents){this.recordUndo();}// Return to the first available snapshot.\nstackOffset=0;// Apply that snapshot.\napplySnapshot(stack[stackOffset]);};/**\n    * @method reset\n    * Resets the history stack completely; reverting to an empty editor.\n    */this.reset=function(){// Clear the stack.\nstack=[];// Restore stackOffset to its original value.\nstackOffset=-1;// Clear the editable area.\n$editable.html('');// Record our first snapshot (of nothing).\nthis.recordUndo();};/**\n     * undo\n     */this.undo=function(){// Create snap shot if not yet recorded\nif($editable.html()!==stack[stackOffset].contents){this.recordUndo();}if(0<stackOffset){stackOffset--;applySnapshot(stack[stackOffset]);}};/**\n     * redo\n     */this.redo=function(){if(stack.length-1>stackOffset){stackOffset++;applySnapshot(stack[stackOffset]);}};/**\n     * recorded undo\n     */this.recordUndo=function(){stackOffset++;// Wash out stack after stackOffset\nif(stack.length>stackOffset){stack=stack.slice(0,stackOffset);}// Create new snapshot and push it to the end\nstack.push(makeSnapshot());};};/**\n   * @class editing.Style\n   *\n   * Style\n   *\n   */var Style=function(){/**\n     * @method jQueryCSS\n     *\n     * [workaround] for old jQuery\n     * passing an array of style properties to .css()\n     * will result in an object of property-value pairs.\n     * (compability with version < 1.9)\n     *\n     * @private\n     * @param  {jQuery} $obj\n     * @param  {Array} propertyNames - An array of one or more CSS properties.\n     * @return {Object}\n     */var jQueryCSS=function($obj,propertyNames){if(agent.jqueryVersion<1.9){var result={};$.each(propertyNames,function(idx,propertyName){result[propertyName]=$obj.css(propertyName);});return result;}return $obj.css.call($obj,propertyNames);};/**\n     * returns style object from node\n     *\n     * @param {jQuery} $node\n     * @return {Object}\n     */this.fromNode=function($node){var properties=['font-family','font-size','text-align','list-style-type','line-height'];var styleInfo=jQueryCSS($node,properties)||{};styleInfo['font-size']=parseInt(styleInfo['font-size'],10);return styleInfo;};/**\n     * paragraph level style\n     *\n     * @param {WrappedRange} rng\n     * @param {Object} styleInfo\n     */this.stylePara=function(rng,styleInfo){$.each(rng.nodes(dom.isPara,{includeAncestor:true}),function(idx,para){$(para).css(styleInfo);});};/**\n     * insert and returns styleNodes on range.\n     *\n     * @param {WrappedRange} rng\n     * @param {Object} [options] - options for styleNodes\n     * @param {String} [options.nodeName] - default: `SPAN`\n     * @param {Boolean} [options.expandClosestSibling] - default: `false`\n     * @param {Boolean} [options.onlyPartialContains] - default: `false`\n     * @return {Node[]}\n     */this.styleNodes=function(rng,options){rng=rng.splitText();var nodeName=options&&options.nodeName||'SPAN';var expandClosestSibling=!!(options&&options.expandClosestSibling);var onlyPartialContains=!!(options&&options.onlyPartialContains);if(rng.isCollapsed()){return[rng.insertNode(dom.create(nodeName))];}var pred=dom.makePredByNodeName(nodeName);var nodes=rng.nodes(dom.isText,{fullyContains:true}).map(function(text){return dom.singleChildAncestor(text,pred)||dom.wrap(text,nodeName);});if(expandClosestSibling){if(onlyPartialContains){var nodesInRange=rng.nodes();// compose with partial contains predication\npred=func.and(pred,function(node){return list.contains(nodesInRange,node);});}return nodes.map(function(node){var siblings=dom.withClosestSiblings(node,pred);var head=list.head(siblings);var tails=list.tail(siblings);$.each(tails,function(idx,elem){dom.appendChildNodes(head,elem.childNodes);dom.remove(elem);});return list.head(siblings);});}else{return nodes;}};/**\n     * get current style on cursor\n     *\n     * @param {WrappedRange} rng\n     * @return {Object} - object contains style properties.\n     */this.current=function(rng){var $cont=$(!dom.isElement(rng.sc)?rng.sc.parentNode:rng.sc);var styleInfo=this.fromNode($cont);// document.queryCommandState for toggle state\n// [workaround] prevent Firefox nsresult: \"0x80004005 (NS_ERROR_FAILURE)\"\ntry{styleInfo=$.extend(styleInfo,{'font-bold':document.queryCommandState('bold')?'bold':'normal','font-italic':document.queryCommandState('italic')?'italic':'normal','font-underline':document.queryCommandState('underline')?'underline':'normal','font-subscript':document.queryCommandState('subscript')?'subscript':'normal','font-superscript':document.queryCommandState('superscript')?'superscript':'normal','font-strikethrough':document.queryCommandState('strikethrough')?'strikethrough':'normal'});}catch(e){}// list-style-type to list-style(unordered, ordered)\nif(!rng.isOnList()){styleInfo['list-style']='none';}else{var orderedTypes=['circle','disc','disc-leading-zero','square'];var isUnordered=$.inArray(styleInfo['list-style-type'],orderedTypes)>-1;styleInfo['list-style']=isUnordered?'unordered':'ordered';}var para=dom.ancestor(rng.sc,dom.isPara);if(para&&para.style['line-height']){styleInfo['line-height']=para.style.lineHeight;}else{var lineHeight=parseInt(styleInfo['line-height'],10)/parseInt(styleInfo['font-size'],10);styleInfo['line-height']=lineHeight.toFixed(1);}styleInfo.anchor=rng.isOnAnchor()&&dom.ancestor(rng.sc,dom.isAnchor);styleInfo.ancestors=dom.listAncestor(rng.sc,dom.isEditable);styleInfo.range=rng;return styleInfo;};};/**\n   * @class editing.Bullet\n   *\n   * @alternateClassName Bullet\n   */var Bullet=function(){var self=this;/**\n     * toggle ordered list\n     */this.insertOrderedList=function(editable){this.toggleList('OL',editable);};/**\n     * toggle unordered list\n     */this.insertUnorderedList=function(editable){this.toggleList('UL',editable);};/**\n     * indent\n     */this.indent=function(editable){var self=this;var rng=range.create(editable).wrapBodyInlineWithPara();var paras=rng.nodes(dom.isPara,{includeAncestor:true});var clustereds=list.clusterBy(paras,func.peq2('parentNode'));$.each(clustereds,function(idx,paras){var head=list.head(paras);if(dom.isLi(head)){self.wrapList(paras,head.parentNode.nodeName);}else{$.each(paras,function(idx,para){$(para).css('marginLeft',function(idx,val){return(parseInt(val,10)||0)+25;});});}});rng.select();};/**\n     * outdent\n     */this.outdent=function(editable){var self=this;var rng=range.create(editable).wrapBodyInlineWithPara();var paras=rng.nodes(dom.isPara,{includeAncestor:true});var clustereds=list.clusterBy(paras,func.peq2('parentNode'));$.each(clustereds,function(idx,paras){var head=list.head(paras);if(dom.isLi(head)){self.releaseList([paras]);}else{$.each(paras,function(idx,para){$(para).css('marginLeft',function(idx,val){val=parseInt(val,10)||0;return val>25?val-25:'';});});}});rng.select();};/**\n     * toggle list\n     *\n     * @param {String} listName - OL or UL\n     */this.toggleList=function(listName,editable){var rng=range.create(editable).wrapBodyInlineWithPara();var paras=rng.nodes(dom.isPara,{includeAncestor:true});var bookmark=rng.paraBookmark(paras);var clustereds=list.clusterBy(paras,func.peq2('parentNode'));// paragraph to list\nif(list.find(paras,dom.isPurePara)){var wrappedParas=[];$.each(clustereds,function(idx,paras){wrappedParas=wrappedParas.concat(self.wrapList(paras,listName));});paras=wrappedParas;// list to paragraph or change list style\n}else{var diffLists=rng.nodes(dom.isList,{includeAncestor:true}).filter(function(listNode){return!$.nodeName(listNode,listName);});if(diffLists.length){$.each(diffLists,function(idx,listNode){dom.replace(listNode,listName);});}else{paras=this.releaseList(clustereds,true);}}range.createFromParaBookmark(bookmark,paras).select();};/**\n     * @param {Node[]} paras\n     * @param {String} listName\n     * @return {Node[]}\n     */this.wrapList=function(paras,listName){var head=list.head(paras);var last=list.last(paras);var prevList=dom.isList(head.previousSibling)&&head.previousSibling;var nextList=dom.isList(last.nextSibling)&&last.nextSibling;var listNode=prevList||dom.insertAfter(dom.create(listName||'UL'),last);// P to LI\nparas=paras.map(function(para){return dom.isPurePara(para)?dom.replace(para,'LI'):para;});// append to list(<ul>, <ol>)\ndom.appendChildNodes(listNode,paras);if(nextList){dom.appendChildNodes(listNode,list.from(nextList.childNodes));dom.remove(nextList);}return paras;};/**\n     * @method releaseList\n     *\n     * @param {Array[]} clustereds\n     * @param {Boolean} isEscapseToBody\n     * @return {Node[]}\n     */this.releaseList=function(clustereds,isEscapseToBody){var releasedParas=[];$.each(clustereds,function(idx,paras){var head=list.head(paras);var last=list.last(paras);var headList=isEscapseToBody?dom.lastAncestor(head,dom.isList):head.parentNode;var lastList=headList.childNodes.length>1?dom.splitTree(headList,{node:last.parentNode,offset:dom.position(last)+1},{isSkipPaddingBlankHTML:true}):null;var middleList=dom.splitTree(headList,{node:head.parentNode,offset:dom.position(head)},{isSkipPaddingBlankHTML:true});paras=isEscapseToBody?dom.listDescendant(middleList,dom.isLi):list.from(middleList.childNodes).filter(dom.isLi);// LI to P\nif(isEscapseToBody||!dom.isList(headList.parentNode)){paras=paras.map(function(para){return dom.replace(para,'P');});}$.each(list.from(paras).reverse(),function(idx,para){dom.insertAfter(para,headList);});// remove empty lists\nvar rootLists=list.compact([headList,middleList,lastList]);$.each(rootLists,function(idx,rootList){var listNodes=[rootList].concat(dom.listDescendant(rootList,dom.isList));$.each(listNodes.reverse(),function(idx,listNode){if(!dom.nodeLength(listNode)){dom.remove(listNode,true);}});});releasedParas=releasedParas.concat(paras);});return releasedParas;};};/**\n   * @class editing.Typing\n   *\n   * Typing\n   *\n   */var Typing=function(){// a Bullet instance to toggle lists off\nvar bullet=new Bullet();/**\n     * insert tab\n     *\n     * @param {WrappedRange} rng\n     * @param {Number} tabsize\n     */this.insertTab=function(rng,tabsize){var tab=dom.createText(new Array(tabsize+1).join(dom.NBSP_CHAR));rng=rng.deleteContents();rng.insertNode(tab,true);rng=range.create(tab,tabsize);rng.select();};/**\n     * insert paragraph\n     */this.insertParagraph=function(editable){var rng=range.create(editable);// deleteContents on range.\nrng=rng.deleteContents();// Wrap range if it needs to be wrapped by paragraph\nrng=rng.wrapBodyInlineWithPara();// finding paragraph\nvar splitRoot=dom.ancestor(rng.sc,dom.isPara);var nextPara;// on paragraph: split paragraph\nif(splitRoot){// if it is an empty line with li\nif(dom.isEmpty(splitRoot)&&dom.isLi(splitRoot)){// toogle UL/OL and escape\nbullet.toggleList(splitRoot.parentNode.nodeName);return;// if it is an empty line with para on blockquote\n}else if(dom.isEmpty(splitRoot)&&dom.isPara(splitRoot)&&dom.isBlockquote(splitRoot.parentNode)){// escape blockquote\ndom.insertAfter(splitRoot,splitRoot.parentNode);nextPara=splitRoot;// if new line has content (not a line break)\n}else{nextPara=dom.splitTree(splitRoot,rng.getStartPoint());var emptyAnchors=dom.listDescendant(splitRoot,dom.isEmptyAnchor);emptyAnchors=emptyAnchors.concat(dom.listDescendant(nextPara,dom.isEmptyAnchor));$.each(emptyAnchors,function(idx,anchor){dom.remove(anchor);});// replace empty heading or pre with P tag\nif((dom.isHeading(nextPara)||dom.isPre(nextPara))&&dom.isEmpty(nextPara)){nextPara=dom.replace(nextPara,'p');}}// no paragraph: insert empty paragraph\n}else{var next=rng.sc.childNodes[rng.so];nextPara=$(dom.emptyPara)[0];if(next){rng.sc.insertBefore(nextPara,next);}else{rng.sc.appendChild(nextPara);}}range.create(nextPara,0).normalize().select().scrollIntoView(editable);};};/**\n   * @class editing.Table\n   *\n   * Table\n   *\n   */var Table=function(){/**\n     * handle tab key\n     *\n     * @param {WrappedRange} rng\n     * @param {Boolean} isShift\n     */this.tab=function(rng,isShift){var cell=dom.ancestor(rng.commonAncestor(),dom.isCell);var table=dom.ancestor(cell,dom.isTable);var cells=dom.listDescendant(table,dom.isCell);var nextCell=list[isShift?'prev':'next'](cells,cell);if(nextCell){range.create(nextCell,0).select();}};/**\n     * create empty table element\n     *\n     * @param {Number} rowCount\n     * @param {Number} colCount\n     * @return {Node}\n     */this.createTable=function(colCount,rowCount,options){var tds=[],tdHTML;for(var idxCol=0;idxCol<colCount;idxCol++){tds.push('<td>'+dom.blank+'</td>');}tdHTML=tds.join('');var trs=[],trHTML;for(var idxRow=0;idxRow<rowCount;idxRow++){trs.push('<tr>'+tdHTML+'</tr>');}trHTML=trs.join('');var $table=$('<table>'+trHTML+'</table>');if(options&&options.tableClassName){$table.addClass(options.tableClassName);}return $table[0];};};var KEY_BOGUS='bogus';/**\n   * @class Editor\n   */var Editor=function(context){var self=this;var $note=context.layoutInfo.note;var $editor=context.layoutInfo.editor;var $editable=context.layoutInfo.editable;var options=context.options;var lang=options.langInfo;var editable=$editable[0];var lastRange=null;var style=new Style();var table=new Table();var typing=new Typing();var bullet=new Bullet();var history=new History($editable);this.initialize=function(){// bind custom events\n$editable.on('keydown',function(event){if(event.keyCode===key.code.ENTER){context.triggerEvent('enter',event);}context.triggerEvent('keydown',event);if(!event.isDefaultPrevented()){if(options.shortcuts){self.handleKeyMap(event);}else{self.preventDefaultEditableShortCuts(event);}}}).on('keyup',function(event){context.triggerEvent('keyup',event);}).on('focus',function(event){context.triggerEvent('focus',event);}).on('blur',function(event){context.triggerEvent('blur',event);}).on('mousedown',function(event){context.triggerEvent('mousedown',event);}).on('mouseup',function(event){context.triggerEvent('mouseup',event);}).on('scroll',function(event){context.triggerEvent('scroll',event);}).on('paste',function(event){context.triggerEvent('paste',event);});// init content before set event\n$editable.html(dom.html($note)||dom.emptyPara);// [workaround] IE doesn't have input events for contentEditable\n// - see: https://goo.gl/4bfIvA\nvar changeEventName=agent.isMSIE?'DOMCharacterDataModified DOMSubtreeModified DOMNodeInserted':'input';$editable.on(changeEventName,func.debounce(function(){context.triggerEvent('change',$editable.html());},250));$editor.on('focusin',function(event){context.triggerEvent('focusin',event);}).on('focusout',function(event){context.triggerEvent('focusout',event);});if(!options.airMode){if(options.width){$editor.outerWidth(options.width);}if(options.height){$editable.outerHeight(options.height);}if(options.maxHeight){$editable.css('max-height',options.maxHeight);}if(options.minHeight){$editable.css('min-height',options.minHeight);}}history.recordUndo();};this.destroy=function(){$editable.off();};this.handleKeyMap=function(event){var keyMap=options.keyMap[agent.isMac?'mac':'pc'];var keys=[];if(event.metaKey){keys.push('CMD');}if(event.ctrlKey&&!event.altKey){keys.push('CTRL');}if(event.shiftKey){keys.push('SHIFT');}var keyName=key.nameFromCode[event.keyCode];if(keyName){keys.push(keyName);}var eventName=keyMap[keys.join('+')];if(eventName){event.preventDefault();context.invoke(eventName);}else if(key.isEdit(event.keyCode)){this.afterCommand();}};this.preventDefaultEditableShortCuts=function(event){// B(Bold, 66) / I(Italic, 73) / U(Underline, 85)\nif((event.ctrlKey||event.metaKey)&&list.contains([66,73,85],event.keyCode)){event.preventDefault();}};/**\n     * create range\n     * @return {WrappedRange}\n     */this.createRange=function(){this.focus();return range.create(editable);};/**\n     * saveRange\n     *\n     * save current range\n     *\n     * @param {Boolean} [thenCollapse=false]\n     */this.saveRange=function(thenCollapse){lastRange=this.createRange();if(thenCollapse){lastRange.collapse().select();}};/**\n     * restoreRange\n     *\n     * restore lately range\n     */this.restoreRange=function(){if(lastRange){lastRange.select();this.focus();}};this.saveTarget=function(node){$editable.data('target',node);};this.clearTarget=function(){$editable.removeData('target');};this.restoreTarget=function(){return $editable.data('target');};/**\n     * currentStyle\n     *\n     * current style\n     * @return {Object|Boolean} unfocus\n     */this.currentStyle=function(){var rng=range.create();if(rng){rng=rng.normalize();}return rng?style.current(rng):style.fromNode($editable);};/**\n     * style from node\n     *\n     * @param {jQuery} $node\n     * @return {Object}\n     */this.styleFromNode=function($node){return style.fromNode($node);};/**\n     * undo\n     */this.undo=function(){context.triggerEvent('before.command',$editable.html());history.undo();context.triggerEvent('change',$editable.html());};context.memo('help.undo',lang.help.undo);/**\n     * redo\n     */this.redo=function(){context.triggerEvent('before.command',$editable.html());history.redo();context.triggerEvent('change',$editable.html());};context.memo('help.redo',lang.help.redo);/**\n     * before command\n     */var beforeCommand=this.beforeCommand=function(){context.triggerEvent('before.command',$editable.html());// keep focus on editable before command execution\nself.focus();};/**\n     * after command\n     * @param {Boolean} isPreventTrigger\n     */var afterCommand=this.afterCommand=function(isPreventTrigger){history.recordUndo();if(!isPreventTrigger){context.triggerEvent('change',$editable.html());}};/* jshint ignore:start */// native commands(with execCommand), generate function for execCommand\nvar commands=['bold','italic','underline','strikethrough','superscript','subscript','justifyLeft','justifyCenter','justifyRight','justifyFull','formatBlock','removeFormat','backColor','foreColor','fontName'];for(var idx=0,len=commands.length;idx<len;idx++){this[commands[idx]]=function(sCmd){return function(value){beforeCommand();document.execCommand(sCmd,false,value);afterCommand(true);};}(commands[idx]);context.memo('help.'+commands[idx],lang.help[commands[idx]]);}/* jshint ignore:end *//**\n     * handle tab key\n     */this.tab=function(){var rng=this.createRange();if(rng.isCollapsed()&&rng.isOnCell()){table.tab(rng);}else{beforeCommand();typing.insertTab(rng,options.tabSize);afterCommand();}};context.memo('help.tab',lang.help.tab);/**\n     * handle shift+tab key\n     */this.untab=function(){var rng=this.createRange();if(rng.isCollapsed()&&rng.isOnCell()){table.tab(rng,true);}};context.memo('help.untab',lang.help.untab);/**\n     * run given function between beforeCommand and afterCommand\n     */this.wrapCommand=function(fn){return function(){beforeCommand();fn.apply(self,arguments);afterCommand();};};/**\n     * insert paragraph\n     */this.insertParagraph=this.wrapCommand(function(){typing.insertParagraph(editable);});context.memo('help.insertParagraph',lang.help.insertParagraph);this.insertOrderedList=this.wrapCommand(function(){bullet.insertOrderedList(editable);});context.memo('help.insertOrderedList',lang.help.insertOrderedList);this.insertUnorderedList=this.wrapCommand(function(){bullet.insertUnorderedList(editable);});context.memo('help.insertUnorderedList',lang.help.insertUnorderedList);this.indent=this.wrapCommand(function(){bullet.indent(editable);});context.memo('help.indent',lang.help.indent);this.outdent=this.wrapCommand(function(){bullet.outdent(editable);});context.memo('help.outdent',lang.help.outdent);/**\n     * insert image\n     *\n     * @param {String} src\n     * @param {String|Function} param\n     * @return {Promise}\n     */this.insertImage=function(src,param){return async.createImage(src,param).then(function($image){beforeCommand();if(typeof param==='function'){param($image);}else{if(typeof param==='string'){$image.attr('data-filename',param);}$image.css('width',Math.min($editable.width(),$image.width()));}$image.show();range.create(editable).insertNode($image[0]);range.createFromNodeAfter($image[0]).select();afterCommand();}).fail(function(e){context.triggerEvent('image.upload.error',e);});};/**\n     * insertImages\n     * @param {File[]} files\n     */this.insertImages=function(files){$.each(files,function(idx,file){var filename=file.name;if(options.maximumImageFileSize&&options.maximumImageFileSize<file.size){context.triggerEvent('image.upload.error',lang.image.maximumFileSizeError);}else{async.readFileAsDataURL(file).then(function(dataURL){return self.insertImage(dataURL,filename);}).fail(function(){context.triggerEvent('image.upload.error');});}});};/**\n     * insertImagesOrCallback\n     * @param {File[]} files\n     */this.insertImagesOrCallback=function(files){var callbacks=options.callbacks;// If onImageUpload options setted\nif(callbacks.onImageUpload){context.triggerEvent('image.upload',files);// else insert Image as dataURL\n}else{this.insertImages(files);}};/**\n     * insertNode\n     * insert node\n     * @param {Node} node\n     */this.insertNode=this.wrapCommand(function(node){var rng=this.createRange();rng.insertNode(node);range.createFromNodeAfter(node).select();});/**\n     * insert text\n     * @param {String} text\n     */this.insertText=this.wrapCommand(function(text){var rng=this.createRange();var textNode=rng.insertNode(dom.createText(text));range.create(textNode,dom.nodeLength(textNode)).select();});/**\n     * return selected plain text\n     * @return {String} text\n     */this.getSelectedText=function(){var rng=this.createRange();// if range on anchor, expand range with anchor\nif(rng.isOnAnchor()){rng=range.createFromNode(dom.ancestor(rng.sc,dom.isAnchor));}return rng.toString();};/**\n     * paste HTML\n     * @param {String} markup\n     */this.pasteHTML=this.wrapCommand(function(markup){var contents=this.createRange().pasteHTML(markup);range.createFromNodeAfter(list.last(contents)).select();});/**\n     * formatBlock\n     *\n     * @param {String} tagName\n     */this.formatBlock=this.wrapCommand(function(tagName){// [workaround] for MSIE, IE need `<`\ntagName=agent.isMSIE?'<'+tagName+'>':tagName;document.execCommand('FormatBlock',false,tagName);});this.formatPara=function(){this.formatBlock('P');};context.memo('help.formatPara',lang.help.formatPara);/* jshint ignore:start */for(var idx=1;idx<=6;idx++){this['formatH'+idx]=function(idx){return function(){this.formatBlock('H'+idx);};}(idx);context.memo('help.formatH'+idx,lang.help['formatH'+idx]);};/* jshint ignore:end *//**\n     * fontSize\n     *\n     * @param {String} value - px\n     */this.fontSize=function(value){var rng=this.createRange();if(rng&&rng.isCollapsed()){var spans=style.styleNodes(rng);var firstSpan=list.head(spans);$(spans).css({'font-size':value+'px'});// [workaround] added styled bogus span for style\n//  - also bogus character needed for cursor position\nif(firstSpan&&!dom.nodeLength(firstSpan)){firstSpan.innerHTML=dom.ZERO_WIDTH_NBSP_CHAR;range.createFromNodeAfter(firstSpan.firstChild).select();$editable.data(KEY_BOGUS,firstSpan);}}else{beforeCommand();$(style.styleNodes(rng)).css({'font-size':value+'px'});afterCommand();}};/**\n     * insert horizontal rule\n     */this.insertHorizontalRule=this.wrapCommand(function(){var hrNode=this.createRange().insertNode(dom.create('HR'));if(hrNode.nextSibling){range.create(hrNode.nextSibling,0).normalize().select();}});context.memo('help.insertHorizontalRule',lang.help.insertHorizontalRule);/**\n     * remove bogus node and character\n     */this.removeBogus=function(){var bogusNode=$editable.data(KEY_BOGUS);if(!bogusNode){return;}var textNode=list.find(list.from(bogusNode.childNodes),dom.isText);var bogusCharIdx=textNode.nodeValue.indexOf(dom.ZERO_WIDTH_NBSP_CHAR);if(bogusCharIdx!==-1){textNode.deleteData(bogusCharIdx,1);}if(dom.isEmpty(bogusNode)){dom.remove(bogusNode);}$editable.removeData(KEY_BOGUS);};/**\n     * lineHeight\n     * @param {String} value\n     */this.lineHeight=this.wrapCommand(function(value){style.stylePara(this.createRange(),{lineHeight:value});});/**\n     * unlink\n     *\n     * @type command\n     */this.unlink=function(){var rng=this.createRange();if(rng.isOnAnchor()){var anchor=dom.ancestor(rng.sc,dom.isAnchor);rng=range.createFromNode(anchor);rng.select();beforeCommand();document.execCommand('unlink');afterCommand();}};/**\n     * create link (command)\n     *\n     * @param {Object} linkInfo\n     */this.createLink=this.wrapCommand(function(linkInfo){var linkUrl=linkInfo.url;var linkText=linkInfo.text;var isNewWindow=linkInfo.isNewWindow;var rng=linkInfo.range||this.createRange();var isTextChanged=rng.toString()!==linkText;// handle spaced urls from input\nif(typeof linkUrl==='string'){linkUrl=linkUrl.trim();}if(options.onCreateLink){linkUrl=options.onCreateLink(linkUrl);}var anchors=[];if(isTextChanged){rng=rng.deleteContents();var anchor=rng.insertNode($('<A>'+linkText+'</A>')[0]);anchors.push(anchor);}else{anchors=style.styleNodes(rng,{nodeName:'A',expandClosestSibling:true,onlyPartialContains:true});}$.each(anchors,function(idx,anchor){// if url doesn't match an URL schema, set http:// as default\nlinkUrl=/^[A-Za-z][A-Za-z0-9+-.]*\\:[\\/\\/]?/.test(linkUrl)?linkUrl:'http://'+linkUrl;$(anchor).attr('href',linkUrl);if(isNewWindow){$(anchor).attr('target','_blank');}else{$(anchor).removeAttr('target');}});var startRange=range.createFromNodeBefore(list.head(anchors));var startPoint=startRange.getStartPoint();var endRange=range.createFromNodeAfter(list.last(anchors));var endPoint=endRange.getEndPoint();range.create(startPoint.node,startPoint.offset,endPoint.node,endPoint.offset).select();});/**\n     * returns link info\n     *\n     * @return {Object}\n     * @return {WrappedRange} return.range\n     * @return {String} return.text\n     * @return {Boolean} [return.isNewWindow=true]\n     * @return {String} [return.url=\"\"]\n     */this.getLinkInfo=function(){var rng=this.createRange().expand(dom.isAnchor);// Get the first anchor on range(for edit).\nvar $anchor=$(list.head(rng.nodes(dom.isAnchor)));return{range:rng,text:rng.toString(),isNewWindow:$anchor.length?$anchor.attr('target')==='_blank':false,url:$anchor.length?$anchor.attr('href'):''};};/**\n     * setting color\n     *\n     * @param {Object} sObjColor  color code\n     * @param {String} sObjColor.foreColor foreground color\n     * @param {String} sObjColor.backColor background color\n     */this.color=this.wrapCommand(function(colorInfo){var foreColor=colorInfo.foreColor;var backColor=colorInfo.backColor;if(foreColor){document.execCommand('foreColor',false,foreColor);}if(backColor){document.execCommand('backColor',false,backColor);}});/**\n     * insert Table\n     *\n     * @param {String} dimension of table (ex : \"5x5\")\n     */this.insertTable=this.wrapCommand(function(dim){var dimension=dim.split('x');var rng=this.createRange().deleteContents();rng.insertNode(table.createTable(dimension[0],dimension[1],options));});/**\n     * float me\n     *\n     * @param {String} value\n     */this.floatMe=this.wrapCommand(function(value){var $target=$(this.restoreTarget());$target.css('float',value);});/**\n     * resize overlay element\n     * @param {String} value\n     */this.resize=this.wrapCommand(function(value){var $target=$(this.restoreTarget());$target.css({width:value*100+'%',height:''});});/**\n     * @param {Position} pos\n     * @param {jQuery} $target - target element\n     * @param {Boolean} [bKeepRatio] - keep ratio\n     */this.resizeTo=function(pos,$target,bKeepRatio){var imageSize;if(bKeepRatio){var newRatio=pos.y/pos.x;var ratio=$target.data('ratio');imageSize={width:ratio>newRatio?pos.x:pos.y/ratio,height:ratio>newRatio?pos.x*ratio:pos.y};}else{imageSize={width:pos.x,height:pos.y};}$target.css(imageSize);};/**\n     * remove media object\n     */this.removeMedia=this.wrapCommand(function(){var $target=$(this.restoreTarget()).detach();context.triggerEvent('media.delete',$target,$editable);});/**\n     * returns whether editable area has focus or not.\n     */this.hasFocus=function(){return $editable.is(':focus');};/**\n     * set focus\n     */this.focus=function(){// [workaround] Screen will move when page is scolled in IE.\n//  - do focus when not focused\nif(!this.hasFocus()){$editable.focus();}};/**\n     * returns whether contents is empty or not.\n     * @return {Boolean}\n     */this.isEmpty=function(){return dom.isEmpty($editable[0])||dom.emptyPara===$editable.html();};/**\n     * Removes all contents and restores the editable instance to an _emptyPara_.\n     */this.empty=function(){context.invoke('code',dom.emptyPara);};};var Clipboard=function(context){var self=this;var $editable=context.layoutInfo.editable;this.events={'summernote.keydown':function(we,e){if(self.needKeydownHook()){if((e.ctrlKey||e.metaKey)&&e.keyCode===key.code.V){context.invoke('editor.saveRange');self.$paste.focus();setTimeout(function(){self.pasteByHook();},0);}}}};this.needKeydownHook=function(){return agent.isMSIE&&agent.browserVersion>10||agent.isFF;};this.initialize=function(){// [workaround] getting image from clipboard\n//  - IE11 and Firefox: CTRL+v hook\n//  - Webkit: event.clipboardData\nif(this.needKeydownHook()){this.$paste=$('<div tabindex=\"-1\" />').attr('contenteditable',true).css({position:'absolute',left:-100000,opacity:0});$editable.before(this.$paste);this.$paste.on('paste',function(event){context.triggerEvent('paste',event);});}else{$editable.on('paste',this.pasteByEvent);}};this.destroy=function(){if(this.needKeydownHook()){this.$paste.remove();this.$paste=null;}};this.pasteByHook=function(){var node=this.$paste[0].firstChild;if(dom.isImg(node)){var dataURI=node.src;var decodedData=atob(dataURI.split(',')[1]);var array=new Uint8Array(decodedData.length);for(var i=0;i<decodedData.length;i++){array[i]=decodedData.charCodeAt(i);}var blob=new Blob([array],{type:'image/png'});blob.name='clipboard.png';context.invoke('editor.restoreRange');context.invoke('editor.focus');context.invoke('editor.insertImagesOrCallback',[blob]);}else{var pasteContent=$('<div />').html(this.$paste.html()).html();context.invoke('editor.restoreRange');context.invoke('editor.focus');if(pasteContent){context.invoke('editor.pasteHTML',pasteContent);}}this.$paste.empty();};/**\n     * paste by clipboard event\n     *\n     * @param {Event} event\n     */this.pasteByEvent=function(event){var clipboardData=event.originalEvent.clipboardData;if(clipboardData&&clipboardData.items&&clipboardData.items.length){var item=list.head(clipboardData.items);if(item.kind==='file'&&item.type.indexOf('image/')!==-1){context.invoke('editor.insertImagesOrCallback',[item.getAsFile()]);}context.invoke('editor.afterCommand');}};};var Dropzone=function(context){var $document=$(document);var $editor=context.layoutInfo.editor;var $editable=context.layoutInfo.editable;var options=context.options;var lang=options.langInfo;var documentEventHandlers={};var $dropzone=$(['<div class=\"note-dropzone\">','  <div class=\"note-dropzone-message\"/>','</div>'].join('')).prependTo($editor);var detachDocumentEvent=function(){Object.keys(documentEventHandlers).forEach(function(key){$document.off(key.substr(2).toLowerCase(),documentEventHandlers[key]);});documentEventHandlers={};};/**\n     * attach Drag and Drop Events\n     */this.initialize=function(){if(options.disableDragAndDrop){// prevent default drop event\ndocumentEventHandlers.onDrop=function(e){e.preventDefault();};$document.on('drop',documentEventHandlers.onDrop);}else{this.attachDragAndDropEvent();}};/**\n     * attach Drag and Drop Events\n     */this.attachDragAndDropEvent=function(){var collection=$(),$dropzoneMessage=$dropzone.find('.note-dropzone-message');documentEventHandlers.onDragenter=function(e){var isCodeview=context.invoke('codeview.isActivated');var hasEditorSize=$editor.width()>0&&$editor.height()>0;if(!isCodeview&&!collection.length&&hasEditorSize){$editor.addClass('dragover');$dropzone.width($editor.width());$dropzone.height($editor.height());$dropzoneMessage.text(lang.image.dragImageHere);}collection=collection.add(e.target);};documentEventHandlers.onDragleave=function(e){collection=collection.not(e.target);if(!collection.length){$editor.removeClass('dragover');}};documentEventHandlers.onDrop=function(){collection=$();$editor.removeClass('dragover');};// show dropzone on dragenter when dragging a object to document\n// -but only if the editor is visible, i.e. has a positive width and height\n$document.on('dragenter',documentEventHandlers.onDragenter).on('dragleave',documentEventHandlers.onDragleave).on('drop',documentEventHandlers.onDrop);// change dropzone's message on hover.\n$dropzone.on('dragenter',function(){$dropzone.addClass('hover');$dropzoneMessage.text(lang.image.dropImage);}).on('dragleave',function(){$dropzone.removeClass('hover');$dropzoneMessage.text(lang.image.dragImageHere);});// attach dropImage\n$dropzone.on('drop',function(event){var dataTransfer=event.originalEvent.dataTransfer;if(dataTransfer&&dataTransfer.files&&dataTransfer.files.length){event.preventDefault();$editable.focus();context.invoke('editor.insertImagesOrCallback',dataTransfer.files);}else{$.each(dataTransfer.types,function(idx,type){var content=dataTransfer.getData(type);if(type.toLowerCase().indexOf('text')>-1){context.invoke('editor.pasteHTML',content);}else{$(content).each(function(){context.invoke('editor.insertNode',this);});}});}}).on('dragover',false);// prevent default dragover event\n};this.destroy=function(){detachDocumentEvent();};};var CodeMirror;if(agent.hasCodeMirror){if(agent.isSupportAmd){!/* require */(/* empty */function() { var __WEBPACK_AMD_REQUIRE_ARRAY__ = [__webpack_require__(55)]; (function(cm){CodeMirror=cm;}.apply(null, __WEBPACK_AMD_REQUIRE_ARRAY__));}());}else{CodeMirror=window.CodeMirror;}}/**\n   * @class Codeview\n   */var Codeview=function(context){var $editor=context.layoutInfo.editor;var $editable=context.layoutInfo.editable;var $codable=context.layoutInfo.codable;var options=context.options;this.sync=function(){var isCodeview=this.isActivated();if(isCodeview&&agent.hasCodeMirror){$codable.data('cmEditor').save();}};/**\n     * @return {Boolean}\n     */this.isActivated=function(){return $editor.hasClass('codeview');};/**\n     * toggle codeview\n     */this.toggle=function(){if(this.isActivated()){this.deactivate();}else{this.activate();}context.triggerEvent('codeview.toggled');};/**\n     * activate code view\n     */this.activate=function(){$codable.val(dom.html($editable,options.prettifyHtml));$codable.height($editable.height());context.invoke('toolbar.updateCodeview',true);$editor.addClass('codeview');$codable.focus();// activate CodeMirror as codable\nif(agent.hasCodeMirror){var cmEditor=CodeMirror.fromTextArea($codable[0],options.codemirror);// CodeMirror TernServer\nif(options.codemirror.tern){var server=new CodeMirror.TernServer(options.codemirror.tern);cmEditor.ternServer=server;cmEditor.on('cursorActivity',function(cm){server.updateArgHints(cm);});}// CodeMirror hasn't Padding.\ncmEditor.setSize(null,$editable.outerHeight());$codable.data('cmEditor',cmEditor);}};/**\n     * deactivate code view\n     */this.deactivate=function(){// deactivate CodeMirror as codable\nif(agent.hasCodeMirror){var cmEditor=$codable.data('cmEditor');$codable.val(cmEditor.getValue());cmEditor.toTextArea();}var value=dom.value($codable,options.prettifyHtml)||dom.emptyPara;var isChange=$editable.html()!==value;$editable.html(value);$editable.height(options.height?$codable.height():'auto');$editor.removeClass('codeview');if(isChange){context.triggerEvent('change',$editable.html(),$editable);}$editable.focus();context.invoke('toolbar.updateCodeview',false);};this.destroy=function(){if(this.isActivated()){this.deactivate();}};};var EDITABLE_PADDING=24;var Statusbar=function(context){var $document=$(document);var $statusbar=context.layoutInfo.statusbar;var $editable=context.layoutInfo.editable;var options=context.options;this.initialize=function(){if(options.airMode||options.disableResizeEditor){return;}$statusbar.on('mousedown',function(event){event.preventDefault();event.stopPropagation();var editableTop=$editable.offset().top-$document.scrollTop();$document.on('mousemove',function(event){var height=event.clientY-(editableTop+EDITABLE_PADDING);height=options.minheight>0?Math.max(height,options.minheight):height;height=options.maxHeight>0?Math.min(height,options.maxHeight):height;$editable.height(height);}).one('mouseup',function(){$document.off('mousemove');});});};this.destroy=function(){$statusbar.off();$statusbar.remove();};};var Fullscreen=function(context){var $editor=context.layoutInfo.editor;var $toolbar=context.layoutInfo.toolbar;var $editable=context.layoutInfo.editable;var $codable=context.layoutInfo.codable;var $window=$(window);var $scrollbar=$('html, body');/**\n     * toggle fullscreen\n     */this.toggle=function(){var resize=function(size){$editable.css('height',size.h);$codable.css('height',size.h);if($codable.data('cmeditor')){$codable.data('cmeditor').setsize(null,size.h);}};$editor.toggleClass('fullscreen');if(this.isFullscreen()){$editable.data('orgHeight',$editable.css('height'));$window.on('resize',function(){resize({h:$window.height()-$toolbar.outerHeight()});}).trigger('resize');$scrollbar.css('overflow','hidden');}else{$window.off('resize');resize({h:$editable.data('orgHeight')});$scrollbar.css('overflow','visible');}context.invoke('toolbar.updateFullscreen',this.isFullscreen());};this.isFullscreen=function(){return $editor.hasClass('fullscreen');};};var Handle=function(context){var self=this;var $document=$(document);var $editingArea=context.layoutInfo.editingArea;var options=context.options;this.events={'summernote.mousedown':function(we,e){if(self.update(e.target)){e.preventDefault();}},'summernote.keyup summernote.scroll summernote.change summernote.dialog.shown':function(){self.update();}};this.initialize=function(){this.$handle=$(['<div class=\"note-handle\">','<div class=\"note-control-selection\">','<div class=\"note-control-selection-bg\"></div>','<div class=\"note-control-holder note-control-nw\"></div>','<div class=\"note-control-holder note-control-ne\"></div>','<div class=\"note-control-holder note-control-sw\"></div>','<div class=\"',options.disableResizeImage?'note-control-holder':'note-control-sizing',' note-control-se\"></div>',options.disableResizeImage?'':'<div class=\"note-control-selection-info\"></div>','</div>','</div>'].join('')).prependTo($editingArea);this.$handle.on('mousedown',function(event){if(dom.isControlSizing(event.target)){event.preventDefault();event.stopPropagation();var $target=self.$handle.find('.note-control-selection').data('target'),posStart=$target.offset(),scrollTop=$document.scrollTop();$document.on('mousemove',function(event){context.invoke('editor.resizeTo',{x:event.clientX-posStart.left,y:event.clientY-(posStart.top-scrollTop)},$target,!event.shiftKey);self.update($target[0]);}).one('mouseup',function(e){e.preventDefault();$document.off('mousemove');context.invoke('editor.afterCommand');});if(!$target.data('ratio')){// original ratio.\n$target.data('ratio',$target.height()/$target.width());}}});};this.destroy=function(){this.$handle.remove();};this.update=function(target){var isImage=dom.isImg(target);var $selection=this.$handle.find('.note-control-selection');context.invoke('imagePopover.update',target);if(isImage){var $image=$(target);var pos=$image.position();// include margin\nvar imageSize={w:$image.outerWidth(true),h:$image.outerHeight(true)};$selection.css({display:'block',left:pos.left,top:pos.top,width:imageSize.w,height:imageSize.h}).data('target',$image);// save current image element.\nvar sizingText=imageSize.w+'x'+imageSize.h;$selection.find('.note-control-selection-info').text(sizingText);context.invoke('editor.saveTarget',target);}else{this.hide();}return isImage;};/**\n     * hide\n     *\n     * @param {jQuery} $handle\n     */this.hide=function(){context.invoke('editor.clearTarget');this.$handle.children().hide();};};var AutoLink=function(context){var self=this;var defaultScheme='http://';var linkPattern=/^([A-Za-z][A-Za-z0-9+-.]*\\:[\\/\\/]?|mailto:[A-Z0-9._%+-]+@)?(www\\.)?(.+)$/i;this.events={'summernote.keyup':function(we,e){if(!e.isDefaultPrevented()){self.handleKeyup(e);}},'summernote.keydown':function(we,e){self.handleKeydown(e);}};this.initialize=function(){this.lastWordRange=null;};this.destroy=function(){this.lastWordRange=null;};this.replace=function(){if(!this.lastWordRange){return;}var keyword=this.lastWordRange.toString();var match=keyword.match(linkPattern);if(match&&(match[1]||match[2])){var link=match[1]?keyword:defaultScheme+keyword;var node=$('<a />').html(keyword).attr('href',link)[0];this.lastWordRange.insertNode(node);this.lastWordRange=null;context.invoke('editor.focus');}};this.handleKeydown=function(e){if(list.contains([key.code.ENTER,key.code.SPACE],e.keyCode)){var wordRange=context.invoke('editor.createRange').getWordRange();this.lastWordRange=wordRange;}};this.handleKeyup=function(e){if(list.contains([key.code.ENTER,key.code.SPACE],e.keyCode)){this.replace();}};};/**\n   * textarea auto sync.\n   */var AutoSync=function(context){var $note=context.layoutInfo.note;this.events={'summernote.change':function(){$note.val(context.invoke('code'));}};this.shouldInitialize=function(){return dom.isTextarea($note[0]);};};var Placeholder=function(context){var self=this;var $editingArea=context.layoutInfo.editingArea;var options=context.options;this.events={'summernote.init summernote.change':function(){self.update();},'summernote.codeview.toggled':function(){self.update();}};this.shouldInitialize=function(){return!!options.placeholder;};this.initialize=function(){this.$placeholder=$('<div class=\"note-placeholder\">');this.$placeholder.on('click',function(){context.invoke('focus');}).text(options.placeholder).prependTo($editingArea);};this.destroy=function(){this.$placeholder.remove();};this.update=function(){var isShow=!context.invoke('codeview.isActivated')&&context.invoke('editor.isEmpty');this.$placeholder.toggle(isShow);};};var Buttons=function(context){var self=this;var ui=$.summernote.ui;var $toolbar=context.layoutInfo.toolbar;var options=context.options;var lang=options.langInfo;var invertedKeyMap=func.invertObject(options.keyMap[agent.isMac?'mac':'pc']);var representShortcut=this.representShortcut=function(editorMethod){var shortcut=invertedKeyMap[editorMethod];if(!options.shortcuts||!shortcut){return'';}if(agent.isMac){shortcut=shortcut.replace('CMD','').replace('SHIFT','');}shortcut=shortcut.replace('BACKSLASH','\\\\').replace('SLASH','/').replace('LEFTBRACKET','[').replace('RIGHTBRACKET',']');return' ('+shortcut+')';};this.initialize=function(){this.addToolbarButtons();this.addImagePopoverButtons();this.addLinkPopoverButtons();this.fontInstalledMap={};};this.destroy=function(){delete this.fontInstalledMap;};this.isFontInstalled=function(name){if(!self.fontInstalledMap.hasOwnProperty(name)){self.fontInstalledMap[name]=agent.isFontInstalled(name)||list.contains(options.fontNamesIgnoreCheck,name);}return self.fontInstalledMap[name];};this.addToolbarButtons=function(){context.memo('button.style',function(){return ui.buttonGroup([ui.button({className:'dropdown-toggle',contents:ui.icon(options.icons.magic)+' '+ui.icon(options.icons.caret,'span'),tooltip:lang.style.style,data:{toggle:'dropdown'}}),ui.dropdown({className:'dropdown-style',items:context.options.styleTags,template:function(item){if(typeof item==='string'){item={tag:item,title:lang.style.hasOwnProperty(item)?lang.style[item]:item};}var tag=item.tag;var title=item.title;var style=item.style?' style=\"'+item.style+'\" ':'';var className=item.className?' class=\"'+item.className+'\"':'';return'<'+tag+style+className+'>'+title+'</'+tag+'>';},click:context.createInvokeHandler('editor.formatBlock')})]).render();});context.memo('button.bold',function(){return ui.button({className:'note-btn-bold',contents:ui.icon(options.icons.bold),tooltip:lang.font.bold+representShortcut('bold'),click:context.createInvokeHandler('editor.bold')}).render();});context.memo('button.italic',function(){return ui.button({className:'note-btn-italic',contents:ui.icon(options.icons.italic),tooltip:lang.font.italic+representShortcut('italic'),click:context.createInvokeHandler('editor.italic')}).render();});context.memo('button.underline',function(){return ui.button({className:'note-btn-underline',contents:ui.icon(options.icons.underline),tooltip:lang.font.underline+representShortcut('underline'),click:context.createInvokeHandler('editor.underline')}).render();});context.memo('button.clear',function(){return ui.button({contents:ui.icon(options.icons.eraser),tooltip:lang.font.clear+representShortcut('removeFormat'),click:context.createInvokeHandler('editor.removeFormat')}).render();});context.memo('button.strikethrough',function(){return ui.button({className:'note-btn-strikethrough',contents:ui.icon(options.icons.strikethrough),tooltip:lang.font.strikethrough+representShortcut('strikethrough'),click:context.createInvokeHandler('editor.strikethrough')}).render();});context.memo('button.superscript',function(){return ui.button({className:'note-btn-superscript',contents:ui.icon(options.icons.superscript),tooltip:lang.font.superscript,click:context.createInvokeHandler('editor.superscript')}).render();});context.memo('button.subscript',function(){return ui.button({className:'note-btn-subscript',contents:ui.icon(options.icons.subscript),tooltip:lang.font.subscript,click:context.createInvokeHandler('editor.subscript')}).render();});context.memo('button.fontname',function(){return ui.buttonGroup([ui.button({className:'dropdown-toggle',contents:'<span class=\"note-current-fontname\"/> '+ui.icon(options.icons.caret,'span'),tooltip:lang.font.name,data:{toggle:'dropdown'}}),ui.dropdownCheck({className:'dropdown-fontname',checkClassName:options.icons.menuCheck,items:options.fontNames.filter(self.isFontInstalled),template:function(item){return'<span style=\"font-family:'+item+'\">'+item+'</span>';},click:context.createInvokeHandler('editor.fontName')})]).render();});context.memo('button.fontsize',function(){return ui.buttonGroup([ui.button({className:'dropdown-toggle',contents:'<span class=\"note-current-fontsize\"/>'+ui.icon(options.icons.caret,'span'),tooltip:lang.font.size,data:{toggle:'dropdown'}}),ui.dropdownCheck({className:'dropdown-fontsize',checkClassName:options.icons.menuCheck,items:options.fontSizes,click:context.createInvokeHandler('editor.fontSize')})]).render();});context.memo('button.color',function(){return ui.buttonGroup({className:'note-color',children:[ui.button({className:'note-current-color-button',contents:ui.icon(options.icons.font+' note-recent-color'),tooltip:lang.color.recent,click:function(e){var $button=$(e.currentTarget);context.invoke('editor.color',{backColor:$button.attr('data-backColor'),foreColor:$button.attr('data-foreColor')});},callback:function($button){var $recentColor=$button.find('.note-recent-color');$recentColor.css('background-color','#FFFF00');$button.attr('data-backColor','#FFFF00');}}),ui.button({className:'dropdown-toggle',contents:ui.icon(options.icons.caret,'span'),tooltip:lang.color.more,data:{toggle:'dropdown'}}),ui.dropdown({items:['<li>','<div class=\"btn-group\">','  <div class=\"note-palette-title\">'+lang.color.background+'</div>','  <div>','    <button type=\"button\" class=\"note-color-reset btn btn-default\" data-event=\"backColor\" data-value=\"inherit\">',lang.color.transparent,'    </button>','  </div>','  <div class=\"note-holder\" data-event=\"backColor\"/>','</div>','<div class=\"btn-group\">','  <div class=\"note-palette-title\">'+lang.color.foreground+'</div>','  <div>','    <button type=\"button\" class=\"note-color-reset btn btn-default\" data-event=\"removeFormat\" data-value=\"foreColor\">',lang.color.resetToDefault,'    </button>','  </div>','  <div class=\"note-holder\" data-event=\"foreColor\"/>','</div>','</li>'].join(''),callback:function($dropdown){$dropdown.find('.note-holder').each(function(){var $holder=$(this);$holder.append(ui.palette({colors:options.colors,eventName:$holder.data('event')}).render());});},click:function(event){var $button=$(event.target);var eventName=$button.data('event');var value=$button.data('value');if(eventName&&value){var key=eventName==='backColor'?'background-color':'color';var $color=$button.closest('.note-color').find('.note-recent-color');var $currentButton=$button.closest('.note-color').find('.note-current-color-button');$color.css(key,value);$currentButton.attr('data-'+eventName,value);context.invoke('editor.'+eventName,value);}}})]}).render();});context.memo('button.ul',function(){return ui.button({contents:ui.icon(options.icons.unorderedlist),tooltip:lang.lists.unordered+representShortcut('insertUnorderedList'),click:context.createInvokeHandler('editor.insertUnorderedList')}).render();});context.memo('button.ol',function(){return ui.button({contents:ui.icon(options.icons.orderedlist),tooltip:lang.lists.ordered+representShortcut('insertOrderedList'),click:context.createInvokeHandler('editor.insertOrderedList')}).render();});var justifyLeft=ui.button({contents:ui.icon(options.icons.alignLeft),tooltip:lang.paragraph.left+representShortcut('justifyLeft'),click:context.createInvokeHandler('editor.justifyLeft')});var justifyCenter=ui.button({contents:ui.icon(options.icons.alignCenter),tooltip:lang.paragraph.center+representShortcut('justifyCenter'),click:context.createInvokeHandler('editor.justifyCenter')});var justifyRight=ui.button({contents:ui.icon(options.icons.alignRight),tooltip:lang.paragraph.right+representShortcut('justifyRight'),click:context.createInvokeHandler('editor.justifyRight')});var justifyFull=ui.button({contents:ui.icon(options.icons.alignJustify),tooltip:lang.paragraph.justify+representShortcut('justifyFull'),click:context.createInvokeHandler('editor.justifyFull')});var outdent=ui.button({contents:ui.icon(options.icons.outdent),tooltip:lang.paragraph.outdent+representShortcut('outdent'),click:context.createInvokeHandler('editor.outdent')});var indent=ui.button({contents:ui.icon(options.icons.indent),tooltip:lang.paragraph.indent+representShortcut('indent'),click:context.createInvokeHandler('editor.indent')});context.memo('button.justifyLeft',func.invoke(justifyLeft,'render'));context.memo('button.justifyCenter',func.invoke(justifyCenter,'render'));context.memo('button.justifyRight',func.invoke(justifyRight,'render'));context.memo('button.justifyFull',func.invoke(justifyFull,'render'));context.memo('button.outdent',func.invoke(outdent,'render'));context.memo('button.indent',func.invoke(indent,'render'));context.memo('button.paragraph',function(){return ui.buttonGroup([ui.button({className:'dropdown-toggle',contents:ui.icon(options.icons.alignLeft)+' '+ui.icon(options.icons.caret,'span'),tooltip:lang.paragraph.paragraph,data:{toggle:'dropdown'}}),ui.dropdown([ui.buttonGroup({className:'note-align',children:[justifyLeft,justifyCenter,justifyRight,justifyFull]}),ui.buttonGroup({className:'note-list',children:[outdent,indent]})])]).render();});context.memo('button.height',function(){return ui.buttonGroup([ui.button({className:'dropdown-toggle',contents:ui.icon(options.icons.textHeight)+' '+ui.icon(options.icons.caret,'span'),tooltip:lang.font.height,data:{toggle:'dropdown'}}),ui.dropdownCheck({items:options.lineHeights,checkClassName:options.icons.menuCheck,className:'dropdown-line-height',click:context.createInvokeHandler('editor.lineHeight')})]).render();});context.memo('button.table',function(){return ui.buttonGroup([ui.button({className:'dropdown-toggle',contents:ui.icon(options.icons.table)+' '+ui.icon(options.icons.caret,'span'),tooltip:lang.table.table,data:{toggle:'dropdown'}}),ui.dropdown({className:'note-table',items:['<div class=\"note-dimension-picker\">','  <div class=\"note-dimension-picker-mousecatcher\" data-event=\"insertTable\" data-value=\"1x1\"/>','  <div class=\"note-dimension-picker-highlighted\"/>','  <div class=\"note-dimension-picker-unhighlighted\"/>','</div>','<div class=\"note-dimension-display\">1 x 1</div>'].join('')})],{callback:function($node){var $catcher=$node.find('.note-dimension-picker-mousecatcher');$catcher.css({width:options.insertTableMaxSize.col+'em',height:options.insertTableMaxSize.row+'em'}).mousedown(context.createInvokeHandler('editor.insertTable')).on('mousemove',self.tableMoveHandler);}}).render();});context.memo('button.link',function(){return ui.button({contents:ui.icon(options.icons.link),tooltip:lang.link.link+representShortcut('linkDialog.show'),click:context.createInvokeHandler('linkDialog.show')}).render();});context.memo('button.picture',function(){return ui.button({contents:ui.icon(options.icons.picture),tooltip:lang.image.image,click:context.createInvokeHandler('imageDialog.show')}).render();});context.memo('button.video',function(){return ui.button({contents:ui.icon(options.icons.video),tooltip:lang.video.video,click:context.createInvokeHandler('videoDialog.show')}).render();});context.memo('button.hr',function(){return ui.button({contents:ui.icon(options.icons.minus),tooltip:lang.hr.insert+representShortcut('insertHorizontalRule'),click:context.createInvokeHandler('editor.insertHorizontalRule')}).render();});context.memo('button.fullscreen',function(){return ui.button({className:'btn-fullscreen',contents:ui.icon(options.icons.arrowsAlt),tooltip:lang.options.fullscreen,click:context.createInvokeHandler('fullscreen.toggle')}).render();});context.memo('button.codeview',function(){return ui.button({className:'btn-codeview',contents:ui.icon(options.icons.code),tooltip:lang.options.codeview,click:context.createInvokeHandler('codeview.toggle')}).render();});context.memo('button.redo',function(){return ui.button({contents:ui.icon(options.icons.redo),tooltip:lang.history.redo+representShortcut('redo'),click:context.createInvokeHandler('editor.redo')}).render();});context.memo('button.undo',function(){return ui.button({contents:ui.icon(options.icons.undo),tooltip:lang.history.undo+representShortcut('undo'),click:context.createInvokeHandler('editor.undo')}).render();});context.memo('button.help',function(){return ui.button({contents:ui.icon(options.icons.question),tooltip:lang.options.help,click:context.createInvokeHandler('helpDialog.show')}).render();});};/**\n     * image : [\n     *   ['imagesize', ['imageSize100', 'imageSize50', 'imageSize25']],\n     *   ['float', ['floatLeft', 'floatRight', 'floatNone' ]],\n     *   ['remove', ['removeMedia']]\n     * ],\n     */this.addImagePopoverButtons=function(){// Image Size Buttons\ncontext.memo('button.imageSize100',function(){return ui.button({contents:'<span class=\"note-fontsize-10\">100%</span>',tooltip:lang.image.resizeFull,click:context.createInvokeHandler('editor.resize','1')}).render();});context.memo('button.imageSize50',function(){return ui.button({contents:'<span class=\"note-fontsize-10\">50%</span>',tooltip:lang.image.resizeHalf,click:context.createInvokeHandler('editor.resize','0.5')}).render();});context.memo('button.imageSize25',function(){return ui.button({contents:'<span class=\"note-fontsize-10\">25%</span>',tooltip:lang.image.resizeQuarter,click:context.createInvokeHandler('editor.resize','0.25')}).render();});// Float Buttons\ncontext.memo('button.floatLeft',function(){return ui.button({contents:ui.icon(options.icons.alignLeft),tooltip:lang.image.floatLeft,click:context.createInvokeHandler('editor.floatMe','left')}).render();});context.memo('button.floatRight',function(){return ui.button({contents:ui.icon(options.icons.alignRight),tooltip:lang.image.floatRight,click:context.createInvokeHandler('editor.floatMe','right')}).render();});context.memo('button.floatNone',function(){return ui.button({contents:ui.icon(options.icons.alignJustify),tooltip:lang.image.floatNone,click:context.createInvokeHandler('editor.floatMe','none')}).render();});// Remove Buttons\ncontext.memo('button.removeMedia',function(){return ui.button({contents:ui.icon(options.icons.trash),tooltip:lang.image.remove,click:context.createInvokeHandler('editor.removeMedia')}).render();});};this.addLinkPopoverButtons=function(){context.memo('button.linkDialogShow',function(){return ui.button({contents:ui.icon(options.icons.link),tooltip:lang.link.edit,click:context.createInvokeHandler('linkDialog.show')}).render();});context.memo('button.unlink',function(){return ui.button({contents:ui.icon(options.icons.unlink),tooltip:lang.link.unlink,click:context.createInvokeHandler('editor.unlink')}).render();});};this.build=function($container,groups){for(var groupIdx=0,groupLen=groups.length;groupIdx<groupLen;groupIdx++){var group=groups[groupIdx];var groupName=group[0];var buttons=group[1];var $group=ui.buttonGroup({className:'note-'+groupName}).render();for(var idx=0,len=buttons.length;idx<len;idx++){var button=context.memo('button.'+buttons[idx]);if(button){$group.append(typeof button==='function'?button(context):button);}}$group.appendTo($container);}};this.updateCurrentStyle=function(){var styleInfo=context.invoke('editor.currentStyle');this.updateBtnStates({'.note-btn-bold':function(){return styleInfo['font-bold']==='bold';},'.note-btn-italic':function(){return styleInfo['font-italic']==='italic';},'.note-btn-underline':function(){return styleInfo['font-underline']==='underline';},'.note-btn-subscript':function(){return styleInfo['font-subscript']==='subscript';},'.note-btn-superscript':function(){return styleInfo['font-superscript']==='superscript';},'.note-btn-strikethrough':function(){return styleInfo['font-strikethrough']==='strikethrough';}});if(styleInfo['font-family']){var fontNames=styleInfo['font-family'].split(',').map(function(name){return name.replace(/[\\'\\\"]/g,'').replace(/\\s+$/,'').replace(/^\\s+/,'');});var fontName=list.find(fontNames,self.isFontInstalled);$toolbar.find('.dropdown-fontname li a').each(function(){// always compare string to avoid creating another func.\nvar isChecked=$(this).data('value')+''===fontName+'';this.className=isChecked?'checked':'';});$toolbar.find('.note-current-fontname').text(fontName);}if(styleInfo['font-size']){var fontSize=styleInfo['font-size'];$toolbar.find('.dropdown-fontsize li a').each(function(){// always compare with string to avoid creating another func.\nvar isChecked=$(this).data('value')+''===fontSize+'';this.className=isChecked?'checked':'';});$toolbar.find('.note-current-fontsize').text(fontSize);}if(styleInfo['line-height']){var lineHeight=styleInfo['line-height'];$toolbar.find('.dropdown-line-height li a').each(function(){// always compare with string to avoid creating another func.\nvar isChecked=$(this).data('value')+''===lineHeight+'';this.className=isChecked?'checked':'';});}};this.updateBtnStates=function(infos){$.each(infos,function(selector,pred){ui.toggleBtnActive($toolbar.find(selector),pred());});};this.tableMoveHandler=function(event){var PX_PER_EM=18;var $picker=$(event.target.parentNode);// target is mousecatcher\nvar $dimensionDisplay=$picker.next();var $catcher=$picker.find('.note-dimension-picker-mousecatcher');var $highlighted=$picker.find('.note-dimension-picker-highlighted');var $unhighlighted=$picker.find('.note-dimension-picker-unhighlighted');var posOffset;// HTML5 with jQuery - e.offsetX is undefined in Firefox\nif(event.offsetX===undefined){var posCatcher=$(event.target).offset();posOffset={x:event.pageX-posCatcher.left,y:event.pageY-posCatcher.top};}else{posOffset={x:event.offsetX,y:event.offsetY};}var dim={c:Math.ceil(posOffset.x/PX_PER_EM)||1,r:Math.ceil(posOffset.y/PX_PER_EM)||1};$highlighted.css({width:dim.c+'em',height:dim.r+'em'});$catcher.data('value',dim.c+'x'+dim.r);if(3<dim.c&&dim.c<options.insertTableMaxSize.col){$unhighlighted.css({width:dim.c+1+'em'});}if(3<dim.r&&dim.r<options.insertTableMaxSize.row){$unhighlighted.css({height:dim.r+1+'em'});}$dimensionDisplay.html(dim.c+' x '+dim.r);};};var Toolbar=function(context){var ui=$.summernote.ui;var $note=context.layoutInfo.note;var $toolbar=context.layoutInfo.toolbar;var options=context.options;this.shouldInitialize=function(){return!options.airMode;};this.initialize=function(){options.toolbar=options.toolbar||[];if(!options.toolbar.length){$toolbar.hide();}else{context.invoke('buttons.build',$toolbar,options.toolbar);}if(options.toolbarContainer){$toolbar.appendTo(options.toolbarContainer);}$note.on('summernote.keyup summernote.mouseup summernote.change',function(){context.invoke('buttons.updateCurrentStyle');});context.invoke('buttons.updateCurrentStyle');};this.destroy=function(){$toolbar.children().remove();};this.updateFullscreen=function(isFullscreen){ui.toggleBtnActive($toolbar.find('.btn-fullscreen'),isFullscreen);};this.updateCodeview=function(isCodeview){ui.toggleBtnActive($toolbar.find('.btn-codeview'),isCodeview);if(isCodeview){this.deactivate();}else{this.activate();}};this.activate=function(isIncludeCodeview){var $btn=$toolbar.find('button');if(!isIncludeCodeview){$btn=$btn.not('.btn-codeview');}ui.toggleBtn($btn,true);};this.deactivate=function(isIncludeCodeview){var $btn=$toolbar.find('button');if(!isIncludeCodeview){$btn=$btn.not('.btn-codeview');}ui.toggleBtn($btn,false);};};var LinkDialog=function(context){var self=this;var ui=$.summernote.ui;var $editor=context.layoutInfo.editor;var options=context.options;var lang=options.langInfo;this.initialize=function(){var $container=options.dialogsInBody?$(document.body):$editor;var body='<div class=\"form-group\">'+'<label>'+lang.link.textToDisplay+'</label>'+'<input class=\"note-link-text form-control\" type=\"text\" />'+'</div>'+'<div class=\"form-group\">'+'<label>'+lang.link.url+'</label>'+'<input class=\"note-link-url form-control\" type=\"text\" value=\"http://\" />'+'</div>'+(!options.disableLinkTarget?'<div class=\"checkbox\">'+'<label>'+'<input type=\"checkbox\" checked> '+lang.link.openInNewWindow+'</label>'+'</div>':'');var footer='<button href=\"#\" class=\"btn btn-primary note-link-btn disabled\" disabled>'+lang.link.insert+'</button>';this.$dialog=ui.dialog({className:'link-dialog',title:lang.link.insert,fade:options.dialogsFade,body:body,footer:footer}).render().appendTo($container);};this.destroy=function(){ui.hideDialog(this.$dialog);this.$dialog.remove();};this.bindEnterKey=function($input,$btn){$input.on('keypress',function(event){if(event.keyCode===key.code.ENTER){$btn.trigger('click');}});};/**\n     * toggle update button\n     */this.toggleLinkBtn=function($linkBtn,$linkText,$linkUrl){ui.toggleBtn($linkBtn,$linkText.val()&&$linkUrl.val());};/**\n     * Show link dialog and set event handlers on dialog controls.\n     *\n     * @param {Object} linkInfo\n     * @return {Promise}\n     */this.showLinkDialog=function(linkInfo){return $.Deferred(function(deferred){var $linkText=self.$dialog.find('.note-link-text'),$linkUrl=self.$dialog.find('.note-link-url'),$linkBtn=self.$dialog.find('.note-link-btn'),$openInNewWindow=self.$dialog.find('input[type=checkbox]');ui.onDialogShown(self.$dialog,function(){context.triggerEvent('dialog.shown');// if no url was given, copy text to url\nif(!linkInfo.url){linkInfo.url=linkInfo.text;}$linkText.val(linkInfo.text);var handleLinkTextUpdate=function(){self.toggleLinkBtn($linkBtn,$linkText,$linkUrl);// if linktext was modified by keyup,\n// stop cloning text from linkUrl\nlinkInfo.text=$linkText.val();};$linkText.on('input',handleLinkTextUpdate).on('paste',function(){setTimeout(handleLinkTextUpdate,0);});var handleLinkUrlUpdate=function(){self.toggleLinkBtn($linkBtn,$linkText,$linkUrl);// display same link on `Text to display` input\n// when create a new link\nif(!linkInfo.text){$linkText.val($linkUrl.val());}};$linkUrl.on('input',handleLinkUrlUpdate).on('paste',function(){setTimeout(handleLinkUrlUpdate,0);}).val(linkInfo.url).trigger('focus');self.toggleLinkBtn($linkBtn,$linkText,$linkUrl);self.bindEnterKey($linkUrl,$linkBtn);self.bindEnterKey($linkText,$linkBtn);$openInNewWindow.prop('checked',linkInfo.isNewWindow);$linkBtn.one('click',function(event){event.preventDefault();deferred.resolve({range:linkInfo.range,url:$linkUrl.val(),text:$linkText.val(),isNewWindow:$openInNewWindow.is(':checked')});self.$dialog.modal('hide');});});ui.onDialogHidden(self.$dialog,function(){// detach events\n$linkText.off('input paste keypress');$linkUrl.off('input paste keypress');$linkBtn.off('click');if(deferred.state()==='pending'){deferred.reject();}});ui.showDialog(self.$dialog);}).promise();};/**\n     * @param {Object} layoutInfo\n     */this.show=function(){var linkInfo=context.invoke('editor.getLinkInfo');context.invoke('editor.saveRange');this.showLinkDialog(linkInfo).then(function(linkInfo){context.invoke('editor.restoreRange');context.invoke('editor.createLink',linkInfo);}).fail(function(){context.invoke('editor.restoreRange');});};context.memo('help.linkDialog.show',options.langInfo.help['linkDialog.show']);};var LinkPopover=function(context){var self=this;var ui=$.summernote.ui;var options=context.options;this.events={'summernote.keyup summernote.mouseup summernote.change summernote.scroll':function(){self.update();},'summernote.dialog.shown':function(){self.hide();}};this.shouldInitialize=function(){return!list.isEmpty(options.popover.link);};this.initialize=function(){this.$popover=ui.popover({className:'note-link-popover',callback:function($node){var $content=$node.find('.popover-content');$content.prepend('<span><a target=\"_blank\"></a>&nbsp;</span>');}}).render().appendTo('body');var $content=this.$popover.find('.popover-content');context.invoke('buttons.build',$content,options.popover.link);};this.destroy=function(){this.$popover.remove();};this.update=function(){// Prevent focusing on editable when invoke('code') is executed\nif(!context.invoke('editor.hasFocus')){this.hide();return;}var rng=context.invoke('editor.createRange');if(rng.isCollapsed()&&rng.isOnAnchor()){var anchor=dom.ancestor(rng.sc,dom.isAnchor);var href=$(anchor).attr('href');this.$popover.find('a').attr('href',href).html(href);var pos=dom.posFromPlaceholder(anchor);this.$popover.css({display:'block',left:pos.left,top:pos.top});}else{this.hide();}};this.hide=function(){this.$popover.hide();};};var ImageDialog=function(context){var self=this;var ui=$.summernote.ui;var $editor=context.layoutInfo.editor;var options=context.options;var lang=options.langInfo;this.initialize=function(){var $container=options.dialogsInBody?$(document.body):$editor;var imageLimitation='';if(options.maximumImageFileSize){var unit=Math.floor(Math.log(options.maximumImageFileSize)/Math.log(1024));var readableSize=(options.maximumImageFileSize/Math.pow(1024,unit)).toFixed(2)*1+' '+' KMGTP'[unit]+'B';imageLimitation='<small>'+lang.image.maximumFileSize+' : '+readableSize+'</small>';}var body='<div class=\"form-group note-group-select-from-files\">'+'<label>'+lang.image.selectFromFiles+'</label>'+'<input class=\"note-image-input form-control\" type=\"file\" name=\"files\" accept=\"image/*\" multiple=\"multiple\" />'+imageLimitation+'</div>'+'<div class=\"form-group note-group-image-url\" style=\"overflow:auto;\">'+'<label>'+lang.image.url+'</label>'+'<input class=\"note-image-url form-control col-md-12\" type=\"text\" />'+'</div>';var footer='<button href=\"#\" class=\"btn btn-primary note-image-btn disabled\" disabled>'+lang.image.insert+'</button>';this.$dialog=ui.dialog({title:lang.image.insert,fade:options.dialogsFade,body:body,footer:footer}).render().appendTo($container);};this.destroy=function(){ui.hideDialog(this.$dialog);this.$dialog.remove();};this.bindEnterKey=function($input,$btn){$input.on('keypress',function(event){if(event.keyCode===key.code.ENTER){$btn.trigger('click');}});};this.show=function(){context.invoke('editor.saveRange');this.showImageDialog().then(function(data){// [workaround] hide dialog before restore range for IE range focus\nui.hideDialog(self.$dialog);context.invoke('editor.restoreRange');if(typeof data==='string'){// image url\ncontext.invoke('editor.insertImage',data);}else{// array of files\ncontext.invoke('editor.insertImagesOrCallback',data);}}).fail(function(){context.invoke('editor.restoreRange');});};/**\n     * show image dialog\n     *\n     * @param {jQuery} $dialog\n     * @return {Promise}\n     */this.showImageDialog=function(){return $.Deferred(function(deferred){var $imageInput=self.$dialog.find('.note-image-input'),$imageUrl=self.$dialog.find('.note-image-url'),$imageBtn=self.$dialog.find('.note-image-btn');ui.onDialogShown(self.$dialog,function(){context.triggerEvent('dialog.shown');// Cloning imageInput to clear element.\n$imageInput.replaceWith($imageInput.clone().on('change',function(){deferred.resolve(this.files||this.value);}).val(''));$imageBtn.click(function(event){event.preventDefault();deferred.resolve($imageUrl.val());});$imageUrl.on('keyup paste',function(){var url=$imageUrl.val();ui.toggleBtn($imageBtn,url);}).val('').trigger('focus');self.bindEnterKey($imageUrl,$imageBtn);});ui.onDialogHidden(self.$dialog,function(){$imageInput.off('change');$imageUrl.off('keyup paste keypress');$imageBtn.off('click');if(deferred.state()==='pending'){deferred.reject();}});ui.showDialog(self.$dialog);});};};var ImagePopover=function(context){var ui=$.summernote.ui;var options=context.options;this.shouldInitialize=function(){return!list.isEmpty(options.popover.image);};this.initialize=function(){this.$popover=ui.popover({className:'note-image-popover'}).render().appendTo('body');var $content=this.$popover.find('.popover-content');context.invoke('buttons.build',$content,options.popover.image);};this.destroy=function(){this.$popover.remove();};this.update=function(target){if(dom.isImg(target)){var pos=dom.posFromPlaceholder(target);this.$popover.css({display:'block',left:pos.left,top:pos.top});}else{this.hide();}};this.hide=function(){this.$popover.hide();};};var VideoDialog=function(context){var self=this;var ui=$.summernote.ui;var $editor=context.layoutInfo.editor;var options=context.options;var lang=options.langInfo;this.initialize=function(){var $container=options.dialogsInBody?$(document.body):$editor;var body='<div class=\"form-group row-fluid\">'+'<label>'+lang.video.url+' <small class=\"text-muted\">'+lang.video.providers+'</small></label>'+'<input class=\"note-video-url form-control span12\" type=\"text\" />'+'</div>';var footer='<button href=\"#\" class=\"btn btn-primary note-video-btn disabled\" disabled>'+lang.video.insert+'</button>';this.$dialog=ui.dialog({title:lang.video.insert,fade:options.dialogsFade,body:body,footer:footer}).render().appendTo($container);};this.destroy=function(){ui.hideDialog(this.$dialog);this.$dialog.remove();};this.bindEnterKey=function($input,$btn){$input.on('keypress',function(event){if(event.keyCode===key.code.ENTER){$btn.trigger('click');}});};this.createVideoNode=function(url){// video url patterns(youtube, instagram, vimeo, dailymotion, youku, mp4, ogg, webm)\nvar ytRegExp=/^(?:https?:\\/\\/)?(?:www\\.)?(?:youtu\\.be\\/|youtube\\.com\\/(?:embed\\/|v\\/|watch\\?v=|watch\\?.+&v=))((\\w|-){11})(?:\\S+)?$/;var ytMatch=url.match(ytRegExp);var igRegExp=/(?:www\\.|\\/\\/)instagram\\.com\\/p\\/(.[a-zA-Z0-9_-]*)/;var igMatch=url.match(igRegExp);var vRegExp=/\\/\\/vine\\.co\\/v\\/([a-zA-Z0-9]+)/;var vMatch=url.match(vRegExp);var vimRegExp=/\\/\\/(player\\.)?vimeo\\.com\\/([a-z]*\\/)*([0-9]{6,11})[?]?.*/;var vimMatch=url.match(vimRegExp);var dmRegExp=/.+dailymotion.com\\/(video|hub)\\/([^_]+)[^#]*(#video=([^_&]+))?/;var dmMatch=url.match(dmRegExp);var youkuRegExp=/\\/\\/v\\.youku\\.com\\/v_show\\/id_(\\w+)=*\\.html/;var youkuMatch=url.match(youkuRegExp);var mp4RegExp=/^.+.(mp4|m4v)$/;var mp4Match=url.match(mp4RegExp);var oggRegExp=/^.+.(ogg|ogv)$/;var oggMatch=url.match(oggRegExp);var webmRegExp=/^.+.(webm)$/;var webmMatch=url.match(webmRegExp);var $video;if(ytMatch&&ytMatch[1].length===11){var youtubeId=ytMatch[1];$video=$('<iframe>').attr('frameborder',0).attr('src','//www.youtube.com/embed/'+youtubeId).attr('width','640').attr('height','360');}else if(igMatch&&igMatch[0].length){$video=$('<iframe>').attr('frameborder',0).attr('src','https://instagram.com/p/'+igMatch[1]+'/embed/').attr('width','612').attr('height','710').attr('scrolling','no').attr('allowtransparency','true');}else if(vMatch&&vMatch[0].length){$video=$('<iframe>').attr('frameborder',0).attr('src',vMatch[0]+'/embed/simple').attr('width','600').attr('height','600').attr('class','vine-embed');}else if(vimMatch&&vimMatch[3].length){$video=$('<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>').attr('frameborder',0).attr('src','//player.vimeo.com/video/'+vimMatch[3]).attr('width','640').attr('height','360');}else if(dmMatch&&dmMatch[2].length){$video=$('<iframe>').attr('frameborder',0).attr('src','//www.dailymotion.com/embed/video/'+dmMatch[2]).attr('width','640').attr('height','360');}else if(youkuMatch&&youkuMatch[1].length){$video=$('<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>').attr('frameborder',0).attr('height','498').attr('width','510').attr('src','//player.youku.com/embed/'+youkuMatch[1]);}else if(mp4Match||oggMatch||webmMatch){$video=$('<video controls>').attr('src',url).attr('width','640').attr('height','360');}else{// this is not a known video link. Now what, Cat? Now what?\nreturn false;}$video.addClass('note-video-clip');return $video[0];};this.show=function(){var text=context.invoke('editor.getSelectedText');context.invoke('editor.saveRange');this.showVideoDialog(text).then(function(url){// [workaround] hide dialog before restore range for IE range focus\nui.hideDialog(self.$dialog);context.invoke('editor.restoreRange');// build node\nvar $node=self.createVideoNode(url);if($node){// insert video node\ncontext.invoke('editor.insertNode',$node);}}).fail(function(){context.invoke('editor.restoreRange');});};/**\n     * show image dialog\n     *\n     * @param {jQuery} $dialog\n     * @return {Promise}\n     */this.showVideoDialog=function(text){return $.Deferred(function(deferred){var $videoUrl=self.$dialog.find('.note-video-url'),$videoBtn=self.$dialog.find('.note-video-btn');ui.onDialogShown(self.$dialog,function(){context.triggerEvent('dialog.shown');$videoUrl.val(text).on('input',function(){ui.toggleBtn($videoBtn,$videoUrl.val());}).trigger('focus');$videoBtn.click(function(event){event.preventDefault();deferred.resolve($videoUrl.val());});self.bindEnterKey($videoUrl,$videoBtn);});ui.onDialogHidden(self.$dialog,function(){$videoUrl.off('input');$videoBtn.off('click');if(deferred.state()==='pending'){deferred.reject();}});ui.showDialog(self.$dialog);});};};var HelpDialog=function(context){var self=this;var ui=$.summernote.ui;var $editor=context.layoutInfo.editor;var options=context.options;var lang=options.langInfo;this.createShortCutList=function(){var keyMap=options.keyMap[agent.isMac?'mac':'pc'];return Object.keys(keyMap).map(function(key){var command=keyMap[key];var $row=$('<div><div class=\"help-list-item\"/></div>');$row.append($('<label><kbd>'+key+'</kdb></label>').css({'width':180,'margin-right':10})).append($('<span/>').html(context.memo('help.'+command)||command));return $row.html();}).join('');};this.initialize=function(){var $container=options.dialogsInBody?$(document.body):$editor;var body=['<p class=\"text-center\">','<a href=\"http://summernote.org/\" target=\"_blank\">Summernote 0.8.2</a>  ','<a href=\"https://github.com/summernote/summernote\" target=\"_blank\">Project</a>  ','<a href=\"https://github.com/summernote/summernote/issues\" target=\"_blank\">Issues</a>','</p>'].join('');this.$dialog=ui.dialog({title:lang.options.help,fade:options.dialogsFade,body:this.createShortCutList(),footer:body,callback:function($node){$node.find('.modal-body').css({'max-height':300,'overflow':'scroll'});}}).render().appendTo($container);};this.destroy=function(){ui.hideDialog(this.$dialog);this.$dialog.remove();};/**\n     * show help dialog\n     *\n     * @return {Promise}\n     */this.showHelpDialog=function(){return $.Deferred(function(deferred){ui.onDialogShown(self.$dialog,function(){context.triggerEvent('dialog.shown');deferred.resolve();});ui.showDialog(self.$dialog);}).promise();};this.show=function(){context.invoke('editor.saveRange');this.showHelpDialog().then(function(){context.invoke('editor.restoreRange');});};};var AirPopover=function(context){var self=this;var ui=$.summernote.ui;var options=context.options;var AIR_MODE_POPOVER_X_OFFSET=20;this.events={'summernote.keyup summernote.mouseup summernote.scroll':function(){self.update();},'summernote.change summernote.dialog.shown':function(){self.hide();},'summernote.focusout':function(we,e){// [workaround] Firefox doesn't support relatedTarget on focusout\n//  - Ignore hide action on focus out in FF.\nif(agent.isFF){return;}if(!e.relatedTarget||!dom.ancestor(e.relatedTarget,func.eq(self.$popover[0]))){self.hide();}}};this.shouldInitialize=function(){return options.airMode&&!list.isEmpty(options.popover.air);};this.initialize=function(){this.$popover=ui.popover({className:'note-air-popover'}).render().appendTo('body');var $content=this.$popover.find('.popover-content');context.invoke('buttons.build',$content,options.popover.air);};this.destroy=function(){this.$popover.remove();};this.update=function(){var styleInfo=context.invoke('editor.currentStyle');if(styleInfo.range&&!styleInfo.range.isCollapsed()){var rect=list.last(styleInfo.range.getClientRects());if(rect){var bnd=func.rect2bnd(rect);this.$popover.css({display:'block',left:Math.max(bnd.left+bnd.width/2,0)-AIR_MODE_POPOVER_X_OFFSET,top:bnd.top+bnd.height});}}else{this.hide();}};this.hide=function(){this.$popover.hide();};};var HintPopover=function(context){var self=this;var ui=$.summernote.ui;var POPOVER_DIST=5;var hint=context.options.hint||[];var direction=context.options.hintDirection||'bottom';var hints=$.isArray(hint)?hint:[hint];this.events={'summernote.keyup':function(we,e){if(!e.isDefaultPrevented()){self.handleKeyup(e);}},'summernote.keydown':function(we,e){self.handleKeydown(e);},'summernote.dialog.shown':function(){self.hide();}};this.shouldInitialize=function(){return hints.length>0;};this.initialize=function(){this.lastWordRange=null;this.$popover=ui.popover({className:'note-hint-popover',hideArrow:true,direction:''}).render().appendTo('body');this.$popover.hide();this.$content=this.$popover.find('.popover-content');this.$content.on('click','.note-hint-item',function(){self.$content.find('.active').removeClass('active');$(this).addClass('active');self.replace();});};this.destroy=function(){this.$popover.remove();};this.selectItem=function($item){this.$content.find('.active').removeClass('active');$item.addClass('active');this.$content[0].scrollTop=$item[0].offsetTop-this.$content.innerHeight()/2;};this.moveDown=function(){var $current=this.$content.find('.note-hint-item.active');var $next=$current.next();if($next.length){this.selectItem($next);}else{var $nextGroup=$current.parent().next();if(!$nextGroup.length){$nextGroup=this.$content.find('.note-hint-group').first();}this.selectItem($nextGroup.find('.note-hint-item').first());}};this.moveUp=function(){var $current=this.$content.find('.note-hint-item.active');var $prev=$current.prev();if($prev.length){this.selectItem($prev);}else{var $prevGroup=$current.parent().prev();if(!$prevGroup.length){$prevGroup=this.$content.find('.note-hint-group').last();}this.selectItem($prevGroup.find('.note-hint-item').last());}};this.replace=function(){var $item=this.$content.find('.note-hint-item.active');if($item.length){var node=this.nodeFromItem($item);this.lastWordRange.insertNode(node);range.createFromNode(node).collapse().select();this.lastWordRange=null;this.hide();context.invoke('editor.focus');}};this.nodeFromItem=function($item){var hint=hints[$item.data('index')];var item=$item.data('item');var node=hint.content?hint.content(item):item;if(typeof node==='string'){node=dom.createText(node);}return node;};this.createItemTemplates=function(hintIdx,items){var hint=hints[hintIdx];return items.map(function(item,idx){var $item=$('<div class=\"note-hint-item\"/>');$item.append(hint.template?hint.template(item):item+'');$item.data({'index':hintIdx,'item':item});if(hintIdx===0&&idx===0){$item.addClass('active');}return $item;});};this.handleKeydown=function(e){if(!this.$popover.is(':visible')){return;}if(e.keyCode===key.code.ENTER){e.preventDefault();this.replace();}else if(e.keyCode===key.code.UP){e.preventDefault();this.moveUp();}else if(e.keyCode===key.code.DOWN){e.preventDefault();this.moveDown();}};this.searchKeyword=function(index,keyword,callback){var hint=hints[index];if(hint&&hint.match.test(keyword)&&hint.search){var matches=hint.match.exec(keyword);hint.search(matches[1],callback);}else{callback();}};this.createGroup=function(idx,keyword){var $group=$('<div class=\"note-hint-group note-hint-group-'+idx+'\"/>');this.searchKeyword(idx,keyword,function(items){items=items||[];if(items.length){$group.html(self.createItemTemplates(idx,items));self.show();}});return $group;};this.handleKeyup=function(e){if(list.contains([key.code.ENTER,key.code.UP,key.code.DOWN],e.keyCode)){if(e.keyCode===key.code.ENTER){if(this.$popover.is(':visible')){return;}}}else{var wordRange=context.invoke('editor.createRange').getWordRange();var keyword=wordRange.toString();if(hints.length&&keyword){this.$content.empty();var bnd=func.rect2bnd(list.last(wordRange.getClientRects()));if(bnd){this.$popover.hide();this.lastWordRange=wordRange;hints.forEach(function(hint,idx){if(hint.match.test(keyword)){self.createGroup(idx,keyword).appendTo(self.$content);}});// set position for popover after group is created\nif(direction==='top'){this.$popover.css({left:bnd.left,top:bnd.top-this.$popover.outerHeight()-POPOVER_DIST});}else{this.$popover.css({left:bnd.left,top:bnd.top+bnd.height+POPOVER_DIST});}}}else{this.hide();}}};this.show=function(){this.$popover.show();};this.hide=function(){this.$popover.hide();};};$.summernote=$.extend($.summernote,{version:'0.8.2',ui:ui,dom:dom,plugins:{},options:{modules:{'editor':Editor,'clipboard':Clipboard,'dropzone':Dropzone,'codeview':Codeview,'statusbar':Statusbar,'fullscreen':Fullscreen,'handle':Handle,// FIXME: HintPopover must be front of autolink\n//  - Script error about range when Enter key is pressed on hint popover\n'hintPopover':HintPopover,'autoLink':AutoLink,'autoSync':AutoSync,'placeholder':Placeholder,'buttons':Buttons,'toolbar':Toolbar,'linkDialog':LinkDialog,'linkPopover':LinkPopover,'imageDialog':ImageDialog,'imagePopover':ImagePopover,'videoDialog':VideoDialog,'helpDialog':HelpDialog,'airPopover':AirPopover},buttons:{},lang:'en-US',// toolbar\ntoolbar:[['style',['style']],['font',['bold','underline','clear']],['fontname',['fontname']],['color',['color']],['para',['ul','ol','paragraph']],['table',['table']],['insert',['link','picture','video']],['view',['fullscreen','codeview','help']]],// popover\npopover:{image:[['imagesize',['imageSize100','imageSize50','imageSize25']],['float',['floatLeft','floatRight','floatNone']],['remove',['removeMedia']]],link:[['link',['linkDialogShow','unlink']]],air:[['color',['color']],['font',['bold','underline','clear']],['para',['ul','paragraph']],['table',['table']],['insert',['link','picture']]]},// air mode: inline editor\nairMode:false,width:null,height:null,focus:false,tabSize:4,styleWithSpan:true,shortcuts:true,textareaAutoSync:true,direction:null,styleTags:['p','blockquote','pre','h1','h2','h3','h4','h5','h6'],fontNames:['Arial','Arial Black','Comic Sans MS','Courier New','Helvetica Neue','Helvetica','Impact','Lucida Grande','Tahoma','Times New Roman','Verdana'],fontSizes:['8','9','10','11','12','14','18','24','36'],// pallete colors(n x n)\ncolors:[['#000000','#424242','#636363','#9C9C94','#CEC6CE','#EFEFEF','#F7F7F7','#FFFFFF'],['#FF0000','#FF9C00','#FFFF00','#00FF00','#00FFFF','#0000FF','#9C00FF','#FF00FF'],['#F7C6CE','#FFE7CE','#FFEFC6','#D6EFD6','#CEDEE7','#CEE7F7','#D6D6E7','#E7D6DE'],['#E79C9C','#FFC69C','#FFE79C','#B5D6A5','#A5C6CE','#9CC6EF','#B5A5D6','#D6A5BD'],['#E76363','#F7AD6B','#FFD663','#94BD7B','#73A5AD','#6BADDE','#8C7BC6','#C67BA5'],['#CE0000','#E79439','#EFC631','#6BA54A','#4A7B8C','#3984C6','#634AA5','#A54A7B'],['#9C0000','#B56308','#BD9400','#397B21','#104A5A','#085294','#311873','#731842'],['#630000','#7B3900','#846300','#295218','#083139','#003163','#21104A','#4A1031']],lineHeights:['1.0','1.2','1.4','1.5','1.6','1.8','2.0','3.0'],tableClassName:'table table-bordered',insertTableMaxSize:{col:10,row:10},dialogsInBody:false,dialogsFade:false,maximumImageFileSize:null,callbacks:{onInit:null,onFocus:null,onBlur:null,onEnter:null,onKeyup:null,onKeydown:null,onImageUpload:null,onImageUploadError:null},codemirror:{mode:'text/html',htmlMode:true,lineNumbers:true},keyMap:{pc:{'ENTER':'insertParagraph','CTRL+Z':'undo','CTRL+Y':'redo','TAB':'tab','SHIFT+TAB':'untab','CTRL+B':'bold','CTRL+I':'italic','CTRL+U':'underline','CTRL+SHIFT+S':'strikethrough','CTRL+BACKSLASH':'removeFormat','CTRL+SHIFT+L':'justifyLeft','CTRL+SHIFT+E':'justifyCenter','CTRL+SHIFT+R':'justifyRight','CTRL+SHIFT+J':'justifyFull','CTRL+SHIFT+NUM7':'insertUnorderedList','CTRL+SHIFT+NUM8':'insertOrderedList','CTRL+LEFTBRACKET':'outdent','CTRL+RIGHTBRACKET':'indent','CTRL+NUM0':'formatPara','CTRL+NUM1':'formatH1','CTRL+NUM2':'formatH2','CTRL+NUM3':'formatH3','CTRL+NUM4':'formatH4','CTRL+NUM5':'formatH5','CTRL+NUM6':'formatH6','CTRL+ENTER':'insertHorizontalRule','CTRL+K':'linkDialog.show'},mac:{'ENTER':'insertParagraph','CMD+Z':'undo','CMD+SHIFT+Z':'redo','TAB':'tab','SHIFT+TAB':'untab','CMD+B':'bold','CMD+I':'italic','CMD+U':'underline','CMD+SHIFT+S':'strikethrough','CMD+BACKSLASH':'removeFormat','CMD+SHIFT+L':'justifyLeft','CMD+SHIFT+E':'justifyCenter','CMD+SHIFT+R':'justifyRight','CMD+SHIFT+J':'justifyFull','CMD+SHIFT+NUM7':'insertUnorderedList','CMD+SHIFT+NUM8':'insertOrderedList','CMD+LEFTBRACKET':'outdent','CMD+RIGHTBRACKET':'indent','CMD+NUM0':'formatPara','CMD+NUM1':'formatH1','CMD+NUM2':'formatH2','CMD+NUM3':'formatH3','CMD+NUM4':'formatH4','CMD+NUM5':'formatH5','CMD+NUM6':'formatH6','CMD+ENTER':'insertHorizontalRule','CMD+K':'linkDialog.show'}},icons:{'align':'note-icon-align','alignCenter':'note-icon-align-center','alignJustify':'note-icon-align-justify','alignLeft':'note-icon-align-left','alignRight':'note-icon-align-right','indent':'note-icon-align-indent','outdent':'note-icon-align-outdent','arrowsAlt':'note-icon-arrows-alt','bold':'note-icon-bold','caret':'note-icon-caret','circle':'note-icon-circle','close':'note-icon-close','code':'note-icon-code','eraser':'note-icon-eraser','font':'note-icon-font','frame':'note-icon-frame','italic':'note-icon-italic','link':'note-icon-link','unlink':'note-icon-chain-broken','magic':'note-icon-magic','menuCheck':'note-icon-check','minus':'note-icon-minus','orderedlist':'note-icon-orderedlist','pencil':'note-icon-pencil','picture':'note-icon-picture','question':'note-icon-question','redo':'note-icon-redo','square':'note-icon-square','strikethrough':'note-icon-strikethrough','subscript':'note-icon-subscript','superscript':'note-icon-superscript','table':'note-icon-table','textHeight':'note-icon-text-height','trash':'note-icon-trash','underline':'note-icon-underline','undo':'note-icon-undo','unorderedlist':'note-icon-unorderedlist','video':'note-icon-video'}}});});//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTM4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vfi9zdW1tZXJub3RlL2Rpc3Qvc3VtbWVybm90ZS5qcz8xNTVhIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogU3VwZXIgc2ltcGxlIHd5c2l3eWcgZWRpdG9yIHYwLjguMlxuICogaHR0cDovL3N1bW1lcm5vdGUub3JnL1xuICpcbiAqIHN1bW1lcm5vdGUuanNcbiAqIENvcHlyaWdodCAyMDEzLTIwMTYgQWxhbiBIb25nLiBhbmQgb3RoZXIgY29udHJpYnV0b3JzXG4gKiBzdW1tZXJub3RlIG1heSBiZSBmcmVlbHkgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLi9cbiAqXG4gKiBEYXRlOiAyMDE2LTA4LTA3VDA1OjExWlxuICovKGZ1bmN0aW9uKGZhY3Rvcnkpey8qIGdsb2JhbCBkZWZpbmUgKi9pZih0eXBlb2YgZGVmaW5lPT09J2Z1bmN0aW9uJyYmZGVmaW5lLmFtZCl7Ly8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxuZGVmaW5lKFsnanF1ZXJ5J10sZmFjdG9yeSk7fWVsc2UgaWYodHlwZW9mIG1vZHVsZT09PSdvYmplY3QnJiZtb2R1bGUuZXhwb3J0cyl7Ly8gTm9kZS9Db21tb25KU1xubW9kdWxlLmV4cG9ydHM9ZmFjdG9yeShyZXF1aXJlKCdqcXVlcnknKSk7fWVsc2V7Ly8gQnJvd3NlciBnbG9iYWxzXG5mYWN0b3J5KHdpbmRvdy5qUXVlcnkpO319KShmdW5jdGlvbigkKXsndXNlIHN0cmljdCc7LyoqXG4gICAqIEBjbGFzcyBjb3JlLmZ1bmNcbiAgICpcbiAgICogZnVuYyB1dGlscyAoZm9yIGhpZ2gtb3JkZXIgZnVuYydzIGFyZylcbiAgICpcbiAgICogQHNpbmdsZXRvblxuICAgKiBAYWx0ZXJuYXRlQ2xhc3NOYW1lIGZ1bmNcbiAgICovdmFyIGZ1bmM9ZnVuY3Rpb24oKXt2YXIgZXE9ZnVuY3Rpb24oaXRlbUEpe3JldHVybiBmdW5jdGlvbihpdGVtQil7cmV0dXJuIGl0ZW1BPT09aXRlbUI7fTt9O3ZhciBlcTI9ZnVuY3Rpb24oaXRlbUEsaXRlbUIpe3JldHVybiBpdGVtQT09PWl0ZW1CO307dmFyIHBlcTI9ZnVuY3Rpb24ocHJvcE5hbWUpe3JldHVybiBmdW5jdGlvbihpdGVtQSxpdGVtQil7cmV0dXJuIGl0ZW1BW3Byb3BOYW1lXT09PWl0ZW1CW3Byb3BOYW1lXTt9O307dmFyIG9rPWZ1bmN0aW9uKCl7cmV0dXJuIHRydWU7fTt2YXIgZmFpbD1mdW5jdGlvbigpe3JldHVybiBmYWxzZTt9O3ZhciBub3Q9ZnVuY3Rpb24oZil7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIWYuYXBwbHkoZixhcmd1bWVudHMpO307fTt2YXIgYW5kPWZ1bmN0aW9uKGZBLGZCKXtyZXR1cm4gZnVuY3Rpb24oaXRlbSl7cmV0dXJuIGZBKGl0ZW0pJiZmQihpdGVtKTt9O307dmFyIHNlbGY9ZnVuY3Rpb24oYSl7cmV0dXJuIGE7fTt2YXIgaW52b2tlPWZ1bmN0aW9uKG9iaixtZXRob2Qpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiBvYmpbbWV0aG9kXS5hcHBseShvYmosYXJndW1lbnRzKTt9O307dmFyIGlkQ291bnRlcj0wOy8qKlxuICAgICAqIGdlbmVyYXRlIGEgZ2xvYmFsbHktdW5pcXVlIGlkXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW3ByZWZpeF1cbiAgICAgKi92YXIgdW5pcXVlSWQ9ZnVuY3Rpb24ocHJlZml4KXt2YXIgaWQ9KytpZENvdW50ZXIrJyc7cmV0dXJuIHByZWZpeD9wcmVmaXgraWQ6aWQ7fTsvKipcbiAgICAgKiByZXR1cm5zIGJuZCAoYm91bmRzKSBmcm9tIHJlY3RcbiAgICAgKlxuICAgICAqIC0gSUUgQ29tcGF0aWJpbGl0eSBJc3N1ZTogaHR0cDovL2dvby5nbC9zUkxPQW9cbiAgICAgKiAtIFNjcm9sbCBJc3N1ZTogaHR0cDovL2dvby5nbC9zTmpVY1xuICAgICAqXG4gICAgICogQHBhcmFtIHtSZWN0fSByZWN0XG4gICAgICogQHJldHVybiB7T2JqZWN0fSBib3VuZHNcbiAgICAgKiBAcmV0dXJuIHtOdW1iZXJ9IGJvdW5kcy50b3BcbiAgICAgKiBAcmV0dXJuIHtOdW1iZXJ9IGJvdW5kcy5sZWZ0XG4gICAgICogQHJldHVybiB7TnVtYmVyfSBib3VuZHMud2lkdGhcbiAgICAgKiBAcmV0dXJuIHtOdW1iZXJ9IGJvdW5kcy5oZWlnaHRcbiAgICAgKi92YXIgcmVjdDJibmQ9ZnVuY3Rpb24ocmVjdCl7dmFyICRkb2N1bWVudD0kKGRvY3VtZW50KTtyZXR1cm57dG9wOnJlY3QudG9wKyRkb2N1bWVudC5zY3JvbGxUb3AoKSxsZWZ0OnJlY3QubGVmdCskZG9jdW1lbnQuc2Nyb2xsTGVmdCgpLHdpZHRoOnJlY3QucmlnaHQtcmVjdC5sZWZ0LGhlaWdodDpyZWN0LmJvdHRvbS1yZWN0LnRvcH07fTsvKipcbiAgICAgKiByZXR1cm5zIGEgY29weSBvZiB0aGUgb2JqZWN0IHdoZXJlIHRoZSBrZXlzIGhhdmUgYmVjb21lIHRoZSB2YWx1ZXMgYW5kIHRoZSB2YWx1ZXMgdGhlIGtleXMuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9ialxuICAgICAqIEByZXR1cm4ge09iamVjdH1cbiAgICAgKi92YXIgaW52ZXJ0T2JqZWN0PWZ1bmN0aW9uKG9iail7dmFyIGludmVydGVkPXt9O2Zvcih2YXIga2V5IGluIG9iail7aWYob2JqLmhhc093blByb3BlcnR5KGtleSkpe2ludmVydGVkW29ialtrZXldXT1rZXk7fX1yZXR1cm4gaW52ZXJ0ZWQ7fTsvKipcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZXNwYWNlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtwcmVmaXhdXG4gICAgICogQHJldHVybiB7U3RyaW5nfVxuICAgICAqL3ZhciBuYW1lc3BhY2VUb0NhbWVsPWZ1bmN0aW9uKG5hbWVzcGFjZSxwcmVmaXgpe3ByZWZpeD1wcmVmaXh8fCcnO3JldHVybiBwcmVmaXgrbmFtZXNwYWNlLnNwbGl0KCcuJykubWFwKGZ1bmN0aW9uKG5hbWUpe3JldHVybiBuYW1lLnN1YnN0cmluZygwLDEpLnRvVXBwZXJDYXNlKCkrbmFtZS5zdWJzdHJpbmcoMSk7fSkuam9pbignJyk7fTsvKipcbiAgICAgKiBSZXR1cm5zIGEgZnVuY3Rpb24sIHRoYXQsIGFzIGxvbmcgYXMgaXQgY29udGludWVzIHRvIGJlIGludm9rZWQsIHdpbGwgbm90XG4gICAgICogYmUgdHJpZ2dlcmVkLiBUaGUgZnVuY3Rpb24gd2lsbCBiZSBjYWxsZWQgYWZ0ZXIgaXQgc3RvcHMgYmVpbmcgY2FsbGVkIGZvclxuICAgICAqIE4gbWlsbGlzZWNvbmRzLiBJZiBgaW1tZWRpYXRlYCBpcyBwYXNzZWQsIHRyaWdnZXIgdGhlIGZ1bmN0aW9uIG9uIHRoZVxuICAgICAqIGxlYWRpbmcgZWRnZSwgaW5zdGVhZCBvZiB0aGUgdHJhaWxpbmcuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuY1xuICAgICAqIEBwYXJhbSB7TnVtYmVyfSB3YWl0XG4gICAgICogQHBhcmFtIHtCb29sZWFufSBpbW1lZGlhdGVcbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn1cbiAgICAgKi92YXIgZGVib3VuY2U9ZnVuY3Rpb24oZnVuYyx3YWl0LGltbWVkaWF0ZSl7dmFyIHRpbWVvdXQ7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGNvbnRleHQ9dGhpcyxhcmdzPWFyZ3VtZW50czt2YXIgbGF0ZXI9ZnVuY3Rpb24oKXt0aW1lb3V0PW51bGw7aWYoIWltbWVkaWF0ZSl7ZnVuYy5hcHBseShjb250ZXh0LGFyZ3MpO319O3ZhciBjYWxsTm93PWltbWVkaWF0ZSYmIXRpbWVvdXQ7Y2xlYXJUaW1lb3V0KHRpbWVvdXQpO3RpbWVvdXQ9c2V0VGltZW91dChsYXRlcix3YWl0KTtpZihjYWxsTm93KXtmdW5jLmFwcGx5KGNvbnRleHQsYXJncyk7fX07fTtyZXR1cm57ZXE6ZXEsZXEyOmVxMixwZXEyOnBlcTIsb2s6b2ssZmFpbDpmYWlsLHNlbGY6c2VsZixub3Q6bm90LGFuZDphbmQsaW52b2tlOmludm9rZSx1bmlxdWVJZDp1bmlxdWVJZCxyZWN0MmJuZDpyZWN0MmJuZCxpbnZlcnRPYmplY3Q6aW52ZXJ0T2JqZWN0LG5hbWVzcGFjZVRvQ2FtZWw6bmFtZXNwYWNlVG9DYW1lbCxkZWJvdW5jZTpkZWJvdW5jZX07fSgpOy8qKlxuICAgKiBAY2xhc3MgY29yZS5saXN0XG4gICAqXG4gICAqIGxpc3QgdXRpbHNcbiAgICpcbiAgICogQHNpbmdsZXRvblxuICAgKiBAYWx0ZXJuYXRlQ2xhc3NOYW1lIGxpc3RcbiAgICovdmFyIGxpc3Q9ZnVuY3Rpb24oKXsvKipcbiAgICAgKiByZXR1cm5zIHRoZSBmaXJzdCBpdGVtIG9mIGFuIGFycmF5LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXlcbiAgICAgKi92YXIgaGVhZD1mdW5jdGlvbihhcnJheSl7cmV0dXJuIGFycmF5WzBdO307LyoqXG4gICAgICogcmV0dXJucyB0aGUgbGFzdCBpdGVtIG9mIGFuIGFycmF5LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXlcbiAgICAgKi92YXIgbGFzdD1mdW5jdGlvbihhcnJheSl7cmV0dXJuIGFycmF5W2FycmF5Lmxlbmd0aC0xXTt9Oy8qKlxuICAgICAqIHJldHVybnMgZXZlcnl0aGluZyBidXQgdGhlIGxhc3QgZW50cnkgb2YgdGhlIGFycmF5LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXlcbiAgICAgKi92YXIgaW5pdGlhbD1mdW5jdGlvbihhcnJheSl7cmV0dXJuIGFycmF5LnNsaWNlKDAsYXJyYXkubGVuZ3RoLTEpO307LyoqXG4gICAgICogcmV0dXJucyB0aGUgcmVzdCBvZiB0aGUgaXRlbXMgaW4gYW4gYXJyYXkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheVxuICAgICAqL3ZhciB0YWlsPWZ1bmN0aW9uKGFycmF5KXtyZXR1cm4gYXJyYXkuc2xpY2UoMSk7fTsvKipcbiAgICAgKiByZXR1cm5zIGl0ZW0gb2YgYXJyYXlcbiAgICAgKi92YXIgZmluZD1mdW5jdGlvbihhcnJheSxwcmVkKXtmb3IodmFyIGlkeD0wLGxlbj1hcnJheS5sZW5ndGg7aWR4PGxlbjtpZHgrKyl7dmFyIGl0ZW09YXJyYXlbaWR4XTtpZihwcmVkKGl0ZW0pKXtyZXR1cm4gaXRlbTt9fX07LyoqXG4gICAgICogcmV0dXJucyB0cnVlIGlmIGFsbCBvZiB0aGUgdmFsdWVzIGluIHRoZSBhcnJheSBwYXNzIHRoZSBwcmVkaWNhdGUgdHJ1dGggdGVzdC5cbiAgICAgKi92YXIgYWxsPWZ1bmN0aW9uKGFycmF5LHByZWQpe2Zvcih2YXIgaWR4PTAsbGVuPWFycmF5Lmxlbmd0aDtpZHg8bGVuO2lkeCsrKXtpZighcHJlZChhcnJheVtpZHhdKSl7cmV0dXJuIGZhbHNlO319cmV0dXJuIHRydWU7fTsvKipcbiAgICAgKiByZXR1cm5zIGluZGV4IG9mIGl0ZW1cbiAgICAgKi92YXIgaW5kZXhPZj1mdW5jdGlvbihhcnJheSxpdGVtKXtyZXR1cm4gJC5pbkFycmF5KGl0ZW0sYXJyYXkpO307LyoqXG4gICAgICogcmV0dXJucyB0cnVlIGlmIHRoZSB2YWx1ZSBpcyBwcmVzZW50IGluIHRoZSBsaXN0LlxuICAgICAqL3ZhciBjb250YWlucz1mdW5jdGlvbihhcnJheSxpdGVtKXtyZXR1cm4gaW5kZXhPZihhcnJheSxpdGVtKSE9PS0xO307LyoqXG4gICAgICogZ2V0IHN1bSBmcm9tIGEgbGlzdFxuICAgICAqXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgLSBhcnJheVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIC0gaXRlcmF0b3JcbiAgICAgKi92YXIgc3VtPWZ1bmN0aW9uKGFycmF5LGZuKXtmbj1mbnx8ZnVuYy5zZWxmO3JldHVybiBhcnJheS5yZWR1Y2UoZnVuY3Rpb24obWVtbyx2KXtyZXR1cm4gbWVtbytmbih2KTt9LDApO307LyoqXG4gICAgICogcmV0dXJucyBhIGNvcHkgb2YgdGhlIGNvbGxlY3Rpb24gd2l0aCBhcnJheSB0eXBlLlxuICAgICAqIEBwYXJhbSB7Q29sbGVjdGlvbn0gY29sbGVjdGlvbiAtIGNvbGxlY3Rpb24gZWcpIG5vZGUuY2hpbGROb2RlcywgLi4uXG4gICAgICovdmFyIGZyb209ZnVuY3Rpb24oY29sbGVjdGlvbil7dmFyIHJlc3VsdD1bXSxpZHg9LTEsbGVuZ3RoPWNvbGxlY3Rpb24ubGVuZ3RoO3doaWxlKCsraWR4PGxlbmd0aCl7cmVzdWx0W2lkeF09Y29sbGVjdGlvbltpZHhdO31yZXR1cm4gcmVzdWx0O307LyoqXG4gICAgICogcmV0dXJucyB3aGV0aGVyIGxpc3QgaXMgZW1wdHkgb3Igbm90XG4gICAgICovdmFyIGlzRW1wdHk9ZnVuY3Rpb24oYXJyYXkpe3JldHVybiFhcnJheXx8IWFycmF5Lmxlbmd0aDt9Oy8qKlxuICAgICAqIGNsdXN0ZXIgZWxlbWVudHMgYnkgcHJlZGljYXRlIGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgLSBhcnJheVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIC0gcHJlZGljYXRlIGZ1bmN0aW9uIGZvciBjbHVzdGVyIHJ1bGVcbiAgICAgKiBAcGFyYW0ge0FycmF5W119XG4gICAgICovdmFyIGNsdXN0ZXJCeT1mdW5jdGlvbihhcnJheSxmbil7aWYoIWFycmF5Lmxlbmd0aCl7cmV0dXJuW107fXZhciBhVGFpbD10YWlsKGFycmF5KTtyZXR1cm4gYVRhaWwucmVkdWNlKGZ1bmN0aW9uKG1lbW8sdil7dmFyIGFMYXN0PWxhc3QobWVtbyk7aWYoZm4obGFzdChhTGFzdCksdikpe2FMYXN0W2FMYXN0Lmxlbmd0aF09djt9ZWxzZXttZW1vW21lbW8ubGVuZ3RoXT1bdl07fXJldHVybiBtZW1vO30sW1toZWFkKGFycmF5KV1dKTt9Oy8qKlxuICAgICAqIHJldHVybnMgYSBjb3B5IG9mIHRoZSBhcnJheSB3aXRoIGFsbCBmYWxzZSB2YWx1ZXMgcmVtb3ZlZFxuICAgICAqXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgLSBhcnJheVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIC0gcHJlZGljYXRlIGZ1bmN0aW9uIGZvciBjbHVzdGVyIHJ1bGVcbiAgICAgKi92YXIgY29tcGFjdD1mdW5jdGlvbihhcnJheSl7dmFyIGFSZXN1bHQ9W107Zm9yKHZhciBpZHg9MCxsZW49YXJyYXkubGVuZ3RoO2lkeDxsZW47aWR4Kyspe2lmKGFycmF5W2lkeF0pe2FSZXN1bHQucHVzaChhcnJheVtpZHhdKTt9fXJldHVybiBhUmVzdWx0O307LyoqXG4gICAgICogcHJvZHVjZXMgYSBkdXBsaWNhdGUtZnJlZSB2ZXJzaW9uIG9mIHRoZSBhcnJheVxuICAgICAqXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXlcbiAgICAgKi92YXIgdW5pcXVlPWZ1bmN0aW9uKGFycmF5KXt2YXIgcmVzdWx0cz1bXTtmb3IodmFyIGlkeD0wLGxlbj1hcnJheS5sZW5ndGg7aWR4PGxlbjtpZHgrKyl7aWYoIWNvbnRhaW5zKHJlc3VsdHMsYXJyYXlbaWR4XSkpe3Jlc3VsdHMucHVzaChhcnJheVtpZHhdKTt9fXJldHVybiByZXN1bHRzO307LyoqXG4gICAgICogcmV0dXJucyBuZXh0IGl0ZW0uXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXlcbiAgICAgKi92YXIgbmV4dD1mdW5jdGlvbihhcnJheSxpdGVtKXt2YXIgaWR4PWluZGV4T2YoYXJyYXksaXRlbSk7aWYoaWR4PT09LTEpe3JldHVybiBudWxsO31yZXR1cm4gYXJyYXlbaWR4KzFdO307LyoqXG4gICAgICogcmV0dXJucyBwcmV2IGl0ZW0uXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXlcbiAgICAgKi92YXIgcHJldj1mdW5jdGlvbihhcnJheSxpdGVtKXt2YXIgaWR4PWluZGV4T2YoYXJyYXksaXRlbSk7aWYoaWR4PT09LTEpe3JldHVybiBudWxsO31yZXR1cm4gYXJyYXlbaWR4LTFdO307cmV0dXJue2hlYWQ6aGVhZCxsYXN0Omxhc3QsaW5pdGlhbDppbml0aWFsLHRhaWw6dGFpbCxwcmV2OnByZXYsbmV4dDpuZXh0LGZpbmQ6ZmluZCxjb250YWluczpjb250YWlucyxhbGw6YWxsLHN1bTpzdW0sZnJvbTpmcm9tLGlzRW1wdHk6aXNFbXB0eSxjbHVzdGVyQnk6Y2x1c3RlckJ5LGNvbXBhY3Q6Y29tcGFjdCx1bmlxdWU6dW5pcXVlfTt9KCk7dmFyIGlzU3VwcG9ydEFtZD10eXBlb2YgZGVmaW5lPT09J2Z1bmN0aW9uJyYmZGVmaW5lLmFtZDsvKipcbiAgICogcmV0dXJucyB3aGV0aGVyIGZvbnQgaXMgaW5zdGFsbGVkIG9yIG5vdC5cbiAgICpcbiAgICogQHBhcmFtIHtTdHJpbmd9IGZvbnROYW1lXG4gICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAqL3ZhciBpc0ZvbnRJbnN0YWxsZWQ9ZnVuY3Rpb24oZm9udE5hbWUpe3ZhciB0ZXN0Rm9udE5hbWU9Zm9udE5hbWU9PT0nQ29taWMgU2FucyBNUyc/J0NvdXJpZXIgTmV3JzonQ29taWMgU2FucyBNUyc7dmFyICR0ZXN0ZXI9JCgnPGRpdj4nKS5jc3Moe3Bvc2l0aW9uOidhYnNvbHV0ZScsbGVmdDonLTk5OTlweCcsdG9wOictOTk5OXB4Jyxmb250U2l6ZTonMjAwcHgnfSkudGV4dCgnbW1tbW1tbW1td3d3d3d3dycpLmFwcGVuZFRvKGRvY3VtZW50LmJvZHkpO3ZhciBvcmlnaW5hbFdpZHRoPSR0ZXN0ZXIuY3NzKCdmb250RmFtaWx5Jyx0ZXN0Rm9udE5hbWUpLndpZHRoKCk7dmFyIHdpZHRoPSR0ZXN0ZXIuY3NzKCdmb250RmFtaWx5Jyxmb250TmFtZSsnLCcrdGVzdEZvbnROYW1lKS53aWR0aCgpOyR0ZXN0ZXIucmVtb3ZlKCk7cmV0dXJuIG9yaWdpbmFsV2lkdGghPT13aWR0aDt9O3ZhciB1c2VyQWdlbnQ9bmF2aWdhdG9yLnVzZXJBZ2VudDt2YXIgaXNNU0lFPS9NU0lFfFRyaWRlbnQvaS50ZXN0KHVzZXJBZ2VudCk7dmFyIGJyb3dzZXJWZXJzaW9uO2lmKGlzTVNJRSl7dmFyIG1hdGNoZXM9L01TSUUgKFxcZCtbLl1cXGQrKS8uZXhlYyh1c2VyQWdlbnQpO2lmKG1hdGNoZXMpe2Jyb3dzZXJWZXJzaW9uPXBhcnNlRmxvYXQobWF0Y2hlc1sxXSk7fW1hdGNoZXM9L1RyaWRlbnRcXC8uKnJ2OihbMC05XXsxLH1bXFwuMC05XXswLH0pLy5leGVjKHVzZXJBZ2VudCk7aWYobWF0Y2hlcyl7YnJvd3NlclZlcnNpb249cGFyc2VGbG9hdChtYXRjaGVzWzFdKTt9fXZhciBpc0VkZ2U9L0VkZ2VcXC9cXGQrLy50ZXN0KHVzZXJBZ2VudCk7dmFyIGhhc0NvZGVNaXJyb3I9ISF3aW5kb3cuQ29kZU1pcnJvcjtpZighaGFzQ29kZU1pcnJvciYmaXNTdXBwb3J0QW1kJiZ0eXBlb2YgcmVxdWlyZSE9PSd1bmRlZmluZWQnKXtpZih0eXBlb2YgcmVxdWlyZS5yZXNvbHZlIT09J3VuZGVmaW5lZCcpe3RyeXsvLyBJZiBDb2RlTWlycm9yIGNhbid0IGJlIHJlc29sdmVkLCBgcmVxdWlyZS5yZXNvbHZlYCB3aWxsIHRocm93IGFuXG4vLyBleGNlcHRpb24gYW5kIGBoYXNDb2RlTWlycm9yYCB3b24ndCBiZSBzZXQgdG8gYHRydWVgLlxucmVxdWlyZS5yZXNvbHZlKCdjb2RlbWlycm9yJyk7aGFzQ29kZU1pcnJvcj10cnVlO31jYXRjaChlKXsvLyBEbyBub3RoaW5nLlxufX1lbHNlIGlmKHR5cGVvZiBldmFsKCdyZXF1aXJlJykuc3BlY2lmaWVkIT09J3VuZGVmaW5lZCcpe2hhc0NvZGVNaXJyb3I9ZXZhbCgncmVxdWlyZScpLnNwZWNpZmllZCgnY29kZW1pcnJvcicpO319LyoqXG4gICAqIEBjbGFzcyBjb3JlLmFnZW50XG4gICAqXG4gICAqIE9iamVjdCB3aGljaCBjaGVjayBwbGF0Zm9ybSBhbmQgYWdlbnRcbiAgICpcbiAgICogQHNpbmdsZXRvblxuICAgKiBAYWx0ZXJuYXRlQ2xhc3NOYW1lIGFnZW50XG4gICAqL3ZhciBhZ2VudD17aXNNYWM6bmF2aWdhdG9yLmFwcFZlcnNpb24uaW5kZXhPZignTWFjJyk+LTEsaXNNU0lFOmlzTVNJRSxpc0VkZ2U6aXNFZGdlLGlzRkY6IWlzRWRnZSYmL2ZpcmVmb3gvaS50ZXN0KHVzZXJBZ2VudCksaXNQaGFudG9tOi9QaGFudG9tSlMvaS50ZXN0KHVzZXJBZ2VudCksaXNXZWJraXQ6IWlzRWRnZSYmL3dlYmtpdC9pLnRlc3QodXNlckFnZW50KSxpc0Nocm9tZTohaXNFZGdlJiYvY2hyb21lL2kudGVzdCh1c2VyQWdlbnQpLGlzU2FmYXJpOiFpc0VkZ2UmJi9zYWZhcmkvaS50ZXN0KHVzZXJBZ2VudCksYnJvd3NlclZlcnNpb246YnJvd3NlclZlcnNpb24sanF1ZXJ5VmVyc2lvbjpwYXJzZUZsb2F0KCQuZm4uanF1ZXJ5KSxpc1N1cHBvcnRBbWQ6aXNTdXBwb3J0QW1kLGhhc0NvZGVNaXJyb3I6aGFzQ29kZU1pcnJvcixpc0ZvbnRJbnN0YWxsZWQ6aXNGb250SW5zdGFsbGVkLGlzVzNDUmFuZ2VTdXBwb3J0OiEhZG9jdW1lbnQuY3JlYXRlUmFuZ2V9O3ZhciBOQlNQX0NIQVI9U3RyaW5nLmZyb21DaGFyQ29kZSgxNjApO3ZhciBaRVJPX1dJRFRIX05CU1BfQ0hBUj0nXFx1ZmVmZic7LyoqXG4gICAqIEBjbGFzcyBjb3JlLmRvbVxuICAgKlxuICAgKiBEb20gZnVuY3Rpb25zXG4gICAqXG4gICAqIEBzaW5nbGV0b25cbiAgICogQGFsdGVybmF0ZUNsYXNzTmFtZSBkb21cbiAgICovdmFyIGRvbT1mdW5jdGlvbigpey8qKlxuICAgICAqIEBtZXRob2QgaXNFZGl0YWJsZVxuICAgICAqXG4gICAgICogcmV0dXJucyB3aGV0aGVyIG5vZGUgaXMgYG5vdGUtZWRpdGFibGVgIG9yIG5vdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Tm9kZX0gbm9kZVxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICovdmFyIGlzRWRpdGFibGU9ZnVuY3Rpb24obm9kZSl7cmV0dXJuIG5vZGUmJiQobm9kZSkuaGFzQ2xhc3MoJ25vdGUtZWRpdGFibGUnKTt9Oy8qKlxuICAgICAqIEBtZXRob2QgaXNDb250cm9sU2l6aW5nXG4gICAgICpcbiAgICAgKiByZXR1cm5zIHdoZXRoZXIgbm9kZSBpcyBgbm90ZS1jb250cm9sLXNpemluZ2Agb3Igbm90LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtOb2RlfSBub2RlXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn1cbiAgICAgKi92YXIgaXNDb250cm9sU2l6aW5nPWZ1bmN0aW9uKG5vZGUpe3JldHVybiBub2RlJiYkKG5vZGUpLmhhc0NsYXNzKCdub3RlLWNvbnRyb2wtc2l6aW5nJyk7fTsvKipcbiAgICAgKiBAbWV0aG9kIG1ha2VQcmVkQnlOb2RlTmFtZVxuICAgICAqXG4gICAgICogcmV0dXJucyBwcmVkaWNhdGUgd2hpY2gganVkZ2Ugd2hldGhlciBub2RlTmFtZSBpcyBzYW1lXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbm9kZU5hbWVcbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn1cbiAgICAgKi92YXIgbWFrZVByZWRCeU5vZGVOYW1lPWZ1bmN0aW9uKG5vZGVOYW1lKXtub2RlTmFtZT1ub2RlTmFtZS50b1VwcGVyQ2FzZSgpO3JldHVybiBmdW5jdGlvbihub2RlKXtyZXR1cm4gbm9kZSYmbm9kZS5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpPT09bm9kZU5hbWU7fTt9Oy8qKlxuICAgICAqIEBtZXRob2QgaXNUZXh0XG4gICAgICpcbiAgICAgKlxuICAgICAqXG4gICAgICogQHBhcmFtIHtOb2RlfSBub2RlXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn0gdHJ1ZSBpZiBub2RlJ3MgdHlwZSBpcyB0ZXh0KDMpXG4gICAgICovdmFyIGlzVGV4dD1mdW5jdGlvbihub2RlKXtyZXR1cm4gbm9kZSYmbm9kZS5ub2RlVHlwZT09PTM7fTsvKipcbiAgICAgKiBAbWV0aG9kIGlzRWxlbWVudFxuICAgICAqXG4gICAgICpcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Tm9kZX0gbm9kZVxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59IHRydWUgaWYgbm9kZSdzIHR5cGUgaXMgZWxlbWVudCgxKVxuICAgICAqL3ZhciBpc0VsZW1lbnQ9ZnVuY3Rpb24obm9kZSl7cmV0dXJuIG5vZGUmJm5vZGUubm9kZVR5cGU9PT0xO307LyoqXG4gICAgICogZXgpIGJyLCBjb2wsIGVtYmVkLCBociwgaW1nLCBpbnB1dCwgLi4uXG4gICAgICogQHNlZSBodHRwOi8vd3d3LnczLm9yZy9odG1sL3dnL2RyYWZ0cy9odG1sL21hc3Rlci9zeW50YXguaHRtbCN2b2lkLWVsZW1lbnRzXG4gICAgICovdmFyIGlzVm9pZD1mdW5jdGlvbihub2RlKXtyZXR1cm4gbm9kZSYmL15CUnxeSU1HfF5IUnxeSUZSQU1FfF5CVVRUT04vLnRlc3Qobm9kZS5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpKTt9O3ZhciBpc1BhcmE9ZnVuY3Rpb24obm9kZSl7aWYoaXNFZGl0YWJsZShub2RlKSl7cmV0dXJuIGZhbHNlO30vLyBDaHJvbWUodjMxLjApLCBGRih2MjUuMC4xKSB1c2UgRElWIGZvciBwYXJhZ3JhcGhcbnJldHVybiBub2RlJiYvXkRJVnxeUHxeTEl8XkhbMS03XS8udGVzdChub2RlLm5vZGVOYW1lLnRvVXBwZXJDYXNlKCkpO307dmFyIGlzSGVhZGluZz1mdW5jdGlvbihub2RlKXtyZXR1cm4gbm9kZSYmL15IWzEtN10vLnRlc3Qobm9kZS5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpKTt9O3ZhciBpc1ByZT1tYWtlUHJlZEJ5Tm9kZU5hbWUoJ1BSRScpO3ZhciBpc0xpPW1ha2VQcmVkQnlOb2RlTmFtZSgnTEknKTt2YXIgaXNQdXJlUGFyYT1mdW5jdGlvbihub2RlKXtyZXR1cm4gaXNQYXJhKG5vZGUpJiYhaXNMaShub2RlKTt9O3ZhciBpc1RhYmxlPW1ha2VQcmVkQnlOb2RlTmFtZSgnVEFCTEUnKTt2YXIgaXNEYXRhPW1ha2VQcmVkQnlOb2RlTmFtZSgnREFUQScpO3ZhciBpc0lubGluZT1mdW5jdGlvbihub2RlKXtyZXR1cm4haXNCb2R5Q29udGFpbmVyKG5vZGUpJiYhaXNMaXN0KG5vZGUpJiYhaXNIcihub2RlKSYmIWlzUGFyYShub2RlKSYmIWlzVGFibGUobm9kZSkmJiFpc0Jsb2NrcXVvdGUobm9kZSkmJiFpc0RhdGEobm9kZSk7fTt2YXIgaXNMaXN0PWZ1bmN0aW9uKG5vZGUpe3JldHVybiBub2RlJiYvXlVMfF5PTC8udGVzdChub2RlLm5vZGVOYW1lLnRvVXBwZXJDYXNlKCkpO307dmFyIGlzSHI9bWFrZVByZWRCeU5vZGVOYW1lKCdIUicpO3ZhciBpc0NlbGw9ZnVuY3Rpb24obm9kZSl7cmV0dXJuIG5vZGUmJi9eVER8XlRILy50ZXN0KG5vZGUubm9kZU5hbWUudG9VcHBlckNhc2UoKSk7fTt2YXIgaXNCbG9ja3F1b3RlPW1ha2VQcmVkQnlOb2RlTmFtZSgnQkxPQ0tRVU9URScpO3ZhciBpc0JvZHlDb250YWluZXI9ZnVuY3Rpb24obm9kZSl7cmV0dXJuIGlzQ2VsbChub2RlKXx8aXNCbG9ja3F1b3RlKG5vZGUpfHxpc0VkaXRhYmxlKG5vZGUpO307dmFyIGlzQW5jaG9yPW1ha2VQcmVkQnlOb2RlTmFtZSgnQScpO3ZhciBpc1BhcmFJbmxpbmU9ZnVuY3Rpb24obm9kZSl7cmV0dXJuIGlzSW5saW5lKG5vZGUpJiYhIWFuY2VzdG9yKG5vZGUsaXNQYXJhKTt9O3ZhciBpc0JvZHlJbmxpbmU9ZnVuY3Rpb24obm9kZSl7cmV0dXJuIGlzSW5saW5lKG5vZGUpJiYhYW5jZXN0b3Iobm9kZSxpc1BhcmEpO307dmFyIGlzQm9keT1tYWtlUHJlZEJ5Tm9kZU5hbWUoJ0JPRFknKTsvKipcbiAgICAgKiByZXR1cm5zIHdoZXRoZXIgbm9kZUIgaXMgY2xvc2VzdCBzaWJsaW5nIG9mIG5vZGVBXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge05vZGV9IG5vZGVBXG4gICAgICogQHBhcmFtIHtOb2RlfSBub2RlQlxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICovdmFyIGlzQ2xvc2VzdFNpYmxpbmc9ZnVuY3Rpb24obm9kZUEsbm9kZUIpe3JldHVybiBub2RlQS5uZXh0U2libGluZz09PW5vZGVCfHxub2RlQS5wcmV2aW91c1NpYmxpbmc9PT1ub2RlQjt9Oy8qKlxuICAgICAqIHJldHVybnMgYXJyYXkgb2YgY2xvc2VzdCBzaWJsaW5ncyB3aXRoIG5vZGVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Tm9kZX0gbm9kZVxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IFtwcmVkXSAtIHByZWRpY2F0ZSBmdW5jdGlvblxuICAgICAqIEByZXR1cm4ge05vZGVbXX1cbiAgICAgKi92YXIgd2l0aENsb3Nlc3RTaWJsaW5ncz1mdW5jdGlvbihub2RlLHByZWQpe3ByZWQ9cHJlZHx8ZnVuYy5vazt2YXIgc2libGluZ3M9W107aWYobm9kZS5wcmV2aW91c1NpYmxpbmcmJnByZWQobm9kZS5wcmV2aW91c1NpYmxpbmcpKXtzaWJsaW5ncy5wdXNoKG5vZGUucHJldmlvdXNTaWJsaW5nKTt9c2libGluZ3MucHVzaChub2RlKTtpZihub2RlLm5leHRTaWJsaW5nJiZwcmVkKG5vZGUubmV4dFNpYmxpbmcpKXtzaWJsaW5ncy5wdXNoKG5vZGUubmV4dFNpYmxpbmcpO31yZXR1cm4gc2libGluZ3M7fTsvKipcbiAgICAgKiBibGFuayBIVE1MIGZvciBjdXJzb3IgcG9zaXRpb25cbiAgICAgKiAtIFt3b3JrYXJvdW5kXSBvbGQgSUUgb25seSB3b3JrcyB3aXRoICZuYnNwO1xuICAgICAqIC0gW3dvcmthcm91bmRdIElFMTEgYW5kIG90aGVyIGJyb3dzZXIgd29ya3Mgd2l0aCBib2d1cyBiclxuICAgICAqL3ZhciBibGFua0hUTUw9YWdlbnQuaXNNU0lFJiZhZ2VudC5icm93c2VyVmVyc2lvbjwxMT8nJm5ic3A7JzonPGJyPic7LyoqXG4gICAgICogQG1ldGhvZCBub2RlTGVuZ3RoXG4gICAgICpcbiAgICAgKiByZXR1cm5zICN0ZXh0J3MgdGV4dCBzaXplIG9yIGVsZW1lbnQncyBjaGlsZE5vZGVzIHNpemVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Tm9kZX0gbm9kZVxuICAgICAqL3ZhciBub2RlTGVuZ3RoPWZ1bmN0aW9uKG5vZGUpe2lmKGlzVGV4dChub2RlKSl7cmV0dXJuIG5vZGUubm9kZVZhbHVlLmxlbmd0aDt9aWYobm9kZSl7cmV0dXJuIG5vZGUuY2hpbGROb2Rlcy5sZW5ndGg7fXJldHVybiAwO307LyoqXG4gICAgICogcmV0dXJucyB3aGV0aGVyIG5vZGUgaXMgZW1wdHkgb3Igbm90LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtOb2RlfSBub2RlXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn1cbiAgICAgKi92YXIgaXNFbXB0eT1mdW5jdGlvbihub2RlKXt2YXIgbGVuPW5vZGVMZW5ndGgobm9kZSk7aWYobGVuPT09MCl7cmV0dXJuIHRydWU7fWVsc2UgaWYoIWlzVGV4dChub2RlKSYmbGVuPT09MSYmbm9kZS5pbm5lckhUTUw9PT1ibGFua0hUTUwpey8vIGV4KSA8cD48YnI+PC9wPiwgPHNwYW4+PGJyPjwvc3Bhbj5cbnJldHVybiB0cnVlO31lbHNlIGlmKGxpc3QuYWxsKG5vZGUuY2hpbGROb2Rlcyxpc1RleHQpJiZub2RlLmlubmVySFRNTD09PScnKXsvLyBleCkgPHA+PC9wPiwgPHNwYW4+PC9zcGFuPlxucmV0dXJuIHRydWU7fXJldHVybiBmYWxzZTt9Oy8qKlxuICAgICAqIHBhZGRpbmcgYmxhbmtIVE1MIGlmIG5vZGUgaXMgZW1wdHkgKGZvciBjdXJzb3IgcG9zaXRpb24pXG4gICAgICovdmFyIHBhZGRpbmdCbGFua0hUTUw9ZnVuY3Rpb24obm9kZSl7aWYoIWlzVm9pZChub2RlKSYmIW5vZGVMZW5ndGgobm9kZSkpe25vZGUuaW5uZXJIVE1MPWJsYW5rSFRNTDt9fTsvKipcbiAgICAgKiBmaW5kIG5lYXJlc3QgYW5jZXN0b3IgcHJlZGljYXRlIGhpdFxuICAgICAqXG4gICAgICogQHBhcmFtIHtOb2RlfSBub2RlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZCAtIHByZWRpY2F0ZSBmdW5jdGlvblxuICAgICAqL3ZhciBhbmNlc3Rvcj1mdW5jdGlvbihub2RlLHByZWQpe3doaWxlKG5vZGUpe2lmKHByZWQobm9kZSkpe3JldHVybiBub2RlO31pZihpc0VkaXRhYmxlKG5vZGUpKXticmVhazt9bm9kZT1ub2RlLnBhcmVudE5vZGU7fXJldHVybiBudWxsO307LyoqXG4gICAgICogZmluZCBuZWFyZXN0IGFuY2VzdG9yIG9ubHkgc2luZ2xlIGNoaWxkIGJsb29kIGxpbmUgYW5kIHByZWRpY2F0ZSBoaXRcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Tm9kZX0gbm9kZVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IHByZWQgLSBwcmVkaWNhdGUgZnVuY3Rpb25cbiAgICAgKi92YXIgc2luZ2xlQ2hpbGRBbmNlc3Rvcj1mdW5jdGlvbihub2RlLHByZWQpe25vZGU9bm9kZS5wYXJlbnROb2RlO3doaWxlKG5vZGUpe2lmKG5vZGVMZW5ndGgobm9kZSkhPT0xKXticmVhazt9aWYocHJlZChub2RlKSl7cmV0dXJuIG5vZGU7fWlmKGlzRWRpdGFibGUobm9kZSkpe2JyZWFrO31ub2RlPW5vZGUucGFyZW50Tm9kZTt9cmV0dXJuIG51bGw7fTsvKipcbiAgICAgKiByZXR1cm5zIG5ldyBhcnJheSBvZiBhbmNlc3RvciBub2RlcyAodW50aWwgcHJlZGljYXRlIGhpdCkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge05vZGV9IG5vZGVcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbb3B0aW9uYWxdIHByZWQgLSBwcmVkaWNhdGUgZnVuY3Rpb25cbiAgICAgKi92YXIgbGlzdEFuY2VzdG9yPWZ1bmN0aW9uKG5vZGUscHJlZCl7cHJlZD1wcmVkfHxmdW5jLmZhaWw7dmFyIGFuY2VzdG9ycz1bXTthbmNlc3Rvcihub2RlLGZ1bmN0aW9uKGVsKXtpZighaXNFZGl0YWJsZShlbCkpe2FuY2VzdG9ycy5wdXNoKGVsKTt9cmV0dXJuIHByZWQoZWwpO30pO3JldHVybiBhbmNlc3RvcnM7fTsvKipcbiAgICAgKiBmaW5kIGZhcnRoZXN0IGFuY2VzdG9yIHByZWRpY2F0ZSBoaXRcbiAgICAgKi92YXIgbGFzdEFuY2VzdG9yPWZ1bmN0aW9uKG5vZGUscHJlZCl7dmFyIGFuY2VzdG9ycz1saXN0QW5jZXN0b3Iobm9kZSk7cmV0dXJuIGxpc3QubGFzdChhbmNlc3RvcnMuZmlsdGVyKHByZWQpKTt9Oy8qKlxuICAgICAqIHJldHVybnMgY29tbW9uIGFuY2VzdG9yIG5vZGUgYmV0d2VlbiB0d28gbm9kZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge05vZGV9IG5vZGVBXG4gICAgICogQHBhcmFtIHtOb2RlfSBub2RlQlxuICAgICAqL3ZhciBjb21tb25BbmNlc3Rvcj1mdW5jdGlvbihub2RlQSxub2RlQil7dmFyIGFuY2VzdG9ycz1saXN0QW5jZXN0b3Iobm9kZUEpO2Zvcih2YXIgbj1ub2RlQjtuO249bi5wYXJlbnROb2RlKXtpZigkLmluQXJyYXkobixhbmNlc3RvcnMpPi0xKXtyZXR1cm4gbjt9fXJldHVybiBudWxsOy8vIGRpZmZlcmVuY2UgZG9jdW1lbnQgYXJlYVxufTsvKipcbiAgICAgKiBsaXN0aW5nIGFsbCBwcmV2aW91cyBzaWJsaW5ncyAodW50aWwgcHJlZGljYXRlIGhpdCkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge05vZGV9IG5vZGVcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbb3B0aW9uYWxdIHByZWQgLSBwcmVkaWNhdGUgZnVuY3Rpb25cbiAgICAgKi92YXIgbGlzdFByZXY9ZnVuY3Rpb24obm9kZSxwcmVkKXtwcmVkPXByZWR8fGZ1bmMuZmFpbDt2YXIgbm9kZXM9W107d2hpbGUobm9kZSl7aWYocHJlZChub2RlKSl7YnJlYWs7fW5vZGVzLnB1c2gobm9kZSk7bm9kZT1ub2RlLnByZXZpb3VzU2libGluZzt9cmV0dXJuIG5vZGVzO307LyoqXG4gICAgICogbGlzdGluZyBuZXh0IHNpYmxpbmdzICh1bnRpbCBwcmVkaWNhdGUgaGl0KS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Tm9kZX0gbm9kZVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtwcmVkXSAtIHByZWRpY2F0ZSBmdW5jdGlvblxuICAgICAqL3ZhciBsaXN0TmV4dD1mdW5jdGlvbihub2RlLHByZWQpe3ByZWQ9cHJlZHx8ZnVuYy5mYWlsO3ZhciBub2Rlcz1bXTt3aGlsZShub2RlKXtpZihwcmVkKG5vZGUpKXticmVhazt9bm9kZXMucHVzaChub2RlKTtub2RlPW5vZGUubmV4dFNpYmxpbmc7fXJldHVybiBub2Rlczt9Oy8qKlxuICAgICAqIGxpc3RpbmcgZGVzY2VuZGFudCBub2Rlc1xuICAgICAqXG4gICAgICogQHBhcmFtIHtOb2RlfSBub2RlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW3ByZWRdIC0gcHJlZGljYXRlIGZ1bmN0aW9uXG4gICAgICovdmFyIGxpc3REZXNjZW5kYW50PWZ1bmN0aW9uKG5vZGUscHJlZCl7dmFyIGRlc2NlbmRhbnRzPVtdO3ByZWQ9cHJlZHx8ZnVuYy5vazsvLyBzdGFydCBERlMoZGVwdGggZmlyc3Qgc2VhcmNoKSB3aXRoIG5vZGVcbihmdW5jdGlvbiBmbldhbGsoY3VycmVudCl7aWYobm9kZSE9PWN1cnJlbnQmJnByZWQoY3VycmVudCkpe2Rlc2NlbmRhbnRzLnB1c2goY3VycmVudCk7fWZvcih2YXIgaWR4PTAsbGVuPWN1cnJlbnQuY2hpbGROb2Rlcy5sZW5ndGg7aWR4PGxlbjtpZHgrKyl7Zm5XYWxrKGN1cnJlbnQuY2hpbGROb2Rlc1tpZHhdKTt9fSkobm9kZSk7cmV0dXJuIGRlc2NlbmRhbnRzO307LyoqXG4gICAgICogd3JhcCBub2RlIHdpdGggbmV3IHRhZy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Tm9kZX0gbm9kZVxuICAgICAqIEBwYXJhbSB7Tm9kZX0gdGFnTmFtZSBvZiB3cmFwcGVyXG4gICAgICogQHJldHVybiB7Tm9kZX0gLSB3cmFwcGVyXG4gICAgICovdmFyIHdyYXA9ZnVuY3Rpb24obm9kZSx3cmFwcGVyTmFtZSl7dmFyIHBhcmVudD1ub2RlLnBhcmVudE5vZGU7dmFyIHdyYXBwZXI9JCgnPCcrd3JhcHBlck5hbWUrJz4nKVswXTtwYXJlbnQuaW5zZXJ0QmVmb3JlKHdyYXBwZXIsbm9kZSk7d3JhcHBlci5hcHBlbmRDaGlsZChub2RlKTtyZXR1cm4gd3JhcHBlcjt9Oy8qKlxuICAgICAqIGluc2VydCBub2RlIGFmdGVyIHByZWNlZGluZ1xuICAgICAqXG4gICAgICogQHBhcmFtIHtOb2RlfSBub2RlXG4gICAgICogQHBhcmFtIHtOb2RlfSBwcmVjZWRpbmcgLSBwcmVkaWNhdGUgZnVuY3Rpb25cbiAgICAgKi92YXIgaW5zZXJ0QWZ0ZXI9ZnVuY3Rpb24obm9kZSxwcmVjZWRpbmcpe3ZhciBuZXh0PXByZWNlZGluZy5uZXh0U2libGluZyxwYXJlbnQ9cHJlY2VkaW5nLnBhcmVudE5vZGU7aWYobmV4dCl7cGFyZW50Lmluc2VydEJlZm9yZShub2RlLG5leHQpO31lbHNle3BhcmVudC5hcHBlbmRDaGlsZChub2RlKTt9cmV0dXJuIG5vZGU7fTsvKipcbiAgICAgKiBhcHBlbmQgZWxlbWVudHMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge05vZGV9IG5vZGVcbiAgICAgKiBAcGFyYW0ge0NvbGxlY3Rpb259IGFDaGlsZFxuICAgICAqL3ZhciBhcHBlbmRDaGlsZE5vZGVzPWZ1bmN0aW9uKG5vZGUsYUNoaWxkKXskLmVhY2goYUNoaWxkLGZ1bmN0aW9uKGlkeCxjaGlsZCl7bm9kZS5hcHBlbmRDaGlsZChjaGlsZCk7fSk7cmV0dXJuIG5vZGU7fTsvKipcbiAgICAgKiByZXR1cm5zIHdoZXRoZXIgYm91bmRhcnlQb2ludCBpcyBsZWZ0IGVkZ2Ugb3Igbm90LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtCb3VuZGFyeVBvaW50fSBwb2ludFxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICovdmFyIGlzTGVmdEVkZ2VQb2ludD1mdW5jdGlvbihwb2ludCl7cmV0dXJuIHBvaW50Lm9mZnNldD09PTA7fTsvKipcbiAgICAgKiByZXR1cm5zIHdoZXRoZXIgYm91bmRhcnlQb2ludCBpcyByaWdodCBlZGdlIG9yIG5vdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Qm91bmRhcnlQb2ludH0gcG9pbnRcbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufVxuICAgICAqL3ZhciBpc1JpZ2h0RWRnZVBvaW50PWZ1bmN0aW9uKHBvaW50KXtyZXR1cm4gcG9pbnQub2Zmc2V0PT09bm9kZUxlbmd0aChwb2ludC5ub2RlKTt9Oy8qKlxuICAgICAqIHJldHVybnMgd2hldGhlciBib3VuZGFyeVBvaW50IGlzIGVkZ2Ugb3Igbm90LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtCb3VuZGFyeVBvaW50fSBwb2ludFxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICovdmFyIGlzRWRnZVBvaW50PWZ1bmN0aW9uKHBvaW50KXtyZXR1cm4gaXNMZWZ0RWRnZVBvaW50KHBvaW50KXx8aXNSaWdodEVkZ2VQb2ludChwb2ludCk7fTsvKipcbiAgICAgKiByZXR1cm5zIHdoZXRoZXIgbm9kZSBpcyBsZWZ0IGVkZ2Ugb2YgYW5jZXN0b3Igb3Igbm90LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtOb2RlfSBub2RlXG4gICAgICogQHBhcmFtIHtOb2RlfSBhbmNlc3RvclxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICovdmFyIGlzTGVmdEVkZ2VPZj1mdW5jdGlvbihub2RlLGFuY2VzdG9yKXt3aGlsZShub2RlJiZub2RlIT09YW5jZXN0b3Ipe2lmKHBvc2l0aW9uKG5vZGUpIT09MCl7cmV0dXJuIGZhbHNlO31ub2RlPW5vZGUucGFyZW50Tm9kZTt9cmV0dXJuIHRydWU7fTsvKipcbiAgICAgKiByZXR1cm5zIHdoZXRoZXIgbm9kZSBpcyByaWdodCBlZGdlIG9mIGFuY2VzdG9yIG9yIG5vdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Tm9kZX0gbm9kZVxuICAgICAqIEBwYXJhbSB7Tm9kZX0gYW5jZXN0b3JcbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufVxuICAgICAqL3ZhciBpc1JpZ2h0RWRnZU9mPWZ1bmN0aW9uKG5vZGUsYW5jZXN0b3Ipe2lmKCFhbmNlc3Rvcil7cmV0dXJuIGZhbHNlO313aGlsZShub2RlJiZub2RlIT09YW5jZXN0b3Ipe2lmKHBvc2l0aW9uKG5vZGUpIT09bm9kZUxlbmd0aChub2RlLnBhcmVudE5vZGUpLTEpe3JldHVybiBmYWxzZTt9bm9kZT1ub2RlLnBhcmVudE5vZGU7fXJldHVybiB0cnVlO307LyoqXG4gICAgICogcmV0dXJucyB3aGV0aGVyIHBvaW50IGlzIGxlZnQgZWRnZSBvZiBhbmNlc3RvciBvciBub3QuXG4gICAgICogQHBhcmFtIHtCb3VuZGFyeVBvaW50fSBwb2ludFxuICAgICAqIEBwYXJhbSB7Tm9kZX0gYW5jZXN0b3JcbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufVxuICAgICAqL3ZhciBpc0xlZnRFZGdlUG9pbnRPZj1mdW5jdGlvbihwb2ludCxhbmNlc3Rvcil7cmV0dXJuIGlzTGVmdEVkZ2VQb2ludChwb2ludCkmJmlzTGVmdEVkZ2VPZihwb2ludC5ub2RlLGFuY2VzdG9yKTt9Oy8qKlxuICAgICAqIHJldHVybnMgd2hldGhlciBwb2ludCBpcyByaWdodCBlZGdlIG9mIGFuY2VzdG9yIG9yIG5vdC5cbiAgICAgKiBAcGFyYW0ge0JvdW5kYXJ5UG9pbnR9IHBvaW50XG4gICAgICogQHBhcmFtIHtOb2RlfSBhbmNlc3RvclxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICovdmFyIGlzUmlnaHRFZGdlUG9pbnRPZj1mdW5jdGlvbihwb2ludCxhbmNlc3Rvcil7cmV0dXJuIGlzUmlnaHRFZGdlUG9pbnQocG9pbnQpJiZpc1JpZ2h0RWRnZU9mKHBvaW50Lm5vZGUsYW5jZXN0b3IpO307LyoqXG4gICAgICogcmV0dXJucyBvZmZzZXQgZnJvbSBwYXJlbnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge05vZGV9IG5vZGVcbiAgICAgKi92YXIgcG9zaXRpb249ZnVuY3Rpb24obm9kZSl7dmFyIG9mZnNldD0wO3doaWxlKG5vZGU9bm9kZS5wcmV2aW91c1NpYmxpbmcpe29mZnNldCs9MTt9cmV0dXJuIG9mZnNldDt9O3ZhciBoYXNDaGlsZHJlbj1mdW5jdGlvbihub2RlKXtyZXR1cm4hIShub2RlJiZub2RlLmNoaWxkTm9kZXMmJm5vZGUuY2hpbGROb2Rlcy5sZW5ndGgpO307LyoqXG4gICAgICogcmV0dXJucyBwcmV2aW91cyBib3VuZGFyeVBvaW50XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0JvdW5kYXJ5UG9pbnR9IHBvaW50XG4gICAgICogQHBhcmFtIHtCb29sZWFufSBpc1NraXBJbm5lck9mZnNldFxuICAgICAqIEByZXR1cm4ge0JvdW5kYXJ5UG9pbnR9XG4gICAgICovdmFyIHByZXZQb2ludD1mdW5jdGlvbihwb2ludCxpc1NraXBJbm5lck9mZnNldCl7dmFyIG5vZGUsb2Zmc2V0O2lmKHBvaW50Lm9mZnNldD09PTApe2lmKGlzRWRpdGFibGUocG9pbnQubm9kZSkpe3JldHVybiBudWxsO31ub2RlPXBvaW50Lm5vZGUucGFyZW50Tm9kZTtvZmZzZXQ9cG9zaXRpb24ocG9pbnQubm9kZSk7fWVsc2UgaWYoaGFzQ2hpbGRyZW4ocG9pbnQubm9kZSkpe25vZGU9cG9pbnQubm9kZS5jaGlsZE5vZGVzW3BvaW50Lm9mZnNldC0xXTtvZmZzZXQ9bm9kZUxlbmd0aChub2RlKTt9ZWxzZXtub2RlPXBvaW50Lm5vZGU7b2Zmc2V0PWlzU2tpcElubmVyT2Zmc2V0PzA6cG9pbnQub2Zmc2V0LTE7fXJldHVybntub2RlOm5vZGUsb2Zmc2V0Om9mZnNldH07fTsvKipcbiAgICAgKiByZXR1cm5zIG5leHQgYm91bmRhcnlQb2ludFxuICAgICAqXG4gICAgICogQHBhcmFtIHtCb3VuZGFyeVBvaW50fSBwb2ludFxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gaXNTa2lwSW5uZXJPZmZzZXRcbiAgICAgKiBAcmV0dXJuIHtCb3VuZGFyeVBvaW50fVxuICAgICAqL3ZhciBuZXh0UG9pbnQ9ZnVuY3Rpb24ocG9pbnQsaXNTa2lwSW5uZXJPZmZzZXQpe3ZhciBub2RlLG9mZnNldDtpZihub2RlTGVuZ3RoKHBvaW50Lm5vZGUpPT09cG9pbnQub2Zmc2V0KXtpZihpc0VkaXRhYmxlKHBvaW50Lm5vZGUpKXtyZXR1cm4gbnVsbDt9bm9kZT1wb2ludC5ub2RlLnBhcmVudE5vZGU7b2Zmc2V0PXBvc2l0aW9uKHBvaW50Lm5vZGUpKzE7fWVsc2UgaWYoaGFzQ2hpbGRyZW4ocG9pbnQubm9kZSkpe25vZGU9cG9pbnQubm9kZS5jaGlsZE5vZGVzW3BvaW50Lm9mZnNldF07b2Zmc2V0PTA7fWVsc2V7bm9kZT1wb2ludC5ub2RlO29mZnNldD1pc1NraXBJbm5lck9mZnNldD9ub2RlTGVuZ3RoKHBvaW50Lm5vZGUpOnBvaW50Lm9mZnNldCsxO31yZXR1cm57bm9kZTpub2RlLG9mZnNldDpvZmZzZXR9O307LyoqXG4gICAgICogcmV0dXJucyB3aGV0aGVyIHBvaW50QSBhbmQgcG9pbnRCIGlzIHNhbWUgb3Igbm90LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtCb3VuZGFyeVBvaW50fSBwb2ludEFcbiAgICAgKiBAcGFyYW0ge0JvdW5kYXJ5UG9pbnR9IHBvaW50QlxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICovdmFyIGlzU2FtZVBvaW50PWZ1bmN0aW9uKHBvaW50QSxwb2ludEIpe3JldHVybiBwb2ludEEubm9kZT09PXBvaW50Qi5ub2RlJiZwb2ludEEub2Zmc2V0PT09cG9pbnRCLm9mZnNldDt9Oy8qKlxuICAgICAqIHJldHVybnMgd2hldGhlciBwb2ludCBpcyB2aXNpYmxlIChjYW4gc2V0IGN1cnNvcikgb3Igbm90LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtCb3VuZGFyeVBvaW50fSBwb2ludFxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICovdmFyIGlzVmlzaWJsZVBvaW50PWZ1bmN0aW9uKHBvaW50KXtpZihpc1RleHQocG9pbnQubm9kZSl8fCFoYXNDaGlsZHJlbihwb2ludC5ub2RlKXx8aXNFbXB0eShwb2ludC5ub2RlKSl7cmV0dXJuIHRydWU7fXZhciBsZWZ0Tm9kZT1wb2ludC5ub2RlLmNoaWxkTm9kZXNbcG9pbnQub2Zmc2V0LTFdO3ZhciByaWdodE5vZGU9cG9pbnQubm9kZS5jaGlsZE5vZGVzW3BvaW50Lm9mZnNldF07aWYoKCFsZWZ0Tm9kZXx8aXNWb2lkKGxlZnROb2RlKSkmJighcmlnaHROb2RlfHxpc1ZvaWQocmlnaHROb2RlKSkpe3JldHVybiB0cnVlO31yZXR1cm4gZmFsc2U7fTsvKipcbiAgICAgKiBAbWV0aG9kIHByZXZQb2ludFV0aWxcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Qm91bmRhcnlQb2ludH0gcG9pbnRcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBwcmVkXG4gICAgICogQHJldHVybiB7Qm91bmRhcnlQb2ludH1cbiAgICAgKi92YXIgcHJldlBvaW50VW50aWw9ZnVuY3Rpb24ocG9pbnQscHJlZCl7d2hpbGUocG9pbnQpe2lmKHByZWQocG9pbnQpKXtyZXR1cm4gcG9pbnQ7fXBvaW50PXByZXZQb2ludChwb2ludCk7fXJldHVybiBudWxsO307LyoqXG4gICAgICogQG1ldGhvZCBuZXh0UG9pbnRVbnRpbFxuICAgICAqXG4gICAgICogQHBhcmFtIHtCb3VuZGFyeVBvaW50fSBwb2ludFxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IHByZWRcbiAgICAgKiBAcmV0dXJuIHtCb3VuZGFyeVBvaW50fVxuICAgICAqL3ZhciBuZXh0UG9pbnRVbnRpbD1mdW5jdGlvbihwb2ludCxwcmVkKXt3aGlsZShwb2ludCl7aWYocHJlZChwb2ludCkpe3JldHVybiBwb2ludDt9cG9pbnQ9bmV4dFBvaW50KHBvaW50KTt9cmV0dXJuIG51bGw7fTsvKipcbiAgICAgKiByZXR1cm5zIHdoZXRoZXIgcG9pbnQgaGFzIGNoYXJhY3RlciBvciBub3QuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BvaW50fSBwb2ludFxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICovdmFyIGlzQ2hhclBvaW50PWZ1bmN0aW9uKHBvaW50KXtpZighaXNUZXh0KHBvaW50Lm5vZGUpKXtyZXR1cm4gZmFsc2U7fXZhciBjaD1wb2ludC5ub2RlLm5vZGVWYWx1ZS5jaGFyQXQocG9pbnQub2Zmc2V0LTEpO3JldHVybiBjaCYmY2ghPT0nICcmJmNoIT09TkJTUF9DSEFSO307LyoqXG4gICAgICogQG1ldGhvZCB3YWxrUG9pbnRcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Qm91bmRhcnlQb2ludH0gc3RhcnRQb2ludFxuICAgICAqIEBwYXJhbSB7Qm91bmRhcnlQb2ludH0gZW5kUG9pbnRcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBoYW5kbGVyXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBpc1NraXBJbm5lck9mZnNldFxuICAgICAqL3ZhciB3YWxrUG9pbnQ9ZnVuY3Rpb24oc3RhcnRQb2ludCxlbmRQb2ludCxoYW5kbGVyLGlzU2tpcElubmVyT2Zmc2V0KXt2YXIgcG9pbnQ9c3RhcnRQb2ludDt3aGlsZShwb2ludCl7aGFuZGxlcihwb2ludCk7aWYoaXNTYW1lUG9pbnQocG9pbnQsZW5kUG9pbnQpKXticmVhazt9dmFyIGlzU2tpcE9mZnNldD1pc1NraXBJbm5lck9mZnNldCYmc3RhcnRQb2ludC5ub2RlIT09cG9pbnQubm9kZSYmZW5kUG9pbnQubm9kZSE9PXBvaW50Lm5vZGU7cG9pbnQ9bmV4dFBvaW50KHBvaW50LGlzU2tpcE9mZnNldCk7fX07LyoqXG4gICAgICogQG1ldGhvZCBtYWtlT2Zmc2V0UGF0aFxuICAgICAqXG4gICAgICogcmV0dXJuIG9mZnNldFBhdGgoYXJyYXkgb2Ygb2Zmc2V0KSBmcm9tIGFuY2VzdG9yXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge05vZGV9IGFuY2VzdG9yIC0gYW5jZXN0b3Igbm9kZVxuICAgICAqIEBwYXJhbSB7Tm9kZX0gbm9kZVxuICAgICAqL3ZhciBtYWtlT2Zmc2V0UGF0aD1mdW5jdGlvbihhbmNlc3Rvcixub2RlKXt2YXIgYW5jZXN0b3JzPWxpc3RBbmNlc3Rvcihub2RlLGZ1bmMuZXEoYW5jZXN0b3IpKTtyZXR1cm4gYW5jZXN0b3JzLm1hcChwb3NpdGlvbikucmV2ZXJzZSgpO307LyoqXG4gICAgICogQG1ldGhvZCBmcm9tT2Zmc2V0UGF0aFxuICAgICAqXG4gICAgICogcmV0dXJuIGVsZW1lbnQgZnJvbSBvZmZzZXRQYXRoKGFycmF5IG9mIG9mZnNldClcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Tm9kZX0gYW5jZXN0b3IgLSBhbmNlc3RvciBub2RlXG4gICAgICogQHBhcmFtIHthcnJheX0gb2Zmc2V0cyAtIG9mZnNldFBhdGhcbiAgICAgKi92YXIgZnJvbU9mZnNldFBhdGg9ZnVuY3Rpb24oYW5jZXN0b3Isb2Zmc2V0cyl7dmFyIGN1cnJlbnQ9YW5jZXN0b3I7Zm9yKHZhciBpPTAsbGVuPW9mZnNldHMubGVuZ3RoO2k8bGVuO2krKyl7aWYoY3VycmVudC5jaGlsZE5vZGVzLmxlbmd0aDw9b2Zmc2V0c1tpXSl7Y3VycmVudD1jdXJyZW50LmNoaWxkTm9kZXNbY3VycmVudC5jaGlsZE5vZGVzLmxlbmd0aC0xXTt9ZWxzZXtjdXJyZW50PWN1cnJlbnQuY2hpbGROb2Rlc1tvZmZzZXRzW2ldXTt9fXJldHVybiBjdXJyZW50O307LyoqXG4gICAgICogQG1ldGhvZCBzcGxpdE5vZGVcbiAgICAgKlxuICAgICAqIHNwbGl0IGVsZW1lbnQgb3IgI3RleHRcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Qm91bmRhcnlQb2ludH0gcG9pbnRcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5pc1NraXBQYWRkaW5nQmxhbmtIVE1MXSAtIGRlZmF1bHQ6IGZhbHNlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5pc05vdFNwbGl0RWRnZVBvaW50XSAtIGRlZmF1bHQ6IGZhbHNlXG4gICAgICogQHJldHVybiB7Tm9kZX0gcmlnaHQgbm9kZSBvZiBib3VuZGFyeVBvaW50XG4gICAgICovdmFyIHNwbGl0Tm9kZT1mdW5jdGlvbihwb2ludCxvcHRpb25zKXt2YXIgaXNTa2lwUGFkZGluZ0JsYW5rSFRNTD1vcHRpb25zJiZvcHRpb25zLmlzU2tpcFBhZGRpbmdCbGFua0hUTUw7dmFyIGlzTm90U3BsaXRFZGdlUG9pbnQ9b3B0aW9ucyYmb3B0aW9ucy5pc05vdFNwbGl0RWRnZVBvaW50Oy8vIGVkZ2UgY2FzZVxuaWYoaXNFZGdlUG9pbnQocG9pbnQpJiYoaXNUZXh0KHBvaW50Lm5vZGUpfHxpc05vdFNwbGl0RWRnZVBvaW50KSl7aWYoaXNMZWZ0RWRnZVBvaW50KHBvaW50KSl7cmV0dXJuIHBvaW50Lm5vZGU7fWVsc2UgaWYoaXNSaWdodEVkZ2VQb2ludChwb2ludCkpe3JldHVybiBwb2ludC5ub2RlLm5leHRTaWJsaW5nO319Ly8gc3BsaXQgI3RleHRcbmlmKGlzVGV4dChwb2ludC5ub2RlKSl7cmV0dXJuIHBvaW50Lm5vZGUuc3BsaXRUZXh0KHBvaW50Lm9mZnNldCk7fWVsc2V7dmFyIGNoaWxkTm9kZT1wb2ludC5ub2RlLmNoaWxkTm9kZXNbcG9pbnQub2Zmc2V0XTt2YXIgY2xvbmU9aW5zZXJ0QWZ0ZXIocG9pbnQubm9kZS5jbG9uZU5vZGUoZmFsc2UpLHBvaW50Lm5vZGUpO2FwcGVuZENoaWxkTm9kZXMoY2xvbmUsbGlzdE5leHQoY2hpbGROb2RlKSk7aWYoIWlzU2tpcFBhZGRpbmdCbGFua0hUTUwpe3BhZGRpbmdCbGFua0hUTUwocG9pbnQubm9kZSk7cGFkZGluZ0JsYW5rSFRNTChjbG9uZSk7fXJldHVybiBjbG9uZTt9fTsvKipcbiAgICAgKiBAbWV0aG9kIHNwbGl0VHJlZVxuICAgICAqXG4gICAgICogc3BsaXQgdHJlZSBieSBwb2ludFxuICAgICAqXG4gICAgICogQHBhcmFtIHtOb2RlfSByb290IC0gc3BsaXQgcm9vdFxuICAgICAqIEBwYXJhbSB7Qm91bmRhcnlQb2ludH0gcG9pbnRcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5pc1NraXBQYWRkaW5nQmxhbmtIVE1MXSAtIGRlZmF1bHQ6IGZhbHNlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5pc05vdFNwbGl0RWRnZVBvaW50XSAtIGRlZmF1bHQ6IGZhbHNlXG4gICAgICogQHJldHVybiB7Tm9kZX0gcmlnaHQgbm9kZSBvZiBib3VuZGFyeVBvaW50XG4gICAgICovdmFyIHNwbGl0VHJlZT1mdW5jdGlvbihyb290LHBvaW50LG9wdGlvbnMpey8vIGV4KSBbI3RleHQsIDxzcGFuPiwgPHA+XVxudmFyIGFuY2VzdG9ycz1saXN0QW5jZXN0b3IocG9pbnQubm9kZSxmdW5jLmVxKHJvb3QpKTtpZighYW5jZXN0b3JzLmxlbmd0aCl7cmV0dXJuIG51bGw7fWVsc2UgaWYoYW5jZXN0b3JzLmxlbmd0aD09PTEpe3JldHVybiBzcGxpdE5vZGUocG9pbnQsb3B0aW9ucyk7fXJldHVybiBhbmNlc3RvcnMucmVkdWNlKGZ1bmN0aW9uKG5vZGUscGFyZW50KXtpZihub2RlPT09cG9pbnQubm9kZSl7bm9kZT1zcGxpdE5vZGUocG9pbnQsb3B0aW9ucyk7fXJldHVybiBzcGxpdE5vZGUoe25vZGU6cGFyZW50LG9mZnNldDpub2RlP2RvbS5wb3NpdGlvbihub2RlKTpub2RlTGVuZ3RoKHBhcmVudCl9LG9wdGlvbnMpO30pO307LyoqXG4gICAgICogc3BsaXQgcG9pbnRcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UG9pbnR9IHBvaW50XG4gICAgICogQHBhcmFtIHtCb29sZWFufSBpc0lubGluZVxuICAgICAqIEByZXR1cm4ge09iamVjdH1cbiAgICAgKi92YXIgc3BsaXRQb2ludD1mdW5jdGlvbihwb2ludCxpc0lubGluZSl7Ly8gZmluZCBzcGxpdFJvb3QsIGNvbnRhaW5lclxuLy8gIC0gaW5saW5lOiBzcGxpdFJvb3QgaXMgYSBjaGlsZCBvZiBwYXJhZ3JhcGhcbi8vICAtIGJsb2NrOiBzcGxpdFJvb3QgaXMgYSBjaGlsZCBvZiBib2R5Q29udGFpbmVyXG52YXIgcHJlZD1pc0lubGluZT9pc1BhcmE6aXNCb2R5Q29udGFpbmVyO3ZhciBhbmNlc3RvcnM9bGlzdEFuY2VzdG9yKHBvaW50Lm5vZGUscHJlZCk7dmFyIHRvcEFuY2VzdG9yPWxpc3QubGFzdChhbmNlc3RvcnMpfHxwb2ludC5ub2RlO3ZhciBzcGxpdFJvb3QsY29udGFpbmVyO2lmKHByZWQodG9wQW5jZXN0b3IpKXtzcGxpdFJvb3Q9YW5jZXN0b3JzW2FuY2VzdG9ycy5sZW5ndGgtMl07Y29udGFpbmVyPXRvcEFuY2VzdG9yO31lbHNle3NwbGl0Um9vdD10b3BBbmNlc3Rvcjtjb250YWluZXI9c3BsaXRSb290LnBhcmVudE5vZGU7fS8vIGlmIHNwbGl0Um9vdCBpcyBleGlzdHMsIHNwbGl0IHdpdGggc3BsaXRUcmVlXG52YXIgcGl2b3Q9c3BsaXRSb290JiZzcGxpdFRyZWUoc3BsaXRSb290LHBvaW50LHtpc1NraXBQYWRkaW5nQmxhbmtIVE1MOmlzSW5saW5lLGlzTm90U3BsaXRFZGdlUG9pbnQ6aXNJbmxpbmV9KTsvLyBpZiBjb250YWluZXIgaXMgcG9pbnQubm9kZSwgZmluZCBwaXZvdCB3aXRoIHBvaW50Lm9mZnNldFxuaWYoIXBpdm90JiZjb250YWluZXI9PT1wb2ludC5ub2RlKXtwaXZvdD1wb2ludC5ub2RlLmNoaWxkTm9kZXNbcG9pbnQub2Zmc2V0XTt9cmV0dXJue3JpZ2h0Tm9kZTpwaXZvdCxjb250YWluZXI6Y29udGFpbmVyfTt9O3ZhciBjcmVhdGU9ZnVuY3Rpb24obm9kZU5hbWUpe3JldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KG5vZGVOYW1lKTt9O3ZhciBjcmVhdGVUZXh0PWZ1bmN0aW9uKHRleHQpe3JldHVybiBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0ZXh0KTt9Oy8qKlxuICAgICAqIEBtZXRob2QgcmVtb3ZlXG4gICAgICpcbiAgICAgKiByZW1vdmUgbm9kZSwgKGlzUmVtb3ZlQ2hpbGQ6IHJlbW92ZSBjaGlsZCBvciBub3QpXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge05vZGV9IG5vZGVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IGlzUmVtb3ZlQ2hpbGRcbiAgICAgKi92YXIgcmVtb3ZlPWZ1bmN0aW9uKG5vZGUsaXNSZW1vdmVDaGlsZCl7aWYoIW5vZGV8fCFub2RlLnBhcmVudE5vZGUpe3JldHVybjt9aWYobm9kZS5yZW1vdmVOb2RlKXtyZXR1cm4gbm9kZS5yZW1vdmVOb2RlKGlzUmVtb3ZlQ2hpbGQpO312YXIgcGFyZW50PW5vZGUucGFyZW50Tm9kZTtpZighaXNSZW1vdmVDaGlsZCl7dmFyIG5vZGVzPVtdO3ZhciBpLGxlbjtmb3IoaT0wLGxlbj1ub2RlLmNoaWxkTm9kZXMubGVuZ3RoO2k8bGVuO2krKyl7bm9kZXMucHVzaChub2RlLmNoaWxkTm9kZXNbaV0pO31mb3IoaT0wLGxlbj1ub2Rlcy5sZW5ndGg7aTxsZW47aSsrKXtwYXJlbnQuaW5zZXJ0QmVmb3JlKG5vZGVzW2ldLG5vZGUpO319cGFyZW50LnJlbW92ZUNoaWxkKG5vZGUpO307LyoqXG4gICAgICogQG1ldGhvZCByZW1vdmVXaGlsZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtOb2RlfSBub2RlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZFxuICAgICAqL3ZhciByZW1vdmVXaGlsZT1mdW5jdGlvbihub2RlLHByZWQpe3doaWxlKG5vZGUpe2lmKGlzRWRpdGFibGUobm9kZSl8fCFwcmVkKG5vZGUpKXticmVhazt9dmFyIHBhcmVudD1ub2RlLnBhcmVudE5vZGU7cmVtb3ZlKG5vZGUpO25vZGU9cGFyZW50O319Oy8qKlxuICAgICAqIEBtZXRob2QgcmVwbGFjZVxuICAgICAqXG4gICAgICogcmVwbGFjZSBub2RlIHdpdGggcHJvdmlkZWQgbm9kZU5hbWVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Tm9kZX0gbm9kZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBub2RlTmFtZVxuICAgICAqIEByZXR1cm4ge05vZGV9IC0gbmV3IG5vZGVcbiAgICAgKi92YXIgcmVwbGFjZT1mdW5jdGlvbihub2RlLG5vZGVOYW1lKXtpZihub2RlLm5vZGVOYW1lLnRvVXBwZXJDYXNlKCk9PT1ub2RlTmFtZS50b1VwcGVyQ2FzZSgpKXtyZXR1cm4gbm9kZTt9dmFyIG5ld05vZGU9Y3JlYXRlKG5vZGVOYW1lKTtpZihub2RlLnN0eWxlLmNzc1RleHQpe25ld05vZGUuc3R5bGUuY3NzVGV4dD1ub2RlLnN0eWxlLmNzc1RleHQ7fWFwcGVuZENoaWxkTm9kZXMobmV3Tm9kZSxsaXN0LmZyb20obm9kZS5jaGlsZE5vZGVzKSk7aW5zZXJ0QWZ0ZXIobmV3Tm9kZSxub2RlKTtyZW1vdmUobm9kZSk7cmV0dXJuIG5ld05vZGU7fTt2YXIgaXNUZXh0YXJlYT1tYWtlUHJlZEJ5Tm9kZU5hbWUoJ1RFWFRBUkVBJyk7LyoqXG4gICAgICogQHBhcmFtIHtqUXVlcnl9ICRub2RlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbc3RyaXBMaW5lYnJlYWtzXSAtIGRlZmF1bHQ6IGZhbHNlXG4gICAgICovdmFyIHZhbHVlPWZ1bmN0aW9uKCRub2RlLHN0cmlwTGluZWJyZWFrcyl7dmFyIHZhbD1pc1RleHRhcmVhKCRub2RlWzBdKT8kbm9kZS52YWwoKTokbm9kZS5odG1sKCk7aWYoc3RyaXBMaW5lYnJlYWtzKXtyZXR1cm4gdmFsLnJlcGxhY2UoL1tcXG5cXHJdL2csJycpO31yZXR1cm4gdmFsO307LyoqXG4gICAgICogQG1ldGhvZCBodG1sXG4gICAgICpcbiAgICAgKiBnZXQgdGhlIEhUTUwgY29udGVudHMgb2Ygbm9kZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtqUXVlcnl9ICRub2RlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbaXNOZXdsaW5lT25CbG9ja11cbiAgICAgKi92YXIgaHRtbD1mdW5jdGlvbigkbm9kZSxpc05ld2xpbmVPbkJsb2NrKXt2YXIgbWFya3VwPXZhbHVlKCRub2RlKTtpZihpc05ld2xpbmVPbkJsb2NrKXt2YXIgcmVnZXhUYWc9LzwoXFwvPykoXFxiKD8hISlbXj5cXHNdKikoLio/KShcXHMqXFwvPz4pL2c7bWFya3VwPW1hcmt1cC5yZXBsYWNlKHJlZ2V4VGFnLGZ1bmN0aW9uKG1hdGNoLGVuZFNsYXNoLG5hbWUpe25hbWU9bmFtZS50b1VwcGVyQ2FzZSgpO3ZhciBpc0VuZE9mSW5saW5lQ29udGFpbmVyPS9eRElWfF5URHxeVEh8XlB8XkxJfF5IWzEtN10vLnRlc3QobmFtZSkmJiEhZW5kU2xhc2g7dmFyIGlzQmxvY2tOb2RlPS9eQkxPQ0tRVU9URXxeVEFCTEV8XlRCT0RZfF5UUnxeSFJ8XlVMfF5PTC8udGVzdChuYW1lKTtyZXR1cm4gbWF0Y2grKGlzRW5kT2ZJbmxpbmVDb250YWluZXJ8fGlzQmxvY2tOb2RlPydcXG4nOicnKTt9KTttYXJrdXA9JC50cmltKG1hcmt1cCk7fXJldHVybiBtYXJrdXA7fTt2YXIgcG9zRnJvbVBsYWNlaG9sZGVyPWZ1bmN0aW9uKHBsYWNlaG9sZGVyKXt2YXIgJHBsYWNlaG9sZGVyPSQocGxhY2Vob2xkZXIpO3ZhciBwb3M9JHBsYWNlaG9sZGVyLm9mZnNldCgpO3ZhciBoZWlnaHQ9JHBsYWNlaG9sZGVyLm91dGVySGVpZ2h0KHRydWUpOy8vIGluY2x1ZGUgbWFyZ2luXG5yZXR1cm57bGVmdDpwb3MubGVmdCx0b3A6cG9zLnRvcCtoZWlnaHR9O307dmFyIGF0dGFjaEV2ZW50cz1mdW5jdGlvbigkbm9kZSxldmVudHMpe09iamVjdC5rZXlzKGV2ZW50cykuZm9yRWFjaChmdW5jdGlvbihrZXkpeyRub2RlLm9uKGtleSxldmVudHNba2V5XSk7fSk7fTt2YXIgZGV0YWNoRXZlbnRzPWZ1bmN0aW9uKCRub2RlLGV2ZW50cyl7T2JqZWN0LmtleXMoZXZlbnRzKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSl7JG5vZGUub2ZmKGtleSxldmVudHNba2V5XSk7fSk7fTtyZXR1cm57LyoqIEBwcm9wZXJ0eSB7U3RyaW5nfSBOQlNQX0NIQVIgKi9OQlNQX0NIQVI6TkJTUF9DSEFSLC8qKiBAcHJvcGVydHkge1N0cmluZ30gWkVST19XSURUSF9OQlNQX0NIQVIgKi9aRVJPX1dJRFRIX05CU1BfQ0hBUjpaRVJPX1dJRFRIX05CU1BfQ0hBUiwvKiogQHByb3BlcnR5IHtTdHJpbmd9IGJsYW5rICovYmxhbms6YmxhbmtIVE1MLC8qKiBAcHJvcGVydHkge1N0cmluZ30gZW1wdHlQYXJhICovZW1wdHlQYXJhOic8cD4nK2JsYW5rSFRNTCsnPC9wPicsbWFrZVByZWRCeU5vZGVOYW1lOm1ha2VQcmVkQnlOb2RlTmFtZSxpc0VkaXRhYmxlOmlzRWRpdGFibGUsaXNDb250cm9sU2l6aW5nOmlzQ29udHJvbFNpemluZyxpc1RleHQ6aXNUZXh0LGlzRWxlbWVudDppc0VsZW1lbnQsaXNWb2lkOmlzVm9pZCxpc1BhcmE6aXNQYXJhLGlzUHVyZVBhcmE6aXNQdXJlUGFyYSxpc0hlYWRpbmc6aXNIZWFkaW5nLGlzSW5saW5lOmlzSW5saW5lLGlzQmxvY2s6ZnVuYy5ub3QoaXNJbmxpbmUpLGlzQm9keUlubGluZTppc0JvZHlJbmxpbmUsaXNCb2R5OmlzQm9keSxpc1BhcmFJbmxpbmU6aXNQYXJhSW5saW5lLGlzUHJlOmlzUHJlLGlzTGlzdDppc0xpc3QsaXNUYWJsZTppc1RhYmxlLGlzRGF0YTppc0RhdGEsaXNDZWxsOmlzQ2VsbCxpc0Jsb2NrcXVvdGU6aXNCbG9ja3F1b3RlLGlzQm9keUNvbnRhaW5lcjppc0JvZHlDb250YWluZXIsaXNBbmNob3I6aXNBbmNob3IsaXNEaXY6bWFrZVByZWRCeU5vZGVOYW1lKCdESVYnKSxpc0xpOmlzTGksaXNCUjptYWtlUHJlZEJ5Tm9kZU5hbWUoJ0JSJyksaXNTcGFuOm1ha2VQcmVkQnlOb2RlTmFtZSgnU1BBTicpLGlzQjptYWtlUHJlZEJ5Tm9kZU5hbWUoJ0InKSxpc1U6bWFrZVByZWRCeU5vZGVOYW1lKCdVJyksaXNTOm1ha2VQcmVkQnlOb2RlTmFtZSgnUycpLGlzSTptYWtlUHJlZEJ5Tm9kZU5hbWUoJ0knKSxpc0ltZzptYWtlUHJlZEJ5Tm9kZU5hbWUoJ0lNRycpLGlzVGV4dGFyZWE6aXNUZXh0YXJlYSxpc0VtcHR5OmlzRW1wdHksaXNFbXB0eUFuY2hvcjpmdW5jLmFuZChpc0FuY2hvcixpc0VtcHR5KSxpc0Nsb3Nlc3RTaWJsaW5nOmlzQ2xvc2VzdFNpYmxpbmcsd2l0aENsb3Nlc3RTaWJsaW5nczp3aXRoQ2xvc2VzdFNpYmxpbmdzLG5vZGVMZW5ndGg6bm9kZUxlbmd0aCxpc0xlZnRFZGdlUG9pbnQ6aXNMZWZ0RWRnZVBvaW50LGlzUmlnaHRFZGdlUG9pbnQ6aXNSaWdodEVkZ2VQb2ludCxpc0VkZ2VQb2ludDppc0VkZ2VQb2ludCxpc0xlZnRFZGdlT2Y6aXNMZWZ0RWRnZU9mLGlzUmlnaHRFZGdlT2Y6aXNSaWdodEVkZ2VPZixpc0xlZnRFZGdlUG9pbnRPZjppc0xlZnRFZGdlUG9pbnRPZixpc1JpZ2h0RWRnZVBvaW50T2Y6aXNSaWdodEVkZ2VQb2ludE9mLHByZXZQb2ludDpwcmV2UG9pbnQsbmV4dFBvaW50Om5leHRQb2ludCxpc1NhbWVQb2ludDppc1NhbWVQb2ludCxpc1Zpc2libGVQb2ludDppc1Zpc2libGVQb2ludCxwcmV2UG9pbnRVbnRpbDpwcmV2UG9pbnRVbnRpbCxuZXh0UG9pbnRVbnRpbDpuZXh0UG9pbnRVbnRpbCxpc0NoYXJQb2ludDppc0NoYXJQb2ludCx3YWxrUG9pbnQ6d2Fsa1BvaW50LGFuY2VzdG9yOmFuY2VzdG9yLHNpbmdsZUNoaWxkQW5jZXN0b3I6c2luZ2xlQ2hpbGRBbmNlc3RvcixsaXN0QW5jZXN0b3I6bGlzdEFuY2VzdG9yLGxhc3RBbmNlc3RvcjpsYXN0QW5jZXN0b3IsbGlzdE5leHQ6bGlzdE5leHQsbGlzdFByZXY6bGlzdFByZXYsbGlzdERlc2NlbmRhbnQ6bGlzdERlc2NlbmRhbnQsY29tbW9uQW5jZXN0b3I6Y29tbW9uQW5jZXN0b3Isd3JhcDp3cmFwLGluc2VydEFmdGVyOmluc2VydEFmdGVyLGFwcGVuZENoaWxkTm9kZXM6YXBwZW5kQ2hpbGROb2Rlcyxwb3NpdGlvbjpwb3NpdGlvbixoYXNDaGlsZHJlbjpoYXNDaGlsZHJlbixtYWtlT2Zmc2V0UGF0aDptYWtlT2Zmc2V0UGF0aCxmcm9tT2Zmc2V0UGF0aDpmcm9tT2Zmc2V0UGF0aCxzcGxpdFRyZWU6c3BsaXRUcmVlLHNwbGl0UG9pbnQ6c3BsaXRQb2ludCxjcmVhdGU6Y3JlYXRlLGNyZWF0ZVRleHQ6Y3JlYXRlVGV4dCxyZW1vdmU6cmVtb3ZlLHJlbW92ZVdoaWxlOnJlbW92ZVdoaWxlLHJlcGxhY2U6cmVwbGFjZSxodG1sOmh0bWwsdmFsdWU6dmFsdWUscG9zRnJvbVBsYWNlaG9sZGVyOnBvc0Zyb21QbGFjZWhvbGRlcixhdHRhY2hFdmVudHM6YXR0YWNoRXZlbnRzLGRldGFjaEV2ZW50czpkZXRhY2hFdmVudHN9O30oKTsvKipcbiAgICogQHBhcmFtIHtqUXVlcnl9ICRub3RlXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXG4gICAqIEByZXR1cm4ge0NvbnRleHR9XG4gICAqL3ZhciBDb250ZXh0PWZ1bmN0aW9uKCRub3RlLG9wdGlvbnMpe3ZhciBzZWxmPXRoaXM7dmFyIHVpPSQuc3VtbWVybm90ZS51aTt0aGlzLm1lbW9zPXt9O3RoaXMubW9kdWxlcz17fTt0aGlzLmxheW91dEluZm89e307dGhpcy5vcHRpb25zPW9wdGlvbnM7LyoqXG4gICAgICogY3JlYXRlIGxheW91dCBhbmQgaW5pdGlhbGl6ZSBtb2R1bGVzIGFuZCBvdGhlciByZXNvdXJjZXNcbiAgICAgKi90aGlzLmluaXRpYWxpemU9ZnVuY3Rpb24oKXt0aGlzLmxheW91dEluZm89dWkuY3JlYXRlTGF5b3V0KCRub3RlLG9wdGlvbnMpO3RoaXMuX2luaXRpYWxpemUoKTskbm90ZS5oaWRlKCk7cmV0dXJuIHRoaXM7fTsvKipcbiAgICAgKiBkZXN0cm95IG1vZHVsZXMgYW5kIG90aGVyIHJlc291cmNlcyBhbmQgcmVtb3ZlIGxheW91dFxuICAgICAqL3RoaXMuZGVzdHJveT1mdW5jdGlvbigpe3RoaXMuX2Rlc3Ryb3koKTskbm90ZS5yZW1vdmVEYXRhKCdzdW1tZXJub3RlJyk7dWkucmVtb3ZlTGF5b3V0KCRub3RlLHRoaXMubGF5b3V0SW5mbyk7fTsvKipcbiAgICAgKiBkZXN0b3J5IG1vZHVsZXMgYW5kIG90aGVyIHJlc291cmNlcyBhbmQgaW5pdGlhbGl6ZSBpdCBhZ2FpblxuICAgICAqL3RoaXMucmVzZXQ9ZnVuY3Rpb24oKXt2YXIgZGlzYWJsZWQ9c2VsZi5pc0Rpc2FibGVkKCk7dGhpcy5jb2RlKGRvbS5lbXB0eVBhcmEpO3RoaXMuX2Rlc3Ryb3koKTt0aGlzLl9pbml0aWFsaXplKCk7aWYoZGlzYWJsZWQpe3NlbGYuZGlzYWJsZSgpO319O3RoaXMuX2luaXRpYWxpemU9ZnVuY3Rpb24oKXsvLyBhZGQgb3B0aW9uYWwgYnV0dG9uc1xudmFyIGJ1dHRvbnM9JC5leHRlbmQoe30sdGhpcy5vcHRpb25zLmJ1dHRvbnMpO09iamVjdC5rZXlzKGJ1dHRvbnMpLmZvckVhY2goZnVuY3Rpb24oa2V5KXtzZWxmLm1lbW8oJ2J1dHRvbi4nK2tleSxidXR0b25zW2tleV0pO30pO3ZhciBtb2R1bGVzPSQuZXh0ZW5kKHt9LHRoaXMub3B0aW9ucy5tb2R1bGVzLCQuc3VtbWVybm90ZS5wbHVnaW5zfHx7fSk7Ly8gYWRkIGFuZCBpbml0aWFsaXplIG1vZHVsZXNcbk9iamVjdC5rZXlzKG1vZHVsZXMpLmZvckVhY2goZnVuY3Rpb24oa2V5KXtzZWxmLm1vZHVsZShrZXksbW9kdWxlc1trZXldLHRydWUpO30pO09iamVjdC5rZXlzKHRoaXMubW9kdWxlcykuZm9yRWFjaChmdW5jdGlvbihrZXkpe3NlbGYuaW5pdGlhbGl6ZU1vZHVsZShrZXkpO30pO307dGhpcy5fZGVzdHJveT1mdW5jdGlvbigpey8vIGRlc3Ryb3kgbW9kdWxlcyB3aXRoIHJldmVyc2VkIG9yZGVyXG5PYmplY3Qua2V5cyh0aGlzLm1vZHVsZXMpLnJldmVyc2UoKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSl7c2VsZi5yZW1vdmVNb2R1bGUoa2V5KTt9KTtPYmplY3Qua2V5cyh0aGlzLm1lbW9zKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSl7c2VsZi5yZW1vdmVNZW1vKGtleSk7fSk7fTt0aGlzLmNvZGU9ZnVuY3Rpb24oaHRtbCl7dmFyIGlzQWN0aXZhdGVkPXRoaXMuaW52b2tlKCdjb2Rldmlldy5pc0FjdGl2YXRlZCcpO2lmKGh0bWw9PT11bmRlZmluZWQpe3RoaXMuaW52b2tlKCdjb2Rldmlldy5zeW5jJyk7cmV0dXJuIGlzQWN0aXZhdGVkP3RoaXMubGF5b3V0SW5mby5jb2RhYmxlLnZhbCgpOnRoaXMubGF5b3V0SW5mby5lZGl0YWJsZS5odG1sKCk7fWVsc2V7aWYoaXNBY3RpdmF0ZWQpe3RoaXMubGF5b3V0SW5mby5jb2RhYmxlLnZhbChodG1sKTt9ZWxzZXt0aGlzLmxheW91dEluZm8uZWRpdGFibGUuaHRtbChodG1sKTt9JG5vdGUudmFsKGh0bWwpO3RoaXMudHJpZ2dlckV2ZW50KCdjaGFuZ2UnLGh0bWwpO319O3RoaXMuaXNEaXNhYmxlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxheW91dEluZm8uZWRpdGFibGUuYXR0cignY29udGVudGVkaXRhYmxlJyk9PT0nZmFsc2UnO307dGhpcy5lbmFibGU9ZnVuY3Rpb24oKXt0aGlzLmxheW91dEluZm8uZWRpdGFibGUuYXR0cignY29udGVudGVkaXRhYmxlJyx0cnVlKTt0aGlzLmludm9rZSgndG9vbGJhci5hY3RpdmF0ZScsdHJ1ZSk7fTt0aGlzLmRpc2FibGU9ZnVuY3Rpb24oKXsvLyBjbG9zZSBjb2RldmlldyBpZiBjb2RldmlldyBpcyBvcGVuZFxuaWYodGhpcy5pbnZva2UoJ2NvZGV2aWV3LmlzQWN0aXZhdGVkJykpe3RoaXMuaW52b2tlKCdjb2Rldmlldy5kZWFjdGl2YXRlJyk7fXRoaXMubGF5b3V0SW5mby5lZGl0YWJsZS5hdHRyKCdjb250ZW50ZWRpdGFibGUnLGZhbHNlKTt0aGlzLmludm9rZSgndG9vbGJhci5kZWFjdGl2YXRlJyx0cnVlKTt9O3RoaXMudHJpZ2dlckV2ZW50PWZ1bmN0aW9uKCl7dmFyIG5hbWVzcGFjZT1saXN0LmhlYWQoYXJndW1lbnRzKTt2YXIgYXJncz1saXN0LnRhaWwobGlzdC5mcm9tKGFyZ3VtZW50cykpO3ZhciBjYWxsYmFjaz10aGlzLm9wdGlvbnMuY2FsbGJhY2tzW2Z1bmMubmFtZXNwYWNlVG9DYW1lbChuYW1lc3BhY2UsJ29uJyldO2lmKGNhbGxiYWNrKXtjYWxsYmFjay5hcHBseSgkbm90ZVswXSxhcmdzKTt9JG5vdGUudHJpZ2dlcignc3VtbWVybm90ZS4nK25hbWVzcGFjZSxhcmdzKTt9O3RoaXMuaW5pdGlhbGl6ZU1vZHVsZT1mdW5jdGlvbihrZXkpe3ZhciBtb2R1bGU9dGhpcy5tb2R1bGVzW2tleV07bW9kdWxlLnNob3VsZEluaXRpYWxpemU9bW9kdWxlLnNob3VsZEluaXRpYWxpemV8fGZ1bmMub2s7aWYoIW1vZHVsZS5zaG91bGRJbml0aWFsaXplKCkpe3JldHVybjt9Ly8gaW5pdGlhbGl6ZSBtb2R1bGVcbmlmKG1vZHVsZS5pbml0aWFsaXplKXttb2R1bGUuaW5pdGlhbGl6ZSgpO30vLyBhdHRhY2ggZXZlbnRzXG5pZihtb2R1bGUuZXZlbnRzKXtkb20uYXR0YWNoRXZlbnRzKCRub3RlLG1vZHVsZS5ldmVudHMpO319O3RoaXMubW9kdWxlPWZ1bmN0aW9uKGtleSxNb2R1bGVDbGFzcyx3aXRob3V0SW50aWFsaXplKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7cmV0dXJuIHRoaXMubW9kdWxlc1trZXldO310aGlzLm1vZHVsZXNba2V5XT1uZXcgTW9kdWxlQ2xhc3ModGhpcyk7aWYoIXdpdGhvdXRJbnRpYWxpemUpe3RoaXMuaW5pdGlhbGl6ZU1vZHVsZShrZXkpO319O3RoaXMucmVtb3ZlTW9kdWxlPWZ1bmN0aW9uKGtleSl7dmFyIG1vZHVsZT10aGlzLm1vZHVsZXNba2V5XTtpZihtb2R1bGUuc2hvdWxkSW5pdGlhbGl6ZSgpKXtpZihtb2R1bGUuZXZlbnRzKXtkb20uZGV0YWNoRXZlbnRzKCRub3RlLG1vZHVsZS5ldmVudHMpO31pZihtb2R1bGUuZGVzdHJveSl7bW9kdWxlLmRlc3Ryb3koKTt9fWRlbGV0ZSB0aGlzLm1vZHVsZXNba2V5XTt9O3RoaXMubWVtbz1mdW5jdGlvbihrZXksb2JqKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7cmV0dXJuIHRoaXMubWVtb3Nba2V5XTt9dGhpcy5tZW1vc1trZXldPW9iajt9O3RoaXMucmVtb3ZlTWVtbz1mdW5jdGlvbihrZXkpe2lmKHRoaXMubWVtb3Nba2V5XSYmdGhpcy5tZW1vc1trZXldLmRlc3Ryb3kpe3RoaXMubWVtb3Nba2V5XS5kZXN0cm95KCk7fWRlbGV0ZSB0aGlzLm1lbW9zW2tleV07fTt0aGlzLmNyZWF0ZUludm9rZUhhbmRsZXI9ZnVuY3Rpb24obmFtZXNwYWNlLHZhbHVlKXtyZXR1cm4gZnVuY3Rpb24oZXZlbnQpe2V2ZW50LnByZXZlbnREZWZhdWx0KCk7c2VsZi5pbnZva2UobmFtZXNwYWNlLHZhbHVlfHwkKGV2ZW50LnRhcmdldCkuY2xvc2VzdCgnW2RhdGEtdmFsdWVdJykuZGF0YSgndmFsdWUnKSk7fTt9O3RoaXMuaW52b2tlPWZ1bmN0aW9uKCl7dmFyIG5hbWVzcGFjZT1saXN0LmhlYWQoYXJndW1lbnRzKTt2YXIgYXJncz1saXN0LnRhaWwobGlzdC5mcm9tKGFyZ3VtZW50cykpO3ZhciBzcGxpdHM9bmFtZXNwYWNlLnNwbGl0KCcuJyk7dmFyIGhhc1NlcGFyYXRvcj1zcGxpdHMubGVuZ3RoPjE7dmFyIG1vZHVsZU5hbWU9aGFzU2VwYXJhdG9yJiZsaXN0LmhlYWQoc3BsaXRzKTt2YXIgbWV0aG9kTmFtZT1oYXNTZXBhcmF0b3I/bGlzdC5sYXN0KHNwbGl0cyk6bGlzdC5oZWFkKHNwbGl0cyk7dmFyIG1vZHVsZT10aGlzLm1vZHVsZXNbbW9kdWxlTmFtZXx8J2VkaXRvciddO2lmKCFtb2R1bGVOYW1lJiZ0aGlzW21ldGhvZE5hbWVdKXtyZXR1cm4gdGhpc1ttZXRob2ROYW1lXS5hcHBseSh0aGlzLGFyZ3MpO31lbHNlIGlmKG1vZHVsZSYmbW9kdWxlW21ldGhvZE5hbWVdJiZtb2R1bGUuc2hvdWxkSW5pdGlhbGl6ZSgpKXtyZXR1cm4gbW9kdWxlW21ldGhvZE5hbWVdLmFwcGx5KG1vZHVsZSxhcmdzKTt9fTtyZXR1cm4gdGhpcy5pbml0aWFsaXplKCk7fTskLmZuLmV4dGVuZCh7LyoqXG4gICAgICogU3VtbWVybm90ZSBBUElcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fFN0cmluZ31cbiAgICAgKiBAcmV0dXJuIHt0aGlzfVxuICAgICAqL3N1bW1lcm5vdGU6ZnVuY3Rpb24oKXt2YXIgdHlwZT0kLnR5cGUobGlzdC5oZWFkKGFyZ3VtZW50cykpO3ZhciBpc0V4dGVybmFsQVBJQ2FsbGVkPXR5cGU9PT0nc3RyaW5nJzt2YXIgaGFzSW5pdE9wdGlvbnM9dHlwZT09PSdvYmplY3QnO3ZhciBvcHRpb25zPWhhc0luaXRPcHRpb25zP2xpc3QuaGVhZChhcmd1bWVudHMpOnt9O29wdGlvbnM9JC5leHRlbmQoe30sJC5zdW1tZXJub3RlLm9wdGlvbnMsb3B0aW9ucyk7b3B0aW9ucy5sYW5nSW5mbz0kLmV4dGVuZCh0cnVlLHt9LCQuc3VtbWVybm90ZS5sYW5nWydlbi1VUyddLCQuc3VtbWVybm90ZS5sYW5nW29wdGlvbnMubGFuZ10pO29wdGlvbnMuaWNvbnM9JC5leHRlbmQodHJ1ZSx7fSwkLnN1bW1lcm5vdGUub3B0aW9ucy5pY29ucyxvcHRpb25zLmljb25zKTt0aGlzLmVhY2goZnVuY3Rpb24oaWR4LG5vdGUpe3ZhciAkbm90ZT0kKG5vdGUpO2lmKCEkbm90ZS5kYXRhKCdzdW1tZXJub3RlJykpe3ZhciBjb250ZXh0PW5ldyBDb250ZXh0KCRub3RlLG9wdGlvbnMpOyRub3RlLmRhdGEoJ3N1bW1lcm5vdGUnLGNvbnRleHQpOyRub3RlLmRhdGEoJ3N1bW1lcm5vdGUnKS50cmlnZ2VyRXZlbnQoJ2luaXQnLGNvbnRleHQubGF5b3V0SW5mbyk7fX0pO3ZhciAkbm90ZT10aGlzLmZpcnN0KCk7aWYoJG5vdGUubGVuZ3RoKXt2YXIgY29udGV4dD0kbm90ZS5kYXRhKCdzdW1tZXJub3RlJyk7aWYoaXNFeHRlcm5hbEFQSUNhbGxlZCl7cmV0dXJuIGNvbnRleHQuaW52b2tlLmFwcGx5KGNvbnRleHQsbGlzdC5mcm9tKGFyZ3VtZW50cykpO31lbHNlIGlmKG9wdGlvbnMuZm9jdXMpe2NvbnRleHQuaW52b2tlKCdlZGl0b3IuZm9jdXMnKTt9fXJldHVybiB0aGlzO319KTt2YXIgUmVuZGVyZXI9ZnVuY3Rpb24obWFya3VwLGNoaWxkcmVuLG9wdGlvbnMsY2FsbGJhY2spe3RoaXMucmVuZGVyPWZ1bmN0aW9uKCRwYXJlbnQpe3ZhciAkbm9kZT0kKG1hcmt1cCk7aWYob3B0aW9ucyYmb3B0aW9ucy5jb250ZW50cyl7JG5vZGUuaHRtbChvcHRpb25zLmNvbnRlbnRzKTt9aWYob3B0aW9ucyYmb3B0aW9ucy5jbGFzc05hbWUpeyRub2RlLmFkZENsYXNzKG9wdGlvbnMuY2xhc3NOYW1lKTt9aWYob3B0aW9ucyYmb3B0aW9ucy5kYXRhKXskLmVhY2gob3B0aW9ucy5kYXRhLGZ1bmN0aW9uKGssdil7JG5vZGUuYXR0cignZGF0YS0nK2ssdik7fSk7fWlmKG9wdGlvbnMmJm9wdGlvbnMuY2xpY2speyRub2RlLm9uKCdjbGljaycsb3B0aW9ucy5jbGljayk7fWlmKGNoaWxkcmVuKXt2YXIgJGNvbnRhaW5lcj0kbm9kZS5maW5kKCcubm90ZS1jaGlsZHJlbi1jb250YWluZXInKTtjaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uKGNoaWxkKXtjaGlsZC5yZW5kZXIoJGNvbnRhaW5lci5sZW5ndGg/JGNvbnRhaW5lcjokbm9kZSk7fSk7fWlmKGNhbGxiYWNrKXtjYWxsYmFjaygkbm9kZSxvcHRpb25zKTt9aWYob3B0aW9ucyYmb3B0aW9ucy5jYWxsYmFjayl7b3B0aW9ucy5jYWxsYmFjaygkbm9kZSk7fWlmKCRwYXJlbnQpeyRwYXJlbnQuYXBwZW5kKCRub2RlKTt9cmV0dXJuICRub2RlO307fTt2YXIgcmVuZGVyZXI9e2NyZWF0ZTpmdW5jdGlvbihtYXJrdXAsY2FsbGJhY2spe3JldHVybiBmdW5jdGlvbigpe3ZhciBjaGlsZHJlbj0kLmlzQXJyYXkoYXJndW1lbnRzWzBdKT9hcmd1bWVudHNbMF06W107dmFyIG9wdGlvbnM9dHlwZW9mIGFyZ3VtZW50c1sxXT09PSdvYmplY3QnP2FyZ3VtZW50c1sxXTphcmd1bWVudHNbMF07aWYob3B0aW9ucyYmb3B0aW9ucy5jaGlsZHJlbil7Y2hpbGRyZW49b3B0aW9ucy5jaGlsZHJlbjt9cmV0dXJuIG5ldyBSZW5kZXJlcihtYXJrdXAsY2hpbGRyZW4sb3B0aW9ucyxjYWxsYmFjayk7fTt9fTt2YXIgZWRpdG9yPXJlbmRlcmVyLmNyZWF0ZSgnPGRpdiBjbGFzcz1cIm5vdGUtZWRpdG9yIG5vdGUtZnJhbWUgcGFuZWwgcGFuZWwtZGVmYXVsdFwiLz4nKTt2YXIgdG9vbGJhcj1yZW5kZXJlci5jcmVhdGUoJzxkaXYgY2xhc3M9XCJub3RlLXRvb2xiYXIgcGFuZWwtaGVhZGluZ1wiLz4nKTt2YXIgZWRpdGluZ0FyZWE9cmVuZGVyZXIuY3JlYXRlKCc8ZGl2IGNsYXNzPVwibm90ZS1lZGl0aW5nLWFyZWFcIi8+Jyk7dmFyIGNvZGFibGU9cmVuZGVyZXIuY3JlYXRlKCc8dGV4dGFyZWEgY2xhc3M9XCJub3RlLWNvZGFibGVcIi8+Jyk7dmFyIGVkaXRhYmxlPXJlbmRlcmVyLmNyZWF0ZSgnPGRpdiBjbGFzcz1cIm5vdGUtZWRpdGFibGUgcGFuZWwtYm9keVwiIGNvbnRlbnRFZGl0YWJsZT1cInRydWVcIi8+Jyk7dmFyIHN0YXR1c2Jhcj1yZW5kZXJlci5jcmVhdGUoWyc8ZGl2IGNsYXNzPVwibm90ZS1zdGF0dXNiYXJcIj4nLCcgIDxkaXYgY2xhc3M9XCJub3RlLXJlc2l6ZWJhclwiPicsJyAgICA8ZGl2IGNsYXNzPVwibm90ZS1pY29uLWJhclwiLz4nLCcgICAgPGRpdiBjbGFzcz1cIm5vdGUtaWNvbi1iYXJcIi8+JywnICAgIDxkaXYgY2xhc3M9XCJub3RlLWljb24tYmFyXCIvPicsJyAgPC9kaXY+JywnPC9kaXY+J10uam9pbignJykpO3ZhciBhaXJFZGl0b3I9cmVuZGVyZXIuY3JlYXRlKCc8ZGl2IGNsYXNzPVwibm90ZS1lZGl0b3JcIi8+Jyk7dmFyIGFpckVkaXRhYmxlPXJlbmRlcmVyLmNyZWF0ZSgnPGRpdiBjbGFzcz1cIm5vdGUtZWRpdGFibGVcIiBjb250ZW50RWRpdGFibGU9XCJ0cnVlXCIvPicpO3ZhciBidXR0b25Hcm91cD1yZW5kZXJlci5jcmVhdGUoJzxkaXYgY2xhc3M9XCJub3RlLWJ0bi1ncm91cCBidG4tZ3JvdXBcIj4nKTt2YXIgYnV0dG9uPXJlbmRlcmVyLmNyZWF0ZSgnPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJub3RlLWJ0biBidG4gYnRuLWRlZmF1bHQgYnRuLXNtXCIgdGFiaW5kZXg9XCItMVwiPicsZnVuY3Rpb24oJG5vZGUsb3B0aW9ucyl7aWYob3B0aW9ucyYmb3B0aW9ucy50b29sdGlwKXskbm9kZS5hdHRyKHt0aXRsZTpvcHRpb25zLnRvb2x0aXB9KS50b29sdGlwKHtjb250YWluZXI6J2JvZHknLHRyaWdnZXI6J2hvdmVyJyxwbGFjZW1lbnQ6J2JvdHRvbSd9KTt9fSk7dmFyIGRyb3Bkb3duPXJlbmRlcmVyLmNyZWF0ZSgnPGRpdiBjbGFzcz1cImRyb3Bkb3duLW1lbnVcIj4nLGZ1bmN0aW9uKCRub2RlLG9wdGlvbnMpe3ZhciBtYXJrdXA9JC5pc0FycmF5KG9wdGlvbnMuaXRlbXMpP29wdGlvbnMuaXRlbXMubWFwKGZ1bmN0aW9uKGl0ZW0pe3ZhciB2YWx1ZT10eXBlb2YgaXRlbT09PSdzdHJpbmcnP2l0ZW06aXRlbS52YWx1ZXx8Jyc7dmFyIGNvbnRlbnQ9b3B0aW9ucy50ZW1wbGF0ZT9vcHRpb25zLnRlbXBsYXRlKGl0ZW0pOml0ZW07cmV0dXJuJzxsaT48YSBocmVmPVwiI1wiIGRhdGEtdmFsdWU9XCInK3ZhbHVlKydcIj4nK2NvbnRlbnQrJzwvYT48L2xpPic7fSkuam9pbignJyk6b3B0aW9ucy5pdGVtczskbm9kZS5odG1sKG1hcmt1cCk7fSk7dmFyIGRyb3Bkb3duQ2hlY2s9cmVuZGVyZXIuY3JlYXRlKCc8ZGl2IGNsYXNzPVwiZHJvcGRvd24tbWVudSBub3RlLWNoZWNrXCI+JyxmdW5jdGlvbigkbm9kZSxvcHRpb25zKXt2YXIgbWFya3VwPSQuaXNBcnJheShvcHRpb25zLml0ZW1zKT9vcHRpb25zLml0ZW1zLm1hcChmdW5jdGlvbihpdGVtKXt2YXIgdmFsdWU9dHlwZW9mIGl0ZW09PT0nc3RyaW5nJz9pdGVtOml0ZW0udmFsdWV8fCcnO3ZhciBjb250ZW50PW9wdGlvbnMudGVtcGxhdGU/b3B0aW9ucy50ZW1wbGF0ZShpdGVtKTppdGVtO3JldHVybic8bGk+PGEgaHJlZj1cIiNcIiBkYXRhLXZhbHVlPVwiJyt2YWx1ZSsnXCI+JytpY29uKG9wdGlvbnMuY2hlY2tDbGFzc05hbWUpKycgJytjb250ZW50Kyc8L2E+PC9saT4nO30pLmpvaW4oJycpOm9wdGlvbnMuaXRlbXM7JG5vZGUuaHRtbChtYXJrdXApO30pO3ZhciBwYWxldHRlPXJlbmRlcmVyLmNyZWF0ZSgnPGRpdiBjbGFzcz1cIm5vdGUtY29sb3ItcGFsZXR0ZVwiLz4nLGZ1bmN0aW9uKCRub2RlLG9wdGlvbnMpe3ZhciBjb250ZW50cz1bXTtmb3IodmFyIHJvdz0wLHJvd1NpemU9b3B0aW9ucy5jb2xvcnMubGVuZ3RoO3Jvdzxyb3dTaXplO3JvdysrKXt2YXIgZXZlbnROYW1lPW9wdGlvbnMuZXZlbnROYW1lO3ZhciBjb2xvcnM9b3B0aW9ucy5jb2xvcnNbcm93XTt2YXIgYnV0dG9ucz1bXTtmb3IodmFyIGNvbD0wLGNvbFNpemU9Y29sb3JzLmxlbmd0aDtjb2w8Y29sU2l6ZTtjb2wrKyl7dmFyIGNvbG9yPWNvbG9yc1tjb2xdO2J1dHRvbnMucHVzaChbJzxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwibm90ZS1jb2xvci1idG5cIicsJ3N0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjonLGNvbG9yLCdcIiAnLCdkYXRhLWV2ZW50PVwiJyxldmVudE5hbWUsJ1wiICcsJ2RhdGEtdmFsdWU9XCInLGNvbG9yLCdcIiAnLCd0aXRsZT1cIicsY29sb3IsJ1wiICcsJ2RhdGEtdG9nZ2xlPVwiYnV0dG9uXCIgdGFiaW5kZXg9XCItMVwiPjwvYnV0dG9uPiddLmpvaW4oJycpKTt9Y29udGVudHMucHVzaCgnPGRpdiBjbGFzcz1cIm5vdGUtY29sb3Itcm93XCI+JytidXR0b25zLmpvaW4oJycpKyc8L2Rpdj4nKTt9JG5vZGUuaHRtbChjb250ZW50cy5qb2luKCcnKSk7JG5vZGUuZmluZCgnLm5vdGUtY29sb3ItYnRuJykudG9vbHRpcCh7Y29udGFpbmVyOidib2R5Jyx0cmlnZ2VyOidob3ZlcicscGxhY2VtZW50Oidib3R0b20nfSk7fSk7dmFyIGRpYWxvZz1yZW5kZXJlci5jcmVhdGUoJzxkaXYgY2xhc3M9XCJtb2RhbFwiIGFyaWEtaGlkZGVuPVwiZmFsc2VcIiB0YWJpbmRleD1cIi0xXCIvPicsZnVuY3Rpb24oJG5vZGUsb3B0aW9ucyl7aWYob3B0aW9ucy5mYWRlKXskbm9kZS5hZGRDbGFzcygnZmFkZScpO30kbm9kZS5odG1sKFsnPGRpdiBjbGFzcz1cIm1vZGFsLWRpYWxvZ1wiPicsJyAgPGRpdiBjbGFzcz1cIm1vZGFsLWNvbnRlbnRcIj4nLG9wdGlvbnMudGl0bGU/JyAgICA8ZGl2IGNsYXNzPVwibW9kYWwtaGVhZGVyXCI+JysnICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJjbG9zZVwiIGRhdGEtZGlzbWlzcz1cIm1vZGFsXCIgYXJpYS1sYWJlbD1cIkNsb3NlXCI+PHNwYW4gYXJpYS1oaWRkZW49XCJ0cnVlXCI+JnRpbWVzOzwvc3Bhbj48L2J1dHRvbj4nKycgICAgICA8aDQgY2xhc3M9XCJtb2RhbC10aXRsZVwiPicrb3B0aW9ucy50aXRsZSsnPC9oND4nKycgICAgPC9kaXY+JzonJywnICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1ib2R5XCI+JytvcHRpb25zLmJvZHkrJzwvZGl2Picsb3B0aW9ucy5mb290ZXI/JyAgICA8ZGl2IGNsYXNzPVwibW9kYWwtZm9vdGVyXCI+JytvcHRpb25zLmZvb3RlcisnPC9kaXY+JzonJywnICA8L2Rpdj4nLCc8L2Rpdj4nXS5qb2luKCcnKSk7fSk7dmFyIHBvcG92ZXI9cmVuZGVyZXIuY3JlYXRlKFsnPGRpdiBjbGFzcz1cIm5vdGUtcG9wb3ZlciBwb3BvdmVyIGluXCI+JywnICA8ZGl2IGNsYXNzPVwiYXJyb3dcIi8+JywnICA8ZGl2IGNsYXNzPVwicG9wb3Zlci1jb250ZW50IG5vdGUtY2hpbGRyZW4tY29udGFpbmVyXCIvPicsJzwvZGl2PiddLmpvaW4oJycpLGZ1bmN0aW9uKCRub2RlLG9wdGlvbnMpe3ZhciBkaXJlY3Rpb249dHlwZW9mIG9wdGlvbnMuZGlyZWN0aW9uIT09J3VuZGVmaW5lZCc/b3B0aW9ucy5kaXJlY3Rpb246J2JvdHRvbSc7JG5vZGUuYWRkQ2xhc3MoZGlyZWN0aW9uKTtpZihvcHRpb25zLmhpZGVBcnJvdyl7JG5vZGUuZmluZCgnLmFycm93JykuaGlkZSgpO319KTt2YXIgaWNvbj1mdW5jdGlvbihpY29uQ2xhc3NOYW1lLHRhZ05hbWUpe3RhZ05hbWU9dGFnTmFtZXx8J2knO3JldHVybic8Jyt0YWdOYW1lKycgY2xhc3M9XCInK2ljb25DbGFzc05hbWUrJ1wiLz4nO307dmFyIHVpPXtlZGl0b3I6ZWRpdG9yLHRvb2xiYXI6dG9vbGJhcixlZGl0aW5nQXJlYTplZGl0aW5nQXJlYSxjb2RhYmxlOmNvZGFibGUsZWRpdGFibGU6ZWRpdGFibGUsc3RhdHVzYmFyOnN0YXR1c2JhcixhaXJFZGl0b3I6YWlyRWRpdG9yLGFpckVkaXRhYmxlOmFpckVkaXRhYmxlLGJ1dHRvbkdyb3VwOmJ1dHRvbkdyb3VwLGJ1dHRvbjpidXR0b24sZHJvcGRvd246ZHJvcGRvd24sZHJvcGRvd25DaGVjazpkcm9wZG93bkNoZWNrLHBhbGV0dGU6cGFsZXR0ZSxkaWFsb2c6ZGlhbG9nLHBvcG92ZXI6cG9wb3ZlcixpY29uOmljb24sdG9nZ2xlQnRuOmZ1bmN0aW9uKCRidG4saXNFbmFibGUpeyRidG4udG9nZ2xlQ2xhc3MoJ2Rpc2FibGVkJywhaXNFbmFibGUpOyRidG4uYXR0cignZGlzYWJsZWQnLCFpc0VuYWJsZSk7fSx0b2dnbGVCdG5BY3RpdmU6ZnVuY3Rpb24oJGJ0bixpc0FjdGl2ZSl7JGJ0bi50b2dnbGVDbGFzcygnYWN0aXZlJyxpc0FjdGl2ZSk7fSxvbkRpYWxvZ1Nob3duOmZ1bmN0aW9uKCRkaWFsb2csaGFuZGxlcil7JGRpYWxvZy5vbmUoJ3Nob3duLmJzLm1vZGFsJyxoYW5kbGVyKTt9LG9uRGlhbG9nSGlkZGVuOmZ1bmN0aW9uKCRkaWFsb2csaGFuZGxlcil7JGRpYWxvZy5vbmUoJ2hpZGRlbi5icy5tb2RhbCcsaGFuZGxlcik7fSxzaG93RGlhbG9nOmZ1bmN0aW9uKCRkaWFsb2cpeyRkaWFsb2cubW9kYWwoJ3Nob3cnKTt9LGhpZGVEaWFsb2c6ZnVuY3Rpb24oJGRpYWxvZyl7JGRpYWxvZy5tb2RhbCgnaGlkZScpO30sY3JlYXRlTGF5b3V0OmZ1bmN0aW9uKCRub3RlLG9wdGlvbnMpe3ZhciAkZWRpdG9yPShvcHRpb25zLmFpck1vZGU/dWkuYWlyRWRpdG9yKFt1aS5lZGl0aW5nQXJlYShbdWkuYWlyRWRpdGFibGUoKV0pXSk6dWkuZWRpdG9yKFt1aS50b29sYmFyKCksdWkuZWRpdGluZ0FyZWEoW3VpLmNvZGFibGUoKSx1aS5lZGl0YWJsZSgpXSksdWkuc3RhdHVzYmFyKCldKSkucmVuZGVyKCk7JGVkaXRvci5pbnNlcnRBZnRlcigkbm90ZSk7cmV0dXJue25vdGU6JG5vdGUsZWRpdG9yOiRlZGl0b3IsdG9vbGJhcjokZWRpdG9yLmZpbmQoJy5ub3RlLXRvb2xiYXInKSxlZGl0aW5nQXJlYTokZWRpdG9yLmZpbmQoJy5ub3RlLWVkaXRpbmctYXJlYScpLGVkaXRhYmxlOiRlZGl0b3IuZmluZCgnLm5vdGUtZWRpdGFibGUnKSxjb2RhYmxlOiRlZGl0b3IuZmluZCgnLm5vdGUtY29kYWJsZScpLHN0YXR1c2JhcjokZWRpdG9yLmZpbmQoJy5ub3RlLXN0YXR1c2JhcicpfTt9LHJlbW92ZUxheW91dDpmdW5jdGlvbigkbm90ZSxsYXlvdXRJbmZvKXskbm90ZS5odG1sKGxheW91dEluZm8uZWRpdGFibGUuaHRtbCgpKTtsYXlvdXRJbmZvLmVkaXRvci5yZW1vdmUoKTskbm90ZS5zaG93KCk7fX07JC5zdW1tZXJub3RlPSQuc3VtbWVybm90ZXx8e2xhbmc6e319OyQuZXh0ZW5kKCQuc3VtbWVybm90ZS5sYW5nLHsnZW4tVVMnOntmb250Ontib2xkOidCb2xkJyxpdGFsaWM6J0l0YWxpYycsdW5kZXJsaW5lOidVbmRlcmxpbmUnLGNsZWFyOidSZW1vdmUgRm9udCBTdHlsZScsaGVpZ2h0OidMaW5lIEhlaWdodCcsbmFtZTonRm9udCBGYW1pbHknLHN0cmlrZXRocm91Z2g6J1N0cmlrZXRocm91Z2gnLHN1YnNjcmlwdDonU3Vic2NyaXB0JyxzdXBlcnNjcmlwdDonU3VwZXJzY3JpcHQnLHNpemU6J0ZvbnQgU2l6ZSd9LGltYWdlOntpbWFnZTonUGljdHVyZScsaW5zZXJ0OidJbnNlcnQgSW1hZ2UnLHJlc2l6ZUZ1bGw6J1Jlc2l6ZSBGdWxsJyxyZXNpemVIYWxmOidSZXNpemUgSGFsZicscmVzaXplUXVhcnRlcjonUmVzaXplIFF1YXJ0ZXInLGZsb2F0TGVmdDonRmxvYXQgTGVmdCcsZmxvYXRSaWdodDonRmxvYXQgUmlnaHQnLGZsb2F0Tm9uZTonRmxvYXQgTm9uZScsc2hhcGVSb3VuZGVkOidTaGFwZTogUm91bmRlZCcsc2hhcGVDaXJjbGU6J1NoYXBlOiBDaXJjbGUnLHNoYXBlVGh1bWJuYWlsOidTaGFwZTogVGh1bWJuYWlsJyxzaGFwZU5vbmU6J1NoYXBlOiBOb25lJyxkcmFnSW1hZ2VIZXJlOidEcmFnIGltYWdlIG9yIHRleHQgaGVyZScsZHJvcEltYWdlOidEcm9wIGltYWdlIG9yIFRleHQnLHNlbGVjdEZyb21GaWxlczonU2VsZWN0IGZyb20gZmlsZXMnLG1heGltdW1GaWxlU2l6ZTonTWF4aW11bSBmaWxlIHNpemUnLG1heGltdW1GaWxlU2l6ZUVycm9yOidNYXhpbXVtIGZpbGUgc2l6ZSBleGNlZWRlZC4nLHVybDonSW1hZ2UgVVJMJyxyZW1vdmU6J1JlbW92ZSBJbWFnZSd9LHZpZGVvOnt2aWRlbzonVmlkZW8nLHZpZGVvTGluazonVmlkZW8gTGluaycsaW5zZXJ0OidJbnNlcnQgVmlkZW8nLHVybDonVmlkZW8gVVJMPycscHJvdmlkZXJzOicoWW91VHViZSwgVmltZW8sIFZpbmUsIEluc3RhZ3JhbSwgRGFpbHlNb3Rpb24gb3IgWW91a3UpJ30sbGluazp7bGluazonTGluaycsaW5zZXJ0OidJbnNlcnQgTGluaycsdW5saW5rOidVbmxpbmsnLGVkaXQ6J0VkaXQnLHRleHRUb0Rpc3BsYXk6J1RleHQgdG8gZGlzcGxheScsdXJsOidUbyB3aGF0IFVSTCBzaG91bGQgdGhpcyBsaW5rIGdvPycsb3BlbkluTmV3V2luZG93OidPcGVuIGluIG5ldyB3aW5kb3cnfSx0YWJsZTp7dGFibGU6J1RhYmxlJ30saHI6e2luc2VydDonSW5zZXJ0IEhvcml6b250YWwgUnVsZSd9LHN0eWxlOntzdHlsZTonU3R5bGUnLG5vcm1hbDonTm9ybWFsJyxibG9ja3F1b3RlOidRdW90ZScscHJlOidDb2RlJyxoMTonSGVhZGVyIDEnLGgyOidIZWFkZXIgMicsaDM6J0hlYWRlciAzJyxoNDonSGVhZGVyIDQnLGg1OidIZWFkZXIgNScsaDY6J0hlYWRlciA2J30sbGlzdHM6e3Vub3JkZXJlZDonVW5vcmRlcmVkIGxpc3QnLG9yZGVyZWQ6J09yZGVyZWQgbGlzdCd9LG9wdGlvbnM6e2hlbHA6J0hlbHAnLGZ1bGxzY3JlZW46J0Z1bGwgU2NyZWVuJyxjb2RldmlldzonQ29kZSBWaWV3J30scGFyYWdyYXBoOntwYXJhZ3JhcGg6J1BhcmFncmFwaCcsb3V0ZGVudDonT3V0ZGVudCcsaW5kZW50OidJbmRlbnQnLGxlZnQ6J0FsaWduIGxlZnQnLGNlbnRlcjonQWxpZ24gY2VudGVyJyxyaWdodDonQWxpZ24gcmlnaHQnLGp1c3RpZnk6J0p1c3RpZnkgZnVsbCd9LGNvbG9yOntyZWNlbnQ6J1JlY2VudCBDb2xvcicsbW9yZTonTW9yZSBDb2xvcicsYmFja2dyb3VuZDonQmFja2dyb3VuZCBDb2xvcicsZm9yZWdyb3VuZDonRm9yZWdyb3VuZCBDb2xvcicsdHJhbnNwYXJlbnQ6J1RyYW5zcGFyZW50JyxzZXRUcmFuc3BhcmVudDonU2V0IHRyYW5zcGFyZW50JyxyZXNldDonUmVzZXQnLHJlc2V0VG9EZWZhdWx0OidSZXNldCB0byBkZWZhdWx0J30sc2hvcnRjdXQ6e3Nob3J0Y3V0czonS2V5Ym9hcmQgc2hvcnRjdXRzJyxjbG9zZTonQ2xvc2UnLHRleHRGb3JtYXR0aW5nOidUZXh0IGZvcm1hdHRpbmcnLGFjdGlvbjonQWN0aW9uJyxwYXJhZ3JhcGhGb3JtYXR0aW5nOidQYXJhZ3JhcGggZm9ybWF0dGluZycsZG9jdW1lbnRTdHlsZTonRG9jdW1lbnQgU3R5bGUnLGV4dHJhS2V5czonRXh0cmEga2V5cyd9LGhlbHA6eydpbnNlcnRQYXJhZ3JhcGgnOidJbnNlcnQgUGFyYWdyYXBoJywndW5kbyc6J1VuZG9lcyB0aGUgbGFzdCBjb21tYW5kJywncmVkbyc6J1JlZG9lcyB0aGUgbGFzdCBjb21tYW5kJywndGFiJzonVGFiJywndW50YWInOidVbnRhYicsJ2JvbGQnOidTZXQgYSBib2xkIHN0eWxlJywnaXRhbGljJzonU2V0IGEgaXRhbGljIHN0eWxlJywndW5kZXJsaW5lJzonU2V0IGEgdW5kZXJsaW5lIHN0eWxlJywnc3RyaWtldGhyb3VnaCc6J1NldCBhIHN0cmlrZXRocm91Z2ggc3R5bGUnLCdyZW1vdmVGb3JtYXQnOidDbGVhbiBhIHN0eWxlJywnanVzdGlmeUxlZnQnOidTZXQgbGVmdCBhbGlnbicsJ2p1c3RpZnlDZW50ZXInOidTZXQgY2VudGVyIGFsaWduJywnanVzdGlmeVJpZ2h0JzonU2V0IHJpZ2h0IGFsaWduJywnanVzdGlmeUZ1bGwnOidTZXQgZnVsbCBhbGlnbicsJ2luc2VydFVub3JkZXJlZExpc3QnOidUb2dnbGUgdW5vcmRlcmVkIGxpc3QnLCdpbnNlcnRPcmRlcmVkTGlzdCc6J1RvZ2dsZSBvcmRlcmVkIGxpc3QnLCdvdXRkZW50JzonT3V0ZGVudCBvbiBjdXJyZW50IHBhcmFncmFwaCcsJ2luZGVudCc6J0luZGVudCBvbiBjdXJyZW50IHBhcmFncmFwaCcsJ2Zvcm1hdFBhcmEnOidDaGFuZ2UgY3VycmVudCBibG9ja1xcJ3MgZm9ybWF0IGFzIGEgcGFyYWdyYXBoKFAgdGFnKScsJ2Zvcm1hdEgxJzonQ2hhbmdlIGN1cnJlbnQgYmxvY2tcXCdzIGZvcm1hdCBhcyBIMScsJ2Zvcm1hdEgyJzonQ2hhbmdlIGN1cnJlbnQgYmxvY2tcXCdzIGZvcm1hdCBhcyBIMicsJ2Zvcm1hdEgzJzonQ2hhbmdlIGN1cnJlbnQgYmxvY2tcXCdzIGZvcm1hdCBhcyBIMycsJ2Zvcm1hdEg0JzonQ2hhbmdlIGN1cnJlbnQgYmxvY2tcXCdzIGZvcm1hdCBhcyBINCcsJ2Zvcm1hdEg1JzonQ2hhbmdlIGN1cnJlbnQgYmxvY2tcXCdzIGZvcm1hdCBhcyBINScsJ2Zvcm1hdEg2JzonQ2hhbmdlIGN1cnJlbnQgYmxvY2tcXCdzIGZvcm1hdCBhcyBINicsJ2luc2VydEhvcml6b250YWxSdWxlJzonSW5zZXJ0IGhvcml6b250YWwgcnVsZScsJ2xpbmtEaWFsb2cuc2hvdyc6J1Nob3cgTGluayBEaWFsb2cnfSxoaXN0b3J5Ont1bmRvOidVbmRvJyxyZWRvOidSZWRvJ30sc3BlY2lhbENoYXI6e3NwZWNpYWxDaGFyOidTUEVDSUFMIENIQVJBQ1RFUlMnLHNlbGVjdDonU2VsZWN0IFNwZWNpYWwgY2hhcmFjdGVycyd9fX0pOy8qKlxuICAgKiBAY2xhc3MgY29yZS5rZXlcbiAgICpcbiAgICogT2JqZWN0IGZvciBrZXljb2Rlcy5cbiAgICpcbiAgICogQHNpbmdsZXRvblxuICAgKiBAYWx0ZXJuYXRlQ2xhc3NOYW1lIGtleVxuICAgKi92YXIga2V5PWZ1bmN0aW9uKCl7dmFyIGtleU1hcD17J0JBQ0tTUEFDRSc6OCwnVEFCJzo5LCdFTlRFUic6MTMsJ1NQQUNFJzozMiwvLyBBcnJvd1xuJ0xFRlQnOjM3LCdVUCc6MzgsJ1JJR0hUJzozOSwnRE9XTic6NDAsLy8gTnVtYmVyOiAwLTlcbidOVU0wJzo0OCwnTlVNMSc6NDksJ05VTTInOjUwLCdOVU0zJzo1MSwnTlVNNCc6NTIsJ05VTTUnOjUzLCdOVU02Jzo1NCwnTlVNNyc6NTUsJ05VTTgnOjU2LC8vIEFscGhhYmV0OiBhLXpcbidCJzo2NiwnRSc6NjksJ0knOjczLCdKJzo3NCwnSyc6NzUsJ0wnOjc2LCdSJzo4MiwnUyc6ODMsJ1UnOjg1LCdWJzo4NiwnWSc6ODksJ1onOjkwLCdTTEFTSCc6MTkxLCdMRUZUQlJBQ0tFVCc6MjE5LCdCQUNLU0xBU0gnOjIyMCwnUklHSFRCUkFDS0VUJzoyMjF9O3JldHVybnsvKipcbiAgICAgICAqIEBtZXRob2QgaXNFZGl0XG4gICAgICAgKlxuICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IGtleUNvZGVcbiAgICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICAgKi9pc0VkaXQ6ZnVuY3Rpb24oa2V5Q29kZSl7cmV0dXJuIGxpc3QuY29udGFpbnMoW2tleU1hcC5CQUNLU1BBQ0Usa2V5TWFwLlRBQixrZXlNYXAuRU5URVIsa2V5TWFwLlNQQUNFXSxrZXlDb2RlKTt9LC8qKlxuICAgICAgICogQG1ldGhvZCBpc01vdmVcbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0ge051bWJlcn0ga2V5Q29kZVxuICAgICAgICogQHJldHVybiB7Qm9vbGVhbn1cbiAgICAgICAqL2lzTW92ZTpmdW5jdGlvbihrZXlDb2RlKXtyZXR1cm4gbGlzdC5jb250YWlucyhba2V5TWFwLkxFRlQsa2V5TWFwLlVQLGtleU1hcC5SSUdIVCxrZXlNYXAuRE9XTl0sa2V5Q29kZSk7fSwvKipcbiAgICAgICAqIEBwcm9wZXJ0eSB7T2JqZWN0fSBuYW1lRnJvbUNvZGVcbiAgICAgICAqIEBwcm9wZXJ0eSB7U3RyaW5nfSBuYW1lRnJvbUNvZGUuOCBcIkJBQ0tTUEFDRVwiXG4gICAgICAgKi9uYW1lRnJvbUNvZGU6ZnVuYy5pbnZlcnRPYmplY3Qoa2V5TWFwKSxjb2RlOmtleU1hcH07fSgpO3ZhciByYW5nZT1mdW5jdGlvbigpey8qKlxuICAgICAqIHJldHVybiBib3VuZGFyeVBvaW50IGZyb20gVGV4dFJhbmdlLCBpbnNwaXJlZCBieSBBbmR5IE5hJ3MgSHVza3lSYW5nZS5qc1xuICAgICAqXG4gICAgICogQHBhcmFtIHtUZXh0UmFuZ2V9IHRleHRSYW5nZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gaXNTdGFydFxuICAgICAqIEByZXR1cm4ge0JvdW5kYXJ5UG9pbnR9XG4gICAgICpcbiAgICAgKiBAc2VlIGh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9pZS9tczUzNTg3Mih2PXZzLjg1KS5hc3B4XG4gICAgICovdmFyIHRleHRSYW5nZVRvUG9pbnQ9ZnVuY3Rpb24odGV4dFJhbmdlLGlzU3RhcnQpe3ZhciBjb250YWluZXI9dGV4dFJhbmdlLnBhcmVudEVsZW1lbnQoKSxvZmZzZXQ7dmFyIHRlc3Rlcj1kb2N1bWVudC5ib2R5LmNyZWF0ZVRleHRSYW5nZSgpLHByZXZDb250YWluZXI7dmFyIGNoaWxkTm9kZXM9bGlzdC5mcm9tKGNvbnRhaW5lci5jaGlsZE5vZGVzKTtmb3Iob2Zmc2V0PTA7b2Zmc2V0PGNoaWxkTm9kZXMubGVuZ3RoO29mZnNldCsrKXtpZihkb20uaXNUZXh0KGNoaWxkTm9kZXNbb2Zmc2V0XSkpe2NvbnRpbnVlO310ZXN0ZXIubW92ZVRvRWxlbWVudFRleHQoY2hpbGROb2Rlc1tvZmZzZXRdKTtpZih0ZXN0ZXIuY29tcGFyZUVuZFBvaW50cygnU3RhcnRUb1N0YXJ0Jyx0ZXh0UmFuZ2UpPj0wKXticmVhazt9cHJldkNvbnRhaW5lcj1jaGlsZE5vZGVzW29mZnNldF07fWlmKG9mZnNldCE9PTAmJmRvbS5pc1RleHQoY2hpbGROb2Rlc1tvZmZzZXQtMV0pKXt2YXIgdGV4dFJhbmdlU3RhcnQ9ZG9jdW1lbnQuYm9keS5jcmVhdGVUZXh0UmFuZ2UoKSxjdXJUZXh0Tm9kZT1udWxsO3RleHRSYW5nZVN0YXJ0Lm1vdmVUb0VsZW1lbnRUZXh0KHByZXZDb250YWluZXJ8fGNvbnRhaW5lcik7dGV4dFJhbmdlU3RhcnQuY29sbGFwc2UoIXByZXZDb250YWluZXIpO2N1clRleHROb2RlPXByZXZDb250YWluZXI/cHJldkNvbnRhaW5lci5uZXh0U2libGluZzpjb250YWluZXIuZmlyc3RDaGlsZDt2YXIgcG9pbnRUZXN0ZXI9dGV4dFJhbmdlLmR1cGxpY2F0ZSgpO3BvaW50VGVzdGVyLnNldEVuZFBvaW50KCdTdGFydFRvU3RhcnQnLHRleHRSYW5nZVN0YXJ0KTt2YXIgdGV4dENvdW50PXBvaW50VGVzdGVyLnRleHQucmVwbGFjZSgvW1xcclxcbl0vZywnJykubGVuZ3RoO3doaWxlKHRleHRDb3VudD5jdXJUZXh0Tm9kZS5ub2RlVmFsdWUubGVuZ3RoJiZjdXJUZXh0Tm9kZS5uZXh0U2libGluZyl7dGV4dENvdW50LT1jdXJUZXh0Tm9kZS5ub2RlVmFsdWUubGVuZ3RoO2N1clRleHROb2RlPWN1clRleHROb2RlLm5leHRTaWJsaW5nO30vKiBqc2hpbnQgaWdub3JlOnN0YXJ0ICovdmFyIGR1bW15PWN1clRleHROb2RlLm5vZGVWYWx1ZTsvLyBlbmZvcmNlIElFIHRvIHJlLXJlZmVyZW5jZSBjdXJUZXh0Tm9kZSwgaGFja1xuLyoganNoaW50IGlnbm9yZTplbmQgKi9pZihpc1N0YXJ0JiZjdXJUZXh0Tm9kZS5uZXh0U2libGluZyYmZG9tLmlzVGV4dChjdXJUZXh0Tm9kZS5uZXh0U2libGluZykmJnRleHRDb3VudD09PWN1clRleHROb2RlLm5vZGVWYWx1ZS5sZW5ndGgpe3RleHRDb3VudC09Y3VyVGV4dE5vZGUubm9kZVZhbHVlLmxlbmd0aDtjdXJUZXh0Tm9kZT1jdXJUZXh0Tm9kZS5uZXh0U2libGluZzt9Y29udGFpbmVyPWN1clRleHROb2RlO29mZnNldD10ZXh0Q291bnQ7fXJldHVybntjb250OmNvbnRhaW5lcixvZmZzZXQ6b2Zmc2V0fTt9Oy8qKlxuICAgICAqIHJldHVybiBUZXh0UmFuZ2UgZnJvbSBib3VuZGFyeSBwb2ludCAoaW5zcGlyZWQgYnkgZ29vZ2xlIGNsb3N1cmUtbGlicmFyeSlcbiAgICAgKiBAcGFyYW0ge0JvdW5kYXJ5UG9pbnR9IHBvaW50XG4gICAgICogQHJldHVybiB7VGV4dFJhbmdlfVxuICAgICAqL3ZhciBwb2ludFRvVGV4dFJhbmdlPWZ1bmN0aW9uKHBvaW50KXt2YXIgdGV4dFJhbmdlSW5mbz1mdW5jdGlvbihjb250YWluZXIsb2Zmc2V0KXt2YXIgbm9kZSxpc0NvbGxhcHNlVG9TdGFydDtpZihkb20uaXNUZXh0KGNvbnRhaW5lcikpe3ZhciBwcmV2VGV4dE5vZGVzPWRvbS5saXN0UHJldihjb250YWluZXIsZnVuYy5ub3QoZG9tLmlzVGV4dCkpO3ZhciBwcmV2Q29udGFpbmVyPWxpc3QubGFzdChwcmV2VGV4dE5vZGVzKS5wcmV2aW91c1NpYmxpbmc7bm9kZT1wcmV2Q29udGFpbmVyfHxjb250YWluZXIucGFyZW50Tm9kZTtvZmZzZXQrPWxpc3Quc3VtKGxpc3QudGFpbChwcmV2VGV4dE5vZGVzKSxkb20ubm9kZUxlbmd0aCk7aXNDb2xsYXBzZVRvU3RhcnQ9IXByZXZDb250YWluZXI7fWVsc2V7bm9kZT1jb250YWluZXIuY2hpbGROb2Rlc1tvZmZzZXRdfHxjb250YWluZXI7aWYoZG9tLmlzVGV4dChub2RlKSl7cmV0dXJuIHRleHRSYW5nZUluZm8obm9kZSwwKTt9b2Zmc2V0PTA7aXNDb2xsYXBzZVRvU3RhcnQ9ZmFsc2U7fXJldHVybntub2RlOm5vZGUsY29sbGFwc2VUb1N0YXJ0OmlzQ29sbGFwc2VUb1N0YXJ0LG9mZnNldDpvZmZzZXR9O307dmFyIHRleHRSYW5nZT1kb2N1bWVudC5ib2R5LmNyZWF0ZVRleHRSYW5nZSgpO3ZhciBpbmZvPXRleHRSYW5nZUluZm8ocG9pbnQubm9kZSxwb2ludC5vZmZzZXQpO3RleHRSYW5nZS5tb3ZlVG9FbGVtZW50VGV4dChpbmZvLm5vZGUpO3RleHRSYW5nZS5jb2xsYXBzZShpbmZvLmNvbGxhcHNlVG9TdGFydCk7dGV4dFJhbmdlLm1vdmVTdGFydCgnY2hhcmFjdGVyJyxpbmZvLm9mZnNldCk7cmV0dXJuIHRleHRSYW5nZTt9Oy8qKlxuICAgICAqIFdyYXBwZWQgUmFuZ2VcbiAgICAgKlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7Tm9kZX0gc2MgLSBzdGFydCBjb250YWluZXJcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gc28gLSBzdGFydCBvZmZzZXRcbiAgICAgKiBAcGFyYW0ge05vZGV9IGVjIC0gZW5kIGNvbnRhaW5lclxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBlbyAtIGVuZCBvZmZzZXRcbiAgICAgKi92YXIgV3JhcHBlZFJhbmdlPWZ1bmN0aW9uKHNjLHNvLGVjLGVvKXt0aGlzLnNjPXNjO3RoaXMuc289c287dGhpcy5lYz1lYzt0aGlzLmVvPWVvOy8vIG5hdGl2ZVJhbmdlOiBnZXQgbmF0aXZlUmFuZ2UgZnJvbSBzYywgc28sIGVjLCBlb1xudmFyIG5hdGl2ZVJhbmdlPWZ1bmN0aW9uKCl7aWYoYWdlbnQuaXNXM0NSYW5nZVN1cHBvcnQpe3ZhciB3M2NSYW5nZT1kb2N1bWVudC5jcmVhdGVSYW5nZSgpO3czY1JhbmdlLnNldFN0YXJ0KHNjLHNvKTt3M2NSYW5nZS5zZXRFbmQoZWMsZW8pO3JldHVybiB3M2NSYW5nZTt9ZWxzZXt2YXIgdGV4dFJhbmdlPXBvaW50VG9UZXh0UmFuZ2Uoe25vZGU6c2Msb2Zmc2V0OnNvfSk7dGV4dFJhbmdlLnNldEVuZFBvaW50KCdFbmRUb0VuZCcscG9pbnRUb1RleHRSYW5nZSh7bm9kZTplYyxvZmZzZXQ6ZW99KSk7cmV0dXJuIHRleHRSYW5nZTt9fTt0aGlzLmdldFBvaW50cz1mdW5jdGlvbigpe3JldHVybntzYzpzYyxzbzpzbyxlYzplYyxlbzplb307fTt0aGlzLmdldFN0YXJ0UG9pbnQ9ZnVuY3Rpb24oKXtyZXR1cm57bm9kZTpzYyxvZmZzZXQ6c299O307dGhpcy5nZXRFbmRQb2ludD1mdW5jdGlvbigpe3JldHVybntub2RlOmVjLG9mZnNldDplb307fTsvKipcbiAgICAgICAqIHNlbGVjdCB1cGRhdGUgdmlzaWJsZSByYW5nZVxuICAgICAgICovdGhpcy5zZWxlY3Q9ZnVuY3Rpb24oKXt2YXIgbmF0aXZlUm5nPW5hdGl2ZVJhbmdlKCk7aWYoYWdlbnQuaXNXM0NSYW5nZVN1cHBvcnQpe3ZhciBzZWxlY3Rpb249ZG9jdW1lbnQuZ2V0U2VsZWN0aW9uKCk7aWYoc2VsZWN0aW9uLnJhbmdlQ291bnQ+MCl7c2VsZWN0aW9uLnJlbW92ZUFsbFJhbmdlcygpO31zZWxlY3Rpb24uYWRkUmFuZ2UobmF0aXZlUm5nKTt9ZWxzZXtuYXRpdmVSbmcuc2VsZWN0KCk7fXJldHVybiB0aGlzO307LyoqXG4gICAgICAgKiBNb3ZlcyB0aGUgc2Nyb2xsYmFyIHRvIHN0YXJ0IGNvbnRhaW5lcihzYykgb2YgY3VycmVudCByYW5nZVxuICAgICAgICpcbiAgICAgICAqIEByZXR1cm4ge1dyYXBwZWRSYW5nZX1cbiAgICAgICAqL3RoaXMuc2Nyb2xsSW50b1ZpZXc9ZnVuY3Rpb24oY29udGFpbmVyKXt2YXIgaGVpZ2h0PSQoY29udGFpbmVyKS5oZWlnaHQoKTtpZihjb250YWluZXIuc2Nyb2xsVG9wK2hlaWdodDx0aGlzLnNjLm9mZnNldFRvcCl7Y29udGFpbmVyLnNjcm9sbFRvcCs9TWF0aC5hYnMoY29udGFpbmVyLnNjcm9sbFRvcCtoZWlnaHQtdGhpcy5zYy5vZmZzZXRUb3ApO31yZXR1cm4gdGhpczt9Oy8qKlxuICAgICAgICogQHJldHVybiB7V3JhcHBlZFJhbmdlfVxuICAgICAgICovdGhpcy5ub3JtYWxpemU9ZnVuY3Rpb24oKXsvKipcbiAgICAgICAgICogQHBhcmFtIHtCb3VuZGFyeVBvaW50fSBwb2ludFxuICAgICAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IGlzTGVmdFRvUmlnaHRcbiAgICAgICAgICogQHJldHVybiB7Qm91bmRhcnlQb2ludH1cbiAgICAgICAgICovdmFyIGdldFZpc2libGVQb2ludD1mdW5jdGlvbihwb2ludCxpc0xlZnRUb1JpZ2h0KXtpZihkb20uaXNWaXNpYmxlUG9pbnQocG9pbnQpJiYhZG9tLmlzRWRnZVBvaW50KHBvaW50KXx8ZG9tLmlzVmlzaWJsZVBvaW50KHBvaW50KSYmZG9tLmlzUmlnaHRFZGdlUG9pbnQocG9pbnQpJiYhaXNMZWZ0VG9SaWdodHx8ZG9tLmlzVmlzaWJsZVBvaW50KHBvaW50KSYmZG9tLmlzTGVmdEVkZ2VQb2ludChwb2ludCkmJmlzTGVmdFRvUmlnaHR8fGRvbS5pc1Zpc2libGVQb2ludChwb2ludCkmJmRvbS5pc0Jsb2NrKHBvaW50Lm5vZGUpJiZkb20uaXNFbXB0eShwb2ludC5ub2RlKSl7cmV0dXJuIHBvaW50O30vLyBwb2ludCBvbiBibG9jaydzIGVkZ2VcbnZhciBibG9jaz1kb20uYW5jZXN0b3IocG9pbnQubm9kZSxkb20uaXNCbG9jayk7aWYoKGRvbS5pc0xlZnRFZGdlUG9pbnRPZihwb2ludCxibG9jayl8fGRvbS5pc1ZvaWQoZG9tLnByZXZQb2ludChwb2ludCkubm9kZSkpJiYhaXNMZWZ0VG9SaWdodHx8KGRvbS5pc1JpZ2h0RWRnZVBvaW50T2YocG9pbnQsYmxvY2spfHxkb20uaXNWb2lkKGRvbS5uZXh0UG9pbnQocG9pbnQpLm5vZGUpKSYmaXNMZWZ0VG9SaWdodCl7Ly8gcmV0dXJucyBwb2ludCBhbHJlYWR5IG9uIHZpc2libGUgcG9pbnRcbmlmKGRvbS5pc1Zpc2libGVQb2ludChwb2ludCkpe3JldHVybiBwb2ludDt9Ly8gcmV2ZXJzZSBkaXJlY3Rpb24gXG5pc0xlZnRUb1JpZ2h0PSFpc0xlZnRUb1JpZ2h0O312YXIgbmV4dFBvaW50PWlzTGVmdFRvUmlnaHQ/ZG9tLm5leHRQb2ludFVudGlsKGRvbS5uZXh0UG9pbnQocG9pbnQpLGRvbS5pc1Zpc2libGVQb2ludCk6ZG9tLnByZXZQb2ludFVudGlsKGRvbS5wcmV2UG9pbnQocG9pbnQpLGRvbS5pc1Zpc2libGVQb2ludCk7cmV0dXJuIG5leHRQb2ludHx8cG9pbnQ7fTt2YXIgZW5kUG9pbnQ9Z2V0VmlzaWJsZVBvaW50KHRoaXMuZ2V0RW5kUG9pbnQoKSxmYWxzZSk7dmFyIHN0YXJ0UG9pbnQ9dGhpcy5pc0NvbGxhcHNlZCgpP2VuZFBvaW50OmdldFZpc2libGVQb2ludCh0aGlzLmdldFN0YXJ0UG9pbnQoKSx0cnVlKTtyZXR1cm4gbmV3IFdyYXBwZWRSYW5nZShzdGFydFBvaW50Lm5vZGUsc3RhcnRQb2ludC5vZmZzZXQsZW5kUG9pbnQubm9kZSxlbmRQb2ludC5vZmZzZXQpO307LyoqXG4gICAgICAgKiByZXR1cm5zIG1hdGNoZWQgbm9kZXMgb24gcmFuZ2VcbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbcHJlZF0gLSBwcmVkaWNhdGUgZnVuY3Rpb25cbiAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc11cbiAgICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW29wdGlvbnMuaW5jbHVkZUFuY2VzdG9yXVxuICAgICAgICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5mdWxseUNvbnRhaW5zXVxuICAgICAgICogQHJldHVybiB7Tm9kZVtdfVxuICAgICAgICovdGhpcy5ub2Rlcz1mdW5jdGlvbihwcmVkLG9wdGlvbnMpe3ByZWQ9cHJlZHx8ZnVuYy5vazt2YXIgaW5jbHVkZUFuY2VzdG9yPW9wdGlvbnMmJm9wdGlvbnMuaW5jbHVkZUFuY2VzdG9yO3ZhciBmdWxseUNvbnRhaW5zPW9wdGlvbnMmJm9wdGlvbnMuZnVsbHlDb250YWluczsvLyBUT0RPIGNvbXBhcmUgcG9pbnRzIGFuZCBzb3J0XG52YXIgc3RhcnRQb2ludD10aGlzLmdldFN0YXJ0UG9pbnQoKTt2YXIgZW5kUG9pbnQ9dGhpcy5nZXRFbmRQb2ludCgpO3ZhciBub2Rlcz1bXTt2YXIgbGVmdEVkZ2VOb2Rlcz1bXTtkb20ud2Fsa1BvaW50KHN0YXJ0UG9pbnQsZW5kUG9pbnQsZnVuY3Rpb24ocG9pbnQpe2lmKGRvbS5pc0VkaXRhYmxlKHBvaW50Lm5vZGUpKXtyZXR1cm47fXZhciBub2RlO2lmKGZ1bGx5Q29udGFpbnMpe2lmKGRvbS5pc0xlZnRFZGdlUG9pbnQocG9pbnQpKXtsZWZ0RWRnZU5vZGVzLnB1c2gocG9pbnQubm9kZSk7fWlmKGRvbS5pc1JpZ2h0RWRnZVBvaW50KHBvaW50KSYmbGlzdC5jb250YWlucyhsZWZ0RWRnZU5vZGVzLHBvaW50Lm5vZGUpKXtub2RlPXBvaW50Lm5vZGU7fX1lbHNlIGlmKGluY2x1ZGVBbmNlc3Rvcil7bm9kZT1kb20uYW5jZXN0b3IocG9pbnQubm9kZSxwcmVkKTt9ZWxzZXtub2RlPXBvaW50Lm5vZGU7fWlmKG5vZGUmJnByZWQobm9kZSkpe25vZGVzLnB1c2gobm9kZSk7fX0sdHJ1ZSk7cmV0dXJuIGxpc3QudW5pcXVlKG5vZGVzKTt9Oy8qKlxuICAgICAgICogcmV0dXJucyBjb21tb25BbmNlc3RvciBvZiByYW5nZVxuICAgICAgICogQHJldHVybiB7RWxlbWVudH0gLSBjb21tb25BbmNlc3RvclxuICAgICAgICovdGhpcy5jb21tb25BbmNlc3Rvcj1mdW5jdGlvbigpe3JldHVybiBkb20uY29tbW9uQW5jZXN0b3Ioc2MsZWMpO307LyoqXG4gICAgICAgKiByZXR1cm5zIGV4cGFuZGVkIHJhbmdlIGJ5IHByZWRcbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBwcmVkIC0gcHJlZGljYXRlIGZ1bmN0aW9uXG4gICAgICAgKiBAcmV0dXJuIHtXcmFwcGVkUmFuZ2V9XG4gICAgICAgKi90aGlzLmV4cGFuZD1mdW5jdGlvbihwcmVkKXt2YXIgc3RhcnRBbmNlc3Rvcj1kb20uYW5jZXN0b3Ioc2MscHJlZCk7dmFyIGVuZEFuY2VzdG9yPWRvbS5hbmNlc3RvcihlYyxwcmVkKTtpZighc3RhcnRBbmNlc3RvciYmIWVuZEFuY2VzdG9yKXtyZXR1cm4gbmV3IFdyYXBwZWRSYW5nZShzYyxzbyxlYyxlbyk7fXZhciBib3VuZGFyeVBvaW50cz10aGlzLmdldFBvaW50cygpO2lmKHN0YXJ0QW5jZXN0b3Ipe2JvdW5kYXJ5UG9pbnRzLnNjPXN0YXJ0QW5jZXN0b3I7Ym91bmRhcnlQb2ludHMuc289MDt9aWYoZW5kQW5jZXN0b3Ipe2JvdW5kYXJ5UG9pbnRzLmVjPWVuZEFuY2VzdG9yO2JvdW5kYXJ5UG9pbnRzLmVvPWRvbS5ub2RlTGVuZ3RoKGVuZEFuY2VzdG9yKTt9cmV0dXJuIG5ldyBXcmFwcGVkUmFuZ2UoYm91bmRhcnlQb2ludHMuc2MsYm91bmRhcnlQb2ludHMuc28sYm91bmRhcnlQb2ludHMuZWMsYm91bmRhcnlQb2ludHMuZW8pO307LyoqXG4gICAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IGlzQ29sbGFwc2VUb1N0YXJ0XG4gICAgICAgKiBAcmV0dXJuIHtXcmFwcGVkUmFuZ2V9XG4gICAgICAgKi90aGlzLmNvbGxhcHNlPWZ1bmN0aW9uKGlzQ29sbGFwc2VUb1N0YXJ0KXtpZihpc0NvbGxhcHNlVG9TdGFydCl7cmV0dXJuIG5ldyBXcmFwcGVkUmFuZ2Uoc2Msc28sc2Msc28pO31lbHNle3JldHVybiBuZXcgV3JhcHBlZFJhbmdlKGVjLGVvLGVjLGVvKTt9fTsvKipcbiAgICAgICAqIHNwbGl0VGV4dCBvbiByYW5nZVxuICAgICAgICovdGhpcy5zcGxpdFRleHQ9ZnVuY3Rpb24oKXt2YXIgaXNTYW1lQ29udGFpbmVyPXNjPT09ZWM7dmFyIGJvdW5kYXJ5UG9pbnRzPXRoaXMuZ2V0UG9pbnRzKCk7aWYoZG9tLmlzVGV4dChlYykmJiFkb20uaXNFZGdlUG9pbnQodGhpcy5nZXRFbmRQb2ludCgpKSl7ZWMuc3BsaXRUZXh0KGVvKTt9aWYoZG9tLmlzVGV4dChzYykmJiFkb20uaXNFZGdlUG9pbnQodGhpcy5nZXRTdGFydFBvaW50KCkpKXtib3VuZGFyeVBvaW50cy5zYz1zYy5zcGxpdFRleHQoc28pO2JvdW5kYXJ5UG9pbnRzLnNvPTA7aWYoaXNTYW1lQ29udGFpbmVyKXtib3VuZGFyeVBvaW50cy5lYz1ib3VuZGFyeVBvaW50cy5zYztib3VuZGFyeVBvaW50cy5lbz1lby1zbzt9fXJldHVybiBuZXcgV3JhcHBlZFJhbmdlKGJvdW5kYXJ5UG9pbnRzLnNjLGJvdW5kYXJ5UG9pbnRzLnNvLGJvdW5kYXJ5UG9pbnRzLmVjLGJvdW5kYXJ5UG9pbnRzLmVvKTt9Oy8qKlxuICAgICAgICogZGVsZXRlIGNvbnRlbnRzIG9uIHJhbmdlXG4gICAgICAgKiBAcmV0dXJuIHtXcmFwcGVkUmFuZ2V9XG4gICAgICAgKi90aGlzLmRlbGV0ZUNvbnRlbnRzPWZ1bmN0aW9uKCl7aWYodGhpcy5pc0NvbGxhcHNlZCgpKXtyZXR1cm4gdGhpczt9dmFyIHJuZz10aGlzLnNwbGl0VGV4dCgpO3ZhciBub2Rlcz1ybmcubm9kZXMobnVsbCx7ZnVsbHlDb250YWluczp0cnVlfSk7Ly8gZmluZCBuZXcgY3Vyc29yIHBvaW50XG52YXIgcG9pbnQ9ZG9tLnByZXZQb2ludFVudGlsKHJuZy5nZXRTdGFydFBvaW50KCksZnVuY3Rpb24ocG9pbnQpe3JldHVybiFsaXN0LmNvbnRhaW5zKG5vZGVzLHBvaW50Lm5vZGUpO30pO3ZhciBlbXB0eVBhcmVudHM9W107JC5lYWNoKG5vZGVzLGZ1bmN0aW9uKGlkeCxub2RlKXsvLyBmaW5kIGVtcHR5IHBhcmVudHNcbnZhciBwYXJlbnQ9bm9kZS5wYXJlbnROb2RlO2lmKHBvaW50Lm5vZGUhPT1wYXJlbnQmJmRvbS5ub2RlTGVuZ3RoKHBhcmVudCk9PT0xKXtlbXB0eVBhcmVudHMucHVzaChwYXJlbnQpO31kb20ucmVtb3ZlKG5vZGUsZmFsc2UpO30pOy8vIHJlbW92ZSBlbXB0eSBwYXJlbnRzXG4kLmVhY2goZW1wdHlQYXJlbnRzLGZ1bmN0aW9uKGlkeCxub2RlKXtkb20ucmVtb3ZlKG5vZGUsZmFsc2UpO30pO3JldHVybiBuZXcgV3JhcHBlZFJhbmdlKHBvaW50Lm5vZGUscG9pbnQub2Zmc2V0LHBvaW50Lm5vZGUscG9pbnQub2Zmc2V0KS5ub3JtYWxpemUoKTt9Oy8qKlxuICAgICAgICogbWFrZUlzT246IHJldHVybiBpc09uKHByZWQpIGZ1bmN0aW9uXG4gICAgICAgKi92YXIgbWFrZUlzT249ZnVuY3Rpb24ocHJlZCl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGFuY2VzdG9yPWRvbS5hbmNlc3RvcihzYyxwcmVkKTtyZXR1cm4hIWFuY2VzdG9yJiZhbmNlc3Rvcj09PWRvbS5hbmNlc3RvcihlYyxwcmVkKTt9O307Ly8gaXNPbkVkaXRhYmxlOiBqdWRnZSB3aGV0aGVyIHJhbmdlIGlzIG9uIGVkaXRhYmxlIG9yIG5vdFxudGhpcy5pc09uRWRpdGFibGU9bWFrZUlzT24oZG9tLmlzRWRpdGFibGUpOy8vIGlzT25MaXN0OiBqdWRnZSB3aGV0aGVyIHJhbmdlIGlzIG9uIGxpc3Qgbm9kZSBvciBub3RcbnRoaXMuaXNPbkxpc3Q9bWFrZUlzT24oZG9tLmlzTGlzdCk7Ly8gaXNPbkFuY2hvcjoganVkZ2Ugd2hldGhlciByYW5nZSBpcyBvbiBhbmNob3Igbm9kZSBvciBub3RcbnRoaXMuaXNPbkFuY2hvcj1tYWtlSXNPbihkb20uaXNBbmNob3IpOy8vIGlzT25DZWxsOiBqdWRnZSB3aGV0aGVyIHJhbmdlIGlzIG9uIGNlbGwgbm9kZSBvciBub3RcbnRoaXMuaXNPbkNlbGw9bWFrZUlzT24oZG9tLmlzQ2VsbCk7Ly8gaXNPbkRhdGE6IGp1ZGdlIHdoZXRoZXIgcmFuZ2UgaXMgb24gZGF0YSBub2RlIG9yIG5vdFxudGhpcy5pc09uRGF0YT1tYWtlSXNPbihkb20uaXNEYXRhKTsvKipcbiAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IHByZWRcbiAgICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICAgKi90aGlzLmlzTGVmdEVkZ2VPZj1mdW5jdGlvbihwcmVkKXtpZighZG9tLmlzTGVmdEVkZ2VQb2ludCh0aGlzLmdldFN0YXJ0UG9pbnQoKSkpe3JldHVybiBmYWxzZTt9dmFyIG5vZGU9ZG9tLmFuY2VzdG9yKHRoaXMuc2MscHJlZCk7cmV0dXJuIG5vZGUmJmRvbS5pc0xlZnRFZGdlT2YodGhpcy5zYyxub2RlKTt9Oy8qKlxuICAgICAgICogcmV0dXJucyB3aGV0aGVyIHJhbmdlIHdhcyBjb2xsYXBzZWQgb3Igbm90XG4gICAgICAgKi90aGlzLmlzQ29sbGFwc2VkPWZ1bmN0aW9uKCl7cmV0dXJuIHNjPT09ZWMmJnNvPT09ZW87fTsvKipcbiAgICAgICAqIHdyYXAgaW5saW5lIG5vZGVzIHdoaWNoIGNoaWxkcmVuIG9mIGJvZHkgd2l0aCBwYXJhZ3JhcGhcbiAgICAgICAqXG4gICAgICAgKiBAcmV0dXJuIHtXcmFwcGVkUmFuZ2V9XG4gICAgICAgKi90aGlzLndyYXBCb2R5SW5saW5lV2l0aFBhcmE9ZnVuY3Rpb24oKXtpZihkb20uaXNCb2R5Q29udGFpbmVyKHNjKSYmZG9tLmlzRW1wdHkoc2MpKXtzYy5pbm5lckhUTUw9ZG9tLmVtcHR5UGFyYTtyZXR1cm4gbmV3IFdyYXBwZWRSYW5nZShzYy5maXJzdENoaWxkLDAsc2MuZmlyc3RDaGlsZCwwKTt9LyoqXG4gICAgICAgICAqIFt3b3JrYXJvdW5kXSBmaXJlZm94IG9mdGVuIGNyZWF0ZSByYW5nZSBvbiBub3QgdmlzaWJsZSBwb2ludC4gc28gbm9ybWFsaXplIGhlcmUuXG4gICAgICAgICAqICAtIGZpcmVmb3g6IHw8cD50ZXh0PC9wPnxcbiAgICAgICAgICogIC0gY2hyb21lOiA8cD58dGV4dHw8L3A+XG4gICAgICAgICAqL3ZhciBybmc9dGhpcy5ub3JtYWxpemUoKTtpZihkb20uaXNQYXJhSW5saW5lKHNjKXx8ZG9tLmlzUGFyYShzYykpe3JldHVybiBybmc7fS8vIGZpbmQgaW5saW5lIHRvcCBhbmNlc3RvclxudmFyIHRvcEFuY2VzdG9yO2lmKGRvbS5pc0lubGluZShybmcuc2MpKXt2YXIgYW5jZXN0b3JzPWRvbS5saXN0QW5jZXN0b3Iocm5nLnNjLGZ1bmMubm90KGRvbS5pc0lubGluZSkpO3RvcEFuY2VzdG9yPWxpc3QubGFzdChhbmNlc3RvcnMpO2lmKCFkb20uaXNJbmxpbmUodG9wQW5jZXN0b3IpKXt0b3BBbmNlc3Rvcj1hbmNlc3RvcnNbYW5jZXN0b3JzLmxlbmd0aC0yXXx8cm5nLnNjLmNoaWxkTm9kZXNbcm5nLnNvXTt9fWVsc2V7dG9wQW5jZXN0b3I9cm5nLnNjLmNoaWxkTm9kZXNbcm5nLnNvPjA/cm5nLnNvLTE6MF07fS8vIHNpYmxpbmdzIG5vdCBpbiBwYXJhZ3JhcGhcbnZhciBpbmxpbmVTaWJsaW5ncz1kb20ubGlzdFByZXYodG9wQW5jZXN0b3IsZG9tLmlzUGFyYUlubGluZSkucmV2ZXJzZSgpO2lubGluZVNpYmxpbmdzPWlubGluZVNpYmxpbmdzLmNvbmNhdChkb20ubGlzdE5leHQodG9wQW5jZXN0b3IubmV4dFNpYmxpbmcsZG9tLmlzUGFyYUlubGluZSkpOy8vIHdyYXAgd2l0aCBwYXJhZ3JhcGhcbmlmKGlubGluZVNpYmxpbmdzLmxlbmd0aCl7dmFyIHBhcmE9ZG9tLndyYXAobGlzdC5oZWFkKGlubGluZVNpYmxpbmdzKSwncCcpO2RvbS5hcHBlbmRDaGlsZE5vZGVzKHBhcmEsbGlzdC50YWlsKGlubGluZVNpYmxpbmdzKSk7fXJldHVybiB0aGlzLm5vcm1hbGl6ZSgpO307LyoqXG4gICAgICAgKiBpbnNlcnQgbm9kZSBhdCBjdXJyZW50IGN1cnNvclxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7Tm9kZX0gbm9kZVxuICAgICAgICogQHJldHVybiB7Tm9kZX1cbiAgICAgICAqL3RoaXMuaW5zZXJ0Tm9kZT1mdW5jdGlvbihub2RlKXt2YXIgcm5nPXRoaXMud3JhcEJvZHlJbmxpbmVXaXRoUGFyYSgpLmRlbGV0ZUNvbnRlbnRzKCk7dmFyIGluZm89ZG9tLnNwbGl0UG9pbnQocm5nLmdldFN0YXJ0UG9pbnQoKSxkb20uaXNJbmxpbmUobm9kZSkpO2lmKGluZm8ucmlnaHROb2RlKXtpbmZvLnJpZ2h0Tm9kZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShub2RlLGluZm8ucmlnaHROb2RlKTt9ZWxzZXtpbmZvLmNvbnRhaW5lci5hcHBlbmRDaGlsZChub2RlKTt9cmV0dXJuIG5vZGU7fTsvKipcbiAgICAgICAqIGluc2VydCBodG1sIGF0IGN1cnJlbnQgY3Vyc29yXG4gICAgICAgKi90aGlzLnBhc3RlSFRNTD1mdW5jdGlvbihtYXJrdXApe3ZhciBjb250ZW50c0NvbnRhaW5lcj0kKCc8ZGl2PjwvZGl2PicpLmh0bWwobWFya3VwKVswXTt2YXIgY2hpbGROb2Rlcz1saXN0LmZyb20oY29udGVudHNDb250YWluZXIuY2hpbGROb2Rlcyk7dmFyIHJuZz10aGlzLndyYXBCb2R5SW5saW5lV2l0aFBhcmEoKS5kZWxldGVDb250ZW50cygpO3JldHVybiBjaGlsZE5vZGVzLnJldmVyc2UoKS5tYXAoZnVuY3Rpb24oY2hpbGROb2RlKXtyZXR1cm4gcm5nLmluc2VydE5vZGUoY2hpbGROb2RlKTt9KS5yZXZlcnNlKCk7fTsvKipcbiAgICAgICAqIHJldHVybnMgdGV4dCBpbiByYW5nZVxuICAgICAgICpcbiAgICAgICAqIEByZXR1cm4ge1N0cmluZ31cbiAgICAgICAqL3RoaXMudG9TdHJpbmc9ZnVuY3Rpb24oKXt2YXIgbmF0aXZlUm5nPW5hdGl2ZVJhbmdlKCk7cmV0dXJuIGFnZW50LmlzVzNDUmFuZ2VTdXBwb3J0P25hdGl2ZVJuZy50b1N0cmluZygpOm5hdGl2ZVJuZy50ZXh0O307LyoqXG4gICAgICAgKiByZXR1cm5zIHJhbmdlIGZvciB3b3JkIGJlZm9yZSBjdXJzb3JcbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtmaW5kQWZ0ZXJdIC0gZmluZCBhZnRlciBjdXJzb3IsIGRlZmF1bHQ6IGZhbHNlXG4gICAgICAgKiBAcmV0dXJuIHtXcmFwcGVkUmFuZ2V9XG4gICAgICAgKi90aGlzLmdldFdvcmRSYW5nZT1mdW5jdGlvbihmaW5kQWZ0ZXIpe3ZhciBlbmRQb2ludD10aGlzLmdldEVuZFBvaW50KCk7aWYoIWRvbS5pc0NoYXJQb2ludChlbmRQb2ludCkpe3JldHVybiB0aGlzO312YXIgc3RhcnRQb2ludD1kb20ucHJldlBvaW50VW50aWwoZW5kUG9pbnQsZnVuY3Rpb24ocG9pbnQpe3JldHVybiFkb20uaXNDaGFyUG9pbnQocG9pbnQpO30pO2lmKGZpbmRBZnRlcil7ZW5kUG9pbnQ9ZG9tLm5leHRQb2ludFVudGlsKGVuZFBvaW50LGZ1bmN0aW9uKHBvaW50KXtyZXR1cm4hZG9tLmlzQ2hhclBvaW50KHBvaW50KTt9KTt9cmV0dXJuIG5ldyBXcmFwcGVkUmFuZ2Uoc3RhcnRQb2ludC5ub2RlLHN0YXJ0UG9pbnQub2Zmc2V0LGVuZFBvaW50Lm5vZGUsZW5kUG9pbnQub2Zmc2V0KTt9Oy8qKlxuICAgICAgICogY3JlYXRlIG9mZnNldFBhdGggYm9va21hcmtcbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0ge05vZGV9IGVkaXRhYmxlXG4gICAgICAgKi90aGlzLmJvb2ttYXJrPWZ1bmN0aW9uKGVkaXRhYmxlKXtyZXR1cm57czp7cGF0aDpkb20ubWFrZU9mZnNldFBhdGgoZWRpdGFibGUsc2MpLG9mZnNldDpzb30sZTp7cGF0aDpkb20ubWFrZU9mZnNldFBhdGgoZWRpdGFibGUsZWMpLG9mZnNldDplb319O307LyoqXG4gICAgICAgKiBjcmVhdGUgb2Zmc2V0UGF0aCBib29rbWFyayBiYXNlIG9uIHBhcmFncmFwaFxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7Tm9kZVtdfSBwYXJhc1xuICAgICAgICovdGhpcy5wYXJhQm9va21hcms9ZnVuY3Rpb24ocGFyYXMpe3JldHVybntzOntwYXRoOmxpc3QudGFpbChkb20ubWFrZU9mZnNldFBhdGgobGlzdC5oZWFkKHBhcmFzKSxzYykpLG9mZnNldDpzb30sZTp7cGF0aDpsaXN0LnRhaWwoZG9tLm1ha2VPZmZzZXRQYXRoKGxpc3QubGFzdChwYXJhcyksZWMpKSxvZmZzZXQ6ZW99fTt9Oy8qKlxuICAgICAgICogZ2V0Q2xpZW50UmVjdHNcbiAgICAgICAqIEByZXR1cm4ge1JlY3RbXX1cbiAgICAgICAqL3RoaXMuZ2V0Q2xpZW50UmVjdHM9ZnVuY3Rpb24oKXt2YXIgbmF0aXZlUm5nPW5hdGl2ZVJhbmdlKCk7cmV0dXJuIG5hdGl2ZVJuZy5nZXRDbGllbnRSZWN0cygpO307fTsvKipcbiAgICogQGNsYXNzIGNvcmUucmFuZ2VcbiAgICpcbiAgICogRGF0YSBzdHJ1Y3R1cmVcbiAgICogICogQm91bmRhcnlQb2ludDogYSBwb2ludCBvZiBkb20gdHJlZVxuICAgKiAgKiBCb3VuZGFyeVBvaW50czogdHdvIGJvdW5kYXJ5UG9pbnRzIGNvcnJlc3BvbmRpbmcgdG8gdGhlIHN0YXJ0IGFuZCB0aGUgZW5kIG9mIHRoZSBSYW5nZVxuICAgKlxuICAgKiBTZWUgdG8gaHR0cDovL3d3dy53My5vcmcvVFIvRE9NLUxldmVsLTItVHJhdmVyc2FsLVJhbmdlL3Jhbmdlcy5odG1sI0xldmVsLTItUmFuZ2UtUG9zaXRpb25cbiAgICpcbiAgICogQHNpbmdsZXRvblxuICAgKiBAYWx0ZXJuYXRlQ2xhc3NOYW1lIHJhbmdlXG4gICAqL3JldHVybnsvKipcbiAgICAgICAqIGNyZWF0ZSBSYW5nZSBPYmplY3QgRnJvbSBhcmd1bWVudHMgb3IgQnJvd3NlciBTZWxlY3Rpb25cbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0ge05vZGV9IHNjIC0gc3RhcnQgY29udGFpbmVyXG4gICAgICAgKiBAcGFyYW0ge051bWJlcn0gc28gLSBzdGFydCBvZmZzZXRcbiAgICAgICAqIEBwYXJhbSB7Tm9kZX0gZWMgLSBlbmQgY29udGFpbmVyXG4gICAgICAgKiBAcGFyYW0ge051bWJlcn0gZW8gLSBlbmQgb2Zmc2V0XG4gICAgICAgKiBAcmV0dXJuIHtXcmFwcGVkUmFuZ2V9XG4gICAgICAgKi9jcmVhdGU6ZnVuY3Rpb24oc2Msc28sZWMsZW8pe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT00KXtyZXR1cm4gbmV3IFdyYXBwZWRSYW5nZShzYyxzbyxlYyxlbyk7fWVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09PTIpey8vY29sbGFwc2VkXG5lYz1zYztlbz1zbztyZXR1cm4gbmV3IFdyYXBwZWRSYW5nZShzYyxzbyxlYyxlbyk7fWVsc2V7dmFyIHdyYXBwZWRSYW5nZT10aGlzLmNyZWF0ZUZyb21TZWxlY3Rpb24oKTtpZighd3JhcHBlZFJhbmdlJiZhcmd1bWVudHMubGVuZ3RoPT09MSl7d3JhcHBlZFJhbmdlPXRoaXMuY3JlYXRlRnJvbU5vZGUoYXJndW1lbnRzWzBdKTtyZXR1cm4gd3JhcHBlZFJhbmdlLmNvbGxhcHNlKGRvbS5lbXB0eVBhcmE9PT1hcmd1bWVudHNbMF0uaW5uZXJIVE1MKTt9cmV0dXJuIHdyYXBwZWRSYW5nZTt9fSxjcmVhdGVGcm9tU2VsZWN0aW9uOmZ1bmN0aW9uKCl7dmFyIHNjLHNvLGVjLGVvO2lmKGFnZW50LmlzVzNDUmFuZ2VTdXBwb3J0KXt2YXIgc2VsZWN0aW9uPWRvY3VtZW50LmdldFNlbGVjdGlvbigpO2lmKCFzZWxlY3Rpb258fHNlbGVjdGlvbi5yYW5nZUNvdW50PT09MCl7cmV0dXJuIG51bGw7fWVsc2UgaWYoZG9tLmlzQm9keShzZWxlY3Rpb24uYW5jaG9yTm9kZSkpey8vIEZpcmVmb3g6IHJldHVybnMgZW50aXJlIGJvZHkgYXMgcmFuZ2Ugb24gaW5pdGlhbGl6YXRpb24uXG4vLyBXZSB3b24ndCBuZXZlciBuZWVkIGl0LlxucmV0dXJuIG51bGw7fXZhciBuYXRpdmVSbmc9c2VsZWN0aW9uLmdldFJhbmdlQXQoMCk7c2M9bmF0aXZlUm5nLnN0YXJ0Q29udGFpbmVyO3NvPW5hdGl2ZVJuZy5zdGFydE9mZnNldDtlYz1uYXRpdmVSbmcuZW5kQ29udGFpbmVyO2VvPW5hdGl2ZVJuZy5lbmRPZmZzZXQ7fWVsc2V7Ly8gSUU4OiBUZXh0UmFuZ2VcbnZhciB0ZXh0UmFuZ2U9ZG9jdW1lbnQuc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCk7dmFyIHRleHRSYW5nZUVuZD10ZXh0UmFuZ2UuZHVwbGljYXRlKCk7dGV4dFJhbmdlRW5kLmNvbGxhcHNlKGZhbHNlKTt2YXIgdGV4dFJhbmdlU3RhcnQ9dGV4dFJhbmdlO3RleHRSYW5nZVN0YXJ0LmNvbGxhcHNlKHRydWUpO3ZhciBzdGFydFBvaW50PXRleHRSYW5nZVRvUG9pbnQodGV4dFJhbmdlU3RhcnQsdHJ1ZSksZW5kUG9pbnQ9dGV4dFJhbmdlVG9Qb2ludCh0ZXh0UmFuZ2VFbmQsZmFsc2UpOy8vIHNhbWUgdmlzaWJsZSBwb2ludCBjYXNlOiByYW5nZSB3YXMgY29sbGFwc2VkLlxuaWYoZG9tLmlzVGV4dChzdGFydFBvaW50Lm5vZGUpJiZkb20uaXNMZWZ0RWRnZVBvaW50KHN0YXJ0UG9pbnQpJiZkb20uaXNUZXh0Tm9kZShlbmRQb2ludC5ub2RlKSYmZG9tLmlzUmlnaHRFZGdlUG9pbnQoZW5kUG9pbnQpJiZlbmRQb2ludC5ub2RlLm5leHRTaWJsaW5nPT09c3RhcnRQb2ludC5ub2RlKXtzdGFydFBvaW50PWVuZFBvaW50O31zYz1zdGFydFBvaW50LmNvbnQ7c289c3RhcnRQb2ludC5vZmZzZXQ7ZWM9ZW5kUG9pbnQuY29udDtlbz1lbmRQb2ludC5vZmZzZXQ7fXJldHVybiBuZXcgV3JhcHBlZFJhbmdlKHNjLHNvLGVjLGVvKTt9LC8qKlxuICAgICAgICogQG1ldGhvZCBcbiAgICAgICAqIFxuICAgICAgICogY3JlYXRlIFdyYXBwZWRSYW5nZSBmcm9tIG5vZGVcbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0ge05vZGV9IG5vZGVcbiAgICAgICAqIEByZXR1cm4ge1dyYXBwZWRSYW5nZX1cbiAgICAgICAqL2NyZWF0ZUZyb21Ob2RlOmZ1bmN0aW9uKG5vZGUpe3ZhciBzYz1ub2RlO3ZhciBzbz0wO3ZhciBlYz1ub2RlO3ZhciBlbz1kb20ubm9kZUxlbmd0aChlYyk7Ly8gYnJvd3NlcnMgY2FuJ3QgdGFyZ2V0IGEgcGljdHVyZSBvciB2b2lkIG5vZGVcbmlmKGRvbS5pc1ZvaWQoc2MpKXtzbz1kb20ubGlzdFByZXYoc2MpLmxlbmd0aC0xO3NjPXNjLnBhcmVudE5vZGU7fWlmKGRvbS5pc0JSKGVjKSl7ZW89ZG9tLmxpc3RQcmV2KGVjKS5sZW5ndGgtMTtlYz1lYy5wYXJlbnROb2RlO31lbHNlIGlmKGRvbS5pc1ZvaWQoZWMpKXtlbz1kb20ubGlzdFByZXYoZWMpLmxlbmd0aDtlYz1lYy5wYXJlbnROb2RlO31yZXR1cm4gdGhpcy5jcmVhdGUoc2Msc28sZWMsZW8pO30sLyoqXG4gICAgICAgKiBjcmVhdGUgV3JhcHBlZFJhbmdlIGZyb20gbm9kZSBhZnRlciBwb3NpdGlvblxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7Tm9kZX0gbm9kZVxuICAgICAgICogQHJldHVybiB7V3JhcHBlZFJhbmdlfVxuICAgICAgICovY3JlYXRlRnJvbU5vZGVCZWZvcmU6ZnVuY3Rpb24obm9kZSl7cmV0dXJuIHRoaXMuY3JlYXRlRnJvbU5vZGUobm9kZSkuY29sbGFwc2UodHJ1ZSk7fSwvKipcbiAgICAgICAqIGNyZWF0ZSBXcmFwcGVkUmFuZ2UgZnJvbSBub2RlIGFmdGVyIHBvc2l0aW9uXG4gICAgICAgKlxuICAgICAgICogQHBhcmFtIHtOb2RlfSBub2RlXG4gICAgICAgKiBAcmV0dXJuIHtXcmFwcGVkUmFuZ2V9XG4gICAgICAgKi9jcmVhdGVGcm9tTm9kZUFmdGVyOmZ1bmN0aW9uKG5vZGUpe3JldHVybiB0aGlzLmNyZWF0ZUZyb21Ob2RlKG5vZGUpLmNvbGxhcHNlKCk7fSwvKipcbiAgICAgICAqIEBtZXRob2QgXG4gICAgICAgKiBcbiAgICAgICAqIGNyZWF0ZSBXcmFwcGVkUmFuZ2UgZnJvbSBib29rbWFya1xuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7Tm9kZX0gZWRpdGFibGVcbiAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBib29rbWFya1xuICAgICAgICogQHJldHVybiB7V3JhcHBlZFJhbmdlfVxuICAgICAgICovY3JlYXRlRnJvbUJvb2ttYXJrOmZ1bmN0aW9uKGVkaXRhYmxlLGJvb2ttYXJrKXt2YXIgc2M9ZG9tLmZyb21PZmZzZXRQYXRoKGVkaXRhYmxlLGJvb2ttYXJrLnMucGF0aCk7dmFyIHNvPWJvb2ttYXJrLnMub2Zmc2V0O3ZhciBlYz1kb20uZnJvbU9mZnNldFBhdGgoZWRpdGFibGUsYm9va21hcmsuZS5wYXRoKTt2YXIgZW89Ym9va21hcmsuZS5vZmZzZXQ7cmV0dXJuIG5ldyBXcmFwcGVkUmFuZ2Uoc2Msc28sZWMsZW8pO30sLyoqXG4gICAgICAgKiBAbWV0aG9kIFxuICAgICAgICpcbiAgICAgICAqIGNyZWF0ZSBXcmFwcGVkUmFuZ2UgZnJvbSBwYXJhQm9va21hcmtcbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0ge09iamVjdH0gYm9va21hcmtcbiAgICAgICAqIEBwYXJhbSB7Tm9kZVtdfSBwYXJhc1xuICAgICAgICogQHJldHVybiB7V3JhcHBlZFJhbmdlfVxuICAgICAgICovY3JlYXRlRnJvbVBhcmFCb29rbWFyazpmdW5jdGlvbihib29rbWFyayxwYXJhcyl7dmFyIHNvPWJvb2ttYXJrLnMub2Zmc2V0O3ZhciBlbz1ib29rbWFyay5lLm9mZnNldDt2YXIgc2M9ZG9tLmZyb21PZmZzZXRQYXRoKGxpc3QuaGVhZChwYXJhcyksYm9va21hcmsucy5wYXRoKTt2YXIgZWM9ZG9tLmZyb21PZmZzZXRQYXRoKGxpc3QubGFzdChwYXJhcyksYm9va21hcmsuZS5wYXRoKTtyZXR1cm4gbmV3IFdyYXBwZWRSYW5nZShzYyxzbyxlYyxlbyk7fX07fSgpOy8qKlxuICAgKiBAY2xhc3MgY29yZS5hc3luY1xuICAgKlxuICAgKiBBc3luYyBmdW5jdGlvbnMgd2hpY2ggcmV0dXJucyBgUHJvbWlzZWBcbiAgICpcbiAgICogQHNpbmdsZXRvblxuICAgKiBAYWx0ZXJuYXRlQ2xhc3NOYW1lIGFzeW5jXG4gICAqL3ZhciBhc3luYz1mdW5jdGlvbigpey8qKlxuICAgICAqIEBtZXRob2QgcmVhZEZpbGVBc0RhdGFVUkxcbiAgICAgKlxuICAgICAqIHJlYWQgY29udGVudHMgb2YgZmlsZSBhcyByZXByZXNlbnRpbmcgVVJMXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0ZpbGV9IGZpbGVcbiAgICAgKiBAcmV0dXJuIHtQcm9taXNlfSAtIHRoZW46IGRhdGFVcmxcbiAgICAgKi92YXIgcmVhZEZpbGVBc0RhdGFVUkw9ZnVuY3Rpb24oZmlsZSl7cmV0dXJuICQuRGVmZXJyZWQoZnVuY3Rpb24oZGVmZXJyZWQpeyQuZXh0ZW5kKG5ldyBGaWxlUmVhZGVyKCkse29ubG9hZDpmdW5jdGlvbihlKXt2YXIgZGF0YVVSTD1lLnRhcmdldC5yZXN1bHQ7ZGVmZXJyZWQucmVzb2x2ZShkYXRhVVJMKTt9LG9uZXJyb3I6ZnVuY3Rpb24oKXtkZWZlcnJlZC5yZWplY3QodGhpcyk7fX0pLnJlYWRBc0RhdGFVUkwoZmlsZSk7fSkucHJvbWlzZSgpO307LyoqXG4gICAgICogQG1ldGhvZCBjcmVhdGVJbWFnZVxuICAgICAqXG4gICAgICogY3JlYXRlIGA8aW1hZ2U+YCBmcm9tIHVybCBzdHJpbmdcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSB1cmxcbiAgICAgKiBAcmV0dXJuIHtQcm9taXNlfSAtIHRoZW46ICRpbWFnZVxuICAgICAqL3ZhciBjcmVhdGVJbWFnZT1mdW5jdGlvbih1cmwpe3JldHVybiAkLkRlZmVycmVkKGZ1bmN0aW9uKGRlZmVycmVkKXt2YXIgJGltZz0kKCc8aW1nPicpOyRpbWcub25lKCdsb2FkJyxmdW5jdGlvbigpeyRpbWcub2ZmKCdlcnJvciBhYm9ydCcpO2RlZmVycmVkLnJlc29sdmUoJGltZyk7fSkub25lKCdlcnJvciBhYm9ydCcsZnVuY3Rpb24oKXskaW1nLm9mZignbG9hZCcpLmRldGFjaCgpO2RlZmVycmVkLnJlamVjdCgkaW1nKTt9KS5jc3Moe2Rpc3BsYXk6J25vbmUnfSkuYXBwZW5kVG8oZG9jdW1lbnQuYm9keSkuYXR0cignc3JjJyx1cmwpO30pLnByb21pc2UoKTt9O3JldHVybntyZWFkRmlsZUFzRGF0YVVSTDpyZWFkRmlsZUFzRGF0YVVSTCxjcmVhdGVJbWFnZTpjcmVhdGVJbWFnZX07fSgpOy8qKlxuICAgKiBAY2xhc3MgZWRpdGluZy5IaXN0b3J5XG4gICAqXG4gICAqIEVkaXRvciBIaXN0b3J5XG4gICAqXG4gICAqL3ZhciBIaXN0b3J5PWZ1bmN0aW9uKCRlZGl0YWJsZSl7dmFyIHN0YWNrPVtdLHN0YWNrT2Zmc2V0PS0xO3ZhciBlZGl0YWJsZT0kZWRpdGFibGVbMF07dmFyIG1ha2VTbmFwc2hvdD1mdW5jdGlvbigpe3ZhciBybmc9cmFuZ2UuY3JlYXRlKGVkaXRhYmxlKTt2YXIgZW1wdHlCb29rbWFyaz17czp7cGF0aDpbXSxvZmZzZXQ6MH0sZTp7cGF0aDpbXSxvZmZzZXQ6MH19O3JldHVybntjb250ZW50czokZWRpdGFibGUuaHRtbCgpLGJvb2ttYXJrOnJuZz9ybmcuYm9va21hcmsoZWRpdGFibGUpOmVtcHR5Qm9va21hcmt9O307dmFyIGFwcGx5U25hcHNob3Q9ZnVuY3Rpb24oc25hcHNob3Qpe2lmKHNuYXBzaG90LmNvbnRlbnRzIT09bnVsbCl7JGVkaXRhYmxlLmh0bWwoc25hcHNob3QuY29udGVudHMpO31pZihzbmFwc2hvdC5ib29rbWFyayE9PW51bGwpe3JhbmdlLmNyZWF0ZUZyb21Cb29rbWFyayhlZGl0YWJsZSxzbmFwc2hvdC5ib29rbWFyaykuc2VsZWN0KCk7fX07LyoqXG4gICAgKiBAbWV0aG9kIHJld2luZFxuICAgICogUmV3aW5kcyB0aGUgaGlzdG9yeSBzdGFjayBiYWNrIHRvIHRoZSBmaXJzdCBzbmFwc2hvdCB0YWtlbi5cbiAgICAqIExlYXZlcyB0aGUgc3RhY2sgaW50YWN0LCBzbyB0aGF0IFwiUmVkb1wiIGNhbiBzdGlsbCBiZSB1c2VkLlxuICAgICovdGhpcy5yZXdpbmQ9ZnVuY3Rpb24oKXsvLyBDcmVhdGUgc25hcCBzaG90IGlmIG5vdCB5ZXQgcmVjb3JkZWRcbmlmKCRlZGl0YWJsZS5odG1sKCkhPT1zdGFja1tzdGFja09mZnNldF0uY29udGVudHMpe3RoaXMucmVjb3JkVW5kbygpO30vLyBSZXR1cm4gdG8gdGhlIGZpcnN0IGF2YWlsYWJsZSBzbmFwc2hvdC5cbnN0YWNrT2Zmc2V0PTA7Ly8gQXBwbHkgdGhhdCBzbmFwc2hvdC5cbmFwcGx5U25hcHNob3Qoc3RhY2tbc3RhY2tPZmZzZXRdKTt9Oy8qKlxuICAgICogQG1ldGhvZCByZXNldFxuICAgICogUmVzZXRzIHRoZSBoaXN0b3J5IHN0YWNrIGNvbXBsZXRlbHk7IHJldmVydGluZyB0byBhbiBlbXB0eSBlZGl0b3IuXG4gICAgKi90aGlzLnJlc2V0PWZ1bmN0aW9uKCl7Ly8gQ2xlYXIgdGhlIHN0YWNrLlxuc3RhY2s9W107Ly8gUmVzdG9yZSBzdGFja09mZnNldCB0byBpdHMgb3JpZ2luYWwgdmFsdWUuXG5zdGFja09mZnNldD0tMTsvLyBDbGVhciB0aGUgZWRpdGFibGUgYXJlYS5cbiRlZGl0YWJsZS5odG1sKCcnKTsvLyBSZWNvcmQgb3VyIGZpcnN0IHNuYXBzaG90IChvZiBub3RoaW5nKS5cbnRoaXMucmVjb3JkVW5kbygpO307LyoqXG4gICAgICogdW5kb1xuICAgICAqL3RoaXMudW5kbz1mdW5jdGlvbigpey8vIENyZWF0ZSBzbmFwIHNob3QgaWYgbm90IHlldCByZWNvcmRlZFxuaWYoJGVkaXRhYmxlLmh0bWwoKSE9PXN0YWNrW3N0YWNrT2Zmc2V0XS5jb250ZW50cyl7dGhpcy5yZWNvcmRVbmRvKCk7fWlmKDA8c3RhY2tPZmZzZXQpe3N0YWNrT2Zmc2V0LS07YXBwbHlTbmFwc2hvdChzdGFja1tzdGFja09mZnNldF0pO319Oy8qKlxuICAgICAqIHJlZG9cbiAgICAgKi90aGlzLnJlZG89ZnVuY3Rpb24oKXtpZihzdGFjay5sZW5ndGgtMT5zdGFja09mZnNldCl7c3RhY2tPZmZzZXQrKzthcHBseVNuYXBzaG90KHN0YWNrW3N0YWNrT2Zmc2V0XSk7fX07LyoqXG4gICAgICogcmVjb3JkZWQgdW5kb1xuICAgICAqL3RoaXMucmVjb3JkVW5kbz1mdW5jdGlvbigpe3N0YWNrT2Zmc2V0Kys7Ly8gV2FzaCBvdXQgc3RhY2sgYWZ0ZXIgc3RhY2tPZmZzZXRcbmlmKHN0YWNrLmxlbmd0aD5zdGFja09mZnNldCl7c3RhY2s9c3RhY2suc2xpY2UoMCxzdGFja09mZnNldCk7fS8vIENyZWF0ZSBuZXcgc25hcHNob3QgYW5kIHB1c2ggaXQgdG8gdGhlIGVuZFxuc3RhY2sucHVzaChtYWtlU25hcHNob3QoKSk7fTt9Oy8qKlxuICAgKiBAY2xhc3MgZWRpdGluZy5TdHlsZVxuICAgKlxuICAgKiBTdHlsZVxuICAgKlxuICAgKi92YXIgU3R5bGU9ZnVuY3Rpb24oKXsvKipcbiAgICAgKiBAbWV0aG9kIGpRdWVyeUNTU1xuICAgICAqXG4gICAgICogW3dvcmthcm91bmRdIGZvciBvbGQgalF1ZXJ5XG4gICAgICogcGFzc2luZyBhbiBhcnJheSBvZiBzdHlsZSBwcm9wZXJ0aWVzIHRvIC5jc3MoKVxuICAgICAqIHdpbGwgcmVzdWx0IGluIGFuIG9iamVjdCBvZiBwcm9wZXJ0eS12YWx1ZSBwYWlycy5cbiAgICAgKiAoY29tcGFiaWxpdHkgd2l0aCB2ZXJzaW9uIDwgMS45KVxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0gIHtqUXVlcnl9ICRvYmpcbiAgICAgKiBAcGFyYW0gIHtBcnJheX0gcHJvcGVydHlOYW1lcyAtIEFuIGFycmF5IG9mIG9uZSBvciBtb3JlIENTUyBwcm9wZXJ0aWVzLlxuICAgICAqIEByZXR1cm4ge09iamVjdH1cbiAgICAgKi92YXIgalF1ZXJ5Q1NTPWZ1bmN0aW9uKCRvYmoscHJvcGVydHlOYW1lcyl7aWYoYWdlbnQuanF1ZXJ5VmVyc2lvbjwxLjkpe3ZhciByZXN1bHQ9e307JC5lYWNoKHByb3BlcnR5TmFtZXMsZnVuY3Rpb24oaWR4LHByb3BlcnR5TmFtZSl7cmVzdWx0W3Byb3BlcnR5TmFtZV09JG9iai5jc3MocHJvcGVydHlOYW1lKTt9KTtyZXR1cm4gcmVzdWx0O31yZXR1cm4gJG9iai5jc3MuY2FsbCgkb2JqLHByb3BlcnR5TmFtZXMpO307LyoqXG4gICAgICogcmV0dXJucyBzdHlsZSBvYmplY3QgZnJvbSBub2RlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2pRdWVyeX0gJG5vZGVcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9XG4gICAgICovdGhpcy5mcm9tTm9kZT1mdW5jdGlvbigkbm9kZSl7dmFyIHByb3BlcnRpZXM9Wydmb250LWZhbWlseScsJ2ZvbnQtc2l6ZScsJ3RleHQtYWxpZ24nLCdsaXN0LXN0eWxlLXR5cGUnLCdsaW5lLWhlaWdodCddO3ZhciBzdHlsZUluZm89alF1ZXJ5Q1NTKCRub2RlLHByb3BlcnRpZXMpfHx7fTtzdHlsZUluZm9bJ2ZvbnQtc2l6ZSddPXBhcnNlSW50KHN0eWxlSW5mb1snZm9udC1zaXplJ10sMTApO3JldHVybiBzdHlsZUluZm87fTsvKipcbiAgICAgKiBwYXJhZ3JhcGggbGV2ZWwgc3R5bGVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7V3JhcHBlZFJhbmdlfSBybmdcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gc3R5bGVJbmZvXG4gICAgICovdGhpcy5zdHlsZVBhcmE9ZnVuY3Rpb24ocm5nLHN0eWxlSW5mbyl7JC5lYWNoKHJuZy5ub2Rlcyhkb20uaXNQYXJhLHtpbmNsdWRlQW5jZXN0b3I6dHJ1ZX0pLGZ1bmN0aW9uKGlkeCxwYXJhKXskKHBhcmEpLmNzcyhzdHlsZUluZm8pO30pO307LyoqXG4gICAgICogaW5zZXJ0IGFuZCByZXR1cm5zIHN0eWxlTm9kZXMgb24gcmFuZ2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1dyYXBwZWRSYW5nZX0gcm5nXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXSAtIG9wdGlvbnMgZm9yIHN0eWxlTm9kZXNcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW29wdGlvbnMubm9kZU5hbWVdIC0gZGVmYXVsdDogYFNQQU5gXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5leHBhbmRDbG9zZXN0U2libGluZ10gLSBkZWZhdWx0OiBgZmFsc2VgXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbb3B0aW9ucy5vbmx5UGFydGlhbENvbnRhaW5zXSAtIGRlZmF1bHQ6IGBmYWxzZWBcbiAgICAgKiBAcmV0dXJuIHtOb2RlW119XG4gICAgICovdGhpcy5zdHlsZU5vZGVzPWZ1bmN0aW9uKHJuZyxvcHRpb25zKXtybmc9cm5nLnNwbGl0VGV4dCgpO3ZhciBub2RlTmFtZT1vcHRpb25zJiZvcHRpb25zLm5vZGVOYW1lfHwnU1BBTic7dmFyIGV4cGFuZENsb3Nlc3RTaWJsaW5nPSEhKG9wdGlvbnMmJm9wdGlvbnMuZXhwYW5kQ2xvc2VzdFNpYmxpbmcpO3ZhciBvbmx5UGFydGlhbENvbnRhaW5zPSEhKG9wdGlvbnMmJm9wdGlvbnMub25seVBhcnRpYWxDb250YWlucyk7aWYocm5nLmlzQ29sbGFwc2VkKCkpe3JldHVybltybmcuaW5zZXJ0Tm9kZShkb20uY3JlYXRlKG5vZGVOYW1lKSldO312YXIgcHJlZD1kb20ubWFrZVByZWRCeU5vZGVOYW1lKG5vZGVOYW1lKTt2YXIgbm9kZXM9cm5nLm5vZGVzKGRvbS5pc1RleHQse2Z1bGx5Q29udGFpbnM6dHJ1ZX0pLm1hcChmdW5jdGlvbih0ZXh0KXtyZXR1cm4gZG9tLnNpbmdsZUNoaWxkQW5jZXN0b3IodGV4dCxwcmVkKXx8ZG9tLndyYXAodGV4dCxub2RlTmFtZSk7fSk7aWYoZXhwYW5kQ2xvc2VzdFNpYmxpbmcpe2lmKG9ubHlQYXJ0aWFsQ29udGFpbnMpe3ZhciBub2Rlc0luUmFuZ2U9cm5nLm5vZGVzKCk7Ly8gY29tcG9zZSB3aXRoIHBhcnRpYWwgY29udGFpbnMgcHJlZGljYXRpb25cbnByZWQ9ZnVuYy5hbmQocHJlZCxmdW5jdGlvbihub2RlKXtyZXR1cm4gbGlzdC5jb250YWlucyhub2Rlc0luUmFuZ2Usbm9kZSk7fSk7fXJldHVybiBub2Rlcy5tYXAoZnVuY3Rpb24obm9kZSl7dmFyIHNpYmxpbmdzPWRvbS53aXRoQ2xvc2VzdFNpYmxpbmdzKG5vZGUscHJlZCk7dmFyIGhlYWQ9bGlzdC5oZWFkKHNpYmxpbmdzKTt2YXIgdGFpbHM9bGlzdC50YWlsKHNpYmxpbmdzKTskLmVhY2godGFpbHMsZnVuY3Rpb24oaWR4LGVsZW0pe2RvbS5hcHBlbmRDaGlsZE5vZGVzKGhlYWQsZWxlbS5jaGlsZE5vZGVzKTtkb20ucmVtb3ZlKGVsZW0pO30pO3JldHVybiBsaXN0LmhlYWQoc2libGluZ3MpO30pO31lbHNle3JldHVybiBub2Rlczt9fTsvKipcbiAgICAgKiBnZXQgY3VycmVudCBzdHlsZSBvbiBjdXJzb3JcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7V3JhcHBlZFJhbmdlfSBybmdcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IC0gb2JqZWN0IGNvbnRhaW5zIHN0eWxlIHByb3BlcnRpZXMuXG4gICAgICovdGhpcy5jdXJyZW50PWZ1bmN0aW9uKHJuZyl7dmFyICRjb250PSQoIWRvbS5pc0VsZW1lbnQocm5nLnNjKT9ybmcuc2MucGFyZW50Tm9kZTpybmcuc2MpO3ZhciBzdHlsZUluZm89dGhpcy5mcm9tTm9kZSgkY29udCk7Ly8gZG9jdW1lbnQucXVlcnlDb21tYW5kU3RhdGUgZm9yIHRvZ2dsZSBzdGF0ZVxuLy8gW3dvcmthcm91bmRdIHByZXZlbnQgRmlyZWZveCBuc3Jlc3VsdDogXCIweDgwMDA0MDA1IChOU19FUlJPUl9GQUlMVVJFKVwiXG50cnl7c3R5bGVJbmZvPSQuZXh0ZW5kKHN0eWxlSW5mbyx7J2ZvbnQtYm9sZCc6ZG9jdW1lbnQucXVlcnlDb21tYW5kU3RhdGUoJ2JvbGQnKT8nYm9sZCc6J25vcm1hbCcsJ2ZvbnQtaXRhbGljJzpkb2N1bWVudC5xdWVyeUNvbW1hbmRTdGF0ZSgnaXRhbGljJyk/J2l0YWxpYyc6J25vcm1hbCcsJ2ZvbnQtdW5kZXJsaW5lJzpkb2N1bWVudC5xdWVyeUNvbW1hbmRTdGF0ZSgndW5kZXJsaW5lJyk/J3VuZGVybGluZSc6J25vcm1hbCcsJ2ZvbnQtc3Vic2NyaXB0Jzpkb2N1bWVudC5xdWVyeUNvbW1hbmRTdGF0ZSgnc3Vic2NyaXB0Jyk/J3N1YnNjcmlwdCc6J25vcm1hbCcsJ2ZvbnQtc3VwZXJzY3JpcHQnOmRvY3VtZW50LnF1ZXJ5Q29tbWFuZFN0YXRlKCdzdXBlcnNjcmlwdCcpPydzdXBlcnNjcmlwdCc6J25vcm1hbCcsJ2ZvbnQtc3RyaWtldGhyb3VnaCc6ZG9jdW1lbnQucXVlcnlDb21tYW5kU3RhdGUoJ3N0cmlrZXRocm91Z2gnKT8nc3RyaWtldGhyb3VnaCc6J25vcm1hbCd9KTt9Y2F0Y2goZSl7fS8vIGxpc3Qtc3R5bGUtdHlwZSB0byBsaXN0LXN0eWxlKHVub3JkZXJlZCwgb3JkZXJlZClcbmlmKCFybmcuaXNPbkxpc3QoKSl7c3R5bGVJbmZvWydsaXN0LXN0eWxlJ109J25vbmUnO31lbHNle3ZhciBvcmRlcmVkVHlwZXM9WydjaXJjbGUnLCdkaXNjJywnZGlzYy1sZWFkaW5nLXplcm8nLCdzcXVhcmUnXTt2YXIgaXNVbm9yZGVyZWQ9JC5pbkFycmF5KHN0eWxlSW5mb1snbGlzdC1zdHlsZS10eXBlJ10sb3JkZXJlZFR5cGVzKT4tMTtzdHlsZUluZm9bJ2xpc3Qtc3R5bGUnXT1pc1Vub3JkZXJlZD8ndW5vcmRlcmVkJzonb3JkZXJlZCc7fXZhciBwYXJhPWRvbS5hbmNlc3Rvcihybmcuc2MsZG9tLmlzUGFyYSk7aWYocGFyYSYmcGFyYS5zdHlsZVsnbGluZS1oZWlnaHQnXSl7c3R5bGVJbmZvWydsaW5lLWhlaWdodCddPXBhcmEuc3R5bGUubGluZUhlaWdodDt9ZWxzZXt2YXIgbGluZUhlaWdodD1wYXJzZUludChzdHlsZUluZm9bJ2xpbmUtaGVpZ2h0J10sMTApL3BhcnNlSW50KHN0eWxlSW5mb1snZm9udC1zaXplJ10sMTApO3N0eWxlSW5mb1snbGluZS1oZWlnaHQnXT1saW5lSGVpZ2h0LnRvRml4ZWQoMSk7fXN0eWxlSW5mby5hbmNob3I9cm5nLmlzT25BbmNob3IoKSYmZG9tLmFuY2VzdG9yKHJuZy5zYyxkb20uaXNBbmNob3IpO3N0eWxlSW5mby5hbmNlc3RvcnM9ZG9tLmxpc3RBbmNlc3Rvcihybmcuc2MsZG9tLmlzRWRpdGFibGUpO3N0eWxlSW5mby5yYW5nZT1ybmc7cmV0dXJuIHN0eWxlSW5mbzt9O307LyoqXG4gICAqIEBjbGFzcyBlZGl0aW5nLkJ1bGxldFxuICAgKlxuICAgKiBAYWx0ZXJuYXRlQ2xhc3NOYW1lIEJ1bGxldFxuICAgKi92YXIgQnVsbGV0PWZ1bmN0aW9uKCl7dmFyIHNlbGY9dGhpczsvKipcbiAgICAgKiB0b2dnbGUgb3JkZXJlZCBsaXN0XG4gICAgICovdGhpcy5pbnNlcnRPcmRlcmVkTGlzdD1mdW5jdGlvbihlZGl0YWJsZSl7dGhpcy50b2dnbGVMaXN0KCdPTCcsZWRpdGFibGUpO307LyoqXG4gICAgICogdG9nZ2xlIHVub3JkZXJlZCBsaXN0XG4gICAgICovdGhpcy5pbnNlcnRVbm9yZGVyZWRMaXN0PWZ1bmN0aW9uKGVkaXRhYmxlKXt0aGlzLnRvZ2dsZUxpc3QoJ1VMJyxlZGl0YWJsZSk7fTsvKipcbiAgICAgKiBpbmRlbnRcbiAgICAgKi90aGlzLmluZGVudD1mdW5jdGlvbihlZGl0YWJsZSl7dmFyIHNlbGY9dGhpczt2YXIgcm5nPXJhbmdlLmNyZWF0ZShlZGl0YWJsZSkud3JhcEJvZHlJbmxpbmVXaXRoUGFyYSgpO3ZhciBwYXJhcz1ybmcubm9kZXMoZG9tLmlzUGFyYSx7aW5jbHVkZUFuY2VzdG9yOnRydWV9KTt2YXIgY2x1c3RlcmVkcz1saXN0LmNsdXN0ZXJCeShwYXJhcyxmdW5jLnBlcTIoJ3BhcmVudE5vZGUnKSk7JC5lYWNoKGNsdXN0ZXJlZHMsZnVuY3Rpb24oaWR4LHBhcmFzKXt2YXIgaGVhZD1saXN0LmhlYWQocGFyYXMpO2lmKGRvbS5pc0xpKGhlYWQpKXtzZWxmLndyYXBMaXN0KHBhcmFzLGhlYWQucGFyZW50Tm9kZS5ub2RlTmFtZSk7fWVsc2V7JC5lYWNoKHBhcmFzLGZ1bmN0aW9uKGlkeCxwYXJhKXskKHBhcmEpLmNzcygnbWFyZ2luTGVmdCcsZnVuY3Rpb24oaWR4LHZhbCl7cmV0dXJuKHBhcnNlSW50KHZhbCwxMCl8fDApKzI1O30pO30pO319KTtybmcuc2VsZWN0KCk7fTsvKipcbiAgICAgKiBvdXRkZW50XG4gICAgICovdGhpcy5vdXRkZW50PWZ1bmN0aW9uKGVkaXRhYmxlKXt2YXIgc2VsZj10aGlzO3ZhciBybmc9cmFuZ2UuY3JlYXRlKGVkaXRhYmxlKS53cmFwQm9keUlubGluZVdpdGhQYXJhKCk7dmFyIHBhcmFzPXJuZy5ub2Rlcyhkb20uaXNQYXJhLHtpbmNsdWRlQW5jZXN0b3I6dHJ1ZX0pO3ZhciBjbHVzdGVyZWRzPWxpc3QuY2x1c3RlckJ5KHBhcmFzLGZ1bmMucGVxMigncGFyZW50Tm9kZScpKTskLmVhY2goY2x1c3RlcmVkcyxmdW5jdGlvbihpZHgscGFyYXMpe3ZhciBoZWFkPWxpc3QuaGVhZChwYXJhcyk7aWYoZG9tLmlzTGkoaGVhZCkpe3NlbGYucmVsZWFzZUxpc3QoW3BhcmFzXSk7fWVsc2V7JC5lYWNoKHBhcmFzLGZ1bmN0aW9uKGlkeCxwYXJhKXskKHBhcmEpLmNzcygnbWFyZ2luTGVmdCcsZnVuY3Rpb24oaWR4LHZhbCl7dmFsPXBhcnNlSW50KHZhbCwxMCl8fDA7cmV0dXJuIHZhbD4yNT92YWwtMjU6Jyc7fSk7fSk7fX0pO3JuZy5zZWxlY3QoKTt9Oy8qKlxuICAgICAqIHRvZ2dsZSBsaXN0XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbGlzdE5hbWUgLSBPTCBvciBVTFxuICAgICAqL3RoaXMudG9nZ2xlTGlzdD1mdW5jdGlvbihsaXN0TmFtZSxlZGl0YWJsZSl7dmFyIHJuZz1yYW5nZS5jcmVhdGUoZWRpdGFibGUpLndyYXBCb2R5SW5saW5lV2l0aFBhcmEoKTt2YXIgcGFyYXM9cm5nLm5vZGVzKGRvbS5pc1BhcmEse2luY2x1ZGVBbmNlc3Rvcjp0cnVlfSk7dmFyIGJvb2ttYXJrPXJuZy5wYXJhQm9va21hcmsocGFyYXMpO3ZhciBjbHVzdGVyZWRzPWxpc3QuY2x1c3RlckJ5KHBhcmFzLGZ1bmMucGVxMigncGFyZW50Tm9kZScpKTsvLyBwYXJhZ3JhcGggdG8gbGlzdFxuaWYobGlzdC5maW5kKHBhcmFzLGRvbS5pc1B1cmVQYXJhKSl7dmFyIHdyYXBwZWRQYXJhcz1bXTskLmVhY2goY2x1c3RlcmVkcyxmdW5jdGlvbihpZHgscGFyYXMpe3dyYXBwZWRQYXJhcz13cmFwcGVkUGFyYXMuY29uY2F0KHNlbGYud3JhcExpc3QocGFyYXMsbGlzdE5hbWUpKTt9KTtwYXJhcz13cmFwcGVkUGFyYXM7Ly8gbGlzdCB0byBwYXJhZ3JhcGggb3IgY2hhbmdlIGxpc3Qgc3R5bGVcbn1lbHNle3ZhciBkaWZmTGlzdHM9cm5nLm5vZGVzKGRvbS5pc0xpc3Qse2luY2x1ZGVBbmNlc3Rvcjp0cnVlfSkuZmlsdGVyKGZ1bmN0aW9uKGxpc3ROb2RlKXtyZXR1cm4hJC5ub2RlTmFtZShsaXN0Tm9kZSxsaXN0TmFtZSk7fSk7aWYoZGlmZkxpc3RzLmxlbmd0aCl7JC5lYWNoKGRpZmZMaXN0cyxmdW5jdGlvbihpZHgsbGlzdE5vZGUpe2RvbS5yZXBsYWNlKGxpc3ROb2RlLGxpc3ROYW1lKTt9KTt9ZWxzZXtwYXJhcz10aGlzLnJlbGVhc2VMaXN0KGNsdXN0ZXJlZHMsdHJ1ZSk7fX1yYW5nZS5jcmVhdGVGcm9tUGFyYUJvb2ttYXJrKGJvb2ttYXJrLHBhcmFzKS5zZWxlY3QoKTt9Oy8qKlxuICAgICAqIEBwYXJhbSB7Tm9kZVtdfSBwYXJhc1xuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBsaXN0TmFtZVxuICAgICAqIEByZXR1cm4ge05vZGVbXX1cbiAgICAgKi90aGlzLndyYXBMaXN0PWZ1bmN0aW9uKHBhcmFzLGxpc3ROYW1lKXt2YXIgaGVhZD1saXN0LmhlYWQocGFyYXMpO3ZhciBsYXN0PWxpc3QubGFzdChwYXJhcyk7dmFyIHByZXZMaXN0PWRvbS5pc0xpc3QoaGVhZC5wcmV2aW91c1NpYmxpbmcpJiZoZWFkLnByZXZpb3VzU2libGluZzt2YXIgbmV4dExpc3Q9ZG9tLmlzTGlzdChsYXN0Lm5leHRTaWJsaW5nKSYmbGFzdC5uZXh0U2libGluZzt2YXIgbGlzdE5vZGU9cHJldkxpc3R8fGRvbS5pbnNlcnRBZnRlcihkb20uY3JlYXRlKGxpc3ROYW1lfHwnVUwnKSxsYXN0KTsvLyBQIHRvIExJXG5wYXJhcz1wYXJhcy5tYXAoZnVuY3Rpb24ocGFyYSl7cmV0dXJuIGRvbS5pc1B1cmVQYXJhKHBhcmEpP2RvbS5yZXBsYWNlKHBhcmEsJ0xJJyk6cGFyYTt9KTsvLyBhcHBlbmQgdG8gbGlzdCg8dWw+LCA8b2w+KVxuZG9tLmFwcGVuZENoaWxkTm9kZXMobGlzdE5vZGUscGFyYXMpO2lmKG5leHRMaXN0KXtkb20uYXBwZW5kQ2hpbGROb2RlcyhsaXN0Tm9kZSxsaXN0LmZyb20obmV4dExpc3QuY2hpbGROb2RlcykpO2RvbS5yZW1vdmUobmV4dExpc3QpO31yZXR1cm4gcGFyYXM7fTsvKipcbiAgICAgKiBAbWV0aG9kIHJlbGVhc2VMaXN0XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0FycmF5W119IGNsdXN0ZXJlZHNcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IGlzRXNjYXBzZVRvQm9keVxuICAgICAqIEByZXR1cm4ge05vZGVbXX1cbiAgICAgKi90aGlzLnJlbGVhc2VMaXN0PWZ1bmN0aW9uKGNsdXN0ZXJlZHMsaXNFc2NhcHNlVG9Cb2R5KXt2YXIgcmVsZWFzZWRQYXJhcz1bXTskLmVhY2goY2x1c3RlcmVkcyxmdW5jdGlvbihpZHgscGFyYXMpe3ZhciBoZWFkPWxpc3QuaGVhZChwYXJhcyk7dmFyIGxhc3Q9bGlzdC5sYXN0KHBhcmFzKTt2YXIgaGVhZExpc3Q9aXNFc2NhcHNlVG9Cb2R5P2RvbS5sYXN0QW5jZXN0b3IoaGVhZCxkb20uaXNMaXN0KTpoZWFkLnBhcmVudE5vZGU7dmFyIGxhc3RMaXN0PWhlYWRMaXN0LmNoaWxkTm9kZXMubGVuZ3RoPjE/ZG9tLnNwbGl0VHJlZShoZWFkTGlzdCx7bm9kZTpsYXN0LnBhcmVudE5vZGUsb2Zmc2V0OmRvbS5wb3NpdGlvbihsYXN0KSsxfSx7aXNTa2lwUGFkZGluZ0JsYW5rSFRNTDp0cnVlfSk6bnVsbDt2YXIgbWlkZGxlTGlzdD1kb20uc3BsaXRUcmVlKGhlYWRMaXN0LHtub2RlOmhlYWQucGFyZW50Tm9kZSxvZmZzZXQ6ZG9tLnBvc2l0aW9uKGhlYWQpfSx7aXNTa2lwUGFkZGluZ0JsYW5rSFRNTDp0cnVlfSk7cGFyYXM9aXNFc2NhcHNlVG9Cb2R5P2RvbS5saXN0RGVzY2VuZGFudChtaWRkbGVMaXN0LGRvbS5pc0xpKTpsaXN0LmZyb20obWlkZGxlTGlzdC5jaGlsZE5vZGVzKS5maWx0ZXIoZG9tLmlzTGkpOy8vIExJIHRvIFBcbmlmKGlzRXNjYXBzZVRvQm9keXx8IWRvbS5pc0xpc3QoaGVhZExpc3QucGFyZW50Tm9kZSkpe3BhcmFzPXBhcmFzLm1hcChmdW5jdGlvbihwYXJhKXtyZXR1cm4gZG9tLnJlcGxhY2UocGFyYSwnUCcpO30pO30kLmVhY2gobGlzdC5mcm9tKHBhcmFzKS5yZXZlcnNlKCksZnVuY3Rpb24oaWR4LHBhcmEpe2RvbS5pbnNlcnRBZnRlcihwYXJhLGhlYWRMaXN0KTt9KTsvLyByZW1vdmUgZW1wdHkgbGlzdHNcbnZhciByb290TGlzdHM9bGlzdC5jb21wYWN0KFtoZWFkTGlzdCxtaWRkbGVMaXN0LGxhc3RMaXN0XSk7JC5lYWNoKHJvb3RMaXN0cyxmdW5jdGlvbihpZHgscm9vdExpc3Qpe3ZhciBsaXN0Tm9kZXM9W3Jvb3RMaXN0XS5jb25jYXQoZG9tLmxpc3REZXNjZW5kYW50KHJvb3RMaXN0LGRvbS5pc0xpc3QpKTskLmVhY2gobGlzdE5vZGVzLnJldmVyc2UoKSxmdW5jdGlvbihpZHgsbGlzdE5vZGUpe2lmKCFkb20ubm9kZUxlbmd0aChsaXN0Tm9kZSkpe2RvbS5yZW1vdmUobGlzdE5vZGUsdHJ1ZSk7fX0pO30pO3JlbGVhc2VkUGFyYXM9cmVsZWFzZWRQYXJhcy5jb25jYXQocGFyYXMpO30pO3JldHVybiByZWxlYXNlZFBhcmFzO307fTsvKipcbiAgICogQGNsYXNzIGVkaXRpbmcuVHlwaW5nXG4gICAqXG4gICAqIFR5cGluZ1xuICAgKlxuICAgKi92YXIgVHlwaW5nPWZ1bmN0aW9uKCl7Ly8gYSBCdWxsZXQgaW5zdGFuY2UgdG8gdG9nZ2xlIGxpc3RzIG9mZlxudmFyIGJ1bGxldD1uZXcgQnVsbGV0KCk7LyoqXG4gICAgICogaW5zZXJ0IHRhYlxuICAgICAqXG4gICAgICogQHBhcmFtIHtXcmFwcGVkUmFuZ2V9IHJuZ1xuICAgICAqIEBwYXJhbSB7TnVtYmVyfSB0YWJzaXplXG4gICAgICovdGhpcy5pbnNlcnRUYWI9ZnVuY3Rpb24ocm5nLHRhYnNpemUpe3ZhciB0YWI9ZG9tLmNyZWF0ZVRleHQobmV3IEFycmF5KHRhYnNpemUrMSkuam9pbihkb20uTkJTUF9DSEFSKSk7cm5nPXJuZy5kZWxldGVDb250ZW50cygpO3JuZy5pbnNlcnROb2RlKHRhYix0cnVlKTtybmc9cmFuZ2UuY3JlYXRlKHRhYix0YWJzaXplKTtybmcuc2VsZWN0KCk7fTsvKipcbiAgICAgKiBpbnNlcnQgcGFyYWdyYXBoXG4gICAgICovdGhpcy5pbnNlcnRQYXJhZ3JhcGg9ZnVuY3Rpb24oZWRpdGFibGUpe3ZhciBybmc9cmFuZ2UuY3JlYXRlKGVkaXRhYmxlKTsvLyBkZWxldGVDb250ZW50cyBvbiByYW5nZS5cbnJuZz1ybmcuZGVsZXRlQ29udGVudHMoKTsvLyBXcmFwIHJhbmdlIGlmIGl0IG5lZWRzIHRvIGJlIHdyYXBwZWQgYnkgcGFyYWdyYXBoXG5ybmc9cm5nLndyYXBCb2R5SW5saW5lV2l0aFBhcmEoKTsvLyBmaW5kaW5nIHBhcmFncmFwaFxudmFyIHNwbGl0Um9vdD1kb20uYW5jZXN0b3Iocm5nLnNjLGRvbS5pc1BhcmEpO3ZhciBuZXh0UGFyYTsvLyBvbiBwYXJhZ3JhcGg6IHNwbGl0IHBhcmFncmFwaFxuaWYoc3BsaXRSb290KXsvLyBpZiBpdCBpcyBhbiBlbXB0eSBsaW5lIHdpdGggbGlcbmlmKGRvbS5pc0VtcHR5KHNwbGl0Um9vdCkmJmRvbS5pc0xpKHNwbGl0Um9vdCkpey8vIHRvb2dsZSBVTC9PTCBhbmQgZXNjYXBlXG5idWxsZXQudG9nZ2xlTGlzdChzcGxpdFJvb3QucGFyZW50Tm9kZS5ub2RlTmFtZSk7cmV0dXJuOy8vIGlmIGl0IGlzIGFuIGVtcHR5IGxpbmUgd2l0aCBwYXJhIG9uIGJsb2NrcXVvdGVcbn1lbHNlIGlmKGRvbS5pc0VtcHR5KHNwbGl0Um9vdCkmJmRvbS5pc1BhcmEoc3BsaXRSb290KSYmZG9tLmlzQmxvY2txdW90ZShzcGxpdFJvb3QucGFyZW50Tm9kZSkpey8vIGVzY2FwZSBibG9ja3F1b3RlXG5kb20uaW5zZXJ0QWZ0ZXIoc3BsaXRSb290LHNwbGl0Um9vdC5wYXJlbnROb2RlKTtuZXh0UGFyYT1zcGxpdFJvb3Q7Ly8gaWYgbmV3IGxpbmUgaGFzIGNvbnRlbnQgKG5vdCBhIGxpbmUgYnJlYWspXG59ZWxzZXtuZXh0UGFyYT1kb20uc3BsaXRUcmVlKHNwbGl0Um9vdCxybmcuZ2V0U3RhcnRQb2ludCgpKTt2YXIgZW1wdHlBbmNob3JzPWRvbS5saXN0RGVzY2VuZGFudChzcGxpdFJvb3QsZG9tLmlzRW1wdHlBbmNob3IpO2VtcHR5QW5jaG9ycz1lbXB0eUFuY2hvcnMuY29uY2F0KGRvbS5saXN0RGVzY2VuZGFudChuZXh0UGFyYSxkb20uaXNFbXB0eUFuY2hvcikpOyQuZWFjaChlbXB0eUFuY2hvcnMsZnVuY3Rpb24oaWR4LGFuY2hvcil7ZG9tLnJlbW92ZShhbmNob3IpO30pOy8vIHJlcGxhY2UgZW1wdHkgaGVhZGluZyBvciBwcmUgd2l0aCBQIHRhZ1xuaWYoKGRvbS5pc0hlYWRpbmcobmV4dFBhcmEpfHxkb20uaXNQcmUobmV4dFBhcmEpKSYmZG9tLmlzRW1wdHkobmV4dFBhcmEpKXtuZXh0UGFyYT1kb20ucmVwbGFjZShuZXh0UGFyYSwncCcpO319Ly8gbm8gcGFyYWdyYXBoOiBpbnNlcnQgZW1wdHkgcGFyYWdyYXBoXG59ZWxzZXt2YXIgbmV4dD1ybmcuc2MuY2hpbGROb2Rlc1tybmcuc29dO25leHRQYXJhPSQoZG9tLmVtcHR5UGFyYSlbMF07aWYobmV4dCl7cm5nLnNjLmluc2VydEJlZm9yZShuZXh0UGFyYSxuZXh0KTt9ZWxzZXtybmcuc2MuYXBwZW5kQ2hpbGQobmV4dFBhcmEpO319cmFuZ2UuY3JlYXRlKG5leHRQYXJhLDApLm5vcm1hbGl6ZSgpLnNlbGVjdCgpLnNjcm9sbEludG9WaWV3KGVkaXRhYmxlKTt9O307LyoqXG4gICAqIEBjbGFzcyBlZGl0aW5nLlRhYmxlXG4gICAqXG4gICAqIFRhYmxlXG4gICAqXG4gICAqL3ZhciBUYWJsZT1mdW5jdGlvbigpey8qKlxuICAgICAqIGhhbmRsZSB0YWIga2V5XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1dyYXBwZWRSYW5nZX0gcm5nXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBpc1NoaWZ0XG4gICAgICovdGhpcy50YWI9ZnVuY3Rpb24ocm5nLGlzU2hpZnQpe3ZhciBjZWxsPWRvbS5hbmNlc3RvcihybmcuY29tbW9uQW5jZXN0b3IoKSxkb20uaXNDZWxsKTt2YXIgdGFibGU9ZG9tLmFuY2VzdG9yKGNlbGwsZG9tLmlzVGFibGUpO3ZhciBjZWxscz1kb20ubGlzdERlc2NlbmRhbnQodGFibGUsZG9tLmlzQ2VsbCk7dmFyIG5leHRDZWxsPWxpc3RbaXNTaGlmdD8ncHJldic6J25leHQnXShjZWxscyxjZWxsKTtpZihuZXh0Q2VsbCl7cmFuZ2UuY3JlYXRlKG5leHRDZWxsLDApLnNlbGVjdCgpO319Oy8qKlxuICAgICAqIGNyZWF0ZSBlbXB0eSB0YWJsZSBlbGVtZW50XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gcm93Q291bnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gY29sQ291bnRcbiAgICAgKiBAcmV0dXJuIHtOb2RlfVxuICAgICAqL3RoaXMuY3JlYXRlVGFibGU9ZnVuY3Rpb24oY29sQ291bnQscm93Q291bnQsb3B0aW9ucyl7dmFyIHRkcz1bXSx0ZEhUTUw7Zm9yKHZhciBpZHhDb2w9MDtpZHhDb2w8Y29sQ291bnQ7aWR4Q29sKyspe3Rkcy5wdXNoKCc8dGQ+Jytkb20uYmxhbmsrJzwvdGQ+Jyk7fXRkSFRNTD10ZHMuam9pbignJyk7dmFyIHRycz1bXSx0ckhUTUw7Zm9yKHZhciBpZHhSb3c9MDtpZHhSb3c8cm93Q291bnQ7aWR4Um93Kyspe3Rycy5wdXNoKCc8dHI+Jyt0ZEhUTUwrJzwvdHI+Jyk7fXRySFRNTD10cnMuam9pbignJyk7dmFyICR0YWJsZT0kKCc8dGFibGU+Jyt0ckhUTUwrJzwvdGFibGU+Jyk7aWYob3B0aW9ucyYmb3B0aW9ucy50YWJsZUNsYXNzTmFtZSl7JHRhYmxlLmFkZENsYXNzKG9wdGlvbnMudGFibGVDbGFzc05hbWUpO31yZXR1cm4gJHRhYmxlWzBdO307fTt2YXIgS0VZX0JPR1VTPSdib2d1cyc7LyoqXG4gICAqIEBjbGFzcyBFZGl0b3JcbiAgICovdmFyIEVkaXRvcj1mdW5jdGlvbihjb250ZXh0KXt2YXIgc2VsZj10aGlzO3ZhciAkbm90ZT1jb250ZXh0LmxheW91dEluZm8ubm90ZTt2YXIgJGVkaXRvcj1jb250ZXh0LmxheW91dEluZm8uZWRpdG9yO3ZhciAkZWRpdGFibGU9Y29udGV4dC5sYXlvdXRJbmZvLmVkaXRhYmxlO3ZhciBvcHRpb25zPWNvbnRleHQub3B0aW9uczt2YXIgbGFuZz1vcHRpb25zLmxhbmdJbmZvO3ZhciBlZGl0YWJsZT0kZWRpdGFibGVbMF07dmFyIGxhc3RSYW5nZT1udWxsO3ZhciBzdHlsZT1uZXcgU3R5bGUoKTt2YXIgdGFibGU9bmV3IFRhYmxlKCk7dmFyIHR5cGluZz1uZXcgVHlwaW5nKCk7dmFyIGJ1bGxldD1uZXcgQnVsbGV0KCk7dmFyIGhpc3Rvcnk9bmV3IEhpc3RvcnkoJGVkaXRhYmxlKTt0aGlzLmluaXRpYWxpemU9ZnVuY3Rpb24oKXsvLyBiaW5kIGN1c3RvbSBldmVudHNcbiRlZGl0YWJsZS5vbigna2V5ZG93bicsZnVuY3Rpb24oZXZlbnQpe2lmKGV2ZW50LmtleUNvZGU9PT1rZXkuY29kZS5FTlRFUil7Y29udGV4dC50cmlnZ2VyRXZlbnQoJ2VudGVyJyxldmVudCk7fWNvbnRleHQudHJpZ2dlckV2ZW50KCdrZXlkb3duJyxldmVudCk7aWYoIWV2ZW50LmlzRGVmYXVsdFByZXZlbnRlZCgpKXtpZihvcHRpb25zLnNob3J0Y3V0cyl7c2VsZi5oYW5kbGVLZXlNYXAoZXZlbnQpO31lbHNle3NlbGYucHJldmVudERlZmF1bHRFZGl0YWJsZVNob3J0Q3V0cyhldmVudCk7fX19KS5vbigna2V5dXAnLGZ1bmN0aW9uKGV2ZW50KXtjb250ZXh0LnRyaWdnZXJFdmVudCgna2V5dXAnLGV2ZW50KTt9KS5vbignZm9jdXMnLGZ1bmN0aW9uKGV2ZW50KXtjb250ZXh0LnRyaWdnZXJFdmVudCgnZm9jdXMnLGV2ZW50KTt9KS5vbignYmx1cicsZnVuY3Rpb24oZXZlbnQpe2NvbnRleHQudHJpZ2dlckV2ZW50KCdibHVyJyxldmVudCk7fSkub24oJ21vdXNlZG93bicsZnVuY3Rpb24oZXZlbnQpe2NvbnRleHQudHJpZ2dlckV2ZW50KCdtb3VzZWRvd24nLGV2ZW50KTt9KS5vbignbW91c2V1cCcsZnVuY3Rpb24oZXZlbnQpe2NvbnRleHQudHJpZ2dlckV2ZW50KCdtb3VzZXVwJyxldmVudCk7fSkub24oJ3Njcm9sbCcsZnVuY3Rpb24oZXZlbnQpe2NvbnRleHQudHJpZ2dlckV2ZW50KCdzY3JvbGwnLGV2ZW50KTt9KS5vbigncGFzdGUnLGZ1bmN0aW9uKGV2ZW50KXtjb250ZXh0LnRyaWdnZXJFdmVudCgncGFzdGUnLGV2ZW50KTt9KTsvLyBpbml0IGNvbnRlbnQgYmVmb3JlIHNldCBldmVudFxuJGVkaXRhYmxlLmh0bWwoZG9tLmh0bWwoJG5vdGUpfHxkb20uZW1wdHlQYXJhKTsvLyBbd29ya2Fyb3VuZF0gSUUgZG9lc24ndCBoYXZlIGlucHV0IGV2ZW50cyBmb3IgY29udGVudEVkaXRhYmxlXG4vLyAtIHNlZTogaHR0cHM6Ly9nb28uZ2wvNGJmSXZBXG52YXIgY2hhbmdlRXZlbnROYW1lPWFnZW50LmlzTVNJRT8nRE9NQ2hhcmFjdGVyRGF0YU1vZGlmaWVkIERPTVN1YnRyZWVNb2RpZmllZCBET01Ob2RlSW5zZXJ0ZWQnOidpbnB1dCc7JGVkaXRhYmxlLm9uKGNoYW5nZUV2ZW50TmFtZSxmdW5jLmRlYm91bmNlKGZ1bmN0aW9uKCl7Y29udGV4dC50cmlnZ2VyRXZlbnQoJ2NoYW5nZScsJGVkaXRhYmxlLmh0bWwoKSk7fSwyNTApKTskZWRpdG9yLm9uKCdmb2N1c2luJyxmdW5jdGlvbihldmVudCl7Y29udGV4dC50cmlnZ2VyRXZlbnQoJ2ZvY3VzaW4nLGV2ZW50KTt9KS5vbignZm9jdXNvdXQnLGZ1bmN0aW9uKGV2ZW50KXtjb250ZXh0LnRyaWdnZXJFdmVudCgnZm9jdXNvdXQnLGV2ZW50KTt9KTtpZighb3B0aW9ucy5haXJNb2RlKXtpZihvcHRpb25zLndpZHRoKXskZWRpdG9yLm91dGVyV2lkdGgob3B0aW9ucy53aWR0aCk7fWlmKG9wdGlvbnMuaGVpZ2h0KXskZWRpdGFibGUub3V0ZXJIZWlnaHQob3B0aW9ucy5oZWlnaHQpO31pZihvcHRpb25zLm1heEhlaWdodCl7JGVkaXRhYmxlLmNzcygnbWF4LWhlaWdodCcsb3B0aW9ucy5tYXhIZWlnaHQpO31pZihvcHRpb25zLm1pbkhlaWdodCl7JGVkaXRhYmxlLmNzcygnbWluLWhlaWdodCcsb3B0aW9ucy5taW5IZWlnaHQpO319aGlzdG9yeS5yZWNvcmRVbmRvKCk7fTt0aGlzLmRlc3Ryb3k9ZnVuY3Rpb24oKXskZWRpdGFibGUub2ZmKCk7fTt0aGlzLmhhbmRsZUtleU1hcD1mdW5jdGlvbihldmVudCl7dmFyIGtleU1hcD1vcHRpb25zLmtleU1hcFthZ2VudC5pc01hYz8nbWFjJzoncGMnXTt2YXIga2V5cz1bXTtpZihldmVudC5tZXRhS2V5KXtrZXlzLnB1c2goJ0NNRCcpO31pZihldmVudC5jdHJsS2V5JiYhZXZlbnQuYWx0S2V5KXtrZXlzLnB1c2goJ0NUUkwnKTt9aWYoZXZlbnQuc2hpZnRLZXkpe2tleXMucHVzaCgnU0hJRlQnKTt9dmFyIGtleU5hbWU9a2V5Lm5hbWVGcm9tQ29kZVtldmVudC5rZXlDb2RlXTtpZihrZXlOYW1lKXtrZXlzLnB1c2goa2V5TmFtZSk7fXZhciBldmVudE5hbWU9a2V5TWFwW2tleXMuam9pbignKycpXTtpZihldmVudE5hbWUpe2V2ZW50LnByZXZlbnREZWZhdWx0KCk7Y29udGV4dC5pbnZva2UoZXZlbnROYW1lKTt9ZWxzZSBpZihrZXkuaXNFZGl0KGV2ZW50LmtleUNvZGUpKXt0aGlzLmFmdGVyQ29tbWFuZCgpO319O3RoaXMucHJldmVudERlZmF1bHRFZGl0YWJsZVNob3J0Q3V0cz1mdW5jdGlvbihldmVudCl7Ly8gQihCb2xkLCA2NikgLyBJKEl0YWxpYywgNzMpIC8gVShVbmRlcmxpbmUsIDg1KVxuaWYoKGV2ZW50LmN0cmxLZXl8fGV2ZW50Lm1ldGFLZXkpJiZsaXN0LmNvbnRhaW5zKFs2Niw3Myw4NV0sZXZlbnQua2V5Q29kZSkpe2V2ZW50LnByZXZlbnREZWZhdWx0KCk7fX07LyoqXG4gICAgICogY3JlYXRlIHJhbmdlXG4gICAgICogQHJldHVybiB7V3JhcHBlZFJhbmdlfVxuICAgICAqL3RoaXMuY3JlYXRlUmFuZ2U9ZnVuY3Rpb24oKXt0aGlzLmZvY3VzKCk7cmV0dXJuIHJhbmdlLmNyZWF0ZShlZGl0YWJsZSk7fTsvKipcbiAgICAgKiBzYXZlUmFuZ2VcbiAgICAgKlxuICAgICAqIHNhdmUgY3VycmVudCByYW5nZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbdGhlbkNvbGxhcHNlPWZhbHNlXVxuICAgICAqL3RoaXMuc2F2ZVJhbmdlPWZ1bmN0aW9uKHRoZW5Db2xsYXBzZSl7bGFzdFJhbmdlPXRoaXMuY3JlYXRlUmFuZ2UoKTtpZih0aGVuQ29sbGFwc2Upe2xhc3RSYW5nZS5jb2xsYXBzZSgpLnNlbGVjdCgpO319Oy8qKlxuICAgICAqIHJlc3RvcmVSYW5nZVxuICAgICAqXG4gICAgICogcmVzdG9yZSBsYXRlbHkgcmFuZ2VcbiAgICAgKi90aGlzLnJlc3RvcmVSYW5nZT1mdW5jdGlvbigpe2lmKGxhc3RSYW5nZSl7bGFzdFJhbmdlLnNlbGVjdCgpO3RoaXMuZm9jdXMoKTt9fTt0aGlzLnNhdmVUYXJnZXQ9ZnVuY3Rpb24obm9kZSl7JGVkaXRhYmxlLmRhdGEoJ3RhcmdldCcsbm9kZSk7fTt0aGlzLmNsZWFyVGFyZ2V0PWZ1bmN0aW9uKCl7JGVkaXRhYmxlLnJlbW92ZURhdGEoJ3RhcmdldCcpO307dGhpcy5yZXN0b3JlVGFyZ2V0PWZ1bmN0aW9uKCl7cmV0dXJuICRlZGl0YWJsZS5kYXRhKCd0YXJnZXQnKTt9Oy8qKlxuICAgICAqIGN1cnJlbnRTdHlsZVxuICAgICAqXG4gICAgICogY3VycmVudCBzdHlsZVxuICAgICAqIEByZXR1cm4ge09iamVjdHxCb29sZWFufSB1bmZvY3VzXG4gICAgICovdGhpcy5jdXJyZW50U3R5bGU9ZnVuY3Rpb24oKXt2YXIgcm5nPXJhbmdlLmNyZWF0ZSgpO2lmKHJuZyl7cm5nPXJuZy5ub3JtYWxpemUoKTt9cmV0dXJuIHJuZz9zdHlsZS5jdXJyZW50KHJuZyk6c3R5bGUuZnJvbU5vZGUoJGVkaXRhYmxlKTt9Oy8qKlxuICAgICAqIHN0eWxlIGZyb20gbm9kZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtqUXVlcnl9ICRub2RlXG4gICAgICogQHJldHVybiB7T2JqZWN0fVxuICAgICAqL3RoaXMuc3R5bGVGcm9tTm9kZT1mdW5jdGlvbigkbm9kZSl7cmV0dXJuIHN0eWxlLmZyb21Ob2RlKCRub2RlKTt9Oy8qKlxuICAgICAqIHVuZG9cbiAgICAgKi90aGlzLnVuZG89ZnVuY3Rpb24oKXtjb250ZXh0LnRyaWdnZXJFdmVudCgnYmVmb3JlLmNvbW1hbmQnLCRlZGl0YWJsZS5odG1sKCkpO2hpc3RvcnkudW5kbygpO2NvbnRleHQudHJpZ2dlckV2ZW50KCdjaGFuZ2UnLCRlZGl0YWJsZS5odG1sKCkpO307Y29udGV4dC5tZW1vKCdoZWxwLnVuZG8nLGxhbmcuaGVscC51bmRvKTsvKipcbiAgICAgKiByZWRvXG4gICAgICovdGhpcy5yZWRvPWZ1bmN0aW9uKCl7Y29udGV4dC50cmlnZ2VyRXZlbnQoJ2JlZm9yZS5jb21tYW5kJywkZWRpdGFibGUuaHRtbCgpKTtoaXN0b3J5LnJlZG8oKTtjb250ZXh0LnRyaWdnZXJFdmVudCgnY2hhbmdlJywkZWRpdGFibGUuaHRtbCgpKTt9O2NvbnRleHQubWVtbygnaGVscC5yZWRvJyxsYW5nLmhlbHAucmVkbyk7LyoqXG4gICAgICogYmVmb3JlIGNvbW1hbmRcbiAgICAgKi92YXIgYmVmb3JlQ29tbWFuZD10aGlzLmJlZm9yZUNvbW1hbmQ9ZnVuY3Rpb24oKXtjb250ZXh0LnRyaWdnZXJFdmVudCgnYmVmb3JlLmNvbW1hbmQnLCRlZGl0YWJsZS5odG1sKCkpOy8vIGtlZXAgZm9jdXMgb24gZWRpdGFibGUgYmVmb3JlIGNvbW1hbmQgZXhlY3V0aW9uXG5zZWxmLmZvY3VzKCk7fTsvKipcbiAgICAgKiBhZnRlciBjb21tYW5kXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBpc1ByZXZlbnRUcmlnZ2VyXG4gICAgICovdmFyIGFmdGVyQ29tbWFuZD10aGlzLmFmdGVyQ29tbWFuZD1mdW5jdGlvbihpc1ByZXZlbnRUcmlnZ2VyKXtoaXN0b3J5LnJlY29yZFVuZG8oKTtpZighaXNQcmV2ZW50VHJpZ2dlcil7Y29udGV4dC50cmlnZ2VyRXZlbnQoJ2NoYW5nZScsJGVkaXRhYmxlLmh0bWwoKSk7fX07LyoganNoaW50IGlnbm9yZTpzdGFydCAqLy8vIG5hdGl2ZSBjb21tYW5kcyh3aXRoIGV4ZWNDb21tYW5kKSwgZ2VuZXJhdGUgZnVuY3Rpb24gZm9yIGV4ZWNDb21tYW5kXG52YXIgY29tbWFuZHM9Wydib2xkJywnaXRhbGljJywndW5kZXJsaW5lJywnc3RyaWtldGhyb3VnaCcsJ3N1cGVyc2NyaXB0Jywnc3Vic2NyaXB0JywnanVzdGlmeUxlZnQnLCdqdXN0aWZ5Q2VudGVyJywnanVzdGlmeVJpZ2h0JywnanVzdGlmeUZ1bGwnLCdmb3JtYXRCbG9jaycsJ3JlbW92ZUZvcm1hdCcsJ2JhY2tDb2xvcicsJ2ZvcmVDb2xvcicsJ2ZvbnROYW1lJ107Zm9yKHZhciBpZHg9MCxsZW49Y29tbWFuZHMubGVuZ3RoO2lkeDxsZW47aWR4Kyspe3RoaXNbY29tbWFuZHNbaWR4XV09ZnVuY3Rpb24oc0NtZCl7cmV0dXJuIGZ1bmN0aW9uKHZhbHVlKXtiZWZvcmVDb21tYW5kKCk7ZG9jdW1lbnQuZXhlY0NvbW1hbmQoc0NtZCxmYWxzZSx2YWx1ZSk7YWZ0ZXJDb21tYW5kKHRydWUpO307fShjb21tYW5kc1tpZHhdKTtjb250ZXh0Lm1lbW8oJ2hlbHAuJytjb21tYW5kc1tpZHhdLGxhbmcuaGVscFtjb21tYW5kc1tpZHhdXSk7fS8qIGpzaGludCBpZ25vcmU6ZW5kICovLyoqXG4gICAgICogaGFuZGxlIHRhYiBrZXlcbiAgICAgKi90aGlzLnRhYj1mdW5jdGlvbigpe3ZhciBybmc9dGhpcy5jcmVhdGVSYW5nZSgpO2lmKHJuZy5pc0NvbGxhcHNlZCgpJiZybmcuaXNPbkNlbGwoKSl7dGFibGUudGFiKHJuZyk7fWVsc2V7YmVmb3JlQ29tbWFuZCgpO3R5cGluZy5pbnNlcnRUYWIocm5nLG9wdGlvbnMudGFiU2l6ZSk7YWZ0ZXJDb21tYW5kKCk7fX07Y29udGV4dC5tZW1vKCdoZWxwLnRhYicsbGFuZy5oZWxwLnRhYik7LyoqXG4gICAgICogaGFuZGxlIHNoaWZ0K3RhYiBrZXlcbiAgICAgKi90aGlzLnVudGFiPWZ1bmN0aW9uKCl7dmFyIHJuZz10aGlzLmNyZWF0ZVJhbmdlKCk7aWYocm5nLmlzQ29sbGFwc2VkKCkmJnJuZy5pc09uQ2VsbCgpKXt0YWJsZS50YWIocm5nLHRydWUpO319O2NvbnRleHQubWVtbygnaGVscC51bnRhYicsbGFuZy5oZWxwLnVudGFiKTsvKipcbiAgICAgKiBydW4gZ2l2ZW4gZnVuY3Rpb24gYmV0d2VlbiBiZWZvcmVDb21tYW5kIGFuZCBhZnRlckNvbW1hbmRcbiAgICAgKi90aGlzLndyYXBDb21tYW5kPWZ1bmN0aW9uKGZuKXtyZXR1cm4gZnVuY3Rpb24oKXtiZWZvcmVDb21tYW5kKCk7Zm4uYXBwbHkoc2VsZixhcmd1bWVudHMpO2FmdGVyQ29tbWFuZCgpO307fTsvKipcbiAgICAgKiBpbnNlcnQgcGFyYWdyYXBoXG4gICAgICovdGhpcy5pbnNlcnRQYXJhZ3JhcGg9dGhpcy53cmFwQ29tbWFuZChmdW5jdGlvbigpe3R5cGluZy5pbnNlcnRQYXJhZ3JhcGgoZWRpdGFibGUpO30pO2NvbnRleHQubWVtbygnaGVscC5pbnNlcnRQYXJhZ3JhcGgnLGxhbmcuaGVscC5pbnNlcnRQYXJhZ3JhcGgpO3RoaXMuaW5zZXJ0T3JkZXJlZExpc3Q9dGhpcy53cmFwQ29tbWFuZChmdW5jdGlvbigpe2J1bGxldC5pbnNlcnRPcmRlcmVkTGlzdChlZGl0YWJsZSk7fSk7Y29udGV4dC5tZW1vKCdoZWxwLmluc2VydE9yZGVyZWRMaXN0JyxsYW5nLmhlbHAuaW5zZXJ0T3JkZXJlZExpc3QpO3RoaXMuaW5zZXJ0VW5vcmRlcmVkTGlzdD10aGlzLndyYXBDb21tYW5kKGZ1bmN0aW9uKCl7YnVsbGV0Lmluc2VydFVub3JkZXJlZExpc3QoZWRpdGFibGUpO30pO2NvbnRleHQubWVtbygnaGVscC5pbnNlcnRVbm9yZGVyZWRMaXN0JyxsYW5nLmhlbHAuaW5zZXJ0VW5vcmRlcmVkTGlzdCk7dGhpcy5pbmRlbnQ9dGhpcy53cmFwQ29tbWFuZChmdW5jdGlvbigpe2J1bGxldC5pbmRlbnQoZWRpdGFibGUpO30pO2NvbnRleHQubWVtbygnaGVscC5pbmRlbnQnLGxhbmcuaGVscC5pbmRlbnQpO3RoaXMub3V0ZGVudD10aGlzLndyYXBDb21tYW5kKGZ1bmN0aW9uKCl7YnVsbGV0Lm91dGRlbnQoZWRpdGFibGUpO30pO2NvbnRleHQubWVtbygnaGVscC5vdXRkZW50JyxsYW5nLmhlbHAub3V0ZGVudCk7LyoqXG4gICAgICogaW5zZXJ0IGltYWdlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gc3JjXG4gICAgICogQHBhcmFtIHtTdHJpbmd8RnVuY3Rpb259IHBhcmFtXG4gICAgICogQHJldHVybiB7UHJvbWlzZX1cbiAgICAgKi90aGlzLmluc2VydEltYWdlPWZ1bmN0aW9uKHNyYyxwYXJhbSl7cmV0dXJuIGFzeW5jLmNyZWF0ZUltYWdlKHNyYyxwYXJhbSkudGhlbihmdW5jdGlvbigkaW1hZ2Upe2JlZm9yZUNvbW1hbmQoKTtpZih0eXBlb2YgcGFyYW09PT0nZnVuY3Rpb24nKXtwYXJhbSgkaW1hZ2UpO31lbHNle2lmKHR5cGVvZiBwYXJhbT09PSdzdHJpbmcnKXskaW1hZ2UuYXR0cignZGF0YS1maWxlbmFtZScscGFyYW0pO30kaW1hZ2UuY3NzKCd3aWR0aCcsTWF0aC5taW4oJGVkaXRhYmxlLndpZHRoKCksJGltYWdlLndpZHRoKCkpKTt9JGltYWdlLnNob3coKTtyYW5nZS5jcmVhdGUoZWRpdGFibGUpLmluc2VydE5vZGUoJGltYWdlWzBdKTtyYW5nZS5jcmVhdGVGcm9tTm9kZUFmdGVyKCRpbWFnZVswXSkuc2VsZWN0KCk7YWZ0ZXJDb21tYW5kKCk7fSkuZmFpbChmdW5jdGlvbihlKXtjb250ZXh0LnRyaWdnZXJFdmVudCgnaW1hZ2UudXBsb2FkLmVycm9yJyxlKTt9KTt9Oy8qKlxuICAgICAqIGluc2VydEltYWdlc1xuICAgICAqIEBwYXJhbSB7RmlsZVtdfSBmaWxlc1xuICAgICAqL3RoaXMuaW5zZXJ0SW1hZ2VzPWZ1bmN0aW9uKGZpbGVzKXskLmVhY2goZmlsZXMsZnVuY3Rpb24oaWR4LGZpbGUpe3ZhciBmaWxlbmFtZT1maWxlLm5hbWU7aWYob3B0aW9ucy5tYXhpbXVtSW1hZ2VGaWxlU2l6ZSYmb3B0aW9ucy5tYXhpbXVtSW1hZ2VGaWxlU2l6ZTxmaWxlLnNpemUpe2NvbnRleHQudHJpZ2dlckV2ZW50KCdpbWFnZS51cGxvYWQuZXJyb3InLGxhbmcuaW1hZ2UubWF4aW11bUZpbGVTaXplRXJyb3IpO31lbHNle2FzeW5jLnJlYWRGaWxlQXNEYXRhVVJMKGZpbGUpLnRoZW4oZnVuY3Rpb24oZGF0YVVSTCl7cmV0dXJuIHNlbGYuaW5zZXJ0SW1hZ2UoZGF0YVVSTCxmaWxlbmFtZSk7fSkuZmFpbChmdW5jdGlvbigpe2NvbnRleHQudHJpZ2dlckV2ZW50KCdpbWFnZS51cGxvYWQuZXJyb3InKTt9KTt9fSk7fTsvKipcbiAgICAgKiBpbnNlcnRJbWFnZXNPckNhbGxiYWNrXG4gICAgICogQHBhcmFtIHtGaWxlW119IGZpbGVzXG4gICAgICovdGhpcy5pbnNlcnRJbWFnZXNPckNhbGxiYWNrPWZ1bmN0aW9uKGZpbGVzKXt2YXIgY2FsbGJhY2tzPW9wdGlvbnMuY2FsbGJhY2tzOy8vIElmIG9uSW1hZ2VVcGxvYWQgb3B0aW9ucyBzZXR0ZWRcbmlmKGNhbGxiYWNrcy5vbkltYWdlVXBsb2FkKXtjb250ZXh0LnRyaWdnZXJFdmVudCgnaW1hZ2UudXBsb2FkJyxmaWxlcyk7Ly8gZWxzZSBpbnNlcnQgSW1hZ2UgYXMgZGF0YVVSTFxufWVsc2V7dGhpcy5pbnNlcnRJbWFnZXMoZmlsZXMpO319Oy8qKlxuICAgICAqIGluc2VydE5vZGVcbiAgICAgKiBpbnNlcnQgbm9kZVxuICAgICAqIEBwYXJhbSB7Tm9kZX0gbm9kZVxuICAgICAqL3RoaXMuaW5zZXJ0Tm9kZT10aGlzLndyYXBDb21tYW5kKGZ1bmN0aW9uKG5vZGUpe3ZhciBybmc9dGhpcy5jcmVhdGVSYW5nZSgpO3JuZy5pbnNlcnROb2RlKG5vZGUpO3JhbmdlLmNyZWF0ZUZyb21Ob2RlQWZ0ZXIobm9kZSkuc2VsZWN0KCk7fSk7LyoqXG4gICAgICogaW5zZXJ0IHRleHRcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdGV4dFxuICAgICAqL3RoaXMuaW5zZXJ0VGV4dD10aGlzLndyYXBDb21tYW5kKGZ1bmN0aW9uKHRleHQpe3ZhciBybmc9dGhpcy5jcmVhdGVSYW5nZSgpO3ZhciB0ZXh0Tm9kZT1ybmcuaW5zZXJ0Tm9kZShkb20uY3JlYXRlVGV4dCh0ZXh0KSk7cmFuZ2UuY3JlYXRlKHRleHROb2RlLGRvbS5ub2RlTGVuZ3RoKHRleHROb2RlKSkuc2VsZWN0KCk7fSk7LyoqXG4gICAgICogcmV0dXJuIHNlbGVjdGVkIHBsYWluIHRleHRcbiAgICAgKiBAcmV0dXJuIHtTdHJpbmd9IHRleHRcbiAgICAgKi90aGlzLmdldFNlbGVjdGVkVGV4dD1mdW5jdGlvbigpe3ZhciBybmc9dGhpcy5jcmVhdGVSYW5nZSgpOy8vIGlmIHJhbmdlIG9uIGFuY2hvciwgZXhwYW5kIHJhbmdlIHdpdGggYW5jaG9yXG5pZihybmcuaXNPbkFuY2hvcigpKXtybmc9cmFuZ2UuY3JlYXRlRnJvbU5vZGUoZG9tLmFuY2VzdG9yKHJuZy5zYyxkb20uaXNBbmNob3IpKTt9cmV0dXJuIHJuZy50b1N0cmluZygpO307LyoqXG4gICAgICogcGFzdGUgSFRNTFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBtYXJrdXBcbiAgICAgKi90aGlzLnBhc3RlSFRNTD10aGlzLndyYXBDb21tYW5kKGZ1bmN0aW9uKG1hcmt1cCl7dmFyIGNvbnRlbnRzPXRoaXMuY3JlYXRlUmFuZ2UoKS5wYXN0ZUhUTUwobWFya3VwKTtyYW5nZS5jcmVhdGVGcm9tTm9kZUFmdGVyKGxpc3QubGFzdChjb250ZW50cykpLnNlbGVjdCgpO30pOy8qKlxuICAgICAqIGZvcm1hdEJsb2NrXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdGFnTmFtZVxuICAgICAqL3RoaXMuZm9ybWF0QmxvY2s9dGhpcy53cmFwQ29tbWFuZChmdW5jdGlvbih0YWdOYW1lKXsvLyBbd29ya2Fyb3VuZF0gZm9yIE1TSUUsIElFIG5lZWQgYDxgXG50YWdOYW1lPWFnZW50LmlzTVNJRT8nPCcrdGFnTmFtZSsnPic6dGFnTmFtZTtkb2N1bWVudC5leGVjQ29tbWFuZCgnRm9ybWF0QmxvY2snLGZhbHNlLHRhZ05hbWUpO30pO3RoaXMuZm9ybWF0UGFyYT1mdW5jdGlvbigpe3RoaXMuZm9ybWF0QmxvY2soJ1AnKTt9O2NvbnRleHQubWVtbygnaGVscC5mb3JtYXRQYXJhJyxsYW5nLmhlbHAuZm9ybWF0UGFyYSk7LyoganNoaW50IGlnbm9yZTpzdGFydCAqL2Zvcih2YXIgaWR4PTE7aWR4PD02O2lkeCsrKXt0aGlzWydmb3JtYXRIJytpZHhdPWZ1bmN0aW9uKGlkeCl7cmV0dXJuIGZ1bmN0aW9uKCl7dGhpcy5mb3JtYXRCbG9jaygnSCcraWR4KTt9O30oaWR4KTtjb250ZXh0Lm1lbW8oJ2hlbHAuZm9ybWF0SCcraWR4LGxhbmcuaGVscFsnZm9ybWF0SCcraWR4XSk7fTsvKiBqc2hpbnQgaWdub3JlOmVuZCAqLy8qKlxuICAgICAqIGZvbnRTaXplXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdmFsdWUgLSBweFxuICAgICAqL3RoaXMuZm9udFNpemU9ZnVuY3Rpb24odmFsdWUpe3ZhciBybmc9dGhpcy5jcmVhdGVSYW5nZSgpO2lmKHJuZyYmcm5nLmlzQ29sbGFwc2VkKCkpe3ZhciBzcGFucz1zdHlsZS5zdHlsZU5vZGVzKHJuZyk7dmFyIGZpcnN0U3Bhbj1saXN0LmhlYWQoc3BhbnMpOyQoc3BhbnMpLmNzcyh7J2ZvbnQtc2l6ZSc6dmFsdWUrJ3B4J30pOy8vIFt3b3JrYXJvdW5kXSBhZGRlZCBzdHlsZWQgYm9ndXMgc3BhbiBmb3Igc3R5bGVcbi8vICAtIGFsc28gYm9ndXMgY2hhcmFjdGVyIG5lZWRlZCBmb3IgY3Vyc29yIHBvc2l0aW9uXG5pZihmaXJzdFNwYW4mJiFkb20ubm9kZUxlbmd0aChmaXJzdFNwYW4pKXtmaXJzdFNwYW4uaW5uZXJIVE1MPWRvbS5aRVJPX1dJRFRIX05CU1BfQ0hBUjtyYW5nZS5jcmVhdGVGcm9tTm9kZUFmdGVyKGZpcnN0U3Bhbi5maXJzdENoaWxkKS5zZWxlY3QoKTskZWRpdGFibGUuZGF0YShLRVlfQk9HVVMsZmlyc3RTcGFuKTt9fWVsc2V7YmVmb3JlQ29tbWFuZCgpOyQoc3R5bGUuc3R5bGVOb2RlcyhybmcpKS5jc3Moeydmb250LXNpemUnOnZhbHVlKydweCd9KTthZnRlckNvbW1hbmQoKTt9fTsvKipcbiAgICAgKiBpbnNlcnQgaG9yaXpvbnRhbCBydWxlXG4gICAgICovdGhpcy5pbnNlcnRIb3Jpem9udGFsUnVsZT10aGlzLndyYXBDb21tYW5kKGZ1bmN0aW9uKCl7dmFyIGhyTm9kZT10aGlzLmNyZWF0ZVJhbmdlKCkuaW5zZXJ0Tm9kZShkb20uY3JlYXRlKCdIUicpKTtpZihock5vZGUubmV4dFNpYmxpbmcpe3JhbmdlLmNyZWF0ZShock5vZGUubmV4dFNpYmxpbmcsMCkubm9ybWFsaXplKCkuc2VsZWN0KCk7fX0pO2NvbnRleHQubWVtbygnaGVscC5pbnNlcnRIb3Jpem9udGFsUnVsZScsbGFuZy5oZWxwLmluc2VydEhvcml6b250YWxSdWxlKTsvKipcbiAgICAgKiByZW1vdmUgYm9ndXMgbm9kZSBhbmQgY2hhcmFjdGVyXG4gICAgICovdGhpcy5yZW1vdmVCb2d1cz1mdW5jdGlvbigpe3ZhciBib2d1c05vZGU9JGVkaXRhYmxlLmRhdGEoS0VZX0JPR1VTKTtpZighYm9ndXNOb2RlKXtyZXR1cm47fXZhciB0ZXh0Tm9kZT1saXN0LmZpbmQobGlzdC5mcm9tKGJvZ3VzTm9kZS5jaGlsZE5vZGVzKSxkb20uaXNUZXh0KTt2YXIgYm9ndXNDaGFySWR4PXRleHROb2RlLm5vZGVWYWx1ZS5pbmRleE9mKGRvbS5aRVJPX1dJRFRIX05CU1BfQ0hBUik7aWYoYm9ndXNDaGFySWR4IT09LTEpe3RleHROb2RlLmRlbGV0ZURhdGEoYm9ndXNDaGFySWR4LDEpO31pZihkb20uaXNFbXB0eShib2d1c05vZGUpKXtkb20ucmVtb3ZlKGJvZ3VzTm9kZSk7fSRlZGl0YWJsZS5yZW1vdmVEYXRhKEtFWV9CT0dVUyk7fTsvKipcbiAgICAgKiBsaW5lSGVpZ2h0XG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHZhbHVlXG4gICAgICovdGhpcy5saW5lSGVpZ2h0PXRoaXMud3JhcENvbW1hbmQoZnVuY3Rpb24odmFsdWUpe3N0eWxlLnN0eWxlUGFyYSh0aGlzLmNyZWF0ZVJhbmdlKCkse2xpbmVIZWlnaHQ6dmFsdWV9KTt9KTsvKipcbiAgICAgKiB1bmxpbmtcbiAgICAgKlxuICAgICAqIEB0eXBlIGNvbW1hbmRcbiAgICAgKi90aGlzLnVubGluaz1mdW5jdGlvbigpe3ZhciBybmc9dGhpcy5jcmVhdGVSYW5nZSgpO2lmKHJuZy5pc09uQW5jaG9yKCkpe3ZhciBhbmNob3I9ZG9tLmFuY2VzdG9yKHJuZy5zYyxkb20uaXNBbmNob3IpO3JuZz1yYW5nZS5jcmVhdGVGcm9tTm9kZShhbmNob3IpO3JuZy5zZWxlY3QoKTtiZWZvcmVDb21tYW5kKCk7ZG9jdW1lbnQuZXhlY0NvbW1hbmQoJ3VubGluaycpO2FmdGVyQ29tbWFuZCgpO319Oy8qKlxuICAgICAqIGNyZWF0ZSBsaW5rIChjb21tYW5kKVxuICAgICAqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGxpbmtJbmZvXG4gICAgICovdGhpcy5jcmVhdGVMaW5rPXRoaXMud3JhcENvbW1hbmQoZnVuY3Rpb24obGlua0luZm8pe3ZhciBsaW5rVXJsPWxpbmtJbmZvLnVybDt2YXIgbGlua1RleHQ9bGlua0luZm8udGV4dDt2YXIgaXNOZXdXaW5kb3c9bGlua0luZm8uaXNOZXdXaW5kb3c7dmFyIHJuZz1saW5rSW5mby5yYW5nZXx8dGhpcy5jcmVhdGVSYW5nZSgpO3ZhciBpc1RleHRDaGFuZ2VkPXJuZy50b1N0cmluZygpIT09bGlua1RleHQ7Ly8gaGFuZGxlIHNwYWNlZCB1cmxzIGZyb20gaW5wdXRcbmlmKHR5cGVvZiBsaW5rVXJsPT09J3N0cmluZycpe2xpbmtVcmw9bGlua1VybC50cmltKCk7fWlmKG9wdGlvbnMub25DcmVhdGVMaW5rKXtsaW5rVXJsPW9wdGlvbnMub25DcmVhdGVMaW5rKGxpbmtVcmwpO312YXIgYW5jaG9ycz1bXTtpZihpc1RleHRDaGFuZ2VkKXtybmc9cm5nLmRlbGV0ZUNvbnRlbnRzKCk7dmFyIGFuY2hvcj1ybmcuaW5zZXJ0Tm9kZSgkKCc8QT4nK2xpbmtUZXh0Kyc8L0E+JylbMF0pO2FuY2hvcnMucHVzaChhbmNob3IpO31lbHNle2FuY2hvcnM9c3R5bGUuc3R5bGVOb2Rlcyhybmcse25vZGVOYW1lOidBJyxleHBhbmRDbG9zZXN0U2libGluZzp0cnVlLG9ubHlQYXJ0aWFsQ29udGFpbnM6dHJ1ZX0pO30kLmVhY2goYW5jaG9ycyxmdW5jdGlvbihpZHgsYW5jaG9yKXsvLyBpZiB1cmwgZG9lc24ndCBtYXRjaCBhbiBVUkwgc2NoZW1hLCBzZXQgaHR0cDovLyBhcyBkZWZhdWx0XG5saW5rVXJsPS9eW0EtWmEtel1bQS1aYS16MC05Ky0uXSpcXDpbXFwvXFwvXT8vLnRlc3QobGlua1VybCk/bGlua1VybDonaHR0cDovLycrbGlua1VybDskKGFuY2hvcikuYXR0cignaHJlZicsbGlua1VybCk7aWYoaXNOZXdXaW5kb3cpeyQoYW5jaG9yKS5hdHRyKCd0YXJnZXQnLCdfYmxhbmsnKTt9ZWxzZXskKGFuY2hvcikucmVtb3ZlQXR0cigndGFyZ2V0Jyk7fX0pO3ZhciBzdGFydFJhbmdlPXJhbmdlLmNyZWF0ZUZyb21Ob2RlQmVmb3JlKGxpc3QuaGVhZChhbmNob3JzKSk7dmFyIHN0YXJ0UG9pbnQ9c3RhcnRSYW5nZS5nZXRTdGFydFBvaW50KCk7dmFyIGVuZFJhbmdlPXJhbmdlLmNyZWF0ZUZyb21Ob2RlQWZ0ZXIobGlzdC5sYXN0KGFuY2hvcnMpKTt2YXIgZW5kUG9pbnQ9ZW5kUmFuZ2UuZ2V0RW5kUG9pbnQoKTtyYW5nZS5jcmVhdGUoc3RhcnRQb2ludC5ub2RlLHN0YXJ0UG9pbnQub2Zmc2V0LGVuZFBvaW50Lm5vZGUsZW5kUG9pbnQub2Zmc2V0KS5zZWxlY3QoKTt9KTsvKipcbiAgICAgKiByZXR1cm5zIGxpbmsgaW5mb1xuICAgICAqXG4gICAgICogQHJldHVybiB7T2JqZWN0fVxuICAgICAqIEByZXR1cm4ge1dyYXBwZWRSYW5nZX0gcmV0dXJuLnJhbmdlXG4gICAgICogQHJldHVybiB7U3RyaW5nfSByZXR1cm4udGV4dFxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59IFtyZXR1cm4uaXNOZXdXaW5kb3c9dHJ1ZV1cbiAgICAgKiBAcmV0dXJuIHtTdHJpbmd9IFtyZXR1cm4udXJsPVwiXCJdXG4gICAgICovdGhpcy5nZXRMaW5rSW5mbz1mdW5jdGlvbigpe3ZhciBybmc9dGhpcy5jcmVhdGVSYW5nZSgpLmV4cGFuZChkb20uaXNBbmNob3IpOy8vIEdldCB0aGUgZmlyc3QgYW5jaG9yIG9uIHJhbmdlKGZvciBlZGl0KS5cbnZhciAkYW5jaG9yPSQobGlzdC5oZWFkKHJuZy5ub2Rlcyhkb20uaXNBbmNob3IpKSk7cmV0dXJue3JhbmdlOnJuZyx0ZXh0OnJuZy50b1N0cmluZygpLGlzTmV3V2luZG93OiRhbmNob3IubGVuZ3RoPyRhbmNob3IuYXR0cigndGFyZ2V0Jyk9PT0nX2JsYW5rJzpmYWxzZSx1cmw6JGFuY2hvci5sZW5ndGg/JGFuY2hvci5hdHRyKCdocmVmJyk6Jyd9O307LyoqXG4gICAgICogc2V0dGluZyBjb2xvclxuICAgICAqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHNPYmpDb2xvciAgY29sb3IgY29kZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBzT2JqQ29sb3IuZm9yZUNvbG9yIGZvcmVncm91bmQgY29sb3JcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gc09iakNvbG9yLmJhY2tDb2xvciBiYWNrZ3JvdW5kIGNvbG9yXG4gICAgICovdGhpcy5jb2xvcj10aGlzLndyYXBDb21tYW5kKGZ1bmN0aW9uKGNvbG9ySW5mbyl7dmFyIGZvcmVDb2xvcj1jb2xvckluZm8uZm9yZUNvbG9yO3ZhciBiYWNrQ29sb3I9Y29sb3JJbmZvLmJhY2tDb2xvcjtpZihmb3JlQ29sb3Ipe2RvY3VtZW50LmV4ZWNDb21tYW5kKCdmb3JlQ29sb3InLGZhbHNlLGZvcmVDb2xvcik7fWlmKGJhY2tDb2xvcil7ZG9jdW1lbnQuZXhlY0NvbW1hbmQoJ2JhY2tDb2xvcicsZmFsc2UsYmFja0NvbG9yKTt9fSk7LyoqXG4gICAgICogaW5zZXJ0IFRhYmxlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZGltZW5zaW9uIG9mIHRhYmxlIChleCA6IFwiNXg1XCIpXG4gICAgICovdGhpcy5pbnNlcnRUYWJsZT10aGlzLndyYXBDb21tYW5kKGZ1bmN0aW9uKGRpbSl7dmFyIGRpbWVuc2lvbj1kaW0uc3BsaXQoJ3gnKTt2YXIgcm5nPXRoaXMuY3JlYXRlUmFuZ2UoKS5kZWxldGVDb250ZW50cygpO3JuZy5pbnNlcnROb2RlKHRhYmxlLmNyZWF0ZVRhYmxlKGRpbWVuc2lvblswXSxkaW1lbnNpb25bMV0sb3B0aW9ucykpO30pOy8qKlxuICAgICAqIGZsb2F0IG1lXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdmFsdWVcbiAgICAgKi90aGlzLmZsb2F0TWU9dGhpcy53cmFwQ29tbWFuZChmdW5jdGlvbih2YWx1ZSl7dmFyICR0YXJnZXQ9JCh0aGlzLnJlc3RvcmVUYXJnZXQoKSk7JHRhcmdldC5jc3MoJ2Zsb2F0Jyx2YWx1ZSk7fSk7LyoqXG4gICAgICogcmVzaXplIG92ZXJsYXkgZWxlbWVudFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSB2YWx1ZVxuICAgICAqL3RoaXMucmVzaXplPXRoaXMud3JhcENvbW1hbmQoZnVuY3Rpb24odmFsdWUpe3ZhciAkdGFyZ2V0PSQodGhpcy5yZXN0b3JlVGFyZ2V0KCkpOyR0YXJnZXQuY3NzKHt3aWR0aDp2YWx1ZSoxMDArJyUnLGhlaWdodDonJ30pO30pOy8qKlxuICAgICAqIEBwYXJhbSB7UG9zaXRpb259IHBvc1xuICAgICAqIEBwYXJhbSB7alF1ZXJ5fSAkdGFyZ2V0IC0gdGFyZ2V0IGVsZW1lbnRcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtiS2VlcFJhdGlvXSAtIGtlZXAgcmF0aW9cbiAgICAgKi90aGlzLnJlc2l6ZVRvPWZ1bmN0aW9uKHBvcywkdGFyZ2V0LGJLZWVwUmF0aW8pe3ZhciBpbWFnZVNpemU7aWYoYktlZXBSYXRpbyl7dmFyIG5ld1JhdGlvPXBvcy55L3Bvcy54O3ZhciByYXRpbz0kdGFyZ2V0LmRhdGEoJ3JhdGlvJyk7aW1hZ2VTaXplPXt3aWR0aDpyYXRpbz5uZXdSYXRpbz9wb3MueDpwb3MueS9yYXRpbyxoZWlnaHQ6cmF0aW8+bmV3UmF0aW8/cG9zLngqcmF0aW86cG9zLnl9O31lbHNle2ltYWdlU2l6ZT17d2lkdGg6cG9zLngsaGVpZ2h0OnBvcy55fTt9JHRhcmdldC5jc3MoaW1hZ2VTaXplKTt9Oy8qKlxuICAgICAqIHJlbW92ZSBtZWRpYSBvYmplY3RcbiAgICAgKi90aGlzLnJlbW92ZU1lZGlhPXRoaXMud3JhcENvbW1hbmQoZnVuY3Rpb24oKXt2YXIgJHRhcmdldD0kKHRoaXMucmVzdG9yZVRhcmdldCgpKS5kZXRhY2goKTtjb250ZXh0LnRyaWdnZXJFdmVudCgnbWVkaWEuZGVsZXRlJywkdGFyZ2V0LCRlZGl0YWJsZSk7fSk7LyoqXG4gICAgICogcmV0dXJucyB3aGV0aGVyIGVkaXRhYmxlIGFyZWEgaGFzIGZvY3VzIG9yIG5vdC5cbiAgICAgKi90aGlzLmhhc0ZvY3VzPWZ1bmN0aW9uKCl7cmV0dXJuICRlZGl0YWJsZS5pcygnOmZvY3VzJyk7fTsvKipcbiAgICAgKiBzZXQgZm9jdXNcbiAgICAgKi90aGlzLmZvY3VzPWZ1bmN0aW9uKCl7Ly8gW3dvcmthcm91bmRdIFNjcmVlbiB3aWxsIG1vdmUgd2hlbiBwYWdlIGlzIHNjb2xsZWQgaW4gSUUuXG4vLyAgLSBkbyBmb2N1cyB3aGVuIG5vdCBmb2N1c2VkXG5pZighdGhpcy5oYXNGb2N1cygpKXskZWRpdGFibGUuZm9jdXMoKTt9fTsvKipcbiAgICAgKiByZXR1cm5zIHdoZXRoZXIgY29udGVudHMgaXMgZW1wdHkgb3Igbm90LlxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICovdGhpcy5pc0VtcHR5PWZ1bmN0aW9uKCl7cmV0dXJuIGRvbS5pc0VtcHR5KCRlZGl0YWJsZVswXSl8fGRvbS5lbXB0eVBhcmE9PT0kZWRpdGFibGUuaHRtbCgpO307LyoqXG4gICAgICogUmVtb3ZlcyBhbGwgY29udGVudHMgYW5kIHJlc3RvcmVzIHRoZSBlZGl0YWJsZSBpbnN0YW5jZSB0byBhbiBfZW1wdHlQYXJhXy5cbiAgICAgKi90aGlzLmVtcHR5PWZ1bmN0aW9uKCl7Y29udGV4dC5pbnZva2UoJ2NvZGUnLGRvbS5lbXB0eVBhcmEpO307fTt2YXIgQ2xpcGJvYXJkPWZ1bmN0aW9uKGNvbnRleHQpe3ZhciBzZWxmPXRoaXM7dmFyICRlZGl0YWJsZT1jb250ZXh0LmxheW91dEluZm8uZWRpdGFibGU7dGhpcy5ldmVudHM9eydzdW1tZXJub3RlLmtleWRvd24nOmZ1bmN0aW9uKHdlLGUpe2lmKHNlbGYubmVlZEtleWRvd25Ib29rKCkpe2lmKChlLmN0cmxLZXl8fGUubWV0YUtleSkmJmUua2V5Q29kZT09PWtleS5jb2RlLlYpe2NvbnRleHQuaW52b2tlKCdlZGl0b3Iuc2F2ZVJhbmdlJyk7c2VsZi4kcGFzdGUuZm9jdXMoKTtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7c2VsZi5wYXN0ZUJ5SG9vaygpO30sMCk7fX19fTt0aGlzLm5lZWRLZXlkb3duSG9vaz1mdW5jdGlvbigpe3JldHVybiBhZ2VudC5pc01TSUUmJmFnZW50LmJyb3dzZXJWZXJzaW9uPjEwfHxhZ2VudC5pc0ZGO307dGhpcy5pbml0aWFsaXplPWZ1bmN0aW9uKCl7Ly8gW3dvcmthcm91bmRdIGdldHRpbmcgaW1hZ2UgZnJvbSBjbGlwYm9hcmRcbi8vICAtIElFMTEgYW5kIEZpcmVmb3g6IENUUkwrdiBob29rXG4vLyAgLSBXZWJraXQ6IGV2ZW50LmNsaXBib2FyZERhdGFcbmlmKHRoaXMubmVlZEtleWRvd25Ib29rKCkpe3RoaXMuJHBhc3RlPSQoJzxkaXYgdGFiaW5kZXg9XCItMVwiIC8+JykuYXR0cignY29udGVudGVkaXRhYmxlJyx0cnVlKS5jc3Moe3Bvc2l0aW9uOidhYnNvbHV0ZScsbGVmdDotMTAwMDAwLG9wYWNpdHk6MH0pOyRlZGl0YWJsZS5iZWZvcmUodGhpcy4kcGFzdGUpO3RoaXMuJHBhc3RlLm9uKCdwYXN0ZScsZnVuY3Rpb24oZXZlbnQpe2NvbnRleHQudHJpZ2dlckV2ZW50KCdwYXN0ZScsZXZlbnQpO30pO31lbHNleyRlZGl0YWJsZS5vbigncGFzdGUnLHRoaXMucGFzdGVCeUV2ZW50KTt9fTt0aGlzLmRlc3Ryb3k9ZnVuY3Rpb24oKXtpZih0aGlzLm5lZWRLZXlkb3duSG9vaygpKXt0aGlzLiRwYXN0ZS5yZW1vdmUoKTt0aGlzLiRwYXN0ZT1udWxsO319O3RoaXMucGFzdGVCeUhvb2s9ZnVuY3Rpb24oKXt2YXIgbm9kZT10aGlzLiRwYXN0ZVswXS5maXJzdENoaWxkO2lmKGRvbS5pc0ltZyhub2RlKSl7dmFyIGRhdGFVUkk9bm9kZS5zcmM7dmFyIGRlY29kZWREYXRhPWF0b2IoZGF0YVVSSS5zcGxpdCgnLCcpWzFdKTt2YXIgYXJyYXk9bmV3IFVpbnQ4QXJyYXkoZGVjb2RlZERhdGEubGVuZ3RoKTtmb3IodmFyIGk9MDtpPGRlY29kZWREYXRhLmxlbmd0aDtpKyspe2FycmF5W2ldPWRlY29kZWREYXRhLmNoYXJDb2RlQXQoaSk7fXZhciBibG9iPW5ldyBCbG9iKFthcnJheV0se3R5cGU6J2ltYWdlL3BuZyd9KTtibG9iLm5hbWU9J2NsaXBib2FyZC5wbmcnO2NvbnRleHQuaW52b2tlKCdlZGl0b3IucmVzdG9yZVJhbmdlJyk7Y29udGV4dC5pbnZva2UoJ2VkaXRvci5mb2N1cycpO2NvbnRleHQuaW52b2tlKCdlZGl0b3IuaW5zZXJ0SW1hZ2VzT3JDYWxsYmFjaycsW2Jsb2JdKTt9ZWxzZXt2YXIgcGFzdGVDb250ZW50PSQoJzxkaXYgLz4nKS5odG1sKHRoaXMuJHBhc3RlLmh0bWwoKSkuaHRtbCgpO2NvbnRleHQuaW52b2tlKCdlZGl0b3IucmVzdG9yZVJhbmdlJyk7Y29udGV4dC5pbnZva2UoJ2VkaXRvci5mb2N1cycpO2lmKHBhc3RlQ29udGVudCl7Y29udGV4dC5pbnZva2UoJ2VkaXRvci5wYXN0ZUhUTUwnLHBhc3RlQ29udGVudCk7fX10aGlzLiRwYXN0ZS5lbXB0eSgpO307LyoqXG4gICAgICogcGFzdGUgYnkgY2xpcGJvYXJkIGV2ZW50XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudFxuICAgICAqL3RoaXMucGFzdGVCeUV2ZW50PWZ1bmN0aW9uKGV2ZW50KXt2YXIgY2xpcGJvYXJkRGF0YT1ldmVudC5vcmlnaW5hbEV2ZW50LmNsaXBib2FyZERhdGE7aWYoY2xpcGJvYXJkRGF0YSYmY2xpcGJvYXJkRGF0YS5pdGVtcyYmY2xpcGJvYXJkRGF0YS5pdGVtcy5sZW5ndGgpe3ZhciBpdGVtPWxpc3QuaGVhZChjbGlwYm9hcmREYXRhLml0ZW1zKTtpZihpdGVtLmtpbmQ9PT0nZmlsZScmJml0ZW0udHlwZS5pbmRleE9mKCdpbWFnZS8nKSE9PS0xKXtjb250ZXh0Lmludm9rZSgnZWRpdG9yLmluc2VydEltYWdlc09yQ2FsbGJhY2snLFtpdGVtLmdldEFzRmlsZSgpXSk7fWNvbnRleHQuaW52b2tlKCdlZGl0b3IuYWZ0ZXJDb21tYW5kJyk7fX07fTt2YXIgRHJvcHpvbmU9ZnVuY3Rpb24oY29udGV4dCl7dmFyICRkb2N1bWVudD0kKGRvY3VtZW50KTt2YXIgJGVkaXRvcj1jb250ZXh0LmxheW91dEluZm8uZWRpdG9yO3ZhciAkZWRpdGFibGU9Y29udGV4dC5sYXlvdXRJbmZvLmVkaXRhYmxlO3ZhciBvcHRpb25zPWNvbnRleHQub3B0aW9uczt2YXIgbGFuZz1vcHRpb25zLmxhbmdJbmZvO3ZhciBkb2N1bWVudEV2ZW50SGFuZGxlcnM9e307dmFyICRkcm9wem9uZT0kKFsnPGRpdiBjbGFzcz1cIm5vdGUtZHJvcHpvbmVcIj4nLCcgIDxkaXYgY2xhc3M9XCJub3RlLWRyb3B6b25lLW1lc3NhZ2VcIi8+JywnPC9kaXY+J10uam9pbignJykpLnByZXBlbmRUbygkZWRpdG9yKTt2YXIgZGV0YWNoRG9jdW1lbnRFdmVudD1mdW5jdGlvbigpe09iamVjdC5rZXlzKGRvY3VtZW50RXZlbnRIYW5kbGVycykuZm9yRWFjaChmdW5jdGlvbihrZXkpeyRkb2N1bWVudC5vZmYoa2V5LnN1YnN0cigyKS50b0xvd2VyQ2FzZSgpLGRvY3VtZW50RXZlbnRIYW5kbGVyc1trZXldKTt9KTtkb2N1bWVudEV2ZW50SGFuZGxlcnM9e307fTsvKipcbiAgICAgKiBhdHRhY2ggRHJhZyBhbmQgRHJvcCBFdmVudHNcbiAgICAgKi90aGlzLmluaXRpYWxpemU9ZnVuY3Rpb24oKXtpZihvcHRpb25zLmRpc2FibGVEcmFnQW5kRHJvcCl7Ly8gcHJldmVudCBkZWZhdWx0IGRyb3AgZXZlbnRcbmRvY3VtZW50RXZlbnRIYW5kbGVycy5vbkRyb3A9ZnVuY3Rpb24oZSl7ZS5wcmV2ZW50RGVmYXVsdCgpO307JGRvY3VtZW50Lm9uKCdkcm9wJyxkb2N1bWVudEV2ZW50SGFuZGxlcnMub25Ecm9wKTt9ZWxzZXt0aGlzLmF0dGFjaERyYWdBbmREcm9wRXZlbnQoKTt9fTsvKipcbiAgICAgKiBhdHRhY2ggRHJhZyBhbmQgRHJvcCBFdmVudHNcbiAgICAgKi90aGlzLmF0dGFjaERyYWdBbmREcm9wRXZlbnQ9ZnVuY3Rpb24oKXt2YXIgY29sbGVjdGlvbj0kKCksJGRyb3B6b25lTWVzc2FnZT0kZHJvcHpvbmUuZmluZCgnLm5vdGUtZHJvcHpvbmUtbWVzc2FnZScpO2RvY3VtZW50RXZlbnRIYW5kbGVycy5vbkRyYWdlbnRlcj1mdW5jdGlvbihlKXt2YXIgaXNDb2Rldmlldz1jb250ZXh0Lmludm9rZSgnY29kZXZpZXcuaXNBY3RpdmF0ZWQnKTt2YXIgaGFzRWRpdG9yU2l6ZT0kZWRpdG9yLndpZHRoKCk+MCYmJGVkaXRvci5oZWlnaHQoKT4wO2lmKCFpc0NvZGV2aWV3JiYhY29sbGVjdGlvbi5sZW5ndGgmJmhhc0VkaXRvclNpemUpeyRlZGl0b3IuYWRkQ2xhc3MoJ2RyYWdvdmVyJyk7JGRyb3B6b25lLndpZHRoKCRlZGl0b3Iud2lkdGgoKSk7JGRyb3B6b25lLmhlaWdodCgkZWRpdG9yLmhlaWdodCgpKTskZHJvcHpvbmVNZXNzYWdlLnRleHQobGFuZy5pbWFnZS5kcmFnSW1hZ2VIZXJlKTt9Y29sbGVjdGlvbj1jb2xsZWN0aW9uLmFkZChlLnRhcmdldCk7fTtkb2N1bWVudEV2ZW50SGFuZGxlcnMub25EcmFnbGVhdmU9ZnVuY3Rpb24oZSl7Y29sbGVjdGlvbj1jb2xsZWN0aW9uLm5vdChlLnRhcmdldCk7aWYoIWNvbGxlY3Rpb24ubGVuZ3RoKXskZWRpdG9yLnJlbW92ZUNsYXNzKCdkcmFnb3ZlcicpO319O2RvY3VtZW50RXZlbnRIYW5kbGVycy5vbkRyb3A9ZnVuY3Rpb24oKXtjb2xsZWN0aW9uPSQoKTskZWRpdG9yLnJlbW92ZUNsYXNzKCdkcmFnb3ZlcicpO307Ly8gc2hvdyBkcm9wem9uZSBvbiBkcmFnZW50ZXIgd2hlbiBkcmFnZ2luZyBhIG9iamVjdCB0byBkb2N1bWVudFxuLy8gLWJ1dCBvbmx5IGlmIHRoZSBlZGl0b3IgaXMgdmlzaWJsZSwgaS5lLiBoYXMgYSBwb3NpdGl2ZSB3aWR0aCBhbmQgaGVpZ2h0XG4kZG9jdW1lbnQub24oJ2RyYWdlbnRlcicsZG9jdW1lbnRFdmVudEhhbmRsZXJzLm9uRHJhZ2VudGVyKS5vbignZHJhZ2xlYXZlJyxkb2N1bWVudEV2ZW50SGFuZGxlcnMub25EcmFnbGVhdmUpLm9uKCdkcm9wJyxkb2N1bWVudEV2ZW50SGFuZGxlcnMub25Ecm9wKTsvLyBjaGFuZ2UgZHJvcHpvbmUncyBtZXNzYWdlIG9uIGhvdmVyLlxuJGRyb3B6b25lLm9uKCdkcmFnZW50ZXInLGZ1bmN0aW9uKCl7JGRyb3B6b25lLmFkZENsYXNzKCdob3ZlcicpOyRkcm9wem9uZU1lc3NhZ2UudGV4dChsYW5nLmltYWdlLmRyb3BJbWFnZSk7fSkub24oJ2RyYWdsZWF2ZScsZnVuY3Rpb24oKXskZHJvcHpvbmUucmVtb3ZlQ2xhc3MoJ2hvdmVyJyk7JGRyb3B6b25lTWVzc2FnZS50ZXh0KGxhbmcuaW1hZ2UuZHJhZ0ltYWdlSGVyZSk7fSk7Ly8gYXR0YWNoIGRyb3BJbWFnZVxuJGRyb3B6b25lLm9uKCdkcm9wJyxmdW5jdGlvbihldmVudCl7dmFyIGRhdGFUcmFuc2Zlcj1ldmVudC5vcmlnaW5hbEV2ZW50LmRhdGFUcmFuc2ZlcjtpZihkYXRhVHJhbnNmZXImJmRhdGFUcmFuc2Zlci5maWxlcyYmZGF0YVRyYW5zZmVyLmZpbGVzLmxlbmd0aCl7ZXZlbnQucHJldmVudERlZmF1bHQoKTskZWRpdGFibGUuZm9jdXMoKTtjb250ZXh0Lmludm9rZSgnZWRpdG9yLmluc2VydEltYWdlc09yQ2FsbGJhY2snLGRhdGFUcmFuc2Zlci5maWxlcyk7fWVsc2V7JC5lYWNoKGRhdGFUcmFuc2Zlci50eXBlcyxmdW5jdGlvbihpZHgsdHlwZSl7dmFyIGNvbnRlbnQ9ZGF0YVRyYW5zZmVyLmdldERhdGEodHlwZSk7aWYodHlwZS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoJ3RleHQnKT4tMSl7Y29udGV4dC5pbnZva2UoJ2VkaXRvci5wYXN0ZUhUTUwnLGNvbnRlbnQpO31lbHNleyQoY29udGVudCkuZWFjaChmdW5jdGlvbigpe2NvbnRleHQuaW52b2tlKCdlZGl0b3IuaW5zZXJ0Tm9kZScsdGhpcyk7fSk7fX0pO319KS5vbignZHJhZ292ZXInLGZhbHNlKTsvLyBwcmV2ZW50IGRlZmF1bHQgZHJhZ292ZXIgZXZlbnRcbn07dGhpcy5kZXN0cm95PWZ1bmN0aW9uKCl7ZGV0YWNoRG9jdW1lbnRFdmVudCgpO307fTt2YXIgQ29kZU1pcnJvcjtpZihhZ2VudC5oYXNDb2RlTWlycm9yKXtpZihhZ2VudC5pc1N1cHBvcnRBbWQpe3JlcXVpcmUoWydjb2RlbWlycm9yJ10sZnVuY3Rpb24oY20pe0NvZGVNaXJyb3I9Y207fSk7fWVsc2V7Q29kZU1pcnJvcj13aW5kb3cuQ29kZU1pcnJvcjt9fS8qKlxuICAgKiBAY2xhc3MgQ29kZXZpZXdcbiAgICovdmFyIENvZGV2aWV3PWZ1bmN0aW9uKGNvbnRleHQpe3ZhciAkZWRpdG9yPWNvbnRleHQubGF5b3V0SW5mby5lZGl0b3I7dmFyICRlZGl0YWJsZT1jb250ZXh0LmxheW91dEluZm8uZWRpdGFibGU7dmFyICRjb2RhYmxlPWNvbnRleHQubGF5b3V0SW5mby5jb2RhYmxlO3ZhciBvcHRpb25zPWNvbnRleHQub3B0aW9uczt0aGlzLnN5bmM9ZnVuY3Rpb24oKXt2YXIgaXNDb2Rldmlldz10aGlzLmlzQWN0aXZhdGVkKCk7aWYoaXNDb2RldmlldyYmYWdlbnQuaGFzQ29kZU1pcnJvcil7JGNvZGFibGUuZGF0YSgnY21FZGl0b3InKS5zYXZlKCk7fX07LyoqXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn1cbiAgICAgKi90aGlzLmlzQWN0aXZhdGVkPWZ1bmN0aW9uKCl7cmV0dXJuICRlZGl0b3IuaGFzQ2xhc3MoJ2NvZGV2aWV3Jyk7fTsvKipcbiAgICAgKiB0b2dnbGUgY29kZXZpZXdcbiAgICAgKi90aGlzLnRvZ2dsZT1mdW5jdGlvbigpe2lmKHRoaXMuaXNBY3RpdmF0ZWQoKSl7dGhpcy5kZWFjdGl2YXRlKCk7fWVsc2V7dGhpcy5hY3RpdmF0ZSgpO31jb250ZXh0LnRyaWdnZXJFdmVudCgnY29kZXZpZXcudG9nZ2xlZCcpO307LyoqXG4gICAgICogYWN0aXZhdGUgY29kZSB2aWV3XG4gICAgICovdGhpcy5hY3RpdmF0ZT1mdW5jdGlvbigpeyRjb2RhYmxlLnZhbChkb20uaHRtbCgkZWRpdGFibGUsb3B0aW9ucy5wcmV0dGlmeUh0bWwpKTskY29kYWJsZS5oZWlnaHQoJGVkaXRhYmxlLmhlaWdodCgpKTtjb250ZXh0Lmludm9rZSgndG9vbGJhci51cGRhdGVDb2RldmlldycsdHJ1ZSk7JGVkaXRvci5hZGRDbGFzcygnY29kZXZpZXcnKTskY29kYWJsZS5mb2N1cygpOy8vIGFjdGl2YXRlIENvZGVNaXJyb3IgYXMgY29kYWJsZVxuaWYoYWdlbnQuaGFzQ29kZU1pcnJvcil7dmFyIGNtRWRpdG9yPUNvZGVNaXJyb3IuZnJvbVRleHRBcmVhKCRjb2RhYmxlWzBdLG9wdGlvbnMuY29kZW1pcnJvcik7Ly8gQ29kZU1pcnJvciBUZXJuU2VydmVyXG5pZihvcHRpb25zLmNvZGVtaXJyb3IudGVybil7dmFyIHNlcnZlcj1uZXcgQ29kZU1pcnJvci5UZXJuU2VydmVyKG9wdGlvbnMuY29kZW1pcnJvci50ZXJuKTtjbUVkaXRvci50ZXJuU2VydmVyPXNlcnZlcjtjbUVkaXRvci5vbignY3Vyc29yQWN0aXZpdHknLGZ1bmN0aW9uKGNtKXtzZXJ2ZXIudXBkYXRlQXJnSGludHMoY20pO30pO30vLyBDb2RlTWlycm9yIGhhc24ndCBQYWRkaW5nLlxuY21FZGl0b3Iuc2V0U2l6ZShudWxsLCRlZGl0YWJsZS5vdXRlckhlaWdodCgpKTskY29kYWJsZS5kYXRhKCdjbUVkaXRvcicsY21FZGl0b3IpO319Oy8qKlxuICAgICAqIGRlYWN0aXZhdGUgY29kZSB2aWV3XG4gICAgICovdGhpcy5kZWFjdGl2YXRlPWZ1bmN0aW9uKCl7Ly8gZGVhY3RpdmF0ZSBDb2RlTWlycm9yIGFzIGNvZGFibGVcbmlmKGFnZW50Lmhhc0NvZGVNaXJyb3Ipe3ZhciBjbUVkaXRvcj0kY29kYWJsZS5kYXRhKCdjbUVkaXRvcicpOyRjb2RhYmxlLnZhbChjbUVkaXRvci5nZXRWYWx1ZSgpKTtjbUVkaXRvci50b1RleHRBcmVhKCk7fXZhciB2YWx1ZT1kb20udmFsdWUoJGNvZGFibGUsb3B0aW9ucy5wcmV0dGlmeUh0bWwpfHxkb20uZW1wdHlQYXJhO3ZhciBpc0NoYW5nZT0kZWRpdGFibGUuaHRtbCgpIT09dmFsdWU7JGVkaXRhYmxlLmh0bWwodmFsdWUpOyRlZGl0YWJsZS5oZWlnaHQob3B0aW9ucy5oZWlnaHQ/JGNvZGFibGUuaGVpZ2h0KCk6J2F1dG8nKTskZWRpdG9yLnJlbW92ZUNsYXNzKCdjb2RldmlldycpO2lmKGlzQ2hhbmdlKXtjb250ZXh0LnRyaWdnZXJFdmVudCgnY2hhbmdlJywkZWRpdGFibGUuaHRtbCgpLCRlZGl0YWJsZSk7fSRlZGl0YWJsZS5mb2N1cygpO2NvbnRleHQuaW52b2tlKCd0b29sYmFyLnVwZGF0ZUNvZGV2aWV3JyxmYWxzZSk7fTt0aGlzLmRlc3Ryb3k9ZnVuY3Rpb24oKXtpZih0aGlzLmlzQWN0aXZhdGVkKCkpe3RoaXMuZGVhY3RpdmF0ZSgpO319O307dmFyIEVESVRBQkxFX1BBRERJTkc9MjQ7dmFyIFN0YXR1c2Jhcj1mdW5jdGlvbihjb250ZXh0KXt2YXIgJGRvY3VtZW50PSQoZG9jdW1lbnQpO3ZhciAkc3RhdHVzYmFyPWNvbnRleHQubGF5b3V0SW5mby5zdGF0dXNiYXI7dmFyICRlZGl0YWJsZT1jb250ZXh0LmxheW91dEluZm8uZWRpdGFibGU7dmFyIG9wdGlvbnM9Y29udGV4dC5vcHRpb25zO3RoaXMuaW5pdGlhbGl6ZT1mdW5jdGlvbigpe2lmKG9wdGlvbnMuYWlyTW9kZXx8b3B0aW9ucy5kaXNhYmxlUmVzaXplRWRpdG9yKXtyZXR1cm47fSRzdGF0dXNiYXIub24oJ21vdXNlZG93bicsZnVuY3Rpb24oZXZlbnQpe2V2ZW50LnByZXZlbnREZWZhdWx0KCk7ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7dmFyIGVkaXRhYmxlVG9wPSRlZGl0YWJsZS5vZmZzZXQoKS50b3AtJGRvY3VtZW50LnNjcm9sbFRvcCgpOyRkb2N1bWVudC5vbignbW91c2Vtb3ZlJyxmdW5jdGlvbihldmVudCl7dmFyIGhlaWdodD1ldmVudC5jbGllbnRZLShlZGl0YWJsZVRvcCtFRElUQUJMRV9QQURESU5HKTtoZWlnaHQ9b3B0aW9ucy5taW5oZWlnaHQ+MD9NYXRoLm1heChoZWlnaHQsb3B0aW9ucy5taW5oZWlnaHQpOmhlaWdodDtoZWlnaHQ9b3B0aW9ucy5tYXhIZWlnaHQ+MD9NYXRoLm1pbihoZWlnaHQsb3B0aW9ucy5tYXhIZWlnaHQpOmhlaWdodDskZWRpdGFibGUuaGVpZ2h0KGhlaWdodCk7fSkub25lKCdtb3VzZXVwJyxmdW5jdGlvbigpeyRkb2N1bWVudC5vZmYoJ21vdXNlbW92ZScpO30pO30pO307dGhpcy5kZXN0cm95PWZ1bmN0aW9uKCl7JHN0YXR1c2Jhci5vZmYoKTskc3RhdHVzYmFyLnJlbW92ZSgpO307fTt2YXIgRnVsbHNjcmVlbj1mdW5jdGlvbihjb250ZXh0KXt2YXIgJGVkaXRvcj1jb250ZXh0LmxheW91dEluZm8uZWRpdG9yO3ZhciAkdG9vbGJhcj1jb250ZXh0LmxheW91dEluZm8udG9vbGJhcjt2YXIgJGVkaXRhYmxlPWNvbnRleHQubGF5b3V0SW5mby5lZGl0YWJsZTt2YXIgJGNvZGFibGU9Y29udGV4dC5sYXlvdXRJbmZvLmNvZGFibGU7dmFyICR3aW5kb3c9JCh3aW5kb3cpO3ZhciAkc2Nyb2xsYmFyPSQoJ2h0bWwsIGJvZHknKTsvKipcbiAgICAgKiB0b2dnbGUgZnVsbHNjcmVlblxuICAgICAqL3RoaXMudG9nZ2xlPWZ1bmN0aW9uKCl7dmFyIHJlc2l6ZT1mdW5jdGlvbihzaXplKXskZWRpdGFibGUuY3NzKCdoZWlnaHQnLHNpemUuaCk7JGNvZGFibGUuY3NzKCdoZWlnaHQnLHNpemUuaCk7aWYoJGNvZGFibGUuZGF0YSgnY21lZGl0b3InKSl7JGNvZGFibGUuZGF0YSgnY21lZGl0b3InKS5zZXRzaXplKG51bGwsc2l6ZS5oKTt9fTskZWRpdG9yLnRvZ2dsZUNsYXNzKCdmdWxsc2NyZWVuJyk7aWYodGhpcy5pc0Z1bGxzY3JlZW4oKSl7JGVkaXRhYmxlLmRhdGEoJ29yZ0hlaWdodCcsJGVkaXRhYmxlLmNzcygnaGVpZ2h0JykpOyR3aW5kb3cub24oJ3Jlc2l6ZScsZnVuY3Rpb24oKXtyZXNpemUoe2g6JHdpbmRvdy5oZWlnaHQoKS0kdG9vbGJhci5vdXRlckhlaWdodCgpfSk7fSkudHJpZ2dlcigncmVzaXplJyk7JHNjcm9sbGJhci5jc3MoJ292ZXJmbG93JywnaGlkZGVuJyk7fWVsc2V7JHdpbmRvdy5vZmYoJ3Jlc2l6ZScpO3Jlc2l6ZSh7aDokZWRpdGFibGUuZGF0YSgnb3JnSGVpZ2h0Jyl9KTskc2Nyb2xsYmFyLmNzcygnb3ZlcmZsb3cnLCd2aXNpYmxlJyk7fWNvbnRleHQuaW52b2tlKCd0b29sYmFyLnVwZGF0ZUZ1bGxzY3JlZW4nLHRoaXMuaXNGdWxsc2NyZWVuKCkpO307dGhpcy5pc0Z1bGxzY3JlZW49ZnVuY3Rpb24oKXtyZXR1cm4gJGVkaXRvci5oYXNDbGFzcygnZnVsbHNjcmVlbicpO307fTt2YXIgSGFuZGxlPWZ1bmN0aW9uKGNvbnRleHQpe3ZhciBzZWxmPXRoaXM7dmFyICRkb2N1bWVudD0kKGRvY3VtZW50KTt2YXIgJGVkaXRpbmdBcmVhPWNvbnRleHQubGF5b3V0SW5mby5lZGl0aW5nQXJlYTt2YXIgb3B0aW9ucz1jb250ZXh0Lm9wdGlvbnM7dGhpcy5ldmVudHM9eydzdW1tZXJub3RlLm1vdXNlZG93bic6ZnVuY3Rpb24od2UsZSl7aWYoc2VsZi51cGRhdGUoZS50YXJnZXQpKXtlLnByZXZlbnREZWZhdWx0KCk7fX0sJ3N1bW1lcm5vdGUua2V5dXAgc3VtbWVybm90ZS5zY3JvbGwgc3VtbWVybm90ZS5jaGFuZ2Ugc3VtbWVybm90ZS5kaWFsb2cuc2hvd24nOmZ1bmN0aW9uKCl7c2VsZi51cGRhdGUoKTt9fTt0aGlzLmluaXRpYWxpemU9ZnVuY3Rpb24oKXt0aGlzLiRoYW5kbGU9JChbJzxkaXYgY2xhc3M9XCJub3RlLWhhbmRsZVwiPicsJzxkaXYgY2xhc3M9XCJub3RlLWNvbnRyb2wtc2VsZWN0aW9uXCI+JywnPGRpdiBjbGFzcz1cIm5vdGUtY29udHJvbC1zZWxlY3Rpb24tYmdcIj48L2Rpdj4nLCc8ZGl2IGNsYXNzPVwibm90ZS1jb250cm9sLWhvbGRlciBub3RlLWNvbnRyb2wtbndcIj48L2Rpdj4nLCc8ZGl2IGNsYXNzPVwibm90ZS1jb250cm9sLWhvbGRlciBub3RlLWNvbnRyb2wtbmVcIj48L2Rpdj4nLCc8ZGl2IGNsYXNzPVwibm90ZS1jb250cm9sLWhvbGRlciBub3RlLWNvbnRyb2wtc3dcIj48L2Rpdj4nLCc8ZGl2IGNsYXNzPVwiJyxvcHRpb25zLmRpc2FibGVSZXNpemVJbWFnZT8nbm90ZS1jb250cm9sLWhvbGRlcic6J25vdGUtY29udHJvbC1zaXppbmcnLCcgbm90ZS1jb250cm9sLXNlXCI+PC9kaXY+JyxvcHRpb25zLmRpc2FibGVSZXNpemVJbWFnZT8nJzonPGRpdiBjbGFzcz1cIm5vdGUtY29udHJvbC1zZWxlY3Rpb24taW5mb1wiPjwvZGl2PicsJzwvZGl2PicsJzwvZGl2PiddLmpvaW4oJycpKS5wcmVwZW5kVG8oJGVkaXRpbmdBcmVhKTt0aGlzLiRoYW5kbGUub24oJ21vdXNlZG93bicsZnVuY3Rpb24oZXZlbnQpe2lmKGRvbS5pc0NvbnRyb2xTaXppbmcoZXZlbnQudGFyZ2V0KSl7ZXZlbnQucHJldmVudERlZmF1bHQoKTtldmVudC5zdG9wUHJvcGFnYXRpb24oKTt2YXIgJHRhcmdldD1zZWxmLiRoYW5kbGUuZmluZCgnLm5vdGUtY29udHJvbC1zZWxlY3Rpb24nKS5kYXRhKCd0YXJnZXQnKSxwb3NTdGFydD0kdGFyZ2V0Lm9mZnNldCgpLHNjcm9sbFRvcD0kZG9jdW1lbnQuc2Nyb2xsVG9wKCk7JGRvY3VtZW50Lm9uKCdtb3VzZW1vdmUnLGZ1bmN0aW9uKGV2ZW50KXtjb250ZXh0Lmludm9rZSgnZWRpdG9yLnJlc2l6ZVRvJyx7eDpldmVudC5jbGllbnRYLXBvc1N0YXJ0LmxlZnQseTpldmVudC5jbGllbnRZLShwb3NTdGFydC50b3Atc2Nyb2xsVG9wKX0sJHRhcmdldCwhZXZlbnQuc2hpZnRLZXkpO3NlbGYudXBkYXRlKCR0YXJnZXRbMF0pO30pLm9uZSgnbW91c2V1cCcsZnVuY3Rpb24oZSl7ZS5wcmV2ZW50RGVmYXVsdCgpOyRkb2N1bWVudC5vZmYoJ21vdXNlbW92ZScpO2NvbnRleHQuaW52b2tlKCdlZGl0b3IuYWZ0ZXJDb21tYW5kJyk7fSk7aWYoISR0YXJnZXQuZGF0YSgncmF0aW8nKSl7Ly8gb3JpZ2luYWwgcmF0aW8uXG4kdGFyZ2V0LmRhdGEoJ3JhdGlvJywkdGFyZ2V0LmhlaWdodCgpLyR0YXJnZXQud2lkdGgoKSk7fX19KTt9O3RoaXMuZGVzdHJveT1mdW5jdGlvbigpe3RoaXMuJGhhbmRsZS5yZW1vdmUoKTt9O3RoaXMudXBkYXRlPWZ1bmN0aW9uKHRhcmdldCl7dmFyIGlzSW1hZ2U9ZG9tLmlzSW1nKHRhcmdldCk7dmFyICRzZWxlY3Rpb249dGhpcy4kaGFuZGxlLmZpbmQoJy5ub3RlLWNvbnRyb2wtc2VsZWN0aW9uJyk7Y29udGV4dC5pbnZva2UoJ2ltYWdlUG9wb3Zlci51cGRhdGUnLHRhcmdldCk7aWYoaXNJbWFnZSl7dmFyICRpbWFnZT0kKHRhcmdldCk7dmFyIHBvcz0kaW1hZ2UucG9zaXRpb24oKTsvLyBpbmNsdWRlIG1hcmdpblxudmFyIGltYWdlU2l6ZT17dzokaW1hZ2Uub3V0ZXJXaWR0aCh0cnVlKSxoOiRpbWFnZS5vdXRlckhlaWdodCh0cnVlKX07JHNlbGVjdGlvbi5jc3Moe2Rpc3BsYXk6J2Jsb2NrJyxsZWZ0OnBvcy5sZWZ0LHRvcDpwb3MudG9wLHdpZHRoOmltYWdlU2l6ZS53LGhlaWdodDppbWFnZVNpemUuaH0pLmRhdGEoJ3RhcmdldCcsJGltYWdlKTsvLyBzYXZlIGN1cnJlbnQgaW1hZ2UgZWxlbWVudC5cbnZhciBzaXppbmdUZXh0PWltYWdlU2l6ZS53Kyd4JytpbWFnZVNpemUuaDskc2VsZWN0aW9uLmZpbmQoJy5ub3RlLWNvbnRyb2wtc2VsZWN0aW9uLWluZm8nKS50ZXh0KHNpemluZ1RleHQpO2NvbnRleHQuaW52b2tlKCdlZGl0b3Iuc2F2ZVRhcmdldCcsdGFyZ2V0KTt9ZWxzZXt0aGlzLmhpZGUoKTt9cmV0dXJuIGlzSW1hZ2U7fTsvKipcbiAgICAgKiBoaWRlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2pRdWVyeX0gJGhhbmRsZVxuICAgICAqL3RoaXMuaGlkZT1mdW5jdGlvbigpe2NvbnRleHQuaW52b2tlKCdlZGl0b3IuY2xlYXJUYXJnZXQnKTt0aGlzLiRoYW5kbGUuY2hpbGRyZW4oKS5oaWRlKCk7fTt9O3ZhciBBdXRvTGluaz1mdW5jdGlvbihjb250ZXh0KXt2YXIgc2VsZj10aGlzO3ZhciBkZWZhdWx0U2NoZW1lPSdodHRwOi8vJzt2YXIgbGlua1BhdHRlcm49L14oW0EtWmEtel1bQS1aYS16MC05Ky0uXSpcXDpbXFwvXFwvXT98bWFpbHRvOltBLVowLTkuXyUrLV0rQCk/KHd3d1xcLik/KC4rKSQvaTt0aGlzLmV2ZW50cz17J3N1bW1lcm5vdGUua2V5dXAnOmZ1bmN0aW9uKHdlLGUpe2lmKCFlLmlzRGVmYXVsdFByZXZlbnRlZCgpKXtzZWxmLmhhbmRsZUtleXVwKGUpO319LCdzdW1tZXJub3RlLmtleWRvd24nOmZ1bmN0aW9uKHdlLGUpe3NlbGYuaGFuZGxlS2V5ZG93bihlKTt9fTt0aGlzLmluaXRpYWxpemU9ZnVuY3Rpb24oKXt0aGlzLmxhc3RXb3JkUmFuZ2U9bnVsbDt9O3RoaXMuZGVzdHJveT1mdW5jdGlvbigpe3RoaXMubGFzdFdvcmRSYW5nZT1udWxsO307dGhpcy5yZXBsYWNlPWZ1bmN0aW9uKCl7aWYoIXRoaXMubGFzdFdvcmRSYW5nZSl7cmV0dXJuO312YXIga2V5d29yZD10aGlzLmxhc3RXb3JkUmFuZ2UudG9TdHJpbmcoKTt2YXIgbWF0Y2g9a2V5d29yZC5tYXRjaChsaW5rUGF0dGVybik7aWYobWF0Y2gmJihtYXRjaFsxXXx8bWF0Y2hbMl0pKXt2YXIgbGluaz1tYXRjaFsxXT9rZXl3b3JkOmRlZmF1bHRTY2hlbWUra2V5d29yZDt2YXIgbm9kZT0kKCc8YSAvPicpLmh0bWwoa2V5d29yZCkuYXR0cignaHJlZicsbGluaylbMF07dGhpcy5sYXN0V29yZFJhbmdlLmluc2VydE5vZGUobm9kZSk7dGhpcy5sYXN0V29yZFJhbmdlPW51bGw7Y29udGV4dC5pbnZva2UoJ2VkaXRvci5mb2N1cycpO319O3RoaXMuaGFuZGxlS2V5ZG93bj1mdW5jdGlvbihlKXtpZihsaXN0LmNvbnRhaW5zKFtrZXkuY29kZS5FTlRFUixrZXkuY29kZS5TUEFDRV0sZS5rZXlDb2RlKSl7dmFyIHdvcmRSYW5nZT1jb250ZXh0Lmludm9rZSgnZWRpdG9yLmNyZWF0ZVJhbmdlJykuZ2V0V29yZFJhbmdlKCk7dGhpcy5sYXN0V29yZFJhbmdlPXdvcmRSYW5nZTt9fTt0aGlzLmhhbmRsZUtleXVwPWZ1bmN0aW9uKGUpe2lmKGxpc3QuY29udGFpbnMoW2tleS5jb2RlLkVOVEVSLGtleS5jb2RlLlNQQUNFXSxlLmtleUNvZGUpKXt0aGlzLnJlcGxhY2UoKTt9fTt9Oy8qKlxuICAgKiB0ZXh0YXJlYSBhdXRvIHN5bmMuXG4gICAqL3ZhciBBdXRvU3luYz1mdW5jdGlvbihjb250ZXh0KXt2YXIgJG5vdGU9Y29udGV4dC5sYXlvdXRJbmZvLm5vdGU7dGhpcy5ldmVudHM9eydzdW1tZXJub3RlLmNoYW5nZSc6ZnVuY3Rpb24oKXskbm90ZS52YWwoY29udGV4dC5pbnZva2UoJ2NvZGUnKSk7fX07dGhpcy5zaG91bGRJbml0aWFsaXplPWZ1bmN0aW9uKCl7cmV0dXJuIGRvbS5pc1RleHRhcmVhKCRub3RlWzBdKTt9O307dmFyIFBsYWNlaG9sZGVyPWZ1bmN0aW9uKGNvbnRleHQpe3ZhciBzZWxmPXRoaXM7dmFyICRlZGl0aW5nQXJlYT1jb250ZXh0LmxheW91dEluZm8uZWRpdGluZ0FyZWE7dmFyIG9wdGlvbnM9Y29udGV4dC5vcHRpb25zO3RoaXMuZXZlbnRzPXsnc3VtbWVybm90ZS5pbml0IHN1bW1lcm5vdGUuY2hhbmdlJzpmdW5jdGlvbigpe3NlbGYudXBkYXRlKCk7fSwnc3VtbWVybm90ZS5jb2Rldmlldy50b2dnbGVkJzpmdW5jdGlvbigpe3NlbGYudXBkYXRlKCk7fX07dGhpcy5zaG91bGRJbml0aWFsaXplPWZ1bmN0aW9uKCl7cmV0dXJuISFvcHRpb25zLnBsYWNlaG9sZGVyO307dGhpcy5pbml0aWFsaXplPWZ1bmN0aW9uKCl7dGhpcy4kcGxhY2Vob2xkZXI9JCgnPGRpdiBjbGFzcz1cIm5vdGUtcGxhY2Vob2xkZXJcIj4nKTt0aGlzLiRwbGFjZWhvbGRlci5vbignY2xpY2snLGZ1bmN0aW9uKCl7Y29udGV4dC5pbnZva2UoJ2ZvY3VzJyk7fSkudGV4dChvcHRpb25zLnBsYWNlaG9sZGVyKS5wcmVwZW5kVG8oJGVkaXRpbmdBcmVhKTt9O3RoaXMuZGVzdHJveT1mdW5jdGlvbigpe3RoaXMuJHBsYWNlaG9sZGVyLnJlbW92ZSgpO307dGhpcy51cGRhdGU9ZnVuY3Rpb24oKXt2YXIgaXNTaG93PSFjb250ZXh0Lmludm9rZSgnY29kZXZpZXcuaXNBY3RpdmF0ZWQnKSYmY29udGV4dC5pbnZva2UoJ2VkaXRvci5pc0VtcHR5Jyk7dGhpcy4kcGxhY2Vob2xkZXIudG9nZ2xlKGlzU2hvdyk7fTt9O3ZhciBCdXR0b25zPWZ1bmN0aW9uKGNvbnRleHQpe3ZhciBzZWxmPXRoaXM7dmFyIHVpPSQuc3VtbWVybm90ZS51aTt2YXIgJHRvb2xiYXI9Y29udGV4dC5sYXlvdXRJbmZvLnRvb2xiYXI7dmFyIG9wdGlvbnM9Y29udGV4dC5vcHRpb25zO3ZhciBsYW5nPW9wdGlvbnMubGFuZ0luZm87dmFyIGludmVydGVkS2V5TWFwPWZ1bmMuaW52ZXJ0T2JqZWN0KG9wdGlvbnMua2V5TWFwW2FnZW50LmlzTWFjPydtYWMnOidwYyddKTt2YXIgcmVwcmVzZW50U2hvcnRjdXQ9dGhpcy5yZXByZXNlbnRTaG9ydGN1dD1mdW5jdGlvbihlZGl0b3JNZXRob2Qpe3ZhciBzaG9ydGN1dD1pbnZlcnRlZEtleU1hcFtlZGl0b3JNZXRob2RdO2lmKCFvcHRpb25zLnNob3J0Y3V0c3x8IXNob3J0Y3V0KXtyZXR1cm4nJzt9aWYoYWdlbnQuaXNNYWMpe3Nob3J0Y3V0PXNob3J0Y3V0LnJlcGxhY2UoJ0NNRCcsJ+KMmCcpLnJlcGxhY2UoJ1NISUZUJywn4oenJyk7fXNob3J0Y3V0PXNob3J0Y3V0LnJlcGxhY2UoJ0JBQ0tTTEFTSCcsJ1xcXFwnKS5yZXBsYWNlKCdTTEFTSCcsJy8nKS5yZXBsYWNlKCdMRUZUQlJBQ0tFVCcsJ1snKS5yZXBsYWNlKCdSSUdIVEJSQUNLRVQnLCddJyk7cmV0dXJuJyAoJytzaG9ydGN1dCsnKSc7fTt0aGlzLmluaXRpYWxpemU9ZnVuY3Rpb24oKXt0aGlzLmFkZFRvb2xiYXJCdXR0b25zKCk7dGhpcy5hZGRJbWFnZVBvcG92ZXJCdXR0b25zKCk7dGhpcy5hZGRMaW5rUG9wb3ZlckJ1dHRvbnMoKTt0aGlzLmZvbnRJbnN0YWxsZWRNYXA9e307fTt0aGlzLmRlc3Ryb3k9ZnVuY3Rpb24oKXtkZWxldGUgdGhpcy5mb250SW5zdGFsbGVkTWFwO307dGhpcy5pc0ZvbnRJbnN0YWxsZWQ9ZnVuY3Rpb24obmFtZSl7aWYoIXNlbGYuZm9udEluc3RhbGxlZE1hcC5oYXNPd25Qcm9wZXJ0eShuYW1lKSl7c2VsZi5mb250SW5zdGFsbGVkTWFwW25hbWVdPWFnZW50LmlzRm9udEluc3RhbGxlZChuYW1lKXx8bGlzdC5jb250YWlucyhvcHRpb25zLmZvbnROYW1lc0lnbm9yZUNoZWNrLG5hbWUpO31yZXR1cm4gc2VsZi5mb250SW5zdGFsbGVkTWFwW25hbWVdO307dGhpcy5hZGRUb29sYmFyQnV0dG9ucz1mdW5jdGlvbigpe2NvbnRleHQubWVtbygnYnV0dG9uLnN0eWxlJyxmdW5jdGlvbigpe3JldHVybiB1aS5idXR0b25Hcm91cChbdWkuYnV0dG9uKHtjbGFzc05hbWU6J2Ryb3Bkb3duLXRvZ2dsZScsY29udGVudHM6dWkuaWNvbihvcHRpb25zLmljb25zLm1hZ2ljKSsnICcrdWkuaWNvbihvcHRpb25zLmljb25zLmNhcmV0LCdzcGFuJyksdG9vbHRpcDpsYW5nLnN0eWxlLnN0eWxlLGRhdGE6e3RvZ2dsZTonZHJvcGRvd24nfX0pLHVpLmRyb3Bkb3duKHtjbGFzc05hbWU6J2Ryb3Bkb3duLXN0eWxlJyxpdGVtczpjb250ZXh0Lm9wdGlvbnMuc3R5bGVUYWdzLHRlbXBsYXRlOmZ1bmN0aW9uKGl0ZW0pe2lmKHR5cGVvZiBpdGVtPT09J3N0cmluZycpe2l0ZW09e3RhZzppdGVtLHRpdGxlOmxhbmcuc3R5bGUuaGFzT3duUHJvcGVydHkoaXRlbSk/bGFuZy5zdHlsZVtpdGVtXTppdGVtfTt9dmFyIHRhZz1pdGVtLnRhZzt2YXIgdGl0bGU9aXRlbS50aXRsZTt2YXIgc3R5bGU9aXRlbS5zdHlsZT8nIHN0eWxlPVwiJytpdGVtLnN0eWxlKydcIiAnOicnO3ZhciBjbGFzc05hbWU9aXRlbS5jbGFzc05hbWU/JyBjbGFzcz1cIicraXRlbS5jbGFzc05hbWUrJ1wiJzonJztyZXR1cm4nPCcrdGFnK3N0eWxlK2NsYXNzTmFtZSsnPicrdGl0bGUrJzwvJyt0YWcrJz4nO30sY2xpY2s6Y29udGV4dC5jcmVhdGVJbnZva2VIYW5kbGVyKCdlZGl0b3IuZm9ybWF0QmxvY2snKX0pXSkucmVuZGVyKCk7fSk7Y29udGV4dC5tZW1vKCdidXR0b24uYm9sZCcsZnVuY3Rpb24oKXtyZXR1cm4gdWkuYnV0dG9uKHtjbGFzc05hbWU6J25vdGUtYnRuLWJvbGQnLGNvbnRlbnRzOnVpLmljb24ob3B0aW9ucy5pY29ucy5ib2xkKSx0b29sdGlwOmxhbmcuZm9udC5ib2xkK3JlcHJlc2VudFNob3J0Y3V0KCdib2xkJyksY2xpY2s6Y29udGV4dC5jcmVhdGVJbnZva2VIYW5kbGVyKCdlZGl0b3IuYm9sZCcpfSkucmVuZGVyKCk7fSk7Y29udGV4dC5tZW1vKCdidXR0b24uaXRhbGljJyxmdW5jdGlvbigpe3JldHVybiB1aS5idXR0b24oe2NsYXNzTmFtZTonbm90ZS1idG4taXRhbGljJyxjb250ZW50czp1aS5pY29uKG9wdGlvbnMuaWNvbnMuaXRhbGljKSx0b29sdGlwOmxhbmcuZm9udC5pdGFsaWMrcmVwcmVzZW50U2hvcnRjdXQoJ2l0YWxpYycpLGNsaWNrOmNvbnRleHQuY3JlYXRlSW52b2tlSGFuZGxlcignZWRpdG9yLml0YWxpYycpfSkucmVuZGVyKCk7fSk7Y29udGV4dC5tZW1vKCdidXR0b24udW5kZXJsaW5lJyxmdW5jdGlvbigpe3JldHVybiB1aS5idXR0b24oe2NsYXNzTmFtZTonbm90ZS1idG4tdW5kZXJsaW5lJyxjb250ZW50czp1aS5pY29uKG9wdGlvbnMuaWNvbnMudW5kZXJsaW5lKSx0b29sdGlwOmxhbmcuZm9udC51bmRlcmxpbmUrcmVwcmVzZW50U2hvcnRjdXQoJ3VuZGVybGluZScpLGNsaWNrOmNvbnRleHQuY3JlYXRlSW52b2tlSGFuZGxlcignZWRpdG9yLnVuZGVybGluZScpfSkucmVuZGVyKCk7fSk7Y29udGV4dC5tZW1vKCdidXR0b24uY2xlYXInLGZ1bmN0aW9uKCl7cmV0dXJuIHVpLmJ1dHRvbih7Y29udGVudHM6dWkuaWNvbihvcHRpb25zLmljb25zLmVyYXNlciksdG9vbHRpcDpsYW5nLmZvbnQuY2xlYXIrcmVwcmVzZW50U2hvcnRjdXQoJ3JlbW92ZUZvcm1hdCcpLGNsaWNrOmNvbnRleHQuY3JlYXRlSW52b2tlSGFuZGxlcignZWRpdG9yLnJlbW92ZUZvcm1hdCcpfSkucmVuZGVyKCk7fSk7Y29udGV4dC5tZW1vKCdidXR0b24uc3RyaWtldGhyb3VnaCcsZnVuY3Rpb24oKXtyZXR1cm4gdWkuYnV0dG9uKHtjbGFzc05hbWU6J25vdGUtYnRuLXN0cmlrZXRocm91Z2gnLGNvbnRlbnRzOnVpLmljb24ob3B0aW9ucy5pY29ucy5zdHJpa2V0aHJvdWdoKSx0b29sdGlwOmxhbmcuZm9udC5zdHJpa2V0aHJvdWdoK3JlcHJlc2VudFNob3J0Y3V0KCdzdHJpa2V0aHJvdWdoJyksY2xpY2s6Y29udGV4dC5jcmVhdGVJbnZva2VIYW5kbGVyKCdlZGl0b3Iuc3RyaWtldGhyb3VnaCcpfSkucmVuZGVyKCk7fSk7Y29udGV4dC5tZW1vKCdidXR0b24uc3VwZXJzY3JpcHQnLGZ1bmN0aW9uKCl7cmV0dXJuIHVpLmJ1dHRvbih7Y2xhc3NOYW1lOidub3RlLWJ0bi1zdXBlcnNjcmlwdCcsY29udGVudHM6dWkuaWNvbihvcHRpb25zLmljb25zLnN1cGVyc2NyaXB0KSx0b29sdGlwOmxhbmcuZm9udC5zdXBlcnNjcmlwdCxjbGljazpjb250ZXh0LmNyZWF0ZUludm9rZUhhbmRsZXIoJ2VkaXRvci5zdXBlcnNjcmlwdCcpfSkucmVuZGVyKCk7fSk7Y29udGV4dC5tZW1vKCdidXR0b24uc3Vic2NyaXB0JyxmdW5jdGlvbigpe3JldHVybiB1aS5idXR0b24oe2NsYXNzTmFtZTonbm90ZS1idG4tc3Vic2NyaXB0Jyxjb250ZW50czp1aS5pY29uKG9wdGlvbnMuaWNvbnMuc3Vic2NyaXB0KSx0b29sdGlwOmxhbmcuZm9udC5zdWJzY3JpcHQsY2xpY2s6Y29udGV4dC5jcmVhdGVJbnZva2VIYW5kbGVyKCdlZGl0b3Iuc3Vic2NyaXB0Jyl9KS5yZW5kZXIoKTt9KTtjb250ZXh0Lm1lbW8oJ2J1dHRvbi5mb250bmFtZScsZnVuY3Rpb24oKXtyZXR1cm4gdWkuYnV0dG9uR3JvdXAoW3VpLmJ1dHRvbih7Y2xhc3NOYW1lOidkcm9wZG93bi10b2dnbGUnLGNvbnRlbnRzOic8c3BhbiBjbGFzcz1cIm5vdGUtY3VycmVudC1mb250bmFtZVwiLz4gJyt1aS5pY29uKG9wdGlvbnMuaWNvbnMuY2FyZXQsJ3NwYW4nKSx0b29sdGlwOmxhbmcuZm9udC5uYW1lLGRhdGE6e3RvZ2dsZTonZHJvcGRvd24nfX0pLHVpLmRyb3Bkb3duQ2hlY2soe2NsYXNzTmFtZTonZHJvcGRvd24tZm9udG5hbWUnLGNoZWNrQ2xhc3NOYW1lOm9wdGlvbnMuaWNvbnMubWVudUNoZWNrLGl0ZW1zOm9wdGlvbnMuZm9udE5hbWVzLmZpbHRlcihzZWxmLmlzRm9udEluc3RhbGxlZCksdGVtcGxhdGU6ZnVuY3Rpb24oaXRlbSl7cmV0dXJuJzxzcGFuIHN0eWxlPVwiZm9udC1mYW1pbHk6JytpdGVtKydcIj4nK2l0ZW0rJzwvc3Bhbj4nO30sY2xpY2s6Y29udGV4dC5jcmVhdGVJbnZva2VIYW5kbGVyKCdlZGl0b3IuZm9udE5hbWUnKX0pXSkucmVuZGVyKCk7fSk7Y29udGV4dC5tZW1vKCdidXR0b24uZm9udHNpemUnLGZ1bmN0aW9uKCl7cmV0dXJuIHVpLmJ1dHRvbkdyb3VwKFt1aS5idXR0b24oe2NsYXNzTmFtZTonZHJvcGRvd24tdG9nZ2xlJyxjb250ZW50czonPHNwYW4gY2xhc3M9XCJub3RlLWN1cnJlbnQtZm9udHNpemVcIi8+Jyt1aS5pY29uKG9wdGlvbnMuaWNvbnMuY2FyZXQsJ3NwYW4nKSx0b29sdGlwOmxhbmcuZm9udC5zaXplLGRhdGE6e3RvZ2dsZTonZHJvcGRvd24nfX0pLHVpLmRyb3Bkb3duQ2hlY2soe2NsYXNzTmFtZTonZHJvcGRvd24tZm9udHNpemUnLGNoZWNrQ2xhc3NOYW1lOm9wdGlvbnMuaWNvbnMubWVudUNoZWNrLGl0ZW1zOm9wdGlvbnMuZm9udFNpemVzLGNsaWNrOmNvbnRleHQuY3JlYXRlSW52b2tlSGFuZGxlcignZWRpdG9yLmZvbnRTaXplJyl9KV0pLnJlbmRlcigpO30pO2NvbnRleHQubWVtbygnYnV0dG9uLmNvbG9yJyxmdW5jdGlvbigpe3JldHVybiB1aS5idXR0b25Hcm91cCh7Y2xhc3NOYW1lOidub3RlLWNvbG9yJyxjaGlsZHJlbjpbdWkuYnV0dG9uKHtjbGFzc05hbWU6J25vdGUtY3VycmVudC1jb2xvci1idXR0b24nLGNvbnRlbnRzOnVpLmljb24ob3B0aW9ucy5pY29ucy5mb250Kycgbm90ZS1yZWNlbnQtY29sb3InKSx0b29sdGlwOmxhbmcuY29sb3IucmVjZW50LGNsaWNrOmZ1bmN0aW9uKGUpe3ZhciAkYnV0dG9uPSQoZS5jdXJyZW50VGFyZ2V0KTtjb250ZXh0Lmludm9rZSgnZWRpdG9yLmNvbG9yJyx7YmFja0NvbG9yOiRidXR0b24uYXR0cignZGF0YS1iYWNrQ29sb3InKSxmb3JlQ29sb3I6JGJ1dHRvbi5hdHRyKCdkYXRhLWZvcmVDb2xvcicpfSk7fSxjYWxsYmFjazpmdW5jdGlvbigkYnV0dG9uKXt2YXIgJHJlY2VudENvbG9yPSRidXR0b24uZmluZCgnLm5vdGUtcmVjZW50LWNvbG9yJyk7JHJlY2VudENvbG9yLmNzcygnYmFja2dyb3VuZC1jb2xvcicsJyNGRkZGMDAnKTskYnV0dG9uLmF0dHIoJ2RhdGEtYmFja0NvbG9yJywnI0ZGRkYwMCcpO319KSx1aS5idXR0b24oe2NsYXNzTmFtZTonZHJvcGRvd24tdG9nZ2xlJyxjb250ZW50czp1aS5pY29uKG9wdGlvbnMuaWNvbnMuY2FyZXQsJ3NwYW4nKSx0b29sdGlwOmxhbmcuY29sb3IubW9yZSxkYXRhOnt0b2dnbGU6J2Ryb3Bkb3duJ319KSx1aS5kcm9wZG93bih7aXRlbXM6Wyc8bGk+JywnPGRpdiBjbGFzcz1cImJ0bi1ncm91cFwiPicsJyAgPGRpdiBjbGFzcz1cIm5vdGUtcGFsZXR0ZS10aXRsZVwiPicrbGFuZy5jb2xvci5iYWNrZ3JvdW5kKyc8L2Rpdj4nLCcgIDxkaXY+JywnICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwibm90ZS1jb2xvci1yZXNldCBidG4gYnRuLWRlZmF1bHRcIiBkYXRhLWV2ZW50PVwiYmFja0NvbG9yXCIgZGF0YS12YWx1ZT1cImluaGVyaXRcIj4nLGxhbmcuY29sb3IudHJhbnNwYXJlbnQsJyAgICA8L2J1dHRvbj4nLCcgIDwvZGl2PicsJyAgPGRpdiBjbGFzcz1cIm5vdGUtaG9sZGVyXCIgZGF0YS1ldmVudD1cImJhY2tDb2xvclwiLz4nLCc8L2Rpdj4nLCc8ZGl2IGNsYXNzPVwiYnRuLWdyb3VwXCI+JywnICA8ZGl2IGNsYXNzPVwibm90ZS1wYWxldHRlLXRpdGxlXCI+JytsYW5nLmNvbG9yLmZvcmVncm91bmQrJzwvZGl2PicsJyAgPGRpdj4nLCcgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJub3RlLWNvbG9yLXJlc2V0IGJ0biBidG4tZGVmYXVsdFwiIGRhdGEtZXZlbnQ9XCJyZW1vdmVGb3JtYXRcIiBkYXRhLXZhbHVlPVwiZm9yZUNvbG9yXCI+JyxsYW5nLmNvbG9yLnJlc2V0VG9EZWZhdWx0LCcgICAgPC9idXR0b24+JywnICA8L2Rpdj4nLCcgIDxkaXYgY2xhc3M9XCJub3RlLWhvbGRlclwiIGRhdGEtZXZlbnQ9XCJmb3JlQ29sb3JcIi8+JywnPC9kaXY+JywnPC9saT4nXS5qb2luKCcnKSxjYWxsYmFjazpmdW5jdGlvbigkZHJvcGRvd24peyRkcm9wZG93bi5maW5kKCcubm90ZS1ob2xkZXInKS5lYWNoKGZ1bmN0aW9uKCl7dmFyICRob2xkZXI9JCh0aGlzKTskaG9sZGVyLmFwcGVuZCh1aS5wYWxldHRlKHtjb2xvcnM6b3B0aW9ucy5jb2xvcnMsZXZlbnROYW1lOiRob2xkZXIuZGF0YSgnZXZlbnQnKX0pLnJlbmRlcigpKTt9KTt9LGNsaWNrOmZ1bmN0aW9uKGV2ZW50KXt2YXIgJGJ1dHRvbj0kKGV2ZW50LnRhcmdldCk7dmFyIGV2ZW50TmFtZT0kYnV0dG9uLmRhdGEoJ2V2ZW50Jyk7dmFyIHZhbHVlPSRidXR0b24uZGF0YSgndmFsdWUnKTtpZihldmVudE5hbWUmJnZhbHVlKXt2YXIga2V5PWV2ZW50TmFtZT09PSdiYWNrQ29sb3InPydiYWNrZ3JvdW5kLWNvbG9yJzonY29sb3InO3ZhciAkY29sb3I9JGJ1dHRvbi5jbG9zZXN0KCcubm90ZS1jb2xvcicpLmZpbmQoJy5ub3RlLXJlY2VudC1jb2xvcicpO3ZhciAkY3VycmVudEJ1dHRvbj0kYnV0dG9uLmNsb3Nlc3QoJy5ub3RlLWNvbG9yJykuZmluZCgnLm5vdGUtY3VycmVudC1jb2xvci1idXR0b24nKTskY29sb3IuY3NzKGtleSx2YWx1ZSk7JGN1cnJlbnRCdXR0b24uYXR0cignZGF0YS0nK2V2ZW50TmFtZSx2YWx1ZSk7Y29udGV4dC5pbnZva2UoJ2VkaXRvci4nK2V2ZW50TmFtZSx2YWx1ZSk7fX19KV19KS5yZW5kZXIoKTt9KTtjb250ZXh0Lm1lbW8oJ2J1dHRvbi51bCcsZnVuY3Rpb24oKXtyZXR1cm4gdWkuYnV0dG9uKHtjb250ZW50czp1aS5pY29uKG9wdGlvbnMuaWNvbnMudW5vcmRlcmVkbGlzdCksdG9vbHRpcDpsYW5nLmxpc3RzLnVub3JkZXJlZCtyZXByZXNlbnRTaG9ydGN1dCgnaW5zZXJ0VW5vcmRlcmVkTGlzdCcpLGNsaWNrOmNvbnRleHQuY3JlYXRlSW52b2tlSGFuZGxlcignZWRpdG9yLmluc2VydFVub3JkZXJlZExpc3QnKX0pLnJlbmRlcigpO30pO2NvbnRleHQubWVtbygnYnV0dG9uLm9sJyxmdW5jdGlvbigpe3JldHVybiB1aS5idXR0b24oe2NvbnRlbnRzOnVpLmljb24ob3B0aW9ucy5pY29ucy5vcmRlcmVkbGlzdCksdG9vbHRpcDpsYW5nLmxpc3RzLm9yZGVyZWQrcmVwcmVzZW50U2hvcnRjdXQoJ2luc2VydE9yZGVyZWRMaXN0JyksY2xpY2s6Y29udGV4dC5jcmVhdGVJbnZva2VIYW5kbGVyKCdlZGl0b3IuaW5zZXJ0T3JkZXJlZExpc3QnKX0pLnJlbmRlcigpO30pO3ZhciBqdXN0aWZ5TGVmdD11aS5idXR0b24oe2NvbnRlbnRzOnVpLmljb24ob3B0aW9ucy5pY29ucy5hbGlnbkxlZnQpLHRvb2x0aXA6bGFuZy5wYXJhZ3JhcGgubGVmdCtyZXByZXNlbnRTaG9ydGN1dCgnanVzdGlmeUxlZnQnKSxjbGljazpjb250ZXh0LmNyZWF0ZUludm9rZUhhbmRsZXIoJ2VkaXRvci5qdXN0aWZ5TGVmdCcpfSk7dmFyIGp1c3RpZnlDZW50ZXI9dWkuYnV0dG9uKHtjb250ZW50czp1aS5pY29uKG9wdGlvbnMuaWNvbnMuYWxpZ25DZW50ZXIpLHRvb2x0aXA6bGFuZy5wYXJhZ3JhcGguY2VudGVyK3JlcHJlc2VudFNob3J0Y3V0KCdqdXN0aWZ5Q2VudGVyJyksY2xpY2s6Y29udGV4dC5jcmVhdGVJbnZva2VIYW5kbGVyKCdlZGl0b3IuanVzdGlmeUNlbnRlcicpfSk7dmFyIGp1c3RpZnlSaWdodD11aS5idXR0b24oe2NvbnRlbnRzOnVpLmljb24ob3B0aW9ucy5pY29ucy5hbGlnblJpZ2h0KSx0b29sdGlwOmxhbmcucGFyYWdyYXBoLnJpZ2h0K3JlcHJlc2VudFNob3J0Y3V0KCdqdXN0aWZ5UmlnaHQnKSxjbGljazpjb250ZXh0LmNyZWF0ZUludm9rZUhhbmRsZXIoJ2VkaXRvci5qdXN0aWZ5UmlnaHQnKX0pO3ZhciBqdXN0aWZ5RnVsbD11aS5idXR0b24oe2NvbnRlbnRzOnVpLmljb24ob3B0aW9ucy5pY29ucy5hbGlnbkp1c3RpZnkpLHRvb2x0aXA6bGFuZy5wYXJhZ3JhcGguanVzdGlmeStyZXByZXNlbnRTaG9ydGN1dCgnanVzdGlmeUZ1bGwnKSxjbGljazpjb250ZXh0LmNyZWF0ZUludm9rZUhhbmRsZXIoJ2VkaXRvci5qdXN0aWZ5RnVsbCcpfSk7dmFyIG91dGRlbnQ9dWkuYnV0dG9uKHtjb250ZW50czp1aS5pY29uKG9wdGlvbnMuaWNvbnMub3V0ZGVudCksdG9vbHRpcDpsYW5nLnBhcmFncmFwaC5vdXRkZW50K3JlcHJlc2VudFNob3J0Y3V0KCdvdXRkZW50JyksY2xpY2s6Y29udGV4dC5jcmVhdGVJbnZva2VIYW5kbGVyKCdlZGl0b3Iub3V0ZGVudCcpfSk7dmFyIGluZGVudD11aS5idXR0b24oe2NvbnRlbnRzOnVpLmljb24ob3B0aW9ucy5pY29ucy5pbmRlbnQpLHRvb2x0aXA6bGFuZy5wYXJhZ3JhcGguaW5kZW50K3JlcHJlc2VudFNob3J0Y3V0KCdpbmRlbnQnKSxjbGljazpjb250ZXh0LmNyZWF0ZUludm9rZUhhbmRsZXIoJ2VkaXRvci5pbmRlbnQnKX0pO2NvbnRleHQubWVtbygnYnV0dG9uLmp1c3RpZnlMZWZ0JyxmdW5jLmludm9rZShqdXN0aWZ5TGVmdCwncmVuZGVyJykpO2NvbnRleHQubWVtbygnYnV0dG9uLmp1c3RpZnlDZW50ZXInLGZ1bmMuaW52b2tlKGp1c3RpZnlDZW50ZXIsJ3JlbmRlcicpKTtjb250ZXh0Lm1lbW8oJ2J1dHRvbi5qdXN0aWZ5UmlnaHQnLGZ1bmMuaW52b2tlKGp1c3RpZnlSaWdodCwncmVuZGVyJykpO2NvbnRleHQubWVtbygnYnV0dG9uLmp1c3RpZnlGdWxsJyxmdW5jLmludm9rZShqdXN0aWZ5RnVsbCwncmVuZGVyJykpO2NvbnRleHQubWVtbygnYnV0dG9uLm91dGRlbnQnLGZ1bmMuaW52b2tlKG91dGRlbnQsJ3JlbmRlcicpKTtjb250ZXh0Lm1lbW8oJ2J1dHRvbi5pbmRlbnQnLGZ1bmMuaW52b2tlKGluZGVudCwncmVuZGVyJykpO2NvbnRleHQubWVtbygnYnV0dG9uLnBhcmFncmFwaCcsZnVuY3Rpb24oKXtyZXR1cm4gdWkuYnV0dG9uR3JvdXAoW3VpLmJ1dHRvbih7Y2xhc3NOYW1lOidkcm9wZG93bi10b2dnbGUnLGNvbnRlbnRzOnVpLmljb24ob3B0aW9ucy5pY29ucy5hbGlnbkxlZnQpKycgJyt1aS5pY29uKG9wdGlvbnMuaWNvbnMuY2FyZXQsJ3NwYW4nKSx0b29sdGlwOmxhbmcucGFyYWdyYXBoLnBhcmFncmFwaCxkYXRhOnt0b2dnbGU6J2Ryb3Bkb3duJ319KSx1aS5kcm9wZG93bihbdWkuYnV0dG9uR3JvdXAoe2NsYXNzTmFtZTonbm90ZS1hbGlnbicsY2hpbGRyZW46W2p1c3RpZnlMZWZ0LGp1c3RpZnlDZW50ZXIsanVzdGlmeVJpZ2h0LGp1c3RpZnlGdWxsXX0pLHVpLmJ1dHRvbkdyb3VwKHtjbGFzc05hbWU6J25vdGUtbGlzdCcsY2hpbGRyZW46W291dGRlbnQsaW5kZW50XX0pXSldKS5yZW5kZXIoKTt9KTtjb250ZXh0Lm1lbW8oJ2J1dHRvbi5oZWlnaHQnLGZ1bmN0aW9uKCl7cmV0dXJuIHVpLmJ1dHRvbkdyb3VwKFt1aS5idXR0b24oe2NsYXNzTmFtZTonZHJvcGRvd24tdG9nZ2xlJyxjb250ZW50czp1aS5pY29uKG9wdGlvbnMuaWNvbnMudGV4dEhlaWdodCkrJyAnK3VpLmljb24ob3B0aW9ucy5pY29ucy5jYXJldCwnc3BhbicpLHRvb2x0aXA6bGFuZy5mb250LmhlaWdodCxkYXRhOnt0b2dnbGU6J2Ryb3Bkb3duJ319KSx1aS5kcm9wZG93bkNoZWNrKHtpdGVtczpvcHRpb25zLmxpbmVIZWlnaHRzLGNoZWNrQ2xhc3NOYW1lOm9wdGlvbnMuaWNvbnMubWVudUNoZWNrLGNsYXNzTmFtZTonZHJvcGRvd24tbGluZS1oZWlnaHQnLGNsaWNrOmNvbnRleHQuY3JlYXRlSW52b2tlSGFuZGxlcignZWRpdG9yLmxpbmVIZWlnaHQnKX0pXSkucmVuZGVyKCk7fSk7Y29udGV4dC5tZW1vKCdidXR0b24udGFibGUnLGZ1bmN0aW9uKCl7cmV0dXJuIHVpLmJ1dHRvbkdyb3VwKFt1aS5idXR0b24oe2NsYXNzTmFtZTonZHJvcGRvd24tdG9nZ2xlJyxjb250ZW50czp1aS5pY29uKG9wdGlvbnMuaWNvbnMudGFibGUpKycgJyt1aS5pY29uKG9wdGlvbnMuaWNvbnMuY2FyZXQsJ3NwYW4nKSx0b29sdGlwOmxhbmcudGFibGUudGFibGUsZGF0YTp7dG9nZ2xlOidkcm9wZG93bid9fSksdWkuZHJvcGRvd24oe2NsYXNzTmFtZTonbm90ZS10YWJsZScsaXRlbXM6Wyc8ZGl2IGNsYXNzPVwibm90ZS1kaW1lbnNpb24tcGlja2VyXCI+JywnICA8ZGl2IGNsYXNzPVwibm90ZS1kaW1lbnNpb24tcGlja2VyLW1vdXNlY2F0Y2hlclwiIGRhdGEtZXZlbnQ9XCJpbnNlcnRUYWJsZVwiIGRhdGEtdmFsdWU9XCIxeDFcIi8+JywnICA8ZGl2IGNsYXNzPVwibm90ZS1kaW1lbnNpb24tcGlja2VyLWhpZ2hsaWdodGVkXCIvPicsJyAgPGRpdiBjbGFzcz1cIm5vdGUtZGltZW5zaW9uLXBpY2tlci11bmhpZ2hsaWdodGVkXCIvPicsJzwvZGl2PicsJzxkaXYgY2xhc3M9XCJub3RlLWRpbWVuc2lvbi1kaXNwbGF5XCI+MSB4IDE8L2Rpdj4nXS5qb2luKCcnKX0pXSx7Y2FsbGJhY2s6ZnVuY3Rpb24oJG5vZGUpe3ZhciAkY2F0Y2hlcj0kbm9kZS5maW5kKCcubm90ZS1kaW1lbnNpb24tcGlja2VyLW1vdXNlY2F0Y2hlcicpOyRjYXRjaGVyLmNzcyh7d2lkdGg6b3B0aW9ucy5pbnNlcnRUYWJsZU1heFNpemUuY29sKydlbScsaGVpZ2h0Om9wdGlvbnMuaW5zZXJ0VGFibGVNYXhTaXplLnJvdysnZW0nfSkubW91c2Vkb3duKGNvbnRleHQuY3JlYXRlSW52b2tlSGFuZGxlcignZWRpdG9yLmluc2VydFRhYmxlJykpLm9uKCdtb3VzZW1vdmUnLHNlbGYudGFibGVNb3ZlSGFuZGxlcik7fX0pLnJlbmRlcigpO30pO2NvbnRleHQubWVtbygnYnV0dG9uLmxpbmsnLGZ1bmN0aW9uKCl7cmV0dXJuIHVpLmJ1dHRvbih7Y29udGVudHM6dWkuaWNvbihvcHRpb25zLmljb25zLmxpbmspLHRvb2x0aXA6bGFuZy5saW5rLmxpbmsrcmVwcmVzZW50U2hvcnRjdXQoJ2xpbmtEaWFsb2cuc2hvdycpLGNsaWNrOmNvbnRleHQuY3JlYXRlSW52b2tlSGFuZGxlcignbGlua0RpYWxvZy5zaG93Jyl9KS5yZW5kZXIoKTt9KTtjb250ZXh0Lm1lbW8oJ2J1dHRvbi5waWN0dXJlJyxmdW5jdGlvbigpe3JldHVybiB1aS5idXR0b24oe2NvbnRlbnRzOnVpLmljb24ob3B0aW9ucy5pY29ucy5waWN0dXJlKSx0b29sdGlwOmxhbmcuaW1hZ2UuaW1hZ2UsY2xpY2s6Y29udGV4dC5jcmVhdGVJbnZva2VIYW5kbGVyKCdpbWFnZURpYWxvZy5zaG93Jyl9KS5yZW5kZXIoKTt9KTtjb250ZXh0Lm1lbW8oJ2J1dHRvbi52aWRlbycsZnVuY3Rpb24oKXtyZXR1cm4gdWkuYnV0dG9uKHtjb250ZW50czp1aS5pY29uKG9wdGlvbnMuaWNvbnMudmlkZW8pLHRvb2x0aXA6bGFuZy52aWRlby52aWRlbyxjbGljazpjb250ZXh0LmNyZWF0ZUludm9rZUhhbmRsZXIoJ3ZpZGVvRGlhbG9nLnNob3cnKX0pLnJlbmRlcigpO30pO2NvbnRleHQubWVtbygnYnV0dG9uLmhyJyxmdW5jdGlvbigpe3JldHVybiB1aS5idXR0b24oe2NvbnRlbnRzOnVpLmljb24ob3B0aW9ucy5pY29ucy5taW51cyksdG9vbHRpcDpsYW5nLmhyLmluc2VydCtyZXByZXNlbnRTaG9ydGN1dCgnaW5zZXJ0SG9yaXpvbnRhbFJ1bGUnKSxjbGljazpjb250ZXh0LmNyZWF0ZUludm9rZUhhbmRsZXIoJ2VkaXRvci5pbnNlcnRIb3Jpem9udGFsUnVsZScpfSkucmVuZGVyKCk7fSk7Y29udGV4dC5tZW1vKCdidXR0b24uZnVsbHNjcmVlbicsZnVuY3Rpb24oKXtyZXR1cm4gdWkuYnV0dG9uKHtjbGFzc05hbWU6J2J0bi1mdWxsc2NyZWVuJyxjb250ZW50czp1aS5pY29uKG9wdGlvbnMuaWNvbnMuYXJyb3dzQWx0KSx0b29sdGlwOmxhbmcub3B0aW9ucy5mdWxsc2NyZWVuLGNsaWNrOmNvbnRleHQuY3JlYXRlSW52b2tlSGFuZGxlcignZnVsbHNjcmVlbi50b2dnbGUnKX0pLnJlbmRlcigpO30pO2NvbnRleHQubWVtbygnYnV0dG9uLmNvZGV2aWV3JyxmdW5jdGlvbigpe3JldHVybiB1aS5idXR0b24oe2NsYXNzTmFtZTonYnRuLWNvZGV2aWV3Jyxjb250ZW50czp1aS5pY29uKG9wdGlvbnMuaWNvbnMuY29kZSksdG9vbHRpcDpsYW5nLm9wdGlvbnMuY29kZXZpZXcsY2xpY2s6Y29udGV4dC5jcmVhdGVJbnZva2VIYW5kbGVyKCdjb2Rldmlldy50b2dnbGUnKX0pLnJlbmRlcigpO30pO2NvbnRleHQubWVtbygnYnV0dG9uLnJlZG8nLGZ1bmN0aW9uKCl7cmV0dXJuIHVpLmJ1dHRvbih7Y29udGVudHM6dWkuaWNvbihvcHRpb25zLmljb25zLnJlZG8pLHRvb2x0aXA6bGFuZy5oaXN0b3J5LnJlZG8rcmVwcmVzZW50U2hvcnRjdXQoJ3JlZG8nKSxjbGljazpjb250ZXh0LmNyZWF0ZUludm9rZUhhbmRsZXIoJ2VkaXRvci5yZWRvJyl9KS5yZW5kZXIoKTt9KTtjb250ZXh0Lm1lbW8oJ2J1dHRvbi51bmRvJyxmdW5jdGlvbigpe3JldHVybiB1aS5idXR0b24oe2NvbnRlbnRzOnVpLmljb24ob3B0aW9ucy5pY29ucy51bmRvKSx0b29sdGlwOmxhbmcuaGlzdG9yeS51bmRvK3JlcHJlc2VudFNob3J0Y3V0KCd1bmRvJyksY2xpY2s6Y29udGV4dC5jcmVhdGVJbnZva2VIYW5kbGVyKCdlZGl0b3IudW5kbycpfSkucmVuZGVyKCk7fSk7Y29udGV4dC5tZW1vKCdidXR0b24uaGVscCcsZnVuY3Rpb24oKXtyZXR1cm4gdWkuYnV0dG9uKHtjb250ZW50czp1aS5pY29uKG9wdGlvbnMuaWNvbnMucXVlc3Rpb24pLHRvb2x0aXA6bGFuZy5vcHRpb25zLmhlbHAsY2xpY2s6Y29udGV4dC5jcmVhdGVJbnZva2VIYW5kbGVyKCdoZWxwRGlhbG9nLnNob3cnKX0pLnJlbmRlcigpO30pO307LyoqXG4gICAgICogaW1hZ2UgOiBbXG4gICAgICogICBbJ2ltYWdlc2l6ZScsIFsnaW1hZ2VTaXplMTAwJywgJ2ltYWdlU2l6ZTUwJywgJ2ltYWdlU2l6ZTI1J11dLFxuICAgICAqICAgWydmbG9hdCcsIFsnZmxvYXRMZWZ0JywgJ2Zsb2F0UmlnaHQnLCAnZmxvYXROb25lJyBdXSxcbiAgICAgKiAgIFsncmVtb3ZlJywgWydyZW1vdmVNZWRpYSddXVxuICAgICAqIF0sXG4gICAgICovdGhpcy5hZGRJbWFnZVBvcG92ZXJCdXR0b25zPWZ1bmN0aW9uKCl7Ly8gSW1hZ2UgU2l6ZSBCdXR0b25zXG5jb250ZXh0Lm1lbW8oJ2J1dHRvbi5pbWFnZVNpemUxMDAnLGZ1bmN0aW9uKCl7cmV0dXJuIHVpLmJ1dHRvbih7Y29udGVudHM6JzxzcGFuIGNsYXNzPVwibm90ZS1mb250c2l6ZS0xMFwiPjEwMCU8L3NwYW4+Jyx0b29sdGlwOmxhbmcuaW1hZ2UucmVzaXplRnVsbCxjbGljazpjb250ZXh0LmNyZWF0ZUludm9rZUhhbmRsZXIoJ2VkaXRvci5yZXNpemUnLCcxJyl9KS5yZW5kZXIoKTt9KTtjb250ZXh0Lm1lbW8oJ2J1dHRvbi5pbWFnZVNpemU1MCcsZnVuY3Rpb24oKXtyZXR1cm4gdWkuYnV0dG9uKHtjb250ZW50czonPHNwYW4gY2xhc3M9XCJub3RlLWZvbnRzaXplLTEwXCI+NTAlPC9zcGFuPicsdG9vbHRpcDpsYW5nLmltYWdlLnJlc2l6ZUhhbGYsY2xpY2s6Y29udGV4dC5jcmVhdGVJbnZva2VIYW5kbGVyKCdlZGl0b3IucmVzaXplJywnMC41Jyl9KS5yZW5kZXIoKTt9KTtjb250ZXh0Lm1lbW8oJ2J1dHRvbi5pbWFnZVNpemUyNScsZnVuY3Rpb24oKXtyZXR1cm4gdWkuYnV0dG9uKHtjb250ZW50czonPHNwYW4gY2xhc3M9XCJub3RlLWZvbnRzaXplLTEwXCI+MjUlPC9zcGFuPicsdG9vbHRpcDpsYW5nLmltYWdlLnJlc2l6ZVF1YXJ0ZXIsY2xpY2s6Y29udGV4dC5jcmVhdGVJbnZva2VIYW5kbGVyKCdlZGl0b3IucmVzaXplJywnMC4yNScpfSkucmVuZGVyKCk7fSk7Ly8gRmxvYXQgQnV0dG9uc1xuY29udGV4dC5tZW1vKCdidXR0b24uZmxvYXRMZWZ0JyxmdW5jdGlvbigpe3JldHVybiB1aS5idXR0b24oe2NvbnRlbnRzOnVpLmljb24ob3B0aW9ucy5pY29ucy5hbGlnbkxlZnQpLHRvb2x0aXA6bGFuZy5pbWFnZS5mbG9hdExlZnQsY2xpY2s6Y29udGV4dC5jcmVhdGVJbnZva2VIYW5kbGVyKCdlZGl0b3IuZmxvYXRNZScsJ2xlZnQnKX0pLnJlbmRlcigpO30pO2NvbnRleHQubWVtbygnYnV0dG9uLmZsb2F0UmlnaHQnLGZ1bmN0aW9uKCl7cmV0dXJuIHVpLmJ1dHRvbih7Y29udGVudHM6dWkuaWNvbihvcHRpb25zLmljb25zLmFsaWduUmlnaHQpLHRvb2x0aXA6bGFuZy5pbWFnZS5mbG9hdFJpZ2h0LGNsaWNrOmNvbnRleHQuY3JlYXRlSW52b2tlSGFuZGxlcignZWRpdG9yLmZsb2F0TWUnLCdyaWdodCcpfSkucmVuZGVyKCk7fSk7Y29udGV4dC5tZW1vKCdidXR0b24uZmxvYXROb25lJyxmdW5jdGlvbigpe3JldHVybiB1aS5idXR0b24oe2NvbnRlbnRzOnVpLmljb24ob3B0aW9ucy5pY29ucy5hbGlnbkp1c3RpZnkpLHRvb2x0aXA6bGFuZy5pbWFnZS5mbG9hdE5vbmUsY2xpY2s6Y29udGV4dC5jcmVhdGVJbnZva2VIYW5kbGVyKCdlZGl0b3IuZmxvYXRNZScsJ25vbmUnKX0pLnJlbmRlcigpO30pOy8vIFJlbW92ZSBCdXR0b25zXG5jb250ZXh0Lm1lbW8oJ2J1dHRvbi5yZW1vdmVNZWRpYScsZnVuY3Rpb24oKXtyZXR1cm4gdWkuYnV0dG9uKHtjb250ZW50czp1aS5pY29uKG9wdGlvbnMuaWNvbnMudHJhc2gpLHRvb2x0aXA6bGFuZy5pbWFnZS5yZW1vdmUsY2xpY2s6Y29udGV4dC5jcmVhdGVJbnZva2VIYW5kbGVyKCdlZGl0b3IucmVtb3ZlTWVkaWEnKX0pLnJlbmRlcigpO30pO307dGhpcy5hZGRMaW5rUG9wb3ZlckJ1dHRvbnM9ZnVuY3Rpb24oKXtjb250ZXh0Lm1lbW8oJ2J1dHRvbi5saW5rRGlhbG9nU2hvdycsZnVuY3Rpb24oKXtyZXR1cm4gdWkuYnV0dG9uKHtjb250ZW50czp1aS5pY29uKG9wdGlvbnMuaWNvbnMubGluayksdG9vbHRpcDpsYW5nLmxpbmsuZWRpdCxjbGljazpjb250ZXh0LmNyZWF0ZUludm9rZUhhbmRsZXIoJ2xpbmtEaWFsb2cuc2hvdycpfSkucmVuZGVyKCk7fSk7Y29udGV4dC5tZW1vKCdidXR0b24udW5saW5rJyxmdW5jdGlvbigpe3JldHVybiB1aS5idXR0b24oe2NvbnRlbnRzOnVpLmljb24ob3B0aW9ucy5pY29ucy51bmxpbmspLHRvb2x0aXA6bGFuZy5saW5rLnVubGluayxjbGljazpjb250ZXh0LmNyZWF0ZUludm9rZUhhbmRsZXIoJ2VkaXRvci51bmxpbmsnKX0pLnJlbmRlcigpO30pO307dGhpcy5idWlsZD1mdW5jdGlvbigkY29udGFpbmVyLGdyb3Vwcyl7Zm9yKHZhciBncm91cElkeD0wLGdyb3VwTGVuPWdyb3Vwcy5sZW5ndGg7Z3JvdXBJZHg8Z3JvdXBMZW47Z3JvdXBJZHgrKyl7dmFyIGdyb3VwPWdyb3Vwc1tncm91cElkeF07dmFyIGdyb3VwTmFtZT1ncm91cFswXTt2YXIgYnV0dG9ucz1ncm91cFsxXTt2YXIgJGdyb3VwPXVpLmJ1dHRvbkdyb3VwKHtjbGFzc05hbWU6J25vdGUtJytncm91cE5hbWV9KS5yZW5kZXIoKTtmb3IodmFyIGlkeD0wLGxlbj1idXR0b25zLmxlbmd0aDtpZHg8bGVuO2lkeCsrKXt2YXIgYnV0dG9uPWNvbnRleHQubWVtbygnYnV0dG9uLicrYnV0dG9uc1tpZHhdKTtpZihidXR0b24peyRncm91cC5hcHBlbmQodHlwZW9mIGJ1dHRvbj09PSdmdW5jdGlvbic/YnV0dG9uKGNvbnRleHQpOmJ1dHRvbik7fX0kZ3JvdXAuYXBwZW5kVG8oJGNvbnRhaW5lcik7fX07dGhpcy51cGRhdGVDdXJyZW50U3R5bGU9ZnVuY3Rpb24oKXt2YXIgc3R5bGVJbmZvPWNvbnRleHQuaW52b2tlKCdlZGl0b3IuY3VycmVudFN0eWxlJyk7dGhpcy51cGRhdGVCdG5TdGF0ZXMoeycubm90ZS1idG4tYm9sZCc6ZnVuY3Rpb24oKXtyZXR1cm4gc3R5bGVJbmZvWydmb250LWJvbGQnXT09PSdib2xkJzt9LCcubm90ZS1idG4taXRhbGljJzpmdW5jdGlvbigpe3JldHVybiBzdHlsZUluZm9bJ2ZvbnQtaXRhbGljJ109PT0naXRhbGljJzt9LCcubm90ZS1idG4tdW5kZXJsaW5lJzpmdW5jdGlvbigpe3JldHVybiBzdHlsZUluZm9bJ2ZvbnQtdW5kZXJsaW5lJ109PT0ndW5kZXJsaW5lJzt9LCcubm90ZS1idG4tc3Vic2NyaXB0JzpmdW5jdGlvbigpe3JldHVybiBzdHlsZUluZm9bJ2ZvbnQtc3Vic2NyaXB0J109PT0nc3Vic2NyaXB0Jzt9LCcubm90ZS1idG4tc3VwZXJzY3JpcHQnOmZ1bmN0aW9uKCl7cmV0dXJuIHN0eWxlSW5mb1snZm9udC1zdXBlcnNjcmlwdCddPT09J3N1cGVyc2NyaXB0Jzt9LCcubm90ZS1idG4tc3RyaWtldGhyb3VnaCc6ZnVuY3Rpb24oKXtyZXR1cm4gc3R5bGVJbmZvWydmb250LXN0cmlrZXRocm91Z2gnXT09PSdzdHJpa2V0aHJvdWdoJzt9fSk7aWYoc3R5bGVJbmZvWydmb250LWZhbWlseSddKXt2YXIgZm9udE5hbWVzPXN0eWxlSW5mb1snZm9udC1mYW1pbHknXS5zcGxpdCgnLCcpLm1hcChmdW5jdGlvbihuYW1lKXtyZXR1cm4gbmFtZS5yZXBsYWNlKC9bXFwnXFxcIl0vZywnJykucmVwbGFjZSgvXFxzKyQvLCcnKS5yZXBsYWNlKC9eXFxzKy8sJycpO30pO3ZhciBmb250TmFtZT1saXN0LmZpbmQoZm9udE5hbWVzLHNlbGYuaXNGb250SW5zdGFsbGVkKTskdG9vbGJhci5maW5kKCcuZHJvcGRvd24tZm9udG5hbWUgbGkgYScpLmVhY2goZnVuY3Rpb24oKXsvLyBhbHdheXMgY29tcGFyZSBzdHJpbmcgdG8gYXZvaWQgY3JlYXRpbmcgYW5vdGhlciBmdW5jLlxudmFyIGlzQ2hlY2tlZD0kKHRoaXMpLmRhdGEoJ3ZhbHVlJykrJyc9PT1mb250TmFtZSsnJzt0aGlzLmNsYXNzTmFtZT1pc0NoZWNrZWQ/J2NoZWNrZWQnOicnO30pOyR0b29sYmFyLmZpbmQoJy5ub3RlLWN1cnJlbnQtZm9udG5hbWUnKS50ZXh0KGZvbnROYW1lKTt9aWYoc3R5bGVJbmZvWydmb250LXNpemUnXSl7dmFyIGZvbnRTaXplPXN0eWxlSW5mb1snZm9udC1zaXplJ107JHRvb2xiYXIuZmluZCgnLmRyb3Bkb3duLWZvbnRzaXplIGxpIGEnKS5lYWNoKGZ1bmN0aW9uKCl7Ly8gYWx3YXlzIGNvbXBhcmUgd2l0aCBzdHJpbmcgdG8gYXZvaWQgY3JlYXRpbmcgYW5vdGhlciBmdW5jLlxudmFyIGlzQ2hlY2tlZD0kKHRoaXMpLmRhdGEoJ3ZhbHVlJykrJyc9PT1mb250U2l6ZSsnJzt0aGlzLmNsYXNzTmFtZT1pc0NoZWNrZWQ/J2NoZWNrZWQnOicnO30pOyR0b29sYmFyLmZpbmQoJy5ub3RlLWN1cnJlbnQtZm9udHNpemUnKS50ZXh0KGZvbnRTaXplKTt9aWYoc3R5bGVJbmZvWydsaW5lLWhlaWdodCddKXt2YXIgbGluZUhlaWdodD1zdHlsZUluZm9bJ2xpbmUtaGVpZ2h0J107JHRvb2xiYXIuZmluZCgnLmRyb3Bkb3duLWxpbmUtaGVpZ2h0IGxpIGEnKS5lYWNoKGZ1bmN0aW9uKCl7Ly8gYWx3YXlzIGNvbXBhcmUgd2l0aCBzdHJpbmcgdG8gYXZvaWQgY3JlYXRpbmcgYW5vdGhlciBmdW5jLlxudmFyIGlzQ2hlY2tlZD0kKHRoaXMpLmRhdGEoJ3ZhbHVlJykrJyc9PT1saW5lSGVpZ2h0KycnO3RoaXMuY2xhc3NOYW1lPWlzQ2hlY2tlZD8nY2hlY2tlZCc6Jyc7fSk7fX07dGhpcy51cGRhdGVCdG5TdGF0ZXM9ZnVuY3Rpb24oaW5mb3MpeyQuZWFjaChpbmZvcyxmdW5jdGlvbihzZWxlY3RvcixwcmVkKXt1aS50b2dnbGVCdG5BY3RpdmUoJHRvb2xiYXIuZmluZChzZWxlY3RvcikscHJlZCgpKTt9KTt9O3RoaXMudGFibGVNb3ZlSGFuZGxlcj1mdW5jdGlvbihldmVudCl7dmFyIFBYX1BFUl9FTT0xODt2YXIgJHBpY2tlcj0kKGV2ZW50LnRhcmdldC5wYXJlbnROb2RlKTsvLyB0YXJnZXQgaXMgbW91c2VjYXRjaGVyXG52YXIgJGRpbWVuc2lvbkRpc3BsYXk9JHBpY2tlci5uZXh0KCk7dmFyICRjYXRjaGVyPSRwaWNrZXIuZmluZCgnLm5vdGUtZGltZW5zaW9uLXBpY2tlci1tb3VzZWNhdGNoZXInKTt2YXIgJGhpZ2hsaWdodGVkPSRwaWNrZXIuZmluZCgnLm5vdGUtZGltZW5zaW9uLXBpY2tlci1oaWdobGlnaHRlZCcpO3ZhciAkdW5oaWdobGlnaHRlZD0kcGlja2VyLmZpbmQoJy5ub3RlLWRpbWVuc2lvbi1waWNrZXItdW5oaWdobGlnaHRlZCcpO3ZhciBwb3NPZmZzZXQ7Ly8gSFRNTDUgd2l0aCBqUXVlcnkgLSBlLm9mZnNldFggaXMgdW5kZWZpbmVkIGluIEZpcmVmb3hcbmlmKGV2ZW50Lm9mZnNldFg9PT11bmRlZmluZWQpe3ZhciBwb3NDYXRjaGVyPSQoZXZlbnQudGFyZ2V0KS5vZmZzZXQoKTtwb3NPZmZzZXQ9e3g6ZXZlbnQucGFnZVgtcG9zQ2F0Y2hlci5sZWZ0LHk6ZXZlbnQucGFnZVktcG9zQ2F0Y2hlci50b3B9O31lbHNle3Bvc09mZnNldD17eDpldmVudC5vZmZzZXRYLHk6ZXZlbnQub2Zmc2V0WX07fXZhciBkaW09e2M6TWF0aC5jZWlsKHBvc09mZnNldC54L1BYX1BFUl9FTSl8fDEscjpNYXRoLmNlaWwocG9zT2Zmc2V0LnkvUFhfUEVSX0VNKXx8MX07JGhpZ2hsaWdodGVkLmNzcyh7d2lkdGg6ZGltLmMrJ2VtJyxoZWlnaHQ6ZGltLnIrJ2VtJ30pOyRjYXRjaGVyLmRhdGEoJ3ZhbHVlJyxkaW0uYysneCcrZGltLnIpO2lmKDM8ZGltLmMmJmRpbS5jPG9wdGlvbnMuaW5zZXJ0VGFibGVNYXhTaXplLmNvbCl7JHVuaGlnaGxpZ2h0ZWQuY3NzKHt3aWR0aDpkaW0uYysxKydlbSd9KTt9aWYoMzxkaW0uciYmZGltLnI8b3B0aW9ucy5pbnNlcnRUYWJsZU1heFNpemUucm93KXskdW5oaWdobGlnaHRlZC5jc3Moe2hlaWdodDpkaW0ucisxKydlbSd9KTt9JGRpbWVuc2lvbkRpc3BsYXkuaHRtbChkaW0uYysnIHggJytkaW0ucik7fTt9O3ZhciBUb29sYmFyPWZ1bmN0aW9uKGNvbnRleHQpe3ZhciB1aT0kLnN1bW1lcm5vdGUudWk7dmFyICRub3RlPWNvbnRleHQubGF5b3V0SW5mby5ub3RlO3ZhciAkdG9vbGJhcj1jb250ZXh0LmxheW91dEluZm8udG9vbGJhcjt2YXIgb3B0aW9ucz1jb250ZXh0Lm9wdGlvbnM7dGhpcy5zaG91bGRJbml0aWFsaXplPWZ1bmN0aW9uKCl7cmV0dXJuIW9wdGlvbnMuYWlyTW9kZTt9O3RoaXMuaW5pdGlhbGl6ZT1mdW5jdGlvbigpe29wdGlvbnMudG9vbGJhcj1vcHRpb25zLnRvb2xiYXJ8fFtdO2lmKCFvcHRpb25zLnRvb2xiYXIubGVuZ3RoKXskdG9vbGJhci5oaWRlKCk7fWVsc2V7Y29udGV4dC5pbnZva2UoJ2J1dHRvbnMuYnVpbGQnLCR0b29sYmFyLG9wdGlvbnMudG9vbGJhcik7fWlmKG9wdGlvbnMudG9vbGJhckNvbnRhaW5lcil7JHRvb2xiYXIuYXBwZW5kVG8ob3B0aW9ucy50b29sYmFyQ29udGFpbmVyKTt9JG5vdGUub24oJ3N1bW1lcm5vdGUua2V5dXAgc3VtbWVybm90ZS5tb3VzZXVwIHN1bW1lcm5vdGUuY2hhbmdlJyxmdW5jdGlvbigpe2NvbnRleHQuaW52b2tlKCdidXR0b25zLnVwZGF0ZUN1cnJlbnRTdHlsZScpO30pO2NvbnRleHQuaW52b2tlKCdidXR0b25zLnVwZGF0ZUN1cnJlbnRTdHlsZScpO307dGhpcy5kZXN0cm95PWZ1bmN0aW9uKCl7JHRvb2xiYXIuY2hpbGRyZW4oKS5yZW1vdmUoKTt9O3RoaXMudXBkYXRlRnVsbHNjcmVlbj1mdW5jdGlvbihpc0Z1bGxzY3JlZW4pe3VpLnRvZ2dsZUJ0bkFjdGl2ZSgkdG9vbGJhci5maW5kKCcuYnRuLWZ1bGxzY3JlZW4nKSxpc0Z1bGxzY3JlZW4pO307dGhpcy51cGRhdGVDb2Rldmlldz1mdW5jdGlvbihpc0NvZGV2aWV3KXt1aS50b2dnbGVCdG5BY3RpdmUoJHRvb2xiYXIuZmluZCgnLmJ0bi1jb2RldmlldycpLGlzQ29kZXZpZXcpO2lmKGlzQ29kZXZpZXcpe3RoaXMuZGVhY3RpdmF0ZSgpO31lbHNle3RoaXMuYWN0aXZhdGUoKTt9fTt0aGlzLmFjdGl2YXRlPWZ1bmN0aW9uKGlzSW5jbHVkZUNvZGV2aWV3KXt2YXIgJGJ0bj0kdG9vbGJhci5maW5kKCdidXR0b24nKTtpZighaXNJbmNsdWRlQ29kZXZpZXcpeyRidG49JGJ0bi5ub3QoJy5idG4tY29kZXZpZXcnKTt9dWkudG9nZ2xlQnRuKCRidG4sdHJ1ZSk7fTt0aGlzLmRlYWN0aXZhdGU9ZnVuY3Rpb24oaXNJbmNsdWRlQ29kZXZpZXcpe3ZhciAkYnRuPSR0b29sYmFyLmZpbmQoJ2J1dHRvbicpO2lmKCFpc0luY2x1ZGVDb2Rldmlldyl7JGJ0bj0kYnRuLm5vdCgnLmJ0bi1jb2RldmlldycpO311aS50b2dnbGVCdG4oJGJ0bixmYWxzZSk7fTt9O3ZhciBMaW5rRGlhbG9nPWZ1bmN0aW9uKGNvbnRleHQpe3ZhciBzZWxmPXRoaXM7dmFyIHVpPSQuc3VtbWVybm90ZS51aTt2YXIgJGVkaXRvcj1jb250ZXh0LmxheW91dEluZm8uZWRpdG9yO3ZhciBvcHRpb25zPWNvbnRleHQub3B0aW9uczt2YXIgbGFuZz1vcHRpb25zLmxhbmdJbmZvO3RoaXMuaW5pdGlhbGl6ZT1mdW5jdGlvbigpe3ZhciAkY29udGFpbmVyPW9wdGlvbnMuZGlhbG9nc0luQm9keT8kKGRvY3VtZW50LmJvZHkpOiRlZGl0b3I7dmFyIGJvZHk9JzxkaXYgY2xhc3M9XCJmb3JtLWdyb3VwXCI+JysnPGxhYmVsPicrbGFuZy5saW5rLnRleHRUb0Rpc3BsYXkrJzwvbGFiZWw+JysnPGlucHV0IGNsYXNzPVwibm90ZS1saW5rLXRleHQgZm9ybS1jb250cm9sXCIgdHlwZT1cInRleHRcIiAvPicrJzwvZGl2PicrJzxkaXYgY2xhc3M9XCJmb3JtLWdyb3VwXCI+JysnPGxhYmVsPicrbGFuZy5saW5rLnVybCsnPC9sYWJlbD4nKyc8aW5wdXQgY2xhc3M9XCJub3RlLWxpbmstdXJsIGZvcm0tY29udHJvbFwiIHR5cGU9XCJ0ZXh0XCIgdmFsdWU9XCJodHRwOi8vXCIgLz4nKyc8L2Rpdj4nKyghb3B0aW9ucy5kaXNhYmxlTGlua1RhcmdldD8nPGRpdiBjbGFzcz1cImNoZWNrYm94XCI+JysnPGxhYmVsPicrJzxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBjaGVja2VkPiAnK2xhbmcubGluay5vcGVuSW5OZXdXaW5kb3crJzwvbGFiZWw+JysnPC9kaXY+JzonJyk7dmFyIGZvb3Rlcj0nPGJ1dHRvbiBocmVmPVwiI1wiIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IG5vdGUtbGluay1idG4gZGlzYWJsZWRcIiBkaXNhYmxlZD4nK2xhbmcubGluay5pbnNlcnQrJzwvYnV0dG9uPic7dGhpcy4kZGlhbG9nPXVpLmRpYWxvZyh7Y2xhc3NOYW1lOidsaW5rLWRpYWxvZycsdGl0bGU6bGFuZy5saW5rLmluc2VydCxmYWRlOm9wdGlvbnMuZGlhbG9nc0ZhZGUsYm9keTpib2R5LGZvb3Rlcjpmb290ZXJ9KS5yZW5kZXIoKS5hcHBlbmRUbygkY29udGFpbmVyKTt9O3RoaXMuZGVzdHJveT1mdW5jdGlvbigpe3VpLmhpZGVEaWFsb2codGhpcy4kZGlhbG9nKTt0aGlzLiRkaWFsb2cucmVtb3ZlKCk7fTt0aGlzLmJpbmRFbnRlcktleT1mdW5jdGlvbigkaW5wdXQsJGJ0bil7JGlucHV0Lm9uKCdrZXlwcmVzcycsZnVuY3Rpb24oZXZlbnQpe2lmKGV2ZW50LmtleUNvZGU9PT1rZXkuY29kZS5FTlRFUil7JGJ0bi50cmlnZ2VyKCdjbGljaycpO319KTt9Oy8qKlxuICAgICAqIHRvZ2dsZSB1cGRhdGUgYnV0dG9uXG4gICAgICovdGhpcy50b2dnbGVMaW5rQnRuPWZ1bmN0aW9uKCRsaW5rQnRuLCRsaW5rVGV4dCwkbGlua1VybCl7dWkudG9nZ2xlQnRuKCRsaW5rQnRuLCRsaW5rVGV4dC52YWwoKSYmJGxpbmtVcmwudmFsKCkpO307LyoqXG4gICAgICogU2hvdyBsaW5rIGRpYWxvZyBhbmQgc2V0IGV2ZW50IGhhbmRsZXJzIG9uIGRpYWxvZyBjb250cm9scy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBsaW5rSW5mb1xuICAgICAqIEByZXR1cm4ge1Byb21pc2V9XG4gICAgICovdGhpcy5zaG93TGlua0RpYWxvZz1mdW5jdGlvbihsaW5rSW5mbyl7cmV0dXJuICQuRGVmZXJyZWQoZnVuY3Rpb24oZGVmZXJyZWQpe3ZhciAkbGlua1RleHQ9c2VsZi4kZGlhbG9nLmZpbmQoJy5ub3RlLWxpbmstdGV4dCcpLCRsaW5rVXJsPXNlbGYuJGRpYWxvZy5maW5kKCcubm90ZS1saW5rLXVybCcpLCRsaW5rQnRuPXNlbGYuJGRpYWxvZy5maW5kKCcubm90ZS1saW5rLWJ0bicpLCRvcGVuSW5OZXdXaW5kb3c9c2VsZi4kZGlhbG9nLmZpbmQoJ2lucHV0W3R5cGU9Y2hlY2tib3hdJyk7dWkub25EaWFsb2dTaG93bihzZWxmLiRkaWFsb2csZnVuY3Rpb24oKXtjb250ZXh0LnRyaWdnZXJFdmVudCgnZGlhbG9nLnNob3duJyk7Ly8gaWYgbm8gdXJsIHdhcyBnaXZlbiwgY29weSB0ZXh0IHRvIHVybFxuaWYoIWxpbmtJbmZvLnVybCl7bGlua0luZm8udXJsPWxpbmtJbmZvLnRleHQ7fSRsaW5rVGV4dC52YWwobGlua0luZm8udGV4dCk7dmFyIGhhbmRsZUxpbmtUZXh0VXBkYXRlPWZ1bmN0aW9uKCl7c2VsZi50b2dnbGVMaW5rQnRuKCRsaW5rQnRuLCRsaW5rVGV4dCwkbGlua1VybCk7Ly8gaWYgbGlua3RleHQgd2FzIG1vZGlmaWVkIGJ5IGtleXVwLFxuLy8gc3RvcCBjbG9uaW5nIHRleHQgZnJvbSBsaW5rVXJsXG5saW5rSW5mby50ZXh0PSRsaW5rVGV4dC52YWwoKTt9OyRsaW5rVGV4dC5vbignaW5wdXQnLGhhbmRsZUxpbmtUZXh0VXBkYXRlKS5vbigncGFzdGUnLGZ1bmN0aW9uKCl7c2V0VGltZW91dChoYW5kbGVMaW5rVGV4dFVwZGF0ZSwwKTt9KTt2YXIgaGFuZGxlTGlua1VybFVwZGF0ZT1mdW5jdGlvbigpe3NlbGYudG9nZ2xlTGlua0J0bigkbGlua0J0biwkbGlua1RleHQsJGxpbmtVcmwpOy8vIGRpc3BsYXkgc2FtZSBsaW5rIG9uIGBUZXh0IHRvIGRpc3BsYXlgIGlucHV0XG4vLyB3aGVuIGNyZWF0ZSBhIG5ldyBsaW5rXG5pZighbGlua0luZm8udGV4dCl7JGxpbmtUZXh0LnZhbCgkbGlua1VybC52YWwoKSk7fX07JGxpbmtVcmwub24oJ2lucHV0JyxoYW5kbGVMaW5rVXJsVXBkYXRlKS5vbigncGFzdGUnLGZ1bmN0aW9uKCl7c2V0VGltZW91dChoYW5kbGVMaW5rVXJsVXBkYXRlLDApO30pLnZhbChsaW5rSW5mby51cmwpLnRyaWdnZXIoJ2ZvY3VzJyk7c2VsZi50b2dnbGVMaW5rQnRuKCRsaW5rQnRuLCRsaW5rVGV4dCwkbGlua1VybCk7c2VsZi5iaW5kRW50ZXJLZXkoJGxpbmtVcmwsJGxpbmtCdG4pO3NlbGYuYmluZEVudGVyS2V5KCRsaW5rVGV4dCwkbGlua0J0bik7JG9wZW5Jbk5ld1dpbmRvdy5wcm9wKCdjaGVja2VkJyxsaW5rSW5mby5pc05ld1dpbmRvdyk7JGxpbmtCdG4ub25lKCdjbGljaycsZnVuY3Rpb24oZXZlbnQpe2V2ZW50LnByZXZlbnREZWZhdWx0KCk7ZGVmZXJyZWQucmVzb2x2ZSh7cmFuZ2U6bGlua0luZm8ucmFuZ2UsdXJsOiRsaW5rVXJsLnZhbCgpLHRleHQ6JGxpbmtUZXh0LnZhbCgpLGlzTmV3V2luZG93OiRvcGVuSW5OZXdXaW5kb3cuaXMoJzpjaGVja2VkJyl9KTtzZWxmLiRkaWFsb2cubW9kYWwoJ2hpZGUnKTt9KTt9KTt1aS5vbkRpYWxvZ0hpZGRlbihzZWxmLiRkaWFsb2csZnVuY3Rpb24oKXsvLyBkZXRhY2ggZXZlbnRzXG4kbGlua1RleHQub2ZmKCdpbnB1dCBwYXN0ZSBrZXlwcmVzcycpOyRsaW5rVXJsLm9mZignaW5wdXQgcGFzdGUga2V5cHJlc3MnKTskbGlua0J0bi5vZmYoJ2NsaWNrJyk7aWYoZGVmZXJyZWQuc3RhdGUoKT09PSdwZW5kaW5nJyl7ZGVmZXJyZWQucmVqZWN0KCk7fX0pO3VpLnNob3dEaWFsb2coc2VsZi4kZGlhbG9nKTt9KS5wcm9taXNlKCk7fTsvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gbGF5b3V0SW5mb1xuICAgICAqL3RoaXMuc2hvdz1mdW5jdGlvbigpe3ZhciBsaW5rSW5mbz1jb250ZXh0Lmludm9rZSgnZWRpdG9yLmdldExpbmtJbmZvJyk7Y29udGV4dC5pbnZva2UoJ2VkaXRvci5zYXZlUmFuZ2UnKTt0aGlzLnNob3dMaW5rRGlhbG9nKGxpbmtJbmZvKS50aGVuKGZ1bmN0aW9uKGxpbmtJbmZvKXtjb250ZXh0Lmludm9rZSgnZWRpdG9yLnJlc3RvcmVSYW5nZScpO2NvbnRleHQuaW52b2tlKCdlZGl0b3IuY3JlYXRlTGluaycsbGlua0luZm8pO30pLmZhaWwoZnVuY3Rpb24oKXtjb250ZXh0Lmludm9rZSgnZWRpdG9yLnJlc3RvcmVSYW5nZScpO30pO307Y29udGV4dC5tZW1vKCdoZWxwLmxpbmtEaWFsb2cuc2hvdycsb3B0aW9ucy5sYW5nSW5mby5oZWxwWydsaW5rRGlhbG9nLnNob3cnXSk7fTt2YXIgTGlua1BvcG92ZXI9ZnVuY3Rpb24oY29udGV4dCl7dmFyIHNlbGY9dGhpczt2YXIgdWk9JC5zdW1tZXJub3RlLnVpO3ZhciBvcHRpb25zPWNvbnRleHQub3B0aW9uczt0aGlzLmV2ZW50cz17J3N1bW1lcm5vdGUua2V5dXAgc3VtbWVybm90ZS5tb3VzZXVwIHN1bW1lcm5vdGUuY2hhbmdlIHN1bW1lcm5vdGUuc2Nyb2xsJzpmdW5jdGlvbigpe3NlbGYudXBkYXRlKCk7fSwnc3VtbWVybm90ZS5kaWFsb2cuc2hvd24nOmZ1bmN0aW9uKCl7c2VsZi5oaWRlKCk7fX07dGhpcy5zaG91bGRJbml0aWFsaXplPWZ1bmN0aW9uKCl7cmV0dXJuIWxpc3QuaXNFbXB0eShvcHRpb25zLnBvcG92ZXIubGluayk7fTt0aGlzLmluaXRpYWxpemU9ZnVuY3Rpb24oKXt0aGlzLiRwb3BvdmVyPXVpLnBvcG92ZXIoe2NsYXNzTmFtZTonbm90ZS1saW5rLXBvcG92ZXInLGNhbGxiYWNrOmZ1bmN0aW9uKCRub2RlKXt2YXIgJGNvbnRlbnQ9JG5vZGUuZmluZCgnLnBvcG92ZXItY29udGVudCcpOyRjb250ZW50LnByZXBlbmQoJzxzcGFuPjxhIHRhcmdldD1cIl9ibGFua1wiPjwvYT4mbmJzcDs8L3NwYW4+Jyk7fX0pLnJlbmRlcigpLmFwcGVuZFRvKCdib2R5Jyk7dmFyICRjb250ZW50PXRoaXMuJHBvcG92ZXIuZmluZCgnLnBvcG92ZXItY29udGVudCcpO2NvbnRleHQuaW52b2tlKCdidXR0b25zLmJ1aWxkJywkY29udGVudCxvcHRpb25zLnBvcG92ZXIubGluayk7fTt0aGlzLmRlc3Ryb3k9ZnVuY3Rpb24oKXt0aGlzLiRwb3BvdmVyLnJlbW92ZSgpO307dGhpcy51cGRhdGU9ZnVuY3Rpb24oKXsvLyBQcmV2ZW50IGZvY3VzaW5nIG9uIGVkaXRhYmxlIHdoZW4gaW52b2tlKCdjb2RlJykgaXMgZXhlY3V0ZWRcbmlmKCFjb250ZXh0Lmludm9rZSgnZWRpdG9yLmhhc0ZvY3VzJykpe3RoaXMuaGlkZSgpO3JldHVybjt9dmFyIHJuZz1jb250ZXh0Lmludm9rZSgnZWRpdG9yLmNyZWF0ZVJhbmdlJyk7aWYocm5nLmlzQ29sbGFwc2VkKCkmJnJuZy5pc09uQW5jaG9yKCkpe3ZhciBhbmNob3I9ZG9tLmFuY2VzdG9yKHJuZy5zYyxkb20uaXNBbmNob3IpO3ZhciBocmVmPSQoYW5jaG9yKS5hdHRyKCdocmVmJyk7dGhpcy4kcG9wb3Zlci5maW5kKCdhJykuYXR0cignaHJlZicsaHJlZikuaHRtbChocmVmKTt2YXIgcG9zPWRvbS5wb3NGcm9tUGxhY2Vob2xkZXIoYW5jaG9yKTt0aGlzLiRwb3BvdmVyLmNzcyh7ZGlzcGxheTonYmxvY2snLGxlZnQ6cG9zLmxlZnQsdG9wOnBvcy50b3B9KTt9ZWxzZXt0aGlzLmhpZGUoKTt9fTt0aGlzLmhpZGU9ZnVuY3Rpb24oKXt0aGlzLiRwb3BvdmVyLmhpZGUoKTt9O307dmFyIEltYWdlRGlhbG9nPWZ1bmN0aW9uKGNvbnRleHQpe3ZhciBzZWxmPXRoaXM7dmFyIHVpPSQuc3VtbWVybm90ZS51aTt2YXIgJGVkaXRvcj1jb250ZXh0LmxheW91dEluZm8uZWRpdG9yO3ZhciBvcHRpb25zPWNvbnRleHQub3B0aW9uczt2YXIgbGFuZz1vcHRpb25zLmxhbmdJbmZvO3RoaXMuaW5pdGlhbGl6ZT1mdW5jdGlvbigpe3ZhciAkY29udGFpbmVyPW9wdGlvbnMuZGlhbG9nc0luQm9keT8kKGRvY3VtZW50LmJvZHkpOiRlZGl0b3I7dmFyIGltYWdlTGltaXRhdGlvbj0nJztpZihvcHRpb25zLm1heGltdW1JbWFnZUZpbGVTaXplKXt2YXIgdW5pdD1NYXRoLmZsb29yKE1hdGgubG9nKG9wdGlvbnMubWF4aW11bUltYWdlRmlsZVNpemUpL01hdGgubG9nKDEwMjQpKTt2YXIgcmVhZGFibGVTaXplPShvcHRpb25zLm1heGltdW1JbWFnZUZpbGVTaXplL01hdGgucG93KDEwMjQsdW5pdCkpLnRvRml4ZWQoMikqMSsnICcrJyBLTUdUUCdbdW5pdF0rJ0InO2ltYWdlTGltaXRhdGlvbj0nPHNtYWxsPicrbGFuZy5pbWFnZS5tYXhpbXVtRmlsZVNpemUrJyA6ICcrcmVhZGFibGVTaXplKyc8L3NtYWxsPic7fXZhciBib2R5PSc8ZGl2IGNsYXNzPVwiZm9ybS1ncm91cCBub3RlLWdyb3VwLXNlbGVjdC1mcm9tLWZpbGVzXCI+JysnPGxhYmVsPicrbGFuZy5pbWFnZS5zZWxlY3RGcm9tRmlsZXMrJzwvbGFiZWw+JysnPGlucHV0IGNsYXNzPVwibm90ZS1pbWFnZS1pbnB1dCBmb3JtLWNvbnRyb2xcIiB0eXBlPVwiZmlsZVwiIG5hbWU9XCJmaWxlc1wiIGFjY2VwdD1cImltYWdlLypcIiBtdWx0aXBsZT1cIm11bHRpcGxlXCIgLz4nK2ltYWdlTGltaXRhdGlvbisnPC9kaXY+JysnPGRpdiBjbGFzcz1cImZvcm0tZ3JvdXAgbm90ZS1ncm91cC1pbWFnZS11cmxcIiBzdHlsZT1cIm92ZXJmbG93OmF1dG87XCI+JysnPGxhYmVsPicrbGFuZy5pbWFnZS51cmwrJzwvbGFiZWw+JysnPGlucHV0IGNsYXNzPVwibm90ZS1pbWFnZS11cmwgZm9ybS1jb250cm9sIGNvbC1tZC0xMlwiIHR5cGU9XCJ0ZXh0XCIgLz4nKyc8L2Rpdj4nO3ZhciBmb290ZXI9JzxidXR0b24gaHJlZj1cIiNcIiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeSBub3RlLWltYWdlLWJ0biBkaXNhYmxlZFwiIGRpc2FibGVkPicrbGFuZy5pbWFnZS5pbnNlcnQrJzwvYnV0dG9uPic7dGhpcy4kZGlhbG9nPXVpLmRpYWxvZyh7dGl0bGU6bGFuZy5pbWFnZS5pbnNlcnQsZmFkZTpvcHRpb25zLmRpYWxvZ3NGYWRlLGJvZHk6Ym9keSxmb290ZXI6Zm9vdGVyfSkucmVuZGVyKCkuYXBwZW5kVG8oJGNvbnRhaW5lcik7fTt0aGlzLmRlc3Ryb3k9ZnVuY3Rpb24oKXt1aS5oaWRlRGlhbG9nKHRoaXMuJGRpYWxvZyk7dGhpcy4kZGlhbG9nLnJlbW92ZSgpO307dGhpcy5iaW5kRW50ZXJLZXk9ZnVuY3Rpb24oJGlucHV0LCRidG4peyRpbnB1dC5vbigna2V5cHJlc3MnLGZ1bmN0aW9uKGV2ZW50KXtpZihldmVudC5rZXlDb2RlPT09a2V5LmNvZGUuRU5URVIpeyRidG4udHJpZ2dlcignY2xpY2snKTt9fSk7fTt0aGlzLnNob3c9ZnVuY3Rpb24oKXtjb250ZXh0Lmludm9rZSgnZWRpdG9yLnNhdmVSYW5nZScpO3RoaXMuc2hvd0ltYWdlRGlhbG9nKCkudGhlbihmdW5jdGlvbihkYXRhKXsvLyBbd29ya2Fyb3VuZF0gaGlkZSBkaWFsb2cgYmVmb3JlIHJlc3RvcmUgcmFuZ2UgZm9yIElFIHJhbmdlIGZvY3VzXG51aS5oaWRlRGlhbG9nKHNlbGYuJGRpYWxvZyk7Y29udGV4dC5pbnZva2UoJ2VkaXRvci5yZXN0b3JlUmFuZ2UnKTtpZih0eXBlb2YgZGF0YT09PSdzdHJpbmcnKXsvLyBpbWFnZSB1cmxcbmNvbnRleHQuaW52b2tlKCdlZGl0b3IuaW5zZXJ0SW1hZ2UnLGRhdGEpO31lbHNley8vIGFycmF5IG9mIGZpbGVzXG5jb250ZXh0Lmludm9rZSgnZWRpdG9yLmluc2VydEltYWdlc09yQ2FsbGJhY2snLGRhdGEpO319KS5mYWlsKGZ1bmN0aW9uKCl7Y29udGV4dC5pbnZva2UoJ2VkaXRvci5yZXN0b3JlUmFuZ2UnKTt9KTt9Oy8qKlxuICAgICAqIHNob3cgaW1hZ2UgZGlhbG9nXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2pRdWVyeX0gJGRpYWxvZ1xuICAgICAqIEByZXR1cm4ge1Byb21pc2V9XG4gICAgICovdGhpcy5zaG93SW1hZ2VEaWFsb2c9ZnVuY3Rpb24oKXtyZXR1cm4gJC5EZWZlcnJlZChmdW5jdGlvbihkZWZlcnJlZCl7dmFyICRpbWFnZUlucHV0PXNlbGYuJGRpYWxvZy5maW5kKCcubm90ZS1pbWFnZS1pbnB1dCcpLCRpbWFnZVVybD1zZWxmLiRkaWFsb2cuZmluZCgnLm5vdGUtaW1hZ2UtdXJsJyksJGltYWdlQnRuPXNlbGYuJGRpYWxvZy5maW5kKCcubm90ZS1pbWFnZS1idG4nKTt1aS5vbkRpYWxvZ1Nob3duKHNlbGYuJGRpYWxvZyxmdW5jdGlvbigpe2NvbnRleHQudHJpZ2dlckV2ZW50KCdkaWFsb2cuc2hvd24nKTsvLyBDbG9uaW5nIGltYWdlSW5wdXQgdG8gY2xlYXIgZWxlbWVudC5cbiRpbWFnZUlucHV0LnJlcGxhY2VXaXRoKCRpbWFnZUlucHV0LmNsb25lKCkub24oJ2NoYW5nZScsZnVuY3Rpb24oKXtkZWZlcnJlZC5yZXNvbHZlKHRoaXMuZmlsZXN8fHRoaXMudmFsdWUpO30pLnZhbCgnJykpOyRpbWFnZUJ0bi5jbGljayhmdW5jdGlvbihldmVudCl7ZXZlbnQucHJldmVudERlZmF1bHQoKTtkZWZlcnJlZC5yZXNvbHZlKCRpbWFnZVVybC52YWwoKSk7fSk7JGltYWdlVXJsLm9uKCdrZXl1cCBwYXN0ZScsZnVuY3Rpb24oKXt2YXIgdXJsPSRpbWFnZVVybC52YWwoKTt1aS50b2dnbGVCdG4oJGltYWdlQnRuLHVybCk7fSkudmFsKCcnKS50cmlnZ2VyKCdmb2N1cycpO3NlbGYuYmluZEVudGVyS2V5KCRpbWFnZVVybCwkaW1hZ2VCdG4pO30pO3VpLm9uRGlhbG9nSGlkZGVuKHNlbGYuJGRpYWxvZyxmdW5jdGlvbigpeyRpbWFnZUlucHV0Lm9mZignY2hhbmdlJyk7JGltYWdlVXJsLm9mZigna2V5dXAgcGFzdGUga2V5cHJlc3MnKTskaW1hZ2VCdG4ub2ZmKCdjbGljaycpO2lmKGRlZmVycmVkLnN0YXRlKCk9PT0ncGVuZGluZycpe2RlZmVycmVkLnJlamVjdCgpO319KTt1aS5zaG93RGlhbG9nKHNlbGYuJGRpYWxvZyk7fSk7fTt9O3ZhciBJbWFnZVBvcG92ZXI9ZnVuY3Rpb24oY29udGV4dCl7dmFyIHVpPSQuc3VtbWVybm90ZS51aTt2YXIgb3B0aW9ucz1jb250ZXh0Lm9wdGlvbnM7dGhpcy5zaG91bGRJbml0aWFsaXplPWZ1bmN0aW9uKCl7cmV0dXJuIWxpc3QuaXNFbXB0eShvcHRpb25zLnBvcG92ZXIuaW1hZ2UpO307dGhpcy5pbml0aWFsaXplPWZ1bmN0aW9uKCl7dGhpcy4kcG9wb3Zlcj11aS5wb3BvdmVyKHtjbGFzc05hbWU6J25vdGUtaW1hZ2UtcG9wb3Zlcid9KS5yZW5kZXIoKS5hcHBlbmRUbygnYm9keScpO3ZhciAkY29udGVudD10aGlzLiRwb3BvdmVyLmZpbmQoJy5wb3BvdmVyLWNvbnRlbnQnKTtjb250ZXh0Lmludm9rZSgnYnV0dG9ucy5idWlsZCcsJGNvbnRlbnQsb3B0aW9ucy5wb3BvdmVyLmltYWdlKTt9O3RoaXMuZGVzdHJveT1mdW5jdGlvbigpe3RoaXMuJHBvcG92ZXIucmVtb3ZlKCk7fTt0aGlzLnVwZGF0ZT1mdW5jdGlvbih0YXJnZXQpe2lmKGRvbS5pc0ltZyh0YXJnZXQpKXt2YXIgcG9zPWRvbS5wb3NGcm9tUGxhY2Vob2xkZXIodGFyZ2V0KTt0aGlzLiRwb3BvdmVyLmNzcyh7ZGlzcGxheTonYmxvY2snLGxlZnQ6cG9zLmxlZnQsdG9wOnBvcy50b3B9KTt9ZWxzZXt0aGlzLmhpZGUoKTt9fTt0aGlzLmhpZGU9ZnVuY3Rpb24oKXt0aGlzLiRwb3BvdmVyLmhpZGUoKTt9O307dmFyIFZpZGVvRGlhbG9nPWZ1bmN0aW9uKGNvbnRleHQpe3ZhciBzZWxmPXRoaXM7dmFyIHVpPSQuc3VtbWVybm90ZS51aTt2YXIgJGVkaXRvcj1jb250ZXh0LmxheW91dEluZm8uZWRpdG9yO3ZhciBvcHRpb25zPWNvbnRleHQub3B0aW9uczt2YXIgbGFuZz1vcHRpb25zLmxhbmdJbmZvO3RoaXMuaW5pdGlhbGl6ZT1mdW5jdGlvbigpe3ZhciAkY29udGFpbmVyPW9wdGlvbnMuZGlhbG9nc0luQm9keT8kKGRvY3VtZW50LmJvZHkpOiRlZGl0b3I7dmFyIGJvZHk9JzxkaXYgY2xhc3M9XCJmb3JtLWdyb3VwIHJvdy1mbHVpZFwiPicrJzxsYWJlbD4nK2xhbmcudmlkZW8udXJsKycgPHNtYWxsIGNsYXNzPVwidGV4dC1tdXRlZFwiPicrbGFuZy52aWRlby5wcm92aWRlcnMrJzwvc21hbGw+PC9sYWJlbD4nKyc8aW5wdXQgY2xhc3M9XCJub3RlLXZpZGVvLXVybCBmb3JtLWNvbnRyb2wgc3BhbjEyXCIgdHlwZT1cInRleHRcIiAvPicrJzwvZGl2Pic7dmFyIGZvb3Rlcj0nPGJ1dHRvbiBocmVmPVwiI1wiIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IG5vdGUtdmlkZW8tYnRuIGRpc2FibGVkXCIgZGlzYWJsZWQ+JytsYW5nLnZpZGVvLmluc2VydCsnPC9idXR0b24+Jzt0aGlzLiRkaWFsb2c9dWkuZGlhbG9nKHt0aXRsZTpsYW5nLnZpZGVvLmluc2VydCxmYWRlOm9wdGlvbnMuZGlhbG9nc0ZhZGUsYm9keTpib2R5LGZvb3Rlcjpmb290ZXJ9KS5yZW5kZXIoKS5hcHBlbmRUbygkY29udGFpbmVyKTt9O3RoaXMuZGVzdHJveT1mdW5jdGlvbigpe3VpLmhpZGVEaWFsb2codGhpcy4kZGlhbG9nKTt0aGlzLiRkaWFsb2cucmVtb3ZlKCk7fTt0aGlzLmJpbmRFbnRlcktleT1mdW5jdGlvbigkaW5wdXQsJGJ0bil7JGlucHV0Lm9uKCdrZXlwcmVzcycsZnVuY3Rpb24oZXZlbnQpe2lmKGV2ZW50LmtleUNvZGU9PT1rZXkuY29kZS5FTlRFUil7JGJ0bi50cmlnZ2VyKCdjbGljaycpO319KTt9O3RoaXMuY3JlYXRlVmlkZW9Ob2RlPWZ1bmN0aW9uKHVybCl7Ly8gdmlkZW8gdXJsIHBhdHRlcm5zKHlvdXR1YmUsIGluc3RhZ3JhbSwgdmltZW8sIGRhaWx5bW90aW9uLCB5b3VrdSwgbXA0LCBvZ2csIHdlYm0pXG52YXIgeXRSZWdFeHA9L14oPzpodHRwcz86XFwvXFwvKT8oPzp3d3dcXC4pPyg/OnlvdXR1XFwuYmVcXC98eW91dHViZVxcLmNvbVxcLyg/OmVtYmVkXFwvfHZcXC98d2F0Y2hcXD92PXx3YXRjaFxcPy4rJnY9KSkoKFxcd3wtKXsxMX0pKD86XFxTKyk/JC87dmFyIHl0TWF0Y2g9dXJsLm1hdGNoKHl0UmVnRXhwKTt2YXIgaWdSZWdFeHA9Lyg/Ond3d1xcLnxcXC9cXC8paW5zdGFncmFtXFwuY29tXFwvcFxcLyguW2EtekEtWjAtOV8tXSopLzt2YXIgaWdNYXRjaD11cmwubWF0Y2goaWdSZWdFeHApO3ZhciB2UmVnRXhwPS9cXC9cXC92aW5lXFwuY29cXC92XFwvKFthLXpBLVowLTldKykvO3ZhciB2TWF0Y2g9dXJsLm1hdGNoKHZSZWdFeHApO3ZhciB2aW1SZWdFeHA9L1xcL1xcLyhwbGF5ZXJcXC4pP3ZpbWVvXFwuY29tXFwvKFthLXpdKlxcLykqKFswLTldezYsMTF9KVs/XT8uKi87dmFyIHZpbU1hdGNoPXVybC5tYXRjaCh2aW1SZWdFeHApO3ZhciBkbVJlZ0V4cD0vLitkYWlseW1vdGlvbi5jb21cXC8odmlkZW98aHViKVxcLyhbXl9dKylbXiNdKigjdmlkZW89KFteXyZdKykpPy87dmFyIGRtTWF0Y2g9dXJsLm1hdGNoKGRtUmVnRXhwKTt2YXIgeW91a3VSZWdFeHA9L1xcL1xcL3ZcXC55b3VrdVxcLmNvbVxcL3Zfc2hvd1xcL2lkXyhcXHcrKT0qXFwuaHRtbC87dmFyIHlvdWt1TWF0Y2g9dXJsLm1hdGNoKHlvdWt1UmVnRXhwKTt2YXIgbXA0UmVnRXhwPS9eLisuKG1wNHxtNHYpJC87dmFyIG1wNE1hdGNoPXVybC5tYXRjaChtcDRSZWdFeHApO3ZhciBvZ2dSZWdFeHA9L14uKy4ob2dnfG9ndikkLzt2YXIgb2dnTWF0Y2g9dXJsLm1hdGNoKG9nZ1JlZ0V4cCk7dmFyIHdlYm1SZWdFeHA9L14uKy4od2VibSkkLzt2YXIgd2VibU1hdGNoPXVybC5tYXRjaCh3ZWJtUmVnRXhwKTt2YXIgJHZpZGVvO2lmKHl0TWF0Y2gmJnl0TWF0Y2hbMV0ubGVuZ3RoPT09MTEpe3ZhciB5b3V0dWJlSWQ9eXRNYXRjaFsxXTskdmlkZW89JCgnPGlmcmFtZT4nKS5hdHRyKCdmcmFtZWJvcmRlcicsMCkuYXR0cignc3JjJywnLy93d3cueW91dHViZS5jb20vZW1iZWQvJyt5b3V0dWJlSWQpLmF0dHIoJ3dpZHRoJywnNjQwJykuYXR0cignaGVpZ2h0JywnMzYwJyk7fWVsc2UgaWYoaWdNYXRjaCYmaWdNYXRjaFswXS5sZW5ndGgpeyR2aWRlbz0kKCc8aWZyYW1lPicpLmF0dHIoJ2ZyYW1lYm9yZGVyJywwKS5hdHRyKCdzcmMnLCdodHRwczovL2luc3RhZ3JhbS5jb20vcC8nK2lnTWF0Y2hbMV0rJy9lbWJlZC8nKS5hdHRyKCd3aWR0aCcsJzYxMicpLmF0dHIoJ2hlaWdodCcsJzcxMCcpLmF0dHIoJ3Njcm9sbGluZycsJ25vJykuYXR0cignYWxsb3d0cmFuc3BhcmVuY3knLCd0cnVlJyk7fWVsc2UgaWYodk1hdGNoJiZ2TWF0Y2hbMF0ubGVuZ3RoKXskdmlkZW89JCgnPGlmcmFtZT4nKS5hdHRyKCdmcmFtZWJvcmRlcicsMCkuYXR0cignc3JjJyx2TWF0Y2hbMF0rJy9lbWJlZC9zaW1wbGUnKS5hdHRyKCd3aWR0aCcsJzYwMCcpLmF0dHIoJ2hlaWdodCcsJzYwMCcpLmF0dHIoJ2NsYXNzJywndmluZS1lbWJlZCcpO31lbHNlIGlmKHZpbU1hdGNoJiZ2aW1NYXRjaFszXS5sZW5ndGgpeyR2aWRlbz0kKCc8aWZyYW1lIHdlYmtpdGFsbG93ZnVsbHNjcmVlbiBtb3phbGxvd2Z1bGxzY3JlZW4gYWxsb3dmdWxsc2NyZWVuPicpLmF0dHIoJ2ZyYW1lYm9yZGVyJywwKS5hdHRyKCdzcmMnLCcvL3BsYXllci52aW1lby5jb20vdmlkZW8vJyt2aW1NYXRjaFszXSkuYXR0cignd2lkdGgnLCc2NDAnKS5hdHRyKCdoZWlnaHQnLCczNjAnKTt9ZWxzZSBpZihkbU1hdGNoJiZkbU1hdGNoWzJdLmxlbmd0aCl7JHZpZGVvPSQoJzxpZnJhbWU+JykuYXR0cignZnJhbWVib3JkZXInLDApLmF0dHIoJ3NyYycsJy8vd3d3LmRhaWx5bW90aW9uLmNvbS9lbWJlZC92aWRlby8nK2RtTWF0Y2hbMl0pLmF0dHIoJ3dpZHRoJywnNjQwJykuYXR0cignaGVpZ2h0JywnMzYwJyk7fWVsc2UgaWYoeW91a3VNYXRjaCYmeW91a3VNYXRjaFsxXS5sZW5ndGgpeyR2aWRlbz0kKCc8aWZyYW1lIHdlYmtpdGFsbG93ZnVsbHNjcmVlbiBtb3phbGxvd2Z1bGxzY3JlZW4gYWxsb3dmdWxsc2NyZWVuPicpLmF0dHIoJ2ZyYW1lYm9yZGVyJywwKS5hdHRyKCdoZWlnaHQnLCc0OTgnKS5hdHRyKCd3aWR0aCcsJzUxMCcpLmF0dHIoJ3NyYycsJy8vcGxheWVyLnlvdWt1LmNvbS9lbWJlZC8nK3lvdWt1TWF0Y2hbMV0pO31lbHNlIGlmKG1wNE1hdGNofHxvZ2dNYXRjaHx8d2VibU1hdGNoKXskdmlkZW89JCgnPHZpZGVvIGNvbnRyb2xzPicpLmF0dHIoJ3NyYycsdXJsKS5hdHRyKCd3aWR0aCcsJzY0MCcpLmF0dHIoJ2hlaWdodCcsJzM2MCcpO31lbHNley8vIHRoaXMgaXMgbm90IGEga25vd24gdmlkZW8gbGluay4gTm93IHdoYXQsIENhdD8gTm93IHdoYXQ/XG5yZXR1cm4gZmFsc2U7fSR2aWRlby5hZGRDbGFzcygnbm90ZS12aWRlby1jbGlwJyk7cmV0dXJuICR2aWRlb1swXTt9O3RoaXMuc2hvdz1mdW5jdGlvbigpe3ZhciB0ZXh0PWNvbnRleHQuaW52b2tlKCdlZGl0b3IuZ2V0U2VsZWN0ZWRUZXh0Jyk7Y29udGV4dC5pbnZva2UoJ2VkaXRvci5zYXZlUmFuZ2UnKTt0aGlzLnNob3dWaWRlb0RpYWxvZyh0ZXh0KS50aGVuKGZ1bmN0aW9uKHVybCl7Ly8gW3dvcmthcm91bmRdIGhpZGUgZGlhbG9nIGJlZm9yZSByZXN0b3JlIHJhbmdlIGZvciBJRSByYW5nZSBmb2N1c1xudWkuaGlkZURpYWxvZyhzZWxmLiRkaWFsb2cpO2NvbnRleHQuaW52b2tlKCdlZGl0b3IucmVzdG9yZVJhbmdlJyk7Ly8gYnVpbGQgbm9kZVxudmFyICRub2RlPXNlbGYuY3JlYXRlVmlkZW9Ob2RlKHVybCk7aWYoJG5vZGUpey8vIGluc2VydCB2aWRlbyBub2RlXG5jb250ZXh0Lmludm9rZSgnZWRpdG9yLmluc2VydE5vZGUnLCRub2RlKTt9fSkuZmFpbChmdW5jdGlvbigpe2NvbnRleHQuaW52b2tlKCdlZGl0b3IucmVzdG9yZVJhbmdlJyk7fSk7fTsvKipcbiAgICAgKiBzaG93IGltYWdlIGRpYWxvZ1xuICAgICAqXG4gICAgICogQHBhcmFtIHtqUXVlcnl9ICRkaWFsb2dcbiAgICAgKiBAcmV0dXJuIHtQcm9taXNlfVxuICAgICAqL3RoaXMuc2hvd1ZpZGVvRGlhbG9nPWZ1bmN0aW9uKHRleHQpe3JldHVybiAkLkRlZmVycmVkKGZ1bmN0aW9uKGRlZmVycmVkKXt2YXIgJHZpZGVvVXJsPXNlbGYuJGRpYWxvZy5maW5kKCcubm90ZS12aWRlby11cmwnKSwkdmlkZW9CdG49c2VsZi4kZGlhbG9nLmZpbmQoJy5ub3RlLXZpZGVvLWJ0bicpO3VpLm9uRGlhbG9nU2hvd24oc2VsZi4kZGlhbG9nLGZ1bmN0aW9uKCl7Y29udGV4dC50cmlnZ2VyRXZlbnQoJ2RpYWxvZy5zaG93bicpOyR2aWRlb1VybC52YWwodGV4dCkub24oJ2lucHV0JyxmdW5jdGlvbigpe3VpLnRvZ2dsZUJ0bigkdmlkZW9CdG4sJHZpZGVvVXJsLnZhbCgpKTt9KS50cmlnZ2VyKCdmb2N1cycpOyR2aWRlb0J0bi5jbGljayhmdW5jdGlvbihldmVudCl7ZXZlbnQucHJldmVudERlZmF1bHQoKTtkZWZlcnJlZC5yZXNvbHZlKCR2aWRlb1VybC52YWwoKSk7fSk7c2VsZi5iaW5kRW50ZXJLZXkoJHZpZGVvVXJsLCR2aWRlb0J0bik7fSk7dWkub25EaWFsb2dIaWRkZW4oc2VsZi4kZGlhbG9nLGZ1bmN0aW9uKCl7JHZpZGVvVXJsLm9mZignaW5wdXQnKTskdmlkZW9CdG4ub2ZmKCdjbGljaycpO2lmKGRlZmVycmVkLnN0YXRlKCk9PT0ncGVuZGluZycpe2RlZmVycmVkLnJlamVjdCgpO319KTt1aS5zaG93RGlhbG9nKHNlbGYuJGRpYWxvZyk7fSk7fTt9O3ZhciBIZWxwRGlhbG9nPWZ1bmN0aW9uKGNvbnRleHQpe3ZhciBzZWxmPXRoaXM7dmFyIHVpPSQuc3VtbWVybm90ZS51aTt2YXIgJGVkaXRvcj1jb250ZXh0LmxheW91dEluZm8uZWRpdG9yO3ZhciBvcHRpb25zPWNvbnRleHQub3B0aW9uczt2YXIgbGFuZz1vcHRpb25zLmxhbmdJbmZvO3RoaXMuY3JlYXRlU2hvcnRDdXRMaXN0PWZ1bmN0aW9uKCl7dmFyIGtleU1hcD1vcHRpb25zLmtleU1hcFthZ2VudC5pc01hYz8nbWFjJzoncGMnXTtyZXR1cm4gT2JqZWN0LmtleXMoa2V5TWFwKS5tYXAoZnVuY3Rpb24oa2V5KXt2YXIgY29tbWFuZD1rZXlNYXBba2V5XTt2YXIgJHJvdz0kKCc8ZGl2PjxkaXYgY2xhc3M9XCJoZWxwLWxpc3QtaXRlbVwiLz48L2Rpdj4nKTskcm93LmFwcGVuZCgkKCc8bGFiZWw+PGtiZD4nK2tleSsnPC9rZGI+PC9sYWJlbD4nKS5jc3Moeyd3aWR0aCc6MTgwLCdtYXJnaW4tcmlnaHQnOjEwfSkpLmFwcGVuZCgkKCc8c3Bhbi8+JykuaHRtbChjb250ZXh0Lm1lbW8oJ2hlbHAuJytjb21tYW5kKXx8Y29tbWFuZCkpO3JldHVybiAkcm93Lmh0bWwoKTt9KS5qb2luKCcnKTt9O3RoaXMuaW5pdGlhbGl6ZT1mdW5jdGlvbigpe3ZhciAkY29udGFpbmVyPW9wdGlvbnMuZGlhbG9nc0luQm9keT8kKGRvY3VtZW50LmJvZHkpOiRlZGl0b3I7dmFyIGJvZHk9Wyc8cCBjbGFzcz1cInRleHQtY2VudGVyXCI+JywnPGEgaHJlZj1cImh0dHA6Ly9zdW1tZXJub3RlLm9yZy9cIiB0YXJnZXQ9XCJfYmxhbmtcIj5TdW1tZXJub3RlIDAuOC4yPC9hPiDCtyAnLCc8YSBocmVmPVwiaHR0cHM6Ly9naXRodWIuY29tL3N1bW1lcm5vdGUvc3VtbWVybm90ZVwiIHRhcmdldD1cIl9ibGFua1wiPlByb2plY3Q8L2E+IMK3ICcsJzxhIGhyZWY9XCJodHRwczovL2dpdGh1Yi5jb20vc3VtbWVybm90ZS9zdW1tZXJub3RlL2lzc3Vlc1wiIHRhcmdldD1cIl9ibGFua1wiPklzc3VlczwvYT4nLCc8L3A+J10uam9pbignJyk7dGhpcy4kZGlhbG9nPXVpLmRpYWxvZyh7dGl0bGU6bGFuZy5vcHRpb25zLmhlbHAsZmFkZTpvcHRpb25zLmRpYWxvZ3NGYWRlLGJvZHk6dGhpcy5jcmVhdGVTaG9ydEN1dExpc3QoKSxmb290ZXI6Ym9keSxjYWxsYmFjazpmdW5jdGlvbigkbm9kZSl7JG5vZGUuZmluZCgnLm1vZGFsLWJvZHknKS5jc3MoeydtYXgtaGVpZ2h0JzozMDAsJ292ZXJmbG93Jzonc2Nyb2xsJ30pO319KS5yZW5kZXIoKS5hcHBlbmRUbygkY29udGFpbmVyKTt9O3RoaXMuZGVzdHJveT1mdW5jdGlvbigpe3VpLmhpZGVEaWFsb2codGhpcy4kZGlhbG9nKTt0aGlzLiRkaWFsb2cucmVtb3ZlKCk7fTsvKipcbiAgICAgKiBzaG93IGhlbHAgZGlhbG9nXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtQcm9taXNlfVxuICAgICAqL3RoaXMuc2hvd0hlbHBEaWFsb2c9ZnVuY3Rpb24oKXtyZXR1cm4gJC5EZWZlcnJlZChmdW5jdGlvbihkZWZlcnJlZCl7dWkub25EaWFsb2dTaG93bihzZWxmLiRkaWFsb2csZnVuY3Rpb24oKXtjb250ZXh0LnRyaWdnZXJFdmVudCgnZGlhbG9nLnNob3duJyk7ZGVmZXJyZWQucmVzb2x2ZSgpO30pO3VpLnNob3dEaWFsb2coc2VsZi4kZGlhbG9nKTt9KS5wcm9taXNlKCk7fTt0aGlzLnNob3c9ZnVuY3Rpb24oKXtjb250ZXh0Lmludm9rZSgnZWRpdG9yLnNhdmVSYW5nZScpO3RoaXMuc2hvd0hlbHBEaWFsb2coKS50aGVuKGZ1bmN0aW9uKCl7Y29udGV4dC5pbnZva2UoJ2VkaXRvci5yZXN0b3JlUmFuZ2UnKTt9KTt9O307dmFyIEFpclBvcG92ZXI9ZnVuY3Rpb24oY29udGV4dCl7dmFyIHNlbGY9dGhpczt2YXIgdWk9JC5zdW1tZXJub3RlLnVpO3ZhciBvcHRpb25zPWNvbnRleHQub3B0aW9uczt2YXIgQUlSX01PREVfUE9QT1ZFUl9YX09GRlNFVD0yMDt0aGlzLmV2ZW50cz17J3N1bW1lcm5vdGUua2V5dXAgc3VtbWVybm90ZS5tb3VzZXVwIHN1bW1lcm5vdGUuc2Nyb2xsJzpmdW5jdGlvbigpe3NlbGYudXBkYXRlKCk7fSwnc3VtbWVybm90ZS5jaGFuZ2Ugc3VtbWVybm90ZS5kaWFsb2cuc2hvd24nOmZ1bmN0aW9uKCl7c2VsZi5oaWRlKCk7fSwnc3VtbWVybm90ZS5mb2N1c291dCc6ZnVuY3Rpb24od2UsZSl7Ly8gW3dvcmthcm91bmRdIEZpcmVmb3ggZG9lc24ndCBzdXBwb3J0IHJlbGF0ZWRUYXJnZXQgb24gZm9jdXNvdXRcbi8vICAtIElnbm9yZSBoaWRlIGFjdGlvbiBvbiBmb2N1cyBvdXQgaW4gRkYuXG5pZihhZ2VudC5pc0ZGKXtyZXR1cm47fWlmKCFlLnJlbGF0ZWRUYXJnZXR8fCFkb20uYW5jZXN0b3IoZS5yZWxhdGVkVGFyZ2V0LGZ1bmMuZXEoc2VsZi4kcG9wb3ZlclswXSkpKXtzZWxmLmhpZGUoKTt9fX07dGhpcy5zaG91bGRJbml0aWFsaXplPWZ1bmN0aW9uKCl7cmV0dXJuIG9wdGlvbnMuYWlyTW9kZSYmIWxpc3QuaXNFbXB0eShvcHRpb25zLnBvcG92ZXIuYWlyKTt9O3RoaXMuaW5pdGlhbGl6ZT1mdW5jdGlvbigpe3RoaXMuJHBvcG92ZXI9dWkucG9wb3Zlcih7Y2xhc3NOYW1lOidub3RlLWFpci1wb3BvdmVyJ30pLnJlbmRlcigpLmFwcGVuZFRvKCdib2R5Jyk7dmFyICRjb250ZW50PXRoaXMuJHBvcG92ZXIuZmluZCgnLnBvcG92ZXItY29udGVudCcpO2NvbnRleHQuaW52b2tlKCdidXR0b25zLmJ1aWxkJywkY29udGVudCxvcHRpb25zLnBvcG92ZXIuYWlyKTt9O3RoaXMuZGVzdHJveT1mdW5jdGlvbigpe3RoaXMuJHBvcG92ZXIucmVtb3ZlKCk7fTt0aGlzLnVwZGF0ZT1mdW5jdGlvbigpe3ZhciBzdHlsZUluZm89Y29udGV4dC5pbnZva2UoJ2VkaXRvci5jdXJyZW50U3R5bGUnKTtpZihzdHlsZUluZm8ucmFuZ2UmJiFzdHlsZUluZm8ucmFuZ2UuaXNDb2xsYXBzZWQoKSl7dmFyIHJlY3Q9bGlzdC5sYXN0KHN0eWxlSW5mby5yYW5nZS5nZXRDbGllbnRSZWN0cygpKTtpZihyZWN0KXt2YXIgYm5kPWZ1bmMucmVjdDJibmQocmVjdCk7dGhpcy4kcG9wb3Zlci5jc3Moe2Rpc3BsYXk6J2Jsb2NrJyxsZWZ0Ok1hdGgubWF4KGJuZC5sZWZ0K2JuZC53aWR0aC8yLDApLUFJUl9NT0RFX1BPUE9WRVJfWF9PRkZTRVQsdG9wOmJuZC50b3ArYm5kLmhlaWdodH0pO319ZWxzZXt0aGlzLmhpZGUoKTt9fTt0aGlzLmhpZGU9ZnVuY3Rpb24oKXt0aGlzLiRwb3BvdmVyLmhpZGUoKTt9O307dmFyIEhpbnRQb3BvdmVyPWZ1bmN0aW9uKGNvbnRleHQpe3ZhciBzZWxmPXRoaXM7dmFyIHVpPSQuc3VtbWVybm90ZS51aTt2YXIgUE9QT1ZFUl9ESVNUPTU7dmFyIGhpbnQ9Y29udGV4dC5vcHRpb25zLmhpbnR8fFtdO3ZhciBkaXJlY3Rpb249Y29udGV4dC5vcHRpb25zLmhpbnREaXJlY3Rpb258fCdib3R0b20nO3ZhciBoaW50cz0kLmlzQXJyYXkoaGludCk/aGludDpbaGludF07dGhpcy5ldmVudHM9eydzdW1tZXJub3RlLmtleXVwJzpmdW5jdGlvbih3ZSxlKXtpZighZS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSl7c2VsZi5oYW5kbGVLZXl1cChlKTt9fSwnc3VtbWVybm90ZS5rZXlkb3duJzpmdW5jdGlvbih3ZSxlKXtzZWxmLmhhbmRsZUtleWRvd24oZSk7fSwnc3VtbWVybm90ZS5kaWFsb2cuc2hvd24nOmZ1bmN0aW9uKCl7c2VsZi5oaWRlKCk7fX07dGhpcy5zaG91bGRJbml0aWFsaXplPWZ1bmN0aW9uKCl7cmV0dXJuIGhpbnRzLmxlbmd0aD4wO307dGhpcy5pbml0aWFsaXplPWZ1bmN0aW9uKCl7dGhpcy5sYXN0V29yZFJhbmdlPW51bGw7dGhpcy4kcG9wb3Zlcj11aS5wb3BvdmVyKHtjbGFzc05hbWU6J25vdGUtaGludC1wb3BvdmVyJyxoaWRlQXJyb3c6dHJ1ZSxkaXJlY3Rpb246Jyd9KS5yZW5kZXIoKS5hcHBlbmRUbygnYm9keScpO3RoaXMuJHBvcG92ZXIuaGlkZSgpO3RoaXMuJGNvbnRlbnQ9dGhpcy4kcG9wb3Zlci5maW5kKCcucG9wb3Zlci1jb250ZW50Jyk7dGhpcy4kY29udGVudC5vbignY2xpY2snLCcubm90ZS1oaW50LWl0ZW0nLGZ1bmN0aW9uKCl7c2VsZi4kY29udGVudC5maW5kKCcuYWN0aXZlJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpOyQodGhpcykuYWRkQ2xhc3MoJ2FjdGl2ZScpO3NlbGYucmVwbGFjZSgpO30pO307dGhpcy5kZXN0cm95PWZ1bmN0aW9uKCl7dGhpcy4kcG9wb3Zlci5yZW1vdmUoKTt9O3RoaXMuc2VsZWN0SXRlbT1mdW5jdGlvbigkaXRlbSl7dGhpcy4kY29udGVudC5maW5kKCcuYWN0aXZlJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpOyRpdGVtLmFkZENsYXNzKCdhY3RpdmUnKTt0aGlzLiRjb250ZW50WzBdLnNjcm9sbFRvcD0kaXRlbVswXS5vZmZzZXRUb3AtdGhpcy4kY29udGVudC5pbm5lckhlaWdodCgpLzI7fTt0aGlzLm1vdmVEb3duPWZ1bmN0aW9uKCl7dmFyICRjdXJyZW50PXRoaXMuJGNvbnRlbnQuZmluZCgnLm5vdGUtaGludC1pdGVtLmFjdGl2ZScpO3ZhciAkbmV4dD0kY3VycmVudC5uZXh0KCk7aWYoJG5leHQubGVuZ3RoKXt0aGlzLnNlbGVjdEl0ZW0oJG5leHQpO31lbHNle3ZhciAkbmV4dEdyb3VwPSRjdXJyZW50LnBhcmVudCgpLm5leHQoKTtpZighJG5leHRHcm91cC5sZW5ndGgpeyRuZXh0R3JvdXA9dGhpcy4kY29udGVudC5maW5kKCcubm90ZS1oaW50LWdyb3VwJykuZmlyc3QoKTt9dGhpcy5zZWxlY3RJdGVtKCRuZXh0R3JvdXAuZmluZCgnLm5vdGUtaGludC1pdGVtJykuZmlyc3QoKSk7fX07dGhpcy5tb3ZlVXA9ZnVuY3Rpb24oKXt2YXIgJGN1cnJlbnQ9dGhpcy4kY29udGVudC5maW5kKCcubm90ZS1oaW50LWl0ZW0uYWN0aXZlJyk7dmFyICRwcmV2PSRjdXJyZW50LnByZXYoKTtpZigkcHJldi5sZW5ndGgpe3RoaXMuc2VsZWN0SXRlbSgkcHJldik7fWVsc2V7dmFyICRwcmV2R3JvdXA9JGN1cnJlbnQucGFyZW50KCkucHJldigpO2lmKCEkcHJldkdyb3VwLmxlbmd0aCl7JHByZXZHcm91cD10aGlzLiRjb250ZW50LmZpbmQoJy5ub3RlLWhpbnQtZ3JvdXAnKS5sYXN0KCk7fXRoaXMuc2VsZWN0SXRlbSgkcHJldkdyb3VwLmZpbmQoJy5ub3RlLWhpbnQtaXRlbScpLmxhc3QoKSk7fX07dGhpcy5yZXBsYWNlPWZ1bmN0aW9uKCl7dmFyICRpdGVtPXRoaXMuJGNvbnRlbnQuZmluZCgnLm5vdGUtaGludC1pdGVtLmFjdGl2ZScpO2lmKCRpdGVtLmxlbmd0aCl7dmFyIG5vZGU9dGhpcy5ub2RlRnJvbUl0ZW0oJGl0ZW0pO3RoaXMubGFzdFdvcmRSYW5nZS5pbnNlcnROb2RlKG5vZGUpO3JhbmdlLmNyZWF0ZUZyb21Ob2RlKG5vZGUpLmNvbGxhcHNlKCkuc2VsZWN0KCk7dGhpcy5sYXN0V29yZFJhbmdlPW51bGw7dGhpcy5oaWRlKCk7Y29udGV4dC5pbnZva2UoJ2VkaXRvci5mb2N1cycpO319O3RoaXMubm9kZUZyb21JdGVtPWZ1bmN0aW9uKCRpdGVtKXt2YXIgaGludD1oaW50c1skaXRlbS5kYXRhKCdpbmRleCcpXTt2YXIgaXRlbT0kaXRlbS5kYXRhKCdpdGVtJyk7dmFyIG5vZGU9aGludC5jb250ZW50P2hpbnQuY29udGVudChpdGVtKTppdGVtO2lmKHR5cGVvZiBub2RlPT09J3N0cmluZycpe25vZGU9ZG9tLmNyZWF0ZVRleHQobm9kZSk7fXJldHVybiBub2RlO307dGhpcy5jcmVhdGVJdGVtVGVtcGxhdGVzPWZ1bmN0aW9uKGhpbnRJZHgsaXRlbXMpe3ZhciBoaW50PWhpbnRzW2hpbnRJZHhdO3JldHVybiBpdGVtcy5tYXAoZnVuY3Rpb24oaXRlbSxpZHgpe3ZhciAkaXRlbT0kKCc8ZGl2IGNsYXNzPVwibm90ZS1oaW50LWl0ZW1cIi8+Jyk7JGl0ZW0uYXBwZW5kKGhpbnQudGVtcGxhdGU/aGludC50ZW1wbGF0ZShpdGVtKTppdGVtKycnKTskaXRlbS5kYXRhKHsnaW5kZXgnOmhpbnRJZHgsJ2l0ZW0nOml0ZW19KTtpZihoaW50SWR4PT09MCYmaWR4PT09MCl7JGl0ZW0uYWRkQ2xhc3MoJ2FjdGl2ZScpO31yZXR1cm4gJGl0ZW07fSk7fTt0aGlzLmhhbmRsZUtleWRvd249ZnVuY3Rpb24oZSl7aWYoIXRoaXMuJHBvcG92ZXIuaXMoJzp2aXNpYmxlJykpe3JldHVybjt9aWYoZS5rZXlDb2RlPT09a2V5LmNvZGUuRU5URVIpe2UucHJldmVudERlZmF1bHQoKTt0aGlzLnJlcGxhY2UoKTt9ZWxzZSBpZihlLmtleUNvZGU9PT1rZXkuY29kZS5VUCl7ZS5wcmV2ZW50RGVmYXVsdCgpO3RoaXMubW92ZVVwKCk7fWVsc2UgaWYoZS5rZXlDb2RlPT09a2V5LmNvZGUuRE9XTil7ZS5wcmV2ZW50RGVmYXVsdCgpO3RoaXMubW92ZURvd24oKTt9fTt0aGlzLnNlYXJjaEtleXdvcmQ9ZnVuY3Rpb24oaW5kZXgsa2V5d29yZCxjYWxsYmFjayl7dmFyIGhpbnQ9aGludHNbaW5kZXhdO2lmKGhpbnQmJmhpbnQubWF0Y2gudGVzdChrZXl3b3JkKSYmaGludC5zZWFyY2gpe3ZhciBtYXRjaGVzPWhpbnQubWF0Y2guZXhlYyhrZXl3b3JkKTtoaW50LnNlYXJjaChtYXRjaGVzWzFdLGNhbGxiYWNrKTt9ZWxzZXtjYWxsYmFjaygpO319O3RoaXMuY3JlYXRlR3JvdXA9ZnVuY3Rpb24oaWR4LGtleXdvcmQpe3ZhciAkZ3JvdXA9JCgnPGRpdiBjbGFzcz1cIm5vdGUtaGludC1ncm91cCBub3RlLWhpbnQtZ3JvdXAtJytpZHgrJ1wiLz4nKTt0aGlzLnNlYXJjaEtleXdvcmQoaWR4LGtleXdvcmQsZnVuY3Rpb24oaXRlbXMpe2l0ZW1zPWl0ZW1zfHxbXTtpZihpdGVtcy5sZW5ndGgpeyRncm91cC5odG1sKHNlbGYuY3JlYXRlSXRlbVRlbXBsYXRlcyhpZHgsaXRlbXMpKTtzZWxmLnNob3coKTt9fSk7cmV0dXJuICRncm91cDt9O3RoaXMuaGFuZGxlS2V5dXA9ZnVuY3Rpb24oZSl7aWYobGlzdC5jb250YWlucyhba2V5LmNvZGUuRU5URVIsa2V5LmNvZGUuVVAsa2V5LmNvZGUuRE9XTl0sZS5rZXlDb2RlKSl7aWYoZS5rZXlDb2RlPT09a2V5LmNvZGUuRU5URVIpe2lmKHRoaXMuJHBvcG92ZXIuaXMoJzp2aXNpYmxlJykpe3JldHVybjt9fX1lbHNle3ZhciB3b3JkUmFuZ2U9Y29udGV4dC5pbnZva2UoJ2VkaXRvci5jcmVhdGVSYW5nZScpLmdldFdvcmRSYW5nZSgpO3ZhciBrZXl3b3JkPXdvcmRSYW5nZS50b1N0cmluZygpO2lmKGhpbnRzLmxlbmd0aCYma2V5d29yZCl7dGhpcy4kY29udGVudC5lbXB0eSgpO3ZhciBibmQ9ZnVuYy5yZWN0MmJuZChsaXN0Lmxhc3Qod29yZFJhbmdlLmdldENsaWVudFJlY3RzKCkpKTtpZihibmQpe3RoaXMuJHBvcG92ZXIuaGlkZSgpO3RoaXMubGFzdFdvcmRSYW5nZT13b3JkUmFuZ2U7aGludHMuZm9yRWFjaChmdW5jdGlvbihoaW50LGlkeCl7aWYoaGludC5tYXRjaC50ZXN0KGtleXdvcmQpKXtzZWxmLmNyZWF0ZUdyb3VwKGlkeCxrZXl3b3JkKS5hcHBlbmRUbyhzZWxmLiRjb250ZW50KTt9fSk7Ly8gc2V0IHBvc2l0aW9uIGZvciBwb3BvdmVyIGFmdGVyIGdyb3VwIGlzIGNyZWF0ZWRcbmlmKGRpcmVjdGlvbj09PSd0b3AnKXt0aGlzLiRwb3BvdmVyLmNzcyh7bGVmdDpibmQubGVmdCx0b3A6Ym5kLnRvcC10aGlzLiRwb3BvdmVyLm91dGVySGVpZ2h0KCktUE9QT1ZFUl9ESVNUfSk7fWVsc2V7dGhpcy4kcG9wb3Zlci5jc3Moe2xlZnQ6Ym5kLmxlZnQsdG9wOmJuZC50b3ArYm5kLmhlaWdodCtQT1BPVkVSX0RJU1R9KTt9fX1lbHNle3RoaXMuaGlkZSgpO319fTt0aGlzLnNob3c9ZnVuY3Rpb24oKXt0aGlzLiRwb3BvdmVyLnNob3coKTt9O3RoaXMuaGlkZT1mdW5jdGlvbigpe3RoaXMuJHBvcG92ZXIuaGlkZSgpO307fTskLnN1bW1lcm5vdGU9JC5leHRlbmQoJC5zdW1tZXJub3RlLHt2ZXJzaW9uOicwLjguMicsdWk6dWksZG9tOmRvbSxwbHVnaW5zOnt9LG9wdGlvbnM6e21vZHVsZXM6eydlZGl0b3InOkVkaXRvciwnY2xpcGJvYXJkJzpDbGlwYm9hcmQsJ2Ryb3B6b25lJzpEcm9wem9uZSwnY29kZXZpZXcnOkNvZGV2aWV3LCdzdGF0dXNiYXInOlN0YXR1c2JhciwnZnVsbHNjcmVlbic6RnVsbHNjcmVlbiwnaGFuZGxlJzpIYW5kbGUsLy8gRklYTUU6IEhpbnRQb3BvdmVyIG11c3QgYmUgZnJvbnQgb2YgYXV0b2xpbmtcbi8vICAtIFNjcmlwdCBlcnJvciBhYm91dCByYW5nZSB3aGVuIEVudGVyIGtleSBpcyBwcmVzc2VkIG9uIGhpbnQgcG9wb3ZlclxuJ2hpbnRQb3BvdmVyJzpIaW50UG9wb3ZlciwnYXV0b0xpbmsnOkF1dG9MaW5rLCdhdXRvU3luYyc6QXV0b1N5bmMsJ3BsYWNlaG9sZGVyJzpQbGFjZWhvbGRlciwnYnV0dG9ucyc6QnV0dG9ucywndG9vbGJhcic6VG9vbGJhciwnbGlua0RpYWxvZyc6TGlua0RpYWxvZywnbGlua1BvcG92ZXInOkxpbmtQb3BvdmVyLCdpbWFnZURpYWxvZyc6SW1hZ2VEaWFsb2csJ2ltYWdlUG9wb3Zlcic6SW1hZ2VQb3BvdmVyLCd2aWRlb0RpYWxvZyc6VmlkZW9EaWFsb2csJ2hlbHBEaWFsb2cnOkhlbHBEaWFsb2csJ2FpclBvcG92ZXInOkFpclBvcG92ZXJ9LGJ1dHRvbnM6e30sbGFuZzonZW4tVVMnLC8vIHRvb2xiYXJcbnRvb2xiYXI6W1snc3R5bGUnLFsnc3R5bGUnXV0sWydmb250JyxbJ2JvbGQnLCd1bmRlcmxpbmUnLCdjbGVhciddXSxbJ2ZvbnRuYW1lJyxbJ2ZvbnRuYW1lJ11dLFsnY29sb3InLFsnY29sb3InXV0sWydwYXJhJyxbJ3VsJywnb2wnLCdwYXJhZ3JhcGgnXV0sWyd0YWJsZScsWyd0YWJsZSddXSxbJ2luc2VydCcsWydsaW5rJywncGljdHVyZScsJ3ZpZGVvJ11dLFsndmlldycsWydmdWxsc2NyZWVuJywnY29kZXZpZXcnLCdoZWxwJ11dXSwvLyBwb3BvdmVyXG5wb3BvdmVyOntpbWFnZTpbWydpbWFnZXNpemUnLFsnaW1hZ2VTaXplMTAwJywnaW1hZ2VTaXplNTAnLCdpbWFnZVNpemUyNSddXSxbJ2Zsb2F0JyxbJ2Zsb2F0TGVmdCcsJ2Zsb2F0UmlnaHQnLCdmbG9hdE5vbmUnXV0sWydyZW1vdmUnLFsncmVtb3ZlTWVkaWEnXV1dLGxpbms6W1snbGluaycsWydsaW5rRGlhbG9nU2hvdycsJ3VubGluayddXV0sYWlyOltbJ2NvbG9yJyxbJ2NvbG9yJ11dLFsnZm9udCcsWydib2xkJywndW5kZXJsaW5lJywnY2xlYXInXV0sWydwYXJhJyxbJ3VsJywncGFyYWdyYXBoJ11dLFsndGFibGUnLFsndGFibGUnXV0sWydpbnNlcnQnLFsnbGluaycsJ3BpY3R1cmUnXV1dfSwvLyBhaXIgbW9kZTogaW5saW5lIGVkaXRvclxuYWlyTW9kZTpmYWxzZSx3aWR0aDpudWxsLGhlaWdodDpudWxsLGZvY3VzOmZhbHNlLHRhYlNpemU6NCxzdHlsZVdpdGhTcGFuOnRydWUsc2hvcnRjdXRzOnRydWUsdGV4dGFyZWFBdXRvU3luYzp0cnVlLGRpcmVjdGlvbjpudWxsLHN0eWxlVGFnczpbJ3AnLCdibG9ja3F1b3RlJywncHJlJywnaDEnLCdoMicsJ2gzJywnaDQnLCdoNScsJ2g2J10sZm9udE5hbWVzOlsnQXJpYWwnLCdBcmlhbCBCbGFjaycsJ0NvbWljIFNhbnMgTVMnLCdDb3VyaWVyIE5ldycsJ0hlbHZldGljYSBOZXVlJywnSGVsdmV0aWNhJywnSW1wYWN0JywnTHVjaWRhIEdyYW5kZScsJ1RhaG9tYScsJ1RpbWVzIE5ldyBSb21hbicsJ1ZlcmRhbmEnXSxmb250U2l6ZXM6Wyc4JywnOScsJzEwJywnMTEnLCcxMicsJzE0JywnMTgnLCcyNCcsJzM2J10sLy8gcGFsbGV0ZSBjb2xvcnMobiB4IG4pXG5jb2xvcnM6W1snIzAwMDAwMCcsJyM0MjQyNDInLCcjNjM2MzYzJywnIzlDOUM5NCcsJyNDRUM2Q0UnLCcjRUZFRkVGJywnI0Y3RjdGNycsJyNGRkZGRkYnXSxbJyNGRjAwMDAnLCcjRkY5QzAwJywnI0ZGRkYwMCcsJyMwMEZGMDAnLCcjMDBGRkZGJywnIzAwMDBGRicsJyM5QzAwRkYnLCcjRkYwMEZGJ10sWycjRjdDNkNFJywnI0ZGRTdDRScsJyNGRkVGQzYnLCcjRDZFRkQ2JywnI0NFREVFNycsJyNDRUU3RjcnLCcjRDZENkU3JywnI0U3RDZERSddLFsnI0U3OUM5QycsJyNGRkM2OUMnLCcjRkZFNzlDJywnI0I1RDZBNScsJyNBNUM2Q0UnLCcjOUNDNkVGJywnI0I1QTVENicsJyNENkE1QkQnXSxbJyNFNzYzNjMnLCcjRjdBRDZCJywnI0ZGRDY2MycsJyM5NEJEN0InLCcjNzNBNUFEJywnIzZCQURERScsJyM4QzdCQzYnLCcjQzY3QkE1J10sWycjQ0UwMDAwJywnI0U3OTQzOScsJyNFRkM2MzEnLCcjNkJBNTRBJywnIzRBN0I4QycsJyMzOTg0QzYnLCcjNjM0QUE1JywnI0E1NEE3QiddLFsnIzlDMDAwMCcsJyNCNTYzMDgnLCcjQkQ5NDAwJywnIzM5N0IyMScsJyMxMDRBNUEnLCcjMDg1Mjk0JywnIzMxMTg3MycsJyM3MzE4NDInXSxbJyM2MzAwMDAnLCcjN0IzOTAwJywnIzg0NjMwMCcsJyMyOTUyMTgnLCcjMDgzMTM5JywnIzAwMzE2MycsJyMyMTEwNEEnLCcjNEExMDMxJ11dLGxpbmVIZWlnaHRzOlsnMS4wJywnMS4yJywnMS40JywnMS41JywnMS42JywnMS44JywnMi4wJywnMy4wJ10sdGFibGVDbGFzc05hbWU6J3RhYmxlIHRhYmxlLWJvcmRlcmVkJyxpbnNlcnRUYWJsZU1heFNpemU6e2NvbDoxMCxyb3c6MTB9LGRpYWxvZ3NJbkJvZHk6ZmFsc2UsZGlhbG9nc0ZhZGU6ZmFsc2UsbWF4aW11bUltYWdlRmlsZVNpemU6bnVsbCxjYWxsYmFja3M6e29uSW5pdDpudWxsLG9uRm9jdXM6bnVsbCxvbkJsdXI6bnVsbCxvbkVudGVyOm51bGwsb25LZXl1cDpudWxsLG9uS2V5ZG93bjpudWxsLG9uSW1hZ2VVcGxvYWQ6bnVsbCxvbkltYWdlVXBsb2FkRXJyb3I6bnVsbH0sY29kZW1pcnJvcjp7bW9kZTondGV4dC9odG1sJyxodG1sTW9kZTp0cnVlLGxpbmVOdW1iZXJzOnRydWV9LGtleU1hcDp7cGM6eydFTlRFUic6J2luc2VydFBhcmFncmFwaCcsJ0NUUkwrWic6J3VuZG8nLCdDVFJMK1knOidyZWRvJywnVEFCJzondGFiJywnU0hJRlQrVEFCJzondW50YWInLCdDVFJMK0InOidib2xkJywnQ1RSTCtJJzonaXRhbGljJywnQ1RSTCtVJzondW5kZXJsaW5lJywnQ1RSTCtTSElGVCtTJzonc3RyaWtldGhyb3VnaCcsJ0NUUkwrQkFDS1NMQVNIJzoncmVtb3ZlRm9ybWF0JywnQ1RSTCtTSElGVCtMJzonanVzdGlmeUxlZnQnLCdDVFJMK1NISUZUK0UnOidqdXN0aWZ5Q2VudGVyJywnQ1RSTCtTSElGVCtSJzonanVzdGlmeVJpZ2h0JywnQ1RSTCtTSElGVCtKJzonanVzdGlmeUZ1bGwnLCdDVFJMK1NISUZUK05VTTcnOidpbnNlcnRVbm9yZGVyZWRMaXN0JywnQ1RSTCtTSElGVCtOVU04JzonaW5zZXJ0T3JkZXJlZExpc3QnLCdDVFJMK0xFRlRCUkFDS0VUJzonb3V0ZGVudCcsJ0NUUkwrUklHSFRCUkFDS0VUJzonaW5kZW50JywnQ1RSTCtOVU0wJzonZm9ybWF0UGFyYScsJ0NUUkwrTlVNMSc6J2Zvcm1hdEgxJywnQ1RSTCtOVU0yJzonZm9ybWF0SDInLCdDVFJMK05VTTMnOidmb3JtYXRIMycsJ0NUUkwrTlVNNCc6J2Zvcm1hdEg0JywnQ1RSTCtOVU01JzonZm9ybWF0SDUnLCdDVFJMK05VTTYnOidmb3JtYXRINicsJ0NUUkwrRU5URVInOidpbnNlcnRIb3Jpem9udGFsUnVsZScsJ0NUUkwrSyc6J2xpbmtEaWFsb2cuc2hvdyd9LG1hYzp7J0VOVEVSJzonaW5zZXJ0UGFyYWdyYXBoJywnQ01EK1onOid1bmRvJywnQ01EK1NISUZUK1onOidyZWRvJywnVEFCJzondGFiJywnU0hJRlQrVEFCJzondW50YWInLCdDTUQrQic6J2JvbGQnLCdDTUQrSSc6J2l0YWxpYycsJ0NNRCtVJzondW5kZXJsaW5lJywnQ01EK1NISUZUK1MnOidzdHJpa2V0aHJvdWdoJywnQ01EK0JBQ0tTTEFTSCc6J3JlbW92ZUZvcm1hdCcsJ0NNRCtTSElGVCtMJzonanVzdGlmeUxlZnQnLCdDTUQrU0hJRlQrRSc6J2p1c3RpZnlDZW50ZXInLCdDTUQrU0hJRlQrUic6J2p1c3RpZnlSaWdodCcsJ0NNRCtTSElGVCtKJzonanVzdGlmeUZ1bGwnLCdDTUQrU0hJRlQrTlVNNyc6J2luc2VydFVub3JkZXJlZExpc3QnLCdDTUQrU0hJRlQrTlVNOCc6J2luc2VydE9yZGVyZWRMaXN0JywnQ01EK0xFRlRCUkFDS0VUJzonb3V0ZGVudCcsJ0NNRCtSSUdIVEJSQUNLRVQnOidpbmRlbnQnLCdDTUQrTlVNMCc6J2Zvcm1hdFBhcmEnLCdDTUQrTlVNMSc6J2Zvcm1hdEgxJywnQ01EK05VTTInOidmb3JtYXRIMicsJ0NNRCtOVU0zJzonZm9ybWF0SDMnLCdDTUQrTlVNNCc6J2Zvcm1hdEg0JywnQ01EK05VTTUnOidmb3JtYXRINScsJ0NNRCtOVU02JzonZm9ybWF0SDYnLCdDTUQrRU5URVInOidpbnNlcnRIb3Jpem9udGFsUnVsZScsJ0NNRCtLJzonbGlua0RpYWxvZy5zaG93J319LGljb25zOnsnYWxpZ24nOidub3RlLWljb24tYWxpZ24nLCdhbGlnbkNlbnRlcic6J25vdGUtaWNvbi1hbGlnbi1jZW50ZXInLCdhbGlnbkp1c3RpZnknOidub3RlLWljb24tYWxpZ24tanVzdGlmeScsJ2FsaWduTGVmdCc6J25vdGUtaWNvbi1hbGlnbi1sZWZ0JywnYWxpZ25SaWdodCc6J25vdGUtaWNvbi1hbGlnbi1yaWdodCcsJ2luZGVudCc6J25vdGUtaWNvbi1hbGlnbi1pbmRlbnQnLCdvdXRkZW50Jzonbm90ZS1pY29uLWFsaWduLW91dGRlbnQnLCdhcnJvd3NBbHQnOidub3RlLWljb24tYXJyb3dzLWFsdCcsJ2JvbGQnOidub3RlLWljb24tYm9sZCcsJ2NhcmV0Jzonbm90ZS1pY29uLWNhcmV0JywnY2lyY2xlJzonbm90ZS1pY29uLWNpcmNsZScsJ2Nsb3NlJzonbm90ZS1pY29uLWNsb3NlJywnY29kZSc6J25vdGUtaWNvbi1jb2RlJywnZXJhc2VyJzonbm90ZS1pY29uLWVyYXNlcicsJ2ZvbnQnOidub3RlLWljb24tZm9udCcsJ2ZyYW1lJzonbm90ZS1pY29uLWZyYW1lJywnaXRhbGljJzonbm90ZS1pY29uLWl0YWxpYycsJ2xpbmsnOidub3RlLWljb24tbGluaycsJ3VubGluayc6J25vdGUtaWNvbi1jaGFpbi1icm9rZW4nLCdtYWdpYyc6J25vdGUtaWNvbi1tYWdpYycsJ21lbnVDaGVjayc6J25vdGUtaWNvbi1jaGVjaycsJ21pbnVzJzonbm90ZS1pY29uLW1pbnVzJywnb3JkZXJlZGxpc3QnOidub3RlLWljb24tb3JkZXJlZGxpc3QnLCdwZW5jaWwnOidub3RlLWljb24tcGVuY2lsJywncGljdHVyZSc6J25vdGUtaWNvbi1waWN0dXJlJywncXVlc3Rpb24nOidub3RlLWljb24tcXVlc3Rpb24nLCdyZWRvJzonbm90ZS1pY29uLXJlZG8nLCdzcXVhcmUnOidub3RlLWljb24tc3F1YXJlJywnc3RyaWtldGhyb3VnaCc6J25vdGUtaWNvbi1zdHJpa2V0aHJvdWdoJywnc3Vic2NyaXB0Jzonbm90ZS1pY29uLXN1YnNjcmlwdCcsJ3N1cGVyc2NyaXB0Jzonbm90ZS1pY29uLXN1cGVyc2NyaXB0JywndGFibGUnOidub3RlLWljb24tdGFibGUnLCd0ZXh0SGVpZ2h0Jzonbm90ZS1pY29uLXRleHQtaGVpZ2h0JywndHJhc2gnOidub3RlLWljb24tdHJhc2gnLCd1bmRlcmxpbmUnOidub3RlLWljb24tdW5kZXJsaW5lJywndW5kbyc6J25vdGUtaWNvbi11bmRvJywndW5vcmRlcmVkbGlzdCc6J25vdGUtaWNvbi11bm9yZGVyZWRsaXN0JywndmlkZW8nOidub3RlLWljb24tdmlkZW8nfX19KTt9KTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vc3VtbWVybm90ZS9kaXN0L3N1bW1lcm5vdGUuanNcbi8vIG1vZHVsZSBpZCA9IDEzOFxuLy8gbW9kdWxlIGNodW5rcyA9IDIwIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=");
}});